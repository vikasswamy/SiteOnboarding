function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),s=new M(i||[]);return r(o,"_invoke",{value:S(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="executing",p="completed",m={};function v(){}function g(){}function y(){}var _={};u(_,o,(function(){return this}));var x=Object.getPrototypeOf,b=x&&x(x(I([])));b&&b!==n&&i.call(b,o)&&(_=b);var w=y.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(r,a,o,s){var l=h(e[r],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return a=a?a.then(r,r):r()}})}function S(t,n,i){var r=d;return function(a,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===a)throw o;return{value:e,done:!0}}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var l=T(s,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var u=h(t,n,i);if("normal"===u.type){if(r=i.done?p:"suspendedYield",u.arg===m)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=p,i.method="throw",i.arg=u.arg)}}}function T(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=h(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(typeof t+" is not iterable")}return g.prototype=y,r(w,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:g,configurable:!0}),g.displayName=u(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},k(C.prototype),u(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new C(c(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(w),u(w,l,"Generator"),u(w,o,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=I,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:I(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),m}},t}function asyncGeneratorStep(e,t,n,i,r,a,o){try{var s=e[a](o),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(i,r)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){asyncGeneratorStep(a,i,r,o,s,"next",e)}function s(e){asyncGeneratorStep(a,i,r,o,s,"throw",e)}o(void 0)}))}}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=_superPropBase(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}}).apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf2(e)););return e}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf2(t),_possibleConstructorReturn(e,_isNativeReflectConstruct2()?Reflect.construct(t,n||[],_getPrototypeOf2(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized2(e)}function _assertThisInitialized2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf2(e,t)}function _wrapNativeSuper2(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper2=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct2(e,arguments,_getPrototypeOf2(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf2(n,e)})(e)}function _construct2(e,t,n){if(_isNativeReflectConstruct2())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(e.bind.apply(e,i));return n&&_setPrototypeOf2(r,n.prototype),r}function _isNativeReflectConstruct2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct2=function(){return!!e})()}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function _setPrototypeOf2(e,t){return(_setPrototypeOf2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf2(e){return(_getPrototypeOf2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+qE3":function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,r)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var r,a,o;if(u(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=c(e))>0&&o.length>r&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function p(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):v(r,r.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function g(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){i.once&&e.removeEventListener(t,r),n(a)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var u=l.length,c=v(l,u);for(n=0;n<u;++n)a(c[n],this,t)}return!0},s.prototype.on=s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},s.prototype.off=s.prototype.removeListener=function(e,t){var n,i,r,a,o;if(u(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},"/5w7":function(e,t,n){"use strict";e.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},"/t/I":function(e,t){!function(t){"use strict";var n,i,r="fulfilled",a="undefined",o=function(){var e=[],n=0;function r(){for(;e.length-n;){try{e[n]()}catch(r){t.console&&t.console.error(r)}e[n++]=i,1024==n&&(e.splice(0,1024),n=0)}}var o=function(){if(typeof MutationObserver===a)return typeof process!==a&&"function"==typeof process.nextTick?function(){process.nextTick(r)}:typeof setImmediate!==a?function(){setImmediate(r)}:function(){setTimeout(r,0)};var e=document.createElement("div");return new MutationObserver(r).observe(e,{attributes:!0}),function(){e.setAttribute("a",0)}}();return function(t){e.push(t),e.length-n==1&&o()}}();function s(e){if(!(this instanceof s))throw new TypeError("Zousan must be created with the new keyword");if("function"==typeof e){var t=this;try{e((function(e){t.resolve(e)}),(function(e){t.reject(e)}))}catch(e){t.reject(e)}}else if(0<arguments.length)throw new TypeError("Zousan resolver "+e+" is not a function")}function l(e,t){if("function"==typeof e.y)try{var n=e.y.call(i,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function u(e,t){if("function"==typeof e.n)try{var n=e.n.call(i,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}s.prototype={resolve:function(e){if(this.state===n){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var t=this;if(e&&("function"==typeof e||"object"==typeof e))try{var i=!0,a=e.then;if("function"==typeof a)return void a.call(e,(function(e){i&&(i=!1,t.resolve(e))}),(function(e){i&&(i=!1,t.reject(e))}))}catch(a){return void(i&&this.reject(a))}this.state=r,this.v=e,t.c&&o((function(){for(var n=0,i=t.c.length;n<i;n++)l(t.c[n],e)}))}},reject:function(e){if(this.state===n){var i=this;this.state="rejected",this.v=e;var r=this.c;o(r?function(){for(var t=0,n=r.length;t<n;t++)u(r[t],e)}:function(){i.handled||!s.suppressUncaughtRejectionError&&t.console&&s.warn("You upset Zousan. Please catch rejections: ",e,e?e.stack:null)})}},then:function(e,t){var i=new s,a={y:e,n:t,p:i};if(this.state===n)this.c?this.c.push(a):this.c=[a];else{var c=this.state,h=this.v;this.handled=!0,o((function(){c===r?l(a,h):u(a,h)}))}return i},catch:function(e){return this.then(null,e)},finally:function(e){return this.then(e,e)},timeout:function(e,t){t=t||"Timeout";var n=this;return new s((function(i,r){setTimeout((function(){r(Error(t))}),e),n.then((function(e){i(e)}),(function(e){r(e)}))}))}},s.resolve=function(e){var t=new s;return t.resolve(e),t},s.reject=function(e){var t=new s;return t.c=[],t.reject(e),t},s.all=function(e){var t=[],n=0,i=new s;function r(r,a){r&&"function"==typeof r.then||(r=s.resolve(r)),r.then((function(r){t[a]=r,++n==e.length&&i.resolve(t)}),(function(e){i.reject(e)}))}for(var a=0;a<e.length;a++)r(e[a],a);return e.length||i.resolve(t),i},s.warn=console.warn,typeof e!=a&&e.exports&&(e.exports=s),t.define&&t.define.amd&&t.define([],(function(){return s})),(t.Zousan=s).soon=o}("undefined"!=typeof global?global:this)},0:function(e,t){},"0KjW":function(e,t,n){"use strict";var i=n("KXza");e.exports=i},1:function(e,t,n){e.exports=n("zUnb")},"2+Hy":function(e,t,n){"use strict";var i=n("YI60"),r=n("U6jy"),a=n("uhBA"),o=n("d0rS"),s=n("jLWS"),l=1;function u(e,t){if(!e)throw new Error("MapiRequest requires a client");if(!t||!t.path||!t.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};t.body&&(n["content-type"]="application/json");var i=r(n,t.headers),o=Object.keys(i).reduce((function(e,t){return e[t.toLowerCase()]=i[t],e}),{});this.id=l++,this._options=t,this.emitter=new a,this.client=e,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=t.path,this.method=t.method,this.origin=t.origin||e.origin,this.query=t.query||{},this.params=t.params||{},this.body=t.body||null,this.file=t.file||null,this.encoding=t.encoding||"utf8",this.sendFileAs=t.sendFileAs||null,this.headers=o}u.prototype.url=function(e){var t=o.prependOrigin(this.path,this.origin);t=o.appendQueryObject(t,this.query);var n=this.params,a=null==e?this.client.accessToken:e;if(a){t=o.appendQueryParam(t,"access_token",a);var s=i(a).user;n=r({ownerId:s},n)}return o.interpolateRouteParams(t,n)},u.prototype.send=function(){var e=this;if(e.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return e.sent=!0,e.client.sendRequest(e).then((function(t){return e.response=t,e.emitter.emit(s.EVENT_RESPONSE,t),t}),(function(t){throw e.error=t,e.emitter.emit(s.EVENT_ERROR,t),t}))},u.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},u.prototype.eachPage=function(e){var t=this;function n(n){e(null,n,(function(){delete t._nextPageRequest;var e=n.nextPage();e&&(t._nextPageRequest=e,r(e))}))}function i(t){e(t,null,(function(){}))}function r(e){e.send().then(n,i)}r(this)},u.prototype.clone=function(){return this._extend()},u.prototype._extend=function(e){var t=r(this._options,e);return new u(this.client,t)},e.exports=u},"4ZJM":function(e,t,n){e.exports=function(){"use strict";var e,t,n;function i(i,r){if(e)if(t){var a="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",o={};e(o),n=r(o),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}else t=r;else e=r}return i(0,(function(e){var t,n,i,r="undefined"!=typeof self?self:{},a="2.15.0",o={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==t){var e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{t=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):e}catch(r){t=e}}return t},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!o.API_URL)return null;try{var t=new URL(o.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},s={supported:!1,testSupport:function(e){!l&&i&&(u?c(e):n=e)}},l=!1,u=!1;function c(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),e.isContextLost())return;s.supported=!0}catch(e){}e.deleteTexture(t),l=!0}r.document&&((i=r.document.createElement("img")).onload=function(){n&&c(n),n=null,u=!0},i.onerror=function(){l=!0,n=null},i.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var h="01";function d(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f=p;function p(e,t,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=i}p.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var r=this.sampleCurveX(n)-e;if(Math.abs(r)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var o=0,s=1;for(n=e,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-e)<t));i++)e>r?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var m=d(f),v=g;function g(e,t){this.x=e,this.y=t}g.prototype={clone:function(){return new g(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=i,this},_rotateAround:function(e,t){var n=Math.cos(e),i=Math.sin(e),r=t.y+i*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-i*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},g.convert=function(e){return e instanceof g?e:Array.isArray(e)?new g(e[0],e[1]):e};var y=d(v),_=Math.PI/180,x=180/Math.PI;function b(e){return e*_}function w(e){return e*x}var k=[[0,0],[1,0],[1,1],[0,1]];function C(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function S(e,t,n,i){var r=new m(e,t,n,i);return function(e){return r.solve(e)}}var T=S(.25,.1,.25,1);function E(e,t,n){return Math.min(n,Math.max(t,e))}function P(e,t,n){return(n=E((n-e)/(t-e),0,1))*n*(3-2*n)}function M(e,t,n){var i=n-t,r=((e-t)%i+i)%i+t;return r===t?n:r}function I(e,t,n){if(!e.length)return n(null,[]);var i=e.length,r=new Array(e.length),a=null;e.forEach((function(e,o){t(e,(function(e,t){e&&(a=e),r[o]=t,0==--i&&n(a,r)}))}))}function A(e){var t=[];for(var n in e)t.push(e[n]);return t}function R(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,a=n;r<a.length;r++){var o=a[r];for(var s in o)e[s]=o[s]}return e}var O=1;function N(){return O++}function D(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function z(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function L(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function B(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function F(e,t){return-1!==e.indexOf(t,e.length-t.length)}function j(e,t,n){var i={};for(var r in e)i[r]=t.call(n||this,e[r],r,e);return i}function H(e,t,n){var i={};for(var r in e)t.call(n||this,e[r],r,e)&&(i[r]=e[r]);return i}function V(e){return Array.isArray(e)?e.map(V):"object"==typeof e&&e?j(e,V):e}var U={};function q(e){U[e]||("undefined"!=typeof console&&console.warn(e),U[e]=!0)}function G(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function W(e){for(var t,n,i=0,r=0,a=e.length,o=a-1;r<a;o=r++)t=e[r],i+=((n=e[o]).x-t.x)*(t.y+n.y);return i}function Z(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function X(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,n,i,r){var a=i||r;return t[n]=!a||a.toLowerCase(),""})),t["max-age"]){var n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t}var K=null;function Y(e){if(null==K){var t=e.navigator?e.navigator.userAgent:null;K=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return K}function J(e){try{var t=r[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function Q(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}var $,ee,te="mapbox-tiles",ne=500,ie=50;function re(){try{return r.caches}catch(e){}}function ae(){re()&&!$&&($=r.caches.open(te))}function oe(e){var t=e.indexOf("?");if(t<0)return e;var n=function(e){var t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}(e).filter((function(e){var t=e.split("=");return"language"===t[0]||"worldview"===t[0]}));return n.length?"".concat(e.slice(0,t),"?").concat(n.join("&")):e.slice(0,t)}var se=1/0,le={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(le);var ue=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),401===n&&_e(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),(r=_callSuper(this,t,[e])).status=n,r.url=i,r}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),t}(),ce=Z()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===r.location.protocol?r.parent:r).location.href},he=function(e,t){if(!(/^file:/.test(n=e.url)||/^file:/.test(ce())&&!/^\w+:/.test(n))){if(r.fetch&&r.Request&&r.AbortController&&r.Request.prototype.hasOwnProperty("signal"))return function(e,t){var n,i=new r.AbortController,a=new r.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:ce(),referrerPolicy:e.referrerPolicy,signal:i.signal}),o=!1,s=!1,l=(n=a.url).indexOf("sku=")>0&&_e(n);"json"===e.type&&a.headers.set("Accept","application/json");var u=function(n,i,o){if(!s){if(n&&"SecurityError"!==n.message&&q(n.toString()),i&&o)return c(i);var u=Date.now();r.fetch(a).then((function(n){if(n.ok){var i=l?n.clone():null;return c(n,i,u)}return t(new ue(n.statusText,n.status,e.url))})).catch((function(n){"AbortError"!==n.name&&t(new Error("".concat(n.message," ").concat(e.url)))}))}},c=function(n,i,l){("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then((function(e){s||(i&&l&&function(e,t,n){if(ae(),$){var i={status:t.status,statusText:t.statusText,headers:new r.Headers};t.headers.forEach((function(e,t){return i.headers.set(t,e)}));var a=X(t.headers.get("Cache-Control")||"");if(!a["no-store"]){a["max-age"]&&i.headers.set("Expires",new Date(n+1e3*a["max-age"]).toUTCString());var o=i.headers.get("Expires");o&&(new Date(o).getTime()-n<42e4||function(e,t){if(void 0===ee)try{new Response(new ReadableStream),ee=!0}catch(e){ee=!1}ee?t(e.body):e.blob().then(t)}(t,(function(t){var n=new r.Response(t,i);ae(),$&&$.then((function(t){return t.put(oe(e.url),n)})).catch((function(e){return q(e.message)}))})))}}}(a,i,l),o=!0,t(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(e){s||t(new Error(e.message))}))};return l?function(e,t){if(ae(),!$)return t(null);var n=oe(e.url);$.then((function(e){e.match(n).then((function(i){var r=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),n=X(e.headers.get("Cache-Control")||"");return t>Date.now()&&!n["no-cache"]}(i);e.delete(n),r&&e.put(n,i.clone()),t(null,i,r)})).catch(t)})).catch(t)}(a,u):u(null,null),{cancel:function(){s=!0,o||i.abort()}}}(e,t);if(Z()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var n;return function(e,t){var n=new r.XMLHttpRequest;for(var i in n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer"),e.headers)n.setRequestHeader(i,e.headers[i]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var i=n.response;if("json"===e.type)try{i=JSON.parse(n.response)}catch(e){return t(e)}t(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else t(new ue(n.statusText,n.status,e.url))},n.send(e.body),{cancel:function(){return n.abort()}}}(e,t)},de=function(e,t){return he(R(e,{type:"arrayBuffer"}),t)};function fe(e){var t=r.document.createElement("a");return t.href=e,t.protocol===r.document.location.protocol&&t.host===r.document.location.host}var pe,me,ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";pe=[],me=0;var ge="NO_ACCESS_TOKEN";function ye(e){return 0===e.indexOf("mapbox:")}function _e(e){return o.API_URL_REGEX.test(e)}function xe(e){return o.API_CDN_URL_REGEX.test(e)}function be(e){return o.API_STYLE_REGEX.test(e)&&!we(e)}function we(e){return o.API_SPRITE_REGEX.test(e)}var ke=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ce(e){var t=e.match(ke);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Se(e){var t=e.params.length?"?"+e.params.join("&"):"";return"".concat(e.protocol,"://").concat(e.authority).concat(e.path).concat(t)}var Te="mapbox.eventData";function Ee(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(r.atob(t[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}var Pe=function(){function e(t){_classCallCheck(this,e),this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}return _createClass(e,[{key:"getStorageKey",value:function(e){var t,n=Ee(o.ACCESS_TOKEN);return t=n&&n.u?r.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):o.ACCESS_TOKEN||"",e?"".concat(Te,".").concat(e,":").concat(t):"".concat(Te,":").concat(t)}},{key:"fetchEventData",value:function(){var e=J("localStorage"),t=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{var i=r.localStorage.getItem(t);i&&(this.eventData=JSON.parse(i));var a=r.localStorage.getItem(n);a&&(this.anonId=a)}catch(e){q("Unable to read from LocalStorage")}}},{key:"saveEventData",value:function(){var e=J("localStorage"),t=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{r.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&r.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){q("Unable to write to LocalStorage")}}},{key:"processRequests",value:function(e){}},{key:"postEvent",value:function(e,t,n,i){var r=this;if(o.EVENTS_URL){var a=Ce(o.EVENTS_URL);a.params.push("access_token="+(i||o.ACCESS_TOKEN||""));var s={event:this.type,created:new Date(e).toISOString()},l=t?R(s,t):s,u={url:Se(a),headers:{"Content-Type":"text/plain"},body:JSON.stringify([l])};this.pendingRequest=function(e,t){return he(R(e,{method:"POST"}),(function(e){r.pendingRequest=null,n(e),r.saveEventData(),r.processRequests(i)}))}(u)}}},{key:"queueRequest",value:function(e,t){this.queue.push(e),this.processRequests(t)}}]),e}(),Me=new(function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,["appUserTurnstile"]))._customAccessToken=e,n}return _inherits(t,e),_createClass(t,[{key:"postTurnstileEvent",value:function(e,t){o.EVENTS_URL&&o.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return ye(e)||_e(e)}))&&this.queueRequest(Date.now(),t)}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=Ee(o.ACCESS_TOKEN),i=n?n.u:o.ACCESS_TOKEN,r=i!==this.eventData.tokenU;L(this.anonId)||(this.anonId=D(),r=!0);var s=this.queue.shift();if(this.eventData.lastSuccess){var l=new Date(this.eventData.lastSuccess),u=new Date(s),c=(s-this.eventData.lastSuccess)/864e5;r=r||c>=1||c<-1||l.getDate()!==u.getDate()}else r=!0;r?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:a,skuId:h,"enabled.telemetry":!1,userId:this.anonId},(function(e){e||(t.eventData.lastSuccess=s,t.eventData.tokenU=i)}),e):this.processRequests()}}}]),t}(Pe)),Ie=Me.postTurnstileEvent.bind(Me),Ae=new(function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,["map.load"])).success={},e.skuToken="",e}return _inherits(t,e),_createClass(t,[{key:"postMapLoadEvent",value:function(e,t,n,i){this.skuToken=t,this.errorCb=i,o.EVENTS_URL&&(n||o.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(ge)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),i=n.id,r=n.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=D()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:a,skuId:h,skuToken:this.skuToken,userId:this.anonId},(function(e){e?t.errorCb(e):i&&(t.success[i]=!0)}),e))}}}]),t}(Pe)),Re=Ae.postMapLoadEvent.bind(Ae),Oe=new(function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,["gljs.performance"])}return _inherits(t,e),_createClass(t,[{key:"postPerformanceEvent",value:function(e,t){o.EVENTS_URL&&(e||o.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}},{key:"processRequests",value:function(e){if(!this.pendingRequest&&0!==this.queue.length){var t,n=this.queue.shift(),i=n.timestamp,o=function(e){var t=r.performance.getEntriesByType("resource"),n=r.performance.getEntriesByType("mark"),i=function(e){var t={};if(e)for(var n in e)if("other"!==n){var i,r=_createForOfIteratorHelper(e[n]);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=n+"ResolveRangeMin",s=n+"ResolveRangeMax",l=n+"RequestCount",u=n+"RequestCachedCount";t[o]=Math.min(t[o]||1/0,a.startTime),t[s]=Math.max(t[s]||-1/0,a.responseEnd);var c=function(e){void 0===t[e]&&(t[e]=0),++t[e]};void 0!==a.transferSize&&0===a.transferSize&&c(u),c(l)}}catch(h){r.e(h)}finally{r.f()}}return t}(function(e,t){var n={};if(e){var i,r=_createForOfIteratorHelper(e);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=t(a);void 0===n[o]&&(n[o]=[]),n[o].push(a)}}catch(s){r.e(s)}finally{r.f()}}return n}(t,je)),o=r.devicePixelRatio,s=r.navigator.connection||r.navigator.mozConnection||r.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},u=function(e,t,n){null!=n&&e.push({name:t,value:n.toString()})};for(var c in i)u(l.counters,c,i[c]);if(e.interactionRange[0]!==1/0&&e.interactionRange[1]!==-1/0&&(u(l.counters,"interactionRangeMin",e.interactionRange[0]),u(l.counters,"interactionRangeMax",e.interactionRange[1])),n)for(var h=function(){var e=f[d],t=Be[e],i=n.find((function(e){return e.name===t}));i&&u(l.counters,t,i.startTime)},d=0,f=Object.keys(Be);d<f.length;d++)h();return u(l.counters,"visibilityHidden",e.visibilityHidden),u(l.attributes,"style",function(e){if(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var i=t.value.name.split("?")[0];if(be(i)){var r=i.split("/").slice(-2);if(2===r.length)return"mapbox://styles/".concat(r[0],"/").concat(r[1])}}}catch(a){n.e(a)}finally{n.f()}}}(t)),u(l.attributes,"terrainEnabled",e.terrainEnabled?"true":"false"),u(l.attributes,"fogEnabled",e.fogEnabled?"true":"false"),u(l.attributes,"projection",e.projection),u(l.attributes,"zoom",e.zoom),u(l.metadata,"devicePixelRatio",o),u(l.metadata,"connectionEffectiveType",s?s.effectiveType:void 0),u(l.metadata,"navigatorUserAgent",r.navigator.userAgent),u(l.metadata,"screenWidth",r.screen.width),u(l.metadata,"screenHeight",r.screen.height),u(l.metadata,"windowWidth",r.innerWidth),u(l.metadata,"windowHeight",r.innerHeight),u(l.metadata,"mapWidth",e.width/o),u(l.metadata,"mapHeight",e.height/o),u(l.metadata,"webglRenderer",e.renderer),u(l.metadata,"webglVendor",e.vendor),u(l.metadata,"sdkVersion",a),u(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(n.performanceData),s=_createForOfIteratorHelper(o.metadata);try{for(s.s();!(t=s.n()).done;)t.value}catch(d){s.e(d)}finally{s.f()}var l,u=_createForOfIteratorHelper(o.counters);try{for(u.s();!(l=u.n()).done;)l.value}catch(d){u.e(d)}finally{u.f()}var c,h=_createForOfIteratorHelper(o.attributes);try{for(h.s();!(c=h.n()).done;)c.value}catch(d){h.e(d)}finally{h.f()}this.postEvent(i,o,(function(){}),e)}}}]),t}(Pe)),Ne=Oe.postPerformanceEvent.bind(Oe),De=new(function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,["map.auth"])).success={},e.skuToken="",e}return _inherits(t,e),_createClass(t,[{key:"getSession",value:function(e,t,n,i){var r=this;if(o.API_URL&&o.SESSION_PATH){var a=Ce(o.API_URL+o.SESSION_PATH);a.params.push("sku="+(t||"")),a.params.push("access_token="+(i||o.ACCESS_TOKEN||""));var s={url:Se(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(e,t){return he(R(e,{method:"GET"}),(function(e){r.pendingRequest=null,n(e),r.saveEventData(),r.processRequests(i)}))}(s)}}},{key:"getSessionAPI",value:function(e,t,n,i){this.skuToken=t,this.errorCb=i,o.SESSION_PATH&&o.API_URL&&(n||o.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(ge)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),i=n.id,r=n.timestamp;i&&this.success[i]||this.getSession(r,this.skuToken,(function(e){e?t.errorCb(e):i&&(t.success[i]=!0)}),e)}}}]),t}(Pe)),ze=De.getSessionAPI.bind(De),Le=new Set,Be={create:"create",load:"load",fullLoad:"fullLoad"},Fe={mark:function(e){r.performance.mark(e)},measure:function(e,t,n){r.performance.measure(e,t,n)}};function je(e){var t=e.name.split("?")[0];return xe(t)&&t.includes("mapbox-gl.js")?"javascript":xe(t)&&t.includes("mapbox-gl.css")?"css":function(e){return o.API_FONTS_REGEX.test(e)}(t)?"fontRange":we(t)?"sprite":be(t)?"style":function(e){return o.API_TILEJSON_REGEX.test(e)}(t)?"tilejson":"other"}var He,Ve,Ue,qe,Ge=r.performance;function We(e){var t=e?e.url.toString():void 0;return Ge.getEntriesByName(t)}var Ze={now:function(){return void 0!==Ue?Ue:r.performance.now()},setNow:function(e){Ue=e},restoreNow:function(){Ue=void 0},frame:function(e){var t=r.requestAnimationFrame(e);return{cancel:function(){return r.cancelAnimationFrame(t)}}},getImageData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.width,i=e.height;qe||(qe=r.document.createElement("canvas"));var a=qe.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return(n>qe.width||i>qe.height)&&(qe.width=n,qe.height=i),a.clearRect(-t,-t,n+2*t,i+2*t),a.drawImage(e,0,0,n,i),a.getImageData(-t,-t,n+2*t,i+2*t)},resolveURL:function(e){return He||(He=r.document.createElement("a")),He.href=e,He.href},get devicePixelRatio(){return r.devicePixelRatio},get prefersReducedMotion(){return!!r.matchMedia&&(null==Ve&&(Ve=r.matchMedia("(prefers-reduced-motion: reduce)")),Ve.matches)}};function Xe(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function Ke(e,t,n){if(n&&n[e]){var i=n[e].indexOf(t);-1!==i&&n[e].splice(i,1)}}var Ye=_createClass((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),R(this,n),this.type=t})),Je=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),_callSuper(this,t,["error",R({error:e},n)])}return _inherits(t,e),_createClass(t)}(Ye),Qe=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"on",value:function(e,t){return this._listeners=this._listeners||{},Xe(e,t,this._listeners),this}},{key:"off",value:function(e,t){return Ke(e,t,this._listeners),Ke(e,t,this._oneTimeListeners),this}},{key:"once",value:function(e,t){var n=this;return t?(this._oneTimeListeners=this._oneTimeListeners||{},Xe(e,t,this._oneTimeListeners),this):new Promise((function(t){return n.once(e,t)}))}},{key:"fire",value:function(e,t){"string"==typeof e&&(e=new Ye(e,t||{}));var n=e.type;if(this.listens(n)){e.target=this;var i,r=_createForOfIteratorHelper(this._listeners&&this._listeners[n]?this._listeners[n].slice():[]);try{for(r.s();!(i=r.n()).done;){i.value.call(this,e)}}catch(u){r.e(u)}finally{r.f()}var a,o=_createForOfIteratorHelper(this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[]);try{for(o.s();!(a=o.n()).done;){var s=a.value;Ke(n,s,this._oneTimeListeners),s.call(this,e)}}catch(u){o.e(u)}finally{o.f()}var l=this._eventedParent;l&&(R(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(e))}else e instanceof Je&&console.error(e.error);return this}},{key:"listens",value:function(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}},{key:"setEventedParent",value:function(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}]),e}(),$e=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,a=n;r<a.length;r++){var o=a[r];for(var s in o)e[s]=o[s]}return e}function tt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nt(e){if(Array.isArray(e))return e.map(nt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var n in e)t[n]=nt(e[n]);return t}return tt(e)}var it=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[n])).message=n,i.key=e,i}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t)}(),rt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,e),this.parent=t,this.bindings={};var i,r=_createForOfIteratorHelper(n);try{for(r.s();!(i=r.n()).done;){var a=_slicedToArray(i.value,2),o=a[0],s=a[1];this.bindings[o]=s}}catch(l){r.e(l)}finally{r.f()}}return _createClass(e,[{key:"concat",value:function(t){return new e(this,t)}},{key:"get",value:function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")}},{key:"has",value:function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}]),e}(),at={kind:"null"},ot={kind:"number"},st={kind:"string"},lt={kind:"boolean"},ut={kind:"color"},ct={kind:"object"},ht={kind:"value"},dt={kind:"collator"},ft={kind:"formatted"},pt={kind:"resolvedImage"};function mt(e,t){return{kind:"array",itemType:e,N:t}}function vt(e){if("array"===e.kind){var t=vt(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}var gt=[at,ot,st,lt,ut,ft,ct,mt(ht),pt];function yt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!yt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var n=0,i=gt;n<i.length;n++){if(!yt(i[n],t))return null}}return"Expected ".concat(vt(e)," but found ").concat(vt(t)," instead.")}function _t(e,t){return t.some((function(t){return t.kind===e.kind}))}function xt(e,t){return t.some((function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e}))}var bt,wt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function kt(e){return(e=Math.round(e))<0?0:e>255?255:e}function Ct(e){return kt("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function St(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function Tt(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}try{bt={}.parseCSSColor=function(e){var t,n=e.replace(/ /g,"").toLowerCase();if(n in wt)return wt[n].slice();if("#"===n[0])return 4===n.length?(t=parseInt(n.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===n.length&&(t=parseInt(n.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var a=n.substr(0,i),o=n.substr(i+1,r-(i+1)).split(","),s=1;switch(a){case"rgba":if(4!==o.length)return null;s=St(o.pop());case"rgb":return 3!==o.length?null:[Ct(o[0]),Ct(o[1]),Ct(o[2]),s];case"hsla":if(4!==o.length)return null;s=St(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,u=St(o[1]),c=St(o[2]),h=c<=.5?c*(u+1):c+u-c*u,d=2*c-h;return[kt(255*Tt(d,h,l+1/3)),kt(255*Tt(d,h,l)),kt(255*Tt(d,h,l-1/3)),s];default:return null}}return null}}catch(e){}var Et=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;_classCallCheck(this,e),this.r=t,this.g=n,this.b=i,this.a=r}return _createClass(e,[{key:"toString",value:function(){var e=_slicedToArray(this.toArray(),4),t=e[0],n=e[1],i=e[2],r=e[3];return"rgba(".concat(Math.round(t),",").concat(Math.round(n),",").concat(Math.round(i),",").concat(r,")")}},{key:"toArray",value:function(){var e=this.r,t=this.g,n=this.b,i=this.a;return 0===i?[0,0,0,0]:[255*e/i,255*t/i,255*n/i,i]}},{key:"toArray01",value:function(){var e=this.r,t=this.g,n=this.b,i=this.a;return 0===i?[0,0,0,0]:[e/i,t/i,n/i,i]}},{key:"toArray01PremultipliedAlpha",value:function(){return[this.r,this.g,this.b,this.a]}}],[{key:"parse",value:function(t){if(t){if(t instanceof e)return t;if("string"==typeof t){var n=bt(t);return n?new e(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}}}}]),e}();Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1),Et.blue=new Et(0,0,1,1);var Pt=Et,Mt=function(){function e(t,n,i){_classCallCheck(this,e),this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}return _createClass(e,[{key:"compare",value:function(e,t){return this.collator.compare(e,t)}},{key:"resolvedLocale",value:function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}]),e}(),It=_createClass((function e(t,n,i,r,a){_classCallCheck(this,e),this.text=t.normalize?t.normalize():t,this.image=n,this.scale=i,this.fontStack=r,this.textColor=a})),At=function(){function e(t){_classCallCheck(this,e),this.sections=t}return _createClass(e,[{key:"isEmpty",value:function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))}},{key:"toString",value:function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")}},{key:"serialize",value:function(){var e,t=["format"],n=_createForOfIteratorHelper(this.sections);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var r={};i.fontStack&&(r["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(r["font-scale"]=i.scale),i.textColor&&(r["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(r)}}}catch(a){n.e(a)}finally{n.f()}return t}}],[{key:"fromString",value:function(t){return new e([new It(t,null,null,null,null)])}},{key:"factory",value:function(t){return t instanceof e?t:e.fromString(t)}}]),e}(),Rt=function(){function e(t){_classCallCheck(this,e),this.name=t.name,this.available=t.available}return _createClass(e,[{key:"toString",value:function(){return this.name}},{key:"serialize",value:function(){return["image",this.name]}}],[{key:"fromString",value:function(t){return t?new e({name:t,available:!1}):null}}]),e}();function Ot(e,t,n,i){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value [".concat([e,t,n,i].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof i?[e,t,n,i]:[e,t,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function Nt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Pt)return!0;if(e instanceof Mt)return!0;if(e instanceof At)return!0;if(e instanceof Rt)return!0;if(Array.isArray(e)){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){if(!Nt(t.value))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}if("object"==typeof e){for(var i in e)if(!Nt(e[i]))return!1;return!0}return!1}function Dt(e){if(null===e)return at;if("string"==typeof e)return st;if("boolean"==typeof e)return lt;if("number"==typeof e)return ot;if(e instanceof Pt)return ut;if(e instanceof Mt)return dt;if(e instanceof At)return ft;if(e instanceof Rt)return pt;if(Array.isArray(e)){var t,n,i=e.length,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var a=Dt(n.value);if(t){if(t===a)continue;t=ht;break}t=a}}catch(o){r.e(o)}finally{r.f()}return mt(t||ht,i)}return ct}function zt(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Pt||e instanceof At||e instanceof Rt?e.toString():JSON.stringify(e)}var Lt=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.value=n}return _createClass(e,[{key:"evaluate",value:function(){return this.value}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Pt?["rgba"].concat(this.value.toArray()):this.value instanceof At?this.value.serialize():this.value}}],[{key:"parse",value:function(t,n){if(2!==t.length)return n.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!Nt(t[1]))return n.error("invalid value");var i=t[1],r=Dt(i),a=n.expectedType;return"array"!==r.kind||0!==r.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(r=a),new e(r,i)}}]),e}(),Bt=function(){function e(t){_classCallCheck(this,e),this.name="ExpressionEvaluationError",this.message=t}return _createClass(e,[{key:"toJSON",value:function(){return this.message}}]),e}(),Ft={string:st,number:ot,boolean:lt,object:ct},jt=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.args=n}return _createClass(e,[{key:"evaluate",value:function(e){for(var t=0;t<this.args.length;t++){var n=this.args[t].evaluate(e);if(!yt(this.type,Dt(n)))return n;if(t===this.args.length-1)throw new Bt("Expected value to be of type ".concat(vt(this.type),", but found ").concat(vt(Dt(n))," instead."))}return null}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=this.type,t=[e.kind];if("array"===e.kind){var n=e.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){t.push(n.kind);var i=e.N;("number"==typeof i||this.args.length>1)&&t.push(i)}}return t.concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i,r=1,a=t[0];if("array"===a){var o,s;if(t.length>2){var l=t[1];if("string"!=typeof l||!(l in Ft)||"object"===l)return n.error('The item type argument of "array" must be one of string, number, boolean',1);o=Ft[l],r++}else o=ht;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);s=t[2],r++}i=mt(o,s)}else i=Ft[a];for(var u=[];r<t.length;r++){var c=n.parse(t[r],r,ht);if(!c)return null;u.push(c)}return new e(i,u)}}]),e}(),Ht=function(){function e(t){_classCallCheck(this,e),this.type=ft,this.sections=t}return _createClass(e,[{key:"evaluate",value:function(e){return new At(this.sections.map((function(t){var n=t.content.evaluate(e);return Dt(n)===pt?new It("",n,null,null,null):new It(zt(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}},{key:"eachChild",value:function(e){var t,n=_createForOfIteratorHelper(this.sections);try{for(n.s();!(t=n.n()).done;){var i=t.value;e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}}catch(r){n.e(r)}finally{n.f()}}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e,t=["format"],n=_createForOfIteratorHelper(this.sections);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push(i.content.serialize());var r={};i.scale&&(r["font-scale"]=i.scale.serialize()),i.font&&(r["text-font"]=i.font.serialize()),i.textColor&&(r["text-color"]=i.textColor.serialize()),t.push(r)}}catch(a){n.e(a)}finally{n.f()}return t}}],[{key:"parse",value:function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return n.error("First argument must be an image or text section.");for(var r=[],a=!1,o=1;o<=t.length-1;++o){var s=t[o];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;var l=null;if(s["font-scale"]&&!(l=n.parse(s["font-scale"],1,ot)))return null;var u=null;if(s["text-font"]&&!(u=n.parse(s["text-font"],1,mt(st))))return null;var c=null;if(s["text-color"]&&!(c=n.parse(s["text-color"],1,ut)))return null;var h=r[r.length-1];h.scale=l,h.font=u,h.textColor=c}else{var d=n.parse(t[o],1,ht);if(!d)return null;var f=d.type.kind;if("string"!==f&&"value"!==f&&"null"!==f&&"resolvedImage"!==f)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,r.push({content:d,scale:null,font:null,textColor:null})}}return new e(r)}}]),e}(),Vt=function(){function e(t){_classCallCheck(this,e),this.type=pt,this.input=t}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),n=Rt.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["image",this.input.serialize()]}}],[{key:"parse",value:function(t,n){if(2!==t.length)return n.error("Expected two arguments.");var i=n.parse(t[1],1,st);return i?new e(i):n.error("No image name provided.")}}]),e}(),Ut={"to-boolean":lt,"to-color":ut,"to-number":ot,"to-string":st},qt=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.args=n}return _createClass(e,[{key:"evaluate",value:function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){var t,n,i,r=_createForOfIteratorHelper(this.args);try{for(r.s();!(i=r.n()).done;){if(t=i.value.evaluate(e),n=null,t instanceof Pt)return t;if("string"==typeof t){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(n=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):Ot(t[0],t[1],t[2],t[3])))return new Pt(t[0]/255,t[1]/255,t[2]/255,t[3])}}catch(c){r.e(c)}finally{r.f()}throw new Bt(n||"Could not parse color from value '".concat("string"==typeof t?t:String(JSON.stringify(t)),"'"))}if("number"===this.type.kind){var o,s=null,l=_createForOfIteratorHelper(this.args);try{for(l.s();!(o=l.n()).done;){if(null===(s=o.value.evaluate(e)))return 0;var u=Number(s);if(!isNaN(u))return u}}catch(c){l.e(c)}finally{l.f()}throw new Bt("Could not convert ".concat(JSON.stringify(s)," to number."))}return"formatted"===this.type.kind?At.fromString(zt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Rt.fromString(zt(this.args[0].evaluate(e))):zt(this.args[0].evaluate(e))}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){if("formatted"===this.type.kind)return new Ht([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Vt(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return n.error("Expected one argument.");for(var r=Ut[i],a=[],o=1;o<t.length;o++){var s=n.parse(t[o],o,ht);if(!s)return null;a.push(s)}return new e(r,a)}}]),e}(),Gt=["Unknown","Point","LineString","Polygon"],Wt=function(){function e(){_classCallCheck(this,e),this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}return _createClass(e,[{key:"id",value:function(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}},{key:"geometryType",value:function(){return this.feature?"number"==typeof this.feature.type?Gt[this.feature.type]:this.feature.type:null}},{key:"geometry",value:function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}},{key:"canonicalID",value:function(){return this.canonical}},{key:"properties",value:function(){return this.feature&&this.feature.properties||{}}},{key:"distanceFromCenter",value:function(){if(this.featureTileCoord&&this.featureDistanceData){var e=this.featureDistanceData.center,t=this.featureDistanceData.scale,n=this.featureTileCoord,i=n.x,r=n.y;return this.featureDistanceData.bearing[0]*(i*t-e[0])+this.featureDistanceData.bearing[1]*(r*t-e[1])}return 0}},{key:"parseColor",value:function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Pt.parse(e)),t}}]),e}(),Zt=function(){function e(t,n,i,r){_classCallCheck(this,e),this.name=t,this.type=n,this._evaluate=i,this.args=r}return _createClass(e,[{key:"evaluate",value:function(e){return this._evaluate(e,this.args)}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,n){var i,r=t[0],a=e.definitions[r];if(!a)return n.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0);var o,s=Array.isArray(a)?a[0]:a.type,l=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,u=l.filter((function(e){var n=_slicedToArray(e,1)[0];return!Array.isArray(n)||n.length===t.length-1})),c=null,h=_createForOfIteratorHelper(u);try{for(h.s();!(o=h.n()).done;){var d=_slicedToArray(o.value,2),f=d[0],p=d[1];c=new gn(n.registry,n.path,null,n.scope);for(var m=[],v=!1,g=1;g<t.length;g++){var y=t[g],_=Array.isArray(f)?f[g-1]:f.type,x=c.parse(y,1+m.length,_);if(!x){v=!0;break}m.push(x)}if(!v)if(Array.isArray(f)&&f.length!==m.length)c.error("Expected ".concat(f.length," arguments, but found ").concat(m.length," instead."));else{for(var b=0;b<m.length;b++){var w=Array.isArray(f)?f[b]:f.type,k=m[b];c.concat(b+1).checkSubtype(w,k.type)}if(0===c.errors.length)return new e(r,s,p,m)}}}catch(P){h.e(P)}finally{h.f()}if(1===u.length)(i=n.errors).push.apply(i,_toConsumableArray(c.errors));else{for(var C=(u.length?u:l).map((function(e){var t;return t=_slicedToArray(e,1)[0],Array.isArray(t)?"(".concat(t.map(vt).join(", "),")"):"(".concat(vt(t.type),"...)")})).join(" | "),S=[],T=1;T<t.length;T++){var E=n.parse(t[T],1+S.length);if(!E)return null;S.push(vt(E.type))}n.error("Expected arguments of type ".concat(C,", but found (").concat(S.join(", "),") instead."))}return null}},{key:"register",value:function(t,n){for(var i in e.definitions=n,n)t[i]=e}}]),e}(),Xt=function(){function e(t,n,i){_classCallCheck(this,e),this.type=dt,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=n}return _createClass(e,[{key:"evaluate",value:function(e){return new Mt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}},{key:"eachChild",value:function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}],[{key:"parse",value:function(t,n){if(2!==t.length)return n.error("Expected one argument.");var i=t[1];if("object"!=typeof i||Array.isArray(i))return n.error("Collator options argument must be an object.");var r=n.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,lt);if(!r)return null;var a=n.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,lt);if(!a)return null;var o=null;return i.locale&&!(o=n.parse(i.locale,1,st))?null:new e(r,a,o)}}]),e}(),Kt=8192;function Yt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Jt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Qt(e,t){var n=(180+e[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(n*r*Kt),Math.round(i*r*Kt)]}function $t(e,t,n){var i=e[0]-t[0],r=e[1]-t[1],a=e[0]-n[0],o=e[1]-n[1];return i*o-a*r==0&&i*a<=0&&r*o<=0}function en(e,t){for(var n,i,r,a=!1,o=0,s=t.length;o<s;o++)for(var l=t[o],u=0,c=l.length;u<c-1;u++){if($t(e,l[u],l[u+1]))return!1;(i=l[u])[1]>(n=e)[1]!=(r=l[u+1])[1]>n[1]&&n[0]<(r[0]-i[0])*(n[1]-i[1])/(r[1]-i[1])+i[0]&&(a=!a)}return a}function tn(e,t){for(var n=0;n<t.length;n++)if(en(e,t[n]))return!0;return!1}function nn(e,t,n,i){var r=i[0]-n[0],a=i[1]-n[1],o=(e[0]-n[0])*a-r*(e[1]-n[1]),s=(t[0]-n[0])*a-r*(t[1]-n[1]);return o>0&&s<0||o<0&&s>0}function rn(e,t,n){var i,r,a,o,s,l,u,c=_createForOfIteratorHelper(n);try{for(c.s();!(i=c.n()).done;)for(var h=i.value,d=0;d<h.length-1;++d)if(0!=(l=[(s=h[d+1])[0]-(o=h[d])[0],s[1]-o[1]])[0]*(u=[(a=t)[0]-(r=e)[0],a[1]-r[1]])[1]-l[1]*u[0]&&nn(r,a,o,s)&&nn(o,s,r,a))return!0}catch(f){c.e(f)}finally{c.f()}return!1}function an(e,t){for(var n=0;n<e.length;++n)if(!en(e[n],t))return!1;for(var i=0;i<e.length-1;++i)if(rn(e[i],e[i+1],t))return!1;return!0}function on(e,t){for(var n=0;n<t.length;n++)if(an(e,t[n]))return!0;return!1}function sn(e,t,n){for(var i=[],r=0;r<e.length;r++){for(var a=[],o=0;o<e[r].length;o++){var s=Qt(e[r][o],n);Yt(t,s),a.push(s)}i.push(a)}return i}function ln(e,t,n){for(var i=[],r=0;r<e.length;r++){var a=sn(e[r],t,n);i.push(a)}return i}function un(e,t,n,i){if(e[0]<n[0]||e[0]>n[2]){var r=.5*i,a=e[0]-n[0]>r?-i:n[0]-e[0]>r?i:0;0===a&&(a=e[0]-n[2]>r?-i:n[2]-e[0]>r?i:0),e[0]+=a}Yt(t,e)}function cn(e,t,n,i){var r=Math.pow(2,i.z)*Kt,a=[i.x*Kt,i.y*Kt],o=[];if(!e)return o;var s,l=_createForOfIteratorHelper(e);try{for(l.s();!(s=l.n()).done;){var u,c=_createForOfIteratorHelper(s.value);try{for(c.s();!(u=c.n()).done;){var h=u.value,d=[h.x+a[0],h.y+a[1]];un(d,t,n,r),o.push(d)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){l.e(f)}finally{l.f()}return o}function hn(e,t,n,i){var r=Math.pow(2,i.z)*Kt,a=[i.x*Kt,i.y*Kt],o=[];if(!e)return o;var s,l,u=_createForOfIteratorHelper(e);try{for(u.s();!(s=u.n()).done;){var c,h=s.value,d=[],f=_createForOfIteratorHelper(h);try{for(f.s();!(c=f.n()).done;){var p=c.value,m=[p.x+a[0],p.y+a[1]];Yt(t,m),d.push(m)}}catch(x){f.e(x)}finally{f.f()}o.push(d)}}catch(x){u.e(x)}finally{u.f()}if(t[2]-t[0]<=r/2){(l=t)[0]=l[1]=1/0,l[2]=l[3]=-1/0;var v,g=_createForOfIteratorHelper(o);try{for(g.s();!(v=g.n()).done;){var y,_=_createForOfIteratorHelper(v.value);try{for(_.s();!(y=_.n()).done;){un(y.value,t,n,r)}}catch(x){_.e(x)}finally{_.f()}}}catch(x){g.e(x)}finally{g.f()}}return o}var dn=function(){function e(t,n){_classCallCheck(this,e),this.type=lt,this.geojson=t,this.geometries=n}return _createClass(e,[{key:"evaluate",value:function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){var a=sn(t.coordinates,i,r),o=cn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;var s,l=_createForOfIteratorHelper(o);try{for(l.s();!(s=l.n()).done;){if(!en(s.value,a))return!1}}catch(f){l.e(f)}finally{l.f()}}if("MultiPolygon"===t.type){var u=ln(t.coordinates,i,r),c=cn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;var h,d=_createForOfIteratorHelper(c);try{for(d.s();!(h=d.n()).done;){if(!tn(h.value,u))return!1}}catch(f){d.e(f)}finally{d.f()}}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){var a=sn(t.coordinates,i,r),o=hn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;var s,l=_createForOfIteratorHelper(o);try{for(l.s();!(s=l.n()).done;){if(!an(s.value,a))return!1}}catch(f){l.e(f)}finally{l.f()}}if("MultiPolygon"===t.type){var u=ln(t.coordinates,i,r),c=hn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;var h,d=_createForOfIteratorHelper(c);try{for(d.s();!(h=d.n()).done;){if(!on(h.value,u))return!1}}catch(f){d.e(f)}finally{d.f()}}return!0}(e,this.geometries)}return!1}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["within",this.geojson]}}],[{key:"parse",value:function(t,n){if(2!==t.length)return n.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(Nt(t[1])){var i=t[1];if("FeatureCollection"===i.type)for(var r=0;r<i.features.length;++r){var a=i.features[r].geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new e(i,i.features[r].geometry)}else if("Feature"===i.type){var o=i.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new e(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new e(i,i)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}}]),e}();function fn(e){if(e instanceof Zt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof dn)return!1;var t=!0;return e.eachChild((function(e){t&&!fn(e)&&(t=!1)})),t}function pn(e){if(e instanceof Zt&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild((function(e){t&&!pn(e)&&(t=!1)})),t}function mn(e,t){if(e instanceof Zt&&t.indexOf(e.name)>=0)return!1;var n=!0;return e.eachChild((function(e){n&&!mn(e,t)&&(n=!1)})),n}var vn=function(){function e(t,n){_classCallCheck(this,e),this.type=n.type,this.name=t,this.boundExpression=n}return _createClass(e,[{key:"evaluate",value:function(e){return this.boundExpression.evaluate(e)}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["var",this.name]}}],[{key:"parse",value:function(t,n){if(2!==t.length||"string"!=typeof t[1])return n.error("'var' expression requires exactly one string literal argument.");var i=t[1];return n.scope.has(i)?new e(i,n.scope.get(i)):n.error('Unknown variable "'.concat(i,'". Make sure "').concat(i,'" has been bound in an enclosing "let" expression before using it.'),1)}}]),e}(),gn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new rt,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];_classCallCheck(this,e),this.registry=t,this.path=n,this.key=n.map((function(e){return"[".concat(e,"]")})).join(""),this.scope=r,this.errors=a,this.expectedType=i}return _createClass(e,[{key:"parse",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,n,i)._parse(e,r):this._parse(e,r)}},{key:"_parse",value:function(e,t){function n(e,t,n){return"assert"===n?new jt(t,[e]):"coerce"===n?new qt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=e[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;var r=this.registry[i];if(r){var a=r.parse(e,this);if(!a)return null;if(this.expectedType){var o=this.expectedType,s=a.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==s.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(o,s))return null}else a=n(a,o,t.typeAnnotation||"coerce");else a=n(a,o,t.typeAnnotation||"assert")}if(!(a instanceof Lt)&&"resolvedImage"!==a.type.kind&&function e(t){if(t instanceof vn)return e(t.boundExpression);if(t instanceof Zt&&"error"===t.name)return!1;if(t instanceof Xt)return!1;if(t instanceof dn)return!1;var n=t instanceof qt||t instanceof jt,i=!0;return t.eachChild((function(t){i=n?i&&e(t):i&&t instanceof Lt})),!!i&&fn(t)&&mn(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}(a)){var l=new Wt;try{a=new Lt(a.type,a.evaluate(l))}catch(e){return this.error(e.message),null}}return a}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}},{key:"concat",value:function(t,n,i){var r="number"==typeof t?this.path.concat(t):this.path,a=i?this.scope.concat(i):this.scope;return new e(this.registry,r,n||null,a,this.errors)}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r="".concat(this.key).concat(n.map((function(e){return"[".concat(e,"]")})).join(""));this.errors.push(new it(r,e))}},{key:"checkSubtype",value:function(e,t){var n=yt(e,t);return n&&this.error(n),n}}]),e}();function yn(e,t){for(var n,i,r=e.length-1,a=0,o=r,s=0;a<=o;)if(n=e[s=Math.floor((a+o)/2)],i=e[s+1],n<=t){if(s===r||t<i)return s;a=s+1}else{if(!(n>t))throw new Bt("Input is not a number.");o=s-1}return 0}var _n=function(){function e(t,n,i){_classCallCheck(this,e),this.type=t,this.input=n,this.labels=[],this.outputs=[];var r,a=_createForOfIteratorHelper(i);try{for(a.s();!(r=a.n()).done;){var o=_slicedToArray(r.value,2),s=o[0],l=o[1];this.labels.push(s),this.outputs.push(l)}}catch(u){a.e(u)}finally{a.f()}}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);var i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);var r=t.length;return i>=t[r-1]?n[r-1].evaluate(e):n[yn(t,i)].evaluate(e)}},{key:"eachChild",value:function(e){e(this.input);var t,n=_createForOfIteratorHelper(this.outputs);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}],[{key:"parse",value:function(t,n){if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");var i=n.parse(t[1],1,ot);if(!i)return null;var r=[],a=null;n.expectedType&&"value"!==n.expectedType.kind&&(a=n.expectedType);for(var o=1;o<t.length;o+=2){var s=1===o?-1/0:t[o],l=t[o+1],u=o,c=o+1;if("number"!=typeof s)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=s)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=n.parse(l,c,a);if(!h)return null;a=a||h.type,r.push([s,h])}return new e(a,i,r)}}]),e}();function xn(e,t,n){return e*(1-n)+t*n}var bn=Object.freeze({__proto__:null,array:function(e,t,n){return e.map((function(e,i){return xn(e,t[i],n)}))},color:function(e,t,n){return new Pt(xn(e.r,t.r,n),xn(e.g,t.g,n),xn(e.b,t.b,n),xn(e.a,t.a,n))},number:xn}),wn=6/29*3*(6/29),kn=Math.PI/180,Cn=180/Math.PI;function Sn(e){return e>.008856451679035631?Math.pow(e,1/3):e/wn+4/29}function Tn(e){return e>6/29?e*e*e:wn*(e-4/29)}function En(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Pn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Mn(e){var t=Pn(e.r),n=Pn(e.g),i=Pn(e.b),r=Sn((.4124564*t+.3575761*n+.1804375*i)/.95047),a=Sn((.2126729*t+.7151522*n+.072175*i)/1);return{l:116*a-16,a:500*(r-a),b:200*(a-Sn((.0193339*t+.119192*n+.9503041*i)/1.08883)),alpha:e.a}}function In(e){var t=(e.l+16)/116,n=isNaN(e.a)?t:t+e.a/500,i=isNaN(e.b)?t:t-e.b/200;return t=1*Tn(t),n=.95047*Tn(n),i=1.08883*Tn(i),new Pt(En(3.2404542*n-1.5371385*t-.4985314*i),En(-.969266*n+1.8760108*t+.041556*i),En(.0556434*n-.2040259*t+1.0572252*i),e.alpha)}function An(e,t,n){var i=t-e;return e+n*(i>180||i<-180?i-360*Math.round(i/360):i)}var Rn={forward:Mn,reverse:In,interpolate:function(e,t,n){return{l:xn(e.l,t.l,n),a:xn(e.a,t.a,n),b:xn(e.b,t.b,n),alpha:xn(e.alpha,t.alpha,n)}}},On={forward:function(e){var t=Mn(e),n=t.l,i=t.a,r=t.b,a=Math.atan2(r,i)*Cn;return{h:a<0?a+360:a,c:Math.sqrt(i*i+r*r),l:n,alpha:e.a}},reverse:function(e){var t=e.h*kn,n=e.c;return In({l:e.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:e.alpha})},interpolate:function(e,t,n){return{h:An(e.h,t.h,n),c:xn(e.c,t.c,n),l:xn(e.l,t.l,n),alpha:xn(e.alpha,t.alpha,n)}}},Nn=Object.freeze({__proto__:null,hcl:On,lab:Rn});function Dn(e,t,n,i){var r=i-n,a=e-n;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}var zn=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.type=t,this.operator=n,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];var o,s=_createForOfIteratorHelper(a);try{for(s.s();!(o=s.n()).done;){var l=_slicedToArray(o.value,2),u=l[0],c=l[1];this.labels.push(u),this.outputs.push(c)}}catch(h){s.e(h)}finally{s.f()}}return _createClass(e,[{key:"evaluate",value:function(t){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(t);var r=this.input.evaluate(t);if(r<=n[0])return i[0].evaluate(t);var a=n.length;if(r>=n[a-1])return i[a-1].evaluate(t);var o=yn(n,r),s=e.interpolationFactor(this.interpolation,r,n[o],n[o+1]),l=i[o].evaluate(t),u=i[o+1].evaluate(t);return"interpolate"===this.operator?bn[this.type.kind.toLowerCase()](l,u,s):"interpolate-hcl"===this.operator?On.reverse(On.interpolate(On.forward(l),On.forward(u),s)):Rn.reverse(Rn.interpolate(Rn.forward(l),Rn.forward(u),s))}},{key:"eachChild",value:function(e){e(this.input);var t,n=_createForOfIteratorHelper(this.outputs);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t}}],[{key:"interpolationFactor",value:function(e,t,n,i){var r=0;if("exponential"===e.name)r=Dn(t,e.base,n,i);else if("linear"===e.name)r=Dn(t,1,n,i);else if("cubic-bezier"===e.name){var a=e.controlPoints;r=new m(a[0],a[1],a[2],a[3]).solve(Dn(t,1,n,i))}return r}},{key:"parse",value:function(t,n){var i=_toArray(t),r=i[0],a=i[1],o=i[2],s=i.slice(3);if(!Array.isArray(a)||0===a.length)return n.error("Expected an interpolation type expression.",1);if("linear"===a[0])a={name:"linear"};else if("exponential"===a[0]){var l=a[1];if("number"!=typeof l)return n.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:l}}else{if("cubic-bezier"!==a[0])return n.error("Unknown interpolation type "+String(a[0]),1,0);var u=a.slice(1);if(4!==u.length||u.some((function(e){return"number"!=typeof e||e<0||e>1})))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:u}}if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(o=n.parse(o,2,ot)))return null;var c=[],h=null;"interpolate-hcl"===r||"interpolate-lab"===r?h=ut:n.expectedType&&"value"!==n.expectedType.kind&&(h=n.expectedType);for(var d=0;d<s.length;d+=2){var f=s[d],p=s[d+1],m=d+3,v=d+4;if("number"!=typeof f)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(c.length&&c[c.length-1][0]>=f)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',m);var g=n.parse(p,v,h);if(!g)return null;h=h||g.type,c.push([f,g])}return"number"===h.kind||"color"===h.kind||"array"===h.kind&&"number"===h.itemType.kind&&"number"==typeof h.N?new e(h,r,a,o,c):n.error("Type ".concat(vt(h)," is not interpolatable."))}}]),e}(),Ln=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.args=n}return _createClass(e,[{key:"evaluate",value:function(e){var t,n,i=null,r=0,a=_createForOfIteratorHelper(this.args);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(r++,(i=o.evaluate(e))&&i instanceof Rt&&!i.available&&(t||(t=i),i=null,r===this.args.length))return t;if(null!==i)break}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,n){if(t.length<2)return n.error("Expectected at least one argument.");var i=null,r=n.expectedType;r&&"value"!==r.kind&&(i=r);var a,o=[],s=_createForOfIteratorHelper(t.slice(1));try{for(s.s();!(a=s.n()).done;){var l=a.value,u=n.parse(l,1+o.length,i,void 0,{typeAnnotation:"omit"});if(!u)return null;i=i||u.type,o.push(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r&&o.some((function(e){return yt(r,e.type)}))?ht:i,o)}}]),e}(),Bn=function(){function e(t,n){_classCallCheck(this,e),this.type=n.type,this.bindings=[].concat(t),this.result=n}return _createClass(e,[{key:"evaluate",value:function(e){return this.result.evaluate(e)}},{key:"eachChild",value:function(e){var t,n=_createForOfIteratorHelper(this.bindings);try{for(n.s();!(t=n.n()).done;){e(t.value[1])}}catch(i){n.e(i)}finally{n.f()}e(this.result)}},{key:"outputDefined",value:function(){return this.result.outputDefined()}},{key:"serialize",value:function(){var e,t=["let"],n=_createForOfIteratorHelper(this.bindings);try{for(n.s();!(e=n.n()).done;){var i=_slicedToArray(e.value,2),r=i[0],a=i[1];t.push(r,a.serialize())}}catch(o){n.e(o)}finally{n.f()}return t.push(this.result.serialize()),t}}],[{key:"parse",value:function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));for(var i=[],r=1;r<t.length-1;r+=2){var a=t[r];if("string"!=typeof a)return n.error("Expected string, but found ".concat(typeof a," instead."),r);if(/[^a-zA-Z0-9_]/.test(a))return n.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=n.parse(t[r+1],r+1);if(!o)return null;i.push([a,o])}var s=n.parse(t[t.length-1],t.length-1,n.expectedType,i);return s?new e(i,s):null}}]),e}(),Fn=function(){function e(t,n,i){_classCallCheck(this,e),this.type=t,this.index=n,this.input=i}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new Bt("Array index out of bounds: ".concat(t," < 0."));if(t>=n.length)throw new Bt("Array index out of bounds: ".concat(t," > ").concat(n.length-1,"."));if(t!==Math.floor(t))throw new Bt("Array index must be an integer, but found ".concat(t," instead."));return n[t]}},{key:"eachChild",value:function(e){e(this.index),e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["at",this.index.serialize(),this.input.serialize()]}}],[{key:"parse",value:function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var i=n.parse(t[1],1,ot),r=n.parse(t[2],2,mt(n.expectedType||ht));return i&&r?new e(r.type.itemType,i,r):null}}]),e}(),jn=function(){function e(t,n){_classCallCheck(this,e),this.type=lt,this.needle=t,this.haystack=n}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(null==n)return!1;if(!xt(t,["boolean","string","number","null"]))throw new Bt("Expected first argument to be of type boolean, string, number or null, but found ".concat(vt(Dt(t))," instead."));if(!xt(n,["string","array"]))throw new Bt("Expected second argument to be of type array or string, but found ".concat(vt(Dt(n))," instead."));return n.indexOf(t)>=0}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["in",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var i=n.parse(t[1],1,ht),r=n.parse(t[2],2,ht);return i&&r?_t(i.type,[lt,st,ot,at,ht])?new e(i,r):n.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(vt(i.type)," instead")):null}}]),e}(),Hn=function(){function e(t,n,i){_classCallCheck(this,e),this.type=ot,this.needle=t,this.haystack=n,this.fromIndex=i}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!xt(t,["boolean","string","number","null"]))throw new Bt("Expected first argument to be of type boolean, string, number or null, but found ".concat(vt(Dt(t))," instead."));if(!xt(n,["string","array"]))throw new Bt("Expected second argument to be of type array or string, but found ".concat(vt(Dt(n))," instead."));if(this.fromIndex){var i=this.fromIndex.evaluate(e);return n.indexOf(t,i)}return n.indexOf(t)}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var i=n.parse(t[1],1,ht),r=n.parse(t[2],2,ht);if(!i||!r)return null;if(!_t(i.type,[lt,st,ot,at,ht]))return n.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(vt(i.type)," instead"));if(4===t.length){var a=n.parse(t[3],3,ot);return a?new e(i,r,a):null}return new e(i,r)}}]),e}(),Vn=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this.inputType=t,this.type=n,this.input=i,this.cases=r,this.outputs=a,this.otherwise=o}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);return(Dt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}},{key:"eachChild",value:function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e,t=this,n=["match",this.input.serialize()],i=[],r={},a=_createForOfIteratorHelper(Object.keys(this.cases).sort());try{for(a.s();!(e=a.n()).done;){var o=e.value,s=r[this.cases[o]];void 0===s?(r[this.cases[o]]=i.length,i.push([this.cases[o],[o]])):i[s][1].push(o)}}catch(p){a.e(p)}finally{a.f()}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=i;u<c.length;u++){var h=_slicedToArray(c[u],2),d=h[0],f=h[1];n.push(1===f.length?l(f[0]):f.map(l)),n.push(this.outputs[d].serialize())}return n.push(this.otherwise.serialize()),n}}],[{key:"parse",value:function(t,n){if(t.length<5)return n.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return n.error("Expected an even number of arguments.");var i,r;n.expectedType&&"value"!==n.expectedType.kind&&(r=n.expectedType);for(var a={},o=[],s=2;s<t.length-1;s+=2){var l=t[s],u=t[s+1];Array.isArray(l)||(l=[l]);var c=n.concat(s);if(0===l.length)return c.error("Expected at least one branch label.");var h,d=_createForOfIteratorHelper(l);try{for(d.s();!(h=d.n()).done;){var f=h.value;if("number"!=typeof f&&"string"!=typeof f)return c.error("Branch labels must be numbers or strings.");if("number"==typeof f&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof f&&Math.floor(f)!==f)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,Dt(f)))return null}else i=Dt(f);if(void 0!==a[String(f)])return c.error("Branch labels must be unique.");a[String(f)]=o.length}}catch(g){d.e(g)}finally{d.f()}var p=n.parse(u,s,r);if(!p)return null;r=r||p.type,o.push(p)}var m=n.parse(t[1],1,ht);if(!m)return null;var v=n.parse(t[t.length-1],t.length-1,r);return v?"value"!==m.type.kind&&n.concat(1).checkSubtype(i,m.type)?null:new e(i,r,m,a,o,v):null}}]),e}(),Un=function(){function e(t,n,i){_classCallCheck(this,e),this.type=t,this.branches=n,this.otherwise=i}return _createClass(e,[{key:"evaluate",value:function(e){var t,n=_createForOfIteratorHelper(this.branches);try{for(n.s();!(t=n.n()).done;){var i=_slicedToArray(t.value,2),r=i[0],a=i[1];if(r.evaluate(e))return a.evaluate(e)}}catch(o){n.e(o)}finally{n.f()}return this.otherwise.evaluate(e)}},{key:"eachChild",value:function(e){var t,n=_createForOfIteratorHelper(this.branches);try{for(n.s();!(t=n.n()).done;){var i=_slicedToArray(t.value,2),r=i[0],a=i[1];e(r),e(a)}}catch(o){n.e(o)}finally{n.f()}e(this.otherwise)}},{key:"outputDefined",value:function(){return this.branches.every((function(e){var t=_slicedToArray(e,2);t[0];return t[1].outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return n.error("Expected an odd number of arguments.");var i;n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var r=[],a=1;a<t.length-1;a+=2){var o=n.parse(t[a],a,lt);if(!o)return null;var s=n.parse(t[a+1],a+1,i);if(!s)return null;r.push([o,s]),i=i||s.type}var l=n.parse(t[t.length-1],t.length-1,i);return l?new e(i,r,l):null}}]),e}(),qn=function(){function e(t,n,i,r){_classCallCheck(this,e),this.type=t,this.input=n,this.beginIndex=i,this.endIndex=r}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!xt(t,["string","array"]))throw new Bt("Expected first argument to be of type array or string, but found ".concat(vt(Dt(t))," instead."));if(this.endIndex){var i=this.endIndex.evaluate(e);return t.slice(n,i)}return t.slice(n)}},{key:"eachChild",value:function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}],[{key:"parse",value:function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var i=n.parse(t[1],1,ht),r=n.parse(t[2],2,ot);if(!i||!r)return null;if(!_t(i.type,[mt(ht),st,ht]))return n.error("Expected first argument to be of type array or string, but found ".concat(vt(i.type)," instead"));if(4===t.length){var a=n.parse(t[3],3,ot);return a?new e(i.type,i,r,a):null}return new e(i.type,i,r)}}]),e}();function Gn(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Wn(e,t,n,i){return 0===i.compare(t,n)}function Zn(e,t,n){var i="=="!==e&&"!="!==e;return function(){function r(e,t,n){_classCallCheck(this,r),this.type=lt,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return _createClass(r,[{key:"evaluate",value:function(r){var a=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){var s=Dt(a),l=Dt(o);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new Bt('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(s.kind,", ").concat(l.kind,") instead."))}if(this.collator&&!i&&this.hasUntypedArgument){var u=Dt(a),c=Dt(o);if("string"!==u.kind||"string"!==c.kind)return t(r,a,o)}return this.collator?n(r,a,o,this.collator.evaluate(r)):t(r,a,o)}},{key:"eachChild",value:function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t}}],[{key:"parse",value:function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var n=e[0],a=t.parse(e[1],1,ht);if(!a)return null;if(!Gn(n,a.type))return t.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(vt(a.type),"'."));var o=t.parse(e[2],2,ht);if(!o)return null;if(!Gn(n,o.type))return t.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(vt(o.type),"'."));if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '".concat(vt(a.type),"' and '").concat(vt(o.type),"'."));i&&("value"===a.type.kind&&"value"!==o.type.kind?a=new jt(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new jt(a.type,[o])));var s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,dt)))return null}return new r(a,o,s)}}]),r}()}var Xn=Zn("==",(function(e,t,n){return t===n}),Wn),Kn=Zn("!=",(function(e,t,n){return t!==n}),(function(e,t,n,i){return!Wn(0,t,n,i)})),Yn=Zn("<",(function(e,t,n){return t<n}),(function(e,t,n,i){return i.compare(t,n)<0})),Jn=Zn(">",(function(e,t,n){return t>n}),(function(e,t,n,i){return i.compare(t,n)>0})),Qn=Zn("<=",(function(e,t,n){return t<=n}),(function(e,t,n,i){return i.compare(t,n)<=0})),$n=Zn(">=",(function(e,t,n){return t>=n}),(function(e,t,n,i){return i.compare(t,n)>=0})),ei=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this.type=st,this.number=t,this.locale=n,this.currency=i,this.unit=r,this.minFractionDigits=a,this.maxFractionDigits=o}return _createClass(e,[{key:"evaluate",value:function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}},{key:"eachChild",value:function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}],[{key:"parse",value:function(t,n){if(3!==t.length)return n.error("Expected two arguments.");var i=n.parse(t[1],1,ot);if(!i)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return n.error("NumberFormat options argument must be an object.");var a=null;if(r.locale&&!(a=n.parse(r.locale,1,st)))return null;var o=null;if(r.currency&&!(o=n.parse(r.currency,1,st)))return null;var s=null;if(r.unit&&!(s=n.parse(r.unit,1,st)))return null;var l=null;if(r["min-fraction-digits"]&&!(l=n.parse(r["min-fraction-digits"],1,ot)))return null;var u=null;return r["max-fraction-digits"]&&!(u=n.parse(r["max-fraction-digits"],1,ot))?null:new e(i,a,o,s,l,u)}}]),e}(),ti={"==":Xn,"!=":Kn,">":Jn,"<":Yn,">=":$n,"<=":Qn,array:jt,at:Fn,boolean:jt,case:Un,coalesce:Ln,collator:Xt,format:Ht,image:Vt,in:jn,"index-of":Hn,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:function(){function e(t){_classCallCheck(this,e),this.type=ot,this.input=t}return _createClass(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Bt("Expected value to be of type string or array, but found ".concat(vt(Dt(t))," instead."))}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,n){if(2!==t.length)return n.error("Expected 1 argument, but found ".concat(t.length-1," instead."));var i=n.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?n.error("Expected argument of type string or array, but found ".concat(vt(i.type)," instead.")):new e(i):null}}]),e}(),let:Bn,literal:Lt,match:Vn,number:jt,"number-format":ei,object:jt,slice:qn,step:_n,string:jt,"to-boolean":qt,"to-color":qt,"to-number":qt,"to-string":qt,var:vn,within:dn};function ni(e,t){var n=_slicedToArray(t,4),i=n[0],r=n[1],a=n[2],o=n[3];i=i.evaluate(e),r=r.evaluate(e),a=a.evaluate(e);var s=o?o.evaluate(e):1,l=Ot(i,r,a,s);if(l)throw new Bt(l);return new Pt(i/255*s,r/255*s,a/255*s,s)}function ii(e,t){return e in t}function ri(e,t){var n=t[e];return void 0===n?null:n}function ai(e){return{type:e}}Zt.register(ti,{error:[{kind:"error"},[st],function(e,t){var n=_slicedToArray(t,1)[0];throw new Bt(n.evaluate(e))}],typeof:[st,[ht],function(e,t){return vt(Dt(_slicedToArray(t,1)[0].evaluate(e)))}],"to-rgba":[mt(ot,4),[ut],function(e,t){return _slicedToArray(t,1)[0].evaluate(e).toArray()}],rgb:[ut,[ot,ot,ot],ni],rgba:[ut,[ot,ot,ot,ot],ni],has:{type:lt,overloads:[[[st],function(e,t){return ii(_slicedToArray(t,1)[0].evaluate(e),e.properties())}],[[st,ct],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return ii(i.evaluate(e),r.evaluate(e))}]]},get:{type:ht,overloads:[[[st],function(e,t){return ri(_slicedToArray(t,1)[0].evaluate(e),e.properties())}],[[st,ct],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return ri(i.evaluate(e),r.evaluate(e))}]]},"feature-state":[ht,[st],function(e,t){return ri(_slicedToArray(t,1)[0].evaluate(e),e.featureState||{})}],properties:[ct,[],function(e){return e.properties()}],"geometry-type":[st,[],function(e){return e.geometryType()}],id:[ht,[],function(e){return e.id()}],zoom:[ot,[],function(e){return e.globals.zoom}],pitch:[ot,[],function(e){return e.globals.pitch||0}],"distance-from-center":[ot,[],function(e){return e.distanceFromCenter()}],"heatmap-density":[ot,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ot,[],function(e){return e.globals.lineProgress||0}],"sky-radial-progress":[ot,[],function(e){return e.globals.skyRadialProgress||0}],accumulated:[ht,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[ot,ai(ot),function(e,t){var n,i=0,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){i+=n.value.evaluate(e)}}catch(a){r.e(a)}finally{r.f()}return i}],"*":[ot,ai(ot),function(e,t){var n,i=1,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){i*=n.value.evaluate(e)}}catch(a){r.e(a)}finally{r.f()}return i}],"-":{type:ot,overloads:[[[ot,ot],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return i.evaluate(e)-r.evaluate(e)}],[[ot],function(e,t){return-_slicedToArray(t,1)[0].evaluate(e)}]]},"/":[ot,[ot,ot],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return i.evaluate(e)/r.evaluate(e)}],"%":[ot,[ot,ot],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return i.evaluate(e)%r.evaluate(e)}],ln2:[ot,[],function(){return Math.LN2}],pi:[ot,[],function(){return Math.PI}],e:[ot,[],function(){return Math.E}],"^":[ot,[ot,ot],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return Math.pow(i.evaluate(e),r.evaluate(e))}],sqrt:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.sqrt(n.evaluate(e))}],log10:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.log(n.evaluate(e))/Math.LN10}],ln:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.log(n.evaluate(e))}],log2:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.log(n.evaluate(e))/Math.LN2}],sin:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.sin(n.evaluate(e))}],cos:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.cos(n.evaluate(e))}],tan:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.tan(n.evaluate(e))}],asin:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.asin(n.evaluate(e))}],acos:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.acos(n.evaluate(e))}],atan:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.atan(n.evaluate(e))}],min:[ot,ai(ot),function(e,t){return Math.min.apply(Math,_toConsumableArray(t.map((function(t){return t.evaluate(e)}))))}],max:[ot,ai(ot),function(e,t){return Math.max.apply(Math,_toConsumableArray(t.map((function(t){return t.evaluate(e)}))))}],abs:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.abs(n.evaluate(e))}],round:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0].evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.floor(n.evaluate(e))}],ceil:[ot,[ot],function(e,t){var n=_slicedToArray(t,1)[0];return Math.ceil(n.evaluate(e))}],"filter-==":[lt,[st,ht],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return e.properties()[i.value]===r.value}],"filter-id-==":[lt,[ht],function(e,t){var n=_slicedToArray(t,1)[0];return e.id()===n.value}],"filter-type-==":[lt,[st],function(e,t){var n=_slicedToArray(t,1)[0];return e.geometryType()===n.value}],"filter-<":[lt,[st,ht],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1],a=e.properties()[i.value],o=r.value;return typeof a==typeof o&&a<o}],"filter-id-<":[lt,[ht],function(e,t){var n=_slicedToArray(t,1)[0],i=e.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[lt,[st,ht],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1],a=e.properties()[i.value],o=r.value;return typeof a==typeof o&&a>o}],"filter-id->":[lt,[ht],function(e,t){var n=_slicedToArray(t,1)[0],i=e.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[lt,[st,ht],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1],a=e.properties()[i.value],o=r.value;return typeof a==typeof o&&a<=o}],"filter-id-<=":[lt,[ht],function(e,t){var n=_slicedToArray(t,1)[0],i=e.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[lt,[st,ht],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1],a=e.properties()[i.value],o=r.value;return typeof a==typeof o&&a>=o}],"filter-id->=":[lt,[ht],function(e,t){var n=_slicedToArray(t,1)[0],i=e.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[lt,[ht],function(e,t){return _slicedToArray(t,1)[0].value in e.properties()}],"filter-has-id":[lt,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[lt,[mt(st)],function(e,t){return _slicedToArray(t,1)[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[lt,[mt(ht)],function(e,t){return _slicedToArray(t,1)[0].value.indexOf(e.id())>=0}],"filter-in-small":[lt,[st,mt(ht)],function(e,t){var n=_slicedToArray(t,2),i=n[0];return n[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[lt,[st,mt(ht)],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return function(e,t,n,i){for(;n<=i;){var r=n+i>>1;if(t[r]===e)return!0;t[r]>e?i=r-1:n=r+1}return!1}(e.properties()[i.value],r.value,0,r.value.length-1)}],all:{type:lt,overloads:[[[lt,lt],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return i.evaluate(e)&&r.evaluate(e)}],[ai(lt),function(e,t){var n,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){if(!n.value.evaluate(e))return!1}}catch(r){i.e(r)}finally{i.f()}return!0}]]},any:{type:lt,overloads:[[[lt,lt],function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return i.evaluate(e)||r.evaluate(e)}],[ai(lt),function(e,t){var n,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){if(n.value.evaluate(e))return!0}}catch(r){i.e(r)}finally{i.f()}return!1}]]},"!":[lt,[lt],function(e,t){return!_slicedToArray(t,1)[0].evaluate(e)}],"is-supported-script":[lt,[st],function(e,t){var n=_slicedToArray(t,1)[0],i=e.globals&&e.globals.isSupportedScript;return!i||i(n.evaluate(e))}],upcase:[st,[st],function(e,t){return _slicedToArray(t,1)[0].evaluate(e).toUpperCase()}],downcase:[st,[st],function(e,t){return _slicedToArray(t,1)[0].evaluate(e).toLowerCase()}],concat:[st,ai(ht),function(e,t){return t.map((function(t){return zt(t.evaluate(e))})).join("")}],"resolved-locale":[st,[dt],function(e,t){return _slicedToArray(t,1)[0].evaluate(e).resolvedLocale()}]});var oi=ti;function si(e){return{result:"success",value:e}}function li(e){return{result:"error",value:e}}function ui(e){return"data-driven"===e["property-type"]}function ci(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function hi(e){return!!e.expression&&e.expression.interpolated}function di(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function fi(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function pi(e){return e}function mi(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function vi(e,t,n,i,r){return mi(typeof n===r?i[n]:void 0,e.default,t.default)}function gi(e,t,n){if("number"!==di(n))return mi(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];var r=yn(e.stops.map((function(e){return e[0]})),n);return e.stops[r][1]}function yi(e,t,n){var i=void 0!==e.base?e.base:1;if("number"!==di(n))return mi(e.default,t.default);var r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];var a=yn(e.stops.map((function(e){return e[0]})),n),o=function(e,t,n,i){var r=i-n,a=e-n;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}(n,i,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],u=bn[t.type]||pi;if(e.colorSpace&&"rgb"!==e.colorSpace){var c=Nn[e.colorSpace];u=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=s.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==i&&void 0!==r)return u(i,r,o)}}:u(s,l,o)}function _i(e,t,n){return"color"===t.type?n=Pt.parse(n):"formatted"===t.type?n=At.fromString(n.toString()):"resolvedImage"===t.type?n=Rt.fromString(n.toString()):di(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0),mi(n,e.default,t.default)}var xi=function(){function e(t,n){_classCallCheck(this,e),this.expression=t,this._warningHistory={},this._evaluator=new Wt,this._defaultValue=n?function(e){return"color"===e.type&&(fi(e.default)||Array.isArray(e.default))?new Pt(0,0,0,0):"color"===e.type?Pt.parse(e.default)||null:void 0===e.default?null:e.default}(n):null,this._enumValues=n&&"enum"===n.type?n.values:null}return _createClass(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,n,i,r,a,o,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)}},{key:"evaluate",value:function(e,t,n,i,r,a,o,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null;try{var l=this.expression.evaluate(this._evaluator);if(null==l||"number"==typeof l&&l!=l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new Bt("Expected value to be one of ".concat(Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", "),", but found ").concat(JSON.stringify(l)," instead."));return l}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}]),e}();function bi(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in oi}function wi(e,t){var n=new gn(oi,[],t?function(e){var t={color:ut,string:st,number:ot,enum:st,boolean:lt,formatted:ft,resolvedImage:pt};return"array"===e.type?mt(t[e.value]||ht,e.length):t[e.type]}(t):void 0),i=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?si(new xi(i,t)):li(n.errors)}var ki=function(){function e(t,n){_classCallCheck(this,e),this.kind=t,this._styleExpression=n,this.isStateDependent="constant"!==t&&!pn(n.expression)}return _createClass(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,a)}},{key:"evaluate",value:function(e,t,n,i,r,a){return this._styleExpression.evaluate(e,t,n,i,r,a)}}]),e}(),Ci=function(){function e(t,n,i,r){_classCallCheck(this,e),this.kind=t,this.zoomStops=i,this._styleExpression=n,this.isStateDependent="camera"!==t&&!pn(n.expression),this.interpolationType=r}return _createClass(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,a)}},{key:"evaluate",value:function(e,t,n,i,r,a){return this._styleExpression.evaluate(e,t,n,i,r,a)}},{key:"interpolationFactor",value:function(e,t,n){return this.interpolationType?zn.interpolationFactor(this.interpolationType,e,t,n):0}}]),e}();function Si(e,t){if("error"===(e=wi(e,t)).result)return e;var n=e.value.expression,i=fn(n);if(!i&&!ui(t))return li([new it("","data expressions not supported")]);var r=mn(n,["zoom","pitch","distance-from-center"]);if(!r&&!ci(t))return li([new it("","zoom expressions not supported")]);var a=function e(t){var n=null;if(t instanceof Bn)n=e(t.result);else if(t instanceof Ln){var i,r=_createForOfIteratorHelper(t.args);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(n=e(a))break}}catch(o){r.e(o)}finally{r.f()}}else(t instanceof _n||t instanceof zn)&&t.input instanceof Zt&&"zoom"===t.input.name&&(n=t);return n instanceof it||t.eachChild((function(t){var i=e(t);i instanceof it?n=i:!n&&i?n=new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new it("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return a||r?a instanceof it?li([a]):a instanceof zn&&!hi(t)?li([new it("",'"interpolate" expressions cannot be used with this property')]):si(a?new Ci(i?"camera":"composite",e.value,a.labels,a instanceof zn?a.interpolation:void 0):new ki(i?"constant":"source",e.value)):li([new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}var Ti=function(){function e(t,n){_classCallCheck(this,e),this._parameters=t,this._specification=n,et(this,function e(t,n){var i,r,a,o="color"===n.type,s=t.stops&&"object"==typeof t.stops[0][0],l=s||!(s||void 0!==t.property),u=t.type||(hi(n)?"exponential":"interval");if(o&&((t=et({},t)).stops&&(t.stops=t.stops.map((function(e){return[e[0],Pt.parse(e[1])]}))),t.default=Pt.parse(t.default?t.default:n.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!Nn[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===u)i=yi;else if("interval"===u)i=gi;else if("categorical"===u){i=vi,r=Object.create(null);var c,h=_createForOfIteratorHelper(t.stops);try{for(h.s();!(c=h.n()).done;){var d=c.value;r[d[0]]=d[1]}}catch(C){h.e(C)}finally{h.f()}a=typeof t.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'.concat(u,'"'));i=_i}if(s){for(var f={},p=[],m=0;m<t.stops.length;m++){var v=t.stops[m],g=v[0].zoom;void 0===f[g]&&(f[g]={zoom:g,type:t.type,property:t.property,default:t.default,stops:[]},p.push(g)),f[g].stops.push([v[0].value,v[1]])}for(var y=[],_=0,x=p;_<x.length;_++){var b=x[_];y.push([f[b].zoom,e(f[b],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:zn.interpolationFactor.bind(void 0,w),zoomStops:y.map((function(e){return e[0]})),evaluate:function(e,i){var r=e.zoom;return yi({stops:y,base:t.base},n,r).evaluate(r,i)}}}if(l){var k="exponential"===u?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:zn.interpolationFactor.bind(void 0,k),zoomStops:t.stops.map((function(e){return e[0]})),evaluate:function(e){var o=e.zoom;return i(t,n,o,r,a)}}}return{kind:"source",evaluate:function(e,o){var s=o&&o.properties?o.properties[t.property]:void 0;return void 0===s?mi(t.default,n.default):i(t,n,s,r,a)}}}(this._parameters,this._specification))}return _createClass(e,null,[{key:"deserialize",value:function(t){return new e(t._parameters,t._specification)}},{key:"serialize",value:function(e){return{_parameters:e._parameters,_specification:e._specification}}}]),e}(),Ei=_createClass((function e(t,n,i,r){_classCallCheck(this,e),this.message=(t?t+": ":"")+i,r&&(this.identifier=r),null!=n&&n.__line__&&(this.line=n.__line__)}));function Pi(e){var t=e.key,n=e.value,i=e.valueSpec||{},r=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=[],l=di(n);if("object"!==l)return[new Ei(t,n,"object expected, ".concat(l," found"))];for(var u in n){var c=u.split(".")[0],h=void 0;r[c]?h=r[c]:i[c]?h=rr:r["*"]?h=r["*"]:i["*"]&&(h=rr),h?s=s.concat(h({key:(t?t+".":t)+u,value:n[u],valueSpec:i[c]||i["*"],style:a,styleSpec:o,object:n,objectKey:u},n)):s.push(new Ei(t,n[u],'unknown property "'.concat(u,'"')))}for(var d in i)r[d]||i[d].required&&void 0===i[d].default&&void 0===n[d]&&s.push(new Ei(t,n,'missing required property "'.concat(d,'"')));return s}function Mi(e){var t=e.value,n=e.valueSpec,i=e.style,r=e.styleSpec,a=e.key,o=e.arrayElementValidator||rr;if("array"!==di(t))return[new Ei(a,t,"array expected, ".concat(di(t)," found"))];if(n.length&&t.length!==n.length)return[new Ei(a,t,"array length ".concat(n.length," expected, length ").concat(t.length," found"))];if(n["min-length"]&&t.length<n["min-length"])return[new Ei(a,t,"array length at least ".concat(n["min-length"]," expected, length ").concat(t.length," found"))];var s={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};r.$version<7&&(s.function=n.function),"object"===di(n.value)&&(s=n.value);for(var l=[],u=0;u<t.length;u++)l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:i,styleSpec:r,key:"".concat(a,"[").concat(u,"]")}));return l}function Ii(e){var t=e.key,n=e.value,i=e.valueSpec,r=di(n);if("number"===r&&n!=n&&(r="NaN"),"number"!==r)return[new Ei(t,n,"number expected, ".concat(r," found"))];if("minimum"in i){var a=i.minimum;if("array"===di(i.minimum)&&(a=i.minimum[e.arrayIndex]),n<a)return[new Ei(t,n,"".concat(n," is less than the minimum value ").concat(a))]}if("maximum"in i){var o=i.maximum;if("array"===di(i.maximum)&&(o=i.maximum[e.arrayIndex]),n>o)return[new Ei(t,n,"".concat(n," is greater than the maximum value ").concat(o))]}return[]}function Ai(e){var t,n,i,r=e.valueSpec,a=tt(e.value.type),o={},s="categorical"!==a&&void 0===e.value.property,l=!s,u="array"===di(e.value.stops)&&"array"===di(e.value.stops[0])&&"object"===di(e.value.stops[0][0]),c=Pi({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===a)return[new Ei(e.key,e.value,'identity function may not have a "stops" property')];var t=[],n=e.value;return t=t.concat(Mi({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===di(n)&&0===n.length&&t.push(new Ei(e.key,n,"array must have at least one stop")),t},default:function(e){return rr({key:e.key,value:e.value,valueSpec:r,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===a&&s&&c.push(new Ei(e.key,e.value,'missing required property "property"')),"identity"===a||e.value.stops||c.push(new Ei(e.key,e.value,'missing required property "stops"')),"exponential"===a&&e.valueSpec.expression&&!hi(e.valueSpec)&&c.push(new Ei(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!ui(e.valueSpec)?c.push(new Ei(e.key,e.value,"property functions not supported")):s&&!ci(e.valueSpec)&&c.push(new Ei(e.key,e.value,"zoom functions not supported"))),"categorical"!==a&&!u||void 0!==e.value.property||c.push(new Ei(e.key,e.value,'"property" property is required')),c;function h(e){var t=[],a=e.value,s=e.key;if("array"!==di(a))return[new Ei(s,a,"array expected, ".concat(di(a)," found"))];if(2!==a.length)return[new Ei(s,a,"array length 2 expected, length ".concat(a.length," found"))];if(u){if("object"!==di(a[0]))return[new Ei(s,a,"object expected, ".concat(di(a[0])," found"))];if(void 0===a[0].zoom)return[new Ei(s,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new Ei(s,a,"object stop key must have value")];var l=tt(a[0].zoom);if("number"!=typeof l)return[new Ei(s,a[0].zoom,"stop zoom values must be numbers")];if(i&&i>l)return[new Ei(s,a[0].zoom,"stop zoom values must appear in ascending order")];l!==i&&(i=l,n=void 0,o={}),t=t.concat(Pi({key:s+"[0]",value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Ii,value:d}}))}else t=t.concat(d({key:s+"[0]",value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a));return bi(nt(a[1]))?t.concat([new Ei(s+"[1]",a[1],"expressions are not allowed in function stops.")]):t.concat(rr({key:s+"[1]",value:a[1],valueSpec:r,style:e.style,styleSpec:e.styleSpec}))}function d(e,i){var s=di(e.value),l=tt(e.value),u=null!==e.value?e.value:i;if(t){if(s!==t)return[new Ei(e.key,u,"".concat(s," stop domain type must match previous stop domain type ").concat(t))]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new Ei(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==a){var c="number expected, ".concat(s," found");return ui(r)&&void 0===a&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ei(e.key,u,c)]}return"categorical"!==a||"number"!==s||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==a&&"number"===s&&"number"==typeof l&&"number"==typeof n&&void 0!==n&&l<n?[new Ei(e.key,u,"stop domain values must appear in ascending order")]:(n=l,"categorical"===a&&l in o?[new Ei(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new Ei(e.key,u,"integer expected, found "+String(l))]}}function Ri(e){var t=("property"===e.expressionContext?Si:wi)(nt(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new Ei("".concat(e.key).concat(t.key),e.value,t.message)}));var n=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!n.outputDefined())return[new Ei(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!pn(n))return[new Ei(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return function e(t,n){var i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression){var r,a=_createForOfIteratorHelper(n.valueSpec.expression.parameters);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.delete(o)}}catch(l){a.e(l)}finally{a.f()}}if(0===i.size)return[];var s=[];return t instanceof Zt&&i.has(t.name)?[new Ei(n.key,n.value,'["'.concat(t.name,'"] expression is not supported in a filter for a ').concat(n.object.type," layer with id: ").concat(n.object.id))]:(t.eachChild((function(t){s.push.apply(s,_toConsumableArray(e(t,n)))})),s)}(n,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!mn(n,["zoom","feature-state"]))return[new Ei(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!fn(n))return[new Ei(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oi(e){var t=e.key,n=e.value,i=e.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(tt(n))&&r.push(new Ei(t,n,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(i.values).indexOf(tt(n))&&r.push(new Ei(t,n,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),r}function Ni(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":var t,n=_createForOfIteratorHelper(e.slice(1));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!Ni(i)&&"boolean"!=typeof i)return!1}}catch(r){n.e(r)}finally{n.f()}return!0;default:return!0}}function Di(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill";if(null==e)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};Ni(e)||(e=ji(e));var n=e,i=!0;try{i=function(e){if(!zi(e))return e;var t=nt(e);return function e(t){var n=!1,i=[];if("case"===t[0]){for(var r=1;r<t.length-1;r+=2)n=n||zi(t[r]),i.push(t[r+1]);i.push(t[t.length-1])}else if("match"===t[0]){n=n||zi(t[1]);for(var a=2;a<t.length-1;a+=2)i.push(t[a+1]);i.push(t[t.length-1])}else if("step"===t[0]){n=n||zi(t[1]);for(var o=1;o<t.length-1;o+=2)i.push(t[o+1])}n&&(t.length=0,t.push.apply(t,["any"].concat(i)));for(var s=1;s<t.length;s++)e(t[s])}(t),t=function e(t){if(!Array.isArray(t))return t;var n=function(e){if(Li.has(e[0]))for(var t=1;t<e.length;t++)if(zi(e[t]))return!0;return e}(t);return!0===n?n:n.map((function(t){return e(t)}))}(t)}(n)}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(n,null,2),"\n        "))}var r=$e["filter_"+t],a=wi(i,r),o=null;if("error"===a.result)throw new Error(a.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));o=function(e,t,n){return a.value.evaluate(e,t,{},n)};var s=null,l=null;if(i!==n){var u=wi(n,r);if("error"===u.result)throw new Error(u.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));s=function(e,t,n,i,r){return u.value.evaluate(e,t,{},n,void 0,void 0,i,r)},l=!fn(u.value.expression)}return{filter:o,dynamicFilter:s||void 0,needGeometry:Fi(i),needFeature:!!l}}function zi(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;for(var t,n=1;n<e.length;n++)if(zi(e[n]))return!0;return!1}var Li=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Bi(e,t){return e<t?-1:e>t?1:0}function Fi(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var t=1;t<e.length;t++)if(Fi(e[t]))return!0;return!1}function ji(e){if(!e)return!0;var t,n=e[0];return e.length<=1?"any"!==n:"=="===n?Hi(e[1],e[2],"=="):"!="===n?qi(Hi(e[1],e[2],"==")):"<"===n||">"===n||"<="===n||">="===n?Hi(e[1],e[2],n):"any"===n?(t=e.slice(1),["any"].concat(t.map(ji))):"all"===n?["all"].concat(e.slice(1).map(ji)):"none"===n?["all"].concat(e.slice(1).map(ji).map(qi)):"in"===n?Vi(e[1],e.slice(2)):"!in"===n?qi(Vi(e[1],e.slice(2))):"has"===n?Ui(e[1]):"!has"===n?qi(Ui(e[1])):"within"!==n||e}function Hi(e,t,n){switch(e){case"$type":return["filter-type-"+n,t];case"$id":return["filter-id-"+n,t];default:return["filter-"+n,e,t]}}function Vi(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(Bi)]]:["filter-in-small",e,["literal",t]]}}function Ui(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function qi(e){return["!",e]}function Gi(e){return Ni(nt(e.value))?Ri(et({},e,{expressionContext:"filter",valueSpec:e.styleSpec["filter_"+(e.layerType||"fill")]})):function e(t){var n=t.value,i=t.key;if("array"!==di(n))return[new Ei(i,n,"array expected, ".concat(di(n)," found"))];var r,a=t.styleSpec,o=[];if(n.length<1)return[new Ei(i,n,"filter array must have at least 1 element")];switch(o=o.concat(Oi({key:i+"[0]",value:n[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),tt(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===tt(n[1])&&o.push(new Ei(i,n,'"$type" cannot be use with operator "'.concat(n[0],'"')));case"==":case"!=":3!==n.length&&o.push(new Ei(i,n,'filter array for operator "'.concat(n[0],'" must have 3 elements')));case"in":case"!in":n.length>=2&&("string"!==(r=di(n[1]))&&o.push(new Ei(i+"[1]",n[1],"string expected, ".concat(r," found"))));for(var s=2;s<n.length;s++)r=di(n[s]),"$type"===tt(n[1])?o=o.concat(Oi({key:"".concat(i,"[").concat(s,"]"),value:n[s],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new Ei("".concat(i,"[").concat(s,"]"),n[s],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(var l=1;l<n.length;l++)o=o.concat(e({key:"".concat(i,"[").concat(l,"]"),value:n[l],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=di(n[1]),2!==n.length?o.push(new Ei(i,n,'filter array for "'.concat(n[0],'" operator must have 2 elements'))):"string"!==r&&o.push(new Ei(i+"[1]",n[1],"string expected, ".concat(r," found")));break;case"within":r=di(n[1]),2!==n.length?o.push(new Ei(i,n,'filter array for "'.concat(n[0],'" operator must have 2 elements'))):"object"!==r&&o.push(new Ei(i+"[1]",n[1],"object expected, ".concat(r," found")))}return o}(e)}function Wi(e,t){var n=e.key,i=e.style,r=e.styleSpec,a=e.value,o=e.objectKey,s=r["".concat(t,"_").concat(e.layerType)];if(!s)return[];var l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return rr({key:n,value:a,valueSpec:r.transition,style:i,styleSpec:r});var u,c=e.valueSpec||s[o];if(!c)return[new Ei(n,a,'unknown property "'.concat(o,'"'))];if("string"===di(a)&&ui(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(a))){var h='`{ "type": "identity", "property": '.concat(u?JSON.stringify(u[1]):'"_"'," }`");return[new Ei(n,a,'"'.concat(o,'" does not support interpolation syntax\nUse an identity property function instead: ').concat(h,"."))]}var d=[];return"symbol"===e.layerType&&("text-field"===o&&i&&!i.glyphs&&d.push(new Ei(n,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&fi(nt(a))&&"identity"===tt(a.type)&&d.push(new Ei(n,a,'"text-font" does not support identity functions'))),d.concat(rr({key:e.key,value:a,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:t,propertyKey:o}))}function Zi(e){return Wi(e,"paint")}function Xi(e){return Wi(e,"layout")}function Ki(e){var t=[],n=e.value,i=e.key,r=e.style,a=e.styleSpec;n.type||n.ref||t.push(new Ei(i,n,'either "type" or "ref" is required'));var o,s=tt(n.type),l=tt(n.ref);if(n.id)for(var u=tt(n.id),c=0;c<e.arrayIndex;c++){var h=r.layers[c];tt(h.id)===u&&t.push(new Ei(i,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(h.id.__line__)))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(e){e in n&&t.push(new Ei(i,n[e],'"'.concat(e,'" is prohibited for ref layers')))})),r.layers.forEach((function(e){tt(e.id)===l&&(o=e)})),o?o.ref?t.push(new Ei(i,n.ref,"ref cannot reference another ref layer")):s=tt(o.type):"string"==typeof l&&t.push(new Ei(i,n.ref,'ref layer "'.concat(l,'" not found')));else if("background"!==s&&"sky"!==s)if(n.source){var d=r.sources&&r.sources[n.source],f=d&&tt(d.type);d?"vector"===f&&"raster"===s?t.push(new Ei(i,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster"===f&&"raster"!==s?t.push(new Ei(i,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==f||n["source-layer"]?"raster-dem"===f&&"hillshade"!==s?t.push(new Ei(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===f&&d.lineMetrics||t.push(new Ei(i,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new Ei(i,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):t.push(new Ei(i,n.source,'source "'.concat(n.source,'" not found')))}else t.push(new Ei(i,n,'missing required property "source"'));return t=t.concat(Pi({key:i,value:n,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return rr({key:i+".type",value:n.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:n,objectKey:"type"})},filter:function(e){return Gi(et({layerType:s},e))},layout:function(e){return Pi({layer:n,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Xi(et({layerType:s},e))}}})},paint:function(e){return Pi({layer:n,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Zi(et({layerType:s},e))}}})}}}))}function Yi(e){var t=e.value,n=e.key,i=di(t);return"string"!==i?[new Ei(n,t,"string expected, ".concat(i," found"))]:[]}var Ji={promoteId:function(e){var t=e.key,n=e.value;if("string"===di(n))return Yi({key:t,value:n});var i=[];for(var r in n)i.push.apply(i,_toConsumableArray(Yi({key:"".concat(t,".").concat(r),value:n[r]})));return i}};function Qi(e){var t=e.value,n=e.key,i=e.styleSpec,r=e.style;if(!t.type)return[new Ei(n,t,'"type" is required')];var a,o=tt(t.type);switch(o){case"vector":case"raster":case"raster-dem":return a=Pi({key:n,value:t,valueSpec:i["source_"+o.replace("-","_")],style:e.style,styleSpec:i,objectElementValidators:Ji});case"geojson":if(a=Pi({key:n,value:t,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:Ji}),t.cluster)for(var s in t.clusterProperties){var l,u,c=_slicedToArray(t.clusterProperties[s],2),h=c[0],d=c[1],f="string"==typeof h?[h,["accumulated"],["get",s]]:h;(l=a).push.apply(l,_toConsumableArray(Ri({key:"".concat(n,".").concat(s,".map"),value:d,expressionContext:"cluster-map"}))),(u=a).push.apply(u,_toConsumableArray(Ri({key:"".concat(n,".").concat(s,".reduce"),value:f,expressionContext:"cluster-reduce"})))}return a;case"video":return Pi({key:n,value:t,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return Pi({key:n,value:t,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new Ei(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oi({key:n+".type",value:t.type,valueSpec:{values:$i(i)},style:r,styleSpec:i})}}function $i(e){return e.source.reduce((function(t,n){var i=e[n];return"enum"===i.type.type&&(t=t.concat(Object.keys(i.type.values))),t}),[])}function er(e){var t=e.value,n=e.styleSpec,i=n.light,r=e.style,a=[],o=di(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Ei("light",t,"object expected, ".concat(o," found"))]);for(var s in t){var l=s.match(/^(.*)-transition$/);a=a.concat(l&&i[l[1]]&&i[l[1]].transition?rr({key:s,value:t[s],valueSpec:n.transition,style:r,styleSpec:n}):i[s]?rr({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}):[new Ei(s,t[s],'unknown property "'.concat(s,'"'))])}return a}function tr(e){var t=e.value,n=e.key,i=e.style,r=e.styleSpec,a=r.terrain,o=[],s=di(t);if(void 0===t)return o;if("object"!==s)return o=o.concat([new Ei("terrain",t,"object expected, ".concat(s," found"))]);for(var l in t){var u=l.match(/^(.*)-transition$/);o=o.concat(u&&a[u[1]]&&a[u[1]].transition?rr({key:l,value:t[l],valueSpec:r.transition,style:i,styleSpec:r}):a[l]?rr({key:l,value:t[l],valueSpec:a[l],style:i,styleSpec:r}):[new Ei(l,t[l],'unknown property "'.concat(l,'"'))])}if(t.source){var c=i.sources&&i.sources[t.source],h=c&&tt(c.type);c?"raster-dem"!==h&&o.push(new Ei(n,t.source,"terrain cannot be used with a source of type ".concat(String(h),', it only be used with a "raster-dem" source type'))):o.push(new Ei(n,t.source,'source "'.concat(t.source,'" not found')))}else o.push(new Ei(n,t,'terrain is missing required property "source"'));return o}function nr(e){var t=e.value,n=e.style,i=e.styleSpec,r=i.fog,a=[],o=di(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Ei("fog",t,"object expected, ".concat(o," found"))]);for(var s in t){var l=s.match(/^(.*)-transition$/);a=a.concat(l&&r[l[1]]&&r[l[1]].transition?rr({key:s,value:t[s],valueSpec:i.transition,style:n,styleSpec:i}):r[s]?rr({key:s,value:t[s],valueSpec:r[s],style:n,styleSpec:i}):[new Ei(s,t[s],'unknown property "'.concat(s,'"'))])}return a}var ir={"*":function(){return[]},array:Mi,boolean:function(e){var t=e.value,n=e.key,i=di(t);return"boolean"!==i?[new Ei(n,t,"boolean expected, ".concat(i," found"))]:[]},number:Ii,color:function(e){var t=e.key,n=e.value,i=di(n);return"string"!==i?[new Ei(t,n,"color expected, ".concat(i," found"))]:null===bt(n)?[new Ei(t,n,'color expected, "'.concat(n,'" found'))]:[]},enum:Oi,filter:Gi,function:Ai,layer:Ki,object:Pi,source:Qi,light:er,terrain:tr,fog:nr,string:Yi,formatted:function(e){return 0===Yi(e).length?[]:Ri(e)},resolvedImage:function(e){return 0===Yi(e).length?[]:Ri(e)},projection:function(e){var t=e.value,n=e.styleSpec,i=n.projection,r=e.style,a=[],o=di(t);if("object"===o)for(var s in t)a=a.concat(rr({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}));else"string"!==o&&(a=a.concat([new Ei("projection",t,"object or string expected, ".concat(o," found"))]));return a}};function rr(e){var t=e.value,n=e.valueSpec,i=e.styleSpec;return n.expression&&fi(tt(t))?Ai(e):n.expression&&bi(nt(t))?Ri(e):n.type&&ir[n.type]?ir[n.type](e):Pi(et({},e,{valueSpec:n.type?i[n.type]:n}))}function ar(e){var t=e.value,n=e.key,i=Yi(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new Ei(n,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new Ei(n,t,'"glyphs" url must include a "{range}" token'))),i}function or(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$e;return ur(rr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ar,"*":function(){return[]}}}))}var sr=function(e){return ur(Zi(e))},lr=function(e){return ur(Xi(e))};function ur(e){return e.slice().sort((function(e,t){return e.line&&t.line?e.line-t.line:0}))}function cr(e,t){var n=!1;if(t&&t.length){var i,r=_createForOfIteratorHelper(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;e.fire(new Je(new Error(a.message))),n=!0}}catch(o){r.e(o)}finally{r.f()}}return n}var hr=dr;function dr(e,t,n){var i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(n=r[2]);for(var a=0;a<this.d*this.d;a++){var o=r[3+a],s=r[3+a+1];i.push(o===s?null:r.subarray(o,s))}var l=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*n;for(var u=0;u<this.d*this.d;u++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;var c=n/t*e;this.min=-c,this.max=e+c}dr.prototype.insert=function(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},dr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},dr.prototype._insertCell=function(e,t,n,i,r,a){this.cells[r].push(a)},dr.prototype.query=function(e,t,n,i,r){var a=this.min,o=this.max;if(e<=a&&t<=a&&o<=n&&o<=i&&!r)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,n,i,this._queryCell,s,{},r),s},dr.prototype._queryCell=function(e,t,n,i,r,a,o,s){var l=this.cells[r];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===o[d]){var f=4*d;(s?s(c[f+0],c[f+1],c[f+2],c[f+3]):e<=c[f+2]&&t<=c[f+3]&&n>=c[f+0]&&i>=c[f+1])?(o[d]=!0,a.push(u[d])):o[d]=!1}}},dr.prototype._forEachCell=function(e,t,n,i,r,a,o,s){for(var l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(n),h=this._convertToCellCoord(i),d=l;d<=c;d++)for(var f=u;f<=h;f++){var p=this.d*f+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(f),this._convertFromCellCoord(d+1),this._convertFromCellCoord(f+1)))&&r.call(this,e,t,n,i,p,a,o,s))return}},dr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},dr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},dr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(t+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var a=t,o=0;o<e.length;o++){var s=e[o];r[3+o]=a,r.set(s,a),a+=s.length}return r[3+e.length]=a,r.set(this.keys,a),r[3+e.length+1]=a+=this.keys.length,r.set(this.bboxes,a),a+=this.bboxes.length,r.buffer};var fr=d(hr),pr={};function mr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),pr[t]={klass:e,omit:n.omit||[]}}for(var vr in mr(Object,"Object"),fr.serialize=function(e,t){var n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}},fr.deserialize=function(e){return new fr(e.buffer)},Object.defineProperty(fr,"name",{value:"Grid"}),mr(fr,"Grid"),mr(Pt,"Color"),mr(Error,"Error"),mr(ue,"AJAXError"),mr(Rt,"ResolvedImage"),mr(Ti,"StylePropertyFunction"),mr(xi,"StyleExpression",{omit:["_evaluator"]}),mr(Ci,"ZoomDependentExpression"),mr(ki,"ZoomConstantExpression"),mr(Zt,"CompoundExpression",{omit:["_evaluate"]}),oi)pr[oi[vr]._classRegistryKey]||mr(oi[vr],"Expression"+vr);function gr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function yr(e){return r.ImageBitmap&&e instanceof r.ImageBitmap}function _r(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(gr(e)||yr(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var n=e;return t&&t.push(n.buffer),n}if(e instanceof r.ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){var i,a=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push(_r(s,t))}}catch(d){o.e(d)}finally{o.f()}return a}if("object"==typeof e){var l=e.constructor,u=l._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class "+u);var c=l.serialize?l.serialize(e,t):{};if(!l.serialize){for(var h in e)e.hasOwnProperty(h)&&(pr[u].omit.indexOf(h)>=0||(c[h]=_r(e[h],t)));e instanceof Error&&(c.message=e.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(c.$name=u),c}throw new Error("can't serialize object of type "+typeof e)}function xr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||gr(e)||yr(e)||ArrayBuffer.isView(e)||e instanceof r.ImageData)return e;if(Array.isArray(e))return e.map(xr);if("object"==typeof e){var t=e.$name||"Object",n=pr[t].klass;if(!n)throw new Error("can't deserialize unregistered class "+t);if(n.deserialize)return n.deserialize(e);for(var i=Object.create(n.prototype),a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];"$name"!==s&&(i[s]=xr(e[s]))}return i}throw new Error("can't deserialize object of type "+typeof e)}var br=function(e){return e>=1536&&e<=1791},wr=function(e){return e>=1872&&e<=1919},kr=function(e){return e>=2208&&e<=2303},Cr=function(e){return e>=11904&&e<=12031},Sr=function(e){return e>=12032&&e<=12255},Tr=function(e){return e>=12272&&e<=12287},Er=function(e){return e>=12288&&e<=12351},Pr=function(e){return e>=12352&&e<=12447},Mr=function(e){return e>=12448&&e<=12543},Ir=function(e){return e>=12544&&e<=12591},Ar=function(e){return e>=12704&&e<=12735},Rr=function(e){return e>=12736&&e<=12783},Or=function(e){return e>=12784&&e<=12799},Nr=function(e){return e>=12800&&e<=13055},Dr=function(e){return e>=13056&&e<=13311},zr=function(e){return e>=13312&&e<=19903},Lr=function(e){return e>=19968&&e<=40959},Br=function(e){return e>=40960&&e<=42127},Fr=function(e){return e>=42128&&e<=42191},jr=function(e){return e>=44032&&e<=55215},Hr=function(e){return e>=63744&&e<=64255},Vr=function(e){return e>=64336&&e<=65023},Ur=function(e){return e>=65040&&e<=65055},qr=function(e){return e>=65072&&e<=65103},Gr=function(e){return e>=65104&&e<=65135},Wr=function(e){return e>=65136&&e<=65279},Zr=function(e){return e>=65280&&e<=65519};function Xr(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){if(Yr(t.value.charCodeAt(0)))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}function Kr(e){return!(br(e)||wr(e)||kr(e)||Vr(e)||Wr(e))}function Yr(e){return!(746!==e&&747!==e&&(e<4352||!(Ar(e)||Ir(e)||qr(e)&&!(e>=65097&&e<=65103)||Hr(e)||Dr(e)||Cr(e)||Rr(e)||!(!Er(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||zr(e)||Lr(e)||Nr(e)||function(e){return e>=12592&&e<=12687}(e)||function(e){return e>=43360&&e<=43391}(e)||function(e){return e>=55216&&e<=55295}(e)||function(e){return e>=4352&&e<=4607}(e)||jr(e)||Pr(e)||Tr(e)||function(e){return e>=12688&&e<=12703}(e)||Sr(e)||Or(e)||Mr(e)&&12540!==e||!(!Zr(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Gr(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||function(e){return e>=5120&&e<=5759}(e)||function(e){return e>=6320&&e<=6399}(e)||Ur(e)||function(e){return e>=19904&&e<=19967}(e)||Br(e)||Fr(e))))}function Jr(e){return!(Yr(e)||function(e){return!!(function(e){return e>=128&&e<=255}(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||function(e){return e>=8192&&e<=8303}(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||function(e){return e>=8448&&e<=8527}(e)||function(e){return e>=8528&&e<=8591}(e)||function(e){return e>=8960&&e<=9215}(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||function(e){return e>=9216&&e<=9279}(e)&&9251!==e||function(e){return e>=9280&&e<=9311}(e)||function(e){return e>=9312&&e<=9471}(e)||function(e){return e>=9632&&e<=9727}(e)||function(e){return e>=9728&&e<=9983}(e)&&!(e>=9754&&e<=9759)||function(e){return e>=11008&&e<=11263}(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Er(e)||Mr(e)||function(e){return e>=57344&&e<=63743}(e)||qr(e)||Gr(e)||Zr(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function Qr(e){return e>=1424&&e<=2303||Vr(e)||Wr(e)}function $r(e,t){return!(!t&&Qr(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||function(e){return e>=6016&&e<=6143}(e))}function ea(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){if(Qr(t.value.charCodeAt(0)))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}var ta="deferred",na="loading",ia="loaded",ra=null,aa="unavailable",oa=null,sa=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(aa="error"),ra&&ra(e)};function la(){ua.fire(new Ye("pluginStateChange",{pluginStatus:aa,pluginURL:oa}))}var ua=new Qe,ca=function(){return aa},ha=function(){if(aa!==ta||!oa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");aa=na,la(),oa&&de({url:oa},(function(e){e?sa(e):(aa=ia,la())}))},da={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return aa===ia||null!=da.applyArabicShaping},isLoading:function(){return aa===na},setState:function(e){aa=e.pluginStatus,oa=e.pluginURL},isParsed:function(){return null!=da.applyArabicShaping&&null!=da.processBidirectionalText&&null!=da.processStyledBidirectionalText},getPluginURL:function(){return oa}},fa=function(){function e(t,n){_classCallCheck(this,e),this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}return _createClass(e,[{key:"isSupportedScript",value:function(e){return function(e,t){var n,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){if(!$r(n.value.charCodeAt(0),t))return!1}}catch(r){i.e(r)}finally{i.f()}return!0}(e,da.isLoaded())}}]),e}(),pa=function(){function e(t,n){_classCallCheck(this,e),this.property=t,this.value=n,this.expression=function(e,t){if(fi(e))return new Ti(e,t);if(bi(e)){var n=Si(e,t);if("error"===n.result)throw new Error(n.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));return n.value}var i=e;return"string"==typeof e&&"color"===t.type&&(i=Pt.parse(e)),{kind:"constant",evaluate:function(){return i}}}(void 0===n?t.specification.default:n,t.specification)}return _createClass(e,[{key:"isDataDriven",value:function(){return"source"===this.expression.kind||"composite"===this.expression.kind}},{key:"possiblyEvaluate",value:function(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}}]),e}(),ma=function(){function e(t){_classCallCheck(this,e),this.property=t,this.value=new pa(t,void 0)}return _createClass(e,[{key:"transitioned",value:function(e,t){return new ga(this.property,this.value,t,R({},e.transition,this.transition),e.now)}},{key:"untransitioned",value:function(){return new ga(this.property,this.value,null,{},0)}}]),e}(),va=function(){function e(t){_classCallCheck(this,e),this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}return _createClass(e,[{key:"getValue",value:function(e){return V(this._values[e].value.value)}},{key:"setValue",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ma(this._values[e].property)),this._values[e].value=new pa(this._values[e].property,null===t?void 0:V(t))}},{key:"getTransition",value:function(e){return V(this._values[e].transition)}},{key:"setTransition",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ma(this._values[e].property)),this._values[e].transition=V(t)||void 0}},{key:"serialize",value:function(){for(var e={},t=0,n=Object.keys(this._values);t<n.length;t++){var i=n[t],r=this.getValue(i);void 0!==r&&(e[i]=r);var a=this.getTransition(i);void 0!==a&&(e[i+"-transition"]=a)}return e}},{key:"transitioned",value:function(e,t){for(var n=new ya(this._properties),i=0,r=Object.keys(this._values);i<r.length;i++){var a=r[i];n._values[a]=this._values[a].transitioned(e,t._values[a])}return n}},{key:"untransitioned",value:function(){for(var e=new ya(this._properties),t=0,n=Object.keys(this._values);t<n.length;t++){var i=n[t];e._values[i]=this._values[i].untransitioned()}return e}}]),e}(),ga=function(){function e(t,n,i,r,a){_classCallCheck(this,e);var o=r.delay||0,s=r.duration||0;a=a||0,this.property=t,this.value=n,this.begin=a+o,this.end=this.begin+s,t.specification.transition&&(r.delay||r.duration)&&(this.prior=i)}return _createClass(e,[{key:"possiblyEvaluate",value:function(e,t,n){var i=e.now||0,r=this.value.possiblyEvaluate(e,t,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return a.possiblyEvaluate(e,t,n);var o=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,n),r,C(o))}return r}}]),e}(),ya=function(){function e(t){_classCallCheck(this,e),this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}return _createClass(e,[{key:"possiblyEvaluate",value:function(e,t,n){for(var i=new ba(this._properties),r=0,a=Object.keys(this._values);r<a.length;r++){var o=a[r];i._values[o]=this._values[o].possiblyEvaluate(e,t,n)}return i}},{key:"hasTransition",value:function(){for(var e=0,t=Object.keys(this._values);e<t.length;e++){var n=t[e];if(this._values[n].prior)return!0}return!1}}]),e}(),_a=function(){function e(t){_classCallCheck(this,e),this._properties=t,this._values=Object.create(t.defaultPropertyValues)}return _createClass(e,[{key:"getValue",value:function(e){return V(this._values[e].value)}},{key:"setValue",value:function(e,t){this._values[e]=new pa(this._values[e].property,null===t?void 0:V(t))}},{key:"serialize",value:function(){for(var e={},t=0,n=Object.keys(this._values);t<n.length;t++){var i=n[t],r=this.getValue(i);void 0!==r&&(e[i]=r)}return e}},{key:"possiblyEvaluate",value:function(e,t,n){for(var i=new ba(this._properties),r=0,a=Object.keys(this._values);r<a.length;r++){var o=a[r];i._values[o]=this._values[o].possiblyEvaluate(e,t,n)}return i}}]),e}(),xa=function(){function e(t,n,i){_classCallCheck(this,e),this.property=t,this.value=n,this.parameters=i}return _createClass(e,[{key:"isConstant",value:function(){return"constant"===this.value.kind}},{key:"constantOr",value:function(e){return"constant"===this.value.kind?this.value.value:e}},{key:"evaluate",value:function(e,t,n,i){return this.property.evaluate(this.value,this.parameters,e,t,n,i)}}]),e}(),ba=function(){function e(t){_classCallCheck(this,e),this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}return _createClass(e,[{key:"get",value:function(e){return this._values[e]}}]),e}(),wa=function(){function e(t){_classCallCheck(this,e),this.specification=t}return _createClass(e,[{key:"possiblyEvaluate",value:function(e,t){return e.expression.evaluate(t)}},{key:"interpolate",value:function(e,t,n){var i=bn[this.specification.type];return i?i(e,t,n):e}}]),e}(),ka=function(){function e(t,n){_classCallCheck(this,e),this.specification=t,this.overrides=n}return _createClass(e,[{key:"possiblyEvaluate",value:function(e,t,n,i){return new xa(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,i)}:e.expression,t)}},{key:"interpolate",value:function(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new xa(this,{kind:"constant",value:void 0},e.parameters);var i=bn[this.specification.type];return i?new xa(this,{kind:"constant",value:i(e.value.value,t.value.value,n)},e.parameters):e}},{key:"evaluate",value:function(e,t,n,i,r,a){return"constant"===e.kind?e.value:e.evaluate(t,n,i,r,a)}}]),e}(),Ca=function(){function e(t){_classCallCheck(this,e),this.specification=t}return _createClass(e,[{key:"possiblyEvaluate",value:function(e,t,n,i){return!!e.expression.evaluate(t,null,{},n,i)}},{key:"interpolate",value:function(){return!1}}]),e}(),Sa=_createClass((function e(t){_classCallCheck(this,e),this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];var n=new fa(0,{});for(var i in t){var r=t[i];r.specification.overridable&&this.overridableProperties.push(i);var a=this.defaultPropertyValues[i]=new pa(r,void 0),o=this.defaultTransitionablePropertyValues[i]=new ma(r);this.defaultTransitioningPropertyValues[i]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=a.possiblyEvaluate(n)}}));function Ta(e,t){return 256*(e=E(Math.floor(e),0,255))+E(Math.floor(t),0,255)}mr(ka,"DataDrivenProperty"),mr(wa,"DataConstantProperty"),mr(Ca,"ColorRampProperty");var Ea={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pa=_createClass((function e(t,n){_classCallCheck(this,e),this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8})),Ma=function(){function e(){_classCallCheck(this,e),this.isTransferred=!1,this.capacity=-1,this.resize(0)}return _createClass(e,[{key:"_trim",value:function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}},{key:"clear",value:function(){this.length=0}},{key:"resize",value:function(e){this.reserve(e),this.length=e}},{key:"reserve",value:function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}},{key:"_refreshViews",value:function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}},{key:"destroy",value:function(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}],[{key:"serialize",value:function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}},{key:"deserialize",value:function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}}]),e}();function Ia(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,i=0;return{members:e.map((function(e){var r=Ea[e.type].BYTES_PER_ELEMENT,a=n=Aa(n,Math.max(t,r)),o=e.components||1;return i=Math.max(i,r),n+=r*o,{name:e.name,type:e.type,components:o,offset:a}})),size:Aa(n,Math.max(i,t)),alignment:t}}function Aa(e,t){return Math.ceil(e/t)*t}var Ra=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)}},{key:"emplace",value:function(e,t,n){var i=2*e;return this.int16[i+0]=t,this.int16[i+1]=n,e}}]),t}(Ma);Ra.prototype.bytesPerElement=4,mr(Ra,"StructArrayLayout2i4");var Oa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}},{key:"emplace",value:function(e,t,n,i){var r=3*e;return this.int16[r+0]=t,this.int16[r+1]=n,this.int16[r+2]=i,e}}]),t}(Ma);Oa.prototype.bytesPerElement=6,mr(Oa,"StructArrayLayout3i6");var Na=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}},{key:"emplace",value:function(e,t,n,i,r){var a=4*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,e}}]),t}(Ma);Na.prototype.bytesPerElement=8,mr(Na,"StructArrayLayout4i8");var Da=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,i,r,a,o)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s){var l=6*e,u=12*e,c=3*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=r,this.uint8[u+6]=a,this.uint8[u+7]=o,this.float32[c+2]=s,e}}]),t}(Ma);Da.prototype.bytesPerElement=12,mr(Da,"StructArrayLayout2i4ub1f12");var za=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}},{key:"emplace",value:function(e,t,n,i,r){var a=4*e;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=r,e}}]),t}(Ma);za.prototype.bytesPerElement=16,mr(za,"StructArrayLayout4f16");var La=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r)}},{key:"emplace",value:function(e,t,n,i,r,a){var o=6*e,s=3*e;return this.uint16[o+0]=t,this.uint16[o+1]=n,this.uint16[o+2]=i,this.uint16[o+3]=r,this.float32[s+2]=a,e}}]),t}(Ma);La.prototype.bytesPerElement=12,mr(La,"StructArrayLayout4ui1f12");var Ba=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}},{key:"emplace",value:function(e,t,n,i,r){var a=4*e;return this.uint16[a+0]=t,this.uint16[a+1]=n,this.uint16[a+2]=i,this.uint16[a+3]=r,e}}]),t}(Ma);Ba.prototype.bytesPerElement=8,mr(Ba,"StructArrayLayout4ui8");var Fa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}},{key:"emplace",value:function(e,t,n,i,r,a,o){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,e}}]),t}(Ma);Fa.prototype.bytesPerElement=12,mr(Fa,"StructArrayLayout6i12");var ja=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o,s,l,u,c,h){var d=this.length;return this.resize(d+1),this.emplace(d,e,t,n,i,r,a,o,s,l,u,c,h)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d){var f=12*e;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=i,this.int16[f+3]=r,this.uint16[f+4]=a,this.uint16[f+5]=o,this.uint16[f+6]=s,this.uint16[f+7]=l,this.int16[f+8]=u,this.int16[f+9]=c,this.int16[f+10]=h,this.int16[f+11]=d,e}}]),t}(Ma);ja.prototype.bytesPerElement=24,mr(ja,"StructArrayLayout4i4ui4i24");var Ha=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}},{key:"emplace",value:function(e,t,n,i,r,a,o){var s=10*e,l=5*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=i,this.float32[l+2]=r,this.float32[l+3]=a,this.float32[l+4]=o,e}}]),t}(Ma);Ha.prototype.bytesPerElement=20,mr(Ha,"StructArrayLayout3i3f20");var Va=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint32[1*e+0]=t,e}}]),t}(Ma);Va.prototype.bytesPerElement=4,mr(Va,"StructArrayLayout1ul4");var Ua=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d){var f=this.length;return this.resize(f+1),this.emplace(f,e,t,n,i,r,a,o,s,l,u,c,h,d)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f){var p=20*e,m=10*e;return this.int16[p+0]=t,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.int16[p+4]=a,this.float32[m+3]=o,this.float32[m+4]=s,this.float32[m+5]=l,this.float32[m+6]=u,this.int16[p+14]=c,this.uint32[m+8]=h,this.uint16[p+18]=d,this.uint16[p+19]=f,e}}]),t}(Ma);Ua.prototype.bytesPerElement=40,mr(Ua,"StructArrayLayout5i4f1i1ul2ui40");var qa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,i,r,a,o)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s){var l=8*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+4]=r,this.int16[l+5]=a,this.int16[l+6]=o,this.int16[l+7]=s,e}}]),t}(Ma);qa.prototype.bytesPerElement=16,mr(qa,"StructArrayLayout3i2i2i16");var Ga=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r)}},{key:"emplace",value:function(e,t,n,i,r,a){var o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=i,this.int16[s+6]=r,this.int16[s+7]=a,e}}]),t}(Ma);Ga.prototype.bytesPerElement=16,mr(Ga,"StructArrayLayout2f1f2i16");var Wa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}},{key:"emplace",value:function(e,t,n,i,r){var a=12*e,o=3*e;return this.uint8[a+0]=t,this.uint8[a+1]=n,this.float32[o+1]=i,this.float32[o+2]=r,e}}]),t}(Ma);Wa.prototype.bytesPerElement=12,mr(Wa,"StructArrayLayout2ub2f12");var Za=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}},{key:"emplace",value:function(e,t,n,i){var r=3*e;return this.float32[r+0]=t,this.float32[r+1]=n,this.float32[r+2]=i,e}}]),t}(Ma);Za.prototype.bytesPerElement=12,mr(Za,"StructArrayLayout3f12");var Xa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}},{key:"emplace",value:function(e,t,n,i){var r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,this.uint16[r+2]=i,e}}]),t}(Ma);Xa.prototype.bytesPerElement=6,mr(Xa,"StructArrayLayout3ui6");var Ka=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x){var b=this.length;return this.resize(b+1),this.emplace(b,e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b){var w=30*e,k=15*e,C=60*e;return this.int16[w+0]=t,this.int16[w+1]=n,this.int16[w+2]=i,this.float32[k+2]=r,this.float32[k+3]=a,this.uint16[w+8]=o,this.uint16[w+9]=s,this.uint32[k+5]=l,this.uint32[k+6]=u,this.uint32[k+7]=c,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=f,this.float32[k+10]=p,this.float32[k+11]=m,this.uint8[C+48]=v,this.uint8[C+49]=g,this.uint8[C+50]=y,this.uint32[k+13]=_,this.int16[w+28]=x,this.uint8[C+58]=b,e}}]),t}(Ma);Ka.prototype.bytesPerElement=60,mr(Ka,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");var Ya=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w,k,C,S,T,E,P,M){var I=this.length;return this.resize(I+1),this.emplace(I,e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w,k,C,S,T,E,P,M)}},{key:"emplace",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w,k,C,S,T,E,P,M,I){var A=38*e,R=19*e;return this.int16[A+0]=t,this.int16[A+1]=n,this.int16[A+2]=i,this.float32[R+2]=r,this.float32[R+3]=a,this.int16[A+8]=o,this.int16[A+9]=s,this.int16[A+10]=l,this.int16[A+11]=u,this.int16[A+12]=c,this.int16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=f,this.uint16[A+16]=p,this.uint16[A+17]=m,this.uint16[A+18]=v,this.uint16[A+19]=g,this.uint16[A+20]=y,this.uint16[A+21]=_,this.uint16[A+22]=x,this.uint16[A+23]=b,this.uint16[A+24]=w,this.uint16[A+25]=k,this.uint16[A+26]=C,this.uint16[A+27]=S,this.uint16[A+28]=T,this.uint32[R+15]=E,this.float32[R+16]=P,this.float32[R+17]=M,this.float32[R+18]=I,e}}]),t}(Ma);Ya.prototype.bytesPerElement=76,mr(Ya,"StructArrayLayout3i2f6i15ui1ul3f76");var Ja=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.float32[1*e+0]=t,e}}]),t}(Ma);Ja.prototype.bytesPerElement=4,mr(Ja,"StructArrayLayout1f4");var Qa=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i,r){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r)}},{key:"emplace",value:function(e,t,n,i,r,a){var o=5*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,this.float32[o+4]=a,e}}]),t}(Ma);Qa.prototype.bytesPerElement=20,mr(Qa,"StructArrayLayout5f20");var $a=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}},{key:"emplace",value:function(e,t,n,i,r){var a=6*e;return this.uint32[3*e+0]=t,this.uint16[a+2]=n,this.uint16[a+3]=i,this.uint16[a+4]=r,e}}]),t}(Ma);$a.prototype.bytesPerElement=12,mr($a,"StructArrayLayout1ul3ui12");var eo=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)}},{key:"emplace",value:function(e,t,n){var i=2*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,e}}]),t}(Ma);eo.prototype.bytesPerElement=4,mr(eo,"StructArrayLayout2ui4");var to=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint16[1*e+0]=t,e}}]),t}(Ma);to.prototype.bytesPerElement=2,mr(to,"StructArrayLayout1ui2");var no=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)}},{key:"emplace",value:function(e,t,n){var i=2*e;return this.float32[i+0]=t,this.float32[i+1]=n,e}}]),t}(Ma);no.prototype.bytesPerElement=8,mr(no,"StructArrayLayout2f8");var io=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.int16[this._pos2+3]}},{key:"tileAnchorY",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"x1",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"y1",get:function(){return this._structArray.float32[this._pos4+4]}},{key:"x2",get:function(){return this._structArray.float32[this._pos4+5]}},{key:"y2",get:function(){return this._structArray.float32[this._pos4+6]}},{key:"padding",get:function(){return this._structArray.int16[this._pos2+14]}},{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+8]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+19]}}]),t}(Pa);io.prototype.size=40;var ro=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return new io(this,e)}}]),t}(Ua);mr(ro,"CollisionBoxArray");var ao=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.float32[this._pos4+2]}},{key:"tileAnchorY",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"glyphStartIndex",get:function(){return this._structArray.uint16[this._pos2+8]}},{key:"numGlyphs",get:function(){return this._structArray.uint16[this._pos2+9]}},{key:"vertexStartIndex",get:function(){return this._structArray.uint32[this._pos4+5]}},{key:"lineStartIndex",get:function(){return this._structArray.uint32[this._pos4+6]}},{key:"lineLength",get:function(){return this._structArray.uint32[this._pos4+7]}},{key:"segment",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"lowerSize",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"upperSize",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"lineOffsetX",get:function(){return this._structArray.float32[this._pos4+10]}},{key:"lineOffsetY",get:function(){return this._structArray.float32[this._pos4+11]}},{key:"writingMode",get:function(){return this._structArray.uint8[this._pos1+48]}},{key:"placedOrientation",get:function(){return this._structArray.uint8[this._pos1+49]},set:function(e){this._structArray.uint8[this._pos1+49]=e}},{key:"hidden",get:function(){return this._structArray.uint8[this._pos1+50]},set:function(e){this._structArray.uint8[this._pos1+50]=e}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+13]},set:function(e){this._structArray.uint32[this._pos4+13]=e}},{key:"associatedIconIndex",get:function(){return this._structArray.int16[this._pos2+28]}},{key:"flipState",get:function(){return this._structArray.uint8[this._pos1+58]},set:function(e){this._structArray.uint8[this._pos1+58]=e}}]),t}(Pa);ao.prototype.size=60;var oo=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return new ao(this,e)}}]),t}(Ka);mr(oo,"PlacedSymbolArray");var so=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"projectedAnchorX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"projectedAnchorY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"projectedAnchorZ",get:function(){return this._structArray.int16[this._pos2+2]}},{key:"tileAnchorX",get:function(){return this._structArray.float32[this._pos4+2]}},{key:"tileAnchorY",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"rightJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+8]}},{key:"centerJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+9]}},{key:"leftJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+10]}},{key:"verticalPlacedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+11]}},{key:"placedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+12]}},{key:"verticalPlacedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+13]}},{key:"key",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"textBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+15]}},{key:"textBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"verticalTextBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"verticalTextBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"iconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+19]}},{key:"iconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+20]}},{key:"verticalIconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+21]}},{key:"verticalIconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+22]}},{key:"featureIndex",get:function(){return this._structArray.uint16[this._pos2+23]}},{key:"numHorizontalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+24]}},{key:"numVerticalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+25]}},{key:"numIconVertices",get:function(){return this._structArray.uint16[this._pos2+26]}},{key:"numVerticalIconVertices",get:function(){return this._structArray.uint16[this._pos2+27]}},{key:"useRuntimeCollisionCircles",get:function(){return this._structArray.uint16[this._pos2+28]}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+15]},set:function(e){this._structArray.uint32[this._pos4+15]=e}},{key:"textOffset0",get:function(){return this._structArray.float32[this._pos4+16]}},{key:"textOffset1",get:function(){return this._structArray.float32[this._pos4+17]}},{key:"collisionCircleDiameter",get:function(){return this._structArray.float32[this._pos4+18]}}]),t}(Pa);so.prototype.size=76;var lo=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return new so(this,e)}}]),t}(Ya);mr(lo,"SymbolInstanceArray");var uo=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getoffsetX",value:function(e){return this.float32[1*e+0]}}]),t}(Ja);mr(uo,"GlyphOffsetArray");var co=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getx",value:function(e){return this.int16[2*e+0]}},{key:"gety",value:function(e){return this.int16[2*e+1]}}]),t}(Ra);mr(co,"SymbolLineVertexArray");var ho=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+0]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+2]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+3]}},{key:"layoutVertexArrayOffset",get:function(){return this._structArray.uint16[this._pos2+4]}}]),t}(Pa);ho.prototype.size=12;var fo=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return new ho(this,e)}}]),t}($a);mr(fo,"FeatureIndexArray");var po=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"geta_centroid_pos0",value:function(e){return this.uint16[2*e+0]}},{key:"geta_centroid_pos1",value:function(e){return this.uint16[2*e+1]}}]),t}(eo);mr(po,"FillExtrusionCentroidArray");var mo=Ia([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),vo=Ia([{name:"a_dash",components:4,type:"Uint16"}]),go={exports:{}},yo={exports:{}};yo.exports=function(e,t){var n,i,r,a,o,s,l,u;for(i=e.length-(n=3&e.length),r=t,o=3432918353,s=461845907,u=0;u<i;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var _o=yo.exports,xo={exports:{}};xo.exports=function(e,t){for(var n,i=e.length,r=t^i,a=0;i>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++a;switch(i){case 3:r^=(255&e.charCodeAt(a+2))<<16;case 2:r^=(255&e.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var bo=_o,wo=xo.exports;go.exports=bo,go.exports.murmur3=bo,go.exports.murmur2=wo;var ko=d(go.exports),Co=function(){function e(){_classCallCheck(this,e),this.ids=[],this.positions=[],this.indexed=!1}return _createClass(e,[{key:"add",value:function(e,t,n,i){this.ids.push(So(e)),this.positions.push(t,n,i)}},{key:"getPositions",value:function(e){for(var t=So(e),n=0,i=this.ids.length-1;n<i;){var r=n+i>>1;this.ids[r]>=t?i=r:n=r+1}for(var a=[];this.ids[n]===t;)a.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return a}}],[{key:"serialize",value:function(e,t){var n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return function e(t,n,i,r){for(;i<r;){for(var a=t[i+r>>1],o=i-1,s=r+1;;){do{o++}while(t[o]<a);do{s--}while(t[s]>a);if(o>=s)break;To(t,o,s),To(n,3*o,3*s),To(n,3*o+1,3*s+1),To(n,3*o+2,3*s+2)}s-i<r-s?(e(t,n,i,s),i=s+1):(e(t,n,s+1,r),r=s)}}(n,i,0,n.length-1),t&&t.push(n.buffer,i.buffer),{ids:n,positions:i}}},{key:"deserialize",value:function(t){var n=new e;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}]),e}();function So(e){var t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:ko(String(e))}function To(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}mr(Co,"FeaturePositionMap");var Eo=function(){function e(t){_classCallCheck(this,e),this.gl=t.gl,this.initialized=!1}return _createClass(e,[{key:"fetchUniformLocation",value:function(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}}]),e}(),Po=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=0,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}]),t}(Eo),Mo=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=[0,0,0,0],n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}]),t}(Eo),Io=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=Pt.transparent,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}]),t}(Eo),Ao=new Float32Array(16),Ro=new Float32Array(9),Oo=new Float32Array(4);function No(e){return[Ta(255*e.r,255*e.g),Ta(255*e.b,255*e.a)]}var Do=function(){function e(t,n,i){_classCallCheck(this,e),this.value=t,this.uniformNames=n.map((function(e){return"u_"+e})),this.type=i}return _createClass(e,[{key:"setUniform",value:function(e,t,n,i,r){t.set(e,r,i.constantOr(this.value))}},{key:"getBinding",value:function(e,t){return"color"===this.type?new Io(e):new Po(e)}}]),e}(),zo=function(){function e(t,n){_classCallCheck(this,e),this.uniformNames=n.map((function(e){return"u_"+e})),this.pattern=null,this.pixelRatio=1}return _createClass(e,[{key:"setConstantPatternPositions",value:function(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}},{key:"setUniform",value:function(e,t,n,i,r){var a="u_pattern"===r||"u_dash"===r?this.pattern:"u_pixel_ratio"===r?this.pixelRatio:null;a&&t.set(e,r,a)}},{key:"getBinding",value:function(e,t){return"u_pattern"===t||"u_dash"===t?new Mo(e):new Po(e)}}]),e}(),Lo=function(){function e(t,n,i,r){_classCallCheck(this,e),this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=n.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===i?2:1,offset:0}})),this.paintVertexArray=new r}return _createClass(e,[{key:"populatePaintArray",value:function(e,t,n,i,r,a){var o=this.paintVertexArray.length,s=this.expression.evaluate(new fa(0),t,{},r,i,a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}},{key:"updatePaintArray",value:function(e,t,n,i,r){var a=this.expression.evaluate({zoom:0},n,i,void 0,r);this._setPaintValue(e,t,a)}},{key:"_setPaintValue",value:function(e,t,n){if("color"===this.type)for(var i=No(n),r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1]);else{for(var a=e;a<t;a++)this.paintVertexArray.emplace(a,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}]),e}(),Bo=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this.expression=t,this.uniformNames=n.map((function(e){return"u_".concat(e,"_t")})),this.type=i,this.useIntegerZoom=r,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=n.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===i?4:2,offset:0}})),this.paintVertexArray=new o}return _createClass(e,[{key:"populatePaintArray",value:function(e,t,n,i,r,a){var o=this.expression.evaluate(new fa(this.zoom),t,{},r,i,a),s=this.expression.evaluate(new fa(this.zoom+1),t,{},r,i,a),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,s)}},{key:"updatePaintArray",value:function(e,t,n,i,r){var a=this.expression.evaluate({zoom:this.zoom},n,i,void 0,r),o=this.expression.evaluate({zoom:this.zoom+1},n,i,void 0,r);this._setPaintValue(e,t,a,o)}},{key:"_setPaintValue",value:function(e,t,n,i){if("color"===this.type)for(var r=No(n),a=No(i),o=e;o<t;o++)this.paintVertexArray.emplace(o,r[0],r[1],a[0],a[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},{key:"setUniform",value:function(e,t,n,i,r){var a=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,o=E(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(e,r,o)}},{key:"getBinding",value:function(e,t){return new Po(e)}}]),e}(),Fo=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.expression=t,this.layerId=a,this.paintVertexAttributes=("array"===i?vo:mo).members;for(var o=0;o<n.length;++o);this.paintVertexArray=new r}return _createClass(e,[{key:"populatePaintArray",value:function(e,t,n){var i=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],n)}},{key:"updatePaintArray",value:function(e,t,n,i,r,a){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],a)}},{key:"_setPaintValues",value:function(e,t,n,i){if(i&&n){var r=i[n];if(r)for(var a=r.tl,o=r.br,s=r.pixelRatio,l=e;l<t;l++)this.paintVertexArray.emplace(l,a[0],a[1],o[0],o[1],s)}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}]),e}(),jo=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};_classCallCheck(this,e),this.binders={},this._buffers=[];var r=[];for(var a in t.paint._values)if(i(a)){var o=t.paint.get(a);if(o instanceof xa&&ui(o.property.specification)){var s=Uo(a,t.type),l=o.value,u=o.property.specification.type,c=!!o.property.useIntegerZoom,h="line-dasharray"===a||a.endsWith("pattern"),d="line-dasharray"===a&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==l.kind||d)if("source"===l.kind||d||h){var f=Wo(a,u,"source");this.binders[a]=h?new Fo(l,s,u,f,t.id):new Lo(l,s,u,f),r.push("/a_"+a)}else{var p=Wo(a,u,"composite");this.binders[a]=new Bo(l,s,u,c,n,p),r.push("/z_"+a)}else this.binders[a]=h?new zo(l.value,s):new Do(l.value,s,u),r.push("/u_"+a)}}this.cacheKey=r.sort().join("")}return _createClass(e,[{key:"getMaxValue",value:function(e){var t=this.binders[e];return t instanceof Lo||t instanceof Bo?t.maxValue:0}},{key:"populatePaintArrays",value:function(e,t,n,i,r,a){for(var o in this.binders){var s=this.binders[o];(s instanceof Lo||s instanceof Bo||s instanceof Fo)&&s.populatePaintArray(e,t,n,i,r,a)}}},{key:"setConstantPatternPositions",value:function(e){for(var t in this.binders){var n=this.binders[t];n instanceof zo&&n.setConstantPatternPositions(e)}}},{key:"updatePaintArrays",value:function(e,t,n,i,r,a){var o=!1;for(var s in e){var l,u=_createForOfIteratorHelper(t.getPositions(s));try{for(u.s();!(l=u.n()).done;){var c=l.value,h=n.feature(c.index);for(var d in this.binders){var f=this.binders[d];if((f instanceof Lo||f instanceof Bo||f instanceof Fo)&&!0===f.expression.isStateDependent){var p=i.paint.get(d);f.expression=p.value,f.updatePaintArray(c.start,c.end,h,e[s],r,a),o=!0}}}}catch(m){u.e(m)}finally{u.f()}}return o}},{key:"defines",value:function(){var e=[];for(var t in this.binders){var n=this.binders[t];(n instanceof Do||n instanceof zo)&&e.push.apply(e,_toConsumableArray(n.uniformNames.map((function(e){return"#define HAS_UNIFORM_"+e}))))}return e}},{key:"getBinderAttributes",value:function(){var e=[];for(var t in this.binders){var n=this.binders[t];if(n instanceof Lo||n instanceof Bo||n instanceof Fo)for(var i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name)}return e}},{key:"getBinderUniforms",value:function(){var e=[];for(var t in this.binders){var n=this.binders[t];if(n instanceof Do||n instanceof zo||n instanceof Bo){var i,r=_createForOfIteratorHelper(n.uniformNames);try{for(r.s();!(i=r.n()).done;){var a=i.value;e.push(a)}}catch(o){r.e(o)}finally{r.f()}}}return e}},{key:"getPaintVertexBuffers",value:function(){return this._buffers}},{key:"getUniforms",value:function(e){var t=[];for(var n in this.binders){var i=this.binders[n];if(i instanceof Do||i instanceof zo||i instanceof Bo){var r,a=_createForOfIteratorHelper(i.uniformNames);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.push({name:o,property:n,binding:i.getBinding(e,o)})}}catch(s){a.e(s)}finally{a.f()}}}return t}},{key:"setUniforms",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.name,u=s.property,c=s.binding;this.binders[u].setUniform(e,c,r,i.get(u),l)}}catch(h){o.e(h)}finally{o.f()}}},{key:"updatePaintBuffers",value:function(){for(var e in this._buffers=[],this.binders){var t=this.binders[e];(t instanceof Lo||t instanceof Bo||t instanceof Fo)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}},{key:"upload",value:function(e){for(var t in this.binders){var n=this.binders[t];(n instanceof Lo||n instanceof Bo||n instanceof Fo)&&n.upload(e)}this.updatePaintBuffers()}},{key:"destroy",value:function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Lo||t instanceof Bo||t instanceof Fo)&&t.destroy()}}}]),e}(),Ho=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};_classCallCheck(this,e),this.programConfigurations={};var r,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;this.programConfigurations[o.id]=new jo(o,n,i)}}catch(s){a.e(s)}finally{a.f()}this.needsUpload=!1,this._featureMap=new Co,this._bufferOffset=0}return _createClass(e,[{key:"populatePaintArrays",value:function(e,t,n,i,r,a,o){for(var s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,i,r,a,o);void 0!==t.id&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}},{key:"updatePaintArrays",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(e,this._featureMap,t,s,i,r)||this.needsUpload}}catch(l){o.e(l)}finally{o.f()}}},{key:"get",value:function(e){return this.programConfigurations[e]}},{key:"upload",value:function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}},{key:"destroy",value:function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()}}]),e}(),Vo={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Uo(e,t){return Vo[e]||[e.replace(t+"-","").replace(/-/g,"_")]}var qo={"line-pattern":{source:La,composite:La},"fill-pattern":{source:La,composite:La},"fill-extrusion-pattern":{source:La,composite:La},"line-dasharray":{source:Ba,composite:Ba}},Go={color:{source:no,composite:za},number:{source:Ja,composite:no}};function Wo(e,t,n){var i=qo[e];return i&&i[n]||Go[t][n]}mr(Do,"ConstantBinder"),mr(zo,"PatternConstantBinder"),mr(Lo,"SourceExpressionBinder"),mr(Fo,"PatternCompositeBinder"),mr(Bo,"CompositeExpressionBinder"),mr(jo,"ProgramConfiguration",{omit:["_buffers"]}),mr(Ho,"ProgramConfigurationSet");var Zo="-transition",Xo=function(e){function t(e,n){var i;if(_classCallCheck(this,t),(i=_callSuper(this,t)).id=e.id,i.type=e.type,i._featureFilter={filter:function(){return!0},needGeometry:!1,needFeature:!1},i._filterCompiled=!1,"custom"!==e.type&&(i.metadata=e.metadata,i.minzoom=e.minzoom,i.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(i.source=e.source,i.sourceLayer=e["source-layer"],i.filter=e.filter),n.layout&&(i._unevaluatedLayout=new _a(n.layout)),n.paint)){for(var r in i._transitionablePaint=new va(n.paint),e.paint)i.setPaintProperty(r,e.paint[r],{validate:!1});for(var a in e.layout)i.setLayoutProperty(a,e.layout[a],{validate:!1});i._transitioningPaint=i._transitionablePaint.untransitioned(),i.paint=new ba(n.paint)}return _possibleConstructorReturn(i)}return _inherits(t,e),_createClass(t,[{key:"getLayoutProperty",value:function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}},{key:"setLayoutProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(lr,"layers.".concat(this.id,".layout.").concat(e),e,t,n)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}},{key:"getPaintProperty",value:function(e){return F(e,Zo)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}},{key:"setPaintProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(sr,"layers.".concat(this.id,".paint.").concat(e),e,t,n))return!1;if(F(e,Zo))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;var i=this._transitionablePaint._values[e],r=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var o=this._transitionablePaint._values[e].value,s=o.isDataDriven(),l=F(e,"pattern")||"line-dasharray"===e;return s||r||l||this._handleOverridablePaintPropertyUpdate(e,a,o)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(e){}},{key:"getProgramIds",value:function(){return null}},{key:"getProgramConfiguration",value:function(e){return null}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,t,n){return!1}},{key:"isHidden",value:function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}},{key:"updateTransitions",value:function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}},{key:"hasTransition",value:function(){return this._transitioningPaint.hasTransition()}},{key:"recalculate",value:function(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}},{key:"serialize",value:function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),H(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))}},{key:"_validate",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&cr(this,e.call(or,{key:t,layerType:this.type,objectKey:n,value:i,styleSpec:$e,style:{glyphs:!0,sprite:!0}}))}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!1}},{key:"isTileClipped",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return!1}},{key:"resize",value:function(){}},{key:"isStateDependent",value:function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof xa&&ui(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}},{key:"compileFilter",value:function(){this._filterCompiled||(this._featureFilter=Di(this.filter),this._filterCompiled=!0)}},{key:"invalidateCompiledFilter",value:function(){this._filterCompiled=!1}},{key:"dynamicFilter",value:function(){return this._featureFilter.dynamicFilter}},{key:"dynamicFilterNeedsFeature",value:function(){return this._featureFilter.needFeature}}]),t}(Qe),Ko=Ia([{name:"a_pos",components:2,type:"Int16"}],4),Yo=Ia([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),Jo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.segments=t}return _createClass(e,[{key:"prepareSegment",value:function(t,n,i,r){var a=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&q("Max vertices per segment is ".concat(e.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!a||a.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==r)&&(a={vertexOffset:n.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==r&&(a.sortKey=r),this.segments.push(a)),a}},{key:"get",value:function(){return this.segments}},{key:"destroy",value:function(){var e,t=_createForOfIteratorHelper(this.segments);try{for(t.s();!(e=t.n()).done;){var n=e.value;for(var i in n.vaos)n.vaos[i].destroy()}}catch(r){t.e(r)}finally{t.f()}}}],[{key:"simpleSegment",value:function(t,n,i,r){return new e([{vertexOffset:t,primitiveOffset:n,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])}}]),e}();Jo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mr(Jo,"SegmentVector");var Qo=8192,$o=function(){function e(t,n){_classCallCheck(this,e),t&&(n?this.setSouthWest(t).setNorthEast(n):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}return _createClass(e,[{key:"setNorthEast",value:function(e){return this._ne=e instanceof Tl?new Tl(e.lng,e.lat):Tl.convert(e),this}},{key:"setSouthWest",value:function(e){return this._sw=e instanceof Tl?new Tl(e.lng,e.lat):Tl.convert(e),this}},{key:"extend",value:function(t){var n,i,r=this._sw,a=this._ne;if(t instanceof Tl)n=t,i=t;else{if(!(t instanceof e))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(e.convert(t)):this.extend(Tl.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(Tl.convert(t)):this;if(n=t._sw,i=t._ne,!n||!i)return this}return r||a?(r.lng=Math.min(n.lng,r.lng),r.lat=Math.min(n.lat,r.lat),a.lng=Math.max(i.lng,a.lng),a.lat=Math.max(i.lat,a.lat)):(this._sw=new Tl(n.lng,n.lat),this._ne=new Tl(i.lng,i.lat)),this}},{key:"getCenter",value:function(){return new Tl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}},{key:"getSouthWest",value:function(){return this._sw}},{key:"getNorthEast",value:function(){return this._ne}},{key:"getNorthWest",value:function(){return new Tl(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Tl(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this._sw.lng}},{key:"getSouth",value:function(){return this._sw.lat}},{key:"getEast",value:function(){return this._ne.lng}},{key:"getNorth",value:function(){return this._ne.lat}},{key:"toArray",value:function(){return[this._sw.toArray(),this._ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this._sw&&this._ne)}},{key:"contains",value:function(e){var t=Tl.convert(e),n=t.lng,i=t.lat,r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}}],[{key:"convert",value:function(t){return!t||t instanceof e?t:new e(t)}}]),e}(),es=1e-6,ts="undefined"!=typeof Float32Array?Float32Array:Array;function ns(){var e=new ts(9);return ts!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function is(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=n[0],f=n[1],p=n[2],m=n[3],v=n[4],g=n[5],y=n[6],_=n[7],x=n[8];return e[0]=d*i+f*o+p*u,e[1]=d*r+f*s+p*c,e[2]=d*a+f*l+p*h,e[3]=m*i+v*o+g*u,e[4]=m*r+v*s+g*c,e[5]=m*a+v*l+g*h,e[6]=y*i+_*o+x*u,e[7]=y*r+_*s+x*c,e[8]=y*a+_*l+x*h,e}function rs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function as(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15],y=n*s-i*o,_=n*l-r*o,x=n*u-a*o,b=i*l-r*s,w=i*u-a*s,k=r*u-a*l,C=c*m-h*p,S=c*v-d*p,T=c*g-f*p,E=h*v-d*m,P=h*g-f*m,M=d*g-f*v,I=y*M-_*P+x*E+b*T-w*S+k*C;return I?(e[0]=(s*M-l*P+u*E)*(I=1/I),e[1]=(r*P-i*M-a*E)*I,e[2]=(m*k-v*w+g*b)*I,e[3]=(d*w-h*k-f*b)*I,e[4]=(l*T-o*M-u*S)*I,e[5]=(n*M-r*T+a*S)*I,e[6]=(v*x-p*k-g*_)*I,e[7]=(c*k-d*x+f*_)*I,e[8]=(o*P-s*T+u*C)*I,e[9]=(i*T-n*P-a*C)*I,e[10]=(p*w-m*x+g*y)*I,e[11]=(h*x-c*w-f*y)*I,e[12]=(s*S-o*E-l*C)*I,e[13]=(n*E-i*S+r*C)*I,e[14]=(m*_-p*b-v*y)*I,e[15]=(c*b-h*_+d*y)*I,e):null}function os(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],_=n[0],x=n[1],b=n[2],w=n[3];return e[0]=_*i+x*s+b*h+w*m,e[1]=_*r+x*l+b*d+w*v,e[2]=_*a+x*u+b*f+w*g,e[3]=_*o+x*c+b*p+w*y,e[4]=(_=n[4])*i+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,e[5]=_*r+x*l+b*d+w*v,e[6]=_*a+x*u+b*f+w*g,e[7]=_*o+x*c+b*p+w*y,e[8]=(_=n[8])*i+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,e[9]=_*r+x*l+b*d+w*v,e[10]=_*a+x*u+b*f+w*g,e[11]=_*o+x*c+b*p+w*y,e[12]=(_=n[12])*i+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,e[13]=_*r+x*l+b*d+w*v,e[14]=_*a+x*u+b*f+w*g,e[15]=_*o+x*c+b*p+w*y,e}function ss(e,t,n){var i,r,a,o,s,l,u,c,h,d,f,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=i=t[0],e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=i*m+s*v+h*g+t[12],e[13]=r*m+l*v+d*g+t[13],e[14]=a*m+u*v+f*g+t[14],e[15]=o*m+c*v+p*g+t[15]),e}function ls(e,t,n){var i=n[0],r=n[1],a=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function us(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+u*i,e[5]=o*r+c*i,e[6]=s*r+h*i,e[7]=l*r+d*i,e[8]=u*r-a*i,e[9]=c*r-o*i,e[10]=h*r-s*i,e[11]=d*r-l*i,e}function cs(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r-u*i,e[1]=o*r-c*i,e[2]=s*r-h*i,e[3]=l*r-d*i,e[8]=a*i+u*r,e[9]=o*i+c*r,e[10]=s*i+h*r,e[11]=l*i+d*r,e}function hs(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ds(e,t,n){var i,r,a,o=n[0],s=n[1],l=n[2],u=Math.hypot(o,s,l);return u<es?null:(o*=u=1/u,s*=u,l*=u,i=Math.sin(t),r=Math.cos(t),e[0]=o*o*(a=1-r)+r,e[1]=s*o*a+l*i,e[2]=l*o*a-s*i,e[3]=0,e[4]=o*s*a-l*i,e[5]=s*s*a+r,e[6]=l*s*a+o*i,e[7]=0,e[8]=o*l*a+s*i,e[9]=s*l*a-o*i,e[10]=l*l*a+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var fs=os;function ps(){var e=new ts(3);return ts!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ms(e){var t=new ts(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function vs(e){return Math.hypot(e[0],e[1],e[2])}function gs(e,t,n){var i=new ts(3);return i[0]=e,i[1]=t,i[2]=n,i}function ys(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function _s(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function xs(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function bs(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function ws(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function ks(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Cs(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e}function Ss(e,t){var n=t[0],i=t[1],r=t[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function Ts(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Es(e,t,n){var i=t[0],r=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=r*l-a*s,e[1]=a*o-i*l,e[2]=i*s-r*o,e}function Ps(e,t,n){var i=t[0],r=t[1],a=t[2],o=n[3]*i+n[7]*r+n[11]*a+n[15];return e[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/(o=o||1),e[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/o,e[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/o,e}function Ms(e,t,n){var i=n[0],r=n[1],a=n[2],o=t[0],s=t[1],l=t[2],u=r*l-a*s,c=a*o-i*l,h=i*s-r*o,d=r*h-a*c,f=a*u-i*h,p=i*c-r*u,m=2*n[3];return c*=m,h*=m,f*=2,p*=2,e[0]=o+(u*=m)+(d*=2),e[1]=s+c+f,e[2]=l+h+p,e}var Is,As=_s,Rs=xs,Os=vs;function Ns(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Ds(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=n*n+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=i*o,e[2]=r*o,e[3]=a*o,e}function zs(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*a+n[12]*o,e[1]=n[1]*i+n[5]*r+n[9]*a+n[13]*o,e[2]=n[2]*i+n[6]*r+n[10]*a+n[14]*o,e[3]=n[3]*i+n[7]*r+n[11]*a+n[15]*o,e}function Ls(){var e=new ts(4);return ts!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Bs(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Fs(e,t,n){n*=.5;var i=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+o*s,e[1]=r*l+a*s,e[2]=a*l-r*s,e[3]=o*l-i*s,e}function js(e,t,n){n*=.5;var i=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l-a*s,e[1]=r*l+o*s,e[2]=a*l+i*s,e[3]=o*l-r*s,e}ps(),Is=new ts(4),ts!=Float32Array&&(Is[0]=0,Is[1]=0,Is[2]=0,Is[3]=0);var Hs=Ds;ps(),gs(1,0,0),gs(0,1,0),Ls(),Ls(),ns();var Vs=Ia([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]).members,Us=Ia([{name:"a_pos_3",components:3,type:"Int16"}]),qs=Ia([{name:"a_pos",type:"Int16",components:2}]),Gs=function(){function e(t,n){_classCallCheck(this,e),this.pos=t,this.dir=n}return _createClass(e,[{key:"intersectsPlane",value:function(e,t,n){var i=Ts(t,this.dir);if(Math.abs(i)<1e-6)return!1;var r=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/i;return n[0]=this.pos[0]+this.dir[0]*r,n[1]=this.pos[1]+this.dir[1]*r,n[2]=this.pos[2]+this.dir[2]*r,!0}},{key:"closestPointOnSphere",value:function(e,t,n){if(function(e,t){var n=e[0],i=e[1],r=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=es*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=es*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-s)<=es*Math.max(1,Math.abs(r),Math.abs(s))}(this.pos,e)||0===t)return n[0]=n[1]=n[2]=0,!1;var i=_slicedToArray(this.dir,3),r=i[0],a=i[1],o=i[2],s=this.pos[0]-e[0],l=this.pos[1]-e[1],u=this.pos[2]-e[2],c=r*r+a*a+o*o,h=2*(s*r+l*a+u*o),d=h*h-4*c*(s*s+l*l+u*u-t*t);if(d<0){var f=Math.max(-h/2,0),p=s+r*f,m=l+a*f,v=u+o*f,g=Math.hypot(p,m,v);return n[0]=p*t/g,n[1]=m*t/g,n[2]=v*t/g,!1}var y=(-h-Math.sqrt(d))/(2*c);if(y<0){var _=Math.hypot(s,l,u);return n[0]=s*t/_,n[1]=l*t/_,n[2]=u*t/_,!1}return n[0]=s+r*y,n[1]=l+a*y,n[2]=u+o*y,!0}}]),e}(),Ws=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.TL=t,this.TR=n,this.BR=i,this.BL=r,this.horizon=a}return _createClass(e,null,[{key:"fromInvProjectionMatrix",value:function(t,n,i){var r=[-1,1,1],a=[1,1,1],o=[1,-1,1],s=[-1,-1,1];return new e(Ps(r,r,t),Ps(a,a,t),Ps(o,o,t),Ps(s,s,t),n/i)}}]),e}(),Zs=function(){function e(t,n){_classCallCheck(this,e),this.points=t,this.planes=n}return _createClass(e,null,[{key:"fromInvProjectionMatrix",value:function(t,n,i,r){var a=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(e){var i=zs([],e,t),o=1/i[3]/n*a;return function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}(i,i,[o,o,r?1/i[3]:o,o])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var t=Ss([],Es([],As([],o[e[0]],o[e[1]]),As([],o[e[2]],o[e[1]]))),n=-Ts(t,o[e[1]]);return t.concat(n)}));return new e(o,s)}}]),e}(),Xs=function(){function e(t,n){_classCallCheck(this,e),this.min=t,this.max=n,this.center=ks([],ys([],this.min,this.max),.5)}return _createClass(e,[{key:"quadrant",value:function(t){for(var n=[t%2==0,t<2],i=ms(this.min),r=ms(this.max),a=0;a<n.length;a++)i[a]=n[a]?this.min[a]:this.center[a],r[a]=n[a]?this.center[a]:this.max[a];return r[2]=this.max[2],new e(i,r)}},{key:"distanceX",value:function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}},{key:"distanceY",value:function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}},{key:"distanceZ",value:function(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}},{key:"getCorners",value:function(){var e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}},{key:"intersects",value:function(e){for(var t=this.getCorners(),n=!0,i=0;i<e.planes.length;i++){for(var r=e.planes[i],a=0,o=0;o<t.length;o++)a+=Ts(r,t[o])+r[3]>=0;if(0===a)return 0;a!==t.length&&(n=!1)}if(n)return 2;for(var s=0;s<3;s++){for(var l=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=0;c<e.points.length;c++){var h=e.points[c][s]-this.min[s];l=Math.min(l,h),u=Math.max(u,h)}if(u<0||l>this.max[s]-this.min[s])return 0}return 1}}],[{key:"fromPoints",value:function(t){var n,i=[1/0,1/0,1/0],r=[-1/0,-1/0,-1/0],a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;bs(i,i,o),ws(r,r,o)}}catch(s){a.e(s)}finally{a.f()}return new e(i,r)}},{key:"applyTransform",value:function(t,n){for(var i=t.getCorners(),r=0;r<i.length;++r)Ps(i[r],i[r],n);return e.fromPoints(i)}}]),e}(),Ks=Qo/Math.PI/2,Ys=[64,32,16],Js=-Ks,Qs=Ks,$s=[new Xs([Js,Js,Js],[Qs,Qs,Qs]),new Xs([Js,Js,Js],[0,0,Qs]),new Xs([0,Js,Js],[Qs,0,Qs]),new Xs([Js,0,Js],[0,Qs,Qs]),new Xs([0,0,Js],[Qs,Qs,Qs])];function el(e){return e*Ks/Cl}function tl(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=ks([],e._camera.position,e.worldSize),a=[t,n,1,1];zs(a,a,e.pixelMatrixInverse),Ns(a,a,1/a[3]);var o=Ss([],As([],a,r)),s=e.globeMatrix,l=[s[12],s[13],s[14]],u=As([],l,r),c=vs(u),h=Ss([],u),d=e.worldSize/(2*Math.PI),f=Ts(h,o),p=Math.asin(d/c);if(p<Math.acos(f)){if(!i)return null;var m=[],v=[];ks(m,o,c/f),Ss(v,As(v,m,u)),Ss(o,ys(o,u,ks(o,v,Math.tan(p)*c)))}var g=[];new Gs(r,o).closestPointOnSphere(l,d,g);var y=Ss([],Q(s,0)),_=Ss([],Q(s,1)),x=Ss([],Q(s,2)),b=Ts(y,g),k=Ts(_,g),C=Ts(x,g),S=w(Math.asin(-k/d)),T=w(Math.atan2(b,C)),P=Pl(T=e.center.lng+function(e,t){var n=(t-e+180)%360-180;return n<-180?n+360:n}(e.center.lng,T)),M=E(Ml(S),0,1);return new zl(P,M)}var nl=_createClass((function e(t,n,i){_classCallCheck(this,e),this.a=As([],t,i),this.b=As([],n,i),this.center=i;var r=Ss([],this.a),a=Ss([],this.b);this.angle=Math.acos(Ts(r,a))}));function il(e,t){return 0===e.angle?null:(n=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)))<0||n>1?null:function(e,t,n,i){var r=Math.sin(n);return e*(Math.sin((1-i)*n)/r)+t*(Math.sin(i*n)/r)}(e.a[t],e.b[t],e.angle,E(n,0,1))+e.center[t];var n}function rl(e){if(e.z<=1)return $s[e.z+2*e.y+e.x];var t=ul(ll(e));return Xs.fromPoints(t)}function al(e,t,n){return ks(e,e,1-n),Cs(e,e,t,n)}function ol(e,t){var n=yl(t.zoom);if(0===n)return rl(e);var i=ll(e),r=ul(i),a=Pl(i.getWest())*t.worldSize,o=Pl(i.getEast())*t.worldSize,s=Ml(i.getNorth())*t.worldSize,l=Ml(i.getSouth())*t.worldSize,u=[a,s,0],c=[o,s,0],h=[a,l,0],d=[o,l,0],f=as([],t.globeMatrix);return Ps(u,u,f),Ps(c,c,f),Ps(h,h,f),Ps(d,d,f),r[0]=al(r[0],h,n),r[1]=al(r[1],d,n),r[2]=al(r[2],c,n),r[3]=al(r[3],u,n),Xs.fromPoints(r)}function sl(e,t,n){var i,r=_createForOfIteratorHelper(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;Ps(a,a,t),ks(a,a,n)}}catch(o){r.e(o)}finally{r.f()}}function ll(e){var t=e.x,n=e.y,i=1/(1<<e.z),r=new Tl(Al(t*i),Rl((n+1)*i)),a=new Tl(Al((t+1)*i),Rl(n*i));return new $o(r,a)}function ul(e){var t=b(e.getNorth()),n=b(e.getSouth()),i=Math.cos(t),r=Math.cos(n),a=Math.sin(t),o=Math.sin(n),s=e.getWest(),l=e.getEast();return[cl(r,o,s),cl(r,o,l),cl(i,a,l),cl(i,a,s)]}function cl(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ks;return n=b(n),[e*Math.sin(n)*i,-t*i,e*Math.cos(n)*i]}function hl(e,t,n){return cl(Math.cos(b(e)),Math.sin(b(e)),t,n)}function dl(e,t,n,i){var r=1<<n.z,a=(e/Qo+n.x)/r;return hl(Rl((t/Qo+n.y)/r),Al(a),i)}function fl(e){var t=e.min,n=e.max;return 16383/Math.max(n[0]-t[0],n[1]-t[1],n[2]-t[2])}var pl=new Float64Array(16);function ml(e){var t,n,i=fl(e),r=hs(pl,[i,i,i]);return ss(r,r,((t=[])[0]=-(n=e.min)[0],t[1]=-n[1],t[2]=-n[2],t))}function vl(e){var t,n,i=(n=e.min,(t=pl)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t),r=1/fl(e);return ls(i,i,[r,r,r])}function gl(e,t,n,i,r){var a=function(e){var t=Qo/(2*Math.PI);return e/(2*Math.PI)/t}(n),o=[e,t,-n/(2*Math.PI)],s=rs(new Float64Array(16));return ss(s,s,o),ls(s,s,[a,a,a]),us(s,s,b(-r)),cs(s,s,b(-i)),s}function yl(e){return P(5,6,e)}function _l(e,t){var n,i,r,a,o,s,l,u,c,h,d=hl(t.lat,t.lng);return r=(n=_s([],function(e){var t=hl(e._center.lat,e._center.lng),n=Es([],gs(0,1,0),t),i=ds([],-e.angle,t);n=Ps(n,n,i),ds(i,-e._pitch,n);var r=Ss([],t);return ks(r,r,el(e.cameraToCenterDistance/e.pixelsPerMeter)),Ps(r,r,i),ys([],t,r)}(e),d))[0],a=n[1],o=n[2],s=(i=d)[0],l=i[1],u=i[2],h=(c=Math.sqrt(r*r+a*a+o*o)*Math.sqrt(s*s+l*l+u*u))&&Ts(n,i)/c,Math.acos(Math.min(Math.max(h,-1),1))}function xl(e,t){return _l(e,t)>Math.PI/2*1.01}var bl=b(85),wl=Math.cos(bl),kl=Math.sin(bl),Cl=6371008.8,Sl=2*Math.PI*Cl,Tl=function(){function e(t,n){if(_classCallCheck(this,e),isNaN(t)||isNaN(n))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(n,")"));if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return _createClass(e,[{key:"wrap",value:function(){return new e(M(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(e){var t=Math.PI/180,n=this.lat*t,i=e.lat*t,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*t);return Cl*Math.acos(Math.min(r,1))}},{key:"toBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=360*t/40075017,i=n/Math.cos(Math.PI/180*this.lat);return new $o(new e(this.lng-i,this.lat-n),new e(this.lng+i,this.lat+n))}},{key:"toEcef",value:function(e){var t=el(e);return hl(this.lat,this.lng,Ks+t)}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}();function El(e){return Sl*Math.cos(e*Math.PI/180)}function Pl(e){return(180+e)/360}function Ml(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Il(e,t){return e/El(t)}function Al(e){return 360*e-180}function Rl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Ol(e,t){return e*El(Rl(t))}var Nl=85.051129;function Dl(e){return 1/Math.cos(e*Math.PI/180)}var zl=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,e),this.x=+t,this.y=+n,this.z=+i}return _createClass(e,[{key:"toLngLat",value:function(){return new Tl(Al(this.x),Rl(this.y))}},{key:"toAltitude",value:function(){return Ol(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/Sl*Dl(Rl(this.y))}}],[{key:"fromLngLat",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=Tl.convert(t);return new e(Pl(i.lng),Ml(i.lat),Il(n,i.lat))}}]),e}();function Ll(e,t,n,i,r,a,o,s,l){var u=(t+i)/2,c=(n+r)/2,h=new y(u,c);s(h),function(e,t,n,i,r,a){var o=n-r,s=i-a;return Math.abs((i-t)*o-(n-e)*s)/Math.hypot(o,s)}(h.x,h.y,a.x,a.y,o.x,o.y)>=l?(Ll(e,t,n,u,c,a,h,s,l),Ll(e,u,c,i,r,h,o,s,l)):e.push(o)}function Bl(e,t,n){var i=e[0],r=i.x,a=i.y;t(i);for(var o=[i],s=1;s<e.length;s++){var l=e[s],u=l.x,c=l.y;t(l),Ll(o,r,a,u,c,i,l,t,n),r=u,a=c,i=l}return o}function Fl(e,t,n,i){if(i(t,n)){var r=t.add(n)._mult(.5);Fl(e,t,r,i),Fl(e,r,n,i)}else e.push(n)}function jl(e,t){for(var n=e[0],i=[n],r=1;r<e.length;r++){var a=e[r];Fl(i,n,a,t),n=a}return i}var Hl=Math.pow(2,14)-1,Vl=-Hl-1;function Ul(e,t){var n=Math.round(e.x*t),i=Math.round(e.y*t);return e.x=E(n,Vl,Hl),e.y=E(i,Vl,Hl),(n<e.x||n>e.x+1||i<e.y||i>e.y+1)&&q("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function ql(e,t,n){var i=e.loadGeometry(),r=e.extent,a=Qo/r;if(t&&n&&n.projection.isReprojectedInTileSpace)for(var o=1<<t.z,s=n.scale,l=n.x,u=n.y,c=n.projection,h=function(e){var n=Al((t.x+e.x/r)/o),i=Rl((t.y+e.y/r)/o),a=c.project(n,i);e.x=(a.x*s-l)*r,e.y=(a.y*s-u)*r},d=0;d<i.length;d++)if(1!==e.type)i[d]=Bl(i[d],h,1);else{var f,p=[],m=_createForOfIteratorHelper(i[d]);try{for(m.s();!(f=m.n()).done;){var v=f.value;v.x<0||v.x>=r||v.y<0||v.y>=r||(h(v),p.push(v))}}catch(b){m.e(b)}finally{m.f()}i[d]=p}var g,y=_createForOfIteratorHelper(i);try{for(y.s();!(g=y.n()).done;){var _,x=_createForOfIteratorHelper(g.value);try{for(x.s();!(_=x.n()).done;){Ul(_.value,a)}}catch(b){x.e(b)}finally{x.f()}}}catch(b){y.e(b)}finally{y.f()}return i}function Gl(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ql(e):[]}}function Wl(e,t,n,i,r){e.emplaceBack(2*t+(i+1)/2,2*n+(r+1)/2)}function Zl(e,t,n){var i=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*i,n[1]*i,n[2]*i)}var Xl=function(){function e(t){_classCallCheck(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Ra,this.indexArray=new Xa,this.segments=new Jo,this.programConfigurations=new Ho(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return _createClass(e,[{key:"populate",value:function(e,t,n,i){var r=this.layers[0],a=[],o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));var s,l=_createForOfIteratorHelper(e);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.feature,h=u.id,d=u.index,f=u.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,m=Gl(c,p);if(this.layers[0]._featureFilter.filter(new fa(this.zoom),m,n)){var v=o?o.evaluate(m,{},n):void 0,g={id:h,properties:c.properties,type:c.type,sourceLayerIndex:f,index:d,geometry:p?m.geometry:ql(c,n,i),patterns:{},sortKey:v};a.push(g)}}}catch(T){l.e(T)}finally{l.f()}o&&a.sort((function(e,t){return e.sortKey-t.sortKey}));var y=null;"globe"===i.projection.name&&(this.globeExtVertexArray=new Fa,y=i.projection);for(var _=0,x=a;_<x.length;_++){var b=x[_],w=b.geometry,k=b.index,C=b.sourceLayerIndex,S=e[k].feature;this.addFeature(b,w,k,t.availableImages,n,y),t.featureIndex.insert(S,w,k,C,this.index)}}},{key:"update",value:function(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ko.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Yo.members))),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}},{key:"addFeature",value:function(e,t,n,i,r,a){var o,s=_createForOfIteratorHelper(t);try{for(s.s();!(o=s.n()).done;){var l,u=_createForOfIteratorHelper(o.value);try{for(u.s();!(l=u.n()).done;){var c=l.value,h=c.x,d=c.y;if(!(h<0||h>=Qo||d<0||d>=Qo)){if(a){var f=a.projectTilePoint(h,d,r),p=a.upVector(r,h,d),m=this.globeExtVertexArray;Zl(m,f,p),Zl(m,f,p),Zl(m,f,p),Zl(m,f,p)}var v=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),g=v.vertexLength;Wl(this.layoutVertexArray,h,d,-1,-1),Wl(this.layoutVertexArray,h,d,1,-1),Wl(this.layoutVertexArray,h,d,1,1),Wl(this.layoutVertexArray,h,d,-1,1),this.indexArray.emplaceBack(g,g+1,g+2),this.indexArray.emplaceBack(g,g+2,g+3),v.vertexLength+=4,v.primitiveLength+=2}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){s.e(y)}finally{s.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i,r)}}]),e}();function Kl(e,t){for(var n=0;n<e.length;n++)if(ru(t,e[n]))return!0;for(var i=0;i<t.length;i++)if(ru(e,t[i]))return!0;return!!$l(e,t)}function Yl(e,t,n){return!!ru(e,t)||!!tu(t,e,n)}function Jl(e,t){if(1===e.length)return iu(t,e[0]);for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<i.length;r++)if(ru(e,i[r]))return!0;for(var a=0;a<e.length;a++)if(iu(t,e[a]))return!0;for(var o=0;o<t.length;o++)if($l(e,t[o]))return!0;return!1}function Ql(e,t,n){if(e.length>1){if($l(e,t))return!0;for(var i=0;i<t.length;i++)if(tu(t[i],e,n))return!0}for(var r=0;r<e.length;r++)if(tu(e[r],t,n))return!0;return!1}function $l(e,t){if(0===e.length||0===t.length)return!1;for(var n=0;n<e.length-1;n++)for(var i=e[n],r=e[n+1],a=0;a<t.length-1;a++)if(eu(i,r,t[a],t[a+1]))return!0;return!1}function eu(e,t,n,i){return G(e,n,i)!==G(t,n,i)&&G(e,t,n)!==G(e,t,i)}function tu(e,t,n){var i=n*n;if(1===t.length)return e.distSqr(t[0])<i;for(var r=1;r<t.length;r++)if(nu(e,t[r-1],t[r])<i)return!0;return!1}function nu(e,t,n){var i=t.distSqr(n);if(0===i)return e.distSqr(t);var r=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return e.distSqr(r<0?t:r>1?n:n.sub(t)._mult(r)._add(t))}function iu(e,t){for(var n,i,r,a=!1,o=0;o<e.length;o++)for(var s=0,l=(n=e[o]).length-1;s<n.length;l=s++)i=n[s],r=n[l],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(a=!a);return a}function ru(e,t){for(var n=!1,i=0,r=e.length-1;i<e.length;r=i++){var a=e[i],o=e[r];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(n=!n)}return n}function au(e,t,n,i,r){var a,o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t<=s.x&&n<=s.y&&i>=s.x&&r>=s.y)return!0}}catch(d){o.e(d)}finally{o.f()}var l=[new y(t,n),new y(t,r),new y(i,r),new y(i,n)];if(e.length>2){var u,c=_createForOfIteratorHelper(l);try{for(c.s();!(u=c.n()).done;){if(ru(e,u.value))return!0}}catch(d){c.e(d)}finally{c.f()}}for(var h=0;h<e.length-1;h++)if(ou(e[h],e[h+1],l))return!0;return!1}function ou(e,t,n){var i=n[0],r=n[2];if(e.x<i.x&&t.x<i.x||e.x>r.x&&t.x>r.x||e.y<i.y&&t.y<i.y||e.y>r.y&&t.y>r.y)return!1;var a=G(e,t,n[0]);return a!==G(e,t,n[1])||a!==G(e,t,n[2])||a!==G(e,t,n[3])}function su(e,t,n){var i=t.paint.get(e).value;return"constant"===i.kind?i.value:n.programConfigurations.get(t.id).getMaxValue(e)}function lu(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function uu(e,t,n,i,r){if(!t[0]&&!t[1])return e;var a=y.convert(t)._mult(r);"viewport"===n&&a._rotate(-i);for(var o=[],s=0;s<e.length;s++)o.push(e[s].sub(a));return o}function cu(e,t,n,i){var r=y.convert(e)._mult(i);return"viewport"===t&&r._rotate(-n),r}mr(Xl,"CircleBucket",{omit:["layers"]});var hu=new Sa({"circle-sort-key":new ka($e.layout_circle["circle-sort-key"])}),du={paint:new Sa({"circle-radius":new ka($e.paint_circle["circle-radius"]),"circle-color":new ka($e.paint_circle["circle-color"]),"circle-blur":new ka($e.paint_circle["circle-blur"]),"circle-opacity":new ka($e.paint_circle["circle-opacity"]),"circle-translate":new wa($e.paint_circle["circle-translate"]),"circle-translate-anchor":new wa($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wa($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wa($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ka($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ka($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ka($e.paint_circle["circle-stroke-opacity"])}),layout:hu};function fu(e,t,n,i,r,a,o,s,l){if(a&&e.queryGeometry.isAboveHorizon)return!1;a&&(l*=e.pixelToTileUnitsFactor);var u,c=e.tileID.canonical,h=n.projection.upVectorScale(c,n.center.lat,n.worldSize).metersToTile,d=_createForOfIteratorHelper(t);try{for(d.s();!(u=d.n()).done;){var f,p=_createForOfIteratorHelper(u.value);try{var m,v=function(){var t=f.value,u=t.add(s),d=r&&n.elevation?n.elevation.exaggeration()*r.getElevationAt(u.x,u.y,!0):0,p=n.projection.projectTilePoint(u.x,u.y,c);if(d>0){var m=n.projection.upVector(c,u.x,u.y);p.x+=m[0]*h*d,p.y+=m[1]*h*d,p.z+=m[2]*h*d}var v=a?u:pu(p.x,p.y,p.z,i),g=a?e.tilespaceRays.map((function(e){return gu(e,d)})):e.queryGeometry.screenGeometry,y=zs([],[p.x,p.y,p.z,1],i);if(!o&&a?l*=y[3]/n.cameraToCenterDistance:o&&!a&&(l*=n.cameraToCenterDistance/y[3]),a){var _=Rl((t.y/Qo+c.y)/(1<<c.z));l/=n.projection.pixelsPerMeter(_,1)/Il(1,_)}if(Yl(g,v,l))return{v:!0}};for(p.s();!(f=p.n()).done;)if(m=v())return m.v}catch(g){p.e(g)}finally{p.f()}}}catch(g){d.e(g)}finally{d.f()}return!1}function pu(e,t,n,i){var r=zs([],[e,t,n,1],i);return new y(r[0]/r[3],r[1]/r[3])}var mu=gs(0,0,0),vu=gs(0,0,1);function gu(e,t){var n=ps();return mu[2]=t,e.intersectsPlane(mu,vu,n),new y(n[0],n[1])}var yu=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(Xl);function _u(e,t,n,i){var r=t.width,a=t.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==r*a*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(r*a*n);return e.width=r,e.height=a,e.data=i,e}function xu(e,t,n){var i=t.width,r=t.height;i===e.width&&r===e.height||(bu(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,i),height:Math.min(e.height,r)},n),e.width=i,e.height=r,e.data=t.data)}function bu(e,t,n,i,r,a){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||i.x>t.width-r.width||i.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,l=0;l<r.height;l++)for(var u=((n.y+l)*e.width+n.x)*a,c=((i.y+l)*t.width+i.x)*a,h=0;h<r.width*a;h++)s[c+h]=o[u+h];return t}mr(yu,"HeatmapBucket",{omit:["layers"]});var wu=function(){function e(t,n){_classCallCheck(this,e),_u(this,t,1,n)}return _createClass(e,[{key:"resize",value:function(t){xu(this,new e(t),1)}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,n,i,r){bu(e,t,n,i,r,1)}}]),e}(),ku=function(){function e(t,n){_classCallCheck(this,e),_u(this,t,4,n)}return _createClass(e,[{key:"resize",value:function(t){xu(this,new e(t),4)}},{key:"replace",value:function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,n,i,r){bu(e,t,n,i,r,4)}}]),e}();mr(wu,"AlphaImage"),mr(ku,"RGBAImage");var Cu={paint:new Sa({"heatmap-radius":new ka($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ka($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wa($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ca($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wa($e.paint_heatmap["heatmap-opacity"])})};function Su(e){var t={},n=e.resolution||256,i=e.clips?e.clips.length:1,r=e.image||new ku({width:n,height:i}),a=function(n,i,a){t[e.evaluationKey]=a;var o=e.expression.evaluate(t);r.data[n+i+0]=Math.floor(255*o.r/o.a),r.data[n+i+1]=Math.floor(255*o.g/o.a),r.data[n+i+2]=Math.floor(255*o.b/o.a),r.data[n+i+3]=Math.floor(255*o.a)};if(e.clips)for(var o=0,s=0;o<i;++o,s+=4*n)for(var l=0,u=0;l<n;l++,u+=4){var c=l/(n-1),h=e.clips[o];a(s,u,h.start*(1-c)+h.end*c)}else for(var d=0,f=0;d<n;d++,f+=4)a(0,f,d/(n-1));return r}var Tu={paint:new Sa({"hillshade-illumination-direction":new wa($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wa($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wa($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wa($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wa($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wa($e.paint_hillshade["hillshade-accent-color"])})},Eu=Ia([{name:"a_pos",components:2,type:"Int16"}],4).members,Pu={exports:{}};function Mu(e,t,n){n=n||2;var i,r,a,o,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=Iu(e,0,h,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(e,t,n,i){var r,a,o,s=[];for(r=0,a=t.length;r<a;r++)(o=Iu(e,t[r]*i,r<a-1?t[r+1]*i:e.length,i,!1))===o.next&&(o.steiner=!0),s.push(Hu(o));for(s.sort(Lu),r=0;r<s.length;r++)n=Bu(s[r],n);return n}(e,t,d,n)),e.length>80*n){i=a=e[0],r=o=e[1];for(var p=n;p<h;p+=n)(s=e[p])<i&&(i=s),(l=e[p+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-i,o-r))?32767/u:0}return Ru(d,f,n,i,r,u,0),f}function Iu(e,t,n,i,r){var a,o;if(r===ec(e,t,n,i)>0)for(a=t;a<n;a+=i)o=Ju(a,e[a],e[a+1],o);else for(a=n-i;a>=t;a-=i)o=Ju(a,e[a],e[a+1],o);return o&&Gu(o,o.next)&&(Qu(o),o=o.next),o}function Au(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!Gu(i,i.next)&&0!==qu(i.prev,i,i.next))i=i.next;else{if(Qu(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function Ru(e,t,n,i,r,a,o){if(e){!o&&a&&function(e,t,n,i){var r=e;do{0===r.z&&(r.z=ju(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,i=n,s=0,t=0;t<u&&(s++,i=i.nextZ);t++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(e,i,r,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Nu(e,i,r,a):Ou(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),Qu(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Ru(e=Du(Au(e),t,n),t,n,i,r,a,2):2===o&&zu(e,t,n,i,r,a):Ru(Au(e),t,n,i,r,a,1);break}}}function Ou(e){var t=e.prev,n=e,i=e.next;if(qu(t,n,i)>=0)return!1;for(var r=t.x,a=n.x,o=i.x,s=t.y,l=n.y,u=i.y,c=r<a?r<o?r:o:a<o?a:o,h=s<l?s<u?s:u:l<u?l:u,d=r>a?r>o?r:o:a>o?a:o,f=s>l?s>u?s:u:l>u?l:u,p=i.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&Vu(r,s,a,l,o,u,p.x,p.y)&&qu(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Nu(e,t,n,i){var r=e.prev,a=e,o=e.next;if(qu(r,a,o)>=0)return!1;for(var s=r.x,l=a.x,u=o.x,c=r.y,h=a.y,d=o.y,f=s<l?s<u?s:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,m=s>l?s>u?s:u:l>u?l:u,v=c>h?c>d?c:d:h>d?h:d,g=ju(f,p,t,n,i),y=ju(m,v,t,n,i),_=e.prevZ,x=e.nextZ;_&&_.z>=g&&x&&x.z<=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=v&&_!==r&&_!==o&&Vu(s,c,l,h,u,d,_.x,_.y)&&qu(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&Vu(s,c,l,h,u,d,x.x,x.y)&&qu(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=g;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=v&&_!==r&&_!==o&&Vu(s,c,l,h,u,d,_.x,_.y)&&qu(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&Vu(s,c,l,h,u,d,x.x,x.y)&&qu(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Du(e,t,n){var i=e;do{var r=i.prev,a=i.next.next;!Gu(r,a)&&Wu(r,i,i.next,a)&&Ku(r,a)&&Ku(a,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(a.i/n|0),Qu(i),Qu(i.next),i=e=a),i=i.next}while(i!==e);return Au(i)}function zu(e,t,n,i,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Uu(o,s)){var l=Yu(o,s);return o=Au(o,o.next),l=Au(l,l.next),Ru(o,t,n,i,r,a,0),void Ru(l,t,n,i,r,a,0)}s=s.next}o=o.next}while(o!==e)}function Lu(e,t){return e.x-t.x}function Bu(e,t){var n=function(e,t){var n,i=t,r=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o&&(o=s,n=i.x<i.next.x?i:i.next,s===r))return n}i=i.next}while(i!==t);if(!n)return null;var l,u=n,c=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&Vu(a<h?r:o,a,c,h,a<h?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),Ku(i,e)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&Fu(n,i)))&&(n=i,d=l)),i=i.next}while(i!==u);return n}(e,t);if(!n)return t;var i=Yu(n,e);return Au(i,i.next),Au(n,n.next)}function Fu(e,t){return qu(e.prev,e,t.prev)<0&&qu(t.next,e,e.next)<0}function ju(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Hu(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Vu(e,t,n,i,r,a,o,s){return(r-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(i-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(r-o)*(i-s)}function Uu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Wu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Ku(e,t)&&Ku(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(qu(e.prev,e,t.prev)||qu(e,t.prev,t))||Gu(e,t)&&qu(e.prev,e,e.next)>0&&qu(t.prev,t,t.next)>0)}function qu(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Gu(e,t){return e.x===t.x&&e.y===t.y}function Wu(e,t,n,i){var r=Xu(qu(e,t,n)),a=Xu(qu(e,t,i)),o=Xu(qu(n,i,e)),s=Xu(qu(n,i,t));return r!==a&&o!==s||!(0!==r||!Zu(e,n,t))||!(0!==a||!Zu(e,i,t))||!(0!==o||!Zu(n,e,i))||!(0!==s||!Zu(n,t,i))}function Zu(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Xu(e){return e>0?1:e<0?-1:0}function Ku(e,t){return qu(e.prev,e,e.next)<0?qu(e,t,e.next)>=0&&qu(e,e.prev,t)>=0:qu(e,t,e.prev)<0||qu(e,e.next,t)<0}function Yu(e,t){var n=new $u(e.i,e.x,e.y),i=new $u(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function Ju(e,t,n,i){var r=new $u(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Qu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $u(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ec(e,t,n,i){for(var r=0,a=t,o=n-i;a<n;a+=i)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}Pu.exports=Mu,Pu.exports.default=Mu,Mu.deviation=function(e,t,n,i){var r=t&&t.length,a=Math.abs(ec(e,0,r?t[0]*n:e.length,n));if(r)for(var o=0,s=t.length;o<s;o++)a-=Math.abs(ec(e,t[o]*n,o<s-1?t[o+1]*n:e.length,n));var l=0;for(o=0;o<i.length;o+=3){var u=i[o]*n,c=i[o+1]*n,h=i[o+2]*n;l+=Math.abs((e[u]-e[h])*(e[c+1]-e[u+1])-(e[u]-e[c])*(e[h+1]-e[u+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},Mu.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var o=0;o<t;o++)n.vertices.push(e[r][a][o]);r>0&&n.holes.push(i+=e[r-1].length)}return n};var tc=d(Pu.exports);function nc(e,t,n,i,r){!function e(t,n,i,r,a){for(;r>i;){if(r-i>600){var o=r-i+1,s=n-i+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);e(t,n,Math.max(i,Math.floor(n-s*u/o+c)),Math.min(r,Math.floor(n+(o-s)*u/o+c)),a)}var h=t[n],d=i,f=r;for(ic(t,i,n),a(t[r],h)>0&&ic(t,i,r);d<f;){for(ic(t,d,f),d++,f--;a(t[d],h)<0;)d++;for(;a(t[f],h)>0;)f--}0===a(t[i],h)?ic(t,i,f):ic(t,++f,r),f<=n&&(i=f+1),n<=f&&(r=f-1)}}(e,t,n||0,i||e.length-1,r||rc)}function ic(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function rc(e,t){return e<t?-1:e>t?1:0}function ac(e,t){var n=e.length;if(n<=1)return[e];for(var i,r,a=[],o=0;o<n;o++){var s=W(e[o]);0!==s&&(e[o].area=Math.abs(s),void 0===r&&(r=s<0),r===s<0?(i&&a.push(i),i=[e[o]]):i.push(e[o]))}if(i&&a.push(i),t>1)for(var l=0;l<a.length;l++)a[l].length<=t||(nc(a[l],t,1,a[l].length-1,oc),a[l]=a[l].slice(0,t));return a}function oc(e,t){return t.area-e.area}function sc(e,t,n){var i,r=n.patternDependencies,a=!1,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var s=i.value.paint.get(e+"-pattern");s.isConstant()||(a=!0);var l=s.constantOr(null);l&&(a=!0,r[l]=!0)}}catch(u){o.e(u)}finally{o.f()}return a}function lc(e,t,n,i,r){var a,o=r.patternDependencies,s=_createForOfIteratorHelper(t);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=l.paint.get(e+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:i},n,{},r.availableImages);o[c=c&&c.name?c.name:c]=!0,n.patterns[l.id]=c}}}catch(h){s.e(h)}finally{s.f()}return n}var uc=function(){function e(t){_classCallCheck(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ra,this.indexArray=new Xa,this.indexArray2=new eo,this.programConfigurations=new Ho(t.layers,t.zoom),this.segments=new Jo,this.segments2=new Jo,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.projection=t.projection}return _createClass(e,[{key:"populate",value:function(e,t,n,i){this.hasPattern=sc("fill",this.layers,t);var r,a=this.layers[0].layout.get("fill-sort-key"),o=[],s=_createForOfIteratorHelper(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,d=l.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,p=Gl(u,f);if(this.layers[0]._featureFilter.filter(new fa(this.zoom),p,n)){var m=a?a.evaluate(p,{},n,t.availableImages):void 0,v={id:c,properties:u.properties,type:u.type,sourceLayerIndex:d,index:h,geometry:f?p.geometry:ql(u,n,i),patterns:{},sortKey:m};o.push(v)}}}catch(C){s.e(C)}finally{s.f()}a&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,y=o;g<y.length;g++){var _=y[g],x=_.geometry,b=_.index,w=_.sourceLayerIndex;if(this.hasPattern){var k=lc("fill",this.layers,_,this.zoom,t);this.patternFeatures.push(k)}else this.addFeature(_,x,b,n,{},t.availableImages);t.featureIndex.insert(e[b].feature,x,b,w,this.index)}}},{key:"update",value:function(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}},{key:"addFeatures",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(this.patternFeatures);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.addFeature(s,s.geometry,s.index,t,n,i)}}catch(l){o.e(l)}finally{o.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Eu),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}},{key:"addFeature",value:function(e,t,n,i,r){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=_createForOfIteratorHelper(ac(t,500));try{for(s.s();!(a=s.n()).done;){var l,u=a.value,c=0,h=_createForOfIteratorHelper(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;c+=d.length}}catch(S){h.e(S)}finally{h.f()}var f,p=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray),m=p.vertexLength,v=[],g=[],y=_createForOfIteratorHelper(u);try{for(y.s();!(f=y.n()).done;){var _=f.value;if(0!==_.length){_!==u[0]&&g.push(v.length/2);var x=this.segments2.prepareSegment(_.length,this.layoutVertexArray,this.indexArray2),b=x.vertexLength;this.layoutVertexArray.emplaceBack(_[0].x,_[0].y),this.indexArray2.emplaceBack(b+_.length-1,b),v.push(_[0].x),v.push(_[0].y);for(var w=1;w<_.length;w++)this.layoutVertexArray.emplaceBack(_[w].x,_[w].y),this.indexArray2.emplaceBack(b+w-1,b+w),v.push(_[w].x),v.push(_[w].y);x.vertexLength+=_.length,x.primitiveLength+=_.length}}}catch(S){y.e(S)}finally{y.f()}for(var k=tc(v,g),C=0;C<k.length;C+=3)this.indexArray.emplaceBack(m+k[C],m+k[C+1],m+k[C+2]);p.vertexLength+=c,p.primitiveLength+=k.length/3}}catch(S){s.e(S)}finally{s.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,o,i)}}]),e}();mr(uc,"FillBucket",{omit:["layers","patternFeatures"]});var cc=new Sa({"fill-sort-key":new ka($e.layout_fill["fill-sort-key"])}),hc={paint:new Sa({"fill-antialias":new wa($e.paint_fill["fill-antialias"]),"fill-opacity":new ka($e.paint_fill["fill-opacity"]),"fill-color":new ka($e.paint_fill["fill-color"]),"fill-outline-color":new ka($e.paint_fill["fill-outline-color"]),"fill-translate":new wa($e.paint_fill["fill-translate"]),"fill-translate-anchor":new wa($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new ka($e.paint_fill["fill-pattern"])}),layout:cc},dc=Ia([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fc=Ia([{name:"a_centroid_pos",components:2,type:"Uint16"}]),pc=Ia([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),mc=dc.members,vc={},gc=v,yc=_c;function _c(e,t,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=r,e.readFields(xc,this,t)}function xc(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var i=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[i]=r}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function bc(e){for(var t,n,i=0,r=0,a=e.length,o=a-1;r<a;o=r++)i+=((n=e[o]).x-(t=e[r]).x)*(t.y+n.y);return i}_c.types=["Unknown","Point","LineString","Polygon"],_c.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,i=1,r=0,a=0,o=0,s=[];e.pos<n;){if(r<=0){var l=e.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)a+=e.readSVarint(),o+=e.readSVarint(),1===i&&(t&&s.push(t),t=[]),t.push(new gc(a,o));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&s.push(t),s},_c.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,i=0,r=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(i<=0){var c=e.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)(r+=e.readSVarint())<o&&(o=r),r>s&&(s=r),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,s,u]},_c.prototype.toGeoJSON=function(e,t,n){var i,r,a=this.extent*Math.pow(2,n),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=_c.types[this.type];function c(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];c(l=h);break;case 2:for(i=0;i<l.length;i++)c(l[i]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var n,i,r=[],a=0;a<t;a++){var o=bc(e[a]);0!==o&&(void 0===i&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)c(l[i][r])}1===l.length?l=l[0]:u="Multi"+u;var d={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var wc=yc,kc=Cc;function Cc(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Sc,this,t),this.length=this._features.length}function Sc(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var i=e.readVarint()>>3;t=1===i?e.readString():2===i?e.readFloat():3===i?e.readDouble():4===i?e.readVarint64():5===i?e.readVarint():6===i?e.readSVarint():7===i?e.readBoolean():null}return t}(n))}Cc.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new wc(this._pbf,t,this.extent,this._keys,this._values)};var Tc=kc;function Ec(e,t,n){if(3===e){var i=new Tc(n,n.readVarint()+n.pos);i.length&&(t[i.name]=i)}}var Pc=vc.VectorTile=function(e,t){this.layers=e.readFields(Ec,{},t)},Mc=vc.VectorTileFeature=yc;function Ic(e,t,n,i){var r,a=[],o=0===i?function(e,t,n,i,r,a){e.push(new y(a,n+(a-t)/(i-t)*(r-n)))}:function(e,t,n,i,r,a){e.push(new y(t+(a-n)/(r-n)*(i-t),a))},s=_createForOfIteratorHelper(e);try{for(s.s();!(r=s.n()).done;){var l,u=r.value,c=[],h=_createForOfIteratorHelper(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;if(!(d.length<=2)){for(var f=[],p=0;p<d.length-1;p++){var m=d[p].x,v=d[p].y,g=d[p+1].x,_=d[p+1].y,x=0===i?m:v,b=0===i?g:_;x<t?b>t&&o(f,m,v,g,_,t):x>n?b<n&&o(f,m,v,g,_,n):f.push(d[p]),b<t&&x>=t&&o(f,m,v,g,_,t),b>n&&x<=n&&o(f,m,v,g,_,n)}var w=d[d.length-1],k=0===i?w.x:w.y;k>=t&&k<=n&&f.push(w),f.length&&(w=f[f.length-1],f[0].x===w.x&&f[0].y===w.y||f.push(f[0]),c.push(f))}}}catch(C){h.e(C)}finally{h.f()}c.length&&a.push(c)}}catch(C){s.e(C)}finally{s.f()}return a}vc.VectorTileLayer=kc;var Ac=Mc.types,Rc=Math.pow(2,13);function Oc(e,t,n,i,r,a,o,s){e.emplaceBack((t<<1)+o,(n<<1)+a,(Math.floor(i*Rc)<<1)+r,Math.round(s))}function Nc(e,t,n){var i=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*i,n[1]*i,n[2]*i)}var Dc=function(){function e(){_classCallCheck(this,e),this.acc=new y(0,0),this.polyCount=[]}return _createClass(e,[{key:"startRing",value:function(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new y(e.x,e.y),this.max=new y(e.x,e.y))}},{key:"append",value:function(e,t){this.currentPolyCount.edges++,this.acc._add(e);var n=this.min,i=this.max;e.x<n.x?n.x=e.x:e.x>i.x&&(i.x=e.x),e.y<n.y?n.y=e.y:e.y>i.y&&(i.y=e.y),((0===e.x||e.x===Qo)&&e.x===t.x)!=((0===e.y||e.y===Qo)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,xn(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Qo!=e.x>Qo&&this.addBorderIntersection(1,xn(t.y,e.y,(Qo-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,xn(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Qo!=e.y>Qo&&this.addBorderIntersection(3,xn(t.x,e.x,(Qo-t.y)/(e.y-t.y)))}},{key:"addBorderIntersection",value:function(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);var n=this.borders[e];t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t)}},{key:"processBorderOverlap",value:function(e,t){if(e.x===t.x){if(e.y===t.y)return;var n=0===e.x?0:1;this.addBorderIntersection(n,t.y),this.addBorderIntersection(n,e.y)}else{var i=0===e.y?2:3;this.addBorderIntersection(i,t.x),this.addBorderIntersection(i,e.x)}}},{key:"centroid",value:function(){var e=this.polyCount.reduce((function(e,t){return e+t.edges}),0);return 0!==e?this.acc.div(e)._round():new y(0,0)}},{key:"span",value:function(){return new y(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"intersectsCount",value:function(){return this.borders.reduce((function(e,t){return e+ +(t[0]!==Number.MAX_VALUE)}),0)}}]),e}(),zc=function(){function e(t){_classCallCheck(this,e),this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new Na,this.centroidVertexArray=new po,this.indexArray=new Xa,this.programConfigurations=new Ho(t.layers,t.zoom),this.segments=new Jo,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.enableTerrain=t.enableTerrain}return _createClass(e,[{key:"populate",value:function(e,t,n,i){this.features=[],this.hasPattern=sc("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){var t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/Qo/(1<<e.z)}(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;var r,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.feature,l=o.id,u=o.index,c=o.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d=Gl(s,h);if(this.layers[0]._featureFilter.filter(new fa(this.zoom),d,n)){var f={id:l,sourceLayerIndex:c,index:u,geometry:h?d.geometry:ql(s,n,i),properties:s.properties,type:s.type,patterns:{}},p=this.layoutVertexArray.length;this.hasPattern?this.features.push(lc("fill-extrusion",this.layers,f,this.zoom,t)):this.addFeature(f,f.geometry,u,n,{},t.availableImages,i),t.featureIndex.insert(s,f.geometry,u,c,this.index,p)}}}catch(m){a.e(m)}finally{a.f()}this.sortBorders()}},{key:"addFeatures",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(this.features);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.geometry;this.addFeature(s,l,s.index,t,n,i,r)}}catch(u){o.e(u)}finally{o.f()}this.sortBorders()}},{key:"update",value:function(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,pc.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"uploadCentroid",value:function(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,fc.members,!0),this.needsCentroidUpdate=!1)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"addFeature",value:function(e,t,n,i,r,a,o){var s=[new y(0,0),new y(Qo,Qo)],l=o.projection,u="globe"===l.name,c=this.enableTerrain&&!u?new Dc:null,h="Polygon"===Ac[e.type];u&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Fa);for(var d,f,p=ac(t,500),m=p.length-1;m>=0;m--){var v=p[m];(0===v.length||(d=v[0]).every((function(e){return e.x<=0}))||d.every((function(e){return e.x>=Qo}))||d.every((function(e){return e.y<=0}))||d.every((function(e){return e.y>=Qo})))&&p.splice(m,1)}if(u)f=qc(p,s,i);else{f=[];var g,_=_createForOfIteratorHelper(p);try{for(_.s();!(g=_.n()).done;){var x=g.value;f.push({polygon:x,bounds:s})}}catch(Me){_.e(Me)}finally{_.f()}}var b,w=h?this.edgeRadius:0,k=_createForOfIteratorHelper(f);try{for(k.s();!(b=k.n()).done;){var C,S=b.value,T=S.polygon,E=S.bounds,P=0,M=0,I=_createForOfIteratorHelper(T);try{for(I.s();!(C=I.n()).done;){var A=C.value;h&&!A[0].equals(A[A.length-1])&&A.push(A[0]),M+=h?A.length-1:A.length}}catch(Me){I.e(Me)}finally{I.f()}var R=this.segments.prepareSegment((h?5:4)*M,this.layoutVertexArray,this.indexArray);if(h){var O=[],N=[];P=R.vertexLength;var D,z=_createForOfIteratorHelper(T);try{for(z.s();!(D=z.n()).done;){var L=D.value,B=void 0,F=void 0;L.length&&L!==T[0]&&N.push(O.length/2),B=L[1].sub(L[0])._perp()._unit();for(var j=1;j<L.length;j++){var H=L[j],V=L[j===L.length-1?1:j+1],U=H.x,q=H.y;if(w){F=V.sub(H)._perp()._unit();var G=B.add(F)._unit(),W=w*Math.min(4,1/(B.x*G.x+B.y*G.y));U+=W*G.x,q+=W*G.y,B=F}Oc(this.layoutVertexArray,U,q,0,0,1,1,0),R.vertexLength++,O.push(H.x,H.y),u&&Nc(this.layoutVertexExtArray,l.projectTilePoint(U,q,i),l.upVector(i,U,q))}}}catch(Me){z.e(Me)}finally{z.f()}for(var Z=tc(O,N),X=0;X<Z.length;X+=3)this.indexArray.emplaceBack(P+Z[X],P+Z[X+2],P+Z[X+1]),R.primitiveLength++}var K,Y=_createForOfIteratorHelper(T);try{for(Y.s();!(K=Y.n()).done;){var J=K.value;c&&J.length&&c.startRing(J[0]);var Q=void 0,$=void 0,ee=void 0,te=J.length>4&&Hc(J[J.length-2],J[0],J[1]),ne=w?Bc(J[J.length-2],J[0],J[1],w):0;$=J[1].sub(J[0])._perp()._unit();for(var ie=!0,re=1,ae=0;re<J.length;re++){var oe=J[re-1],se=J[re],le=J[re===J.length-1?1:re+1];if(c&&h&&c.currentPolyCount.top++,jc(se,oe,E))w&&($=le.sub(se)._perp()._unit(),ie=!ie);else{c&&c.append(se,oe);var ue=se.sub(oe)._perp(),ce=ue.x/(Math.abs(ue.x)+Math.abs(ue.y)),he=ue.y>0?1:0,de=oe.dist(se);if(ae+de>32768&&(ae=0),w){ee=le.sub(se)._perp()._unit();var fe=Fc(oe,se,le,Lc($,ee),w);isNaN(fe)&&(fe=0);var pe=se.sub(oe)._unit();oe=oe.add(pe.mult(ne))._round(),se=se.add(pe.mult(-fe))._round(),ne=fe,$=ee}var me=R.vertexLength,ve=J.length>4&&Hc(oe,se,le),ge=Vc(ae,te,ie);if(Oc(this.layoutVertexArray,oe.x,oe.y,ce,he,0,0,ge),Oc(this.layoutVertexArray,oe.x,oe.y,ce,he,0,1,ge),ge=Vc(ae+=de,ve,!ie),te=ve,Oc(this.layoutVertexArray,se.x,se.y,ce,he,0,0,ge),Oc(this.layoutVertexArray,se.x,se.y,ce,he,0,1,ge),R.vertexLength+=4,this.indexArray.emplaceBack(me+0,me+1,me+2),this.indexArray.emplaceBack(me+1,me+3,me+2),R.primitiveLength+=2,w){var ye=P+(1===re?J.length-2:re-2),_e=1===re?P:ye+1;if(this.indexArray.emplaceBack(me+1,ye,me+3),this.indexArray.emplaceBack(ye,_e,me+3),R.primitiveLength+=2,void 0===Q&&(Q=me),!jc(le,J[re],E)){var xe=re===J.length-1?Q:R.vertexLength;this.indexArray.emplaceBack(me+2,me+3,xe),this.indexArray.emplaceBack(me+3,xe+1,xe),this.indexArray.emplaceBack(me+3,_e,xe+1),R.primitiveLength+=3}ie=!ie}if(u){var be=this.layoutVertexExtArray,we=l.projectTilePoint(oe.x,oe.y,i),ke=l.projectTilePoint(se.x,se.y,i),Ce=l.upVector(i,oe.x,oe.y),Se=l.upVector(i,se.x,se.y);Nc(be,we,Ce),Nc(be,we,Ce),Nc(be,ke,Se),Nc(be,ke,Se)}}}h&&(P+=J.length-1)}}catch(Me){Y.e(Me)}finally{Y.f()}}}catch(Me){k.e(Me)}finally{k.f()}if(c&&c.polyCount.length>0){if(c.borders){c.vertexArrayOffset=this.centroidVertexArray.length;for(var Te=c.borders,Ee=this.featuresOnBorder.push(c)-1,Pe=0;Pe<4;Pe++)Te[Pe][0]!==Number.MAX_VALUE&&this.borders[Pe].push(Ee)}this.encodeCentroid(c.borders?void 0:c.centroid(),c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,a,i)}},{key:"sortBorders",value:function(){for(var e=this,t=function(t){e.borders[t].sort((function(n,i){return e.featuresOnBorder[n].borders[t][0]-e.featuresOnBorder[i].borders[t][0]}))},n=0;n<4;n++)t(n)}},{key:"encodeCentroid",value:function(e,t){var n,i,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e)if(0!==e.y){var a=t.span()._mult(this.tileToMeter);n=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(a.x/10)),i=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(a.y/10))}else n=Math.ceil(7*(e.x+450)),i=0;else n=0,i=+r;var o,s=r?this.centroidVertexArray.length:t.vertexArrayOffset,l=_createForOfIteratorHelper(t.polyCount);try{for(l.s();!(o=l.n()).done;){var u=o.value;r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*u.edges+u.top);for(var c=0;c<u.top;c++)this.centroidVertexArray.emplace(s++,n,i);for(var h=0;h<2*u.edges;h++)this.centroidVertexArray.emplace(s++,0,i),this.centroidVertexArray.emplace(s++,n,i)}}catch(d){l.e(d)}finally{l.f()}}}]),e}();function Lc(e,t){var n=e.add(t)._unit();return e.x*n.x+e.y*n.y}function Bc(e,t,n,i){var r=t.sub(e)._perp()._unit(),a=n.sub(t)._perp()._unit();return Fc(e,t,n,Lc(r,a),i)}function Fc(e,t,n,i,r){var a=Math.sqrt(1-i*i);return Math.min(e.dist(t)/3,t.dist(n)/3,r*a/i)}function jc(e,t,n){return e.x<n[0].x&&t.x<n[0].x||e.x>n[1].x&&t.x>n[1].x||e.y<n[0].y&&t.y<n[0].y||e.y>n[1].y&&t.y>n[1].y}function Hc(e,t,n){if(e.x<0||e.x>=Qo||t.x<0||t.x>=Qo||n.x<0||n.x>=Qo)return!1;var i=n.sub(t),r=i.perp(),a=e.sub(t);return(i.x*a.x+i.y*a.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(a.x*a.x+a.y*a.y))>-.866&&r.x*a.x+r.y*a.y<0}function Vc(e,t,n){var i=t?2|e:-3&e;return n?1|i:-2&i}function Uc(){var e=Math.PI/32,t=Math.tan(e),n=Cl;return n*Math.sqrt(1+2*t*t)-n}function qc(e,t,n){var i=1<<n.z,r=Al(n.x/i),a=Al((n.x+1)/i),o=Rl(n.y/i),s=Rl((n.y+1)/i);return function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0,o=[];if(!e.length||!n||!i)return o;for(var s=function(e,t){var n,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;o.push({polygon:r,bounds:t})}}catch(a){i.e(a)}finally{i.f()}},l=Math.ceil(Math.log2(n)),u=Math.ceil(Math.log2(i)),c=l-u,h=[],d=0;d<Math.abs(c);d++)h.push(c>0?0:1);for(var f=0;f<Math.min(l,u);f++)h.push(0),h.push(1);var p=e;if(p=Ic(p,t[0].y-r,t[1].y+r,1),!(p=Ic(p,t[0].x-r,t[1].x+r,0)).length)return o;var m=[];for(h.length?m.push({polygons:p,bounds:t,depth:0}):s(p,t);m.length;){var v=m.pop(),g=v.depth,_=h[g],x=v.bounds[0],b=v.bounds[1],w=0===_?x.x:x.y,k=0===_?b.x:b.y,C=a?a(_,w,k):.5*(w+k),S=Ic(v.polygons,w-r,C+r,_),T=Ic(v.polygons,C-r,k+r,_);if(S.length){var E=[x,new y(0===_?C:b.x,1===_?C:b.y)];h.length>g+1?m.push({polygons:S,bounds:E,depth:g+1}):s(S,E)}if(T.length){var P=[new y(0===_?C:x.x,1===_?C:x.y),b];h.length>g+1?m.push({polygons:T,bounds:P,depth:g+1}):s(T,P)}}return o}(e,t,Math.ceil((a-r)/11.25),Math.ceil((o-s)/11.25),1,(function(e,t,r){if(0===e)return.5*(t+r);var a=Rl((n.y+t/Qo)/i);return(Ml(.5*(Rl((n.y+r/Qo)/i)+a))*i-n.y)*Qo}))}mr(zc,"FillExtrusionBucket",{omit:["layers","features"]}),mr(Dc,"PartMetadata");var Gc=new Sa({"fill-extrusion-edge-radius":new wa($e["layout_fill-extrusion"]["fill-extrusion-edge-radius"])}),Wc={paint:new Sa({"fill-extrusion-opacity":new wa($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ka($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wa($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wa($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ka($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ka($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ka($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wa($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new wa($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new wa($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new wa($e["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Gc};function Zc(e,t,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}var Xc=function(){function e(t,n,i){_classCallCheck(this,e),this.z=t,this.x=n,this.y=i,this.key=Jc(0,t,t,n,i)}return _createClass(e,[{key:"equals",value:function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}},{key:"url",value:function(e,t){var n=function(e,t,n){var i=Zc(256*e,256*(t=Math.pow(2,n)-t-1),n),r=Zc(256*(e+1),256*(t+1),n);return i[0]+","+i[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),i=function(e,t,n){for(var i,r="",a=e;a>0;a--)r+=(t&(i=1<<a-1)?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",n)}},{key:"toString",value:function(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}]),e}(),Kc=_createClass((function e(t,n){_classCallCheck(this,e),this.wrap=t,this.canonical=n,this.key=Jc(t,n.z,n.z,n.x,n.y)})),Yc=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.overscaledZ=t,this.wrap=n,this.canonical=new Xc(i,+r,+a),this.key=0===n&&t===i?this.canonical.key:Jc(n,t,i,r,a)}return _createClass(e,[{key:"equals",value:function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}},{key:"scaledTo",value:function(t){var n=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}},{key:"calculateScaledKey",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return Jc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);var n=this.canonical.z-e;return Jc(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}},{key:"isChildOf",value:function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}},{key:"children",value:function(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new e(n,this.wrap,n,i,r),new e(n,this.wrap,n,i+1,r),new e(n,this.wrap,n,i,r+1),new e(n,this.wrap,n,i+1,r+1)]}},{key:"isLessThan",value:function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}},{key:"wrapped",value:function(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"unwrapTo",value:function(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"overscaleFactor",value:function(){return Math.pow(2,this.overscaledZ-this.canonical.z)}},{key:"toUnwrapped",value:function(){return new Kc(this.wrap,this.canonical)}},{key:"toString",value:function(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}]),e}();function Jc(e,t,n,i,r){var a=1<<Math.min(n,22),o=a*(r%a)+i%a;return e&&n<22&&(o+=a*a*((e<0?-2*e-1:2*e)%(1<<2*(22-n)))),16*(32*o+n)+(t-n)}mr(Xc,"CanonicalTileID"),mr(Yc,"OverscaledTileID",{omit:["projMatrix"]});var Qc=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).z=i,r}return _inherits(t,e),_createClass(t)}(y);function $c(e,t){return e.x*t.x+e.y*t.y}function eh(e,t){if(1===e.length){for(var n,i=0,r=t[i++];!n||r.equals(n);)if(!(n=t[i++]))return 1/0;for(;i<t.length;i++){var a=t[i],o=e[0],s=n.sub(r),l=a.sub(r),u=o.sub(r),c=$c(s,s),h=$c(s,l),d=$c(l,l),f=$c(u,s),p=$c(u,l),m=c*d-h*h,v=(d*f-h*p)/m,g=(c*p-h*f)/m,y=r.z*(1-v-g)+n.z*v+a.z*g;if(isFinite(y))return y}return 1/0}var _,x=1/0,b=_createForOfIteratorHelper(t);try{for(b.s();!(_=b.n()).done;){var w=_.value;x=Math.min(x,w.z)}}catch(k){b.e(k)}finally{b.f()}return x}function th(e,t,n,i,r,a,o,s){var l=o*r.getElevationAt(e,t,!0,!0),u=0!==a[0],c=u?0===a[1]?o*(a[0]/7-450):o*function(e,t,n){var i=Math.floor(t[0]/8),r=Math.floor(t[1]/8),a=10*(t[0]-8*i),o=10*(t[1]-8*r),s=e.getElevationAt(i,r,!0,!0),l=e.getMeterToDEM(n),u=Math.floor(.5*(a*l-1)),c=Math.floor(.5*(o*l-1)),h=e.tileCoordToPixel(i,r),d=2*u+1,f=2*c+1,p=function(e,t,n,i,r){return[e.getElevationAtPixel(t,n,!0),e.getElevationAtPixel(t+r,n,!0),e.getElevationAtPixel(t,n+r,!0),e.getElevationAtPixel(t+i,n+r,!0)]}(e,h.x-u,h.y-c,d,f),m=Math.abs(p[0]-p[1]),v=Math.abs(p[2]-p[3]),g=Math.abs(p[0]-p[2])+Math.abs(p[1]-p[3]),y=Math.min(.25,.5*l*(m+v)/d),_=Math.min(.25,.5*l*g/f);return s+Math.max(y*a,_*o)}(r,a,s):l;return{base:l+(0===n)?-1:n,top:u?Math.max(c+i,l+n+2):l+i}}var nh=Ia([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4).members,ih=Ia([{name:"a_packed",components:4,type:"Float32"}]).members,rh=Mc.types,ah=Math.cos(Math.PI/180*37.5),oh=function(){function e(t){var n=this;_classCallCheck(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(e){n.gradients[e.id]={}})),this.layoutVertexArray=new Da,this.layoutVertexArray2=new za,this.indexArray=new Xa,this.programConfigurations=new Ho(t.layers,t.zoom),this.segments=new Jo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return _createClass(e,[{key:"populate",value:function(e,t,n,i){this.hasPattern=sc("line",this.layers,t);var r,a=this.layers[0].layout.get("line-sort-key"),o=[],s=_createForOfIteratorHelper(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.feature,c=l.id,h=l.index,d=l.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,p=Gl(u,f);if(this.layers[0]._featureFilter.filter(new fa(this.zoom),p,n)){var m=a?a.evaluate(p,{},n):void 0,v={id:c,properties:u.properties,type:u.type,sourceLayerIndex:d,index:h,geometry:f?p.geometry:ql(u,n,i),patterns:{},sortKey:m};o.push(v)}}}catch(E){s.e(E)}finally{s.f()}a&&o.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=t.lineAtlas,y=t.featureIndex,_=this.addConstantDashes(g),x=0,b=o;x<b.length;x++){var w=b[x],k=w.geometry,C=w.index,S=w.sourceLayerIndex;if(_&&this.addFeatureDashes(w,g),this.hasPattern){var T=lc("line",this.layers,w,this.zoom,t);this.patternFeatures.push(T)}else this.addFeature(w,k,C,n,g.positions,t.availableImages);y.insert(e[C].feature,k,C,S,this.index)}}},{key:"addConstantDashes",value:function(e){var t,n=!1,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(t=i.n()).done;){var r=t.value,a=r.paint.get("line-dasharray").value,o=r.layout.get("line-cap").value;if("constant"!==a.kind||"constant"!==o.kind)n=!0;else{var s=o.value,l=a.value;if(!l)continue;e.addDash(l,s)}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"addFeatureDashes",value:function(e,t){var n,i=this.zoom,r=_createForOfIteratorHelper(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=a.paint.get("line-dasharray").value,s=a.layout.get("line-cap").value;if("constant"!==o.kind||"constant"!==s.kind){var l,u=void 0;if("constant"===o.kind){if(!(u=o.value))continue}else u=o.evaluate({zoom:i},e);l="constant"===s.kind?s.value:s.evaluate({zoom:i},e),t.addDash(u,l),e.patterns[a.id]=t.getKey(u,l)}}}catch(c){r.e(c)}finally{r.f()}}},{key:"update",value:function(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}},{key:"addFeatures",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(this.patternFeatures);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.addFeature(s,s.geometry,s.index,t,n,i)}}catch(l){o.e(l)}finally{o.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ih)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nh),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"lineFeatureClips",value:function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}},{key:"addFeature",value:function(e,t,n,i,r,a){var o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),l=o.get("line-cap").evaluate(e,{}),u=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);var h,d=_createForOfIteratorHelper(t);try{for(d.s();!(h=d.n()).done;){var f=h.value;this.addLine(f,e,s,l,u,c)}}catch(p){d.e(p)}finally{d.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,a,i)}},{key:"addLine",value:function(e,t,n,i,r,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var o=0;o<e.length-1;o++)this.totalDistance+=e[o].dist(e[o+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===rh[t.type],l=e.length;l>=2&&e[l-1].equals(e[l-2]);)l--;for(var u=0;u<l-1&&e[u].equals(e[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===n&&(r=1.05);var c,h,d,f,p,m=this.overscaling<=16?15*Qo/(512*this.overscaling):0,v=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,s&&(c=e[l-2],p=e[u].sub(c)._unit()._perp());for(var g=u;g<l;g++)if(!(d=g===l-1?s?e[u+1]:void 0:e[g+1])||!e[g].equals(d)){p&&(f=p),c&&(h=c),c=e[g],p=d?d.sub(c)._unit()._perp():f;var y=(f=f||p).add(p);0===y.x&&0===y.y||y._unit();var _=f.x*p.x+f.y*p.y,x=y.x*p.x+y.y*p.y,b=0!==x?1/x:1/0,w=2*Math.sqrt(2-2*x),k=x<ah&&h&&d,C=f.x*p.y-f.y*p.x>0;if(k&&g>u){var S=c.dist(h);if(S>2*m){var T=c.sub(c.sub(h)._mult(m/S)._round());this.updateDistance(h,T),this.addCurrentVertex(T,f,0,0,v),h=T}}var E=h&&d,P=E?n:s?"butt":i;if(E&&"round"===P&&(b<a?P="miter":b<=2&&(P="fakeround")),"miter"===P&&b>r&&(P="bevel"),"bevel"===P&&(b>2&&(P="flipbevel"),b<r&&(P="miter")),h&&this.updateDistance(h,c),"miter"===P)y._mult(b),this.addCurrentVertex(c,y,0,0,v);else if("flipbevel"===P){if(b>100)y=p.mult(-1);else{var M=b*f.add(p).mag()/f.sub(p).mag();y._perp()._mult(M*(C?-1:1))}this.addCurrentVertex(c,y,0,0,v),this.addCurrentVertex(c,y.mult(-1),0,0,v)}else if("bevel"===P||"fakeround"===P){var I=-Math.sqrt(b*b-1),A=C?I:0,R=C?0:I;if(h&&this.addCurrentVertex(c,f,A,R,v),"fakeround"===P)for(var O=Math.round(180*w/Math.PI/20),N=1;N<O;N++){var D=N/O;if(.5!==D){var z=D-.5;D+=D*z*(D-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*z*z+(.848013+_*(.215638*_-1.06021)))}var L=p.sub(f)._mult(D)._add(f)._unit()._mult(C?-1:1);this.addHalfVertex(c,L.x,L.y,!1,C,0,v)}d&&this.addCurrentVertex(c,p,-A,-R,v)}else if("butt"===P)this.addCurrentVertex(c,y,0,0,v);else if("square"===P){var B=h?1:-1;h||this.addCurrentVertex(c,y,B,B,v),this.addCurrentVertex(c,y,0,0,v),h&&this.addCurrentVertex(c,y,B,B,v)}else"round"===P&&(h&&(this.addCurrentVertex(c,f,0,0,v),this.addCurrentVertex(c,f,1,1,v,!0)),d&&(this.addCurrentVertex(c,p,-1,-1,v,!0),this.addCurrentVertex(c,p,0,0,v)));if(k&&g<l-1){var F=c.dist(d);if(F>2*m){var j=c.add(d.sub(c)._mult(m/F)._round());this.updateDistance(c,j),this.addCurrentVertex(j,p,0,0,v),c=j}}}}}},{key:"addCurrentVertex",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=t.y*i-t.x,s=-t.y-t.x*i;this.addHalfVertex(e,t.x+t.y*n,t.y-t.x*n,a,!1,n,r),this.addHalfVertex(e,o,s,a,!0,-i,r)}},{key:"addHalfVertex",value:function(e,t,n,i,r,a,o){var s=e.x,l=e.y;this.layoutVertexArray.emplaceBack((s<<1)+(i?1:0),(l<<1)+(r?1:0),Math.round(63*t)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);var u=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),o.primitiveLength++),r?this.e2=u:this.e1=u}},{key:"updateScaledDistance",value:function(){if(this.lineClips){var e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}},{key:"updateDistance",value:function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}]),e}();mr(oh,"LineBucket",{omit:["layers","patternFeatures"]});var sh=new Sa({"line-cap":new ka($e.layout_line["line-cap"]),"line-join":new ka($e.layout_line["line-join"]),"line-miter-limit":new wa($e.layout_line["line-miter-limit"]),"line-round-limit":new wa($e.layout_line["line-round-limit"]),"line-sort-key":new ka($e.layout_line["line-sort-key"])}),lh={paint:new Sa({"line-opacity":new ka($e.paint_line["line-opacity"]),"line-color":new ka($e.paint_line["line-color"]),"line-translate":new wa($e.paint_line["line-translate"]),"line-translate-anchor":new wa($e.paint_line["line-translate-anchor"]),"line-width":new ka($e.paint_line["line-width"]),"line-gap-width":new ka($e.paint_line["line-gap-width"]),"line-offset":new ka($e.paint_line["line-offset"]),"line-blur":new ka($e.paint_line["line-blur"]),"line-dasharray":new ka($e.paint_line["line-dasharray"]),"line-pattern":new ka($e.paint_line["line-pattern"]),"line-gradient":new Ca($e.paint_line["line-gradient"]),"line-trim-offset":new wa($e.paint_line["line-trim-offset"])}),layout:sh},uh=new(function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"possiblyEvaluate",value:function(e,n){return n=new fa(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),_get(_getPrototypeOf2(t.prototype),"possiblyEvaluate",this).call(this,e,n)}},{key:"evaluate",value:function(e,n,i,r){return n=R({},n,{zoom:Math.floor(n.zoom)}),_get(_getPrototypeOf2(t.prototype),"evaluate",this).call(this,e,n,i,r)}}]),t}(ka))(lh.paint.properties["line-width"].specification);function ch(e,t){return t>0?t+2*e:e}uh.useIntegerZoom=!0;var hh=Ia([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),dh=Ia([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),fh=Ia([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ia([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var ph=Ia([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),mh=Ia([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var vh=Ia([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),gh=Ia([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ia([{name:"triangle",components:3,type:"Uint16"}]),Ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ia([{type:"Float32",name:"offsetX"}]),Ia([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var yh=128;function _h(e,t){var n=t.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new fa(e+1))};if("source"===n.kind)return{kind:"source"};for(var i=n.zoomStops,r=n.interpolationType,a=0;a<i.length&&i[a]<=e;)a++;for(var o=a=Math.max(0,a-1);o<i.length&&i[o]<e+1;)o++;o=Math.min(i.length-1,o);var s=i[a],l=i[o];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:l,minSize:n.evaluate(new fa(s)),maxSize:n.evaluate(new fa(l)),interpolationType:r}}function xh(e,t,n){var i=t.uSize,r=t.uSizeT,a=n.lowerSize,o=n.upperSize;return"source"===e.kind?a/yh:"composite"===e.kind?xn(a/yh,o/yh,r):i}function bh(e,t){var n=0,i=0;if("constant"===e.kind)i=e.layoutSize;else if("source"!==e.kind){var r=e.interpolationType,a=e.minZoom,o=e.maxZoom,s=r?E(zn.interpolationFactor(r,t,a,o),0,1):0;"camera"===e.kind?i=xn(e.minSize,e.maxSize,s):n=s}return{uSizeT:n,uSize:i}}var wh=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:yh,evaluateSizeForFeature:xh,evaluateSizeForZoom:bh,getSizeData:_h});var kh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Ch(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function Sh(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var Th=Mh,Eh=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,d=n?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-c)-1,f>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=i;c>0;o=256*o+e[t+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),a-=u}return(f?-1:1)*o*Math.pow(2,a-i)},Ph=function(e,t,n,i,r,a){var o,s,l,u=8*a-r-1,c=(1<<u)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*l-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&s,f+=p,s/=256,r-=8);for(o=o<<r|s,u+=r;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m};function Mh(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Mh.Varint=0,Mh.Fixed64=1,Mh.Bytes=2,Mh.Fixed32=5;var Ih=4294967296,Ah=1/Ih,Rh="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Oh(e){return e.type===Mh.Bytes?e.readVarint()+e.pos:e.pos+1}function Nh(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Dh(e,t,n){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=e;r--)n.buf[r+i]=n.buf[r]}function zh(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function Lh(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function Bh(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function Fh(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function jh(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function Hh(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function Vh(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function Uh(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function qh(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function Gh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Wh(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function Zh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Mh.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,a=this.pos;this.type=7&i,e(r,t,this),this.pos===a&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Gh(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Zh(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Gh(this.buf,this.pos)+Gh(this.buf,this.pos+4)*Ih;return this.pos+=8,e},readSFixed64:function(){var e=Gh(this.buf,this.pos)+Zh(this.buf,this.pos+4)*Ih;return this.pos+=8,e},readFloat:function(){var e=Eh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Eh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,i=this.buf;return t=127&(n=i[this.pos++]),n<128?t:(t|=(127&(n=i[this.pos++]))<<7,n<128?t:(t|=(127&(n=i[this.pos++]))<<14,n<128?t:(t|=(127&(n=i[this.pos++]))<<21,n<128?t:function(e,t,n){var i,r,a=n.buf;if(i=(112&(r=a[n.pos++]))>>4,r<128)return Nh(e,i,t);if(i|=(127&(r=a[n.pos++]))<<3,r<128)return Nh(e,i,t);if(i|=(127&(r=a[n.pos++]))<<10,r<128)return Nh(e,i,t);if(i|=(127&(r=a[n.pos++]))<<17,r<128)return Nh(e,i,t);if(i|=(127&(r=a[n.pos++]))<<24,r<128)return Nh(e,i,t);if(i|=(1&(r=a[n.pos++]))<<31,r<128)return Nh(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=i[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Rh?function(e,t,n){return Rh.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var i="",r=t;r<n;){var a,o,s,l=e[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[r+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(o=e[r+2],128==(192&(a=e[r+1]))&&128==(192&o)&&((u=(15&l)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[r+2],s=e[r+3],128==(192&(a=e[r+1]))&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),r+=c}return i}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Mh.Bytes)return e.push(this.readVarint(t));var n=Oh(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Mh.Bytes)return e.push(this.readSVarint());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Mh.Bytes)return e.push(this.readBoolean());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Mh.Bytes)return e.push(this.readFloat());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Mh.Bytes)return e.push(this.readDouble());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Mh.Bytes)return e.push(this.readFixed32());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Mh.Bytes)return e.push(this.readSFixed32());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Mh.Bytes)return e.push(this.readFixed64());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Mh.Bytes)return e.push(this.readSFixed64());var t=Oh(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Mh.Varint)for(;this.buf[this.pos++]>127;);else if(t===Mh.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Mh.Fixed32)this.pos+=4;else{if(t!==Mh.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Wh(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Wh(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Wh(this.buf,-1&e,this.pos),Wh(this.buf,Math.floor(e*Ah),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Wh(this.buf,-1&e,this.pos),Wh(this.buf,Math.floor(e*Ah),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,i;if(e>=0?(n=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,i=i+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(i,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var i,r,a=0;a<t.length;a++){if((i=t.charCodeAt(a))>55295&&i<57344){if(!r){i>56319||a+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):r=i;continue}if(i<56320){e[n++]=239,e[n++]=191,e[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(e[n++]=239,e[n++]=191,e[n++]=189,r=null);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(i<65536?e[n++]=i>>12|224:(e[n++]=i>>18|240,e[n++]=i>>12&63|128),e[n++]=i>>6&63|128),e[n++]=63&i|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&Dh(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),Ph(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ph(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var i=this.pos-n;i>=128&&Dh(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,n){this.writeTag(e,Mh.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,zh,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Lh,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,jh,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Bh,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Fh,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Hh,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Vh,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Uh,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,qh,t)},writeBytesField:function(e,t){this.writeTag(e,Mh.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Mh.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Mh.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Mh.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Mh.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Mh.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Mh.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Mh.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Mh.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Mh.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Xh=d(Th);function Kh(e,t,n){t.glyphs=[],1===e&&n.readMessage(Yh,t)}function Yh(e,t,n){if(3===e){var i=n.readMessage(Jh,{}),r=i.id,a=i.bitmap,o=i.width,s=i.height,l=i.left,u=i.top,c=i.advance;t.glyphs.push({id:r,bitmap:new wu({width:o+6,height:s+6},a),metrics:{width:o,height:s,left:l,top:u,advance:c}})}else 4===e?t.ascender=n.readSVarint():5===e&&(t.descender=n.readSVarint())}function Jh(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}function Qh(e){var t,n=0,i=0,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=a.w*a.h,i=Math.max(i,a.w)}}catch(m){r.e(m)}finally{r.f()}e.sort((function(e,t){return t.h-e.h}));var o,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),i),h:1/0}],l=0,u=0,c=_createForOfIteratorHelper(e);try{for(c.s();!(o=c.n()).done;)for(var h=o.value,d=s.length-1;d>=0;d--){var f=s[d];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),l=Math.max(l,h.x+h.w),h.w===f.w&&h.h===f.h){var p=s.pop();d<s.length&&(s[d]=p)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):h.w===f.w?(f.y+=h.h,f.h-=h.h):(s.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}catch(m){c.e(m)}finally{c.f()}return{w:l,h:u,fill:n/(l*u)||0}}var $h=function(){function e(t,n){var i=n.pixelRatio,r=n.version,a=n.stretchX,o=n.stretchY,s=n.content;_classCallCheck(this,e),this.paddedRect=t,this.pixelRatio=i,this.stretchX=a,this.stretchY=o,this.content=s,this.version=r}return _createClass(e,[{key:"tl",get:function(){return[this.paddedRect.x+1,this.paddedRect.y+1]}},{key:"br",get:function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}},{key:"displaySize",get:function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}]),e}(),ed=function(){function e(t,n){_classCallCheck(this,e);var i={},r={};this.haveRenderCallbacks=[];var a=[];this.addImages(t,i,a),this.addImages(n,r,a);var o=Qh(a),s=o.w,l=o.h,u=new ku({width:s||1,height:l||1});for(var c in t){var h=t[c],d=i[c].paddedRect;ku.copy(h.data,u,{x:0,y:0},{x:d.x+1,y:d.y+1},h.data)}for(var f in n){var p=n[f],m=r[f].paddedRect,v=m.x+1,g=m.y+1,y=p.data.width,_=p.data.height;ku.copy(p.data,u,{x:0,y:0},{x:v,y:g},p.data),ku.copy(p.data,u,{x:0,y:_-1},{x:v,y:g-1},{width:y,height:1}),ku.copy(p.data,u,{x:0,y:0},{x:v,y:g+_},{width:y,height:1}),ku.copy(p.data,u,{x:y-1,y:0},{x:v-1,y:g},{width:1,height:_}),ku.copy(p.data,u,{x:0,y:0},{x:v+y,y:g},{width:1,height:_})}this.image=u,this.iconPositions=i,this.patternPositions=r}return _createClass(e,[{key:"addImages",value:function(e,t,n){for(var i in e){var r=e[i],a={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(a),t[i]=new $h(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}},{key:"patchUpdatedImages",value:function(e,t){for(var n in this.haveRenderCallbacks=this.haveRenderCallbacks.filter((function(t){return e.hasImage(t)})),e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)}},{key:"patchUpdatedImage",value:function(e,t,n){if(e&&t&&e.version!==t.version){e.version=t.version;var i=_slicedToArray(e.tl,2),r=i[0],a=i[1];n.update(t.data,void 0,{x:r,y:a})}}}]),e}();mr($h,"ImagePosition"),mr(ed,"ImageAtlas");var td={horizontal:1,vertical:2,horizontalOnly:3},nd=function(){function e(){_classCallCheck(this,e),this.scale=1,this.fontStack="",this.imageName=null}return _createClass(e,null,[{key:"forText",value:function(t,n){var i=new e;return i.scale=t||1,i.fontStack=n,i}},{key:"forImage",value:function(t){var n=new e;return n.imageName=t,n}}]),e}(),id=function(){function e(){_classCallCheck(this,e),this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}return _createClass(e,[{key:"length",value:function(){return this.text.length}},{key:"getSection",value:function(e){return this.sections[this.sectionIndex[e]]}},{key:"getSections",value:function(){return this.sections}},{key:"getSectionIndex",value:function(e){return this.sectionIndex[e]}},{key:"getCharCode",value:function(e){return this.text.charCodeAt(e)}},{key:"verticalizePunctuation",value:function(e){this.text=function(e,t){for(var n="",i=0;i<e.length;i++){var r=e.charCodeAt(i+1)||null,a=e.charCodeAt(i-1)||null;n+=!t&&(r&&Jr(r)&&!kh[e[i+1]]||a&&Jr(a)&&!kh[e[i-1]])||!kh[e[i]]?e[i]:kh[e[i]]}return n}(this.text,e)}},{key:"trim",value:function(){for(var e=0,t=0;t<this.text.length&&ad[this.text.charCodeAt(t)];t++)e++;for(var n=this.text.length,i=this.text.length-1;i>=0&&i>=e&&ad[this.text.charCodeAt(i)];i--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}},{key:"substring",value:function(t,n){var i=new e;return i.text=this.text.substring(t,n),i.sectionIndex=this.sectionIndex.slice(t,n),i.sections=this.sections,i}},{key:"toString",value:function(){return this.text}},{key:"getMaxScale",value:function(){var e=this;return this.sectionIndex.reduce((function(t,n){return Math.max(t,e.sections[n].scale)}),0)}},{key:"addTextSection",value:function(e,t){this.text+=e.text,this.sections.push(nd.forText(e.scale,e.fontStack||t));for(var n=this.sections.length-1,i=0;i<e.text.length;++i)this.sectionIndex.push(n)}},{key:"addImageSection",value:function(e){var t=e.image?e.image.name:"";if(0!==t.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(nd.forImage(t)),this.sectionIndex.push(this.sections.length-1)):q("Reached maximum number of images 6401")}else q("Can't add FormattedSection with an empty image.")}},{key:"getNextImageSectionCharCode",value:function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}],[{key:"fromFeature",value:function(t,n){for(var i=new e,r=0;r<t.sections.length;r++){var a=t.sections[r];a.image?i.addImageSection(a):i.addTextSection(a,n)}return i}}]),e}();function rd(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p){var m=id.fromFeature(e,r);h===td.vertical&&m.verticalizePunctuation(d);var v=[],g=function(e,t,n,i,r,a){if(!e)return[];for(var o,s=[],l=function(e,t,n,i,r,a){for(var o=0,s=0;s<e.length();s++){var l=e.getSection(s);o+=sd(e.getCharCode(s),l,i,r,t,a)}return o/Math.max(1,Math.ceil(o/n))}(e,t,n,i,r,a),u=e.text.indexOf("\u200b")>=0,c=0,h=0;h<e.length();h++){var d=e.getSection(h),f=e.getCharCode(h);if(ad[f]||(c+=sd(f,d,i,r,t,a)),h<e.length()-1){var p=!((o=f)<11904||!(Ar(o)||Ir(o)||qr(o)||Hr(o)||Dr(o)||Cr(o)||Rr(o)||Er(o)||zr(o)||Lr(o)||Nr(o)||Zr(o)||Pr(o)||Tr(o)||Sr(o)||Or(o)||Mr(o)||Ur(o)||Fr(o)||Br(o)));(od[f]||p||d.imageName)&&s.push(cd(h+1,c,l,s,ud(f,e.getCharCode(h+1),p&&u),!1))}}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(cd(e.length(),c,l,s,0,!0))}(m,u,a,t,i,f),y=da.processBidirectionalText,_=da.processStyledBidirectionalText;if(y&&1===m.sections.length){var x,b=_createForOfIteratorHelper(y(m.toString(),g));try{for(b.s();!(x=b.n()).done;){var w=x.value,k=new id;k.text=w,k.sections=m.sections;for(var C=0;C<w.length;C++)k.sectionIndex.push(0);v.push(k)}}catch(A){b.e(A)}finally{b.f()}}else if(_){var S,T=_createForOfIteratorHelper(_(m.text,m.sectionIndex,g));try{for(T.s();!(S=T.n()).done;){var E=S.value,P=new id;P.text=E[0],P.sectionIndex=E[1],P.sections=m.sections,v.push(P)}}catch(A){T.e(A)}finally{T.f()}}else v=function(e,t){var n,i=[],r=e.text,a=0,o=_createForOfIteratorHelper(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;i.push(e.substring(a,s)),a=s}}catch(A){o.e(A)}finally{o.f()}return a<r.length&&i.push(e.substring(a,r.length)),i}(m,g);var M=[],I={positionedLines:M,text:m.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,n,i,r,a,o,s,l,u,c,h){var d,f=0,p=0,m=0,v="right"===s?1:"left"===s?0:.5,g=!1,y=_createForOfIteratorHelper(r);try{for(y.s();!(d=y.n()).done;){var _,x=_createForOfIteratorHelper(d.value.getSections());try{for(x.s();!(_=x.n()).done;){var b=_.value;if(!b.imageName){var w=t[b.fontStack];if(w&&!(g=void 0!==w.ascender&&void 0!==w.descender))break}}}catch(A){x.e(A)}finally{x.f()}if(!g)break}}catch(A){y.e(A)}finally{y.f()}var k,C,S=0,T=_createForOfIteratorHelper(r);try{for(T.s();!(k=T.n()).done;){var E=k.value;E.trim();var P=E.getMaxScale(),M=24*(P-1),I={positionedGlyphs:[],lineOffset:0};e.positionedLines[S]=I;var R=I.positionedGlyphs,O=0;if(E.length()){for(var N=0,D=0,z=0;z<E.length();z++){var L=E.getSection(z),B=E.getSectionIndex(z),F=E.getCharCode(z),j=L.scale,H=null,V=null,U=null,q=24,G=0,W=!(l===td.horizontal||!c&&!Yr(F)||c&&(ad[F]||(C=F,br(C)||wr(C)||kr(C)||Vr(C)||Wr(C))));if(L.imageName){var Z=i[L.imageName];if(!Z)continue;U=L.imageName,e.iconsInText=e.iconsInText||!0,V=Z.paddedRect;var X=Z.displaySize;j=24*j/h,H={width:X[0],height:X[1],left:1,top:-3,advance:W?X[1]:X[0],localGlyph:!1},G=g?-H.height*j:24*P-17-X[1]*j,q=H.advance;var K=(W?X[0]:X[1])*j-24*P;K>0&&K>O&&(O=K)}else{var Y=n[L.fontStack];if(!Y)continue;Y[F]&&(V=Y[F]);var J=t[L.fontStack];if(!J)continue;var Q=J.glyphs[F];if(!Q)continue;if(H=Q.metrics,q=8203!==F?24:0,g){var $=void 0!==J.ascender?Math.abs(J.ascender):0,ee=void 0!==J.descender?Math.abs(J.descender):0,te=($+ee)*j;N<te&&(N=te,D=($-ee)/2*j),G=-$*j}else G=24*(P-j)-17}W?(e.verticalizable=!0,R.push({glyph:F,imageName:U,x:f,y:p+G,vertical:W,scale:j,localGlyph:H.localGlyph,fontStack:L.fontStack,sectionIndex:B,metrics:H,rect:V}),f+=q*j+u):(R.push({glyph:F,imageName:U,x:f,y:p+G,vertical:W,scale:j,localGlyph:H.localGlyph,fontStack:L.fontStack,sectionIndex:B,metrics:H,rect:V}),f+=H.advance*j+u)}0!==R.length&&(m=Math.max(f-u,m),g?dd(R,v,O,D,a*P/2):dd(R,v,O,0,a/2)),f=0;var ne=a*P+O;I.lineOffset=Math.max(O,M),p+=ne,++S}else p+=a,++S}}catch(A){T.e(A)}finally{T.f()}var ie=p,re=hd(o),ae=re.horizontalAlign,oe=re.verticalAlign;(function(e,t,n,i,r,a){var o,s=(t-n)*r,l=-a*i,u=_createForOfIteratorHelper(e);try{for(u.s();!(o=u.n()).done;){var c,h=_createForOfIteratorHelper(o.value.positionedGlyphs);try{for(h.s();!(c=h.n()).done;){var d=c.value;d.x+=s,d.y+=l}}catch(A){h.e(A)}finally{h.f()}}}catch(A){u.e(A)}finally{u.f()}})(e.positionedLines,v,ae,oe,m,ie),e.top+=-oe*ie,e.bottom=e.top+ie,e.left+=-ae*m,e.right=e.left+m,e.hasBaseline=g}(I,t,n,i,v,o,s,l,h,u,d,p),!function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){if(0!==t.value.positionedGlyphs.length)return!1}}catch(A){n.e(A)}finally{n.f()}return!0}(M)&&I}var ad={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},od={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function sd(e,t,n,i,r,a){if(t.imageName){var o=i[t.imageName];return o?o.displaySize[0]*t.scale*24/a+r:0}var s=n[t.fontStack],l=s&&s.glyphs[e];return l?l.metrics.advance*t.scale+r:0}function ld(e,t,n,i){var r=Math.pow(e-t,2);return i?e<t?r/2:2*r:r+Math.abs(n)*n}function ud(e,t,n){var i=0;return 10===e&&(i-=1e4),n&&(i+=150),40!==e&&65288!==e||(i+=50),41!==t&&65289!==t||(i+=50),i}function cd(e,t,n,i,r,a){var o,s=null,l=ld(t,n,r,a),u=_createForOfIteratorHelper(i);try{for(u.s();!(o=u.n()).done;){var c=o.value,h=ld(t-c.x,n,r,a)+c.badness;h<=l&&(s=c,l=h)}}catch(d){u.e(d)}finally{u.f()}return{index:e,x:t,priorBreak:s,badness:l}}function hd(e){var t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function dd(e,t,n,i,r){if(t||n||i||r)for(var a=e.length-1,o=e[a],s=(o.x+o.metrics.advance*o.scale)*t,l=0;l<=a;l++)e[l].x-=s,e[l].y+=n+i+r}function fd(e,t,n,i,r,a){var o,s=e.image;if(s.content){var l=s.content,u=s.pixelRatio||1;o=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,h,d,f,p=t.left*a,m=t.right*a;"width"===n||"both"===n?(f=r[0]+p-i[3],h=r[0]+m+i[1]):h=(f=r[0]+(p+m-s.displaySize[0])/2)+s.displaySize[0];var v=t.top*a,g=t.bottom*a;return"height"===n||"both"===n?(c=r[1]+v-i[0],d=r[1]+g+i[2]):d=(c=r[1]+(v+g-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:h,bottom:d,left:f,collisionPadding:o}}var pd=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e,n])).angle=r,o.z=i,void 0!==a&&(o.segment=a),o}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z,this.angle,this.segment)}}]),t}(y);function md(e,t,n,i,r){if(void 0===t.segment)return!0;for(var a=t,o=t.segment+1,s=0;s>-n/2;){if(--o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;for(var l=[],u=0;s<n/2;){var c=e[o],h=e[o+1];if(!h)return!1;var d=e[o-1].angleTo(c)-c.angleTo(h);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:d}),u+=d;s-l[0].distance>i;)u-=l.shift().angleDelta;if(u>r)return!1;o++,s+=c.dist(h)}return!0}function vd(e){for(var t=0,n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function gd(e,t,n){return e?.6*t*n:0}function yd(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function _d(e,t,n,i,r,a){for(var o=gd(n,r,a),s=yd(n,i)*a,l=0,u=vd(e)/2,c=0;c<e.length-1;c++){var h=e[c],d=e[c+1],f=h.dist(d);if(l+f>u){var p=(u-l)/f,m=xn(h.x,d.x,p),v=xn(h.y,d.y,p),g=new pd(m,v,0,d.angleTo(h),c);return!o||md(e,g,s,o,t)?g:void 0}l+=f}}function xd(e,t,n,i,r,a,o,s,l){var u=gd(i,a,o),c=yd(i,r),h=c*o,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),function e(t,n,i,r,a,o,s,l,u){for(var c=o/2,h=vd(t),d=0,f=n-i,p=[],m=0;m<t.length-1;m++){for(var v=t[m],g=t[m+1],y=v.dist(g),_=g.angleTo(v);f+i<d+y;){var x=((f+=i)-d)/y,b=xn(v.x,g.x,x),w=xn(v.y,g.y,x);if(b>=0&&b<u&&w>=0&&w<u&&f-c>=0&&f+c<=h){var k=new pd(b,w,0,_,m);k._round(),r&&!md(t,k,o,r,a)||p.push(k)}}d+=y}return l||p.length||s||(p=e(t,d/2,i,r,a,o,s,!0,u)),p}(e,d?t/2*s%t:(c/2+2*a)*o*s%t,t,u,n,h,d,!1,l)}function bd(e,t,n,i,r){for(var a=[],o=0;o<e.length;o++)for(var s=e[o],l=void 0,u=0;u<s.length-1;u++){var c=s[u],h=s[u+1];c.x<t&&h.x<t||(c.x<t?c=new y(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x<t&&(h=new y(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y<n&&h.y<n||(c.y<n?c=new y(c.x+(n-c.y)/(h.y-c.y)*(h.x-c.x),n)._round():h.y<n&&(h=new y(c.x+(n-c.y)/(h.y-c.y)*(h.x-c.x),n)._round()),c.x>=i&&h.x>=i||(c.x>=i?c=new y(i,c.y+(i-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x>=i&&(h=new y(i,c.y+(i-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y>=r&&h.y>=r||(c.y>=r?c=new y(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round():h.y>=r&&(h=new y(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round()),l&&c.equals(l[l.length-1])||(l=[c],a.push(l)),l.push(h)))))}return a}mr(pd,"Anchor");var wd=1e20;function kd(e,t,n,i,r,a,o,s,l){for(var u=t;u<t+i;u++)Cd(e,n*a+u,a,r,o,s,l);for(var c=n;c<n+r;c++)Cd(e,c*a+t,1,i,o,s,l)}function Cd(e,t,n,i,r,a,o){a[0]=0,o[0]=-wd,o[1]=wd,r[0]=e[t];for(var s=1,l=0,u=0;s<i;s++){r[s]=e[t+s*n];var c=s*s;do{var h=a[l];u=(r[s]-r[h]+c-h*h)/(s-h)/2}while(u<=o[l]&&--l>-1);a[++l]=s,o[l]=u,o[l+1]=wd}for(var d=0,f=0;d<i;d++){for(;o[f+1]<d;)f++;var p=a[f],m=d-p;e[t+d*n]=r[p]+m*m}}var Sd={none:0,ideographs:1,all:2},Td=function(){function e(t,n,i){_classCallCheck(this,e),this.requestManager=t,this.localGlyphMode=n,this.localFontFamily=i,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}return _createClass(e,[{key:"setURL",value:function(e){this.url=e}},{key:"getGlyphs",value:function(t,n){var i=this,r=[];for(var a in t){var o,s=_createForOfIteratorHelper(t[a]);try{for(s.s();!(o=s.n()).done;){var l=o.value;r.push({stack:a,id:l})}}catch(u){s.e(u)}finally{s.f()}}I(r,(function(t,n){var r=t.stack,a=t.id,o=i.entries[r];o||(o=i.entries[r]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});var s=o.glyphs[a];if(void 0===s){if(s=i._tinySDF(o,r,a))return o.glyphs[a]=s,void n(null,{stack:r,id:a,glyph:s});var l=Math.floor(a/256);if(256*l>65535)n(new Error("glyphs > 65535 not supported"));else if(o.ranges[l])n(null,{stack:r,id:a,glyph:s});else{var c=o.requests[l];c||(c=o.requests[l]=[],e.loadGlyphRange(r,l,i.url,i.requestManager,(function(e,t){if(t){for(var n in o.ascender=t.ascender,o.descender=t.descender,t.glyphs)i._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=t.glyphs[+n]);o.ranges[l]=!0}var r,a=_createForOfIteratorHelper(c);try{for(a.s();!(r=a.n()).done;){(0,r.value)(e,t)}}catch(u){a.e(u)}finally{a.f()}delete o.requests[l]}))),c.push((function(e,t){e?n(e):t&&n(null,{stack:r,id:a,glyph:t.glyphs[a]||null})}))}}else n(null,{stack:r,id:a,glyph:s})}),(function(e,t){if(e)n(e);else if(t){var r,a={},o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=s.stack,c=s.id,h=s.glyph;void 0===a[l]&&(a[l]={}),void 0===a[l].glyphs&&(a[l].glyphs={}),a[l].glyphs[c]=h&&{id:h.id,bitmap:h.bitmap.clone(),metrics:h.metrics},a[l].ascender=i.entries[l].ascender,a[l].descender=i.entries[l].descender}}catch(u){o.e(u)}finally{o.f()}n(null,a)}}))}},{key:"_doesCharSupportLocalGlyph",value:function(e){return this.localGlyphMode!==Sd.none&&(this.localGlyphMode===Sd.all?!!this.localFontFamily:!!this.localFontFamily&&(Lr(e)||jr(e)||Pr(e)||Mr(e)||Er(e)))}},{key:"_tinySDF",value:function(t,n,i){var r=this.localFontFamily;if(r&&this._doesCharSupportLocalGlyph(i)){var a=t.tinySDF;if(!a){var o="400";/bold/i.test(n)?o="900":/medium/i.test(n)?o="500":/light/i.test(n)&&(o="200"),(a=t.tinySDF=new e.TinySDF({fontFamily:r,fontWeight:o,fontSize:48,buffer:6,radius:16})).fontWeight=o}if(this.localGlyphs[a.fontWeight][i])return this.localGlyphs[a.fontWeight][i];var s=String.fromCharCode(i),l=a.draw(s),u=l.data,c=l.width,h=l.height,d=l.glyphWidth,f=l.glyphHeight,p=l.glyphLeft,m=l.glyphTop,v=l.glyphAdvance;return this.localGlyphs[a.fontWeight][i]={id:i,bitmap:new wu({width:c,height:h},u),metrics:{width:d/2,height:f/2,left:p/2,top:m/2-27,advance:v/2,localGlyph:!0}}}}}]),e}();function Ed(e,t,n,i){var r=[],a=e.image,o=a.pixelRatio,s=a.paddedRect.w-2,l=a.paddedRect.h-2,u=e.right-e.left,c=e.bottom-e.top,h=a.stretchX||[[0,s]],d=a.stretchY||[[0,l]],f=function(e,t){return e+t[1]-t[0]},p=h.reduce(f,0),m=d.reduce(f,0),v=s-p,g=l-m,_=0,x=p,b=0,w=m,k=0,C=v,S=0,T=g;if(a.content&&i){var E=a.content;_=Pd(h,0,E[0]),b=Pd(d,0,E[1]),x=Pd(h,E[0],E[2]),w=Pd(d,E[1],E[3]),k=E[0]-_,S=E[1]-b,C=E[2]-E[0]-x,T=E[3]-E[1]-w}var P=function(i,r,s,l){var h=Id(i.stretch-_,x,u,e.left),d=Ad(i.fixed-k,C,i.stretch,p),f=Id(r.stretch-b,w,c,e.top),v=Ad(r.fixed-S,T,r.stretch,m),g=Id(s.stretch-_,x,u,e.left),E=Ad(s.fixed-k,C,s.stretch,p),P=Id(l.stretch-b,w,c,e.top),M=Ad(l.fixed-S,T,l.stretch,m),I=new y(h,f),A=new y(g,f),R=new y(g,P),O=new y(h,P),N=new y(d/o,v/o),D=new y(E/o,M/o),z=t*Math.PI/180;if(z){var L=Math.sin(z),B=Math.cos(z),F=[B,-L,L,B];I._matMult(F),A._matMult(F),O._matMult(F),R._matMult(F)}var j=i.stretch+i.fixed,H=r.stretch+r.fixed;return{tl:I,tr:A,bl:O,br:R,tex:{x:a.paddedRect.x+1+j,y:a.paddedRect.y+1+H,w:s.stretch+s.fixed-j,h:l.stretch+l.fixed-H},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:N,pixelOffsetBR:D,minFontScaleX:C/o/u,minFontScaleY:T/o/c,isSDF:n}};if(i&&(a.stretchX||a.stretchY))for(var M=Md(h,v,p),I=Md(d,g,m),A=0;A<M.length-1;A++)for(var R=M[A],O=M[A+1],N=0;N<I.length-1;N++)r.push(P(R,I[N],O,I[N+1]));else r.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));return r}function Pd(e,t,n){var i,r=0,a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r+=Math.max(t,Math.min(n,o[1]))-Math.max(t,Math.min(n,o[0]))}}catch(s){a.e(s)}finally{a.f()}return r}function Md(e,t,n){var i,r=[{fixed:-1,stretch:0}],a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var o=_slicedToArray(i.value,2),s=o[0],l=o[1],u=r[r.length-1];r.push({fixed:s-u.stretch,stretch:u.stretch}),r.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}}catch(c){a.e(c)}finally{a.f()}return r.push({fixed:t+1,stretch:n}),r}function Id(e,t,n,i){return e/t*n+i}function Ad(e,t,n,i){return e-t*n/i}function Rd(e,t,n,i){var r=t+e.positionedLines[i].lineOffset;return 0===i?n+r/2:n+(r+(t+e.positionedLines[i-1].lineOffset))/2}Td.loadGlyphRange=function(e,t,n,i,r){var a=256*t,o=a+255,s=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",e).replace("{range}","".concat(a,"-").concat(o)),le.Glyphs);de(s,(function(e,t){if(e)r(e);else if(t){var n,i={},a=function(e){return new Xh(e).readFields(Kh,{})}(t),o=_createForOfIteratorHelper(a.glyphs);try{for(o.s();!(n=o.n()).done;){var s=n.value;i[s.id]=s}}catch(l){o.e(l)}finally{o.f()}r(null,{glyphs:i,ascender:a.ascender,descender:a.descender})}}))},Td.TinySDF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.fontSize,i=void 0===n?24:n,r=t.buffer,a=void 0===r?3:r,o=t.radius,s=void 0===o?8:o,l=t.cutoff,u=void 0===l?.25:l,c=t.fontFamily,h=void 0===c?"sans-serif":c,d=t.fontWeight,f=void 0===d?"normal":d,p=t.fontStyle,m=void 0===p?"normal":p;_classCallCheck(this,e),this.buffer=a,this.cutoff=u,this.radius=s;var v=this.size=i+4*a,g=this._createCanvas(v),y=this.ctx=g.getContext("2d",{willReadFrequently:!0});y.font="".concat(m," ").concat(f," ").concat(i,"px ").concat(h),y.textBaseline="alphabetic",y.textAlign="left",y.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}return _createClass(e,[{key:"_createCanvas",value:function(e){var t=document.createElement("canvas");return t.width=t.height=e,t}},{key:"draw",value:function(e){var t=this.ctx.measureText(e),n=t.width,i=t.actualBoundingBoxAscent,r=t.actualBoundingBoxDescent,a=t.actualBoundingBoxLeft,o=t.actualBoundingBoxRight,s=Math.ceil(i),l=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),u=Math.min(this.size-this.buffer,s+Math.ceil(r)),c=l+2*this.buffer,h=u+2*this.buffer,d=Math.max(c*h,0),f=new Uint8ClampedArray(d),p={data:f,width:c,height:h,glyphWidth:l,glyphHeight:u,glyphTop:s,glyphLeft:0,glyphAdvance:n};if(0===l||0===u)return p;var m=this.ctx,v=this.buffer,g=this.gridInner,y=this.gridOuter;m.clearRect(v,v,l,u),m.fillText(e,v,v+s);var _=m.getImageData(v,v,l,u);y.fill(wd,0,d),g.fill(0,0,d);for(var x=0;x<u;x++)for(var b=0;b<l;b++){var w=_.data[4*(x*l+b)+3]/255;if(0!==w){var k=(x+v)*c+b+v;if(1===w)y[k]=0,g[k]=wd;else{var C=.5-w;y[k]=C>0?C*C:0,g[k]=C<0?C*C:0}}}kd(y,0,0,c,h,c,this.f,this.v,this.z),kd(g,v,v,l,u,c,this.f,this.v,this.z);for(var S=0;S<d;S++){var T=Math.sqrt(y[S])-Math.sqrt(g[S]);f[S]=Math.round(255-255*(T/this.radius+this.cutoff))}return p}}]),e}();var Od=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nd;if(_classCallCheck(this,e),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}return _createClass(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,n=this.compare,i=t[e];e>0;){var r=e-1>>1,a=t[r];if(n(i,a)>=0)break;t[e]=a,e=r}t[e]=i}},{key:"_down",value:function(e){for(var t=this.data,n=this.compare,i=this.length>>1,r=t[e];e<i;){var a=1+(e<<1),o=t[a],s=a+1;if(s<this.length&&n(t[s],o)<0&&(a=s,o=t[s]),n(o,r)>=0)break;t[e]=o,e=a}t[e]=r}}]),e}();function Nd(e,t){return e<t?-1:e>t?1:0}function Dd(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1/0,r=1/0,a=-1/0,o=-1/0,s=e[0],l=0;l<s.length;l++){var u=s[l];(!l||u.x<i)&&(i=u.x),(!l||u.y<r)&&(r=u.y),(!l||u.x>a)&&(a=u.x),(!l||u.y>o)&&(o=u.y)}var c=Math.min(a-i,o-r),h=c/2,d=new Od([],zd);if(0===c)return new y(i,r);for(var f=i;f<a;f+=c)for(var p=r;p<o;p+=c)d.push(new Ld(f+h,p+h,h,e));for(var m=function(e){for(var t=0,n=0,i=0,r=e[0],a=0,o=r.length,s=o-1;a<o;s=a++){var l=r[a],u=r[s],c=l.x*u.y-u.x*l.y;n+=(l.x+u.x)*c,i+=(l.y+u.y)*c,t+=3*c}return new Ld(n/t,i/t,0,e)}(e),v=d.length;d.length;){var g=d.pop();(g.d>m.d||!m.d)&&(m=g,n&&console.log("found best %d after %d probes",Math.round(1e4*g.d)/1e4,v)),g.max-m.d<=t||(h=g.h/2,d.push(new Ld(g.p.x-h,g.p.y-h,h,e)),d.push(new Ld(g.p.x+h,g.p.y-h,h,e)),d.push(new Ld(g.p.x-h,g.p.y+h,h,e)),d.push(new Ld(g.p.x+h,g.p.y+h,h,e)),v+=4)}return n&&(console.log("num probes: "+v),console.log("best distance: "+m.d)),m.p}function zd(e,t){return t.max-e.max}var Ld=_createClass((function e(t,n,i,r){_classCallCheck(this,e),this.p=new y(t,n),this.h=i,this.d=function(e,t){for(var n=!1,i=1/0,r=0;r<t.length;r++)for(var a=t[r],o=0,s=a.length,l=s-1;o<s;l=o++){var u=a[o],c=a[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(n=!n),i=Math.min(i,nu(e,u,c))}return(n?1:-1)*Math.sqrt(i)}(this.p,r),this.max=this.d+this.h*Math.SQRT2})),Bd=Number.POSITIVE_INFINITY,Fd=Math.sqrt(2);function jd(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1],a=0,o=0;if(r===Bd){i<0&&(i=0);var s=i/Fd;switch(e){case"top-right":case"top-left":o=s-7;break;case"bottom-right":case"bottom-left":o=7-s;break;case"bottom":o=7-i;break;case"top":o=i-7}switch(e){case"top-right":case"bottom-right":a=-s;break;case"top-left":case"bottom-left":a=s;break;case"left":a=i;break;case"right":a=-i}}else{switch(i=Math.abs(i),r=Math.abs(r),e){case"top-right":case"top-left":case"top":o=r-7;break;case"bottom-right":case"bottom-left":case"bottom":o=7-r}switch(e){case"top-right":case"bottom-right":case"right":a=-i;break;case"top-left":case"bottom-left":case"left":a=i}}return[a,o]}function Hd(e,t,n,i,r,a,o,s,l,u){e.createArrays(),e.tilePixelRatio=Qo/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var c=e.layers[0].layout,h=e.layers[0]._unevaluatedLayout._values,d={};if("composite"===e.textSizeData.kind){var f=e.textSizeData,p=f.minZoom,m=f.maxZoom;d.compositeTextSizes=[h["text-size"].possiblyEvaluate(new fa(p),s),h["text-size"].possiblyEvaluate(new fa(m),s)]}if("composite"===e.iconSizeData.kind){var v=e.iconSizeData,g=v.minZoom,y=v.maxZoom;d.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new fa(g),s),h["icon-size"].possiblyEvaluate(new fa(y),s)]}d.layoutTextSize=h["text-size"].possiblyEvaluate(new fa(l+1),s),d.layoutIconSize=h["icon-size"].possiblyEvaluate(new fa(l+1),s),d.textMaxSize=h["text-size"].possiblyEvaluate(new fa(18),s);var _,x="map"===c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),b=c.get("text-size"),w=_createForOfIteratorHelper(e.features);try{var k=function(){var a,l=_.value,h=c.get("text-font").evaluate(l,{},s).join(","),f=b.evaluate(l,{},s),p=d.layoutTextSize.evaluate(l,{},s),m=(d.layoutIconSize.evaluate(l,{},s),{horizontal:{},vertical:void 0}),v=l.text,g=[0,0];if(v){var y=v.toString(),w=24*c.get("text-letter-spacing").evaluate(l,{},s),k=24*c.get("text-line-height").evaluate(l,{},s),C=function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){if(!Kr(t.value.charCodeAt(0)))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}(y)?w:0,S=c.get("text-anchor").evaluate(l,{},s),T=c.get("text-variable-anchor");if(!T){var E=c.get("text-radial-offset").evaluate(l,{},s);g=E?jd(S,[24*E,Bd]):c.get("text-offset").evaluate(l,{},s).map((function(e){return 24*e}))}var P=x?"center":c.get("text-justify").evaluate(l,{},s),M="point"===c.get("symbol-placement"),I=M?24*c.get("text-max-width").evaluate(l,{},s):1/0,A=function(i){e.allowVerticalPlacement&&Xr(y)&&(m.vertical=rd(v,t,n,r,h,I,k,S,i,C,g,td.vertical,!0,p,f))};if(!x&&T){for(var R="auto"===P?T.map((function(e){return Vd(e)})):[P],O=!1,N=0;N<R.length;N++){var D=R[N];if(!m.horizontal[D])if(O)m.horizontal[D]=m.horizontal[0];else{var z=rd(v,t,n,r,h,I,k,"center",D,C,g,td.horizontal,!1,p,f);z&&(m.horizontal[D]=z,O=1===z.positionedLines.length)}}A("left")}else{if("auto"===P&&(P=Vd(S)),M||c.get("text-writing-mode").indexOf("horizontal")>=0||!Xr(y)){var L=rd(v,t,n,r,h,I,k,S,P,C,g,td.horizontal,!1,p,f);L&&(m.horizontal[P]=L)}A(M?"left":P)}}var B=!1;if(l.icon&&l.icon.name){var F=i[l.icon.name];F&&(a=function(e,t,n){var i=hd(n),r=i.horizontalAlign,a=i.verticalAlign,o=t[0]-e.displaySize[0]*r,s=t[1]-e.displaySize[1]*a;return{image:e,top:s,bottom:s+e.displaySize[1],left:o,right:o+e.displaySize[0]}}(r[l.icon.name],c.get("icon-offset").evaluate(l,{},s),c.get("icon-anchor").evaluate(l,{},s)),B=F.sdf,void 0===e.sdfIcons?e.sdfIcons=F.sdf:e.sdfIcons!==F.sdf&&q("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(F.pixelRatio!==e.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var j=Zd(m.horizontal)||m.vertical;e.iconsInText||(e.iconsInText=!!j&&j.iconsInText),(j||a)&&Ud(e,l,m,a,i,d,p,0,g,B,o,s,u)};for(w.s();!(_=w.n()).done;)k()}catch(C){w.e(C)}finally{w.f()}a&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray)}function Vd(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ud(e,t,n,i,r,a,o,s,l,u,c,h,d){var f=a.textMaxSize.evaluate(t,{},h);void 0===f&&(f=o);var p,m,v=e.layers[0].layout,g=v.get("icon-offset").evaluate(t,{},h),y=Zd(n.horizontal)||n.vertical,_="globe"===d.name,x=o/24,w=e.tilePixelRatio*f/24,k=(p=e.overscaling,e.zoom>18&&p>2&&(p>>=1),Math.max(Qo/(512*p),1)*v.get("symbol-spacing")),C=v.get("text-padding")*e.tilePixelRatio,S=v.get("icon-padding")*e.tilePixelRatio,T=b(v.get("text-max-angle")),E="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement"),P="map"===v.get("icon-rotation-alignment")&&"point"!==v.get("symbol-placement"),M=v.get("symbol-placement"),I=k/2,A=v.get("icon-text-fit");i&&"none"!==A&&(e.allowVerticalPlacement&&n.vertical&&(m=fd(i,n.vertical,A,v.get("icon-text-fit-padding"),g,x)),y&&(i=fd(i,y,A,v.get("icon-text-fit-padding"),g,x)));var R=function(o,s,f){if(!(s.x<0||s.x>=Qo||s.y<0||s.y>=Qo)){var p=null;if(_){var v=d.projectTilePoint(s.x,s.y,f),y=v.x,x=v.y,b=v.z;p={anchor:new pd(y,x,b,0,void 0),up:d.upVector(f,s.x,s.y)}}!function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w,k,C,S,T){var E,P,M,I,A,R,O,N=e.addToLineVertexArray(t,i),D=0,z=0,L=0,B=0,F=-1,j=-1,H={},V=ko(""),U=n?n.anchor:t,G=0,W=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?(G=(T=_slicedToArray(l.layout.get("text-offset").evaluate(x,{},C).map((function(e){return 24*e})),2))[0],W=T[1]):(G=24*l.layout.get("text-radial-offset").evaluate(x,{},C),W=Bd),e.allowVerticalPlacement&&r.vertical){var Z=r.vertical;if(p)R=Kd(Z),s&&(O=Kd(s));else{var X=l.layout.get("text-rotate").evaluate(x,{},C)+90;M=Xd(u,U,t,c,h,d,Z,f,X,m),s&&(I=Xd(u,U,t,c,h,d,s,g,X))}}if(a){var K=l.layout.get("icon-rotate").evaluate(x,{},C),Y="none"!==l.layout.get("icon-text-fit"),J=Ed(a,K,w,Y),Q=s?Ed(s,K,w,Y):void 0;P=Xd(u,U,t,c,h,d,a,g,K),D=4*J.length;var $=e.iconSizeData,ee=null;"source"===$.kind?(ee=[yh*l.layout.get("icon-size").evaluate(x,{},C)])[0]>Gd&&q("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(qd,'. Reduce your "icon-size".')):"composite"===$.kind&&(((ee=[yh*b.compositeIconSizes[0].evaluate(x,{},C),yh*b.compositeIconSizes[1].evaluate(x,{},C)])[0]>Gd||ee[1]>Gd)&&q("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(qd,'. Reduce your "icon-size".'))),e.addSymbols(e.icon,J,ee,_,y,x,!1,n,t,N.lineStartIndex,N.lineLength,-1,k,C),F=e.icon.placedSymbolArray.length-1,Q&&(z=4*Q.length,e.addSymbols(e.icon,Q,ee,_,y,x,td.vertical,n,t,N.lineStartIndex,N.lineLength,-1,k,C),j=e.icon.placedSymbolArray.length-1)}for(var te in r.horizontal){var ne=r.horizontal[te];E||(V=ko(ne.text),p?A=Kd(ne):E=Xd(u,U,t,c,h,d,ne,f,l.layout.get("text-rotate").evaluate(x,{},C),m));var ie=1===ne.positionedLines.length;if(L+=Wd(e,n,t,ne,o,l,p,x,m,N,r.vertical?td.horizontal:td.horizontalOnly,ie?Object.keys(r.horizontal):[te],H,F,b,k,C),ie)break}r.vertical&&(B+=Wd(e,n,t,r.vertical,o,l,p,x,m,N,td.vertical,["vertical"],H,j,b,k,C));var re=-1,ae=function(e,t){return e?Math.max(e,t):t};re=ae(A,re),re=ae(R,re);var oe=(re=ae(O,re))>-1?1:0;e.glyphOffsetArray.length>=Pf.MAX_GLYPHS&&q("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(U.x,U.y,U.z,t.x,t.y,H.right>=0?H.right:-1,H.center>=0?H.center:-1,H.left>=0?H.left:-1,H.vertical>=0?H.vertical:-1,F,j,V,void 0!==E?E:e.collisionBoxArray.length,void 0!==E?E+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,void 0!==P?P:e.collisionBoxArray.length,void 0!==P?P+1:e.collisionBoxArray.length,I||e.collisionBoxArray.length,I?I+1:e.collisionBoxArray.length,c,L,B,D,z,oe,0,G,W,re)}(e,s,p,o,n,i,r,m,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,C,E,l,0,S,P,g,t,a,u,c,h)}};if("line"===M){var O,N=_createForOfIteratorHelper(bd(t.geometry,0,0,Qo,Qo));try{for(N.s();!(O=N.n()).done;){var D,z=O.value,L=_createForOfIteratorHelper(xd(z,k,T,n.vertical||y,i,24,w,e.overscaling,Qo));try{for(L.s();!(D=L.n()).done;){var B=D.value;y&&Yd(e,y.text,I,B)||R(z,B,h)}}catch(ne){L.e(ne)}finally{L.f()}}}catch(ne){N.e(ne)}finally{N.f()}}else if("line-center"===M){var F,j=_createForOfIteratorHelper(t.geometry);try{for(j.s();!(F=j.n()).done;){var H=F.value;if(H.length>1){var V=_d(H,T,n.vertical||y,i,24,w);V&&R(H,V,h)}}}catch(ne){j.e(ne)}finally{j.f()}}else if("Polygon"===t.type){var U,G=_createForOfIteratorHelper(ac(t.geometry,0));try{for(G.s();!(U=G.n()).done;){var W=U.value,Z=Dd(W,16);R(W[0],new pd(Z.x,Z.y,0,0,void 0),h)}}catch(ne){G.e(ne)}finally{G.f()}}else if("LineString"===t.type){var X,K=_createForOfIteratorHelper(t.geometry);try{for(K.s();!(X=K.n()).done;){var Y=X.value;R(Y,new pd(Y[0].x,Y[0].y,0,0,void 0),h)}}catch(ne){K.e(ne)}finally{K.f()}}else if("Point"===t.type){var J,Q=_createForOfIteratorHelper(t.geometry);try{for(Q.s();!(J=Q.n()).done;){var $,ee=_createForOfIteratorHelper(J.value);try{for(ee.s();!($=ee.n()).done;){var te=$.value;R([te],new pd(te.x,te.y,0,0,void 0),h)}}catch(ne){ee.e(ne)}finally{ee.f()}}}catch(ne){Q.e(ne)}finally{Q.f()}}}var qd=255,Gd=qd*yh;function Wd(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v){var g=function(e,t,n,i,r,a,o,s){var l=[];if(0===t.positionedLines.length)return l;var u,c=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,h=function(e){var t=e[0],n=e[1],i=t*n;return i>0?[t,-n]:i<0?[-t,n]:0===t?[n,t]:[n,-t]}(n),d=Math.abs(t.top-t.bottom),f=_createForOfIteratorHelper(t.positionedLines);try{for(f.s();!(u=f.n()).done;){d-=u.value.lineOffset}}catch(ie){f.e(ie)}finally{f.f()}for(var p=t.positionedLines.length,m=d/p,v=t.top-n[1],g=0;g<p;++g){var _=t.positionedLines[g];v=Rd(t,m,v,g);var x,b=_createForOfIteratorHelper(_.positionedGlyphs);try{for(b.s();!(x=b.n()).done;){var w=x.value;if(w.rect){var k=w.rect||{},C=4,S=!0,T=1,E=0;if(w.imageName){var P=o[w.imageName];if(!P)continue;if(P.sdf){q("SDF images are not supported in formatted text and will be ignored.");continue}S=!1,C=1/(T=P.pixelRatio)}var M=(r||s)&&w.vertical,I=w.metrics.advance*w.scale/2,A=w.metrics,R=w.rect;if(null!==R){s&&t.verticalizable&&(E=w.imageName?I-w.metrics.width*w.scale/2:0);var O=r?[w.x+I,w.y]:[0,0],N=[0,0],D=[0,0],z=!1;r||(M?(D=[w.x+I+h[0],w.y+h[1]-E],z=!0):N=[w.x+I+n[0],w.y+n[1]-E]);var L=R.w*w.scale/(T*(w.localGlyph?2:1)),B=R.h*w.scale/(T*(w.localGlyph?2:1)),F=void 0,j=void 0,H=void 0,V=void 0;if(M){var U=w.y-v,G=new y(-I,I-U),W=-Math.PI/2,Z=_construct2(y,_toConsumableArray(D));(F=new y(-I+N[0],N[1]))._rotateAround(W,G)._add(Z),F.x+=-U+I,F.y-=(A.left-C)*w.scale;var X=w.imageName?A.advance*w.scale:24*w.scale,K=String.fromCharCode(w.glyph);Ch(K)?F.x+=(1-C)*w.scale:Sh(K)?F.x+=X-A.height*w.scale+(-C-1)*w.scale:F.x+=w.imageName||A.width+2*C===R.w&&A.height+2*C===R.h?(X-B)/2:(X-(A.height+2*C)*w.scale)/2,j=new y(F.x,F.y-L),H=new y(F.x+B,F.y),V=new y(F.x+B,F.y-L)}else{var Y=(A.left-C)*w.scale-I+N[0],J=(-A.top-C)*w.scale+N[1],Q=Y+L,$=J+B;F=new y(Y,J),j=new y(Q,J),H=new y(Y,$),V=new y(Q,$)}if(c){var ee;ee=r?new y(0,0):z?new y(h[0],h[1]):new y(n[0],n[1]),F._rotateAround(c,ee),j._rotateAround(c,ee),H._rotateAround(c,ee),V._rotateAround(c,ee)}var te=new y(0,0),ne=new y(0,0);l.push({tl:F,tr:j,bl:H,br:V,tex:k,writingMode:t.writingMode,glyphOffset:O,sectionIndex:w.sectionIndex,isSDF:S,pixelOffsetTL:te,pixelOffsetBR:ne,minFontScaleX:0,minFontScaleY:0})}}}}catch(ie){b.e(ie)}finally{b.f()}}return l}(0,i,l,a,o,s,r,e.allowVerticalPlacement),_=e.textSizeData,x=null;"source"===_.kind?(x=[yh*a.layout.get("text-size").evaluate(s,{},v)])[0]>Gd&&q("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(qd,'. Reduce your "text-size".')):"composite"===_.kind&&(((x=[yh*p.compositeTextSizes[0].evaluate(s,{},v),yh*p.compositeTextSizes[1].evaluate(s,{},v)])[0]>Gd||x[1]>Gd)&&q("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(qd,'. Reduce your "text-size".'))),e.addSymbols(e.text,g,x,l,o,s,c,t,n,u.lineStartIndex,u.lineLength,f,m,v);var b,w=_createForOfIteratorHelper(h);try{for(w.s();!(b=w.n()).done;){d[b.value]=e.text.placedSymbolArray.length-1}}catch(k){w.e(k)}finally{w.f()}return 4*g.length}function Zd(e){for(var t in e)return e[t];return null}function Xd(e,t,n,i,r,a,o,s,l,u){var c=o.top,h=o.bottom,d=o.left,f=o.right,p=o.collisionPadding;if(p&&(d-=p[0],c-=p[1],f+=p[2],h+=p[3]),l){var m=new y(d,c),v=new y(f,c),g=new y(d,h),_=new y(f,h),x=b(l),w=new y(0,0);u&&(w=new y(u[0],u[1])),m._rotateAround(x,w),v._rotateAround(x,w),g._rotateAround(x,w),_._rotateAround(x,w),d=Math.min(m.x,v.x,g.x,_.x),f=Math.max(m.x,v.x,g.x,_.x),c=Math.min(m.y,v.y,g.y,_.y),h=Math.max(m.y,v.y,g.y,_.y)}return e.emplaceBack(t.x,t.y,t.z,n.x,n.y,d,c,f,h,s,i,r,a),e.length-1}function Kd(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);var t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Yd(e,t,n,i){var r=e.compareText;if(t in r){for(var a=r[t],o=a.length-1;o>=0;o--)if(i.dist(a[o])<n)return!0}else r[t]=[];return r[t].push(i),!1}function Jd(e,t){var n=e.fovAboveCenter,i=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,r=(e._camera.position[2]*e.worldSize-i)/Math.cos(e._pitch),a=Math.sin(n)*r/Math.sin(Math.max(Math.PI/2-e._pitch-n,.01)),o=Math.sin(e._pitch)*a+r;return Math.min(1.01*o,r*(1/e._horizonShift))}function Qd(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};var n=Math.pow(2,-e.z),i=e.x*n,r=(e.x+1)*n,a=e.y*n,o=(e.y+1)*n,s=Al(i),l=Al(r),u=Rl(a),c=Rl(o),h=t.project(s,u),d=t.project(l,u),f=t.project(l,c),p=t.project(s,c),m=Math.min(h.x,d.x,f.x,p.x),v=Math.min(h.y,d.y,f.y,p.y),g=Math.max(h.x,d.x,f.x,p.x),y=Math.max(h.y,d.y,f.y,p.y),_=n/16;function x(e,n,i,r,a,o){var s=(i+a)/2,l=(r+o)/2,u=t.project(Al(s),Rl(l)),c=Math.max(0,m-u.x,v-u.y,u.x-g,u.y-y);m=Math.min(m,u.x),g=Math.max(g,u.x),v=Math.min(v,u.y),y=Math.max(y,u.y),c>_&&(x(e,u,i,r,s,l),x(u,n,s,l,a,o))}x(h,d,i,a,r,a),x(d,f,r,a,r,o),x(f,p,r,o,i,o),x(p,h,i,o,i,a),m-=_,v-=_,g+=_,y+=_;var b=1/Math.max(g-m,y-v);return{scale:b,x:m*b,y:v*b,x2:g*b,y2:y*b,projection:t}}var $d=rs(new Float32Array(16)),ef=function(){function e(t){_classCallCheck(this,e),this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}return _createClass(e,[{key:"project",value:function(e,t){return{x:0,y:0,z:0}}},{key:"unproject",value:function(e,t){return new Tl(0,0)}},{key:"projectTilePoint",value:function(e,t,n){return{x:e,y:t,z:0}}},{key:"locationPoint",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._coordinatePoint(e.locationCoordinate(t),n)}},{key:"pixelsPerMeter",value:function(e,t){return Il(1,e)*t}},{key:"pixelSpaceConversion",value:function(e,t,n){return 1}},{key:"farthestPixelDistance",value:function(e){return Jd(e,e.pixelsPerMeter)}},{key:"pointCoordinate",value:function(e,t,n,i){var r=e.horizonLineFromTop(!1),a=new y(t,Math.max(r,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(a,i))}},{key:"pointCoordinate3D",value:function(e,t,n){var i=new y(t,n);if(e.elevation)return e.elevation.pointCoordinate(i);var r=this.pointCoordinate(e,i.x,i.y,0);return[r.x,r.y,r.z]}},{key:"isPointAboveHorizon",value:function(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);var n=e.horizonLineFromTop();return t.y<n}},{key:"createInversionMatrix",value:function(e,t){return $d}},{key:"createTileMatrix",value:function(e,t,n){var i,r,a,o=n.canonical,s=rs(new Float64Array(16));if(this.isReprojectedInTileSpace){var l=Qd(o,this);i=1,r=l.x+n.wrap*l.scale,a=l.y,ls(s,s,[i/l.scale,i/l.scale,e.pixelsPerMeter/t])}else i=t/e.zoomScale(o.z),r=(o.x+Math.pow(2,o.z)*n.wrap)*i,a=o.y*i;return ss(s,s,[r,a,0]),ls(s,s,[i/Qo,i/Qo,1]),s}},{key:"upVector",value:function(e,t,n){return[0,0,1]}},{key:"upVectorScale",value:function(e,t,n){return{metersToTile:1}}}]),e}(),tf=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t,[e])).range=[4,7],n.center=e.center||[-96,37.5];var i=_slicedToArray(n.parallels=e.parallels||[29.5,45.5],2),r=i[0],a=i[1],o=Math.sin(b(r));return n.n=(o+Math.sin(b(a)))/2,n.c=1+o*(2*n.n-o),n.r0=Math.sqrt(n.c)/n.n,n}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){var n=this.n,i=this.c,r=this.r0,a=b(e-this.center[0]),o=b(t),s=Math.sqrt(i-2*n*Math.sin(o))/n;return{x:s*Math.sin(a*n),y:s*Math.cos(a*n)-r,z:0}}},{key:"unproject",value:function(e,t){var n=this.n,i=this.c,r=this.r0+t,a=Math.atan2(e,Math.abs(r))*Math.sign(r);r*n<0&&(a-=Math.PI*Math.sign(e)*Math.sign(r));var o=b(this.center[0])*n,s=E(w((a=M(a,-Math.PI-o,Math.PI-o))/n)+this.center[0],-180,180),l=Math.asin(E((i-(e*e+r*r)*n*n)/(2*n),-1,1)),u=E(w(l),-Nl,Nl);return new Tl(s,u)}}]),t}(ef),nf=1.340264,rf=-.081106,af=893e-6,of=.003796,sf=Math.sqrt(3)/2,lf=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){t=t/180*Math.PI,e=e/180*Math.PI;var n=Math.asin(sf*Math.sin(t)),i=n*n,r=i*i*i;return{x:.5*(e*Math.cos(n)/(sf*(nf+3*rf*i+r*(7*af+9*of*i)))/Math.PI+.5),y:1-.5*(n*(nf+rf*i+r*(af+of*i))/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI;for(var n,i=t=(2*(1-t)-1)*Math.PI,r=i*i,a=r*r*r,o=0;o<12&&(a=(r=(i=E(i-(n=(i*(nf+rf*r+a*(af+of*r))-t)/(nf+3*rf*r+a*(7*af+9*of*r))),-Math.PI/3,Math.PI/3))*i)*r*r,!(Math.abs(n)<1e-12));++o);var s=sf*e*(nf+3*rf*r+a*(7*af+9*of*r))/Math.cos(i),l=Math.asin(Math.sin(i)/sf),u=E(180*s/Math.PI,-180,180),c=E(180*l/Math.PI,-Nl,Nl);return new Tl(u,c)}}]),t}(ef),uf=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).wrap=!0,n.supportsWorldCopies=!0,n}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}},{key:"unproject",value:function(e,t){var n=360*(e-.5),i=E(360*(.5-t),-Nl,Nl);return new Tl(n,i)}}]),t}(ef),cf=Math.PI/2;function hf(e){return Math.tan((cf+e)/2)}var df=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t,[e])).center=e.center||[0,30];var i=_slicedToArray(n.parallels=e.parallels||[30,30],2),r=i[0],a=i[1],o=b(r),s=b(a);n.southernCenter=o+s<0,n.southernCenter&&(o=-o,s=-s);var l=Math.cos(o),u=hf(o);return n.n=o===s?Math.sin(o):Math.log(l/Math.cos(s))/Math.log(hf(s)/u),n.f=l*Math.pow(hf(o),n.n)/n.n,n}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){t=b(t),this.southernCenter&&(t=-t),e=b(e-this.center[0]);var n=1e-6,i=this.n,r=this.f;r>0?t<-cf+n&&(t=-cf+n):t>cf-n&&(t=cf-n);var a=r/Math.pow(hf(t),i),o=a*Math.sin(i*e),s=r-a*Math.cos(i*e);return o=.5*(o/Math.PI+.5),s=.5*(s/Math.PI+.5),{x:o,y:this.southernCenter?s:1-s,z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;var n=this.n,i=this.f,r=i-t,a=Math.sign(r),o=Math.sign(n)*Math.sqrt(e*e+r*r),s=Math.atan2(e,Math.abs(r))*a;r*n<0&&(s-=Math.PI*Math.sign(e)*a);var l=E(w(s/n)+this.center[0],-180,180),u=E(w(2*Math.atan(Math.pow(i/o,1/n))-cf),-Nl,Nl);return new Tl(l,this.southernCenter?-u:u)}}]),t}(ef),ff=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).wrap=!0,n.supportsWorldCopies=!0,n.supportsTerrain=!0,n.supportsFog=!0,n.supportsFreeCamera=!0,n.isReprojectedInTileSpace=!1,n.unsupportedLayers=[],n.range=null,n}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){return{x:Pl(e),y:Ml(t),z:0}}},{key:"unproject",value:function(e,t){var n=Al(e),i=Rl(t);return new Tl(n,i)}}]),t}(ef),pf=b(Nl),mf=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){var n=(t=b(t))*t,i=n*n;return{x:.5*((e=b(e))*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){e=(2*e-.5)*Math.PI;var n=t=(2*(1-t)-1)*Math.PI,i=25,r=0,a=n*n;do{var o=(a=n*n)*a;n=E(n-(r=(n*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-t)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))),-pf,pf)}while(Math.abs(r)>1e-6&&--i>0);var s=E(w(e/(.8707+(a=n*n)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979))),-180,180),l=w(n);return new Tl(s,l)}}]),t}(ef),vf=b(Nl),gf=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){t=b(t),e=b(e);var n=Math.cos(t),i=2/Math.PI,r=Math.acos(n*Math.cos(e/2)),a=Math.sin(r)/r,o=.5*(e*i+2*n*Math.sin(e/2)/a)||0,s=.5*(t+Math.sin(t)/a)||0;return{x:.5*(o/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}},{key:"unproject",value:function(e,t){var n=e=(2*e-.5)*Math.PI,i=t=(2*(1-t)-1)*Math.PI,r=25,a=1e-6,o=0,s=0;do{var l=Math.cos(i),u=Math.sin(i),c=2*u*l,h=u*u,d=l*l,f=Math.cos(n/2),p=Math.sin(n/2),m=2*f*p,v=p*p,g=1-d*f*f,y=g?1/g:0,_=g?Math.acos(l*f)*Math.sqrt(1/g):0,x=.5*(2*_*l*p+2*n/Math.PI)-e,b=.5*(_*u+i)-t,k=.5*y*(d*v+_*l*f*h)+1/Math.PI,C=y*(m*c/4-_*u*p),S=.125*y*(c*p-_*u*d*m),T=.5*y*(h*f+_*v*l)+.5,P=C*S-T*k;s=(x*S-b*k)/P,n=E(n-(o=(b*C-x*T)/P),-Math.PI,Math.PI),i=E(i-s,-vf,vf)}while((Math.abs(o)>a||Math.abs(s)>a)&&--r>0);return new Tl(w(n),w(i))}}]),t}(ef),yf=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).center=e.center||[0,0],n.parallels=e.parallels||[0,0],n.cosPhi=Math.max(.01,Math.cos(b(n.parallels[0]))),n.scale=1/(2*Math.max(Math.PI*n.cosPhi,1/n.cosPhi)),n.wrap=!0,n.supportsWorldCopies=!0,n}return _inherits(t,e),_createClass(t,[{key:"project",value:function(e,t){var n=this.scale,i=this.cosPhi;return{x:b(e)*i*n+.5,y:-Math.sin(b(t))/i*n+.5,z:0}}},{key:"unproject",value:function(e,t){var n=this.scale,i=this.cosPhi,r=-(t-.5)/n,a=E(w((e-.5)/n)/i,-180,180),o=Math.asin(E(r*i,-1,1)),s=E(w(o),-Nl,Nl);return new Tl(a,s)}}]),t}(ef),_f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).requiresDraping=!0,n.supportsWorldCopies=!1,n.supportsFog=!0,n.zAxisUnit="pixels",n.unsupportedLayers=["debug"],n.range=[3,5],n}return _inherits(t,e),_createClass(t,[{key:"projectTilePoint",value:function(e,t,n){var i=dl(e,t,n);return Ps(i,i,ml(rl(n))),{x:i[0],y:i[1],z:i[2]}}},{key:"locationPoint",value:function(e,t){var n=hl(t.lat,t.lng),i=Ss([],n),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;Cs(n,n,i,Il(1,0)*Qo*r);var a=rs(new Float64Array(16));return os(a,e.pixelMatrix,e.globeMatrix),Ps(n,n,a),new y(n[0],n[1])}},{key:"pixelsPerMeter",value:function(e,t){return Il(1,0)*t}},{key:"pixelSpaceConversion",value:function(e,t,n){var i=Il(1,e)*t,r=xn(Il(1,45)*t,i,n);return this.pixelsPerMeter(e,t)/r}},{key:"createTileMatrix",value:function(e,t,n){var i=vl(rl(n.canonical));return os(new Float64Array(16),e.globeMatrix,i)}},{key:"createInversionMatrix",value:function(e,t){var n=e.center,i=ml(rl(t));return cs(i,i,b(n.lng)),us(i,i,b(n.lat)),ls(i,i,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(i)}},{key:"pointCoordinate",value:function(e,t,n,i){return tl(e,t,n,!0)||new zl(0,0)}},{key:"pointCoordinate3D",value:function(e,t,n){var i=this.pointCoordinate(e,t,n,0);return[i.x,i.y,i.z]}},{key:"isPointAboveHorizon",value:function(e,t){return!tl(e,t.x,t.y,!1)}},{key:"farthestPixelDistance",value:function(e){var t=function(e,t){var n,i=e.cameraToCenterDistance,r=e._centerAltitude*t,a=e._camera,o=e._camera.forward(),s=ys([],ks([],o,-i),[0,0,r]),l=e.worldSize/(2*Math.PI),u=[0,0,-l],c=e.width/e.height,h=Math.tan(e.fovAboveCenter),d=ks([],a.up(),h),f=ks([],a.right(),h*c),p=Ss([],ys([],ys([],o,d),f)),m=[];if(new Gs(s,p).closestPointOnSphere(u,l,m)){var v=ys([],m,u),g=As([],v,s);n=Math.cos(e.fovAboveCenter)*vs(g)}else{var y=As([],s,u),_=As([],u,s);Ss(_,_);var x=vs(y)-l;n=Math.sqrt(x*(x+2*l));var b=Math.acos(n/(l+x))-Math.acos(Ts(o,_));n*=Math.cos(b)}return 1.01*n}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),n=yl(e.zoom);if(n>0){var i=Jd(e,Il(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),a=Math.max(e.width,e.height)/e.worldSize*Math.PI;return xn(t,i+r*(1-Math.cos(a)),Math.pow(n,10))}return t}},{key:"upVector",value:function(e,t,n){return dl(t,n,e,1)}},{key:"upVectorScale",value:function(e){return{metersToTile:el(fl(rl(e)))}}}]),t}(ff);function xf(e){var t=e.parallels,n=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new ff(e);case"equirectangular":return new uf(e);case"naturalEarth":return new mf(e);case"equalEarth":return new lf(e);case"winkelTripel":return new gf(e);case"albers":return n?new yf(e):new tf(e);case"lambertConformalConic":return n?new yf(e):new df(e);case"globe":return new _f(e)}throw new Error("Invalid projection name: "+e.name)}var bf=Mc.types,wf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function kf(e,t,n,i,r,a,o,s,l,u,c,h,d){var f=s?Math.min(Gd,Math.round(s[0])):0,p=s?Math.min(Gd,Math.round(s[1])):0;e.emplaceBack(t,n,Math.round(32*i),Math.round(32*r),a,o,(f<<1)+(l?1:0),p,16*u,16*c,256*h,256*d)}function Cf(e,t,n,i,r,a,o){e.emplaceBack(t,n,i,r,a,o)}function Sf(e,t,n,i,r){e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r)}var Tf=function(){function e(t){_classCallCheck(this,e),this.layoutVertexArray=new ja,this.indexArray=new Xa,this.programConfigurations=t,this.segments=new Jo,this.dynamicLayoutVertexArray=new za,this.opacityVertexArray=new Va,this.placedSymbolArray=new oo,this.globeExtVertexArray=new Ha}return _createClass(e,[{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}},{key:"upload",value:function(e,t,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,fh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wf,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,dh.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}]),e}();mr(Tf,"SymbolBuffers");var Ef=function(){function e(t,n,i){_classCallCheck(this,e),this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new i,this.segments=new Jo,this.collisionVertexArray=new Wa,this.collisionVertexArrayExt=new Za}return _createClass(e,[{key:"upload",value:function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ph.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,mh.members,!0)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}]),e}();mr(Ef,"CollisionBuffers");var Pf=function(){function e(t){_classCallCheck(this,e),this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=rs([]),this.placementViewportMatrix=rs([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_h(this.zoom,n["text-size"]),this.iconSizeData=_h(this.zoom,n["icon-size"]);var i=this.layers[0].layout,r=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map((function(e){return td[e]})),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=t.sourceID,this.projection=t.projection}return _createClass(e,[{key:"createArrays",value:function(){this.text=new Tf(new Ho(this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new Tf(new Ho(this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new uo,this.lineVertexArray=new co,this.symbolInstances=new lo}},{key:"calculateGlyphDependencies",value:function(e,t,n,i,r){for(var a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,i&&r){var o=kh[e.charAt(a)];o&&(t[o.charCodeAt(0)]=!0)}}},{key:"populate",value:function(e,t,n,i){var r=this,a=this.layers[0],o=a.layout,s="globe"===this.projection.name,l=o.get("text-font"),u=o.get("text-field"),c=o.get("icon-image"),h=("constant"!==u.value.kind||u.value.value instanceof At&&!u.value.value.isEmpty()||u.value.value.toString().length>0)&&("constant"!==l.value.kind||l.value.value.length>0),d="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,f=o.get("symbol-sort-key");if(this.features=[],h||d){var p,m=t.iconDependencies,v=t.glyphDependencies,g=t.availableImages,y=new fa(this.zoom),_=_createForOfIteratorHelper(e);try{var x=function(){var e,t,u=p.value,c=u.feature,_=u.id,x=u.index,b=u.sourceLayerIndex,w=a._featureFilter.needGeometry,k=Gl(c,w);if(!a._featureFilter.filter(y,k,n))return 0;if(w||(k.geometry=ql(c,n,i)),s&&1!==c.type&&n.z<=5)for(var C=k.geometry,S=function(e,t){return Ts(dl(e.x,e.y,n,1),dl(t.x,t.y,n,1))<.98078528056},T=0;T<C.length;T++)C[T]=jl(C[T],S);if(h){var E=a.getValueAndResolveTokens("text-field",k,n,g),P=At.factory(E);(function(e){var t,n=_createForOfIteratorHelper(e.sections);try{for(n.s();!(t=n.n()).done;){if(ea(t.value.text))return!0}}catch(i){n.e(i)}finally{n.f()}return!1})(P)&&(r.hasRTLText=!0),(!r.hasRTLText||"unavailable"===ca()||r.hasRTLText&&da.isParsed())&&(e=function(e,t,n){return e.sections.forEach((function(e){e.text=function(e,t,n){var i=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),da.applyArabicShaping&&(e=da.applyArabicShaping(e)),e}(e.text,t,n)})),e}(P,a,k))}if(d){var M=a.getValueAndResolveTokens("icon-image",k,n,g);t=M instanceof Rt?M:Rt.fromString(M)}if(!e&&!t)return 0;var I=r.sortFeaturesByKey?f.evaluate(k,{},n):void 0;if(r.features.push({id:_,text:e,icon:t,index:x,sourceLayerIndex:b,geometry:k.geometry,properties:c.properties,type:bf[c.type],sortKey:I}),t&&(m[t.name]=!0),e){var A=l.evaluate(k,{},n).join(","),R="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");r.allowVerticalPlacement=r.writingModes&&r.writingModes.indexOf(td.vertical)>=0;var O,N=_createForOfIteratorHelper(e.sections);try{for(N.s();!(O=N.n()).done;){var D=O.value;if(D.image)m[D.image.name]=!0;else{var z=Xr(e.toString()),L=D.fontStack||A,B=v[L]=v[L]||{};r.calculateGlyphDependencies(D.text,B,R,r.allowVerticalPlacement,z)}}}catch(F){N.e(F)}finally{N.f()}}};for(_.s();!(p=_.n()).done;)x()}catch(b){_.e(b)}finally{_.f()}"line"===o.get("symbol-placement")&&(this.features=function(e){var t={},n={},i=[],r=0;function a(t){i.push(e[t]),r++}function o(e,t,r){var a=n[e];return delete n[e],n[t]=a,i[a].geometry[0].pop(),i[a].geometry[0]=i[a].geometry[0].concat(r[0]),a}function s(e,n,r){var a=t[n];return delete t[n],t[e]=a,i[a].geometry[0].shift(),i[a].geometry[0]=r[0].concat(i[a].geometry[0]),a}function l(e,t,n){var i=n?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(i.x,":").concat(i.y)}for(var u=0;u<e.length;u++){var c=e[u],h=c.geometry,d=c.text?c.text.toString():null;if(d){var f=l(d,h),p=l(d,h,!0);if(f in n&&p in t&&n[f]!==t[p]){var m=s(f,p,h),v=o(f,p,i[m].geometry);delete t[f],delete n[p],n[l(d,i[v].geometry,!0)]=v,i[m].geometry=null}else f in n?o(f,p,h):p in t?s(f,p,h):(a(u),t[f]=r-1,n[p]=r-1)}else a(u)}return i.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}}},{key:"update",value:function(e,t,n,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n,i))}},{key:"isEmpty",value:function(){return 0===this.symbolInstances.length&&!this.hasRTLText}},{key:"uploadPending",value:function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}},{key:"upload",value:function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}},{key:"destroyDebugData",value:function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}},{key:"getProjection",value:function(){return this.projectionInstance||(this.projectionInstance=xf(this.projection)),this.projectionInstance}},{key:"destroy",value:function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}},{key:"addToLineVertexArray",value:function(e,t){var n=this.lineVertexArray.length;if(void 0!==e.segment){var i,r=_createForOfIteratorHelper(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.x,s=a.y;this.lineVertexArray.emplaceBack(o,s)}}catch(l){r.e(l)}finally{r.f()}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}},{key:"addSymbols",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f){for(var p=e.indexArray,m=e.layoutVertexArray,v=e.globeExtVertexArray,g=e.segments.prepareSegment(4*t.length,m,p,this.canOverlap?a.sortKey:void 0),y=this.glyphOffsetArray.length,_=g.vertexLength,x=this.allowVerticalPlacement&&o===td.vertical?Math.PI/2:0,b=a.text&&a.text.sections,w=0;w<t.length;w++){var k=t[w],C=k.tl,S=k.tr,T=k.bl,E=k.br,P=k.tex,M=k.pixelOffsetTL,I=k.pixelOffsetBR,A=k.minFontScaleX,R=k.minFontScaleY,O=k.glyphOffset,N=k.isSDF,D=k.sectionIndex,z=g.vertexLength,L=O[1];if(kf(m,l.x,l.y,C.x,L+C.y,P.x,P.y,n,N,M.x,M.y,A,R),kf(m,l.x,l.y,S.x,L+S.y,P.x+P.w,P.y,n,N,I.x,M.y,A,R),kf(m,l.x,l.y,T.x,L+T.y,P.x,P.y+P.h,n,N,M.x,I.y,A,R),kf(m,l.x,l.y,E.x,L+E.y,P.x+P.w,P.y+P.h,n,N,I.x,I.y,A,R),s){var B=s.anchor,F=B.x,j=B.y,H=B.z,V=_slicedToArray(s.up,3),U=V[0],q=V[1],G=V[2];Cf(v,F,j,H,U,q,G),Cf(v,F,j,H,U,q,G),Cf(v,F,j,H,U,q,G),Cf(v,F,j,H,U,q,G),Sf(e.dynamicLayoutVertexArray,F,j,H,x)}else Sf(e.dynamicLayoutVertexArray,l.x,l.y,l.z,x);p.emplaceBack(z,z+1,z+2),p.emplaceBack(z+1,z+2,z+3),g.vertexLength+=4,g.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(O[0]),w!==t.length-1&&D===t[w+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},d,f,b&&b[D])}var W=s?s.anchor:l;e.placedSymbolArray.emplaceBack(W.x,W.y,W.z,l.x,l.y,y,this.glyphOffsetArray.length-y,_,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],o,0,!1,0,h,0)}},{key:"_commitLayoutVertex",value:function(e,t,n,i,r,a,o){e.emplaceBack(t,n,i,r,a,Math.round(o.x),Math.round(o.y))}},{key:"_addCollisionDebugVertices",value:function(e,t,n,i,r,a,o){for(var s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=s.vertexLength,u=o.tileAnchorX,c=o.tileAnchorY,h=0;h<4;h++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),n.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(n.layoutVertexArray,i,r,a,u,c,new y(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,r,a,u,c,new y(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,r,a,u,c,new y(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,i,r,a,u,c,new y(e.x1,e.y2)),s.vertexLength+=4;var d=n.indexArray;d.emplaceBack(l,l+1),d.emplaceBack(l+1,l+2),d.emplaceBack(l+2,l+3),d.emplaceBack(l+3,l),s.primitiveLength+=4}},{key:"_addTextDebugCollisionBoxes",value:function(e,t,n,i,r,a){for(var o=i;o<r;o++){var s=n.get(o),l=this.getSymbolInstanceTextSize(e,a,t,o);this._addCollisionDebugVertices(s,l,this.textCollisionBox,s.projectedAnchorX,s.projectedAnchorY,s.projectedAnchorZ,a)}}},{key:"_addIconDebugCollisionBoxes",value:function(e,t,n,i,r,a){for(var o=i;o<r;o++){var s=n.get(o),l=this.getSymbolInstanceIconSize(e,t,a.placedIconSymbolIndex);this._addCollisionDebugVertices(s,l,this.iconCollisionBox,s.projectedAnchorX,s.projectedAnchorY,s.projectedAnchorZ,a)}}},{key:"generateCollisionDebugBuffers",value:function(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ef(qa,vh.members,eo),this.iconCollisionBox=new Ef(qa,vh.members,eo);for(var n=bh(this.iconSizeData,e),i=bh(this.textSizeData,e),r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(i,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._addTextDebugCollisionBoxes(i,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._addIconDebugCollisionBoxes(n,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex,a),this._addIconDebugCollisionBoxes(n,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a)}}},{key:"getSymbolInstanceTextSize",value:function(e,t,n,i){var r=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:i),a=xh(this.textSizeData,e,r)/24;return this.tilePixelRatio*a}},{key:"getSymbolInstanceIconSize",value:function(e,t,n){var i=this.icon.placedSymbolArray.get(n),r=xh(this.iconSizeData,e,i);return this.tilePixelRatio*r}},{key:"_commitDebugCollisionVertexUpdate",value:function(e,t,n){e.emplaceBack(t,-n,-n),e.emplaceBack(t,n,-n),e.emplaceBack(t,n,n),e.emplaceBack(t,-n,n)}},{key:"_updateTextDebugCollisionBoxes",value:function(e,t,n,i,r,a){for(var o=i;o<r;o++){var s=n.get(o),l=this.getSymbolInstanceTextSize(e,a,t,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,l,s.padding)}}},{key:"_updateIconDebugCollisionBoxes",value:function(e,t,n,i,r,a){for(var o=i;o<r;o++){var s=n.get(o),l=this.getSymbolInstanceIconSize(e,t,a);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,l,s.padding)}}},{key:"updateCollisionDebugBuffers",value:function(e,t){if(this.hasDebugData()){this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();for(var n=bh(this.iconSizeData,e),i=bh(this.textSizeData,e),r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(i,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._updateTextDebugCollisionBoxes(i,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._updateIconDebugCollisionBoxes(n,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex,a.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(n,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}}},{key:"_deserializeCollisionBoxesForSymbol",value:function(e,t,n,i,r,a,o,s,l){var u={};if(t<n){var c=e.get(t),h=c.x1,d=c.y1,f=c.x2,p=c.y2,m=c.padding,v=c.projectedAnchorX,g=c.projectedAnchorY,y=c.projectedAnchorZ,_=c.tileAnchorX,x=c.tileAnchorY,b=c.featureIndex;u.textBox={x1:h,y1:d,x2:f,y2:p,padding:m,projectedAnchorX:v,projectedAnchorY:g,projectedAnchorZ:y,tileAnchorX:_,tileAnchorY:x},u.textFeatureIndex=b}if(i<r){var w=e.get(i),k=w.x1,C=w.y1,S=w.x2,T=w.y2,E=w.padding,P=w.projectedAnchorX,M=w.projectedAnchorY,I=w.projectedAnchorZ,A=w.tileAnchorX,R=w.tileAnchorY,O=w.featureIndex;u.verticalTextBox={x1:k,y1:C,x2:S,y2:T,padding:E,projectedAnchorX:P,projectedAnchorY:M,projectedAnchorZ:I,tileAnchorX:A,tileAnchorY:R},u.verticalTextFeatureIndex=O}if(a<o){var N=e.get(a),D=N.x1,z=N.y1,L=N.x2,B=N.y2,F=N.padding,j=N.projectedAnchorX,H=N.projectedAnchorY,V=N.projectedAnchorZ,U=N.tileAnchorX,q=N.tileAnchorY,G=N.featureIndex;u.iconBox={x1:D,y1:z,x2:L,y2:B,padding:F,projectedAnchorX:j,projectedAnchorY:H,projectedAnchorZ:V,tileAnchorX:U,tileAnchorY:q},u.iconFeatureIndex=G}if(s<l){var W=e.get(s),Z=W.x1,X=W.y1,K=W.x2,Y=W.y2,J=W.padding,Q=W.projectedAnchorX,$=W.projectedAnchorY,ee=W.projectedAnchorZ,te=W.tileAnchorX,ne=W.tileAnchorY,ie=W.featureIndex;u.verticalIconBox={x1:Z,y1:X,x2:K,y2:Y,padding:J,projectedAnchorX:Q,projectedAnchorY:$,projectedAnchorZ:ee,tileAnchorX:te,tileAnchorY:ne},u.verticalIconFeatureIndex=ie}return u}},{key:"deserializeCollisionBoxes",value:function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}},{key:"hasTextData",value:function(){return this.text.segments.get().length>0}},{key:"hasIconData",value:function(){return this.icon.segments.get().length>0}},{key:"hasDebugData",value:function(){return this.textCollisionBox&&this.iconCollisionBox}},{key:"hasTextCollisionBoxData",value:function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}},{key:"hasIconCollisionBoxData",value:function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}},{key:"addIndicesForPlacedSymbol",value:function(e,t){for(var n=e.placedSymbolArray.get(t),i=n.vertexStartIndex+4*n.numGlyphs,r=n.vertexStartIndex;r<i;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}},{key:"getSortedSymbolIndexes",value:function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),n=Math.cos(e),i=[],r=[],a=[],o=0;o<this.symbolInstances.length;++o){a.push(o);var s=this.symbolInstances.get(o);i.push(0|Math.round(t*s.tileAnchorX+n*s.tileAnchorY)),r.push(s.featureIndex)}return a.sort((function(e,t){return i[e]-i[t]||r[t]-r[e]})),a}},{key:"addToSortKeyRanges",value:function(e,t){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}},{key:"sortFeatures",value:function(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];var t,n=_createForOfIteratorHelper(this.symbolInstanceIndexes);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=this.symbolInstances.get(i);this.featureSortOrder.push(r.featureIndex);var a=r.rightJustifiedTextSymbolIndex,o=r.centerJustifiedTextSymbolIndex,s=r.leftJustifiedTextSymbolIndex,l=r.verticalPlacedTextSymbolIndex,u=r.placedIconSymbolIndex,c=r.verticalPlacedIconSymbolIndex;a>=0&&this.addIndicesForPlacedSymbol(this.text,a),o>=0&&o!==a&&this.addIndicesForPlacedSymbol(this.text,o),s>=0&&s!==o&&s!==a&&this.addIndicesForPlacedSymbol(this.text,s),l>=0&&this.addIndicesForPlacedSymbol(this.text,l),u>=0&&this.addIndicesForPlacedSymbol(this.icon,u),c>=0&&this.addIndicesForPlacedSymbol(this.icon,c)}}catch(h){n.e(h)}finally{n.f()}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}]),e}();mr(Pf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Pf.MAX_GLYPHS=65535,Pf.addDynamicAttributes=Sf;var Mf=new Sa({"symbol-placement":new wa($e.layout_symbol["symbol-placement"]),"symbol-spacing":new wa($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wa($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ka($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wa($e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wa($e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wa($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new wa($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wa($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new ka($e.layout_symbol["icon-size"]),"icon-text-fit":new wa($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wa($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new ka($e.layout_symbol["icon-image"]),"icon-rotate":new ka($e.layout_symbol["icon-rotate"]),"icon-padding":new wa($e.layout_symbol["icon-padding"]),"icon-keep-upright":new wa($e.layout_symbol["icon-keep-upright"]),"icon-offset":new ka($e.layout_symbol["icon-offset"]),"icon-anchor":new ka($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wa($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wa($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wa($e.layout_symbol["text-rotation-alignment"]),"text-field":new ka($e.layout_symbol["text-field"]),"text-font":new ka($e.layout_symbol["text-font"]),"text-size":new ka($e.layout_symbol["text-size"]),"text-max-width":new ka($e.layout_symbol["text-max-width"]),"text-line-height":new ka($e.layout_symbol["text-line-height"]),"text-letter-spacing":new ka($e.layout_symbol["text-letter-spacing"]),"text-justify":new ka($e.layout_symbol["text-justify"]),"text-radial-offset":new ka($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wa($e.layout_symbol["text-variable-anchor"]),"text-anchor":new ka($e.layout_symbol["text-anchor"]),"text-max-angle":new wa($e.layout_symbol["text-max-angle"]),"text-writing-mode":new wa($e.layout_symbol["text-writing-mode"]),"text-rotate":new ka($e.layout_symbol["text-rotate"]),"text-padding":new wa($e.layout_symbol["text-padding"]),"text-keep-upright":new wa($e.layout_symbol["text-keep-upright"]),"text-transform":new ka($e.layout_symbol["text-transform"]),"text-offset":new ka($e.layout_symbol["text-offset"]),"text-allow-overlap":new wa($e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wa($e.layout_symbol["text-ignore-placement"]),"text-optional":new wa($e.layout_symbol["text-optional"])}),If={paint:new Sa({"icon-opacity":new ka($e.paint_symbol["icon-opacity"]),"icon-color":new ka($e.paint_symbol["icon-color"]),"icon-halo-color":new ka($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new ka($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ka($e.paint_symbol["icon-halo-blur"]),"icon-translate":new wa($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new wa($e.paint_symbol["icon-translate-anchor"]),"text-opacity":new ka($e.paint_symbol["text-opacity"]),"text-color":new ka($e.paint_symbol["text-color"],{runtimeType:ut,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new ka($e.paint_symbol["text-halo-color"]),"text-halo-width":new ka($e.paint_symbol["text-halo-width"]),"text-halo-blur":new ka($e.paint_symbol["text-halo-blur"]),"text-translate":new wa($e.paint_symbol["text-translate"]),"text-translate-anchor":new wa($e.paint_symbol["text-translate-anchor"])}),layout:Mf},Af=function(){function e(t){_classCallCheck(this,e),this.type=t.property.overrides?t.property.overrides.runtimeType:at,this.defaultValue=t}return _createClass(e,[{key:"evaluate",value:function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}},{key:"eachChild",value:function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return null}}]),e}();mr(Af,"FormatSectionOverride",{omit:["defaultValue"]});var Rf=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,If])}return _inherits(t,e),_createClass(t,[{key:"recalculate",value:function(e,n){_get(_getPrototypeOf2(t.prototype),"recalculate",this).call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));var i=this.layout.get("text-writing-mode");if(i){var r,a=[],o=_createForOfIteratorHelper(i);try{for(o.s();!(r=o.n()).done;){var s=r.value;a.indexOf(s)<0&&a.push(s)}}catch(l){o.e(l)}finally{o.f()}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}},{key:"getValueAndResolveTokens",value:function(e,t,n,i){var r=this.layout.get(e).evaluate(t,{},n,i),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||bi(a.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,(function(t,n){return n in e?String(e[n]):""}))}(t.properties,r)}},{key:"createBucket",value:function(e){return new Pf(e)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){return!1}},{key:"_setPaintOverrides",value:function(){var e,n=_createForOfIteratorHelper(If.paint.overridableProperties);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(t.hasPaintOverride(this.layout,i)){var r,a=this.paint.get(i),o=new Af(a),s=new xi(o,a.property.specification);r="constant"===a.value.kind||"source"===a.value.kind?new ki("source",s):new Ci("composite",s,a.value.zoomStops,a.value._interpolationType),this.paint._values[i]=new xa(a.property,r,a.parameters)}}}catch(l){n.e(l)}finally{n.f()}}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,n,i){return!(!this.layout||n.isDataDriven()||i.isDataDriven())&&t.hasPaintOverride(this.layout,e)}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}}],[{key:"hasPaintOverride",value:function(e,t){var n=e.get("text-field"),i=If.paint.properties[t],r=!1,a=function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(i.overrides&&i.overrides.hasOverride(a))return void(r=!0)}}catch(o){n.e(o)}finally{n.f()}};if("constant"===n.value.kind&&n.value.value instanceof At)a(n.value.value.sections);else if("source"===n.value.kind){var o=n.value;o._styleExpression&&function e(t){r||(t instanceof Lt&&Dt(t.value)===ft?a(t.value.sections):t instanceof Ht?a(t.sections):t.eachChild(e))}(o._styleExpression.expression)}return r}}]),t}(Xo),Of={paint:new Sa({"background-color":new wa($e.paint_background["background-color"]),"background-pattern":new wa($e.paint_background["background-pattern"]),"background-opacity":new wa($e.paint_background["background-opacity"])})},Nf={paint:new Sa({"raster-opacity":new wa($e.paint_raster["raster-opacity"]),"raster-hue-rotate":new wa($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wa($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wa($e.paint_raster["raster-brightness-max"]),"raster-saturation":new wa($e.paint_raster["raster-saturation"]),"raster-contrast":new wa($e.paint_raster["raster-contrast"]),"raster-resampling":new wa($e.paint_raster["raster-resampling"]),"raster-fade-duration":new wa($e.paint_raster["raster-fade-duration"])})},Df=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,{}])).implementation=e,n}return _inherits(t,e),_createClass(t,[{key:"is3D",value:function(){return"3d"===this.implementation.renderingMode}},{key:"hasOffscreenPass",value:function(){return void 0!==this.implementation.prerender}},{key:"isLayerDraped",value:function(){return void 0!==this.implementation.renderToTile}},{key:"shouldRedrape",value:function(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}},{key:"recalculate",value:function(){}},{key:"updateTransitions",value:function(){}},{key:"hasTransition",value:function(){return!1}},{key:"serialize",value:function(){}},{key:"onAdd",value:function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}},{key:"onRemove",value:function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}]),t}(Xo),zf={paint:new Sa({"sky-type":new wa($e.paint_sky["sky-type"]),"sky-atmosphere-sun":new wa($e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new wa($e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new wa($e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new wa($e.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ca($e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new wa($e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new wa($e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new wa($e.paint_sky["sky-opacity"])})};function Lf(e,t,n){var i=[0,0,1],r=Bs([]);return js(r,r,n?-b(e)+Math.PI:b(e)),Fs(r,r,-b(t)),Ms(i,i,r),Ss(i,i)}for(var Bf={circle:function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,du])}return _inherits(t,e),_createClass(t,[{key:"createBucket",value:function(e){return new Xl(e)}},{key:"queryRadius",value:function(e){var t=e;return su("circle-radius",this,t)+su("circle-stroke-width",this,t)+lu(this.paint.get("circle-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,n,i,r,a,o,s){var l=cu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n);return fu(e,i,a,o,s,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}},{key:"getProgramIds",value:function(){return["circle"]}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}}]),t}(Xo),heatmap:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,Cu]))._updateColorRamp(),n}return _inherits(t,e),_createClass(t,[{key:"createBucket",value:function(e){return new yu(e)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"heatmap-color"===e&&this._updateColorRamp()}},{key:"_updateColorRamp",value:function(){this.colorRamp=Su({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}},{key:"resize",value:function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}},{key:"queryRadius",value:function(e){return su("heatmap-radius",this,e)}},{key:"queryIntersectsFeature",value:function(e,t,n,i,r,a,o,s){var l=this.paint.get("heatmap-radius").evaluate(t,n);return fu(e,i,a,o,s,!0,!0,new y(0,0),l)}},{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["heatmap","heatmapTexture"]}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}}]),t}(Xo),hillshade:function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,Tu])}return _inherits(t,e),_createClass(t,[{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["hillshade","hillshadePrepare"]}}]),t}(Xo),fill:function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,hc])}return _inherits(t,e),_createClass(t,[{key:"getProgramIds",value:function(){var e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),n=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}},{key:"recalculate",value:function(e,n){_get(_getPrototypeOf2(t.prototype),"recalculate",this).call(this,e,n);var i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}},{key:"createBucket",value:function(e){return new uc(e)}},{key:"queryRadius",value:function(){return lu(this.paint.get("fill-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,n,i,r,a){return!e.queryGeometry.isAboveHorizon&&Jl(uu(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),i)}},{key:"isTileClipped",value:function(){return!0}}]),t}(Xo),"fill-extrusion":function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,Wc])}return _inherits(t,e),_createClass(t,[{key:"createBucket",value:function(e){return new zc(e)}},{key:"queryRadius",value:function(){return lu(this.paint.get("fill-extrusion-translate"))}},{key:"is3D",value:function(){return!0}},{key:"getProgramIds",value:function(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}},{key:"queryIntersectsFeature",value:function(e,t,n,i,r,a,o,s,l){var u=cu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),c=this.paint.get("fill-extrusion-height").evaluate(t,n),h=this.paint.get("fill-extrusion-base").evaluate(t,n),d=[0,0],f=s&&a.elevation,p=a.elevation?a.elevation.exaggeration():1,m=e.tile.getBucket(this);if(f&&m instanceof zc){var v=m.centroidVertexArray,g=l+1;g<v.length&&(d[0]=v.geta_centroid_pos0(g),d[1]=v.geta_centroid_pos1(g))}if(0===d[0]&&1===d[1])return!1;"globe"===a.projection.name&&(i=qc([i],[new y(0,0),new y(Qo,Qo)],e.tileID.canonical).map((function(e){return e.polygon})).flat());var _=_slicedToArray(function(e,t,n,i,r,a,o,s,l,u,c){return"globe"===e.projection.name?function(e,t,n,i,r,a,o,s,l,u,c){var h=[],d=[],f=e.projection.upVectorScale(c,e.center.lat,e.worldSize).metersToTile,p=[0,0,0,1],m=[0,0,0,1],v=function(e,t,n,i){e[0]=t,e[1]=n,e[2]=i,e[3]=1},g=Uc();n>0&&(n+=g),i+=g;var y,_=_createForOfIteratorHelper(t);try{for(_.s();!(y=_.n()).done;){var x,b=y.value,w=[],k=[],C=_createForOfIteratorHelper(b);try{for(C.s();!(x=C.n()).done;){var S=x.value,T=S.x+r.x,E=S.y+r.y,P=e.projection.projectTilePoint(T,E,c),M=e.projection.upVector(c,S.x,S.y),I=n,A=i;if(o){var R=th(T,E,n,i,o,s,l,u);I+=R.base,A+=R.top}0!==n?v(p,P.x+M[0]*f*I,P.y+M[1]*f*I,P.z+M[2]*f*I):v(p,P.x,P.y,P.z),v(m,P.x+M[0]*f*A,P.y+M[1]*f*A,P.z+M[2]*f*A),Ps(p,p,a),Ps(m,m,a),w.push(new Qc(p[0],p[1],p[2])),k.push(new Qc(m[0],m[1],m[2]))}}catch(O){C.e(O)}finally{C.f()}h.push(w),d.push(k)}}catch(O){_.e(O)}finally{_.f()}return[h,d]}(e,t,n,i,r,a,o,s,l,u,c):o?function(e,t,n,i,r,a,o,s,l){var u,c=[],h=[],d=[0,0,0,1],f=_createForOfIteratorHelper(e);try{for(f.s();!(u=f.n()).done;){var p,m=u.value,v=[],g=[],y=_createForOfIteratorHelper(m);try{for(y.s();!(p=y.n()).done;){var _=p.value,x=_.x+i.x,b=_.y+i.y,w=th(x,b,t,n,a,o,s,l);d[0]=x,d[1]=b,d[2]=w.base,d[3]=1,zs(d,d,r),d[3]=Math.max(d[3],1e-5);var k=new Qc(d[0]/d[3],d[1]/d[3],d[2]/d[3]);d[0]=x,d[1]=b,d[2]=w.top,d[3]=1,zs(d,d,r),d[3]=Math.max(d[3],1e-5);var C=new Qc(d[0]/d[3],d[1]/d[3],d[2]/d[3]);v.push(k),g.push(C)}}catch(S){y.e(S)}finally{y.f()}c.push(v),h.push(g)}}catch(S){f.e(S)}finally{f.f()}return[c,h]}(t,n,i,r,a,o,s,l,u):function(e,t,n,i,r){var a,o=[],s=[],l=r[8]*t,u=r[9]*t,c=r[10]*t,h=r[11]*t,d=r[8]*n,f=r[9]*n,p=r[10]*n,m=r[11]*n,v=_createForOfIteratorHelper(e);try{for(v.s();!(a=v.n()).done;){var g,y=a.value,_=[],x=[],b=_createForOfIteratorHelper(y);try{for(b.s();!(g=b.n()).done;){var w=g.value,k=w.x+i.x,C=w.y+i.y,S=r[0]*k+r[4]*C+r[12],T=r[1]*k+r[5]*C+r[13],E=r[2]*k+r[6]*C+r[14],P=r[3]*k+r[7]*C+r[15],M=S+l,I=T+u,A=E+c,R=Math.max(P+h,1e-5),O=S+d,N=T+f,D=E+p,z=Math.max(P+m,1e-5);_.push(new Qc(M/R,I/R,A/R)),x.push(new Qc(O/z,N/z,D/z))}}catch(L){b.e(L)}finally{b.f()}o.push(_),s.push(x)}}catch(L){v.e(L)}finally{v.f()}return[o,s]}(t,n,i,r,a)}(a,i,h,c,u,o,f?s:null,d,p,a.center.lat,e.tileID.canonical),2),x=_[0],b=_[1],w=e.queryGeometry;return function(e,t,n){var i=1/0;Jl(n,t)&&(i=eh(n,t[0]));for(var r=0;r<t.length;r++)for(var a=t[r],o=e[r],s=0;s<a.length-1;s++){var l=a[s],u=[l,a[s+1],o[s+1],o[s],l];Kl(n,u)&&(i=Math.min(i,eh(n,u)))}return i!==1/0&&i}(x,b,w.isPointQuery()?w.screenBounds:w.screenGeometry)}}]),t}(Xo),line:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,lh])).gradientVersion=0,n}return _inherits(t,e),_createClass(t,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){if("line-gradient"===e){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof _n,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}},{key:"gradientExpression",value:function(){return this._transitionablePaint._values["line-gradient"].value.expression}},{key:"widthExpression",value:function(){return this._transitionablePaint._values["line-width"].value.expression}},{key:"recalculate",value:function(e,n){_get(_getPrototypeOf2(t.prototype),"recalculate",this).call(this,e,n),this.paint._values["line-floorwidth"]=uh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}},{key:"createBucket",value:function(e){return new oh(e)}},{key:"getProgramIds",value:function(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}},{key:"getProgramConfiguration",value:function(e){return new jo(this,e)}},{key:"queryRadius",value:function(e){var t=e,n=ch(su("line-width",this,t),su("line-gap-width",this,t)),i=su("line-offset",this,t);return n/2+Math.abs(i)+lu(this.paint.get("line-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,n,i,r,a){if(e.queryGeometry.isAboveHorizon)return!1;var o=uu(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),s=e.pixelToTileUnitsFactor/2*ch(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),l=this.paint.get("line-offset").evaluate(t,n);return l&&(i=function(e,t){for(var n=[],i=new y(0,0),r=0;r<e.length;r++){for(var a=e[r],o=[],s=0;s<a.length;s++){var l=a[s],u=a[s+1],c=0===s?i:l.sub(a[s-1])._unit()._perp(),h=s===a.length-1?i:u.sub(l)._unit()._perp(),d=c._add(h)._unit();d._mult(1/(d.x*h.x+d.y*h.y)),o.push(d._mult(t)._add(l))}n.push(o)}return n}(i,l*e.pixelToTileUnitsFactor)),function(e,t,n){for(var i=0;i<t.length;i++){var r=t[i];if(e.length>=3)for(var a=0;a<r.length;a++)if(ru(e,r[a]))return!0;if(Ql(e,r,n))return!0}return!1}(o,i,s)}},{key:"isTileClipped",value:function(){return!0}}]),t}(Xo),symbol:Rf,background:function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,Of])}return _inherits(t,e),_createClass(t,[{key:"getProgramIds",value:function(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}}]),t}(Xo),raster:function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,Nf])}return _inherits(t,e),_createClass(t,[{key:"getProgramIds",value:function(){return["raster"]}}]),t}(Xo),sky:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,zf]))._updateColorRamp(),n}return _inherits(t,e),_createClass(t,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}},{key:"_updateColorRamp",value:function(){this.colorRamp=Su({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}},{key:"needsSkyboxCapture",value:function(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){var t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}},{key:"getCenter",value:function(e,t){if("atmosphere"===this.paint.get("sky-type")){var n=this.paint.get("sky-atmosphere-sun"),i=!n,r=e.style.light,a=r.properties.get("position");return i&&"viewport"===r.properties.get("anchor")&&q("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?Lf(a.azimuthal,90-a.polar,t):Lf(n[0],90-n[1],t)}var o=this.paint.get("sky-gradient-center");return Lf(o[0],90-o[1],t)}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!0}},{key:"markSkyboxValid",value:function(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}},{key:"hasOffscreenPass",value:function(){return!0}},{key:"getProgramIds",value:function(){var e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}]),t}(Xo)},Ff=function(){function e(t,n,i,r){_classCallCheck(this,e),this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(n,r)}return _createClass(e,[{key:"update",value:function(e,t,n){var i=e.width,a=e.height,o=this.context,s=o.gl,l=r.HTMLImageElement,u=r.HTMLCanvasElement,c=r.HTMLVideoElement,h=r.ImageData,d=r.ImageBitmap;if(s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),n||this.size&&this.size[0]===i&&this.size[1]===a){var f=n||{x:0,y:0},p=f.x,m=f.y;e instanceof l||e instanceof u||e instanceof c||e instanceof h||d&&e instanceof d?s.texSubImage2D(s.TEXTURE_2D,0,p,m,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,p,m,i,a,s.RGBA,s.UNSIGNED_BYTE,e.data)}else this.size=[i,a],e instanceof l||e instanceof u||e instanceof c||e instanceof h||d&&e instanceof d?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,i,a,0,this.format,s.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(t&&t.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&s.generateMipmap(s.TEXTURE_2D)}},{key:"bind",value:function(e,t){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap?e===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}},{key:"isSizePowerOfTwo",value:function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}},{key:"destroy",value:function(){this.context.gl.deleteTexture(this.texture),this.texture=null}}]),e}(),jf=function(){function e(t){var n=this;_classCallCheck(this,e),this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})}return _createClass(e,[{key:"trigger",value:function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))}},{key:"remove",value:function(){this._channel=void 0,this._callback=function(){}}}]),e}(),Hf=function(){function e(){_classCallCheck(this,e),this.tasks={},this.taskQueue=[],B(["process"],this),this.invoker=new jf(this.process),this.nextId=0}return _createClass(e,[{key:"add",value:function(e,t){var n=this,i=this.nextId++,r=function(e){var t=e.type,n=e.isSymbolTile,i=e.zoom;return i=i||0,"message"===t?0:"maybePrepare"!==t||n?"parseTile"!==t||n?"parseTile"===t&&n?300-i:"maybePrepare"===t&&n?400-i:500:200-i:100-i}(t);if(0===r){Z();try{e()}finally{}return{cancel:function(){}}}return this.tasks[i]={fn:e,metadata:t,priority:r,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:function(){delete n.tasks[i]}}}},{key:"process",value:function(){var e=this;Z();try{if(this.taskQueue=this.taskQueue.filter((function(t){return!!e.tasks[t]})),!this.taskQueue.length)return;var t=this.pick();if(null===t)return;var n=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}},{key:"pick",value:function(){for(var e=null,t=1/0,n=0;n<this.taskQueue.length;n++){var i=this.tasks[this.taskQueue[n]];i.priority<t&&(t=i.priority,e=n)}if(null===e)return null;var r=this.taskQueue[e];return this.taskQueue.splice(e,1),r}},{key:"remove",value:function(){this.invoker.remove()}}]),e}(),Vf=function(){function e(t){_classCallCheck(this,e),this._stringToNumber={},this._numberToString=[];for(var n=0;n<t.length;n++){var i=t[n];this._stringToNumber[i]=n,this._numberToString[n]=i}}return _createClass(e,[{key:"encode",value:function(e){return this._stringToNumber[e]}},{key:"decode",value:function(e){return this._numberToString[e]}}]),e}(),Uf=["tile","layer","source","sourceLayer","state"],qf=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.type="Feature",this._vectorTileFeature=t,this._z=n,this._x=i,this._y=r,this.properties=t.properties,this.id=a}return _createClass(e,[{key:"geometry",get:function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry},set:function(e){this._geometry=e}},{key:"toJSON",value:function(){var e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(var t=0,n=Uf;t<n.length;t++){var i=n[t];void 0!==this[i]&&(e[i]=this[i])}return e}}]),e}(),Gf=new Uint16Array(8184),Wf=0;Wf<2046;Wf++){var Zf=Wf+2,Xf=0,Kf=0,Yf=0,Jf=0,Qf=0,$f=0;for(1&Zf?Yf=Jf=Qf=32:Xf=Kf=$f=32;(Zf>>=1)>1;){var ep=Xf+Yf>>1,tp=Kf+Jf>>1;1&Zf?(Yf=Xf,Jf=Kf,Xf=Qf,Kf=$f):(Xf=Yf,Kf=Jf,Yf=Qf,Jf=$f),Qf=ep,$f=tp}var np=4*Wf;Gf[np+0]=Xf,Gf[np+1]=Kf,Gf[np+2]=Yf,Gf[np+3]=Jf}var ip=new Uint16Array(2178),rp=new Uint8Array(1089),ap=new Uint16Array(1089);function op(e){return 0===e?-.03125:32===e?.03125:0}var sp=Ia([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),lp={type:2,extent:Qo,loadGeometry:function(){return[[new y(0,0),new y(8193,0),new y(8193,8193),new y(0,8193),new y(0,0)]]}},up=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.tileID=t,this.uid=N(),this.uses=0,this.tileSize=n,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=a,this.expiredRequestCount=0,this.state="loading",r&&r.transform&&(this.projection=r.transform.projection)}return _createClass(e,[{key:"registerFadeDuration",value:function(e){var t=e+this.timeAdded;t<Ze.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}},{key:"wasRequested",value:function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}},{key:"tileTransform",get:function(){return this._tileTransform||(this._tileTransform=Qd(this.tileID.canonical,this.projection)),this._tileTransform}},{key:"loadVectorData",value:function(e,t,n){if(this.unloadVectorData(),this.state="loaded",e){for(var i in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var n={};if(!t)return n;var i,r=_createForOfIteratorHelper(e);try{var a=function(){var e=i.value,r=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==r.length){e.layers=r,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return r.filter((function(t){return t.id===e}))[0]})));var a,o=_createForOfIteratorHelper(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.id]=e}}catch(l){o.e(l)}finally{o.f()}}};for(r.s();!(i=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}return n}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var r=this.buckets[i];if(r instanceof Pf){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var o=this.buckets[a];if(o instanceof Pf&&o.hasRTLText){this.hasRTLText=!0,da.isLoading()||da.isLoaded()||"deferred"!==ca()||ha();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ro}},{key:"unloadVectorData",value:function(){if(this.hasData()){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}},{key:"getBucket",value:function(e){return this.buckets[e.id]}},{key:"upload",value:function(e){for(var t in this.buckets){var n=this.buckets[t];n.uploadPending()&&n.upload(e)}var i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ff(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ff(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ff(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}},{key:"prepare",value:function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}},{key:"queryRenderedFeatures",value:function(e,t,n,i,r,a,o,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:o,transform:a,params:r,tileTransform:this.tileTransform},e,t,n):{}}},{key:"querySourceFeatures",value:function(e,t){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var i=n.loadVTLayers(),r=t?t.sourceLayer:"",a=i._geojsonTileLayer||i[r];if(a)for(var o=Di(t&&t.filter),s=this.tileID.canonical,l=s.z,u=s.x,c=s.y,h={z:l,x:u,y:c},d=0;d<a.length;d++){var f=a.feature(d);if(o.needGeometry){var p=Gl(f,!0);if(!o.filter(new fa(this.tileID.overscaledZ),p,this.tileID.canonical))continue}else if(!o.filter(new fa(this.tileID.overscaledZ),f))continue;var m=n.getId(f,r),v=new qf(f,l,u,c,m);v.tile=h,e.push(v)}}}},{key:"hasData",value:function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}},{key:"patternsLoaded",value:function(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}},{key:"setExpiryData",value:function(e){var t=this.expirationTime;if(e.cacheControl){var n=X(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var i=Date.now(),r=!1;if(this.expirationTime>i)r=!1;else if(t)if(this.expirationTime<t)r=!0;else{var a=this.expirationTime-t;a?this.expirationTime=i+Math.max(a,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}},{key:"getExpiryTimeout",value:function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}},{key:"setFeatureState",value:function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length&&t){var n=this.latestFeatureIndex.loadVTLayers(),i=t.style.listImages();for(var r in this.buckets)if(t.style.hasLayer(r)){var a=this.buckets[r],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=n[o],l=e[o];if(s&&l&&0!==Object.keys(l).length){if(a.update(l,s,i,this.imageAtlas&&this.imageAtlas.patternPositions||{}),a instanceof oh||a instanceof uc){var u=t.style._getSourceCache(a.layers[0].source);t._terrain&&t._terrain.enabled&&u&&a.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(u.id,this.tileID)}var c=t&&t.style&&t.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(a)))}}}}},{key:"holdingForFade",value:function(){return void 0!==this.symbolFadeHoldUntil}},{key:"symbolFadeFinished",value:function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ze.now()}},{key:"clearFadeHold",value:function(){this.symbolFadeHoldUntil=void 0}},{key:"setHoldDuration",value:function(e){this.symbolFadeHoldUntil=Ze.now()+e}},{key:"setTexture",value:function(e,t){var n=t.context,i=n.gl;this.texture=this.texture||t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Ff(n,e,i.RGBA,{useMipmap:!0}),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE))}},{key:"setDependencies",value:function(e,t){var n,i={},r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){i[n.value]=!0}}catch(a){r.e(a)}finally{r.f()}this.dependencies[e]=i}},{key:"hasDependency",value:function(e,t){var n,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=this.dependencies[r];if(a){var o,s=_createForOfIteratorHelper(t);try{for(s.s();!(o=s.n()).done;){if(a[o.value])return!0}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}return!1}},{key:"clearQueryDebugViz",value:function(){}},{key:"_makeDebugTileBoundsBuffers",value:function(e,t){if(t&&"mercator"!==t.name&&!this._tileDebugBuffer){for(var n=ql(lp,this.tileID.canonical,this.tileTransform)[0],i=new Ra,r=new to,a=0;a<n.length;a++){var o=n[a],s=o.x,l=o.y;i.emplaceBack(s,l),r.emplaceBack(a)}r.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(i,qs.members),this._tileDebugSegments=Jo.simpleSegment(0,0,i.length,r.length)}}},{key:"_makeTileBoundsBuffers",value:function(e,t){if(!this._tileBoundsBuffer&&t&&"mercator"!==t.name){var n,i,r=ql(lp,this.tileID.canonical,this.tileTransform)[0];if(this.isRaster){var a=function(e,t){for(var n=Qd(e,t),i=Math.pow(2,e.z),r=0;r<33;r++)for(var a=0;a<33;a++){var o=Al((e.x+(a+op(a))/32)/i),s=Rl((e.y+(r+op(r))/32)/i),l=t.project(o,s),u=33*r+a;ip[2*u+0]=Math.round((l.x*n.scale-n.x)*Qo),ip[2*u+1]=Math.round((l.y*n.scale-n.y)*Qo)}rp.fill(0),ap.fill(0);for(var c=2045;c>=0;c--){var h=4*c,d=Gf[h+0],f=Gf[h+1],p=Gf[h+2],m=Gf[h+3],v=d+p>>1,g=f+m>>1,y=v+g-f,_=g+d-v,x=33*f+d,b=33*m+p,w=33*g+v,k=Math.hypot((ip[2*x+0]+ip[2*b+0])/2-ip[2*w+0],(ip[2*x+1]+ip[2*b+1])/2-ip[2*w+1])>=16;rp[w]=rp[w]||(k?1:0),c<1022&&(rp[w]=rp[w]||rp[33*(f+_>>1)+(d+y>>1)]||rp[33*(m+_>>1)+(p+y>>1)])}var C=new Na,S=new Xa,T=0;function E(e,t){var n=33*t+e;return 0===ap[n]&&(C.emplaceBack(ip[2*n+0],ip[2*n+1],e*Qo/32,t*Qo/32),ap[n]=++T),ap[n]-1}function P(e,t,n,i,r,a){var o=e+n>>1,s=t+i>>1;if(Math.abs(e-r)+Math.abs(t-a)>1&&rp[33*s+o])P(r,a,e,t,o,s),P(n,i,r,a,o,s);else{var l=E(e,t),u=E(n,i),c=E(r,a);S.emplaceBack(l,u,c)}}return P(0,0,32,32,32,0),P(32,32,0,0,0,32),{vertices:C,indices:S}}(this.tileID.canonical,t);n=a.vertices,i=a.indices}else{n=new Na,i=new Xa;var o,s=_createForOfIteratorHelper(r);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=l.x,c=l.y;n.emplaceBack(u,c,0,0)}}catch(f){s.e(f)}finally{s.f()}for(var h=tc(n.int16,void 0,4),d=0;d<h.length;d+=3)i.emplaceBack(h[d],h[d+1],h[d+2])}this._tileBoundsBuffer=e.createVertexBuffer(n,sp.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(i),this._tileBoundsSegments=Jo.simpleSegment(0,0,n.length,i.length)}}},{key:"_makeGlobeTileDebugBuffers",value:function(e,t){var n=t.projection;if(n&&"globe"===n.name&&!t.freezeTileCoverage){var i,r=this.tileID.canonical,a=ml(ol(r,t)),o=yl(t.zoom);o>0&&(i=as(new Float64Array(16),t.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,r,t,a,i,o),this._makeGlobeTileDebugTextBuffer(e,r,t,a,i,o)}}},{key:"_globePoint",value:function(e,t,n,i,r,a,o){var s=dl(e,t,n);if(a){var l=1<<n.z,u=Pl(i.center.lng),c=Ml(i.center.lat),h=(n.x+.5)/l-u,d=0;h>.5?d=-1:h<-.5&&(d=1);var f=(e/Qo+n.x)/l+d,p=(t/Qo+n.y)/l;f=(f-u)*i._pixelsPerMercatorPixel+u,p=(p-c)*i._pixelsPerMercatorPixel+c;var m=[f*i.worldSize,p*i.worldSize,0];Ps(m,m,a),s=al(s,m,o)}return Ps(s,s,r)}},{key:"_makeGlobeTileDebugBorderBuffer",value:function(e,t,n,i,r,a){var o=this,s=new Ra,l=new to,u=new Oa,c=function(e,c,h,d,f){for(var p=(h-e)/(f-1),m=(d-c)/(f-1),v=s.length,g=0;g<f;g++){var y=e+g*p,_=c+g*m;s.emplaceBack(y,_);var x=o._globePoint(y,_,t,n,i,r,a);u.emplaceBack(x[0],x[1],x[2]),l.emplaceBack(v+g)}},h=Qo;c(0,0,h,0,16),c(h,0,h,h,16),c(h,h,0,h,16),c(0,h,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(l),this._tileDebugBuffer=e.createVertexBuffer(s,qs.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(u,Us.members),this._tileDebugSegments=Jo.simpleSegment(0,0,s.length,l.length)}},{key:"_makeGlobeTileDebugTextBuffer",value:function(e,t,n,i,r,a){var o=new Ra,s=new Xa,l=new Oa,u=25;s.reserve(32),o.reserve(u),l.reserve(u);for(var c=function(e,t){return u*e+t},h=0;h<u;h++)for(var d=2048*h,f=0;f<u;f++){var p=2048*f;o.emplaceBack(p,d);var m=this._globePoint(p,d,t,n,i,r,a);l.emplaceBack(m[0],m[1],m[2])}for(var v=0;v<4;v++)for(var g=0;g<4;g++){var y=c(v,g),_=c(v,g+1),x=c(v+1,g),b=c(v+1,g+1);s.emplaceBack(y,_,x),s.emplaceBack(x,_,b)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(s),this._tileDebugTextBuffer=e.createVertexBuffer(o,qs.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(l,Us.members),this._tileDebugTextSegments=Jo.simpleSegment(0,0,u,32)}}]),e}(),cp=function(){function e(){_classCallCheck(this,e),this.state={},this.stateChanges={},this.deletedStates={}}return _createClass(e,[{key:"updateState",value:function(e,t,n){var i=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},R(this.stateChanges[e][i],n),null===this.deletedStates[e])for(var r in this.deletedStates[e]={},this.state[e])r!==i&&(this.deletedStates[e][r]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][i])for(var a in this.deletedStates[e][i]={},this.state[e][i])n[a]||(this.deletedStates[e][i][a]=null);else for(var o in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][o]&&delete this.deletedStates[e][i][o]}},{key:"removeFeatureState",value:function(e,t,n){if(null!==this.deletedStates[e]){var i=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][i]&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][i])for(n in this.deletedStates[e][i]={},this.stateChanges[e][i])this.deletedStates[e][i][n]=null;else this.deletedStates[e][i]=null;else this.deletedStates[e]=null}}},{key:"getState",value:function(e,t){var n=String(t),i=R({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var r=this.deletedStates[e][t];if(null===r)return{};for(var a in r)delete i[a]}return i}},{key:"initializeTileState",value:function(e,t){e.setFeatureState(this.state,t)}},{key:"coalesceChanges",value:function(e,t){var n={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var r={};for(var a in this.stateChanges[i])this.state[i][a]||(this.state[i][a]={}),R(this.state[i][a],this.stateChanges[i][a]),r[a]=this.state[i][a];n[i]=r}for(var o in this.deletedStates){this.state[o]=this.state[o]||{};var s={};if(null===this.deletedStates[o])for(var l in this.state[o])s[l]={},this.state[o][l]={};else for(var u in this.deletedStates[o]){if(null===this.deletedStates[o][u])this.state[o][u]={};else if(this.state[o][u])for(var c=0,h=Object.keys(this.deletedStates[o][u]);c<h.length;c++){var d=h[c];delete this.state[o][u][d]}s[u]=this.state[o][u]}n[o]=n[o]||{},R(n[o],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var f in e)e[f].setFeatureState(n,t)}}]),e}(),hp=function(){function e(t){_classCallCheck(this,e),this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}return _createClass(e,[{key:"getElevation",value:function(e,t){var n=this.toIdx(e,t);return{min:this.minimums[n],max:this.maximums[n]}}},{key:"isLeaf",value:function(e,t){return this.leaves[this.toIdx(e,t)]}},{key:"toIdx",value:function(e,t){return t*this.size+e}}]),e}();function dp(e,t,n,i){for(var r=0,a=Number.MAX_VALUE,o=0;o<3;o++)if(Math.abs(i[o])<1e-15){if(n[o]<e[o]||n[o]>t[o])return null}else{var s=1/i[o],l=(e[o]-n[o])*s,u=(t[o]-n[o])*s;if(l>u){var c=l;l=u,u=c}if(l>r&&(r=l),u<a&&(a=u),r>a)return null}return r}function fp(e,t,n,i,r,a,o,s,l,u,c){var h=i-e,d=r-t,f=a-n,p=o-e,m=s-t,v=l-n,g=c[1]*v-c[2]*m,y=c[2]*p-c[0]*v,_=c[0]*m-c[1]*p,x=h*g+d*y+f*_;if(Math.abs(x)<1e-15)return null;var b=1/x,w=u[0]-e,k=u[1]-t,C=u[2]-n,S=(w*g+k*y+C*_)*b;if(S<0||S>1)return null;var T=k*f-C*d,E=C*h-w*f,P=w*d-k*h,M=(c[0]*T+c[1]*E+c[2]*P)*b;return M<0||S+M>1?null:(p*T+m*E+v*P)*b}function pp(e,t,n){return(e-t)/(n-t)}function mp(e,t,n,i,r,a,o,s,l){var u=1<<n,c=a-i,h=o-r,d=(e+1)/u*c+i,f=(t+0)/u*h+r,p=(t+1)/u*h+r;s[0]=(e+0)/u*c+i,s[1]=f,l[0]=d,l[1]=p}var vp=function(){function e(t){if(_classCallCheck(this,e),this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],this.dem){var n=function(e){for(var t=Math.ceil(Math.log2(e.dim/8)),n=[],i=Math.ceil(Math.pow(2,t)),r=1/i,a=function(e,t,n,i,r){var a=i?1:0,o=(e+1)*n-a,s=t*n,l=(t+1)*n-a;r[0]=e*n,r[1]=s,r[2]=o,r[3]=l},o=new hp(i),s=[],l=0;l<i*i;l++){a(l%i,Math.floor(l/i),r,!1,s);var u=yp(s[0],s[1],e),c=yp(s[2],s[1],e),h=yp(s[2],s[3],e),d=yp(s[0],s[3],e);o.minimums.push(Math.min(u,c,h,d)),o.maximums.push(Math.max(u,c,h,d)),o.leaves.push(1)}for(n.push(o),i/=2;i>=1;i/=2){var f=n[n.length-1];o=new hp(i);for(var p=0;p<i*i;p++){a(p%i,Math.floor(p/i),2,!0,s);var m=f.getElevation(s[0],s[1]),v=f.getElevation(s[2],s[1]),g=f.getElevation(s[2],s[3]),y=f.getElevation(s[0],s[3]),_=f.isLeaf(s[0],s[1]),x=f.isLeaf(s[2],s[1]),b=f.isLeaf(s[2],s[3]),w=f.isLeaf(s[0],s[3]),k=Math.min(m.min,v.min,g.min,y.min),C=Math.max(m.max,v.max,g.max,y.max),S=_&&x&&b&&w;o.maximums.push(C),o.minimums.push(k),o.leaves.push(C-k<=5&&S?1:0)}n.push(o)}return n}(this.dem),i=n.length-1,r=n[i];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(n,0,0,i,0)}}return _createClass(e,[{key:"raycastRoot",value:function(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return dp([e,t,-100],[n,i,this.maximums[0]*o],r,a)}},{key:"raycast",value:function(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;var s=this.raycastRoot(e,t,n,i,r,a,o);if(null==s)return null;for(var l=[],u=[],c=[],h=[],d=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];d.length>0;){var f=d.pop(),p=f.idx,m=f.t,v=f.nodex,g=f.nodey,y=f.depth;if(this.leaves[p]){mp(v,g,y,e,t,n,i,c,h);var _=1<<y,x=(v+0)/_,b=(v+1)/_,w=(g+0)/_,k=(g+1)/_,C=yp(x,w,this.dem)*o,S=yp(b,w,this.dem)*o,T=yp(b,k,this.dem)*o,E=yp(x,k,this.dem)*o,P=fp(c[0],c[1],C,h[0],c[1],S,h[0],h[1],T,r,a),M=fp(h[0],h[1],T,c[0],h[1],E,c[0],c[1],C,r,a),I=Math.min(null!==P?P:Number.MAX_VALUE,null!==M?M:Number.MAX_VALUE);if(I!==Number.MAX_VALUE)return I;var A=Cs([],r,a,m);if(gp(C,S,E,T,pp(A[0],c[0],h[0]),pp(A[1],c[1],h[1]))>=A[2])return m}else{for(var R=0,O=0;O<this._siblingOffset.length;O++){mp((v<<1)+this._siblingOffset[O][0],(g<<1)+this._siblingOffset[O][1],y+1,e,t,n,i,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[p]+O]*o;var N=dp(c,h,r,a);if(null!=N){var D=N;l[O]=D;for(var z=!1,L=0;L<R&&!z;L++)D>=l[u[L]]&&(u.splice(L,0,O),z=!0);z||(u[R]=O),R++}}for(var B=0;B<R;B++){var F=u[B];d.push({idx:this.childOffsets[p]+F,t:l[F],nodex:(v<<1)+this._siblingOffset[F][0],nodey:(g<<1)+this._siblingOffset[F][1],depth:y+1})}}}return null}},{key:"_addNode",value:function(e,t,n){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}},{key:"_construct",value:function(e,t,n,i,r){if(1!==e[i].isLeaf(t,n)){this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);for(var a=i-1,o=e[a],s=0,l=0,u=0;u<this._siblingOffset.length;u++){var c=2*t+this._siblingOffset[u][0],h=2*n+this._siblingOffset[u][1],d=o.getElevation(c,h),f=o.isLeaf(c,h),p=this._addNode(d.min,d.max,f);f&&(s|=1<<u),l||(l=p)}for(var m=0;m<this._siblingOffset.length;m++)s&1<<m||this._construct(e,2*t+this._siblingOffset[m][0],2*n+this._siblingOffset[m][1],a,l+m)}}}]),e}();function gp(e,t,n,i,r,a){return xn(xn(e,n,a),xn(t,i,a),r)}function yp(e,t,n){var i=n.dim,r=E(e*i-.5,0,i-1),a=E(t*i-.5,0,i-1),o=Math.floor(r),s=Math.floor(a),l=Math.min(o+1,i-1),u=Math.min(s+1,i-1);return gp(n.get(o,s),n.get(l,s),n.get(o,u),n.get(l,u),r-o,a-s)}var _p={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function xp(e,t,n){return(256*e*256+256*t+n)/10-1e4}function bp(e,t,n){return 256*e+t+n/256-32768}var wp=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,e),this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return q('"'.concat(i,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=n.height;var o=this.dim=n.height-2,s=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=i||"mapbox",this.borderReady=r,!r){for(var l=0;l<o;l++)s[this._idx(-1,l)]=s[this._idx(0,l)],s[this._idx(o,l)]=s[this._idx(o-1,l)],s[this._idx(l,-1)]=s[this._idx(l,0)],s[this._idx(l,o)]=s[this._idx(l,o-1)];s[this._idx(-1,-1)]=s[this._idx(0,0)],s[this._idx(o,-1)]=s[this._idx(o-1,0)],s[this._idx(-1,o)]=s[this._idx(0,o-1)],s[this._idx(o,o)]=s[this._idx(o-1,o-1)],a&&this._buildQuadTree()}}return _createClass(e,[{key:"tree",get:function(){return this._tree||this._buildQuadTree(),this._tree}},{key:"_buildQuadTree",value:function(){this._tree=new vp(this)}},{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&(e=E(e,-1,this.dim),t=E(t,-1,this.dim));var i=4*this._idx(e,t);return("terrarium"===this.encoding?bp:xp)(this.pixels[i],this.pixels[i+1],this.pixels[i+2])}},{key:"unpackVector",get:function(){return _p[this.encoding]}},{key:"_idx",value:function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}},{key:"getPixels",value:function(){return new ku({width:this.stride,height:this.stride},this.pixels)}},{key:"backfillBorder",value:function(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var i=t*this.dim,r=t*this.dim+this.dim,a=n*this.dim,o=n*this.dim+this.dim;switch(t){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:a=o-1;break;case 1:o=a+1}for(var s=-t*this.dim,l=-n*this.dim,u=a;u<o;u++)for(var c=i;c<r;c++){var h=4*this._idx(c,u),d=4*this._idx(c+s,u+l);this.pixels[h+0]=e.pixels[d+0],this.pixels[h+1]=e.pixels[d+1],this.pixels[h+2]=e.pixels[d+2],this.pixels[h+3]=e.pixels[d+3]}}},{key:"onDeserialize",value:function(){this._tree&&(this._tree.dem=this)}}],[{key:"getUnpackVector",value:function(e){return _p[e]}},{key:"pack",value:function(t,n){var i=[0,0,0,0],r=e.getUnpackVector(n),a=Math.floor((t+r[3])/r[2]);return i[2]=a%256,a=Math.floor(a/256),i[1]=a%256,a=Math.floor(a/256),i[0]=a,i}}]),e}();mr(wp,"DEMData"),mr(vp,"DemMinMaxQuadTree",{omit:["dem"]});var kp=function(){function e(t,n){_classCallCheck(this,e),this.max=t,this.onRemove=n,this.reset()}return _createClass(e,[{key:"reset",value:function(){for(var e in this.data){var t,n=_createForOfIteratorHelper(this.data[e]);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}}catch(r){n.e(r)}finally{n.f()}}return this.data={},this.order=[],this}},{key:"add",value:function(e,t,n){var i=this,r=e.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var a={value:t,timeout:void 0};if(void 0!==n&&(a.timeout=setTimeout((function(){i.remove(e,a)}),n)),this.data[r].push(a),this.order.push(r),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}},{key:"has",value:function(e){return e.wrapped().key in this.data}},{key:"getAndRemove",value:function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}},{key:"_getAndRemoveByKey",value:function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}},{key:"getByKey",value:function(e){var t=this.data[e];return t?t[0].value:null}},{key:"get",value:function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}},{key:"remove",value:function(e,t){if(!this.has(e))return this;var n=e.wrapped().key,i=void 0===t?0:this.data[n].indexOf(t),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}},{key:"setMaxSize",value:function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}},{key:"filter",value:function(e){var t=[];for(var n in this.data){var i,r=_createForOfIteratorHelper(this.data[n]);try{for(r.s();!(i=r.n()).done;){var a=i.value;e(a.value)||t.push(a)}}catch(u){r.e(u)}finally{r.f()}}for(var o=0,s=t;o<s.length;o++){var l=s[o];this.remove(l.value.tileID,l)}}}]),e}(),Cp=_createClass((function e(t,n,i){_classCallCheck(this,e),this.func=t,this.mask=n,this.range=i}));Cp.ReadOnly=!1,Cp.ReadWrite=!0,Cp.disabled=new Cp(519,Cp.ReadOnly,[0,1]);var Sp=_createClass((function e(t,n,i,r,a,o){_classCallCheck(this,e),this.test=t,this.ref=n,this.mask=i,this.fail=r,this.depthFail=a,this.pass=o}));Sp.disabled=new Sp({func:519,mask:0},0,0,7680,7680,7680);var Tp=_createClass((function e(t,n,i){_classCallCheck(this,e),this.blendFunction=t,this.blendColor=n,this.mask=i}));Tp.Replace=[1,0],Tp.disabled=new Tp(Tp.Replace,Pt.transparent,[!1,!1,!1,!1]),Tp.unblended=new Tp(Tp.Replace,Pt.transparent,[!0,!0,!0,!0]),Tp.alphaBlended=new Tp([1,771],Pt.transparent,[!0,!0,!0,!0]);var Ep=_createClass((function e(t,n,i){_classCallCheck(this,e),this.enable=t,this.mode=n,this.frontFace=i}));Ep.disabled=new Ep(!1,1029,2305),Ep.backCCW=new Ep(!0,1029,2305),Ep.backCW=new Ep(!0,1029,2304),Ep.frontCW=new Ep(!0,1028,2304),Ep.frontCCW=new Ep(!0,1028,2305);var Pp=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).id=e,r._onlySymbols=i,n.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(r._sourceLoaded=!0),r._sourceLoaded&&!r._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(r.reload(),r.transform&&r.update(r.transform))})),n.on("error",(function(){r._sourceErrored=!0})),r._source=n,r._tiles={},r._cache=new kp(0,r._unloadTile.bind(_assertThisInitialized2(r))),r._timers={},r._cacheTimers={},r._minTileCacheSize=n.minTileCacheSize,r._maxTileCacheSize=n.maxTileCacheSize,r._loadedParentTiles={},r._coveredTiles={},r._state=new cp,r._isRaster="raster"===r._source.type||"raster-dem"===r._source.type||"custom"===r._source.type&&"raster"===r._source._dataType,r}return _inherits(t,e),_createClass(t,[{key:"onAdd",value:function(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}},{key:"loaded",value:function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}},{key:"getSource",value:function(){return this._source}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}}},{key:"_loadTile",value:function(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}},{key:"_unloadTile",value:function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))}},{key:"_abortTile",value:function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))}},{key:"serialize",value:function(){return this._source.serialize()}},{key:"prepare",value:function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}}},{key:"getIds",value:function(){return A(this._tiles).map((function(e){return e.tileID})).sort(Mp).map((function(e){return e.key}))}},{key:"getRenderableIds",value:function(e){var t=this,n=[];for(var i in this._tiles)this._isIdRenderable(+i,e)&&n.push(this._tiles[i]);return e?n.sort((function(e,n){var i=e.tileID,r=n.tileID,a=new y(i.canonical.x,i.canonical.y)._rotate(t.transform.angle),o=new y(r.canonical.x,r.canonical.y)._rotate(t.transform.angle);return i.overscaledZ-r.overscaledZ||o.y-a.y||o.x-a.x})).map((function(e){return e.tileID.key})):n.map((function(e){return e.tileID})).sort(Mp).map((function(e){return e.key}))}},{key:"hasRenderableParent",value:function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}},{key:"_isIdRenderable",value:function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}},{key:"reload",value:function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}},{key:"_reloadTile",value:function(e,t){var n=this._tiles[e];n&&("loading"!==n.state&&(n.state=t),this._loadTile(n,this._tileLoaded.bind(this,n,e,t)))}},{key:"_tileLoaded",value:function(e,t,n,i){if(i)if(e.state="errored",404!==i.status)this._source.fire(new Je(i,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){var r=this.map.painter.terrain;this.update(this.transform,r.getScaledDemTileSize(),!0),r.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ze.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ye("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}},{key:"_backfillDEM",value:function(e){for(var t=this.getRenderableIds(),n=0;n<t.length;n++){var i=t[n];if(e.neighboringTiles&&e.neighboringTiles[i]){var r=this.getTileByID(i);a(e,r),a(r,e)}}function a(e,t){if(e.dem&&!e.dem.borderReady){e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;var n=t.tileID.canonical.x-e.tileID.canonical.x,i=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,i),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}}},{key:"getTile",value:function(e){return this.getTileByID(e.key)}},{key:"getTileByID",value:function(e){return this._tiles[e]}},{key:"_retainLoadedChildren",value:function(e,t,n,i){for(var r in this._tiles){var a=this._tiles[r];if(!(i[r]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>n)){for(var o=a.tileID;a&&a.tileID.overscaledZ>t+1;){var s=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[s.key])&&a.hasData()&&(o=s)}for(var l=o;l.overscaledZ>t;)if(e[(l=l.scaledTo(l.overscaledZ-1)).key]){i[o.key]=o;break}}}}},{key:"findLoadedParent",value:function(e,t){if(e.key in this._loadedParentTiles){var n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(var i=e.overscaledZ-1;i>=t;i--){var r=e.scaledTo(i),a=this._getLoadedTile(r);if(a)return a}}},{key:"_getLoadedTile",value:function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}},{key:"updateCacheSize",value:function(e,t){t=t||this._source.tileSize;var n=Math.ceil(e.width/t)+1,i=Math.ceil(e.height/t)+1,r=Math.floor(n*i*5),a="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,a):a;this._cache.setMaxSize(o)}},{key:"handleWrapJump",value:function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var n={};for(var i in this._tiles){var r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),n[r.tileID.key]=r}for(var a in this._tiles=n,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var o in this._tiles)this._setTileReloadTimer(+o,this._tiles[o])}}},{key:"update",value:function(e,n,i){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused&&!this.transform.freezeTileCoverage&&(!this.usedForTerrain||i)){var a;this.updateCacheSize(e,n),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new Yc(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(a=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter((function(e){return r._source.hasTile(e)})))):a=[];var o=this._updateRetainedTiles(a);if(Ip(this._source.type)&&0!==a.length){for(var s={},l={},u=0,c=Object.keys(o);u<c.length;u++){var h=c[u],d=o[h],f=this._tiles[h];if(f&&!(f.fadeEndTime&&f.fadeEndTime<=Ze.now())){var p=this.findLoadedParent(d,Math.max(d.overscaledZ-t.maxOverzooming,this._source.minzoom));p&&(this._addTile(p.tileID),s[p.tileID.key]=p.tileID),l[h]=d}}var m=a[a.length-1].overscaledZ;for(var v in this._tiles){var g=this._tiles[v];if(!o[v]&&g.hasData())for(var y=g.tileID;y.overscaledZ>m;){y=y.scaledTo(y.overscaledZ-1);var _=this._tiles[y.key];if(_&&_.hasData()&&l[y.key]){o[v]=g.tileID;break}}}for(var x in s)o[x]||(this._coveredTiles[x]=!0,o[x]=s[x])}for(var b in o)this._tiles[b].clearFadeHold();var w,k=_createForOfIteratorHelper(function(e,t){var n=[];for(var i in e)i in t||n.push(i);return n}(this._tiles,o));try{for(k.s();!(w=k.n()).done;){var C=w.value,S=this._tiles[C];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+C)}}catch(T){k.e(T)}finally{k.f()}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}}},{key:"releaseSymbolFadeTiles",value:function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}},{key:"_updateRetainedTiles",value:function(e){var n={};if(0===e.length)return n;var i,r={},a=e.reduce((function(e,t){return Math.min(e,t.overscaledZ)}),1/0),o=e[0].overscaledZ,s=Math.max(o-t.maxOverzooming,this._source.minzoom),l=Math.max(o+t.maxUnderzooming,this._source.minzoom),u={},c=_createForOfIteratorHelper(e);try{for(c.s();!(i=c.n()).done;){var h=i.value,d=this._addTile(h);n[h.key]=h,d.hasData()||a<this._source.maxzoom&&(u[h.key]=h)}}catch(k){c.e(k)}finally{c.f()}this._retainLoadedChildren(u,a,l,n);var f,p=_createForOfIteratorHelper(e);try{for(p.s();!(f=p.n()).done;){var m=f.value,v=this._tiles[m.key];if(!v.hasData()){if(m.canonical.z>=this._source.maxzoom){var g=m.children(this._source.maxzoom)[0],y=this.getTile(g);if(y&&y.hasData()){n[g.key]=g;continue}}else{var _=m.children(this._source.maxzoom);if(n[_[0].key]&&n[_[1].key]&&n[_[2].key]&&n[_[3].key])continue}for(var x=v.wasRequested(),b=m.overscaledZ-1;b>=s;--b){var w=m.scaledTo(b);if(r[w.key])break;if(r[w.key]=!0,!(v=this.getTile(w))&&x&&(v=this._addTile(w)),v&&(n[w.key]=w,x=v.wasRequested(),v.hasData()))break}}}}catch(k){p.e(k)}finally{p.f()}return n}},{key:"_updateLoadedParentTileCache",value:function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],n=void 0,i=this._tiles[e].tileID;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}t.push(i.key);var r=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(r))break;i=r}for(var a=0,o=t;a<o.length;a++){var s=o[a];this._loadedParentTiles[s]=n}}}},{key:"_addTile",value:function(e){var t=this._tiles[e.key];if(t)return t;(t=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));var n=Boolean(t);if(!n){var i=this.map?this.map.painter:null;t=new up(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,i,this._isRaster),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,n||this._source.fire(new Ye("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}},{key:"_setTileReloadTimer",value:function(e,t){var n=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout((function(){n._reloadTile(e,"expired"),delete n._timers[e]}),i))}},{key:"_removeTile",value:function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}},{key:"clearTiles",value:function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}},{key:"tilesIn",value:function(e,t,n){var i=[],r=this.transform;if(!r)return i;var a="globe"===r.projection.name,o=Pl(r.center.lng);for(var s in this._tiles){var l=this._tiles[s];if(n&&l.clearQueryDebugViz(),!l.holdingForFade()){var u=void 0;if(a){var c=l.tileID.canonical;if(0===c.z){var h=[Math.abs(E.apply(void 0,[o].concat(_toConsumableArray(Ap(c,-1))))-o),Math.abs(E.apply(void 0,[o].concat(_toConsumableArray(Ap(c,1))))-o)];u=[0,2*h.indexOf(Math.min.apply(Math,h))-1]}else{var d=[Math.abs(E.apply(void 0,[o].concat(_toConsumableArray(Ap(c,-1))))-o),Math.abs(E.apply(void 0,[o].concat(_toConsumableArray(Ap(c,0))))-o),Math.abs(E.apply(void 0,[o].concat(_toConsumableArray(Ap(c,1))))-o)];u=[d.indexOf(Math.min.apply(Math,d))-1]}}else u=[0];var f,p=_createForOfIteratorHelper(u);try{for(p.s();!(f=p.n()).done;){var m=f.value,v=e.containsTile(l,r,t,m);v&&i.push(v)}}catch(g){p.e(g)}finally{p.f()}}}return i}},{key:"getVisibleCoordinates",value:function(e){var t,n=this,i=this.getRenderableIds(e).map((function(e){return n._tiles[e].tileID})),r=_createForOfIteratorHelper(i);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped())}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"hasTransition",value:function(){if(this._source.hasTransition())return!0;if(Ip(this._source.type))for(var e in this._tiles){var t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=Ze.now())return!0}return!1}},{key:"setFeatureState",value:function(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)}},{key:"removeFeatureState",value:function(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)}},{key:"getFeatureState",value:function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}},{key:"setDependencies",value:function(e,t,n){var i=this._tiles[e];i&&i.setDependencies(t,n)}},{key:"reloadTilesForDependencies",value:function(e,t){for(var n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(+n,"reloading");this._cache.filter((function(n){return!n.hasDependency(e,t)}))}},{key:"_preloadTiles",value:function(e,t){var n=this;if(this._sourceLoaded){var i,r=new Map,a=Array.isArray(e)?e:[e],o=this.map.painter.terrain,s=this.usedForTerrain&&o?o.getScaledDemTileSize():this._source.tileSize,l=_createForOfIteratorHelper(a);try{for(l.s();!(i=l.n()).done;){var u,c=i.value,h=_createForOfIteratorHelper(c.coveringTiles({tileSize:s,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}));try{for(h.s();!(u=h.n()).done;){var d=u.value;r.set(d.key,d)}}catch(f){h.e(f)}finally{h.f()}this.usedForTerrain&&c.updateElevation(!1)}}catch(f){l.e(f)}finally{l.f()}I(Array.from(r.values()),(function(e,t){var i=new up(e,n._source.tileSize*e.overscaleFactor(),n.transform.tileZoom,n.map.painter,n._isRaster);n._loadTile(i,(function(e){"raster-dem"===n._source.type&&i.dem&&n._backfillDEM(i),t(e,i)}))}),t)}else{this._source.on("data",(function i(){n._sourceLoaded&&(n._source.off("data",i),n._preloadTiles(e,t))}))}}}]),t}(Qe);function Mp(e,t){var n=Math.abs(2*e.wrap)-+(e.wrap<0),i=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||i-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Ip(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function Ap(e,t){var n=1<<e.z;return[e.x/n+t,(e.x+1)/n+t]}Pp.maxOverzooming=10,Pp.maxUnderzooming=3;var Rp=function(){function e(t,n,i){_classCallCheck(this,e),this._demTile=t,this._dem=this._demTile.dem,this._scale=n,this._offset=i}return _createClass(e,[{key:"tileCoordToPixel",value:function(e,t){var n=t*this._scale+this._offset[1],i=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(n);return new y(i,r)}},{key:"getElevationAt",value:function(e,t,n,i){var r=e*this._scale+this._offset[0],a=t*this._scale+this._offset[1],o=Math.floor(r),s=Math.floor(a),l=this._dem;return i=!!i,n?xn(xn(l.get(o,s,i),l.get(o,s+1,i),a-s),xn(l.get(o+1,s,i),l.get(o+1,s+1,i),a-s),r-o):l.get(o,s,i)}},{key:"getElevationAtPixel",value:function(e,t,n){return this._dem.get(e,t,!!n)}},{key:"getMeterToDEM",value:function(e){return(1<<this._demTile.tileID.canonical.z)*Il(1,e)*this._dem.stride}}],[{key:"create",value:function(t,n,i){var r=i||t.findDEMTileFor(n);if(r&&r.dem){var a=r.dem,o=r.tileID,s=1<<n.canonical.z-o.canonical.z;return new e(r,r.tileSize/Qo/s,[(n.canonical.x/s-o.canonical.x)*a.dim,(n.canonical.y/s-o.canonical.y)*a.dim])}}}]),e}(),Op=function(){function e(t,n){_classCallCheck(this,e),this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new fr(Qo,16,0),this.featureIndexArray=new fo,this.promoteId=n}return _createClass(e,[{key:"insert",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r,a);for(var s=this.grid,l=0;l<t.length;l++){for(var u=t[l],c=[1/0,1/0,-1/0,-1/0],h=0;h<u.length;h++){var d=u[h];c[0]=Math.min(c[0],d.x),c[1]=Math.min(c[1],d.y),c[2]=Math.max(c[2],d.x),c[3]=Math.max(c[3],d.y)}c[0]<Qo&&c[1]<Qo&&c[2]>=0&&c[3]>=0&&s.insert(o,c[0],c[1],c[2],c[3])}}},{key:"loadVTLayers",value:function(){if(!this.vtLayers)for(var e in this.vtLayers=new Pc(new Xh(this.rawTileData)).layers,this.sourceLayerCoder=new Vf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={},this.vtLayers)this.vtFeatures[e]=[];return this.vtLayers}},{key:"query",value:function(e,t,n,i){var r=this;this.loadVTLayers();var a=e.params||{},o=Di(a.filter),s=e.tileResult,l=e.transform,u=s.bufferedTilespaceBounds,c=this.grid.query(u.min.x,u.min.y,u.max.x,u.max.y,(function(e,t,n,i){return au(s.bufferedTilespaceGeometry,e,t,n,i)}));c.sort(Dp);var h=null;l.elevation&&c.length>0&&(h=Rp.create(l.elevation,this.tileID));for(var d,f={},p=function(){var l=c[m];if(l===d)return 1;d=l;var u=r.featureIndexArray.get(l),p=null;r.loadMatchingFeature(f,u,o,a.layers,a.availableImages,t,n,i,(function(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return p||(p=ql(t,r.tileID.canonical,e.tileTransform)),n.queryIntersectsFeature(s,t,i,p,r.z,e.transform,e.pixelPosMatrix,h,a)}))},m=0;m<c.length;m++)p();return f}},{key:"loadMatchingFeature",value:function(e,t,n,i,r,a,o,s,l){var u=t.featureIndex,c=t.bucketIndex,h=t.sourceLayerIndex,d=t.layoutVertexArrayOffset,f=this.bucketLayerIDs[c];if(!i||function(e,t){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(i,f)){var p=this.sourceLayerCoder.decode(h),m=this.vtLayers[p].feature(u);if(n.needGeometry){var v=Gl(m,!0);if(!n.filter(new fa(this.tileID.overscaledZ),v,this.tileID.canonical))return}else if(!n.filter(new fa(this.tileID.overscaledZ),m))return;for(var g=this.getId(m,p),y=0;y<f.length;y++){var _=f[y];if(!(i&&i.indexOf(_)<0)){var x=a[_];if(x){var b={};void 0!==g&&s&&(b=s.getState(x.sourceLayer||"_geojsonTileLayer",g));var w=R({},o[_]);w.paint=Np(w.paint,x.paint,m,b,r),w.layout=Np(w.layout,x.layout,m,b,r);var k=!l||l(m,x,b,d);if(k){var C=new qf(m,this.z,this.x,this.y,g);C.layer=w;var S=e[_];void 0===S&&(S=e[_]=[]),S.push({featureIndex:u,feature:C,intersectionZ:k})}}}}}}},{key:"lookupSymbolFeatures",value:function(e,t,n,i,r,a,o,s){var l={};this.loadVTLayers();var u,c=Di(r),h=_createForOfIteratorHelper(e);try{for(h.s();!(u=h.n()).done;){var d=u.value;this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:i,featureIndex:d,layoutVertexArrayOffset:0},c,a,o,s,t)}}catch(f){h.e(f)}finally{h.f()}return l}},{key:"loadFeature",value:function(e){var t=e.featureIndex,n=e.sourceLayerIndex;this.loadVTLayers();var i=this.sourceLayerCoder.decode(n),r=this.vtFeatures[i];if(r[t])return r[t];var a=this.vtLayers[i].feature(t);return r[t]=a,a}},{key:"hasLayer",value:function(e){var t,n=_createForOfIteratorHelper(this.bucketLayerIDs);try{for(n.s();!(t=n.n()).done;){var i,r=_createForOfIteratorHelper(t.value);try{for(r.s();!(i=r.n()).done;){if(e===i.value)return!0}}catch(a){r.e(a)}finally{r.f()}}}catch(a){n.e(a)}finally{n.f()}return!1}},{key:"getId",value:function(e,t){var n=e.id;if(this.promoteId){var i="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=i&&(n=e.properties[i]),"boolean"==typeof n&&(n=Number(n))}return n}}]),e}();function Np(e,t,n,i,r){return j(e,(function(e,a){var o=t instanceof ba?t.get(a):null;return o&&o.evaluate?o.evaluate(n,i,r):o}))}function Dp(e,t){return t-e}mr(Op,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var zp=function(){function e(t,n){_classCallCheck(this,e),this.width=t,this.height=n,this.nextRow=0,this.image=new wu({width:t,height:n}),this.positions={},this.uploaded=!1}return _createClass(e,[{key:"getDash",value:function(e,t){var n=this.getKey(e,t);return this.positions[n]}},{key:"trim",value:function(){var e=this.width,t=this.height=z(this.nextRow);this.image.resize({width:e,height:t})}},{key:"getKey",value:function(e,t){return e.join(",")+t}},{key:"getDashRanges",value:function(e,t,n){var i=[],r=e.length%2==1?-e[e.length-1]*n:0,a=e[0]*n,o=!0;i.push({left:r,right:a,isDash:o,zeroLength:0===e[0]});for(var s=e[0],l=1;l<e.length;l++){o=!o;var u=e[l];r=s*n,a=(s+=u)*n,i.push({left:r,right:a,isDash:o,zeroLength:0===u})}return i}},{key:"addRoundDash",value:function(e,t,n){for(var i=t/2,r=-n;r<=n;r++)for(var a=this.width*(this.nextRow+n+r),o=0,s=e[o],l=0;l<this.width;l++){l/s.right>1&&(s=e[++o]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),h=Math.min(u,c),d=void 0,f=r/n*(i+1);if(s.isDash){var p=i-Math.abs(f);d=Math.sqrt(h*h+p*p)}else d=i-Math.sqrt(h*h+f*f);this.image.data[a+l]=Math.max(0,Math.min(255,d+128))}}},{key:"addRegularDash",value:function(e,t){for(var n=e.length-1;n>=0;--n){var i=e[n],r=e[n+1];i.zeroLength?e.splice(n,1):r&&r.isDash===i.isDash&&(r.left=i.left,e.splice(n,1))}var a=e[0],o=e[e.length-1];a.isDash===o.isDash&&(a.left=o.left-this.width,o.right=a.right+this.width);for(var s=this.width*this.nextRow,l=0,u=e[l],c=0;c<this.width;c++){c/u.right>1&&(u=e[++l]);var h=Math.abs(c-u.left),d=Math.abs(c-u.right),f=Math.min(h,d);this.image.data[s+c]=Math.max(0,Math.min(255,(u.isDash?f:-f)+t+128))}}},{key:"addDash",value:function(e,t){var n=this.getKey(e,t);if(this.positions[n])return this.positions[n];var i="round"===t,r=i?7:0,a=2*r+1;if(this.nextRow+a>this.height)return q("LineAtlas out of space"),null;0===e.length&&e.push(1);for(var o=0,s=0;s<e.length;s++)e[s]<0&&(q("Negative value is found in line dasharray, replacing values with 0"),e[s]=0),o+=e[s];if(0!==o){var l=this.width/o,u=this.getDashRanges(e,this.width,l);i?this.addRoundDash(u,l,r):this.addRegularDash(u,"square"===t?.5*l:0)}var c=this.nextRow+r;this.nextRow+=a;var h={tl:[c,r],br:[o,0]};return this.positions[n]=h,h}}]),e}();mr(zp,"LineAtlas");var Lp=_createClass((function e(t){_classCallCheck(this,e);var n={},i=[];for(var r in t){var a=t[r],o=n[r]={};for(var s in a.glyphs){var l=a.glyphs[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u=l.metrics.localGlyph?2:1,c={x:0,y:0,w:l.bitmap.width+2*u,h:l.bitmap.height+2*u};i.push(c),o[s]=c}}}var h=Qh(i),d=h.w,f=h.h,p=new wu({width:d||1,height:f||1});for(var m in t){var v=t[m];for(var g in v.glyphs){var y=v.glyphs[+g];if(y&&0!==y.bitmap.width&&0!==y.bitmap.height){var _=n[m][g],x=y.metrics.localGlyph?2:1;wu.copy(y.bitmap,p,{x:0,y:0},{x:_.x+x,y:_.y+x},y.bitmap)}}}this.image=p,this.positions=n}));mr(Lp,"GlyphAtlas");var Bp=function(){function e(t){_classCallCheck(this,e),this.tileID=new Yc(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Qd(t.tileID.canonical,t.projection),this.projection=t.projection}return _createClass(e,[{key:"parse",value:function(e,t,n,i,r){var a=this;this.status="parsing",this.data=e,this.collisionBoxArray=new ro;var o=new Vf(Object.keys(e.layers).sort()),s=new Op(this.tileID,this.promoteId);s.bucketLayerIDs=[];var l,u,c,h,d={},f=new zp(256,256),p={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:f,availableImages:n},m=t.familiesBySource[this.source];for(var v in m){var g=e.layers[v];if(g){var y,_=!1,x=!1,b=_createForOfIteratorHelper(m[v]);try{for(b.s();!(y=b.n()).done;){"symbol"===y.value[0].type?_=!0:x=!0}}catch(L){b.e(L)}finally{b.f()}if((!0!==this.isSymbolTile||_)&&(!1!==this.isSymbolTile||x)){1===g.version&&q('Vector tile source "'.concat(this.source,'" layer "').concat(v,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));for(var w=o.encode(v),k=[],C=0;C<g.length;C++){var S=g.feature(C),T=s.getId(S,v);k.push({feature:S,id:T,index:C,sourceLayerIndex:w})}var E,P=_createForOfIteratorHelper(m[v]);try{for(P.s();!(E=P.n()).done;){var M=E.value,I=M[0];void 0!==this.isSymbolTile&&"symbol"===I.type!==this.isSymbolTile||I.minzoom&&this.zoom<Math.floor(I.minzoom)||I.maxzoom&&this.zoom>=I.maxzoom||"none"!==I.visibility&&(Fp(M,this.zoom,n),(d[I.id]=I.createBucket({index:s.bucketLayerIDs.length,layers:M,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:w,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n})).populate(k,p,this.tileID.canonical,this.tileTransform),s.bucketLayerIDs.push(M.map((function(e){return e.id}))))}}catch(L){P.e(L)}finally{P.f()}}}}f.trim();var R={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},O=function(){if(l)return r(l);if(u&&c&&h){var e=new Lp(u),t=new ed(c,h);for(var i in d){var o=d[i];o instanceof Pf?(Fp(o.layers,a.zoom,n),Hd(o,u,e.positions,c,t.iconPositions,a.showCollisionBoxes,n,a.tileID.canonical,a.tileZoom,a.projection)):o.hasPattern&&(o instanceof oh||o instanceof uc||o instanceof zc)&&(Fp(o.layers,a.zoom,n),o.addFeatures(p,a.tileID.canonical,t.patternPositions,n,a.tileTransform))}a.status="done",r(null,{buckets:A(d).filter((function(e){return!e.isEmpty()})),featureIndex:s,collisionBoxArray:a.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:f,imageAtlas:t,glyphMap:a.returnDependencies?u:null,iconMap:a.returnDependencies?c:null,glyphPositions:a.returnDependencies?e.positions:null})}},N=j(p.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(N).length?i.send("getGlyphs",{uid:this.uid,stacks:N},(function(e,t){l||(l=e,u=t,O())}),void 0,!1,R):u={};var D=Object.keys(p.iconDependencies);D.length?i.send("getImages",{icons:D,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){l||(l=e,c=t,O())}),void 0,!1,R):c={};var z=Object.keys(p.patternDependencies);z.length?i.send("getImages",{icons:z,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){l||(l=e,h=t,O())}),void 0,!1,R):h={},O()}}]),e}();function Fp(e,t,n){var i,r=new fa(t),a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){i.value.recalculate(r,n)}}catch(o){a.e(o)}finally{a.f()}}var jp=function(){function e(t){_classCallCheck(this,e),this.entries={},this.scheduler=t}return _createClass(e,[{key:"request",value:function(e,t,n,i){var r=this,a=this.entries[e]=this.entries[e]||{callbacks:[]};if(a.result){var o=_slicedToArray(a.result,2),s=o[0],l=o[1];return this.scheduler?this.scheduler.add((function(){i(s,l)}),t):i(s,l),function(){}}return a.callbacks.push(i),a.cancel||(a.cancel=n((function(n,i){a.result=[n,i];var o,s=_createForOfIteratorHelper(a.callbacks);try{var l=function(){var e=o.value;r.scheduler?r.scheduler.add((function(){e(n,i)}),t):e(n,i)};for(s.s();!(o=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}setTimeout((function(){return delete r.entries[e]}),3e3)}))),function(){a.result||(a.callbacks=a.callbacks.filter((function(e){return e!==i})),a.callbacks.length||(a.cancel(),delete r.entries[e]))}}}]),e}();function Hp(e,t,n){var i=JSON.stringify(e.request);return e.data&&(this.deduped.entries[i]={result:[null,e.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(function(t){var i=de(e.request,(function(e,i,r,a){e?t(e):i&&t(null,{vectorTile:n?void 0:new Pc(new Xh(i)),rawData:i,cacheControl:r,expires:a})}));return function(){i.cancel(),t()}}),t)}var Vp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Up=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(_classCallCheck(this,e),isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;var a=Vp.indexOf(this.ArrayType),o=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(a<0)throw new Error("Unexpected typed array class: ".concat(i,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+l,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+l),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+l,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}return _createClass(e,[{key:"add",value:function(e,t){var n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}},{key:"finish",value:function(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return function e(t,n,i,r,a,o){if(!(a-r<=i)){var s=r+a>>1;(function e(t,n,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,n,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=n[2*i+o],f=r,p=a;for(qp(t,n,r,i),n[2*a+o]>d&&qp(t,n,r,a);f<p;){for(qp(t,n,f,p),f++,p--;n[2*f+o]<d;)f++;for(;n[2*p+o]>d;)p--}n[2*r+o]===d?qp(t,n,r,p):qp(t,n,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}})(t,n,s,r,a,o),e(t,n,i,r,s-1,1-o),e(t,n,i,s+1,a,1-o)}}(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}},{key:"range",value:function(e,t,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var r=this.ids,a=this.coords,o=this.nodeSize,s=[0,r.length-1,0],l=[];s.length;){var u=s.pop()||0,c=s.pop()||0,h=s.pop()||0;if(c-h<=o)for(var d=h;d<=c;d++){var f=a[2*d],p=a[2*d+1];f>=e&&f<=n&&p>=t&&p<=i&&l.push(r[d])}else{var m=h+c>>1,v=a[2*m],g=a[2*m+1];v>=e&&v<=n&&g>=t&&g<=i&&l.push(r[m]),(0===u?e<=v:t<=g)&&(s.push(h),s.push(m-1),s.push(1-u)),(0===u?n>=v:i>=g)&&(s.push(m+1),s.push(c),s.push(1-u))}}return l}},{key:"within",value:function(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var i=this.ids,r=this.coords,a=this.nodeSize,o=[0,i.length-1,0],s=[],l=n*n;o.length;){var u=o.pop()||0,c=o.pop()||0,h=o.pop()||0;if(c-h<=a)for(var d=h;d<=c;d++)Wp(r[2*d],r[2*d+1],e,t)<=l&&s.push(i[d]);else{var f=h+c>>1,p=r[2*f],m=r[2*f+1];Wp(p,m,e,t)<=l&&s.push(i[f]),(0===u?e-n<=p:t-n<=m)&&(o.push(h),o.push(f-1),o.push(1-u)),(0===u?e+n>=p:t+n>=m)&&(o.push(f+1),o.push(c),o.push(1-u))}}return s}}],[{key:"from",value:function(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var n=_slicedToArray(new Uint8Array(t,0,2),2),i=n[0],r=n[1];if(219!==i)throw new Error("Data does not appear to be in a KDBush format.");var a=r>>4;if(1!==a)throw new Error("Got v".concat(a," data when expected v1."));var o=Vp[15&r];if(!o)throw new Error("Unrecognized array type.");var s=_slicedToArray(new Uint16Array(t,2,1),1)[0];return new e(_slicedToArray(new Uint32Array(t,4,1),1)[0],s,o,t)}}]),e}();function qp(e,t,n,i){Gp(e,n,i),Gp(t,2*n,2*i),Gp(t,2*n+1,2*i+1)}function Gp(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function Wp(e,t,n,i){var r=e-n,a=t-i;return r*r+a*a}e.ARRAY_TYPE=ts,e.AUTH_ERR_MSG=ge,e.Aabb=Xs,e.Actor=function(){function e(t,n,i){_classCallCheck(this,e),this.target=t,this.parent=n,this.mapId=i,this.callbacks={},this.cancelCallbacks={},B(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Z()?t:r,this.scheduler=new Hf}return _createClass(e,[{key:"send",value:function(e,t,n,i){var r=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=o,this.callbacks[s]=n);var l=Y(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:e,hasCallback:!!n,targetMapId:i,mustQueue:a,sourceMapId:this.mapId,data:_r(t,l)},l),{cancel:function(){n&&delete r.callbacks[s],r.target.postMessage({id:s,type:"<cancel>",targetMapId:i,sourceMapId:r.mapId})}}}},{key:"receive",value:function(e){var t=this,n=e.data,i=n.id;if(i&&(!n.targetMapId||this.mapId===n.targetMapId))if("<cancel>"===n.type){var r=this.cancelCallbacks[i];delete this.cancelCallbacks[i],r&&r.cancel()}else if(n.mustQueue||Z()){var a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add((function(){return t.processTask(i,n)}),a&&a.metadata||{type:"message"})}else this.processTask(i,n)}},{key:"processTask",value:function(e,t){var n=this;if("<response>"===t.type){var i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(xr(t.error)):i(null,xr(t.data)))}else{var r=Y(this.globalScope)?void 0:[],a=t.hasCallback?function(t,i){delete n.cancelCallbacks[e],n.target.postMessage({id:e,type:"<response>",sourceMapId:n.mapId,error:t?_r(t):null,data:_r(i,r)},r)}:function(e){},o=xr(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,o,a);else if(this.parent.getWorkerSource){var s=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,s[0],o.source)[s[1]](o,a)}else a(new Error("Could not find function "+t.type))}}},{key:"remove",value:function(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}]),e}(),e.CanonicalTileID=Xc,e.Color=Pt,e.ColorMode=Tp,e.CullFaceMode=Ep,e.DEMData=wp,e.DataConstantProperty=wa,e.DedupedRequest=jp,e.DepthMode=Cp,e.EXTENT=Qo,e.Elevation=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isDataAvailableAtPoint",value:function(e){var t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;var n=t.getSource().maxzoom,i=1<<n,r=Math.floor(e.x),a=Math.floor((e.x-r)*i),o=Math.floor(e.y*i),s=this.findDEMTileFor(new Yc(n,r,n,a,o));return!(!s||!s.dem)}},{key:"getAtPointOrZero",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}},{key:"getAtPoint",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==t&&(t=null);var i=this._source();if(!i)return t;if(e.y<0||e.y>1)return t;var r=i.getSource().maxzoom,a=1<<r,o=Math.floor(e.x),s=e.x-o,l=new Yc(r,o,r,Math.floor(s*a),Math.floor(e.y*a)),u=this.findDEMTileFor(l);if(!u||!u.dem)return t;var c=u.dem,h=1<<u.tileID.canonical.z,d=(s*h-u.tileID.canonical.x)*c.dim,f=(e.y*h-u.tileID.canonical.y)*c.dim,p=Math.floor(d),m=Math.floor(f);return(n?this.exaggeration():1)*xn(xn(c.get(p,m),c.get(p,m+1),f-m),xn(c.get(p+1,m),c.get(p+1,m+1),f-m),d-p)}},{key:"getAtTileOffset",value:function(e,t,n){var i=1<<e.canonical.z;return this.getAtPointOrZero(new zl(e.wrap+(e.canonical.x+t/Qo)/i,(e.canonical.y+n/Qo)/i))}},{key:"getAtTileOffsetFunc",value:function(e,t,n,i){var r=this;return function(a){var o=r.getAtTileOffset(e,a.x,a.y),s=i.upVector(e.canonical,a.x,a.y);return ks(s,s,o*i.upVectorScale(e.canonical,t,n).metersToTile),s}}},{key:"getForTilePoints",value:function(e,t,n,i){var r=this;if(this.isUsingMockSource())return!1;var a=Rp.create(this,e,i);return!!a&&(t.forEach((function(e){e[2]=r.exaggeration()*a.getElevationAt(e[0],e[1],n)})),!0)}},{key:"getMinMaxForTile",value:function(e){if(this.isUsingMockSource())return null;var t=this.findDEMTileFor(e);if(!t||!t.dem)return null;for(var n=t.dem.tree,i=t.tileID,r=1<<e.canonical.z-i.canonical.z,a=e.canonical.x/r-i.canonical.x,o=e.canonical.y/r-i.canonical.y,s=0,l=0;l<e.canonical.z-i.canonical.z&&!n.leaves[s];l++){a*=2,o*=2;var u=2*Math.floor(o)+Math.floor(a);s=n.childOffsets[s]+u,a%=1,o%=1}return{min:this.exaggeration()*n.minimums[s],max:this.exaggeration()*n.maximums[s]}}},{key:"getMinElevationBelowMSL",value:function(){throw new Error("Pure virtual method called.")}},{key:"raycast",value:function(e,t,n){throw new Error("Pure virtual method called.")}},{key:"pointCoordinate",value:function(e){throw new Error("Pure virtual method called.")}},{key:"_source",value:function(){throw new Error("Pure virtual method called.")}},{key:"isUsingMockSource",value:function(){throw new Error("Pure virtual method called.")}},{key:"exaggeration",value:function(){throw new Error("Pure virtual method called.")}},{key:"findDEMTileFor",value:function(e){throw new Error("Pure virtual method called.")}},{key:"visibleDemTiles",get:function(){throw new Error("Getter must be implemented in subclass.")}}]),e}(),e.ErrorEvent=Je,e.EvaluationParameters=fa,e.Event=Ye,e.Evented=Qe,e.FillExtrusionBucket=zc,e.Frustum=Zs,e.FrustumCorners=Ws,e.GLOBE_RADIUS=Ks,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=6,e.GLOBE_ZOOM_THRESHOLD_MIN=5,e.GlobeSharedBuffers=function(){function e(t){_classCallCheck(this,e),this._createGrid(t),this._createPoles(t)}return _createClass(e,[{key:"destroy",value:function(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();var e,t=_createForOfIteratorHelper(this._poleSegments);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(s){t.e(s)}finally{t.f()}var n,i=_createForOfIteratorHelper(this._gridSegments);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.withSkirts.destroy(),r.withoutSkirts.destroy()}}catch(s){i.e(s)}finally{i.f()}if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();var a,o=_createForOfIteratorHelper(this._wireframeSegments);try{for(o.s();!(a=o.n()).done;){a.value.destroy()}}catch(s){o.e(s)}finally{o.f()}}}},{key:"_fillGridMeshWithLods",value:function(e,t){for(var n=new Ra,i=new Xa,r=[],a=e+1+2,o=t[0]+1,s=t[0]+1+(1+t.length),l=function(e,t,n){var i=e===a-1?e-2:0===e?e:e-1;return[i+=n?24575:0,t]},u=0;u<a;++u)n.emplaceBack.apply(n,_toConsumableArray(l(u,0,!0)));for(var c=0;c<o;++c)for(var h=0;h<a;++h)n.emplaceBack.apply(n,_toConsumableArray(l(h,c,(0===h||h===a-1)&&!0)));for(var d=0;d<t.length;++d)for(var f=t[d],p=0;p<a;++p)n.emplaceBack.apply(n,_toConsumableArray(l(p,f,!0)));for(var m=0;m<t.length;++m){for(var v=i.length,g=t[m]+1+2,y=new Xa,_=0;_<g-1;_++)for(var x=_===g-2,b=x?a*(s-t.length+m-_):a,w=0;w<a-1;w++){var k=_*a+w;0===_||x||0===w||w===a-2?(y.emplaceBack(k+1,k,k+b),y.emplaceBack(k+b,k+b+1,k+1)):(i.emplaceBack(k+1,k,k+b),i.emplaceBack(k+b,k+b+1,k+1))}for(var C=Jo.simpleSegment(0,v,n.length,i.length-v),S=0;S<y.uint16.length;S+=3)i.emplaceBack(y.uint16[S],y.uint16[S+1],y.uint16[S+2]);var T=Jo.simpleSegment(0,v,n.length,i.length-v);r.push({withoutSkirts:C,withSkirts:T})}return{vertices:n,indices:i,segments:r}}},{key:"_createGrid",value:function(e){var t=this._fillGridMeshWithLods(64,Ys);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,qs.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}},{key:"_createPoles",value:function(e){for(var t=new Xa,n=0;n<=64;n++)t.emplaceBack(0,n+1,n+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);var i=new Qa,r=new Qa;this._poleSegments=[];for(var a=0,o=0;a<5;a++){var s=360/(1<<a);i.emplaceBack(0,-Ks,0,.5,0),r.emplaceBack(0,-Ks,0,.5,1);for(var l=0;l<=64;l++){var u=l/64,c=xn(0,s,u),h=_slicedToArray(cl(wl,kl,c,Ks),3),d=h[0],f=h[1],p=h[2];i.emplaceBack(d,f,p,u,0),r.emplaceBack(d,f,p,u,1)}this._poleSegments.push(Jo.simpleSegment(o,0,66,64)),o+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,Vs,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(r,Vs,!1)}},{key:"getGridBuffers",value:function(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}},{key:"getPoleBuffers",value:function(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}},{key:"getWirefameBuffers",value:function(e,t){if(!this._wireframeSegments){var n=new eo;this._wireframeSegments=[];for(var i=0,r=0;i<Ys.length;i++){for(var a=Ys[i],o=1;o<a+1;o++)for(var s=1;s<65;s++){var l=67*o+s;n.emplaceBack(l,l+1),n.emplaceBack(l,l+67),n.emplaceBack(l,l+67+1)}var u=64*a*3;this._wireframeSegments.push(Jo.simpleSegment(0,r,67*(a+1),u)),r+=u}this._wireframeIndexBuffer=e.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}}]),e}(),e.GlyphManager=Td,e.ImagePosition=$h,e.KDBush=Up,e.LivePerformanceUtils=Fe,e.LngLat=Tl,e.LngLatBounds=$o,e.LocalGlyphMode=Sd,e.MAX_MERCATOR_LATITUDE=Nl,e.MercatorCoordinate=zl,e.ONE_EM=24,e.OverscaledTileID=Yc,e.PerformanceMarkers=Be,e.Point=y,e.Properties=Sa,e.RGBAImage=ku,e.Ray=Gs,e.RequestManager=function(){function e(t,n,i){_classCallCheck(this,e),this._transformRequestFn=t,this._customAccessToken=n,this._silenceAuthErrors=!!i,this._createSkuToken()}return _createClass(e,[{key:"_createSkuToken",value:function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",h,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}},{key:"_isSkuTokenExpired",value:function(){return Date.now()>this._skuTokenExpiresAt}},{key:"transformRequest",value:function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}},{key:"normalizeStyleURL",value:function(e,t){if(!ye(e))return e;var n=Ce(e);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||t)}},{key:"normalizeGlyphsURL",value:function(e,t){if(!ye(e))return e;var n=Ce(e);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||t)}},{key:"normalizeSourceURL",value:function(e,t,n,i){if(!ye(e))return e;var r=Ce(e);return r.path="/v4/".concat(r.authority,".json"),r.params.push("secure"),n&&r.params.push("language="+n),i&&r.params.push("worldview="+i),this._makeAPIURL(r,this._customAccessToken||t)}},{key:"normalizeSpriteURL",value:function(e,t,n,i){var r=Ce(e);return ye(e)?(r.path="/styles/v1".concat(r.path,"/sprite").concat(t).concat(n),this._makeAPIURL(r,this._customAccessToken||i)):(r.path+="".concat(t).concat(n),Se(r))}},{key:"normalizeTileURL",value:function(e,t,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!ye(e))return e;var i=Ce(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(t||n&&"raster"!==i.authority&&512===n?"@2x":"").concat(s.supported?".webp":"$1")),"raster"===i.authority?i.path="/".concat(o.RASTER_URL_PREFIX).concat(i.path):(i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/".concat(o.TILE_URL_VERSION).concat(i.path));var r=this._customAccessToken||function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var i=t.value.match(/^access_token=(.*)$/);if(i)return i[1]}}catch(r){n.e(r)}finally{n.f()}return null}(i.params)||o.ACCESS_TOKEN;return o.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,r)}},{key:"canonicalizeTileURL",value:function(e,t){var n=Ce(e);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return e;var i="mapbox://";n.path.match(/^\/raster\/v1\//)?i+="raster/"+n.path.replace("/".concat(o.RASTER_URL_PREFIX,"/"),""):i+="tiles/"+n.path.replace("/".concat(o.TILE_URL_VERSION,"/"),"");var r=n.params;return t&&(r=r.filter((function(e){return!e.match(/^access_token=/)}))),r.length&&(i+="?"+r.join("&")),i}},{key:"canonicalizeTileset",value:function(e,t){var n,i=!!t&&ye(t),r=[],a=_createForOfIteratorHelper(e.tiles||[]);try{for(a.s();!(n=a.n()).done;){var o=n.value;_e(o)?r.push(this.canonicalizeTileURL(o,i)):r.push(o)}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"_makeAPIURL",value:function(e,t){var n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",i=Ce(o.API_URL);if(e.protocol=i.protocol,e.authority=i.authority,"http"===e.protocol){var r=e.params.indexOf("secure");r>=0&&e.params.splice(r,1)}if("/"!==i.path&&(e.path="".concat(i.path).concat(e.path)),!o.REQUIRE_ACCESS_TOKEN)return Se(e);if(t=t||o.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n)}return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token="+(t||"")),Se(e)}}]),e}(),e.ResourceType=le,e.SegmentVector=Jo,e.SourceCache=Pp,e.StencilMode=Sp,e.StructArrayLayout1ui2=to,e.StructArrayLayout2f1f2i16=Ga,e.StructArrayLayout2i4=Ra,e.StructArrayLayout2ui4=eo,e.StructArrayLayout3f12=Za,e.StructArrayLayout3ui6=Xa,e.StructArrayLayout4i8=Na,e.StructArrayLayout5f20=Qa,e.Texture=Ff,e.Tile=up,e.Transitionable=va,e.Uniform1f=Po,e.Uniform1i=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=0,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}}]),t}(Eo),e.Uniform2f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=[0,0],n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}}]),t}(Eo),e.Uniform3f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=[0,0,0],n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}}]),t}(Eo),e.Uniform4f=Mo,e.UniformColor=Io,e.UniformMatrix2f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=Oo,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){if(this.fetchUniformLocation(e,t))for(var i=0;i<4;i++)if(n[i]!==this.current[i]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}]),t}(Eo),e.UniformMatrix3f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=Ro,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){if(this.fetchUniformLocation(e,t))for(var i=0;i<9;i++)if(n[i]!==this.current[i]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}]),t}(Eo),e.UniformMatrix4f=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).current=Ao,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t,n){if(this.fetchUniformLocation(e,t)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(var i=1;i<16;i++)if(n[i]!==this.current[i]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}}]),t}(Eo),e.UnwrappedTileID=Kc,e.ValidationError=Ei,e.VectorTileFeature=Mc,e.VectorTileWorkerSource=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t)).actor=e,o.layerIndex=n,o.availableImages=i,o.loadVectorData=a||Hp,o.loading={},o.loaded={},o.deduped=new jp(e.scheduler),o.isSpriteLoaded=r,o.scheduler=e.scheduler,o}return _inherits(t,e),_createClass(t,[{key:"loadTile",value:function(e,t){var n=this,i=e.uid,r=e&&e.request,a=r&&r.collectResourceTiming,o=this.loading[i]=new Bp(e);o.abort=this.loadVectorData(e,(function(s,l){var u=!n.loading[i];if(delete n.loading[i],u||s||!l)return o.status="done",u||(n.loaded[i]=o),t(s);var c=l.rawData,h={};l.expires&&(h.expires=l.expires),l.cacheControl&&(h.cacheControl=l.cacheControl),o.vectorTile=l.vectorTile||new Pc(new Xh(c));var d=function(){o.parse(o.vectorTile,n.layerIndex,n.availableImages,n.actor,(function(e,n){if(e||!n)return t(e);var i={};if(a){var o=We(r);o.length>0&&(i.resourceTiming=JSON.parse(JSON.stringify(o)))}t(null,R({rawTileData:c.slice(0)},n,h,i))}))};n.isSpriteLoaded?d():n.once("isSpriteLoaded",(function(){n.scheduler?n.scheduler.add(d,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):d()})),n.loaded=n.loaded||{},n.loaded[i]=o}))}},{key:"reloadTile",value:function(e,t){var n=this,i=this.loaded,r=e.uid,a=this;if(i&&i[r]){var o=i[r];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain,o.projection=e.projection,o.tileTransform=Qd(e.tileID.canonical,e.projection);var s=function(e,i){var r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,a.layerIndex,n.availableImages,a.actor,r)),t(e,i)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}},{key:"abortTile",value:function(e,t){var n=e.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),t()}},{key:"removeTile",value:function(e,t){var n=this.loaded,i=e.uid;n&&n[i]&&delete n[i],t()}}]),t}(Qe),e.WritingMode=td,e.ZoomDependentExpression=Ci,e.add=ys,e.addDynamicAttributes=Sf,e.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-s*u,e[1]=r*u-i*c,e[2]=i*s-r*o,e[3]=s*l-a*c,e[4]=n*c-r*l,e[5]=r*a-n*s,e[6]=a*u-o*l,e[7]=i*l-n*u,e[8]=n*o-i*a,e},e.asyncAll=I,e.bezier=S,e.bindAll=B,e.boundsAttributes=sp,e.bufferConvexPolygon=function(e,t){for(var n=[],i=0;i<e.length;i++){var r=M(i-1,-1,e.length-1),a=M(i+1,-1,e.length-1),o=e[i],s=e[a],l=e[r].sub(o).unit(),u=s.sub(o).unit(),c=u.angleWithSep(l.x,l.y),h=l.add(u).unit().mult(-1*t/Math.sin(c/2));n.push(o.add(h))}return n},e.cacheEntryPossiblyAdded=function(e){++se>ie&&(e.getActor().send("enforceCacheSizeLimit",ne),se=0)},e.calculateGlobeLabelMatrix=function(e,t){var n=e.point,i=gl(n.x,n.y,e.worldSize/e._pixelsPerMercatorPixel,0,0);return os(i,i,vl(rl(t)))},e.calculateGlobeMatrix=function(e){var t=e.point,n=t.x,i=t.y,r=e._center,a=r.lng,o=r.lat;return gl(n,i,e.worldSize,a,o)},e.calculateGlobeMercatorMatrix=function(e){var t=e.pixelsPerMeter,n=t/Il(1,e.center.lat),i=rs(new Float64Array(16));return ss(i,i,[e.point.x,e.point.y,0]),ls(i,i,[n,n,t]),Float32Array.from(i)},e.circumferenceAtLatitude=El,e.clamp=E,e.clearTileCache=function(e){if(re()){var t=r.caches.delete(te);e&&t.catch(e).then((function(){return e()}))}},e.clipLine=bd,e.clone=function(e){var t=new ts(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=V,e.collisionCircleLayout=gh,e.config=o,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new ts(16);return ts!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=ns,e.createExpression=wi,e.createLayout=Ia,e.createStyleLayer=function(e){return"custom"===e.type?new Df(e):new Bf[e.type](e)},e.cross=Es,e.degToRad=b,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},e.dot=Ts,e.earthRadius=Cl,e.ease=T,e.easeCubicInOut=C,e.ecefToLatLng=function(e){var t=_slicedToArray(e,3),n=t[0],i=t[1],r=t[2],a=Math.hypot(n,i,r),o=Math.atan2(n,r),s=.5*Math.PI-Math.acos(-i/a);return new Tl(w(o),w(s))},e.emitValidationErrors=cr,e.endsWith=F,e.enforceCacheSizeLimit=function(e){ae(),$&&$.then((function(t){t.keys().then((function(n){for(var i=0;i<n.length-e;i++)t.delete(n[i])}))}))},e.evaluateSizeForFeature=xh,e.evaluateSizeForZoom=bh,e.evaluateVariableOffset=jd,e.evented=ua,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=Ze,e.exported$1=s,e.extend=R,e.extend$1=et,e.fillExtrusionHeightLift=Uc,e.filterObject=H,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=n+n,s=i+i,l=r+r,u=n*o,c=i*o,h=i*s,d=r*o,f=r*s,p=r*l,m=a*o,v=a*s,g=a*l;return e[0]=1-h-p,e[1]=c+g,e[2]=d-v,e[3]=0,e[4]=c-g,e[5]=1-u-p,e[6]=f+m,e[7]=0,e[8]=d+v,e[9]=f-m,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=-n,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=hs,e.furthestTileCorner=function(e){var t=Math.round((e+45+360)%360/90)%4;return k[t]},e.getAABBPointSquareDist=function(e,t,n){for(var i=0,r=0;r<2;++r){var a=n?n[r]:0;e[r]>a&&(i+=(e[r]-a)*(e[r]-a)),t[r]<a&&(i+=(a-t[r])*(a-t[r]))}return i},e.getAnchorAlignment=hd,e.getAnchorJustification=Vd,e.getBounds=function(e){var t,n=1/0,i=1/0,r=-1/0,a=-1/0,o=_createForOfIteratorHelper(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;n=Math.min(n,s.x),i=Math.min(i,s.y),r=Math.max(r,s.x),a=Math.max(a,s.y)}}catch(l){o.e(l)}finally{o.f()}return{min:new y(n,i),max:new y(r,a)}},e.getColumn=Q,e.getDefaultExportFromCjs=d,e.getGridMatrix=function(e,t,n,i){var r=t.getNorth(),a=t.getSouth(),o=t.getWest(),s=t.getEast(),l=1<<e.z,u=s-o,c=r-a,h=u/64,d=-c/Ys[n],f=[0,h,0,d,0,0,r,o,0];if(e.z>0){var p=180/i;is(f,f,[p/u+1,0,0,0,p/c+1,0,-.5*p/h,.5*p/d,1])}return f[2]=l,f[5]=e.x,f[8]=e.y,f},e.getImage=function e(t,n){if(s.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),me>=o.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return pe.push(i),i}me++;var a=!1,l=function(){if(!a)for(a=!0,me--;pe.length&&me<o.MAX_PARALLEL_IMAGE_REQUESTS;){var t=pe.shift(),n=t.requestParameters,i=t.callback;t.cancelled||(t.cancel=e(n,i).cancel)}},u=de(t,(function(e,t,i,a){l(),e?n(e):t&&(r.createImageBitmap?function(e,t){var n=new r.Blob([new Uint8Array(e)],{type:"image/png"});r.createImageBitmap(n).then((function(e){t(null,e)})).catch((function(e){t(new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(t,(function(e,t){return n(e,t,i,a)})):function(e,t){var n=new r.Image,i=r.URL;n.onload=function(){t(null,n),i.revokeObjectURL(n.src),n.onload=null,r.requestAnimationFrame((function(){n.src=ve}))},n.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new r.Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?i.createObjectURL(a):ve}(t,(function(e,t){return n(e,t,i,a)})))}));return{cancel:function(){u.cancel(),l()}}},e.getJSON=function(e,t){return he(R(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){var t=Nl-5;e=E(e,-t,t)/t*90;var n=Math.pow(Math.abs(Math.sin(b(e))),3);return Math.round(n*(Ys.length-1))},e.getMapSessionAPI=ze,e.getPerformanceMeasurement=We,e.getProjection=xf,e.getRTLTextPluginStatus=ca,e.getReferrer=ce,e.getTilePoint=function(e,t){var n=t.x,i=t.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new y(((n-r)*e.scale-e.x)*Qo,(i*e.scale-e.y)*Qo)},e.getTileVec3=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return gs(((t.x-n)*e.scale-e.x)*Qo,(t.y*e.scale-e.y)*Qo,Ol(t.z,t.y))},e.getVideo=function(e,t){var n=r.document.createElement("video");n.muted=!0,n.onloadstart=function(){t(null,n)};for(var i=0;i<e.length;i++){var a=r.document.createElement("source");fe(e[i])||(n.crossOrigin="Anonymous"),a.src=e[i],n.appendChild(a)}return{cancel:function(){}}},e.globeCenterToScreenPoint=function(e){var t=[0,0,0],n=rs(new Float64Array(16));return os(n,e.pixelMatrix,e.globeMatrix),Ps(t,t,n),new y(t[0],t[1])},e.globeDenormalizeECEF=vl,e.globeECEFOrigin=function(e,t){var n=[0,0,0];return Ps(n,n,ml(rl(t.canonical))),Ps(n,n,e),n},e.globeMetersToEcef=el,e.globeNormalizeECEF=ml,e.globePixelsToTileUnits=function(e,t){return Qo/(512*Math.pow(2,e))*fl(rl(t))},e.globePoleMatrixForTile=function(e,t,n){var i=rs(new Float64Array(16)),r=(t/(1<<e)-.5)*Math.PI*2;return cs(i,n.globeMatrix,r),Float32Array.from(i)},e.globeTileBounds=rl,e.globeTiltAtLngLat=_l,e.globeToMercatorTransition=yl,e.globeUseCustomAntiAliasing=function(e,t,n){var i=yl(n.zoom),r=e.style.map._antialias,a=!!t.extStandardDerivatives,o=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===i&&!r&&!o&&a},e.identity=rs,e.identity$1=Bs,e.invert=as,e.isFullscreen=function(){return!!r.document.fullscreenElement||!!r.document.webkitFullscreenElement},e.isLngLatBehindGlobe=xl,e.isMapAuthenticated=function(e){return Le.has(e)},e.isMapboxURL=ye,e.isSafariWithAntialiasingBug=function(e){var t=e.navigator?e.navigator.userAgent:null;return!!Y(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=Rl,e.latLngToECEF=hl,e.len=Os,e.length=vs,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.lngFromMercatorX=Al,e.loadVectorTile=Hp,e.makeRequest=he,e.mapValue=function(e,t,n,i,r){return E((e-t)/(n-t)*(r-i)+i,i,r)},e.mercatorScale=Dl,e.mercatorXfromLng=Pl,e.mercatorYfromLat=Ml,e.mercatorZfromAltitude=Il,e.mul=fs,e.mul$1=Rs,e.multiply=os,e.multiply$1=is,e.multiply$2=xs,e.nextPowerOfTwo=z,e.normalize=Ss,e.normalize$1=Hs,e.normalize$2=Ds,e.number=xn,e.ortho=function(e,t,n,i,r,a,o){var s=1/(t-n),l=1/(i-r),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(o+a)*u,e[15]=1,e},e.pbf=Th,e.perspective=function(e,t,n,i,r){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+i)*(a=1/(i-r)),e[14]=2*r*i*a):(e[10]=-1,e[14]=-2*i),e},e.pick=function(e,t){for(var n={},i=0;i<t.length;i++){var r=t[i];r in e&&(n[r]=e[r])}return n},e.plugin=da,e.pointGeometry=v,e.polesInViewport=function(e){var t=rs(new Float64Array(16));os(t,e.pixelMatrix,e.globeMatrix);var n=[0,Js,0],i=[0,Qs,0];return Ps(n,n,t),Ps(i,i,t),[n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!xl(e,new Tl(e.center.lat,90)),i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!xl(e,new Tl(e.center.lat,-90))]},e.polygonContainsPoint=ru,e.polygonIntersectsBox=au,e.polygonIntersectsPolygon=Kl,e.polygonizeBounds=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=new y(n,n),a=e.sub(r),o=t.add(r),s=[a,new y(o.x,a.y),o,new y(a.x,o.y)];return i&&s.push(a.clone()),s},e.posAttributes=qs,e.postMapLoadEvent=Re,e.postPerformanceEvent=Ne,e.postTurnstileEvent=Ie,e.potpack=Qh,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=w,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:aa,pluginURL:oa}),ua.on("pluginStateChange",e),e},e.removeAuthState=function(e){Le.delete(e)},e.renderColorRamp=Su,e.resample=Bl,e.rotateX=us,e.rotateX$1=Fs,e.rotateY=cs,e.rotateY$1=js,e.rotateZ=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+u*i,e[1]=o*r+c*i,e[2]=s*r+h*i,e[3]=l*r+d*i,e[4]=u*r-a*i,e[5]=c*r-o*i,e[6]=h*r-s*i,e[7]=d*r-l*i,e},e.rotateZ$1=function(e,t,n){n*=.5;var i=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+r*s,e[1]=r*l-i*s,e[2]=a*l+o*s,e[3]=o*l-a*s,e},e.scale=ls,e.scale$1=Ns,e.scale$2=ks,e.scaleAndAdd=Cs,e.set=function(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e},e.setCacheLimits=function(e,t){ne=e,ie=t},e.setColumn=function(e,t,n){e[4*t+0]=n[0],e[4*t+1]=n[1],e[4*t+2]=n[2],e[4*t+3]=n[3]},e.setRTLTextPlugin=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(aa===ta||aa===na||aa===ia)throw new Error("setRTLTextPlugin cannot be called multiple times.");oa=Ze.resolveURL(e),aa=ta,ra=t,la(),n||ha()},e.smoothstep=P,e.spec=$e,e.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},e.storeAuthState=function(e,t){t?Le.add(e):Le.delete(e)},e.sub=As,e.subtract=_s,e.symbolSize=wh,e.tileAABB=function(e,t,n,i,r,a,o,s,l){if("globe"===l.name)return function(e,t,n){var i=t/e.worldSize,r=e.globeMatrix;if(n.z<=1){var a=rl(n).getCorners();return sl(a,r,i),Xs.fromPoints(a)}var o=ll(n),s=ul(o);sl(s,r,i);var l=Number.MAX_VALUE,u=[-l,-l,-l],c=[l,l,l];if(o.contains(e.center)){var h,d=_createForOfIteratorHelper(s);try{for(d.s();!(h=d.n()).done;){var f=h.value;bs(c,c,f),ws(u,u,f)}}catch(B){d.e(B)}finally{d.f()}u[2]=0;var p=e.point,m=[p.x*i,p.y*i,0];return bs(c,c,m),ws(u,u,m),new Xs(c,u)}var v=[r[12]*i,r[13]*i,r[14]*i],g=o.getCenter(),y=E(e.center.lat,-Nl,Nl),_=E(g.lat,-Nl,Nl),x=Pl(e.center.lng),w=Ml(y),k=x-Pl(g.lng),C=w-Ml(_);k>.5?k-=1:k<-.5&&(k+=1);var S=0;Math.abs(k)>Math.abs(C)?S=k>=0?1:3:(S=C>=0?0:2,Cs(v,v,[r[4]*i,r[5]*i,r[6]*i],-Math.sin(b(C>=0?o.getSouth():o.getNorth()))*Ks));var T=s[S],P=s[(S+1)%4],M=new nl(T,P,v),I=[il(M,0)||T[0],il(M,1)||T[1],il(M,2)||T[2]],A=yl(e.zoom);if(A>0){for(var R=function(e,t,n,i,r){var a=e.x,o=e.y,s=1/(1<<e.z),l=a*s,u=l+s,c=o*s,h=c+s,d=0,f=(l+u)/2-i;return f>.5?d=-1:f<-.5&&(d=1),c=(c*t-(r*=t))*n+r,[[l=((l+d)*t-(i*=t))*n+i,h=(h*t-r)*n+r,0],[u=((u+d)*t-i)*n+i,h,0],[u,c,0],[l,c,0]]}(n,t,e._pixelsPerMercatorPixel,x,w),O=0;O<s.length;O++)al(s[O],R[O],A);var N=ys([],R[S],R[(S+1)%4]);ks(N,N,.5),al(I,N,A)}var D,z=_createForOfIteratorHelper(s);try{for(z.s();!(D=z.n()).done;){var L=D.value;bs(c,c,L),ws(u,u,L)}}catch(B){z.e(B)}finally{z.f()}return c[2]=Math.min(T[2],P[2]),bs(c,c,I),ws(u,u,I),new Xs(c,u)}(e,t,new Xc(n,i,r));var u=Qd({z:n,x:i,y:r},l);return new Xs([(a+u.x/u.scale)*t,t*(u.y/u.scale),o],[(a+u.x2/u.scale)*t,t*(u.y2/u.scale),s])},e.tileCornersToBounds=ll,e.tileTransform=Qd,e.transformMat3=function(e,t,n){var i=t[0],r=t[1],a=t[2];return e[0]=i*n[0]+r*n[3]+a*n[6],e[1]=i*n[1]+r*n[4]+a*n[7],e[2]=i*n[2]+r*n[5]+a*n[8],e},e.transformMat4=Ps,e.transformMat4$1=zs,e.transformQuat=Ms,e.transitionTileAABBinECEF=ol,e.translate=ss,e.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=sa,e.uniqueId=N,e.updateGlobeVertexNormal=function(e,t,n,i,r){var a=5*t+2;e.float32[a+0]=n,e.float32[a+1]=i,e.float32[a+2]=r},e.validateCustomStyleLayer=function(e){var t=[],n=e.id;return void 0===n&&t.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(n,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),t},e.validateFilter=function(e){return ur(Gi(e))},e.validateFog=function(e){return ur(nr(e))},e.validateLayer=function(e){return ur(Ki(e))},e.validateLight=function(e){return ur(er(e))},e.validateSource=function(e){return ur(Qi(e))},e.validateStyle=or,e.validateTerrain=function(e){return ur(tr(e))},e.values=A,e.vectorTile=vc,e.version=a,e.warnOnce=q,e.window=r,e.wrap=M})),i(0,(function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){var n,i="[",r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){i+=t(n.value)+","}}catch(u){r.e(u)}finally{r.f()}return i+"]"}var a,o="{",s=_createForOfIteratorHelper(Object.keys(e).sort());try{for(s.s();!(a=s.n()).done;){var l=a.value;o+="".concat(l,":").concat(t(e[l]),",")}}catch(u){s.e(u)}finally{s.f()}return o+"}"}function n(n){var i,r="",a=_createForOfIteratorHelper(e.refProperties);try{for(a.s();!(i=a.n()).done;){r+="/"+t(n[i.value])}}catch(o){a.e(o)}finally{a.f()}return r}var i=function(){function t(e){_classCallCheck(this,t),this.keyCache={},e&&this.replace(e)}return _createClass(t,[{key:"replace",value:function(e){this._layerConfigs={},this._layers={},this.update(e,[])}},{key:"update",value:function(t,i){var r,a=this,o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;this._layerConfigs[s.id]=s,(this._layers[s.id]=e.createStyleLayer(s)).compileFilter(),this.keyCache[s.id]&&delete this.keyCache[s.id]}}catch(_){o.e(_)}finally{o.f()}var l,u=_createForOfIteratorHelper(i);try{for(u.s();!(l=u.n()).done;){var c=l.value;delete this.keyCache[c],delete this._layerConfigs[c],delete this._layers[c]}}catch(_){u.e(_)}finally{u.f()}this.familiesBySource={};var h,d=_createForOfIteratorHelper(function(e,t){for(var i={},r=0;r<e.length;r++){var a=t&&t[e[r].id]||n(e[r]);t&&(t[e[r].id]=a);var o=i[a];o||(o=i[a]=[]),o.push(e[r])}var s=[];for(var l in i)s.push(i[l]);return s}(e.values(this._layerConfigs),this.keyCache));try{for(d.s();!(h=d.n()).done;){var f=h.value.map((function(e){return a._layers[e.id]})),p=f[0];if("none"!==p.visibility){var m=p.source||"",v=this.familiesBySource[m];v||(v=this.familiesBySource[m]={});var g=p.sourceLayer||"_geojsonTileLayer",y=v[g];y||(y=v[g]=[]),y.push(f)}}}catch(_){d.e(_)}finally{d.f()}}}]),t}(),r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"loadTile",value:function(t,n){var i=t.uid,r=t.encoding,a=t.rawImageData,o=t.padding,s=t.buildQuadTree,l=e.window.ImageBitmap&&a instanceof e.window.ImageBitmap?this.getImageData(a,o):a;n(null,new e.DEMData(i,l,r,o<1,s))}},{key:"getImageData",value:function(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}]),t}();function a(e,t){if(0!==e.length){o(e[0],t);for(var n=1;n<e.length;n++)o(e[n],!t)}}function o(e,t){for(var n=0,i=0,r=0,a=e.length,o=a-1;r<a;o=r++){var s=(e[r][0]-e[o][0])*(e[o][1]+e[r][1]),l=n+s;i+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+i>=0!=!!t&&e.reverse()}var s=e.getDefaultExportFromCjs((function e(t,n){var i,r=t&&t.type;if("FeatureCollection"===r)for(i=0;i<t.features.length;i++)e(t.features[i],n);else if("GeometryCollection"===r)for(i=0;i<t.geometries.length;i++)e(t.geometries[i],n);else if("Feature"===r)e(t.geometry,n);else if("Polygon"===r)a(t.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<t.coordinates.length;i++)a(t.coordinates[i],n);return t})),l=e.VectorTileFeature.prototype.toGeoJSON,u={exports:{}},c=e.pointGeometry,h=e.vectorTile.VectorTileFeature,d=f;function f(e,t){this.options=t||{},this.features=e,this.length=e.length}function p(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}f.prototype.feature=function(e){return new p(this.features[e],this.options.extent)},p.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var n=e[t],i=[],r=0;r<n.length;r++)i.push(new c(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},p.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[t,i,n,r]},p.prototype.toGeoJSON=h.prototype.toGeoJSON;var m=e.pbf,v=d;function g(e){var t=new m;return function(e,t){for(var n in e.layers)t.writeMessage(3,y,e.layers[n])}(e,t),t.finish()}function y(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)i.feature=e.feature(n),t.writeMessage(2,_,i);var r=i.keys;for(n=0;n<r.length;n++)t.writeStringField(3,r[n]);var a=i.values;for(n=0;n<a.length;n++)t.writeMessage(4,C,a[n])}function _(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,x,e),t.writeVarintField(3,n.type),t.writeMessage(4,k,n)}function x(e,t){var n=e.feature,i=e.keys,r=e.values,a=e.keycache,o=e.valuecache;for(var s in n.properties){var l=n.properties[s],u=a[s];if(null!==l){void 0===u&&(i.push(s),a[s]=u=i.length-1),t.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,d=o[h];void 0===d&&(r.push(l),o[h]=d=r.length-1),t.writeVarint(d)}}}function b(e,t){return(t<<3)+(7&e)}function w(e){return e<<1^e>>31}function k(e,t){for(var n=e.loadGeometry(),i=e.type,r=0,a=0,o=n.length,s=0;s<o;s++){var l=n[s],u=1;1===i&&(u=l.length),t.writeVarint(b(1,u));for(var c=3===i?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==i&&t.writeVarint(b(2,c-1));var d=l[h].x-r,f=l[h].y-a;t.writeVarint(w(d)),t.writeVarint(w(f)),r+=d,a+=f}3===i&&t.writeVarint(b(7,1))}}function C(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}u.exports=g,u.exports.fromVectorTileJs=g,u.exports.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var i in e)n[i]=new v(e[i].features,t),n[i].name=i,n[i].version=t.version,n[i].extent=t.extent;return g({layers:n})},u.exports.GeoJSONWrapper=v;var S,T=e.getDefaultExportFromCjs(u.exports),E={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},P=Math.fround||(S=new Float32Array(1),function(e){return S[0]=+e,S[0]}),M=function(){function t(e){_classCallCheck(this,t),this.options=Object.assign(Object.create(E),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}return _createClass(t,[{key:"load",value:function(e){var t=this.options,n=t.log,i=t.minZoom,r=t.maxZoom;n&&console.time("total time");var a="prepare ".concat(e.length," points");n&&console.time(a),this.points=e;for(var o=[],s=0;s<e.length;s++){var l=e[s];if(l.geometry){var u=_slicedToArray(l.geometry.coordinates,2),c=u[0],h=u[1],d=P(R(c)),f=P(O(h));o.push(d,f,1/0,s,-1,1),this.options.reduce&&o.push(0)}}var p=this.trees[r+1]=this._createTree(o);n&&console.timeEnd(a);for(var m=r;m>=i;m--){var v=+Date.now();p=this.trees[m]=this._createTree(this._cluster(p,m)),n&&console.log("z%d: %d clusters in %dms",m,p.numItems,+Date.now()-v)}return n&&console.timeEnd("total time"),this}},{key:"getClusters",value:function(e,t){var n=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),r=180===e[2]?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,r=180;else if(n>r){var o=this.getClusters([n,i,180,a],t),s=this.getClusters([-180,i,r,a],t);return o.concat(s)}var l,u=this.trees[this._limitZoom(t)],c=u.range(R(n),O(a),R(r),O(i)),h=u.data,d=[],f=_createForOfIteratorHelper(c);try{for(f.s();!(l=f.n()).done;){var p=l.value,m=this.stride*p;d.push(h[m+5]>1?I(h,m,this.clusterProps):this.points[h[m+3]])}}catch(v){f.e(v)}finally{f.f()}return d}},{key:"getChildren",value:function(e){var t=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);var a=r.data;if(t*this.stride>=a.length)throw new Error(i);var o,s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=[],u=_createForOfIteratorHelper(r.within(a[t*this.stride],a[t*this.stride+1],s));try{for(u.s();!(o=u.n()).done;){var c=o.value*this.stride;a[c+4]===e&&l.push(a[c+5]>1?I(a,c,this.clusterProps):this.points[a[c+3]])}}catch(h){u.e(h)}finally{u.f()}if(0===l.length)throw new Error(i);return l}},{key:"getLeaves",value:function(e,t,n){var i=[];return this._appendLeaves(i,e,t=t||10,n=n||0,0),i}},{key:"getTile",value:function(e,t,n){var i=this.trees[this._limitZoom(e)],r=Math.pow(2,e),a=this.options,o=a.extent,s=a.radius/o,l=(n-s)/r,u=(n+1+s)/r,c={features:[]};return this._addTileFeatures(i.range((t-s)/r,l,(t+1+s)/r,u),i.data,t,n,r,c),0===t&&this._addTileFeatures(i.range(1-s/r,l,1,u),i.data,r,n,r,c),t===r-1&&this._addTileFeatures(i.range(0,l,s/r,u),i.data,-1,n,r,c),c.features.length?c:null}},{key:"getClusterExpansionZoom",value:function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}},{key:"_appendLeaves",value:function(e,t,n,i,r){var a,o=_createForOfIteratorHelper(this.getChildren(t));try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.properties;if(l&&l.cluster?r+l.point_count<=i?r+=l.point_count:r=this._appendLeaves(e,l.cluster_id,n,i,r):r<i?r++:e.push(s),e.length===n)break}}catch(u){o.e(u)}finally{o.f()}return r}},{key:"_createTree",value:function(t){for(var n=new e.KDBush(t.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<t.length;i+=this.stride)n.add(t[i],t[i+1]);return n.finish(),n.data=t,n}},{key:"_addTileFeatures",value:function(e,t,n,i,r,a){var o,s=_createForOfIteratorHelper(e);try{for(s.s();!(o=s.n()).done;){var l=o.value*this.stride,u=t[l+5]>1,c=void 0,h=void 0,d=void 0;if(u)c=A(t,l,this.clusterProps),h=t[l],d=t[l+1];else{var f=this.points[t[l+3]];c=f.properties;var p=_slicedToArray(f.geometry.coordinates,2),m=p[0],v=p[1];h=R(m),d=O(v)}var g,y={type:1,geometry:[[Math.round(this.options.extent*(h*r-n)),Math.round(this.options.extent*(d*r-i))]],tags:c};void 0!==(g=u||this.options.generateId?t[l+3]:this.points[t[l+3]].id)&&(y.id=g),a.features.push(y)}}catch(_){s.e(_)}finally{s.f()}}},{key:"_limitZoom",value:function(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}},{key:"_cluster",value:function(e,t){for(var n=this.options,i=n.radius,r=n.extent,a=n.reduce,o=n.minPoints,s=i/(r*Math.pow(2,t)),l=e.data,u=[],c=this.stride,h=0;h<l.length;h+=c)if(!(l[h+2]<=t)){l[h+2]=t;var d,f=l[h],p=l[h+1],m=e.within(l[h],l[h+1],s),v=l[h+5],g=v,y=_createForOfIteratorHelper(m);try{for(y.s();!(d=y.n()).done;){var _=d.value*c;l[_+2]>t&&(g+=l[_+5])}}catch(N){y.e(N)}finally{y.f()}if(g>v&&g>=o){var x,b=void 0,w=f*v,k=p*v,C=-1,S=((h/c|0)<<5)+(t+1)+this.points.length,T=_createForOfIteratorHelper(m);try{for(T.s();!(x=T.n()).done;){var E=x.value*c;if(!(l[E+2]<=t)){l[E+2]=t;var P=l[E+5];w+=l[E]*P,k+=l[E+1]*P,l[E+4]=S,a&&(b||(b=this._map(l,h,!0),C=this.clusterProps.length,this.clusterProps.push(b)),a(b,this._map(l,E)))}}}catch(N){T.e(N)}finally{T.f()}l[h+4]=S,u.push(w/g,k/g,1/0,S,-1,g),a&&u.push(C)}else{for(var M=0;M<c;M++)u.push(l[h+M]);if(g>1){var I,A=_createForOfIteratorHelper(m);try{for(A.s();!(I=A.n()).done;){var R=I.value*c;if(!(l[R+2]<=t)){l[R+2]=t;for(var O=0;O<c;O++)u.push(l[R+O])}}}catch(N){A.e(N)}finally{A.f()}}}}return u}},{key:"_getOriginId",value:function(e){return e-this.points.length>>5}},{key:"_getOriginZoom",value:function(e){return(e-this.points.length)%32}},{key:"_map",value:function(e,t,n){if(e[t+5]>1){var i=this.clusterProps[e[t+6]];return n?Object.assign({},i):i}var r=this.points[e[t+3]].properties,a=this.options.map(r);return n&&a===r?Object.assign({},a):a}}]),t}();function I(e,t,n){return{type:"Feature",id:e[t+3],properties:A(e,t,n),geometry:{type:"Point",coordinates:[(i=e[t],360*(i-.5)),N(e[t+1])]}};var i}function A(e,t,n){var i=e[t+5],r=i>=1e4?Math.round(i/1e3)+"k":i>=1e3?Math.round(i/100)/10+"k":i,a=e[t+6],o=-1===a?{}:Object.assign({},n[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+3],point_count:i,point_count_abbreviated:r})}function R(e){return e/360+.5}function O(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function N(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function D(e,t,n,i,r,a){var o=r-n,s=a-i;if(0!==o||0!==s){var l=((e-n)*o+(t-i)*s)/(o*o+s*s);l>1?(n=r,i=a):l>0&&(n+=o*l,i+=s*l)}return(o=e-n)*o+(s=t-i)*s}function z(e,t,n,i){var r={id:void 0===e?null:e,type:t,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,n=e.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)L(e,t);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<t.length;i++)L(e,t[i]);else if("MultiPolygon"===n)for(i=0;i<t.length;i++)for(var r=0;r<t[i].length;r++)L(e,t[i][r])}(r),r}function L(e,t){for(var n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function B(e,t,n,i){if(t.geometry){var r=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=t.id;if(n.promoteId?l=t.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===a)F(r,s);else if("MultiPoint"===a)for(var u=0;u<r.length;u++)F(r[u],s);else if("LineString"===a)j(r,s,o,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(u=0;u<r.length;u++)j(r[u],s=[],o,!1),e.push(z(l,"LineString",s,t.properties));return}H(r,s,o,!1)}else if("Polygon"===a)H(r,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(u=0;u<t.geometry.geometries.length;u++)B(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<r.length;u++){var c=[];H(r[u],c,o,!0),s.push(c)}}e.push(z(l,a,s,t.properties))}}function F(e,t){t.push(V(e[0])),t.push(U(e[1])),t.push(0)}function j(e,t,n,i){for(var r,a,o=0,s=0;s<e.length;s++){var l=V(e[s][0]),u=U(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(o+=i?(r*u-l*a)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-a,2))),r=l,a=u}var c=t.length-3;t[2]=1,function e(t,n,i,r){for(var a,o=r,s=i-n>>1,l=i-n,u=t[n],c=t[n+1],h=t[i],d=t[i+1],f=n+3;f<i;f+=3){var p=D(t[f],t[f+1],u,c,h,d);if(p>o)a=f,o=p;else if(p===o){var m=Math.abs(f-s);m<l&&(a=f,l=m)}}o>r&&(a-n>3&&e(t,n,a,r),t[a+2]=o,i-a>3&&e(t,a,i,r))}(t,0,c,n),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function H(e,t,n,i){for(var r=0;r<e.length;r++){var a=[];j(e[r],a,n,i),t.push(a)}}function V(e){return e/360+.5}function U(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function q(e,t,n,i,r,a,o,s){if(i/=t,a>=(n/=t)&&o<i)return e;if(o<n||a>=i)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],h=c.geometry,d=c.type,f=0===r?c.minX:c.minY,p=0===r?c.maxX:c.maxY;if(f>=n&&p<i)l.push(c);else if(!(p<n||f>=i)){var m=[];if("Point"===d||"MultiPoint"===d)G(h,m,n,i,r);else if("LineString"===d)W(h,m,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===d)X(h,m,n,i,r,!1);else if("Polygon"===d)X(h,m,n,i,r,!0);else if("MultiPolygon"===d)for(var v=0;v<h.length;v++){var g=[];X(h[v],g,n,i,r,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===d){for(v=0;v<m.length;v++)l.push(z(c.id,d,m[v],c.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(z(c.id,d,m,c.tags))}}}return l.length?l:null}function G(e,t,n,i,r){for(var a=0;a<e.length;a+=3){var o=e[a+r];o>=n&&o<=i&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function W(e,t,n,i,r,a,o){for(var s,l,u=Z(e),c=0===r?Y:J,h=e.start,d=0;d<e.length-3;d+=3){var f=e[d],p=e[d+1],m=e[d+2],v=e[d+3],g=e[d+4],y=0===r?f:p,_=0===r?v:g,x=!1;o&&(s=Math.sqrt(Math.pow(f-v,2)+Math.pow(p-g,2))),y<n?_>n&&(l=c(u,f,p,v,g,n),o&&(u.start=h+s*l)):y>i?_<i&&(l=c(u,f,p,v,g,i),o&&(u.start=h+s*l)):K(u,f,p,m),_<n&&y>=n&&(l=c(u,f,p,v,g,n),x=!0),_>i&&y<=i&&(l=c(u,f,p,v,g,i),x=!0),!a&&x&&(o&&(u.end=h+s*l),t.push(u),u=Z(e)),o&&(h+=s)}var b=e.length-3;f=e[b],p=e[b+1],m=e[b+2],(y=0===r?f:p)>=n&&y<=i&&K(u,f,p,m),b=u.length-3,a&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&K(u,u[0],u[1],u[2]),u.length&&t.push(u)}function Z(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function X(e,t,n,i,r,a){for(var o=0;o<e.length;o++)W(e[o],t,n,i,r,a,!1)}function K(e,t,n,i){e.push(t),e.push(n),e.push(i)}function Y(e,t,n,i,r,a){var o=(a-t)/(i-t);return e.push(a),e.push(n+(r-n)*o),e.push(1),o}function J(e,t,n,i,r,a){var o=(a-n)/(r-n);return e.push(t+(i-t)*o),e.push(a),e.push(1),o}function Q(e,t){for(var n=[],i=0;i<e.length;i++){var r,a=e[i],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=$(a.geometry,t);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var s=0;s<a.geometry.length;s++)r.push($(a.geometry[s],t))}else if("MultiPolygon"===o)for(r=[],s=0;s<a.geometry.length;s++){for(var l=[],u=0;u<a.geometry[s].length;u++)l.push($(a.geometry[s][u],t));r.push(l)}n.push(z(a.id,o,r,a.tags))}return n}function $(e,t){var n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(var i=0;i<e.length;i+=3)n.push(e[i]+t,e[i+1],e[i+2]);return n}function ee(e,t){if(e.transformed)return e;var n,i,r,a=1<<e.z,o=e.x,s=e.y;for(n=0;n<e.features.length;n++){var l=e.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(te(u[i],u[i+1],t,a,o,s));else for(i=0;i<u.length;i++){var h=[];for(r=0;r<u[i].length;r+=2)h.push(te(u[i][r],u[i][r+1],t,a,o,s));l.geometry.push(h)}}return e.transformed=!0,e}function te(e,t,n,i,r,a){return[Math.round(n*(e*i-r)),Math.round(n*(t*i-a))]}function ne(e,t,n,i,r){for(var a=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,ie(o,e[s],a,r);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,h=e[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),h>o.maxY&&(o.maxY=h)}return o}function ie(e,t,n,i){var r=t.geometry,a=t.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<r.length;s+=3)o.push(r[s]),o.push(r[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)re(o,r,e,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<r.length;s++)re(o,r[s],e,n,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)re(o,u[s],e,n,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===a&&i.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==t.id&&(d.id=t.id),e.features.push(d)}}function re(e,t,n,i,r,a){var o=i*i;if(i>0&&t.size<(r?o:i))n.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>o)&&(n.numSimplified++,s.push(t[l]),s.push(t[l+1])),n.numPoints++;r&&function(e,t){for(var n=0,i=0,r=e.length,a=r-2;i<r;a=i,i+=2)n+=(e[i]-e[a])*(e[i+1]+e[a+1]);if(n>0===t)for(i=0,r=e.length;i<r/2;i+=2){var o=e[i],s=e[i+1];e[i]=e[r-2-i],e[i+1]=e[r-1-i],e[r-2-i]=o,e[r-1-i]=s}}(s,a),e.push(s)}}function ae(e,t){var n=(t=this.options=function(e,t){for(var n in t)e[n]=t[n];return e}(Object.create(this.options),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(e,t){var n=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)B(n,e.features[i],t,i);else B(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(e,t){var n=t.buffer/t.extent,i=e,r=q(e,1,-1-n,n,0,-1,2,t),a=q(e,1,1-n,2+n,0,-1,2,t);return(r||a)&&(i=q(e,1,-n,1+n,0,-1,2,t)||[],r&&(i=Q(r,1).concat(i)),a&&(i=i.concat(Q(a,-1)))),i}(i,t)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oe(e,t,n){return 32*((1<<e)*n+t)+e}function se(t,n){var i=t.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);var r=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!r)return n(null,null);var a=new(function(){function t(n){_classCallCheck(this,t),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=n.length,this._features=n}return _createClass(t,[{key:"feature",value:function(t){return new(function(){function t(n){_classCallCheck(this,t),this._feature=n,this.extent=e.EXTENT,this.type=n.type,this.properties=n.tags,"id"in n&&!isNaN(n.id)&&(this.id=parseInt(n.id,10))}return _createClass(t,[{key:"loadGeometry",value:function(){if(1===this._feature.type){var t,n=[],i=_createForOfIteratorHelper(this._feature.geometry);try{for(i.s();!(t=i.n()).done;){var r=t.value;n.push([new e.Point(r[0],r[1])])}}catch(f){i.e(f)}finally{i.f()}return n}var a,o=[],s=_createForOfIteratorHelper(this._feature.geometry);try{for(s.s();!(a=s.n()).done;){var l,u=a.value,c=[],h=_createForOfIteratorHelper(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;c.push(new e.Point(d[0],d[1]))}}catch(f){h.e(f)}finally{h.f()}o.push(c)}}catch(f){s.e(f)}finally{s.f()}return o}},{key:"toGeoJSON",value:function(e,t,n){return l.call(this,e,t,n)}}]),t}())(this._features[t])}}]),t}())(r.features),o=T(a);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),n(null,{vectorTile:a,rawData:o.buffer})}ae.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ae.prototype.splitTile=function(e,t,n,i,r,a,o){for(var s=[e,t,n,i],l=this.options,u=l.debug;s.length;){i=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,h=oe(t,n,i),d=this.tiles[h];if(!d&&(u>1&&console.time("creation"),d=this.tiles[h]=ne(e,t,n,i,l),this.tileCoords.push({z:t,x:n,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var f="z"+t;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(d.source=e,r){if(t===l.maxZoom||t===r)continue;var p=1<<r-t;if(n!==Math.floor(a/p)||i!==Math.floor(o/p))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){u>1&&console.time("clipping");var m,v,g,y,_,x,b=.5*l.buffer/l.extent,w=.5-b,k=.5+b,C=1+b;m=v=g=y=null,_=q(e,c,n-b,n+k,0,d.minX,d.maxX,l),x=q(e,c,n+w,n+C,0,d.minX,d.maxX,l),e=null,_&&(m=q(_,c,i-b,i+k,1,d.minY,d.maxY,l),v=q(_,c,i+w,i+C,1,d.minY,d.maxY,l),_=null),x&&(g=q(x,c,i-b,i+k,1,d.minY,d.maxY,l),y=q(x,c,i+w,i+C,1,d.minY,d.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*n,2*i),s.push(v||[],t+1,2*n,2*i+1),s.push(g||[],t+1,2*n+1,2*i),s.push(y||[],t+1,2*n+1,2*i+1)}}},ae.prototype.getTile=function(e,t,n){var i=this.options,r=i.extent,a=i.debug;if(e<0||e>24)return null;var o=1<<e,s=oe(e,t=(t%o+o)%o,n);if(this.tiles[s])return ee(this.tiles[s],r);a>1&&console.log("drilling down to z%d-%d-%d",e,t,n);for(var l,u=e,c=t,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[oe(u,c,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",u,c,h),a>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,n),a>1&&console.timeEnd("drilling down"),this.tiles[s]?ee(this.tiles[s],r):null):null};var le=function(t){function n(e,t,i,r,a){var o;return _classCallCheck(this,n),o=_callSuper(this,n,[e,t,i,r,se]),a&&(o.loadGeoJSON=a),o}return _inherits(n,t),_createClass(n,[{key:"loadData",value:function(t,n){var i=this,r=t&&t.request,a=r&&r.collectResourceTiming;this.loadGeoJSON(t,(function(o,l){if(o||!l)return n(o);if("object"!=typeof l)return n(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));s(l,!0);try{if(t.filter){var u=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===u.result)throw new Error(u.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));var c=l.features.filter((function(e){return u.value.evaluate({zoom:0},e)}));l={type:"FeatureCollection",features:c}}i._geoJSONIndex=t.cluster?new M(function(t){var n=t.superclusterOptions,i=t.clusterProperties;if(!i||!n)return n;for(var r={},a={},o={accumulated:null,zoom:0},s={properties:null},l=Object.keys(i),u=0,c=l;u<c.length;u++){var h=c[u],d=_slicedToArray(i[h],2),f=d[0],p=d[1],m=e.createExpression(p),v=e.createExpression("string"==typeof f?[f,["accumulated"],["get",h]]:f);r[h]=m.value,a[h]=v.value}return n.map=function(e){s.properties=e;for(var t={},n=0,i=l;n<i.length;n++){var a=i[n];t[a]=r[a].evaluate(o,s)}return t},n.reduce=function(e,t){s.properties=t;for(var n=0,i=l;n<i.length;n++){var r=i[n];o.accumulated=e[r],e[r]=a[r].evaluate(o,s)}},n}(t)).load(l.features):function(e,t){return new ae(e,t)}(l,t.geojsonVtOptions)}catch(o){return n(o)}i.loaded={};var h={};if(a){var d=e.getPerformanceMeasurement(r);d&&(h.resourceTiming={},h.resourceTiming[t.source]=JSON.parse(JSON.stringify(d)))}n(null,h)}))}},{key:"reloadTile",value:function(e,t){var i=this.loaded;return i&&i[e.uid]?_get(_getPrototypeOf2(n.prototype),"reloadTile",this).call(this,e,t):this.loadTile(e,t)}},{key:"loadGeoJSON",value:function(t,n){if(t.request)e.getJSON(t.request,n);else{if("string"!=typeof t.data)return n(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));try{return n(null,JSON.parse(t.data))}catch(e){return n(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")))}}}},{key:"getClusterExpansionZoom",value:function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}},{key:"getClusterChildren",value:function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}},{key:"getClusterLeaves",value:function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}]),n}(e.VectorTileWorkerSource),ue=function(){function t(n){var i=this;_classCallCheck(this,t),this.self=n,this.actor=new e.Actor(n,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:le},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(i.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));i.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}return _createClass(t,[{key:"clearCaches",value:function(e,t,n){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],n()}},{key:"checkIfReady",value:function(e,t,n){n()}},{key:"setReferrer",value:function(e,t){this.referrer=t}},{key:"spriteLoaded",value:function(t,n){for(var i in this.isSpriteLoaded[t]=n,this.workerSources[t]){var r=this.workerSources[t][i];for(var a in r)r[a]instanceof e.VectorTileWorkerSource&&(r[a].isSpriteLoaded=n,r[a].fire(new e.Event("isSpriteLoaded")))}}},{key:"setImages",value:function(e,t,n){for(var i in this.availableImages[e]=t,this.workerSources[e]){var r=this.workerSources[e][i];for(var a in r)r[a].availableImages=t}n()}},{key:"enableTerrain",value:function(e,t,n){this.terrain=t,n()}},{key:"setProjection",value:function(t,n){this.projections[t]=e.getProjection(n)}},{key:"setLayers",value:function(e,t,n){this.getLayerIndex(e).replace(t),n()}},{key:"updateLayers",value:function(e,t,n){this.getLayerIndex(e).update(t.layers,t.removedIds),n()}},{key:"loadTile",value:function(t,n,i){var r=this.enableTerrain?e.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,n.type,n.source).loadTile(r,i)}},{key:"loadDEMTile",value:function(t,n,i){var r=this.enableTerrain?e.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(t,n.source).loadTile(r,i)}},{key:"reloadTile",value:function(t,n,i){var r=this.enableTerrain?e.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,n.type,n.source).reloadTile(r,i)}},{key:"abortTile",value:function(e,t,n){this.getWorkerSource(e,t.type,t.source).abortTile(t,n)}},{key:"removeTile",value:function(e,t,n){this.getWorkerSource(e,t.type,t.source).removeTile(t,n)}},{key:"removeSource",value:function(e,t,n){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var i=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==i.removeSource?i.removeSource(t,n):n()}}},{key:"loadWorkerSource",value:function(e,t,n){try{this.self.importScripts(t.url),n()}catch(e){n(e.toString())}}},{key:"syncRTLPluginState",value:function(t,n,i){try{e.plugin.setState(n);var r=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=r){this.self.importScripts(r);var a=e.plugin.isParsed();i(a?void 0:new Error("RTL Text Plugin failed to import scripts from "+r),a)}}catch(e){i(e.toString())}}},{key:"getAvailableImages",value:function(e){var t=this.availableImages[e];return t||(t=[]),t}},{key:"getLayerIndex",value:function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new i),t}},{key:"getWorkerSource",value:function(e,t,n){var i=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][n]||(this.workerSources[e][t][n]=new this.workerSourceTypes[t]({send:function(t,n,r,a,o,s){i.actor.send(t,n,r,e,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])),this.workerSources[e][t][n]}},{key:"getDEMWorkerSource",value:function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new r),this.demWorkerSources[e][t]}},{key:"enforceCacheSizeLimit",value:function(t,n){e.enforceCacheSizeLimit(n)}},{key:"getWorkerPerformanceMetrics",value:function(e,t,n){n(void 0,void 0)}}]),t}();return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ue(self)),ue})),i(0,(function(e){function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var r in e)if(!t(e[r],n[r]))return!1;return!0}return e===n}var n=i;function i(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{t=new Worker(i),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(i),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var n=t.getImageData(0,0,1,1);return n&&n.width===e.width}()?(void 0===r[t=e&&e.failIfMajorPerformanceCaveat]&&(r[t]=function(e){var t,n=function(e){var t=document.createElement("canvas"),n=Object.create(i.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,t.getContext("webgl",n)||t.getContext("experimental-webgl",n)}(e);if(!n)return!1;try{t=n.createShader(n.VERTEX_SHADER)}catch(e){return!1}return!(!t||n.isContextLost())&&(n.shaderSource(t,"void main() {}"),n.compileShader(t),!0===n.getShaderParameter(t,n.COMPILE_STATUS))}(t)),r[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var r={};function a(t,n,i){var r=e.window.document.createElement(t);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r}function o(t,n,i){for(var r=e.window.document.createElementNS("http://www.w3.org/2000/svg",t),a=0,o=Object.keys(n);a<o.length;a++){var s=o[a];r.setAttributeNS(null,s,n[s])}return i&&i.appendChild(r),r}i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var s,l=e.window.document&&e.window.document.documentElement.style,u=l&&void 0!==l.userSelect?"userSelect":"WebkitUserSelect";function c(){l&&u&&(s=l[u],l[u]="none")}function h(){l&&u&&(l[u]=s)}function d(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",d,!0)}function f(){e.window.addEventListener("click",d,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",d,!0)}),0)}function p(e,t){var n=e.getBoundingClientRect();return g(e,n,t)}function m(e,t){for(var n=e.getBoundingClientRect(),i=[],r=0;r<t.length;r++)i.push(g(e,n,t[r]));return i}function v(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function g(t,n,i){var r=t.offsetWidth===n.width?1:t.offsetWidth/n.width;return new e.Point((i.clientX-n.left)*r,(i.clientY-n.top)*r)}function y(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=n*a-r*i;return o?(e[0]=a*(o=1/o),e[1]=-i*o,e[2]=-r*o,e[3]=n*o,e):null}function _(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}var x=function(t){function n(){var t;return _classCallCheck(this,n),(t=_callSuper(this,n)).images={},t.updatedImages={},t.callbackDispatchedThisFrame={},t.loaded=!1,t.requestors=[],t.patterns={},t.atlasImage=new e.RGBAImage({width:1,height:1}),t.dirty=!0,t}return _inherits(n,t),_createClass(n,[{key:"isLoaded",value:function(){return this.loaded}},{key:"setLoaded",value:function(e){if(this.loaded!==e&&(this.loaded=e,e)){var t,n=_createForOfIteratorHelper(this.requestors);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.ids,a=i.callback;this._notify(r,a)}}catch(o){n.e(o)}finally{n.f()}this.requestors=[]}}},{key:"hasImage",value:function(e){return!!this.getImage(e)}},{key:"getImage",value:function(e){return this.images[e]}},{key:"addImage",value:function(e,t){this._validate(e,t)&&(this.images[e]=t)}},{key:"_validate",value:function(t,n){var i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),i=!1),this._validateContent(n.content,n)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "content" value')))),i=!1),i}},{key:"_validateStretch",value:function(e,t){if(!e)return!0;var n,i=0,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a[0]<i||a[1]<a[0]||t<a[1])return!1;i=a[1]}}catch(o){r.e(o)}finally{r.f()}return!0}},{key:"_validateContent",value:function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}},{key:"updateImage",value:function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}},{key:"removeImage",value:function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}},{key:"listImages",value:function(){return Object.keys(this.images)}},{key:"getImages",value:function(e,t){var n=!0;if(!this.isLoaded()){var i,r=_createForOfIteratorHelper(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.images[a]||(n=!1)}}catch(o){r.e(o)}finally{r.f()}}this.isLoaded()||n?this._notify(e,t):this.requestors.push({ids:e,callback:t})}},{key:"_notify",value:function(t,n){var i,r={},a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.images[o]||this.fire(new e.Event("styleimagemissing",{id:o}));var s=this.images[o];s?r[o]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'.concat(o,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}}catch(l){a.e(l)}finally{a.f()}n(null,r)}},{key:"getPixelSize",value:function(){var e=this.atlasImage;return{width:e.width,height:e.height}}},{key:"getPattern",value:function(t){var n=this.patterns[t],i=this.getImage(t);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{var r={w:i.data.width+2,h:i.data.height+2,x:0,y:0},a=new e.ImagePosition(r,i);this.patterns[t]={bin:r,position:a}}return this._updatePatternAtlas(),this.patterns[t].position}},{key:"bind",value:function(t){var n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,n.RGBA),this.atlasTexture&&this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}},{key:"_updatePatternAtlas",value:function(){var t=[];for(var n in this.patterns)t.push(this.patterns[n].bin);var i=e.potpack(t),r=i.w,a=i.h,o=this.atlasImage;for(var s in o.resize({width:r||1,height:a||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,h=this.images[s].data,d=h.width,f=h.height;e.RGBAImage.copy(h,o,{x:0,y:0},{x:u,y:c},{width:d,height:f}),e.RGBAImage.copy(h,o,{x:0,y:f-1},{x:u,y:c-1},{width:d,height:1}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:u,y:c+f},{width:d,height:1}),e.RGBAImage.copy(h,o,{x:d-1,y:0},{x:u-1,y:c},{width:1,height:f}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:u+d,y:c},{width:1,height:f})}this.dirty=!0}},{key:"beginFrame",value:function(){this.callbackDispatchedThisFrame={}}},{key:"dispatchRenderCallbacks",value:function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var r=this.images[i];_(r)&&this.updateImage(i,r)}}}catch(a){n.e(a)}finally{n.f()}}}]),n}(e.Evented),b=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new(function(){function t(){_classCallCheck(this,t),this.specification=e.spec.light.position}return _createClass(t,[{key:"possiblyEvaluate",value:function(t,n){return function(t){var n=_slicedToArray(t,3),i=n[0],r=n[1],a=n[2],o=e.degToRad(r+90),s=e.degToRad(a);return{x:i*Math.cos(o)*Math.sin(s),y:i*Math.sin(o)*Math.sin(s),z:i*Math.cos(s),azimuthal:r,polar:a}}(t.expression.evaluate(n))}},{key:"interpolate",value:function(t,n,i){return{x:e.number(t.x,n.x,i),y:e.number(t.y,n.y,i),z:e.number(t.z,n.z,i),azimuthal:e.number(t.azimuthal,n.azimuthal,i),polar:e.number(t.polar,n.polar,i)}}}]),t}()),color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)}),w=function(t){function n(t){var i;return _classCallCheck(this,n),(i=_callSuper(this,n))._transitionable=new e.Transitionable(b),i.setLight(t),i._transitioning=i._transitionable.untransitioned(),i}return _inherits(n,t),_createClass(n,[{key:"getLight",value:function(){return this._transitionable.serialize()}},{key:"setLight",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateLight,t,n))for(var i in t){var r=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),r):this._transitionable.setValue(i,r)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,n,i){return(!i||!1!==i.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}]),n}(e.Evented),k=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)}),C=function(t){function n(t,i){var r;return _classCallCheck(this,n),(r=_callSuper(this,n))._transitionable=new e.Transitionable(k),r.set(t),r._transitioning=r._transitionable.untransitioned(),r.drapeRenderMode=i,r}return _inherits(n,t),_createClass(n,[{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){for(var n in t){var i=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),i):this._transitionable.setValue(n,i)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}}]),n}(e.Evented);function S(t,n,i,r){var a=e.smoothstep(45,65,i),o=_slicedToArray(T(t,r),2),s=o[0],l=o[1],u=e.length(n),c=1-Math.min(1,Math.exp((u-s)/(l-s)*-6));return c*=c*c,(c=Math.min(1,1.00747*c))*a*t.alpha}function T(e,t){var n=.5/Math.tan(.5*t);return[e.range[0]+n,e.range[1]+n]}var E=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])}),P=function(t){function n(t,i){var r;return _classCallCheck(this,n),(r=_callSuper(this,n))._transitionable=new e.Transitionable(E),r.set(t),r._transitioning=r._transitionable.untransitioned(),r._transform=i,r}return _inherits(n,t),_createClass(n,[{key:"state",get:function(){var t=this._transform,n="globe"===t.projection.name,i=e.globeToMercatorTransition(t.zoom),r=this.properties.get("range"),a=[.5,3];return{range:n?[e.number(a[0],r[0],i),e.number(a[1],r[1],i)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}},{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateFog,t,n)){for(var i=0,r=Object.keys(e.spec.fog);i<r.length;i++){var a=r[i];t&&void 0===t[a]&&(t[a]=e.spec.fog[a].default)}for(var o in t){var s=t[o];e.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),s):this._transitionable.setValue(o,s)}}}},{key:"getOpacity",value:function(t){if(!this._transform.projection.supportsFog)return 0;var n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*n.a}},{key:"getOpacityAtLatLng",value:function(t,n){return this._transform.projection.supportsFog?function(t,n,i){var r=e.MercatorCoordinate.fromLngLat(n),a=i.elevation?i.elevation.getAtPointOrZero(r):0,o=[r.x,r.y,a];return e.transformMat4(o,o,i.mercatorFogMatrix),S(t,o,i.pitch,i._fov)}(this.state,t,n):0}},{key:"getFovAdjustedRange",value:function(e){return this._transform.projection.supportsFog?T(this.state,e):[0,1]}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,n,i){return(!i||!1!==i.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}]),n}(e.Evented),M=function(){function t(n,i){var r=this;_classCallCheck(this,t),this.workerPool=n,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var a=this.workerPool.acquire(this.id),o=0;o<a.length;o++){var s=new t.Actor(a[o],i,this.id);s.name="Worker "+o,this.actors.push(s)}this.ready=!1,this.broadcast("checkIfReady",null,(function(){r.ready=!0}))}return _createClass(t,[{key:"broadcast",value:function(t,n,i){e.asyncAll(this.actors,(function(e,i){e.send(t,n,i)}),i=i||function(){})}},{key:"getActor",value:function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}},{key:"remove",value:function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)}}]),t}();function I(t,n,i){return n*(e.EXTENT/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}M.Actor=e.Actor;var A=function(){function t(e,n,i,r){_classCallCheck(this,t),this.screenBounds=e,this.cameraPoint=n,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,r)}return _createClass(t,[{key:"isPointQuery",value:function(){return 1===this.screenBounds.length}},{key:"bufferedScreenGeometry",value:function(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}},{key:"bufferedCameraGeometry",value:function(t){var n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?r[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(r[3]=this.cameraPoint)),e.bufferConvexPolygon(r,t)}},{key:"bufferedCameraGeometryGlobe",value:function(t){var n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(n,i,t),a=this.cameraPoint.clone();switch(3*((a.y>n.y)+(a.y>i.y))+((a.x>n.x)+(a.x>i.x))){case 0:r[0]=a,r[4]=a.clone();break;case 1:r.splice(1,0,a);break;case 2:r[1]=a;break;case 3:r.splice(4,0,a);break;case 5:r.splice(2,0,a);break;case 6:r[3]=a;break;case 7:r.splice(3,0,a);break;case 8:r[2]=a}return r}},{key:"containsTile",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.queryPadding/n._pixelsPerMercatorPixel+1,o=i?this._bufferedCameraMercator(a,n):this._bufferedScreenMercator(a,n),s=t.tileID.wrap+(o.unwrapped?r:0),l=o.polygon.map((function(n){return e.getTilePoint(t.tileTransform,n,s)}));if(e.polygonIntersectsBox(l,0,0,e.EXTENT,e.EXTENT)){s=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);var u,c=this.screenGeometryMercator.polygon.map((function(n){return e.getTileVec3(t.tileTransform,n,s)})),h=c.map((function(t){return new e.Point(t[0],t[1])})),d=n.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),f=e.getTileVec3(t.tileTransform,d,s),p=c.map((function(t){var n=e.sub(t,t,f);return e.normalize(n,n),new e.Ray(f,n)})),m=I(t,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:h,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(u=e.getBounds(l),u.min.x=e.clamp(u.min.x,0,e.EXTENT),u.min.y=e.clamp(u.min.y,0,e.EXTENT),u.max.x=e.clamp(u.max.x,0,e.EXTENT),u.max.y=e.clamp(u.max.y,0,e.EXTENT),u),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:m}}}},{key:"_bufferedScreenMercator",value:function(e,t){var n,i=N(e);return this._screenRaycastCache[i]?this._screenRaycastCache[i]:(n="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((function(e){return t.pointCoordinate3D(e)})),unwrapped:!0},this._screenRaycastCache[i]=n,n)}},{key:"_bufferedCameraMercator",value:function(e,t){var n,i=N(e);return this._cameraRaycastCache[i]?this._cameraRaycastCache[i]:(n="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((function(e){return t.pointCoordinate3D(e)})),unwrapped:!0},this._cameraRaycastCache[i]=n,n)}},{key:"_projectAndResample",value:function(t,n){var i=function(t,n){var i=e.multiply([],n.pixelMatrix,n.globeMatrix),r=[0,-e.GLOBE_RADIUS,0,1],a=[0,e.GLOBE_RADIUS,0,1],o=[0,0,0,1];e.transformMat4$1(r,r,i),e.transformMat4$1(a,a,i),e.transformMat4$1(o,o,i);var s=new e.Point(r[0]/r[3],r[1]/r[3]),l=new e.Point(a[0]/a[3],a[1]/a[3]),u=e.polygonContainsPoint(t,s)&&r[3]<o[3],c=e.polygonContainsPoint(t,l)&&a[3]<o[3];if(!u&&!c)return null;var h=function(e,t,n){for(var i=1;i<e.length;i++){var r=O(t.pointCoordinate3D(e[i-1]).x),a=O(t.pointCoordinate3D(e[i]).x);if(n<0){if(r<a)return{idx:i,t:-r/(a-1-r)}}else if(a<r)return{idx:i,t:(1-r)/(a+1-r)}}return null}(t,n,u?-1:1);if(!h)return null;var d=h.idx,f=h.t,p=d>1?R(t.slice(0,d),n):[],m=d<t.length?R(t.slice(d),n):[];p=p.map((function(t){return new e.Point(O(t.x),t.y)})),m=m.map((function(t){return new e.Point(O(t.x),t.y)}));var v=_toConsumableArray(p);0===v.length&&v.push(m[m.length-1]);var g,y=e.number(v[v.length-1].y,(0===m.length?p[0]:m[0]).y,f);return g=u?[new e.Point(0,y),new e.Point(0,0),new e.Point(1,0),new e.Point(1,y)]:[new e.Point(1,y),new e.Point(1,1),new e.Point(0,1),new e.Point(0,y)],v.push.apply(v,_toConsumableArray(g)),0===m.length?v.push(p[0]):v.push.apply(v,_toConsumableArray(m)),{polygon:v.map((function(t){return new e.MercatorCoordinate(t.x,t.y)})),unwrapped:!1}}(t,n);if(i)return i;var r=function(t,n){for(var i=!1,r=-1/0,a=0,o=0;o<t.length-1;o++)t[o].x>r&&(r=t[o].x,a=o);for(var s=0;s<t.length-1;s++){var l=(a+s)%(t.length-1),u=t[l],c=t[l+1];Math.abs(u.x-c.x)>.5&&(u.x<c.x?(u.x+=1,0===l&&(t[t.length-1].x+=1)):(c.x+=1,l+1===t.length-1&&(t[0].x+=1)),i=!0)}var h=e.mercatorXfromLng(n.center.lng);return i&&h<Math.abs(h-1)&&t.forEach((function(e){e.x-=1})),{polygon:t,unwrapped:i}}(R(t,n).map((function(t){return new e.Point(O(t.x),t.y)})),n);return{polygon:r.polygon.map((function(t){return new e.MercatorCoordinate(t.x,t.y)})),unwrapped:r.unwrapped}}}],[{key:"createFromScreenPoints",value:function(n,i){var r,a;if(n instanceof e.Point||"number"==typeof n[0]){var o=e.Point.convert(n);r=[o],a=i.isPointAboveHorizon(o)}else{var s=e.Point.convert(n[0]),l=e.Point.convert(n[1]);r=[s,l],a=e.polygonizeBounds(s,l).every((function(e){return i.isPointAboveHorizon(e)}))}return new t(r,i.getCameraPoint(),a,i)}}]),t}();function R(t,n){return e.resample(t,(function(e){var t=n.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function O(e){return e<0?1+e%1:e%1}function N(e){return 100*e|0}function D(t,n,i,r,a){var o=function(i,r){if(i)return a(i);if(r){t.url&&r.tiles&&t.tiles&&delete t.tiles;var o=e.pick(e.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(o.vectorLayers=r.vector_layers,o.vectorLayerIds=o.vectorLayers.map((function(e){return e.id}))),o.tiles=n.canonicalizeTileset(o,t.url),a(null,o)}};return t.url?e.getJSON(n.transformRequest(n.normalizeSourceURL(t.url,null,i,r),e.ResourceType.Source),o):e.exported.frame((function(){return o(null,t)}))}var z,L=function(){function t(n,i,r){_classCallCheck(this,t),this.bounds=e.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=i||0,this.maxzoom=r||24}return _createClass(t,[{key:"validateBounds",value:function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}},{key:"contains",value:function(t){var n=Math.pow(2,t.z),i=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*n),a=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*n),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*n);return t.x>=i&&t.x<a&&t.y>=r&&t.y<o}}]),t}(),B=function(){function e(t,n,i){_classCallCheck(this,e),this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||n.destroy()}return _createClass(e,[{key:"bind",value:function(){this.context.bindElementBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),F={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},j=function(){function e(t,n,i,r){_classCallCheck(this,e),this.length=n.length,this.attributes=i,this.itemSize=n.bytesPerElement,this.dynamicDraw=r,this.context=t;var a=t.gl;this.buffer=a.createBuffer(),t.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||n.destroy()}return _createClass(e,[{key:"bind",value:function(){this.context.bindVertexBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"enableAttributes",value:function(e,t){for(var n=0;n<this.attributes.length;n++){var i=t.attributes[this.attributes[n].name];void 0!==i&&e.enableVertexAttribArray(i)}}},{key:"setVertexAttribPointers",value:function(e,t,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i],a=t.attributes[r.name];void 0!==a&&e.vertexAttribPointer(a,r.components,e[F[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),H=function(){function e(t){_classCallCheck(this,e),this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}return _createClass(e,[{key:"get",value:function(){return this.current}},{key:"set",value:function(e){}},{key:"getDefault",value:function(){return this.default}},{key:"setDefault",value:function(){this.set(this.default)}}]),e}(),V=function(t){function n(){return _classCallCheck(this,n),_callSuper(this,n,arguments)}return _inherits(n,t),_createClass(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(H),U=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return 1}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}]),t}(H),q=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return 0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}]),t}(H),G=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return[!0,!0,!0,!0]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),t}(H),W=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}]),t}(H),Z=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return 255}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}]),t}(H),X=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return{func:this.gl.ALWAYS,ref:0,mask:255}}},{key:"set",value:function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}]),t}(H),K=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}]),t}(H),Y=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}}]),t}(H),J=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return[0,1]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}]),t}(H),Q=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}}]),t}(H),$=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return this.gl.LESS}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}]),t}(H),ee=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}}]),t}(H),te=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){var e=this.gl;return[e.ONE,e.ZERO]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}]),t}(H),ne=function(t){function n(){return _classCallCheck(this,n),_callSuper(this,n,arguments)}return _inherits(n,t),_createClass(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(H),ie=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return this.gl.FUNC_ADD}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}]),t}(H),re=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}}]),t}(H),ae=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return this.gl.BACK}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}]),t}(H),oe=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return this.gl.CCW}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}]),t}(H),se=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}]),t}(H),le=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return this.gl.TEXTURE0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}]),t}(H),ue=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),t}(H),ce=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}}]),t}(H),he=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),t}(H),de=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}}]),t}(H),fe=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}}]),t}(H),pe=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}]),t}(H),me=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).vao=e.extVertexArrayObject,n}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}]),t}(H),ve=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return 4}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}}]),t}(H),ge=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}}]),t}(H),ye=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}}]),t}(H),_e=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).context=e,i.parent=n,i}return _inherits(t,e),_createClass(t,[{key:"getDefault",value:function(){return null}}]),t}(H),xe=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"setDirty",value:function(){this.dirty=!0}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}}]),t}(_e),be=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"attachment",value:function(){return this.gl.DEPTH_ATTACHMENT}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),t}(_e),we=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"attachment",value:function(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}]),t}(be),ke=function(){function e(t,n,i,r){_classCallCheck(this,e),this.context=t,this.width=n,this.height=i;var a=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new xe(t,a),r&&(this.depthAttachment=new be(t,a))}return _createClass(e,[{key:"destroy",value:function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var n=this.depthAttachment.get();n&&e.deleteRenderbuffer(n)}e.deleteFramebuffer(this.framebuffer)}}]),e}(),Ce=function(){function n(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck(this,n),this.gl=e,this.isWebGL2=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),t){var i=e;this.extVertexArrayObject={createVertexArrayOES:i.createVertexArray.bind(e),deleteVertexArrayOES:i.deleteVertexArray.bind(e),bindVertexArrayOES:i.bindVertexArray.bind(e)}}this.clearColor=new V(this),this.clearDepth=new U(this),this.clearStencil=new q(this),this.colorMask=new G(this),this.depthMask=new W(this),this.stencilMask=new Z(this),this.stencilFunc=new X(this),this.stencilOp=new K(this),this.stencilTest=new Y(this),this.depthRange=new J(this),this.depthTest=new Q(this),this.depthFunc=new $(this),this.blend=new ee(this),this.blendFunc=new te(this),this.blendColor=new ne(this),this.blendEquation=new ie(this),this.cullFace=new re(this),this.cullFaceSide=new ae(this),this.frontFace=new oe(this),this.program=new se(this),this.activeTexture=new le(this),this.viewport=new ue(this),this.bindFramebuffer=new ce(this),this.bindRenderbuffer=new he(this),this.bindTexture=new de(this),this.bindVertexBuffer=new fe(this),this.bindElementBuffer=new pe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new me(this),this.pixelStoreUnpack=new ve(this),this.pixelStoreUnpackPremultiplyAlpha=new ge(this),this.pixelStoreUnpackFlipY=new ye(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),t||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(t||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}return _createClass(n,[{key:"setDefault",value:function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}},{key:"setDirty",value:function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}},{key:"createIndexBuffer",value:function(e,t){return new B(this,e,t)}},{key:"createVertexBuffer",value:function(e,t,n){return new j(this,e,t,n)}},{key:"createRenderbuffer",value:function(e,t,n){var i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),r}},{key:"createFramebuffer",value:function(e,t,n){return new ke(this,e,t,n)}},{key:"clear",value:function(e){var t=e.color,n=e.depth,i=e.stencil,r=this.gl,a=0;t&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==i&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(a)}},{key:"setCullFace",value:function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}},{key:"setDepthMode",value:function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}},{key:"setStencilMode",value:function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}},{key:"setColorMode",value:function(n){t(n.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}},{key:"unbindVAO",value:function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}]),n}(),Se=function(t){function n(t,i,r,a){var o;if(_classCallCheck(this,n),(o=_callSuper(this,n)).id=t,o.dispatcher=r,o.type="vector",o.minzoom=0,o.maxzoom=22,o.scheme="xyz",o.tileSize=512,o.reparseOverscaled=!0,o.isTileClipped=!0,o._loaded=!1,e.extend(_assertThisInitialized2(o),e.pick(i,["url","scheme","tileSize","promoteId"])),o._options=e.extend({type:"vector"},i),o._collectResourceTiming=i.collectResourceTiming,512!==o.tileSize)throw new Error("vector tile sources must have a tileSize of 512");return o.setEventedParent(a),o._tileWorkers={},o._deduped=new e.DedupedRequest,_possibleConstructorReturn(o)}return _inherits(n,t),_createClass(n,[{key:"load",value:function(t){var n=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));var i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=D(this._options,this.map._requestManager,i,r,(function(a,o){n._tileJSONRequest=null,n._loaded=!0,a?(i&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: "+i),r&&2!==r.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: "+r),n.fire(new e.ErrorEvent(a))):o&&(e.extend(n,o),o.bounds&&(n.tileBounds=new L(o.bounds,n.minzoom,n.maxzoom)),e.postTurnstileEvent(o.tiles,n.map._requestManager._customAccessToken),n.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(a)}))}},{key:"loaded",value:function(){return this._loaded}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"reload",value:function(){var e=this;this.cancelTileJSONRequest(),this.load((function(){return e.map.style._clearSource(e.id)}))}},{key:"setTiles",value:function(e){return this._options.tiles=e,this.reload(),this}},{key:"setUrl",value:function(e){return this.url=e,this._options.url=e,this.reload(),this}},{key:"onRemove",value:function(){this.cancelTileJSONRequest()}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"loadTile",value:function(t,n){var i=this,r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(r,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(a.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=n:t.request=t.actor.send("reloadTile",a,s.bind(this));else if(t.actor=this._tileWorkers[r]=this._tileWorkers[r]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",a,s.bind(this),void 0,!0);else{var o=e.loadVectorTile.call({deduped:this._deduped},a,(function(e,n){e||!n?s.call(i,e):(a.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},t.actor&&t.actor.send("loadTile",a,s.bind(i),void 0,!0))}),!0);t.request={cancel:o}}function s(i,r){return delete t.request,t.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"unloadTile",value:function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"hasTransition",value:function(){return!1}},{key:"afterUpdate",value:function(){this._tileWorkers={}}},{key:"cancelTileJSONRequest",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}]),n}(e.Evented),Te=function(t){function n(t,i,r,a){var o;return _classCallCheck(this,n),(o=_callSuper(this,n)).id=t,o.dispatcher=r,o.setEventedParent(a),o.type="raster",o.minzoom=0,o.maxzoom=22,o.roundZoom=!0,o.scheme="xyz",o.tileSize=512,o._loaded=!1,o._options=e.extend({type:"raster"},i),e.extend(_assertThisInitialized2(o),e.pick(i,["url","scheme","tileSize"])),o}return _inherits(n,t),_createClass(n,[{key:"load",value:function(t){var n=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,null,null,(function(i,r){n._tileJSONRequest=null,n._loaded=!0,i?n.fire(new e.ErrorEvent(i)):r&&(e.extend(n,r),r.bounds&&(n.tileBounds=new L(r.bounds,n.minzoom,n.maxzoom)),e.postTurnstileEvent(r.tiles),n.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"reload",value:function(){var e=this;this.cancelTileJSONRequest(),this.load((function(){return e.map.style._clearSource(e.id)}))}},{key:"setTiles",value:function(e){return this._options.tiles=e,this.reload(),this}},{key:"setUrl",value:function(e){return this.url=e,this._options.url=e,this.reload(),this}},{key:"onRemove",value:function(){this.cancelTileJSONRequest()}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"loadTile",value:function(t,n){var i=this,r=e.exported.devicePixelRatio>=2,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(a,e.ResourceType.Tile),(function(r,a,o,s){return delete t.request,t.aborted?(t.state="unloaded",n(null)):r?(t.state="errored",n(r)):a?(i.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s}),t.setTexture(a,i.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(i.dispatcher),void n(null)):n(null)}))}},{key:"abortTile",value:function(e,t){e.request&&(e.request.cancel(),delete e.request),t()}},{key:"unloadTile",value:function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}},{key:"hasTransition",value:function(){return!1}},{key:"cancelTileJSONRequest",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}],[{key:"loadTileData",value:function(e,t,n){e.setTexture(t,n)}},{key:"unloadTileData",value:function(e,t){e.texture&&t.saveTileTexture(e.texture)}}]),n}(e.Evented);function Ee(t,n,i,r,a,o,s,l){var u=[t,i,a,n,r,o,1,1,1],c=[s,l,1],h=e.adjoint([],u),d=_slicedToArray(e.transformMat3(c,c,e.transpose(h,h)),3),f=d[0],p=d[1],m=d[2];return e.multiply$1(u,[f,0,0,0,p,0,0,0,m],u)}var Pe=function(t){function n(e,t,i,r){var a;return _classCallCheck(this,n),(a=_callSuper(this,n)).id=e,a.dispatcher=i,a.coordinates=t.coordinates,a.type="image",a.minzoom=0,a.maxzoom=22,a.tileSize=512,a.tiles={},a._loaded=!1,a.setEventedParent(r),a.options=t,a._dirty=!1,a}return _inherits(n,t),_createClass(n,[{key:"load",value:function(t,n){var i=this;this._loaded=n||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(n,r){if(i._imageRequest=null,i._loaded=!0,n)i.fire(new e.ErrorEvent(n));else if(r){var a=e.window.HTMLImageElement;i.image=r instanceof a?e.exported.getImageData(r):r,i._dirty=!0,i.width=i.image.width,i.height=i.image.height,t&&(i.coordinates=t),i._finishLoading()}}))}},{key:"loaded",value:function(){return this._loaded}},{key:"updateImage",value:function(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}},{key:"_finishLoading",value:function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"onRemove",value:function(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}},{key:"setCoordinates",value:function(t){this.coordinates=t,this._boundsArray=void 0;var n=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){var n,i=1/0,r=1/0,a=-1/0,o=-1/0,s=_createForOfIteratorHelper(t);try{for(s.s();!(n=s.n()).done;){var l=n.value;i=Math.min(i,l.x),r=Math.min(r,l.y),a=Math.max(a,l.x),o=Math.max(o,l.y)}}catch(d){s.e(d)}finally{s.f()}var u=Math.max(a-i,o-r),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),h=Math.pow(2,c);return new e.CanonicalTileID(c,Math.floor((i+a)/2*h),Math.floor((r+o)/2*h))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}},{key:"_clear",value:function(){this._boundsArray=void 0}},{key:"_prepareData",value:function(t){for(var n in this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}if(!this._boundsArray){var r=e.tileTransform(this.tileID,this.map.transform.projection),a=_slicedToArray(this.coordinates.map((function(t){var n=r.projection.project(t[0],t[1]);return e.getTilePoint(r,n)._round()})),4),o=a[0],s=a[1],l=a[2],u=a[3];this.perspectiveTransform=function(t,n,i,r,a,o,s,l,u,c){var h=Ee(0,0,t,0,0,n,t,n),d=Ee(i,r,a,o,s,l,u,c);return e.multiply$1(d,e.adjoint(h,h),d),[d[6]/d[8]*t/e.EXTENT,d[7]/d[8]*n/e.EXTENT]}(this.width,this.height,o.x,o.y,s.x,s.y,u.x,u.y,l.x,l.y);var c=this._boundsArray=new e.StructArrayLayout4i8;c.emplaceBack(o.x,o.y,0,0),c.emplaceBack(s.x,s.y,e.EXTENT,0),c.emplaceBack(u.x,u.y,0,e.EXTENT),c.emplaceBack(l.x,l.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(c,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}}},{key:"prepare",value:function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,n=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}}},{key:"loadTile",value:function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}},{key:"serialize",value:function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),Me={vector:Se,raster:Te,"raster-dem":function(t){function n(t,i,r,a){var o;return _classCallCheck(this,n),(o=_callSuper(this,n,[t,i,r,a])).type="raster-dem",o.maxzoom=22,o._options=e.extend({type:"raster-dem"},i),o.encoding=i.encoding||"mapbox",o}return _inherits(n,t),_createClass(n,[{key:"loadTile",value:function(t,n){var i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(e,i){e&&(t.state="errored",n(e)),i&&(t.dem=i,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",n(null))}t.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),(function(i,a,o,s){if(delete t.request,t.aborted)t.state="unloaded",n(null);else if(i)t.state="errored",n(i);else if(a){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s});var l=e.window.ImageBitmap&&a instanceof e.window.ImageBitmap&&(null==z&&(z=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),z),u=1-(a.width-e.prevPowerOfTwo(a.width))/2;u<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));var c=l?a:e.exported.getImageData(a,u),h={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:c,encoding:this.encoding,padding:u};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",h,r.bind(this),void 0,!0))}}).bind(this))}},{key:"_getNeighboringTiles",value:function(t){var n=t.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,a=0===n.x?t.wrap-1:t.wrap,o=(n.x+1+i)%i,s=n.x+1===i?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,a,n.z,r,n.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,a,n.z,r,n.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new e.OverscaledTileID(t.overscaledZ,a,n.z,r,n.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,n.z,o,n.y+1).key]={backfilled:!1}),l}},{key:"unloadTile",value:function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}}]),n}(Te),geojson:function(t){function n(t,i,r,a){var o;_classCallCheck(this,n),(o=_callSuper(this,n)).id=t,o.type="geojson",o.minzoom=0,o.maxzoom=18,o.tileSize=512,o.isTileClipped=!0,o.reparseOverscaled=!0,o._loaded=!1,o.actor=r.getActor(),o.setEventedParent(a),o._data=i.data,o._options=e.extend({},i),o._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(o.maxzoom=i.maxzoom),i.type&&(o.type=i.type),i.attribution&&(o.attribution=i.attribution),o.promoteId=i.promoteId;var s=e.EXTENT/o.tileSize;return o.workerOptions=e.extend({source:o.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*s,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*s,extent:e.EXTENT,maxZoom:o.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:o.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*s,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),o}return _inherits(n,t),_createClass(n,[{key:"onAdd",value:function(e){this.map=e,this.setData(this._data)}},{key:"setData",value:function(e){return this._data=e,this._updateWorkerData(),this}},{key:"getClusterExpansionZoom",value:function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}},{key:"getClusterChildren",value:function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}},{key:"getClusterLeaves",value:function(e,t,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:n},i),this}},{key:"_updateWorkerData",value:function(){var t=this;if(this._pendingLoad)this._coalesce=!0;else{this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;var n=e.extend({},this.workerOptions),i=this._data;"string"==typeof i?(n.request=this.map._requestManager.transformRequest(e.exported.resolveURL(i),e.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(i),this._pendingLoad=this.actor.send(this.type+".loadData",n,(function(n,i){if(t._loaded=!0,t._pendingLoad=null,n)t.fire(new e.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:t._metadataFired?"content":"metadata"};t._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[t.id]&&(r.resourceTiming=i.resourceTiming[t.id]),t.fire(new e.Event("data",r)),t._metadataFired=!0}t._coalesce&&(t._updateWorkerData(),t._coalesce=!1)}))}}},{key:"loaded",value:function(){return this._loaded}},{key:"loadTile",value:function(t,n){var i=this,r=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(r,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,a){return delete t.request,t.unloadVectorData(),t.aborted?n(null):e?n(e):(t.loadVectorData(a,i.map.painter,"reloadTile"===r),n(null))}),void 0,"loadTile"===r)}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}},{key:"unloadTile",value:function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"onRemove",value:function(){this._pendingLoad&&this._pendingLoad.cancel()}},{key:"serialize",value:function(){return e.extend({},this._options,{type:this.type,data:this._data})}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),video:function(t){function n(e,t,i,r){var a;return _classCallCheck(this,n),(a=_callSuper(this,n,[e,t,i,r])).roundZoom=!0,a.type="video",a.options=t,a}return _inherits(n,t),_createClass(n,[{key:"load",value:function(){var t=this;this._loaded=!1;var n=this.options;this.urls=[];var i,r=_createForOfIteratorHelper(n.urls);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.urls.push(this.map._requestManager.transformRequest(a,e.ResourceType.Source).url)}}catch(o){r.e(o)}finally{r.f()}e.getVideo(this.urls,(function(n,i){t._loaded=!0,n?t.fire(new e.ErrorEvent(n)):i&&(t.video=i,t.video.loop=!0,t.video.setAttribute("playsinline",""),t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"play",value:function(){this.video&&this.video.play()}},{key:"seek",value:function(t){if(this.video){var n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=t}}},{key:"getVideo",value:function(){return this.video}},{key:"onAdd",value:function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}},{key:"prepare",value:function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}}},{key:"serialize",value:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this.video&&!this.video.paused}}]),n}(Pe),image:Pe,canvas:function(t){function n(t,i,r,a){var o;return _classCallCheck(this,n),o=_callSuper(this,n,[t,i,r,a]),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||o.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):o.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&o.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof e.window.HTMLCanvasElement||o.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):o.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "canvas"'))),o.options=i,o.animate=void 0===i.animate||i.animate,o}return _inherits(n,t),_createClass(n,[{key:"load",value:function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}},{key:"getCanvas",value:function(){return this.canvas}},{key:"onAdd",value:function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}},{key:"onRemove",value:function(){this.pause()}},{key:"prepare",value:function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}}},{key:"serialize",value:function(){return{type:"canvas",coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this._playing}},{key:"_hasInvalidDimensions",value:function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e++){var n=t[e];if(isNaN(n)||n<=0)return!0}return!1}}]),n}(Pe),custom:function(t){function n(t,i,r,a){var o;return _classCallCheck(this,n),(o=_callSuper(this,n)).id=t,o.type="custom",o._dataType="raster",o._dispatcher=r,o._implementation=i,o.setEventedParent(a),o.scheme="xyz",o.minzoom=0,o.maxzoom=22,o.tileSize=512,o._loaded=!1,o.roundZoom=!0,o._implementation||o.fire(new e.ErrorEvent(new Error("Missing implementation for ".concat(o.id," custom source")))),o._implementation.loadTile||o.fire(new e.ErrorEvent(new Error("Missing loadTile implementation for ".concat(o.id," custom source")))),o._implementation.bounds&&(o.tileBounds=new L(o._implementation.bounds,o.minzoom,o.maxzoom)),i.update=o._update.bind(_assertThisInitialized2(o)),i.clearTiles=o._clearTiles.bind(_assertThisInitialized2(o)),i.coveringTiles=o._coveringTiles.bind(_assertThisInitialized2(o)),e.extend(_assertThisInitialized2(o),e.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"])),o}return _inherits(n,t),_createClass(n,[{key:"serialize",value:function(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}},{key:"load",value:function(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}},{key:"onRemove",value:function(e){this._implementation.onRemove&&this._implementation.onRemove(e)}},{key:"hasTile",value:function(e){if(this._implementation.hasTile){var t=e.canonical,n=t.x,i=t.y,r=t.z;return this._implementation.hasTile({x:n,y:i,z:r})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"loadTile",value:function(t,n){var i=t.tileID.canonical,r=i.x,a=i.y,o=i.z,s=new e.window.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:r,y:a,z:o},{signal:s.signal})).then((function(i){return delete t.request,t.aborted?(t.state="unloaded",n(null)):void 0===i?(t.state="errored",n(null)):null===i?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",n(null)):function(t){return t instanceof e.window.ImageData||t instanceof e.window.HTMLCanvasElement||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLImageElement}(i)?(this.loadTileData(t,i),t.state="loaded",void n(null)):(t.state="errored",n(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment"))))}).bind(this)).catch((function(e){20!==e.code&&(t.state="errored",n(e))})),t.request.cancel=function(){return s.abort()}}},{key:"loadTileData",value:function(e,t){Te.loadTileData(e,t,this._map.painter)}},{key:"unloadTileData",value:function(e){Te.unloadTileData(e,this._map.painter)}},{key:"unloadTile",value:function(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){var n=e.tileID.canonical,i=n.x,r=n.y,a=n.z;this._implementation.unloadTile({x:i,y:r,z:a})}t()}},{key:"abortTile",value:function(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}},{key:"hasTransition",value:function(){return!1}},{key:"_coveringTiles",value:function(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((function(e){return{x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}}))}},{key:"_clearTiles",value:function(){this._map.style._clearSource(this.id)}},{key:"_update",value:function(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}]),n}(e.Evented)},Ie=function(t,n,i,r){var a=new Me[n.type](t,n,i,r);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return e.bindAll(["load","abort","unload","serialize","prepare"],a),a};function Ae(t,n){var i=e.identity([]);return e.scale(i,i,[.5*t.width,.5*-t.height,1]),e.translate(i,i,[1,-1,0]),e.multiply(i,i,t.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(i)}function Re(e,t,n,i,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=e.tilesIn(i,o,s);l.sort(Ne);var u,c=[],h=_createForOfIteratorHelper(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;c.push({wrappedTileID:d.tile.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,n,e._state,d,r,a,Ae(e.transform,d.tile.tileID),s)})}}catch(m){h.e(m)}finally{h.f()}var f=function(e){var t,n={},i={},r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,o=a.queryResults,s=a.wrappedTileID,l=i[s]=i[s]||{};for(var u in o){var c,h=o[u],d=l[u]=l[u]||{},f=n[u]=n[u]||[],p=_createForOfIteratorHelper(h);try{for(p.s();!(c=p.n()).done;){var v=c.value;d[v.featureIndex]||(d[v.featureIndex]=!0,f.push(v))}}catch(m){p.e(m)}finally{p.f()}}}}catch(m){r.e(m)}finally{r.f()}return n}(c);for(var p in f)f[p].forEach((function(t){var n=t.feature,i=n.layer;i&&"background"!==i.type&&"sky"!==i.type&&(n.source=i.source,i["source-layer"]&&(n.sourceLayer=i["source-layer"]),n.state=void 0!==n.id?e.getFeatureState(i["source-layer"],n.id):{})}));return f}function Oe(e,t){for(var n=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),i=[],r={},a=0;a<n.length;a++){var o=n[a],s=o.tileID.canonical.key;r[s]||(r[s]=!0,o.querySourceFeatures(i,t))}return i}function Ne(e,t){var n=e.tileID,i=t.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function De(){return null!=la.workerClass?new la.workerClass:new e.window.Worker(la.workerUrl)}var ze,Le="mapboxgl_preloaded_worker_pool",Be=function(){function e(){_classCallCheck(this,e),this.active={}}return _createClass(e,[{key:"acquire",value:function(t){if(!this.workers)for(this.workers=[];this.workers.length<e.workerCount;)this.workers.push(new De);return this.active[t]=!0,this.workers.slice()}},{key:"release",value:function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)}},{key:"isPreloaded",value:function(){return!!this.active[Le]}},{key:"numActive",value:function(){return Object.keys(this.active).length}}]),e}();function Fe(){return ze||(ze=new Be),ze}function je(t,n){var i={};for(var r in t)"ref"!==r&&(i[r]=t[r]);return e.refProperties.forEach((function(e){e in n&&(i[e]=n[e])})),i}function He(e){e=e.slice();for(var t=Object.create(null),n=0;n<e.length;n++)t[e[n].id]=e[n];for(var i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=je(e[i],t[e[i].ref]));return e}Be.workerCount=2;var Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ue(e,t,n){n.push({command:Ve.addSource,args:[e,t[e]]})}function qe(e,t,n){t.push({command:Ve.removeSource,args:[e]}),n[e]=!0}function Ge(e,t,n,i){qe(e,n,i),Ue(e,t,n)}function We(e,n,i){var r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t(e[i][r],n[i][r]))return!1;return!0}function Ze(e,n,i,r,a,o){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t(e[s],n[s])||i.push({command:o,args:[r,s,n[s],a]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t(e[s],n[s])||i.push({command:o,args:[r,s,n[s],a]}))}function Xe(e){return e.id}function Ke(e,t){return e[t.id]=t,e}var Ye=function(){function t(e,n){_classCallCheck(this,t),this.reset(e,n)}return _createClass(t,[{key:"reset",value:function(e,t){this.points=e||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}},{key:"lerp",value:function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var n=1,i=this._distances[n],r=t*this.paddedLength+this.padding;i<r&&n<this._distances.length;)i=this._distances[++n];var a=n-1,o=this._distances[a],s=i-o,l=s>0?(r-o)/s:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))}}]),t}(),Je=function(){function e(t,n,i){_classCallCheck(this,e);var r=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(n/i);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}return _createClass(e,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}},{key:"insertCircle",value:function(e,t,n,i){this._forEachCell(t-i,n-i,t+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(i)}},{key:"_insertBoxCell",value:function(e,t,n,i,r,a){this.boxCells[r].push(a)}},{key:"_insertCircleCell",value:function(e,t,n,i,r,a){this.circleCells[r].push(a)}},{key:"_query",value:function(e,t,n,i,r,a){if(n<0||e>this.width||i<0||t>this.height)return!r&&[];var o=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(var s=0;s<this.boxKeys.length;s++)o.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];o.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return a?o.filter(a):o}return this._forEachCell(e,t,n,i,this._queryCell,o,{hitTest:r,seenUids:{box:{},circle:{}}},a),r?o.length>0:o}},{key:"_queryCircle",value:function(e,t,n,i,r){var a=e-n,o=e+n,s=t-n,l=t+n;if(o<0||a>this.width||l<0||s>this.height)return!i&&[];var u=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,u,{hitTest:i,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},r),i?u.length>0:u}},{key:"query",value:function(e,t,n,i,r){return this._query(e,t,n,i,!1,r)}},{key:"hitTest",value:function(e,t,n,i,r){return this._query(e,t,n,i,!0,r)}},{key:"hitTestCircle",value:function(e,t,n,i){return this._queryCircle(e,t,n,!0,i)}},{key:"_queryCell",value:function(e,t,n,i,r,a,o,s){var l=o.seenUids,u=this.boxCells[r];if(null!==u){var c,h=this.bboxes,d=_createForOfIteratorHelper(u);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(!l.box[f]){l.box[f]=!0;var p=4*f;if(e<=h[p+2]&&t<=h[p+3]&&n>=h[p+0]&&i>=h[p+1]&&(!s||s(this.boxKeys[f]))){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[f],x1:h[p],y1:h[p+1],x2:h[p+2],y2:h[p+3]})}}}}catch(C){d.e(C)}finally{d.f()}}var m=this.circleCells[r];if(null!==m){var v,g=this.circles,y=_createForOfIteratorHelper(m);try{for(y.s();!(v=y.n()).done;){var _=v.value;if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(g[x],g[x+1],g[x+2],e,t,n,i)&&(!s||s(this.circleKeys[_]))){if(o.hitTest)return a.push(!0),!0;var b=g[x],w=g[x+1],k=g[x+2];a.push({key:this.circleKeys[_],x1:b-k,y1:w-k,x2:b+k,y2:w+k})}}}}catch(C){y.e(C)}finally{y.f()}}}},{key:"_queryCellCircle",value:function(e,t,n,i,r,a,o,s){var l=o.circle,u=o.seenUids,c=this.boxCells[r];if(null!==c){var h,d=this.bboxes,f=_createForOfIteratorHelper(c);try{for(f.s();!(h=f.n()).done;){var p=h.value;if(!u.box[p]){u.box[p]=!0;var m=4*p;if(this._circleAndRectCollide(l.x,l.y,l.radius,d[m+0],d[m+1],d[m+2],d[m+3])&&(!s||s(this.boxKeys[p])))return a.push(!0),!0}}}catch(w){f.e(w)}finally{f.f()}}var v=this.circleCells[r];if(null!==v){var g,y=this.circles,_=_createForOfIteratorHelper(v);try{for(_.s();!(g=_.n()).done;){var x=g.value;if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circlesCollide(y[b],y[b+1],y[b+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return a.push(!0),!0}}}catch(w){_.e(w)}finally{_.f()}}}},{key:"_forEachCell",value:function(e,t,n,i,r,a,o,s){for(var l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i),d=l;d<=c;d++)for(var f=u;f<=h;f++)if(r.call(this,e,t,n,i,this.xCellCount*f+d,a,o,s))return}},{key:"_convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"_convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}},{key:"_circlesCollide",value:function(e,t,n,i,r,a){var o=i-e,s=r-t,l=n+a;return l*l>o*o+s*s}},{key:"_circleAndRectCollide",value:function(e,t,n,i,r,a,o){var s=(a-i)/2,l=Math.abs(e-(i+s));if(l>s+n)return!1;var u=(o-r)/2,c=Math.abs(t-(r+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;var h=l-s,d=c-u;return h*h+d*d<=n*n}}]),e}(),Qe=Math.tan(85*Math.PI/180);function $e(t,n,i,r,a,o,s){var l=e.create();if(i)if("globe"===o.name){var u=e.calculateGlobeLabelMatrix(a,n);e.multiply(l,l,u)}else{var c=y([],s);l[0]=c[0],l[1]=c[1],l[4]=c[2],l[5]=c[3],r||e.rotateZ(l,l,a.angle)}else e.multiply(l,a.labelPlaneMatrix,t);return l}function et(e,t,n,i,r,a,o){var s=$e(e,t,n,i,r,a,o);return"globe"===a.name&&n||(s[2]=s[6]=s[10]=s[14]=0),s}function tt(t,n,i,r,a,o,s){if(i){if("globe"===o.name){var l=$e(t,n,i,r,a,o,s);return e.invert(l,l),e.multiply(l,t,l),l}var u=e.clone(t),c=e.identity([]);return c[0]=s[0],c[1]=s[1],c[4]=s[2],c[5]=s[3],e.multiply(u,u,c),r||e.rotateZ(u,u,-a.angle),u}return a.glCoordMatrix}function nt(t,n,i,r){var a=[t,n,i,1];i?e.transformMat4$1(a,a,r):ft(a,a,r);var o=a[3];return a[0]/=o,a[1]/=o,a[2]/=o,a}function it(e,t){return Math.min(.5+e/t*.5,1.5)}function rt(e,t){var n=e[0]/e[3],i=e[1]/e[3];return n>=-t[0]&&n<=t[0]&&i>=-t[1]&&i<=t[1]}function at(t,n,i,r,a,o,s,l,u,c){var h=i.transform,d=r?t.textSizeData:t.iconSizeData,f=e.evaluateSizeForZoom(d,i.transform.zoom),p="globe"===h.projection.name,m=[256/i.width*2+1,256/i.height*2+1],v=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;v.clear();var g=null;p&&(g=r?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);for(var y,_=t.lineVertexArray,x=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=i.transform.width/i.transform.height,w=!1,k=0;k<x.length;k++){var C=x.get(k),S=C.numGlyphs,T=C.writingMode;if(T!==e.WritingMode.vertical||w||y===e.WritingMode.horizontal||(w=!0),y=T,!C.hidden&&T!==e.WritingMode.vertical||w){w=!1;var E=new e.Point(C.tileAnchorX,C.tileAnchorY),P=h.projection.projectTilePoint(E.x,E.y,c.canonical),M=P.x,I=P.y,A=P.z;if(u){var R=_slicedToArray(u(E),3);M+=R[0],I+=R[1],A+=R[2]}var O=[M,I,A,1];if(e.transformMat4$1(O,O,n),rt(O,m)){var N=it(i.transform.cameraToCenterDistance,O[3]),D=e.evaluateSizeForFeature(d,f,C),z=s?D/N:D*N,L=nt(M,I,A,a);if(L[3]<=0)dt(S,v);else{var B={},F=s?null:u,j=lt(C,z,!1,l,n,a,o,t.glyphOffsetArray,_,v,g,L,E,B,b,F,h.projection,c,s);w=j.useVertical,F&&j.needsFlipping&&(B={}),(j.notEnoughRoom||w||j.needsFlipping&&lt(C,z,!0,l,n,a,o,t.glyphOffsetArray,_,v,g,L,E,B,b,F,h.projection,c,s).notEnoughRoom)&&dt(S,v)}}else dt(S,v)}else dt(S,v)}r?(t.text.dynamicLayoutVertexBuffer.updateData(v),g&&t.text.globeExtVertexBuffer.updateData(g)):(t.icon.dynamicLayoutVertexBuffer.updateData(v),g&&t.icon.globeExtVertexBuffer.updateData(g))}function ot(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){var v=s.lineStartIndex,g=s.glyphStartIndex,y=s.segment,_=g+s.numGlyphs,x=v+s.lineLength,b=t.getoffsetX(g),w=t.getoffsetX(_-1),k=ht(e*b,n,i,r,a,o,y,v,x,l,u,c,h,d,!0,f,p,m);if(!k)return null;var C=ht(e*w,n,i,r,a,o,y,v,x,l,u,c,h,d,!0,f,p,m);return C?{first:k,last:C}:null}function st(t,n,i,r){return t===e.WritingMode.horizontal&&Math.abs(r)>Math.abs(i)?{useVertical:!0}:t===e.WritingMode.vertical?r>0?{needsFlipping:!0}:null:0!==n&&function(e,t){return 0===e||Math.abs(t/e)>Qe}(i,r)?1===n?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function lt(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_){var x=n/24,b=t.lineOffsetX*x,w=t.lineOffsetY*x,k=t.lineStartIndex,C=t.glyphStartIndex,S=t.numGlyphs,T=t.segment,E=t.writingMode,P=t.flipState,M=k+t.lineLength,I=function(t){if(h){var n=_slicedToArray(t.up,3),i=n[0],r=n[1],a=n[2],o=c.length;e.updateGlobeVertexNormal(h,o+0,i,r,a),e.updateGlobeVertexNormal(h,o+1,i,r,a),e.updateGlobeVertexNormal(h,o+2,i,r,a),e.updateGlobeVertexNormal(h,o+3,i,r,a)}var s=_slicedToArray(t.point,3),l=s[0],u=s[1],d=s[2];e.addDynamicAttributes(c,l,u,d,t.angle)};if(S>1){var A=ot(x,l,b,w,i,d,f,t,u,o,p,v,!1,g,y,_);if(!A)return{notEnoughRoom:!0};if(r&&!i){var R,O,N=_slicedToArray(A.first.point,3),D=N[0],z=N[1],L=N[2],B=_slicedToArray(A.last.point,3),F=B[0],j=B[1],H=B[2];D=(R=_slicedToArray(nt(D,z,L,s),2))[0],z=R[1];var V=st(E,P,((F=(O=_slicedToArray(nt(F,j,H,s),2))[0])-D)*m,(j=O[1])-z);if(t.flipState=V&&V.needsFlipping?1:2,V)return V}I(A.first);for(var U=C+1;U<C+S-1;U++){var q=ht(x*l.getoffsetX(U),b,w,i,d,f,T,k,M,u,o,p,v,!1,!1,g,y,_);if(!q)return c.length-=4*(U-C),{notEnoughRoom:!0};I(q)}I(A.last)}else{if(r&&!i){var G=nt(f.x,f.y,0,a),W=k+T+1,Z=new e.Point(u.getx(W),u.gety(W)),X=nt(Z.x,Z.y,0,a),K=X[3]>0?X:ct(f,Z,G,1,a,void 0,g,y.canonical),Y=st(E,P,(K[0]-G[0])*m,K[1]-G[1]);if(t.flipState=Y&&Y.needsFlipping?1:2,Y)return Y}var J=ht(x*l.getoffsetX(C),b,w,i,d,f,T,k,M,u,o,p,v,!1,!1,g,y,_);if(!J)return{notEnoughRoom:!0};I(J)}return{}}function ut(e,t,n,i,r){var a=i.projectTilePoint(e.x,e.y,t),o=a.x,s=a.y,l=a.z;if(!r)return nt(o,s,l,n);var u=_slicedToArray(r(e),3);return nt(o+u[0],s+u[1],l+u[2],n)}function ct(t,n,i,r,a,o,s,l){var u=ut(t.sub(n)._unit()._add(t),l,a,s,o);return e.sub(u,i,u),e.normalize(u,u),e.scaleAndAdd(u,i,u,r)}function ht(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y){var _=r?t-n:t+n,x=_>0?1:-1,b=0;r&&(x*=-1,b=Math.PI),x<0&&(b+=Math.PI);for(var w=l+s+(x>0?0:1)|0,k=a,C=a,S=0,T=0,E=Math.abs(_),P=[],M=[],I=o,A=I,R=function(){return ct(A,I,C,E-S+1,h,f,v,g.canonical)};S+T<=E;){if((w+=x)<l||w>=u)return null;if(C=k,A=I,P.push(C),p&&M.push(A),I=new e.Point(c.getx(w),c.gety(w)),!(k=d[w])){var O=ut(I,g.canonical,h,v,f);k=O[3]>0?d[w]=O:R()}S+=T,T=e.distance(C,k)}m&&f&&(d[w]&&(k=R(),T=e.distance(C,k)),d[w]=k);var N=(E-S)/T,D=I.sub(A)._mult(N)._add(A),z=e.sub([],k,C),L=e.scaleAndAdd([],C,z,N),B=[0,0,1],F=z[0],j=z[1];if(y&&(0!==(B=v.upVector(g.canonical,D.x,D.y))[0]||0!==B[1]||1!==B[2])){var H=[B[2],0,-B[0]],V=e.cross([],B,H);e.normalize(H,H),e.normalize(V,V),F=e.dot(z,H),j=e.dot(z,V)}if(i){var U=e.cross([],B,z);e.normalize(U,U),e.scaleAndAdd(L,L,U,i*x)}var q=b+Math.atan2(j,F);return P.push(L),p&&M.push(D),{point:L,angle:q,path:P,tilePath:M,up:B}}function dt(e,t){var n=t.length,i=n+4*e;t.resize(i),t.float32.fill(-1/0,4*n,4*i)}function ft(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e[3]=n[3]*i+n[7]*r+n[15],e}var pt=100,mt=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Je(e.width+200,e.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Je(e.width+200,e.height+200,25);_classCallCheck(this,t),this.transform=e,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+pt,this.screenBottomBoundary=e.height+pt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=n}return _createClass(t,[{key:"placeCollisionBox",value:function(e,t,n,i,r,a,o,s){var l=n.projectedAnchorX,u=n.projectedAnchorY,c=n.projectedAnchorZ,h=n.elevation,d=n.tileID,f=e.getProjection();if(h&&d){var p=_slicedToArray(f.upVector(d.canonical,n.tileAnchorX,n.tileAnchorY),3),m=p[0],v=p[1],g=p[2],y=f.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=m*h*y,u+=v*h*y,c+=g*h*y}var _=this.projectAndGetPerspectiveRatio(o,l,u,c,n.tileID,"globe"===f.name||!!h||this.transform.pitch>0,f),x=a*_.perspectiveRatio,b=(n.x1*t+i.x-n.padding)*x+_.point.x,w=(n.y1*t+i.y-n.padding)*x+_.point.y,k=(n.x2*t+i.x+n.padding)*x+_.point.x,C=(n.y2*t+i.y+n.padding)*x+_.point.y,S=_.perspectiveRatio<=.55||_.occluded;return!this.isInsideGrid(b,w,k,C)||!r&&this.grid.hitTest(b,w,k,C,s)||S?{box:[],offscreen:!1,occluded:_.occluded}:{box:[b,w,k,C],offscreen:this.isOffscreen(b,w,k,C),occluded:!1}}},{key:"placeCollisionCircles",value:function(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){var v=[],g=this.transform.elevation,y=t.getProjection(),_=g?g.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,y):null,x=new e.Point(i.tileAnchorX,i.tileAnchorY),b=y.projectTilePoint(x.x,x.y,m.canonical),w=b.x,k=b.y,C=b.z;if(_){var S=_slicedToArray(_(x),3);w+=S[0],k+=S[1],C+=S[2]}var T="globe"===y.name,E=this.projectAndGetPerspectiveRatio(s,w,k,C,m,T||!!g||this.transform.pitch>0,y),P=E.perspectiveRatio,M=(h?o/P:o*P)/e.ONE_EM,I=nt(w,k,C,l),A=E.signedDistanceFromCamera>0?ot(M,a,i.lineOffsetX*M,i.lineOffsetY*M,!1,I,x,i,r,l,{},g&&!h?_:null,h&&!!g,y,m,h):null,R=!1,O=!1,N=!0;if(A&&!E.occluded){for(var D=.5*f*P+p,z=new e.Point(-100,-100),L=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),B=new Ye,F=A.first,j=A.last,H=F.path.length,V=[],U=H-1;U>=1;U--)V.push(F.path[U]);for(var q=1;q<j.path.length;q++)V.push(j.path[q]);var G=2.5*D;u&&((V=V.map((function(e,t){var n=_slicedToArray(e,3),i=n[0],r=n[1],a=n[2];return _&&!T&&(a=_(t<H-1?F.tilePath[H-1-t]:j.tilePath[t-H+2])[2]),nt(i,r,a,u)}))).some((function(e){return e[3]<=0}))&&(V=[]));var W=[];if(V.length>0){var Z,X=1/0,K=-1/0,Y=1/0,J=-1/0,Q=_createForOfIteratorHelper(V);try{for(Q.s();!(Z=Q.n()).done;){var $=Z.value;X=Math.min(X,$[0]),Y=Math.min(Y,$[1]),K=Math.max(K,$[0]),J=Math.max(J,$[1])}}catch(fe){Q.e(fe)}finally{Q.f()}K>=z.x&&X<=L.x&&J>=z.y&&Y<=L.y&&(W=[V.map((function(t){return new e.Point(t[0],t[1])}))],(X<z.x||K>L.x||Y<z.y||J>L.y)&&(W=e.clipLine(W,z.x,z.y,L.x,L.y)))}var ee,te=_createForOfIteratorHelper(W);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;B.reset(ne,.25*D);var ie;ie=B.length<=.5*D?1:Math.ceil(B.paddedLength/G)+1;for(var re=0;re<ie;re++){var ae=re/Math.max(ie-1,1),oe=B.lerp(ae),se=oe.x+pt,le=oe.y+pt;v.push(se,le,D,0);var ue=se-D,ce=le-D,he=se+D,de=le+D;if(N=N&&this.isOffscreen(ue,ce,he,de),O=O||this.isInsideGrid(ue,ce,he,de),!n&&this.grid.hitTestCircle(se,le,D,d)&&(R=!0,!c))return{circles:[],offscreen:!1,collisionDetected:R,occluded:!1}}}}catch(fe){te.e(fe)}finally{te.f()}}return{circles:!c&&R||!O?[]:v,offscreen:N,collisionDetected:R,occluded:E.occluded}}},{key:"queryRenderedSymbols",value:function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var n,i=[],r=1/0,a=1/0,o=-1/0,s=-1/0,l=_createForOfIteratorHelper(t);try{for(l.s();!(n=l.n()).done;){var u=n.value,c=new e.Point(u.x+pt,u.y+pt);r=Math.min(r,c.x),a=Math.min(a,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y),i.push(c)}}catch(y){l.e(y)}finally{l.f()}var h,d={},f={},p=_createForOfIteratorHelper(this.grid.query(r,a,o,s).concat(this.ignoredGrid.query(r,a,o,s)));try{for(p.s();!(h=p.n()).done;){var m=h.value,v=m.key;if(void 0===d[v.bucketInstanceId]&&(d[v.bucketInstanceId]={}),!d[v.bucketInstanceId][v.featureIndex]){var g=[new e.Point(m.x1,m.y1),new e.Point(m.x2,m.y1),new e.Point(m.x2,m.y2),new e.Point(m.x1,m.y2)];e.polygonIntersectsPolygon(i,g)&&(d[v.bucketInstanceId][v.featureIndex]=!0,void 0===f[v.bucketInstanceId]&&(f[v.bucketInstanceId]=[]),f[v.bucketInstanceId].push(v.featureIndex))}}}catch(y){p.e(y)}finally{p.f()}return f}},{key:"insertCollisionBox",value:function(e,t,n,i,r){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},e[0],e[1],e[2],e[3])}},{key:"insertCollisionCircles",value:function(e,t,n,i,r){for(var a=t?this.ignoredGrid:this.grid,o={bucketInstanceId:n,featureIndex:i,collisionGroupID:r},s=0;s<e.length;s+=4)a.insertCircle(o,e[s],e[s+1],e[s+2])}},{key:"projectAndGetPerspectiveRatio",value:function(t,n,i,r,a,o,s){var l=[n,i,r,1],u=!1;r||this.transform.pitch>0?(e.transformMat4$1(l,l,t),this.fogState&&a&&"globe"!==s.name&&(u=function(t,n,i,r,a,o){var s=o.calculateFogTileMatrix(a),l=[n,i,r];return e.transformMat4(l,l,s),S(t,l,o.pitch,o._fov)}(this.fogState,n,i,r,a.toUnwrapped(),this.transform)>.9)):ft(l,l,t);var c=l[3];return{point:new e.Point((l[0]/c+1)/2*this.transform.width+pt,(-l[1]/c+1)/2*this.transform.height+pt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(s)/c*.5,1.5),signedDistanceFromCamera:c,occluded:o&&l[2]>c||u}}},{key:"isOffscreen",value:function(e,t,n,i){return n<pt||e>=this.screenRightBoundary||i<pt||t>this.screenBottomBoundary}},{key:"isInsideGrid",value:function(e,t,n,i){return n>=0&&e<this.gridRightBoundary&&i>=0&&t<this.gridBottomBoundary}},{key:"getViewportMatrix",value:function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}]),t}();function vt(t,n,i){var r=n.createTileMatrix(t,t.worldSize,i.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,r)}function gt(e,t,n){if(t.projection.name===n.projection.name)return e.projMatrix;var i=n.clone();return i.setProjection(t.projection),vt(i,t.getProjection(),e)}function yt(e,t,n){return t.name===n.projection.name?e.projMatrix:vt(n,t,e)}var _t=function(){function e(t,n,i,r){_classCallCheck(this,e),this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?n:-n))):r&&i?1:0,this.placed=i}return _createClass(e,[{key:"isHidden",value:function(){return 0===this.opacity&&!this.placed}}]),e}(),xt=function(){function e(t,n,i,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];_classCallCheck(this,e),this.text=new _t(t?t.text:null,n,i,a),this.icon=new _t(t?t.icon:null,n,r,a),this.clipped=o}return _createClass(e,[{key:"isHidden",value:function(){return this.text.isHidden()&&this.icon.isHidden()}}]),e}(),bt=_createClass((function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.text=t,this.icon=n,this.skipFade=i,this.clipped=r})),wt=_createClass((function t(){_classCallCheck(this,t),this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]})),kt=_createClass((function e(t,n,i,r,a){_classCallCheck(this,e),this.bucketInstanceId=t,this.featureIndex=n,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=a})),Ct=function(){function e(t){_classCallCheck(this,e),this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}return _createClass(e,[{key:"get",value:function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]}}]),e}();function St(t,n,i,r,a){var o=e.getAnchorAlignment(t),s=-(o.horizontalAlign-.5)*n,l=-(o.verticalAlign-.5)*i,u=e.evaluateVariableOffset(t,r);return new e.Point(s+u[0]*a,l+u[1]*a)}function Tt(t,n,i,r,a){var o=new e.Point(t,n);return i&&o._rotate(r?a:-a),o}var Et=function(){function t(e,n,i,r,a){_classCallCheck(this,t),this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new mt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Ct(i),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}return _createClass(t,[{key:"getBucketParts",value:function(t,n,i,r){var a=i.getBucket(n),o=i.latestFeatureIndex;if(a&&o&&n.id===a.layerIds[0]){var s=a.layers[0].layout,l=i.collisionBoxArray,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/e.EXTENT,h=i.tileID.toUnwrapped();this.transform.setProjection(a.projection);var d,f,p,m=(d=i.tileID,f=a.getProjection(),p=this.transform,f.name===this.projection?p.calculateProjMatrix(d.toUnwrapped()):vt(p,f,d)),v="map"===s.get("text-pitch-alignment"),g="map"===s.get("text-rotation-alignment");n.compileFilter();var y=n.dynamicFilter(),_=n.dynamicFilterNeedsFeature(),x=this.transform.calculatePixelsToTileUnitsMatrix(i),b=et(m,i.tileID.canonical,v,g,this.transform,a.getProjection(),x),w=null;if(v){var k=tt(m,i.tileID.canonical,v,g,this.transform,a.getProjection(),x);w=e.multiply([],this.transform.labelPlaneMatrix,k)}var C=null;y&&i.latestFeatureIndex&&(C={unwrappedTileID:h,dynamicFilter:y,dynamicFilterNeedsFeature:_,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[a.bucketInstanceId]=new kt(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,i.tileID);var S={bucket:a,layout:s,posMatrix:m,textLabelPlaneMatrix:b,labelToScreenMatrix:w,clippingData:C,scale:u,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(a.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(a.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r){var T,E=_createForOfIteratorHelper(a.sortKeyRanges);try{for(E.s();!(T=E.n()).done;){var P=T.value,M=P.sortKey,I=P.symbolInstanceStart,A=P.symbolInstanceEnd;t.push({sortKey:M,symbolInstanceStart:I,symbolInstanceEnd:A,parameters:S})}}catch(R){E.e(R)}finally{E.f()}}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:S})}}},{key:"attemptAnchorPlacement",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g){var y,_=h.textOffset0,x=h.textOffset1,b=h.crossTileID,w=[_,x],k=St(e,n,i,w,r),C=this.collisionIndex.placeCollisionBox(f,r,t,Tt(k.x,k.y,a,o,this.transform.angle),c,s,l,u.predicate);if(m){var S=f.getSymbolInstanceIconSize(g,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(f,S,m,Tt(k.x,k.y,a,o,this.transform.angle),c,s,l,u.predicate).box.length)return}if(C.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[b]&&this.prevPlacement.placements[b]&&this.prevPlacement.placements[b].text&&(y=this.prevPlacement.variableOffsets[b].anchor),this.variableOffsets[b]={textOffset:w,width:n,height:i,anchor:e,textScale:r,prevAnchor:y},this.markUsedJustification(f,e,h,p),f.allowVerticalPlacement&&(this.markUsedOrientation(f,p,h),this.placedOrientations[b]=p),{shift:k,placedGlyphBoxes:C}}},{key:"placeLayerBucketPart",value:function(t,n,i,r){var a=this,o=t.parameters,s=o.bucket,l=o.layout,u=o.posMatrix,c=o.textLabelPlaneMatrix,h=o.labelToScreenMatrix,d=o.clippingData,f=o.textPixelRatio,p=o.holdingForFade,m=o.collisionBoxArray,v=o.partiallyEvaluatedTextSize,g=o.partiallyEvaluatedIconSize,y=o.collisionGroup,_=l.get("text-optional"),x=l.get("icon-optional"),b=l.get("text-allow-overlap"),w=l.get("icon-allow-overlap"),k="map"===l.get("text-rotation-alignment"),C="map"===l.get("text-pitch-alignment"),S="none"!==l.get("icon-text-fit"),T="viewport-y"===l.get("symbol-z-order");this.transform.setProjection(s.projection);var E=b&&(w||!s.hasIconData()||x),P=w&&(b||!s.hasTextData()||_);!s.collisionArrays&&m&&s.deserializeCollisionBoxes(m),i&&r&&s.updateCollisionDebugBuffers(this.transform.zoom,m);var M=function(t,r,o){var m=t.crossTileID,T=t.numVerticalGlyphVertices;if(d){var M={zoom:a.transform.zoom,pitch:a.transform.pitch},I=null;if(d.dynamicFilterNeedsFeature){var A=a.retainedQueryData[s.bucketInstanceId];I=d.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:A.bucketIndex,sourceLayerIndex:A.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,d.dynamicFilter)(M,I,a.retainedQueryData[s.bucketInstanceId].tileID.canonical,new e.Point(t.tileAnchorX,t.tileAnchorY),a.transform.calculateDistanceTileData(d.unwrappedTileID)))return a.placements[m]=new bt(!1,!1,!1,!0),void n.add(m)}if(!n.has(m))if(p)a.placements[m]=new bt(!1,!1,!1);else{var R,O=!1,N=!1,D=!0,z=!1,L=!1,B=null,F={box:null,offscreen:null,occluded:null},j={box:null,offscreen:null,occluded:null},H=null,V=null,U=0,q=0,G=0;o.textFeatureIndex?U=o.textFeatureIndex:t.useRuntimeCollisionCircles&&(U=t.featureIndex),o.verticalTextFeatureIndex&&(q=o.verticalTextFeatureIndex);var W=function(e){e.tileID=a.retainedQueryData[s.bucketInstanceId].tileID;var t=a.transform.elevation;(t||e.elevation)&&(e.elevation=t?t.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0)},Z=o.textBox;if(Z){W(Z);var X=function(n){var i=e.WritingMode.horizontal;if(s.allowVerticalPlacement&&!n&&a.prevPlacement){var r=a.prevPlacement.placedOrientations[m];r&&(a.placedOrientations[m]=r,i=r,a.markUsedOrientation(s,i,t))}return i},K=function(t,n){if(s.allowVerticalPlacement&&T>0&&o.verticalTextBox){var i,r=_createForOfIteratorHelper(s.writingModes);try{for(r.s();!(i=r.n()).done;){if(i.value===e.WritingMode.vertical?(F=n(),j=F):F=t(),F&&F.box&&F.box.length)break}}catch(a){r.e(a)}finally{r.f()}}else F=t()};if(l.get("text-variable-anchor")){var Y=l.get("text-variable-anchor");if(a.prevPlacement&&a.prevPlacement.variableOffsets[m]){var J=a.prevPlacement.variableOffsets[m];Y.indexOf(J.anchor)>0&&(Y=Y.filter((function(e){return e!==J.anchor}))).unshift(J.anchor)}var Q=function(e,n,i){var o=s.getSymbolInstanceTextSize(v,t,a.transform.zoom,r),l=(e.x2-e.x1)*o+2*e.padding,c=(e.y2-e.y1)*o+2*e.padding,h=S&&!w?n:null;h&&W(h);for(var d={box:[],offscreen:!1,occluded:!1},p=b?2*Y.length:Y.length,m=0;m<p;++m){var _=a.attemptAnchorPlacement(Y[m%Y.length],e,l,c,o,k,C,f,u,y,m>=Y.length,t,r,s,i,h,v,g);if(_&&((d=_.placedGlyphBoxes)&&d.box&&d.box.length)){O=!0,B=_.shift;break}}return d};K((function(){return Q(Z,o.iconBox,e.WritingMode.horizontal)}),(function(){var t=o.verticalTextBox;return t&&W(t),s.allowVerticalPlacement&&!(F&&F.box&&F.box.length)&&T>0&&t?Q(t,o.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),F&&(O=F.box,D=F.offscreen,z=F.occluded);var $=X(!(!F||!F.box));if(!O&&a.prevPlacement){var ee=a.prevPlacement.variableOffsets[m];ee&&(a.variableOffsets[m]=ee,a.markUsedJustification(s,ee.anchor,t,$))}}else{var te=function(n,i){var o=s.getSymbolInstanceTextSize(v,t,a.transform.zoom,r),l=a.collisionIndex.placeCollisionBox(s,o,n,new e.Point(0,0),b,f,u,y.predicate);return l&&l.box&&l.box.length&&(a.markUsedOrientation(s,i,t),a.placedOrientations[m]=i),l};K((function(){return te(Z,e.WritingMode.horizontal)}),(function(){var t=o.verticalTextBox;return s.allowVerticalPlacement&&T>0&&t?(W(t),te(t,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),X(!!(F&&F.box&&F.box.length))}}if(O=(R=F)&&R.box&&R.box.length>0,D=R&&R.offscreen,z=R&&R.occluded,t.useRuntimeCollisionCircles){var ne=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),ie=e.evaluateSizeForFeature(s.textSizeData,v,ne),re=l.get("text-padding");H=a.collisionIndex.placeCollisionCircles(s,b,ne,s.lineVertexArray,s.glyphOffsetArray,ie,u,c,h,i,C,y.predicate,t.collisionCircleDiameter*ie/e.ONE_EM,re,a.retainedQueryData[s.bucketInstanceId].tileID),O=b||H.circles.length>0&&!H.collisionDetected,D=D&&H.offscreen,z=H.occluded}if(o.iconFeatureIndex&&(G=o.iconFeatureIndex),o.iconBox){var ae=function(n){W(n);var i=S&&B?Tt(B.x,B.y,k,C,a.transform.angle):new e.Point(0,0),r=s.getSymbolInstanceIconSize(g,a.transform.zoom,t.placedIconSymbolIndex);return a.collisionIndex.placeCollisionBox(s,r,n,i,w,f,u,y.predicate)};j&&j.box&&j.box.length&&o.verticalIconBox?N=(V=ae(o.verticalIconBox)).box.length>0:N=(V=ae(o.iconBox)).box.length>0,D=D&&V.offscreen,L=V.occluded}var oe=_||0===t.numHorizontalGlyphVertices&&0===T,se=x||0===t.numIconVertices;if(oe||se?se?oe||(N=N&&O):O=N&&O:N=O=N&&O,O&&R&&R.box&&a.collisionIndex.insertCollisionBox(R.box,l.get("text-ignore-placement"),s.bucketInstanceId,j&&j.box&&q?q:U,y.ID),N&&V&&a.collisionIndex.insertCollisionBox(V.box,l.get("icon-ignore-placement"),s.bucketInstanceId,G,y.ID),H&&(O&&a.collisionIndex.insertCollisionCircles(H.circles,l.get("text-ignore-placement"),s.bucketInstanceId,U,y.ID),i)){var le=s.bucketInstanceId,ue=a.collisionCircleArrays[le];void 0===ue&&(ue=a.collisionCircleArrays[le]=new wt);for(var ce=0;ce<H.circles.length;ce+=4)ue.circles.push(H.circles[ce+0]),ue.circles.push(H.circles[ce+1]),ue.circles.push(H.circles[ce+2]),ue.circles.push(H.collisionDetected?1:0)}var he="globe"!==s.projection.name;E=E&&(he||!z),P=P&&(he||!L),a.placements[m]=new bt(O||E,N||P,D||s.justReloaded),n.add(m)}};if(T)for(var I=s.getSortedSymbolIndexes(this.transform.angle),A=I.length-1;A>=0;--A){var R=I[A];M(s.symbolInstances.get(R),R,s.collisionArrays[R])}else for(var O=t.symbolInstanceStart;O<t.symbolInstanceEnd;O++)M(s.symbolInstances.get(O),O,s.collisionArrays[O]);if(i&&s.bucketInstanceId in this.collisionCircleArrays){var N=this.collisionCircleArrays[s.bucketInstanceId];e.invert(N.invProjMatrix,u),N.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}},{key:"markUsedJustification",value:function(t,n,i,r){var a=i.leftJustifiedTextSymbolIndex,o=i.centerJustifiedTextSymbolIndex,s=i.rightJustifiedTextSymbolIndex,l=i.verticalPlacedTextSymbolIndex,u=i.crossTileID,c=e.getAnchorJustification(n),h=r===e.WritingMode.vertical?l:"left"===c?a:"center"===c?o:"right"===c?s:-1;a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:u),o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:u),s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:u),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:u)}},{key:"markUsedOrientation",value:function(t,n,i){var r=n===e.WritingMode.horizontal||n===e.WritingMode.horizontalOnly?n:0,a=n===e.WritingMode.vertical?n:0,o=i.leftJustifiedTextSymbolIndex,s=i.centerJustifiedTextSymbolIndex,l=i.rightJustifiedTextSymbolIndex,u=i.verticalPlacedTextSymbolIndex,c=t.text.placedSymbolArray;o>=0&&(c.get(o).placedOrientation=r),s>=0&&(c.get(s).placedOrientation=r),l>=0&&(c.get(l).placedOrientation=r),u>=0&&(c.get(u).placedOrientation=a)}},{key:"commit",value:function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var i=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=r[s];u?(this.opacities[s]=new xt(u,i,l.text,l.icon,null,l.clipped),n=n||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new xt(null,i,l.text,l.icon,l.skipFade,l.clipped),n=n||l.text||l.icon)}for(var c in r){var h=r[c];if(!this.opacities[c]){var d=new xt(h,i,!1,!1);d.isHidden()||(this.opacities[c]=d,n=n||h.text.placed||h.icon.placed)}}for(var f in a)this.variableOffsets[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.variableOffsets[f]=a[f]);for(var p in o)this.placedOrientations[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.placedOrientations[p]=o[p]);n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}},{key:"updateLayerOpacities",value:function(e,t){var n,i=new Set,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=a.getBucket(e);o&&a.latestFeatureIndex&&e.id===o.layerIds[0]&&this.updateBucketOpacities(o,i,a.collisionBoxArray)}}catch(s){r.e(s)}finally{r.f()}}},{key:"updateBucketOpacities",value:function(t,n,i){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var r=t.layers[0].layout,a=!!t.layers[0].dynamicFilter(),o=new xt(null,0,!1,!1,!0),s=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),u=r.get("text-variable-anchor"),c="map"===r.get("text-rotation-alignment"),h="map"===r.get("text-pitch-alignment"),d="none"!==r.get("icon-text-fit"),f=new xt(null,0,s&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(s||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);for(var p=function(e,t,n){for(var i=0;i<t/4;i++)e.opacityVertexArray.emplaceBack(n)},m=0,v=0;v<t.symbolInstances.length;v++){var g=t.symbolInstances.get(v),y=g.numHorizontalGlyphVertices,_=g.numVerticalGlyphVertices,x=g.crossTileID,b=g.numIconVertices,w=n.has(x),k=this.opacities[x];w?k=o:k||(k=f,this.opacities[x]=k),n.add(x);var C=y>0||_>0,S=b>0,T=this.placedOrientations[x],E=T===e.WritingMode.vertical,P=T===e.WritingMode.horizontal||T===e.WritingMode.horizontalOnly;if(!C&&!S||k.isHidden()||m++,C){var M=zt(k.text);p(t.text,y,E?Lt:M),p(t.text,_,P?Lt:M);var I=k.text.isHidden(),A=g.leftJustifiedTextSymbolIndex,R=g.centerJustifiedTextSymbolIndex,O=g.rightJustifiedTextSymbolIndex,N=g.verticalPlacedTextSymbolIndex,D=t.text.placedSymbolArray,z=I||E?1:0;A>=0&&(D.get(A).hidden=z),R>=0&&(D.get(R).hidden=z),O>=0&&(D.get(O).hidden=z),N>=0&&(D.get(N).hidden=I||P?1:0);var L=this.variableOffsets[x];L&&this.markUsedJustification(t,L.anchor,g,T);var B=this.placedOrientations[x];B&&(this.markUsedJustification(t,"left",g,B),this.markUsedOrientation(t,B,g))}if(S){var F=zt(k.icon),j=g.placedIconSymbolIndex,H=g.verticalPlacedIconSymbolIndex,V=t.icon.placedSymbolArray,U=k.icon.isHidden()?1:0;j>=0&&(p(t.icon,b,E?Lt:F),V.get(j).hidden=U),H>=0&&(p(t.icon,g.numVerticalIconVertices,P?Lt:F),V.get(H).hidden=U)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var q=t.collisionArrays[v];if(q){var G=new e.Point(0,0),W=!0;if(q.textBox||q.verticalTextBox){if(u){var Z=this.variableOffsets[x];Z?(G=St(Z.anchor,Z.width,Z.height,Z.textOffset,Z.textScale),c&&G._rotate(h?this.transform.angle:-this.transform.angle)):W=!1}a&&(W=!k.clipped),q.textBox&&Pt(t.textCollisionBox.collisionVertexArray,k.text.placed,!W||E,G.x,G.y),q.verticalTextBox&&Pt(t.textCollisionBox.collisionVertexArray,k.text.placed,!W||P,G.x,G.y)}var X=W&&Boolean(!P&&q.verticalIconBox);q.iconBox&&Pt(t.iconCollisionBox.collisionVertexArray,k.icon.placed,X,d?G.x:0,d?G.y:0),q.verticalIconBox&&Pt(t.iconCollisionBox.collisionVertexArray,k.icon.placed,!X,d?G.x:0,d?G.y:0)}}}if(t.fullyClipped=0===m,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var K=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=K.invProjMatrix,t.placementViewportMatrix=K.viewportMatrix,t.collisionCircleArray=K.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}},{key:"symbolFadeChange",value:function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}},{key:"zoomAdjustment",value:function(e){return Math.max(0,(this.transform.zoom-e)/1.5)}},{key:"hasTransitions",value:function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}},{key:"stillRecent",value:function(e,t){var n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}},{key:"setStale",value:function(){this.stale=!0}}]),t}();function Pt(e,t,n,i,r){e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0)}var Mt=Math.pow(2,25),It=Math.pow(2,24),At=Math.pow(2,17),Rt=Math.pow(2,16),Ot=Math.pow(2,9),Nt=Math.pow(2,8),Dt=Math.pow(2,1);function zt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*Mt+t*It+n*At+t*Rt+n*Ot+t*Nt+n*Dt+t}var Lt=0,Bt=function(){function e(t){_classCallCheck(this,e),this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}return _createClass(e,[{key:"continuePlacement",value:function(e,t,n,i,r){for(var a=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(a,i,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<a.length;){var o=a[this._currentPartIndex];if(t.placeLayerBucketPart(o,this._seenCrossTileIDs,n,0===o.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}]),e}(),Ft=function(){function t(e,n,i,r,a,o,s,l){_classCallCheck(this,t),this.placement=new Et(e,a,o,s,l),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}return _createClass(t,[{key:"isDone",value:function(){return this._done}},{key:"continuePlacement",value:function(t,n,i){for(var r=this,a=e.exported.now(),o=function(){var t=e.exported.now()-a;return!r._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=n[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Bt(s)),this._inProgressLayer.continuePlacement(i[s.source],this.placement,this._showCollisionBoxes,s,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}},{key:"commit",value:function(e){return this.placement.commit(e),this.placement}}]),t}(),jt=512/e.EXTENT/2,Ht=function(){function t(n,i,r){_classCallCheck(this,t),this.tileID=n,this.bucketInstanceId=r,this.index=new e.KDBush(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];for(var a=n.canonical.x*e.EXTENT,o=n.canonical.y*e.EXTENT,s=0;s<i.length;s++){var l=i.get(s),u=l.key,c=l.crossTileID,h=l.tileAnchorX,d=l.tileAnchorY,f=Math.floor((a+h)*jt),p=Math.floor((o+d)*jt);this.index.add(f,p),this.keys.push(u),this.crossTileIDs.push(c)}this.index.finish()}return _createClass(t,[{key:"findMatches",value:function(t,n,i){for(var r=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),a=jt/Math.pow(2,n.canonical.z-this.tileID.canonical.z),o=n.canonical.x*e.EXTENT,s=n.canonical.y*e.EXTENT,l=0;l<t.length;l++){var u=t.get(l);if(!u.crossTileID){var c,h=u.key,d=u.tileAnchorX,f=u.tileAnchorY,p=Math.floor((o+d)*a),m=Math.floor((s+f)*a),v=_createForOfIteratorHelper(this.index.range(p-r,m-r,p+r,m+r));try{for(v.s();!(c=v.n()).done;){var g=c.value,y=this.crossTileIDs[g];if(this.keys[g]===h&&!i.has(y)){i.add(y),u.crossTileID=y;break}}}catch(_){v.e(_)}finally{v.f()}}}}}]),t}(),Vt=function(){function e(){_classCallCheck(this,e),this.maxCrossTileID=0}return _createClass(e,[{key:"generate",value:function(){return++this.maxCrossTileID}}]),e}(),Ut=function(){function e(){_classCallCheck(this,e),this.indexes={},this.usedCrossTileIDs={},this.lng=0}return _createClass(e,[{key:"handleWrapJump",value:function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var n in this.indexes){var i=this.indexes[n],r={};for(var a in i){var o=i[a];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),r[o.tileID.key]=o}this.indexes[n]=r}this.lng=e}},{key:"addBucket",value:function(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);var r=this.usedCrossTileIDs[e.overscaledZ];for(var a in this.indexes){var o=this.indexes[a];if(Number(a)>e.overscaledZ)for(var s in o){var l=o[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,r)}else{var u=o[e.scaledTo(Number(a)).key];u&&u.findMatches(t.symbolInstances,e,r)}}for(var c=0;c<t.symbolInstances.length;c++){var h=t.symbolInstances.get(c);h.crossTileID||(h.crossTileID=n.generate(),r.add(h.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ht(e,t.symbolInstances,t.bucketInstanceId),!0}},{key:"removeBucketCrossTileIDs",value:function(e,t){var n,i=_createForOfIteratorHelper(t.crossTileIDs);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.usedCrossTileIDs[e].delete(r)}}catch(a){i.e(a)}finally{i.f()}}},{key:"removeStaleBuckets",value:function(e){var t=!1;for(var n in this.indexes){var i=this.indexes[n];for(var r in i)e[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],t=!0)}return t}}]),e}(),qt=function(){function e(){_classCallCheck(this,e),this.layerIndexes={},this.crossTileIDs=new Vt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}return _createClass(e,[{key:"addLayer",value:function(e,t,n,i){var r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new Ut);var a=!1,o={};"globe"!==i.name&&r.handleWrapJump(n);var s,l=_createForOfIteratorHelper(t);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=u.getBucket(e);c&&e.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(a=!0),o[c.bucketInstanceId]=!0)}}catch(h){l.e(h)}finally{l.f()}return r.removeStaleBuckets(o)&&(a=!0),a}},{key:"pruneUnusedLayers",value:function(e){var t={};for(var n in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[n]||delete this.layerIndexes[n]}}]),e}(),Gt=function(t,n){return e.emitValidationErrors(t,n&&n.filter((function(e){return"source.canvas"!==e.identifier})))},Wt=e.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zt=e.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),Xt={version:8,layers:[],sources:{}},Kt={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0},Yt=function(n){function i(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,i),(n=_callSuper(this,i)).map=t,n.dispatcher=new M(Fe(),_assertThisInitialized2(n)),n.imageManager=new x,n.imageManager.setEventedParent(_assertThisInitialized2(n)),n.glyphManager=new e.GlyphManager(t._requestManager,r.localFontFamily?e.LocalGlyphMode.all:r.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,r.localFontFamily||r.localIdeographFontFamily),n.crossTileSymbolIndex=new qt,n._layers={},n._num3DLayers=0,n._numSymbolLayers=0,n._numCircleLayers=0,n._serializedLayers={},n._sourceCaches={},n._otherSourceCaches={},n._symbolSourceCaches={},n._loaded=!1,n._availableImages=[],n._order=[],n._drapedFirstOrder=[],n._markersNeedUpdate=!1,n._resetUpdates(),n.dispatcher.broadcast("setReferrer",e.getReferrer());var a=_assertThisInitialized2(n);return n._rtlTextPluginCallback=i.registerForPluginStateChange((function(t){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,n){if(e.triggerPluginCompletionEvent(t),n&&n.every((function(e){return e})))for(var i in a._sourceCaches){var r=a._sourceCaches[i],o=r.getSource().type;"vector"!==o&&"geojson"!==o||r.reload()}}))})),n.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=n.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(var i in n._layers){var r=n._layers[i];r.source===t.id&&n._validateLayer(r)}}})),n}return _inherits(i,n),_createClass(i,[{key:"loadURL",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof i.validate?i.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,i.accessToken);var a=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(a,(function(t,i){n._request=null,t?n.fire(new e.ErrorEvent(t)):i&&n._load(i,r)}))}},{key:"loadJSON",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((function(){n._request=null,n._load(t,!1!==i.validate)}))}},{key:"loadEmpty",value:function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Xt,!1)}},{key:"_updateLayerCount",value:function(e,t){var n=t?1:-1;e.is3D()&&(this._num3DLayers+=n),"circle"===e.type&&(this._numCircleLayers+=n),"symbol"===e.type&&(this._numSymbolLayers+=n)}},{key:"_load",value:function(t,n){if(!n||!Gt(this,e.validateStyle(t))){for(var i in this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection(),t.sources)this.addSource(i,t.sources[i],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);var r=He(this.stylesheet.layers);this._order=r.map((function(e){return e.id})),this._layers={},this._serializedLayers={};var a,o=_createForOfIteratorHelper(r);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=e.createStyleLayer(s);l.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=l,this._serializedLayers[l.id]=l.serialize(),this._updateLayerCount(l,!0)}}catch(u){o.e(u)}finally{o.f()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}}},{key:"terrainSetForDrapingOnly",value:function(){return!!this.terrain&&0===this.terrain.drapeRenderMode}},{key:"setProjection",value:function(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}},{key:"applyProjectionUpdate",value:function(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}},{key:"_updateMapProjection",value:function(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}},{key:"_loadSprite",value:function(t){var n=this;this._spriteRequest=function(t,n,i){var r,a,o,s=e.exported.devicePixelRatio>1?"@2x":"",l=e.getJSON(n.transformRequest(n.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){l=null,o||(o=e,r=t,c())})),u=e.getImage(n.transformRequest(n.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){u=null,o||(o=e,a=t,c())}));function c(){if(o)i(o);else if(r&&a){var t=e.exported.getImageData(a),n={};for(var s in r){var l=r[s],u=l.width,c=l.height,h=l.x,d=l.y,f=l.sdf,p=l.pixelRatio,m=l.stretchX,v=l.stretchY,g=l.content,y=new e.RGBAImage({width:u,height:c});e.RGBAImage.copy(t,y,{x:h,y:d},{x:0,y:0},{width:u,height:c}),n[s]={data:y,pixelRatio:p,sdf:f,stretchX:m,stretchY:v,content:g}}i(null,n)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(t,this.map._requestManager,(function(t,i){if(n._spriteRequest=null,t)n.fire(new e.ErrorEvent(t));else if(i)for(var r in i)n.imageManager.addImage(r,i[r]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.dispatcher.broadcast("spriteLoaded",!0),n.fire(new e.Event("data",{dataType:"style"}))}))}},{key:"_validateLayer",value:function(t){var n=this.getSource(t.source);if(n){var i=t.sourceLayer;i&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new e.ErrorEvent(new Error('Source layer "'.concat(i,'" does not exist on source "').concat(n.id,'" as specified by style layer "').concat(t.id,'"'))))}}},{key:"loaded",value:function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}},{key:"_serializeLayers",value:function(e){var t,n=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var r=t.value,a=this._layers[r];"custom"!==a.type&&n.push(a.serialize())}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"hasTransitions",value:function(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(var e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}},{key:"order",get:function(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}},{key:"isLayerDraped",value:function(e){return!!this.terrain&&("function"==typeof e.isLayerDraped?e.isLayerDraped():Kt[e.type])}},{key:"_checkLoaded",value:function(){if(!this._loaded)throw new Error("Style is not done loading")}},{key:"update",value:function(t){if(this._loaded){var n=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var a in(i.length||r.length)&&this._updateWorkerLayers(i,r),this._updatedSources){var o=this._updatedSources[a];"reload"===o?this._reloadSource(a):"clear"===o&&this._clearSource(a)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}var l={};for(var u in this._sourceCaches){var c=this._sourceCaches[u];l[u]=c.used,c.used=!1}var h,d=_createForOfIteratorHelper(this._order);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=this._layers[f];if(p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)){var m=this._getLayerSourceCache(p);m&&(m.used=!0)}var v=this.map.painter;if(v){var g=p.getProgramIds();if(!g)continue;var y,_=p.getProgramConfiguration(t.zoom),x=_createForOfIteratorHelper(g);try{for(x.s();!(y=x.n()).done;){var b=y.value;v.useProgram(b,_)}}catch(C){x.e(C)}finally{x.f()}}}}catch(C){d.e(C)}finally{d.f()}for(var w in l){var k=this._sourceCaches[w];l[w]!==k.used&&k.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:k.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new e.Event("data",{dataType:"style"}))}}},{key:"_updateTilesForChangedImages",value:function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}},{key:"_updateWorkerLayers",value:function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}},{key:"_resetUpdates",value:function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}},{key:"setState",value:function(n){var i=this;if(this._checkLoaded(),Gt(this,e.validateStyle(n)))return!1;(n=e.clone$1(n)).layers=He(n.layers);var r=function(e,n){if(!e)return[{command:Ve.setStyle,args:[n]}];var i=[];try{if(!t(e.version,n.version))return[{command:Ve.setStyle,args:[n]}];t(e.center,n.center)||i.push({command:Ve.setCenter,args:[n.center]}),t(e.zoom,n.zoom)||i.push({command:Ve.setZoom,args:[n.zoom]}),t(e.bearing,n.bearing)||i.push({command:Ve.setBearing,args:[n.bearing]}),t(e.pitch,n.pitch)||i.push({command:Ve.setPitch,args:[n.pitch]}),t(e.sprite,n.sprite)||i.push({command:Ve.setSprite,args:[n.sprite]}),t(e.glyphs,n.glyphs)||i.push({command:Ve.setGlyphs,args:[n.glyphs]}),t(e.transition,n.transition)||i.push({command:Ve.setTransition,args:[n.transition]}),t(e.light,n.light)||i.push({command:Ve.setLight,args:[n.light]}),t(e.fog,n.fog)||i.push({command:Ve.setFog,args:[n.fog]}),t(e.projection,n.projection)||i.push({command:Ve.setProjection,args:[n.projection]});var r={},a=[];!function(e,n,i,r){var a;for(a in n=n||{},e=e||{})e.hasOwnProperty(a)&&(n.hasOwnProperty(a)||qe(a,i,r));for(a in n)if(n.hasOwnProperty(a)){var o=n[a];e.hasOwnProperty(a)?t(e[a],o)||("geojson"===e[a].type&&"geojson"===o.type&&We(e,n,a)?i.push({command:Ve.setGeoJSONSourceData,args:[a,o.data]}):Ge(a,n,i,r)):Ue(a,n,i)}}(e.sources,n.sources,a,r);var o=[];e.layers&&e.layers.forEach((function(e){e.source&&r[e.source]?i.push({command:Ve.removeLayer,args:[e.id]}):o.push(e)}));var s=e.terrain;s&&r[s.source]&&(i.push({command:Ve.setTerrain,args:[void 0]}),s=void 0),i=i.concat(a),t(s,n.terrain)||i.push({command:Ve.setTerrain,args:[n.terrain]}),function(e,n,i){n=n||[];var r,a,o,s,l,u,c,h=(e=e||[]).map(Xe),d=n.map(Xe),f=e.reduce(Ke,{}),p=n.reduce(Ke,{}),m=h.slice(),v=Object.create(null);for(r=0,a=0;r<h.length;r++)o=h[r],p.hasOwnProperty(o)?a++:(i.push({command:Ve.removeLayer,args:[o]}),m.splice(m.indexOf(o,a),1));for(r=0,a=0;r<d.length;r++)o=d[d.length-1-r],m[m.length-1-r]!==o&&(f.hasOwnProperty(o)?(i.push({command:Ve.removeLayer,args:[o]}),m.splice(m.lastIndexOf(o,m.length-a),1)):a++,u=m[m.length-r],i.push({command:Ve.addLayer,args:[p[o],u]}),m.splice(m.length-r,0,o),v[o]=!0);for(r=0;r<d.length;r++)if(s=f[o=d[r]],l=p[o],!v[o]&&!t(s,l))if(t(s.source,l.source)&&t(s["source-layer"],l["source-layer"])&&t(s.type,l.type)){for(c in Ze(s.layout,l.layout,i,o,null,Ve.setLayoutProperty),Ze(s.paint,l.paint,i,o,null,Ve.setPaintProperty),t(s.filter,l.filter)||i.push({command:Ve.setFilter,args:[o,l.filter]}),t(s.minzoom,l.minzoom)&&t(s.maxzoom,l.maxzoom)||i.push({command:Ve.setLayerZoomRange,args:[o,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ze(s[c],l[c],i,o,c.slice(6),Ve.setPaintProperty):t(s[c],l[c])||i.push({command:Ve.setLayerProperty,args:[o,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ze(s[c],l[c],i,o,c.slice(6),Ve.setPaintProperty):t(s[c],l[c])||i.push({command:Ve.setLayerProperty,args:[o,c,l[c]]}))}else i.push({command:Ve.removeLayer,args:[o]}),u=m[m.lastIndexOf(o)+1],i.push({command:Ve.addLayer,args:[l,u]})}(o,n.layers,i)}catch(e){console.warn("Unable to compute style diff:",e),i=[{command:Ve.setStyle,args:[n]}]}return i}(this.serialize(),n).filter((function(e){return!(e.command in Zt)}));if(0===r.length)return!1;var a=r.filter((function(e){return!(e.command in Wt)}));if(a.length>0)throw new Error("Unimplemented: ".concat(a.map((function(e){return e.command})).join(", "),"."));return r.forEach((function(e){"setTransition"!==e.command&&"setProjection"!==e.command&&i[e.command].apply(i,e.args)})),this.stylesheet=n,this._updateMapProjection(),!0}},{key:"addImage",value:function(t,n){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,n),this._afterImageUpdated(t),this)}},{key:"updateImage",value:function(e,t){this.imageManager.updateImage(e,t)}},{key:"getImage",value:function(e){return this.imageManager.getImage(e)}},{key:"removeImage",value:function(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}},{key:"_afterImageUpdated",value:function(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}},{key:"listImages",value:function(){return this._checkLoaded(),this._availableImages.slice()}},{key:"addSource",value:function(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(e.validateSource,"sources."+t,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var a=Ie(t,n,this.dispatcher,this);a.setEventedParent(this,(function(){return{isSourceLoaded:i._isSourceCacheLoaded(t),source:a.serialize(),sourceId:t}}));var o=function(n){var r=(n?"symbol:":"other:")+t,o=i._sourceCaches[r]=new e.SourceCache(r,a,n);(n?i._symbolSourceCaches:i._otherSourceCaches)[t]=o,o.style=i,o.onAdd(i.map)};o(!1),"vector"!==n.type&&"geojson"!==n.type||o(!0),a.onAdd&&a.onAdd(this.map),this._changed=!0}}},{key:"removeSource",value:function(t){this._checkLoaded();var n=this.getSource(t);if(!n)throw new Error("There is no source with this ID");for(var i in this._layers)if(this._layers[i].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(i,'" is using it.'))));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while terrain is using it.'))));var r,a=_createForOfIteratorHelper(this._getSourceCaches(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;delete this._sourceCaches[o.id],delete this._updatedSources[o.id],o.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o.getSource().id})),o.setEventedParent(null),o.clearTiles()}}catch(s){a.e(s)}finally{a.f()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0,this}},{key:"setGeoJSONSourceData",value:function(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}},{key:"getSource",value:function(e){var t=this._getSourceCache(e);return t&&t.getSource()}},{key:"_getSources",value:function(){var e=[];for(var t in this._otherSourceCaches){var n=this._getSourceCache(t);n&&e.push(n.getSource())}return e}},{key:"addLayer",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var r=t.id;if(this.getLayer(r))this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(r,'" already exists on this map'))));else{var a;if("custom"===t.type){if(Gt(this,e.validateCustomStyleLayer(t)))return;a=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=e.clone$1(t),t=e.extend(t,{source:r})),this._validate(e.validateLayer,"layers."+r,t,{arrayIndex:-1},i))return;a=e.createStyleLayer(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[a.id]=a.serialize(),this._updateLayerCount(a,!0)}var o=n?this._order.indexOf(n):this._order.length;if(n&&-1===o)this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.'))));else{this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=a;var s=this._getLayerSourceCache(a);if(this._removedLayers[r]&&a.source&&s&&"custom"!==a.type){var l=this._removedLayers[r];delete this._removedLayers[r],l.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",s.pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map),this._updateDrapeFirstLayers()}}}},{key:"moveLayer",value:function(t,n){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==n){var i=this._order.indexOf(t);this._order.splice(i,1);var r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.')))):(this._order.splice(r,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be moved."))))}},{key:"removeLayer",value:function(t){this._checkLoaded();var n=this._layers[t];if(n){n.setEventedParent(null),this._updateLayerCount(n,!1);var i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be removed."))))}},{key:"getLayer",value:function(e){return this._layers[e]}},{key:"hasLayer",value:function(e){return e in this._layers}},{key:"hasLayerType",value:function(e){for(var t in this._layers)if(this._layers[t].type===e)return!0;return!1}},{key:"setLayerZoomRange",value:function(t,n,i){this._checkLoaded();var r=this.getLayer(t);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot have zoom extent."))))}},{key:"setFilter",value:function(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var a=this.getLayer(n);if(a){if(!t(a.filter,i))return null==i?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(e.validateFilter,"layers.".concat(a.id,".filter"),i,{layerType:a.type},r)||(a.filter=e.clone$1(i),this._updateLayer(a)))}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be filtered."))))}},{key:"getFilter",value:function(t){var n=this.getLayer(t);return n&&e.clone$1(n.filter)}},{key:"setLayoutProperty",value:function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(n);o?t(o.getLayoutProperty(i),r)||(o.setLayoutProperty(i,r,a),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}},{key:"getLayoutProperty",value:function(t,n){var i=this.getLayer(t);if(i)return i.getLayoutProperty(n);this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style."))))}},{key:"setPaintProperty",value:function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(n);o?t(o.getPaintProperty(i),r)||(o.setPaintProperty(i,r,a)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new e.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}},{key:"getPaintProperty",value:function(e,t){var n=this.getLayer(e);return n&&n.getPaintProperty(t)}},{key:"setFeatureState",value:function(t,n){this._checkLoaded();var i=t.source,r=t.sourceLayer,a=this.getSource(i);if(a){var o=a.type;if("geojson"===o&&r)this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));else if("vector"!==o||r){void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));var s,l=_createForOfIteratorHelper(this._getSourceCaches(i));try{for(l.s();!(s=l.n()).done;){s.value.setFeatureState(r,t.id,n)}}catch(u){l.e(u)}finally{l.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(i,"' does not exist in the map's style."))))}},{key:"removeFeatureState",value:function(t,n){this._checkLoaded();var i=t.source,r=this.getSource(i);if(r){var a=r.type,o="vector"===a?t.sourceLayer:void 0;if("vector"!==a||o)if(n&&"string"!=typeof t.id&&"number"!=typeof t.id)this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));else{var s,l=_createForOfIteratorHelper(this._getSourceCaches(i));try{for(l.s();!(s=l.n()).done;){s.value.removeFeatureState(o,t.id,n)}}catch(u){l.e(u)}finally{l.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(i,"' does not exist in the map's style."))))}},{key:"getFeatureState",value:function(t){this._checkLoaded();var n=t.source,i=t.sourceLayer,r=this.getSource(n);if(r){if("vector"!==r.type||i)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(i,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"getTransition",value:function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}},{key:"serialize",value:function(){var t={};for(var n in this._sourceCaches){var i=this._sourceCaches[n].getSource();t[i.id]||(t[i.id]=i.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))}},{key:"_updateLayer",value:function(e){this._updatedLayers[e.id]=!0;var t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}},{key:"_flattenAndSortRenderedFeatures",value:function(e){for(var t=this,n=function(e){return"fill-extrusion"===t._layers[e].type},i={},r=[],a=this._order.length-1;a>=0;a--){var o=this._order[a];if(n(o)){i[o]=a;var s,l=_createForOfIteratorHelper(e);try{for(l.s();!(s=l.n()).done;){var u=s.value[o];if(u){var c,h=_createForOfIteratorHelper(u);try{for(h.s();!(c=h.n()).done;){var d=c.value;r.push(d)}}catch(C){h.e(C)}finally{h.f()}}}}catch(C){l.e(C)}finally{l.f()}}}r.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var f=[],p=this._order.length-1;p>=0;p--){var m=this._order[p];if(n(m))for(var v=r.length-1;v>=0;v--){var g=r[v].feature;if(i[g.layer.id]<p)break;f.push(g),r.pop()}else{var y,_=_createForOfIteratorHelper(e);try{for(_.s();!(y=_.n()).done;){var x=y.value[m];if(x){var b,w=_createForOfIteratorHelper(x);try{for(w.s();!(b=w.n()).done;){var k=b.value;f.push(k.feature)}}catch(C){w.e(C)}finally{w.f()}}}}catch(C){_.e(C)}finally{_.f()}}}return f}},{key:"queryRenderedFeatures",value:function(t,n,i){var r=this;n&&n.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",n.filter,null,n);var a={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];var o,s=_createForOfIteratorHelper(n.layers);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=this._layers[l];if(!u)return this.fire(new e.ErrorEvent(new Error("The layer '".concat(l,"' does not exist in the map's style and cannot be queried for features.")))),[];a[u.source]=!0}}catch(m){s.e(m)}finally{s.f()}}var c=[];n.availableImages=this._availableImages;var h=n&&n.layers?n.layers.some((function(e){var t=r.getLayer(e);return t&&t.is3D()})):this.has3DLayers(),d=A.createFromScreenPoints(t,i);for(var f in this._sourceCaches){var p=this._sourceCaches[f].getSource().id;n.layers&&!a[p]||c.push(Re(this._sourceCaches[f],this._layers,this._serializedLayers,d,n,i,h,!!this.map._showQueryGeometry))}return this.placement&&c.push(function(e,t,n,i,r,a,o){var s,l={},u=a.queryRenderedSymbols(i),c=[],h=_createForOfIteratorHelper(Object.keys(u).map(Number));try{for(h.s();!(s=h.n()).done;){var d=s.value;c.push(o[d])}}catch(m){h.e(m)}finally{h.f()}c.sort(Ne);for(var f=function(){var n=v[p],i=n.featureIndex.lookupSymbolFeatures(u[n.bucketInstanceId],t,n.bucketIndex,n.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(var a in i){var o=l[a]=l[a]||[],s=i[a];s.sort((function(e,t){var i=n.featureSortOrder;if(i){var r=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}));var c,h=_createForOfIteratorHelper(s);try{for(h.s();!(c=h.n()).done;){var d=c.value;o.push(d)}}catch(m){h.e(m)}finally{h.f()}}},p=0,v=c;p<v.length;p++)f();var g=function(t){l[t].forEach((function(i){var r=i.feature,a=n(e[t]);if(a){var o=a.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o}}))};for(var y in l)g(y);return l}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),d.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)}},{key:"querySourceFeatures",value:function(t,n){n&&n.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",n.filter,null,n);var i,r=[],a=_createForOfIteratorHelper(this._getSourceCaches(t));try{for(a.s();!(i=a.n()).done;){var o=i.value;r=r.concat(Oe(o,n))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"addSourceType",value:function(e,t,n){return i.getSourceType(e)?n(new Error('A source type called "'.concat(e,'" already exists.'))):(i.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))}},{key:"getLight",value:function(){return this.light.getLight()}},{key:"setLight",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();var i=this.light.getLight(),r=!1;for(var a in e)if(!t(e[a],i[a])){r=!0;break}if(r){var o=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,n),this.light.updateTransitions(o)}}},{key:"getTerrain",value:function(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}},{key:"setTerrainForDraping",value:function(){this.setTerrain({source:"",exaggeration:0},0)}},{key:"setTerrain",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);var r=n;if(1===i){if("object"==typeof r.source){var a="terrain-dem-src";this.addSource(a,r.source),r=e.clone$1(r),r=e.extend(r,{source:a})}if(this._validate(e.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&i!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,i)}else{for(var o=this.terrain,s=o.get(),l=0,u=Object.keys(e.spec.terrain);l<u.length;l++){var c=u[l];!r.hasOwnProperty(c)&&e.spec.terrain[c].default&&(r[c]=e.spec.terrain[c].default)}for(var h in r)if(!t(r[h],s[h])){o.set(r),this.stylesheet.terrain=r;var d=this._setTransitionParameters({duration:0});o.updateTransitions(d);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}},{key:"_createFog",value:function(e){var t=this.fog=new P(e,this.map.transform);this.stylesheet.fog=e;var n=this._setTransitionParameters({duration:0});t.updateTransitions(n)}},{key:"_updateMarkersOpacity",value:function(){var e=this;0!==this.map._markers.length&&this.map._requestDomTask((function(){var t,n=_createForOfIteratorHelper(e.map._markers);try{for(n.s();!(t=n.n()).done;){t.value._evaluateOpacity()}}catch(i){n.e(i)}finally{n.f()}}))}},{key:"getFog",value:function(){return this.fog?this.fog.get():null}},{key:"setFog",value:function(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){var n=this.fog,i=n.get();for(var r in 0===Object.keys(e).length&&n.set(e),e)if(!t(e[r],i[r])){n.set(e),this.stylesheet.fog=e;var a=this._setTransitionParameters({duration:0});n.updateTransitions(a);break}}else this._createFog(e);this._markersNeedUpdate=!0}},{key:"_setTransitionParameters",value:function(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}},{key:"_updateDrapeFirstLayers",value:function(){var e,t,n=this;if(this.map._optimizeForTerrain&&this.terrain){var i=this._order.filter((function(e){return n.isLayerDraped(n._layers[e])})),r=this._order.filter((function(e){return!n.isLayerDraped(n._layers[e])}));this._drapedFirstOrder=[],(e=this._drapedFirstOrder).push.apply(e,_toConsumableArray(i)),(t=this._drapedFirstOrder).push.apply(t,_toConsumableArray(r))}}},{key:"_createTerrain",value:function(e,t){var n=this.terrain=new C(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();var i=this._setTransitionParameters({duration:0});n.updateTransitions(i)}},{key:"_force3DLayerUpdate",value:function(){for(var e in this._layers){var t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}},{key:"_forceSymbolLayerUpdate",value:function(){for(var e in this._layers){var t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}},{key:"_validate",value:function(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&Gt(this,t.call(e.validateStyle,e.extend({key:n,style:this.serialize(),value:i,styleSpec:e.spec},r)))}},{key:"_remove",value:function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}},{key:"_clearSource",value:function(e){var t,n=_createForOfIteratorHelper(this._getSourceCaches(e));try{for(n.s();!(t=n.n()).done;){t.value.clearTiles()}}catch(i){n.e(i)}finally{n.f()}}},{key:"_reloadSource",value:function(e){var t,n=_createForOfIteratorHelper(this._getSourceCaches(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;i.resume(),i.reload()}}catch(r){n.e(r)}finally{n.f()}}},{key:"_reloadSources",value:function(){var e,t=_createForOfIteratorHelper(this._getSources());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.reload&&n.reload()}}catch(i){t.e(i)}finally{t.f()}}},{key:"_updateSources",value:function(e){for(var t in this._sourceCaches)this._sourceCaches[t].update(e)}},{key:"_generateCollisionBoxes",value:function(){for(var e in this._sourceCaches){var t=this._sourceCaches[e];t.resume(),t.reload()}}},{key:"_updatePlacement",value:function(t,n,i,r){var a,o=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=!1,u=!1,c={},h=_createForOfIteratorHelper(this._order);try{var d=function(){var e=a.value,n=o._layers[e];if("symbol"!==n.type)return 0;if(!c[n.source]){var i=o._getLayerSourceCache(n);if(!i)return 0;c[n.source]=i.getRenderableIds(!0).map((function(e){return i.getTileByID(e)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}var r=o.crossTileSymbolIndex.addLayer(n,c[n.source],t.center.lng,t.projection);l=l||r};for(h.s();!(a=h.n()).done;)d()}catch(g){h.e(g)}finally{h.f()}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===i,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new Ft(t,this._order,s,n,i,r,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,c),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),u=!0),l&&this.pauseablePlacement.placement.setStale()),u||l){var f,p=_createForOfIteratorHelper(this._order);try{for(p.s();!(f=p.n()).done;){var m=f.value,v=this._layers[m];"symbol"===v.type&&this.placement.updateLayerOpacities(v,c[v.source])}}catch(g){p.e(g)}finally{p.f()}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}},{key:"_releaseSymbolFadeTiles",value:function(){for(var e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}},{key:"getImages",value:function(e,t,n){this.imageManager.getImages(t.icons,n),this._updateTilesForChangedImages();var i=function(e){e&&e.setDependencies(t.tileID.key,t.type,t.icons)};i(this._otherSourceCaches[t.source]),i(this._symbolSourceCaches[t.source])}},{key:"getGlyphs",value:function(e,t,n){this.glyphManager.getGlyphs(t.stacks,n)}},{key:"getResource",value:function(t,n,i){return e.makeRequest(n,i)}},{key:"_getSourceCache",value:function(e){return this._otherSourceCaches[e]}},{key:"_getLayerSourceCache",value:function(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}},{key:"_getSourceCaches",value:function(e){var t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}},{key:"_isSourceCacheLoaded",value:function(t){var n=this._getSourceCaches(t);return 0===n.length?(this.fire(new e.ErrorEvent(new Error("There is no source with ID '".concat(t,"'")))),!1):n.every((function(e){return e.loaded()}))}},{key:"has3DLayers",value:function(){return this._num3DLayers>0}},{key:"hasSymbolLayers",value:function(){return this._numSymbolLayers>0}},{key:"hasCircleLayers",value:function(){return this._numCircleLayers>0}},{key:"_clearWorkerCaches",value:function(){this.dispatcher.broadcast("clearCaches")}},{key:"destroy",value:function(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}]),i}(e.Evented);Yt.getSourceType=function(e){return Me[e]},Yt.setSourceType=function(e,t){Me[e]=t},Yt.registerForPluginStateChange=e.registerForPluginStateChange;var Jt,Qt,$t="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",en="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",tn="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",nn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",rn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",an=[];cn($t,an),cn(tn,an),cn(nn,an),cn(rn,an),Jt=hn("",tn),Qt=hn(rn,nn);var on=hn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),sn=$t,ln="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",un={background:hn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",en),skyboxGradient:hn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",en),skyboxCapture:hn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function cn(e,t){var n,i=_createForOfIteratorHelper(e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n"));try{for(i.s();!(n=i.n()).done;){var r=n.value;if("#"===(r=r.trim())[0]&&r.includes("if")&&!r.includes("endif")){var a,o=_createForOfIteratorHelper((r=r.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim()).split(" "));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.includes(s)||t.push(s)}}catch(l){o.e(l)}finally{o.f()}}}}catch(l){i.e(l)}finally{i.f()}}function hn(e,t){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),r={},a=[].concat(an);return cn(e,a),cn(t,a),{fragmentSource:e=e.replace(n,(function(e,t,n,i,a){return r[a]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(a,"\nvarying ").concat(n," ").concat(i," ").concat(a,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(a,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(a,"\n    ").concat(n," ").concat(i," ").concat(a," = u_").concat(a,";\n#endif\n")})),vertexSource:t=t.replace(n,(function(e,t,n,i,a){var o="float"===i?"vec2":"vec4",s=a.match(/color/)?"color":o;return r[a]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(a,"\nuniform lowp float u_").concat(a,"_t;\nattribute ").concat(n," ").concat(o," a_").concat(a,";\nvarying ").concat(n," ").concat(i," ").concat(a,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(a,";\n#endif\n"):"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(a,"\n    ").concat(a," = a_").concat(a,";\n#else\n    ").concat(n," ").concat(i," ").concat(a," = u_").concat(a,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(a,"\n    ").concat(a," = unpack_mix_").concat(s,"(a_").concat(a,", u_").concat(a,"_t);\n#else\n    ").concat(n," ").concat(i," ").concat(a," = u_").concat(a,";\n#endif\n"):"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(a,"\nuniform lowp float u_").concat(a,"_t;\nattribute ").concat(n," ").concat(o," a_").concat(a,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(a,";\n#endif\n"):"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(a,"\n    ").concat(n," ").concat(i," ").concat(a," = a_").concat(a,";\n#else\n    ").concat(n," ").concat(i," ").concat(a," = u_").concat(a,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(a,"\n    ").concat(n," ").concat(i," ").concat(a," = unpack_mix_").concat(s,"(a_").concat(a,", u_").concat(a,"_t);\n#else\n    ").concat(n," ").concat(i," ").concat(a," = u_").concat(a,";\n#endif\n")})),staticAttributes:i,usedDefines:a}}var dn=function(){function e(){_classCallCheck(this,e),this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}return _createClass(e,[{key:"bind",value:function(e,t,n,i,r,a,o){this.context=e;for(var s=this.boundPaintVertexBuffers.length!==i.length,l=0;!s&&l<i.length;l++)this.boundPaintVertexBuffers[l]!==i[l]&&(s=!0);for(var u=this.boundDynamicVertexBuffers.length!==o.length,c=0;!u&&c<o.length;c++)this.boundDynamicVertexBuffers[c]!==o[c]&&(u=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||s||u||this.boundIndexBuffer!==r||this.boundVertexOffset!==a)this.freshBind(t,n,i,r,a,o);else{e.bindVertexArrayOES.set(this.vao);var h,d=_createForOfIteratorHelper(o);try{for(d.s();!(h=d.n()).done;){var f=h.value;f&&f.bind()}}catch(p){d.e(p)}finally{d.f()}r&&r.dynamicDraw&&r.bind()}}},{key:"freshBind",value:function(e,t,n,i,r,a){var o,s=e.numAttributes,l=this.context,u=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),o=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffers=a;else{o=l.currentNumAttributes||0;for(var c=s;c<o;c++)u.disableVertexAttribArray(c)}t.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,r);var h,d=_createForOfIteratorHelper(n);try{for(d.s();!(h=d.n()).done;){var f=h.value;f.enableAttributes(u,e),f.bind(),f.setVertexAttribPointers(u,e,r)}}catch(g){d.e(g)}finally{d.f()}var p,m=_createForOfIteratorHelper(a);try{for(m.s();!(p=m.n()).done;){var v=p.value;v&&(v.enableAttributes(u,e),v.bind(),v.setVertexAttribPointers(u,e,r))}}catch(g){m.e(g)}finally{m.f()}i&&i.bind(),l.currentNumAttributes=s}},{key:"destroy",value:function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}]),e}();function fn(t,n){var i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new e.MercatorCoordinate(0,r/i).toLngLat().lat,new e.MercatorCoordinate(0,(r+1)/i).toLngLat().lat]}function pn(t,n,i,r,a,o,s){var l=t.context,u=l.gl,c=i.fbo;if(c){t.prepareDrawTile();var h=t.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());var d=function(e,t,n,i){var r=n.paint.get("hillshade-shadow-color"),a=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color"),s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var l=!e.options.moving;return{u_matrix:i||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:fn(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:a,u_accent:o}}(t,i,r,t.terrain?n.projMatrix:null);t.prepareDrawProgram(l,h,n.toUnwrapped());var f=t.getTileBoundsBuffers(i),p=f.tileBoundsBuffer,m=f.tileBoundsIndexBuffer,v=f.tileBoundsSegments;h.draw(l,u.TRIANGLES,a,o,s,e.CullFaceMode.disabled,d,r.id,p,m,v)}}function mn(t,n,i){if(n.needsDEMTextureUpload){var r=t.context,a=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||t.getTileTexture(i.stride);var o=i.getPixels();n.demTexture?n.demTexture.update(o,{premultiply:!1}):n.demTexture=new e.Texture(r,o,a.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}}function vn(t,n,i,r,a,o){var s=t.context,l=s.gl;if(n.dem){var u=n.dem;if(s.activeTexture.set(l.TEXTURE1),mn(t,n,u),n.demTexture){n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);var c=u.dim;s.activeTexture.set(l.TEXTURE0);var h=n.fbo;if(!h){var d=new e.Texture(s,{width:c,height:c,data:null},l.RGBA);d.bind(l.LINEAR,l.CLAMP_TO_EDGE),(h=n.fbo=s.createFramebuffer(c,c,!0)).colorAttachment.set(d.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,c,c]);var f=t.getMercatorTileBoundsBuffers(),p=f.tileBoundsBuffer,m=f.tileBoundsIndexBuffer,v=f.tileBoundsSegments;t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,o,e.CullFaceMode.disabled,function(t,n){var i=n.stride,r=e.create();return e.ortho(r,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(r,r,[0,-e.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:n.unpackVector}}(n.tileID,u),i.id,p,m,v),n.needsHillshadePrepare=!1}}}var gn=function(t){return{u_matrix:new e.UniformMatrix4f(t),u_image0:new e.Uniform1i(t),u_skirt_height:new e.Uniform1f(t)}},yn=function(e,t){return{u_matrix:e,u_image0:0,u_skirt_height:t}},_n=function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p){return{u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:n,u_zoom_transition:r,u_merc_center:a,u_image0:0,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:c,u_globe_radius:h,u_viewport:d,u_grid_matrix:p?Float32Array.from(p):new Float32Array(9),u_skirt_height:f}};function xn(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}var bn=new(function(){function e(){_classCallCheck(this,e),this.operations={}}return _createClass(e,[{key:"newMorphing",value:function(e,t,n,i,r){if(e in this.operations){var a=this.operations[e];a.to.tileID.key!==n.tileID.key&&(a.queued=n)}else this.operations[e]={startTime:i,phase:0,duration:r,from:t,to:n,queued:null}}},{key:"getMorphValuesForProxy",value:function(e){if(!(e in this.operations))return null;var t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}},{key:"update",value:function(e){for(var t in this.operations){var n=this.operations[t];for(n.phase=(e-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,e)){delete this.operations[t];break}}}},{key:"_nextOp",value:function(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}},{key:"_validOp",value:function(e){return e.from.hasData()&&e.to.hasData()}}]),e}()),wn={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function kn(e){return 6*Math.pow(1.5,22-e)}function Cn(e,t){var n=1<<e.z;return!t&&(0===e.x||e.x===n-1)||0===e.y||e.y===n-1}var Sn=function(e){return{u_matrix:e}};function Tn(t,n,i,r,a){if(a>0){var o=e.exported.now(),s=(o-t.timeAdded)/a,l=n?(o-n.timeAdded)/a:-1,u=i.getSource(),c=r.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),d=h&&t.refreshedUponExpiration?1:e.clamp(h?s:1-l,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var En=function(e){function t(e){var n;_classCallCheck(this,t);var i={type:"raster-dem",maxzoom:e.transform.maxZoom},r=new M(Fe(),null),a=Ie("mock-dem",i,r,e.style);return n=_callSuper(this,t,["mock-dem",a,!1]),a.setEventedParent(_assertThisInitialized2(n)),n._sourceLoaded=!0,n}return _inherits(t,e),_createClass(t,[{key:"_loadTile",value:function(e,t){e.state="loaded",t(null)}}]),t}(e.SourceCache),Pn=function(t){function n(e){var t;_classCallCheck(this,n);var i=Ie("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new M(Fe(),null),e.style);return t=_callSuper(this,n,["proxy",i,!1]),i.setEventedParent(_assertThisInitialized2(t)),t.map=t.getSource().map=e,t.used=t._sourceLoaded=!0,t.renderCache=[],t.renderCachePool=[],t.proxyCachedFBO={},t}return _inherits(n,t),_createClass(n,[{key:"update",value:function(t,n,i){var r=this;if(!t.freezeTileCoverage){this.transform=t;var a=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((function(n,i){if(n[i.key]="",!r._tiles[i.key]){var a=new e.Tile(i,r._source.tileSize*i.overscaleFactor(),t.tileZoom);a.state="loaded",r._tiles[i.key]=a}return n}),{});for(var o in this._tiles)o in a||(this.freeFBO(o),this._tiles[o].unloadVectorData(),delete this._tiles[o])}}},{key:"freeFBO",value:function(e){var t=this.proxyCachedFBO[e];if(void 0!==t){var n,i=Object.values(t);(n=this.renderCachePool).push.apply(n,i),delete this.proxyCachedFBO[e]}}},{key:"deallocRenderCache",value:function(){this.renderCache.forEach((function(e){return e.fb.destroy()})),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}]),n}(e.SourceCache),Mn=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y])).proxyTileKey=n,r.projMatrix=i,r}return _inherits(t,e),_createClass(t)}(e.OverscaledTileID),In=function(t){function n(t,i){var r;_classCallCheck(this,n),(r=_callSuper(this,n)).painter=t,r.terrainTileForTile={},r.prevTerrainTileForTile={};var a=_slicedToArray(function(t){var n=new e.StructArrayLayout2i4,i=new e.StructArrayLayout3ui6,r=131;n.reserve(17161),i.reserve(33800);for(var a=e.EXTENT/128,o=e.EXTENT+a/2,s=o+a,l=-a;l<s;l+=a)for(var u=-a;u<s;u+=a){var c=u<0||u>o||l<0||l>o?24575:0,h=e.clamp(Math.round(u),0,e.EXTENT),d=e.clamp(Math.round(l),0,e.EXTENT);n.emplaceBack(h+c,d)}for(var f=function(e,t){var n=t*r+e;i.emplaceBack(n+1,n,n+r),i.emplaceBack(n+r,n+r+1,n+1)},p=1;p<129;p++)for(var m=1;m<129;m++)f(m,p);return[0,129].forEach((function(e){for(var t=0;t<130;t++)f(t,e),f(e,t)})),[n,i,32768]}(),3),o=a[0],s=a[1],l=a[2],u=t.context;r.gridBuffer=u.createVertexBuffer(o,e.posAttributes.members),r.gridIndexBuffer=u.createIndexBuffer(s),r.gridSegments=e.SegmentVector.simpleSegment(0,0,o.length,s.length),r.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,o.length,l),r.proxyCoords=[],r.proxiedCoords={},r._visibleDemTiles=[],r._drapedRenderBatches=[],r._sourceTilesOverlap={},r.proxySourceCache=new Pn(i.map),r.orthoMatrix=e.create(),e.ortho(r.orthoMatrix,"globe"===r.painter.transform.projection.name?.015:0,e.EXTENT,0,e.EXTENT,0,1);var c=u.gl;return r._overlapStencilMode=new e.StencilMode({func:c.GEQUAL,mask:255},0,255,c.KEEP,c.KEEP,c.REPLACE),r._previousZoom=t.transform.zoom,r.pool=[],r._findCoveringTileCache={},r._tilesDirty={},r.style=i,r._useVertexMorphing=!0,r._exaggeration=1,r._mockSourceCache=new En(i.map),r}return _inherits(n,t),_createClass(n,[{key:"style",set:function(e){var t=this;e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(function(){t._clearLineLayersFromRenderCache()}))}},{key:"update",value:function(t,n,i){var r=this;if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;var a=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(a.get("source")),this._exaggeration=a.get("exaggeration");var o=function(){r.sourceCache.used&&e.warnOnce("Raster DEM source '".concat(r.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));var t=r.getScaledDemTileSize();r.sourceCache.update(n,t,!0),r.resetTileLookupCache(r.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),n.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}},{key:"resetTileLookupCache",value:function(e){this._findCoveringTileCache[e]={}}},{key:"getScaledDemTileSize",value:function(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}},{key:"_checkRenderCacheEfficiency",value:function(){var t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce("Terrain render cache efficiency is not optimal (".concat(t.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(t.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}},{key:"_onStyleDataEvent",value:function(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}},{key:"_disable",value:function(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(var e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}},{key:"destroy",value:function(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((function(e){return e.fb.destroy()})),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}},{key:"_source",value:function(){return this.enabled?this.sourceCache:null}},{key:"isUsingMockSource",value:function(){return this.sourceCache===this._mockSourceCache}},{key:"exaggeration",value:function(){return this._exaggeration}},{key:"visibleDemTiles",get:function(){return this._visibleDemTiles}},{key:"drapeBufferSize",get:function(){var e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}},{key:"useVertexMorphing",set:function(e){this._useVertexMorphing=e}},{key:"updateTileBinding",value:function(t){var n=this;if(this.enabled){this.prevTerrainTileForTile=this.terrainTileForTile;var i=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);var a=this.proxyCoords=i.getIds().map((function(e){var t=i.getTileByID(e).tileID;return t.projMatrix=r.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,n){var i=n.transform.pointCoordinate(n.transform.getCameraPoint()),r=new e.Point(i.x,i.y);t.sort((function(t,n){if(n.overscaledZ-t.overscaledZ)return n.overscaledZ-t.overscaledZ;var i=new e.Point(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),a=new e.Point(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),o=r.mult(1<<t.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(i)-o.distSqr(a)}))}(a,this.painter),this._previousZoom=r.zoom;var o=this.proxyToSource||{};this.proxyToSource={},a.forEach((function(e){n.proxyToSource[e.key]={}})),this.terrainTileForTile={};var s=this._style._sourceCaches;for(var l in s){var u=s[l];if(u.used&&(u!==this.sourceCache&&this.resetTileLookupCache(u.id),this._setupProxiedCoordsForOrtho(u,t[l],o),!u.usedForTerrain)){var c=t[l];u.getSource().reparseOverscaled&&this._assignTerrainTiles(c)}}this.proxiedCoords[i.id]=a.map((function(e){return new Mn(e,e.key,n.orthoMatrix)})),this._assignTerrainTiles(a),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();var h={};this._visibleDemTiles=[];var d,f=_createForOfIteratorHelper(this.proxyCoords);try{for(f.s();!(d=f.n()).done;){var p=d.value,m=this.terrainTileForTile[p.key];if(m){var v=m.tileID.key;v in h||(this._visibleDemTiles.push(m),h[v]=v)}}}catch(g){f.e(g)}finally{f.f()}}}},{key:"_assignTerrainTiles",value:function(e){var t=this;this._initializing||e.forEach((function(e){if(!t.terrainTileForTile[e.key]){var n=t._findTileCoveringTileID(e,t.sourceCache);n&&(t.terrainTileForTile[e.key]=n)}}))}},{key:"_prepareDEMTextures",value:function(){var e=this.painter.context,t=e.gl;for(var n in this.terrainTileForTile){var i=this.terrainTileForTile[n],r=i.dem;!r||i.demTexture&&!i.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),mn(this.painter,i,r))}}},{key:"_prepareDemTileUniforms",value:function(e,t,n,i){if(!t||null==t.demTexture)return!1;var r=e.tileID.canonical,a=Math.pow(2,t.tileID.canonical.z-r.z),o=i||"";return n["u_dem_tl"+o]=[r.x*a%1,r.y*a%1],n["u_dem_scale"+o]=a,!0}},{key:"emptyDEMTexture",get:function(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}},{key:"emptyDepthBufferTexture",get:function(){var t=this.painter.context,n=t.gl;if(!this._emptyDepthBufferTexture){var i=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,i,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}},{key:"_getLoadedAreaMinimum",value:function(){var e=0,t=this._visibleDemTiles.reduce((function(t,n){if(!n.dem)return t;var i=n.dem.tree.minimums[0];return i>0&&e++,t+i}),0);return e?t/e:0}},{key:"_updateEmptyDEMTexture",value:function(){var t=this.painter.context,n=t.gl;t.activeTexture.set(n.TEXTURE2);var i=this._getLoadedAreaMinimum(),r=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(i,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;var a=this._emptyDEMTexture;return a?a.update(r,{premultiply:!1}):a=this._emptyDEMTexture=new e.Texture(t,r,n.RGBA,{premultiply:!1}),a}},{key:"setupElevationDraw",value:function(t,n,i){var r,a=this.painter.context,o=a.gl,s=(r=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(r),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();var l=null,u=null,c=1;if(i&&i.morphing&&this._useVertexMorphing){var h=i.morphing.srcDemTile,d=i.morphing.dstDemTile;c=i.morphing.phase,h&&d&&(this._prepareDemTileUniforms(t,h,s,"_prev")&&(u=h),this._prepareDemTileUniforms(t,d,s)&&(l=d))}if(u&&l?(a.activeTexture.set(o.TEXTURE2),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.activeTexture.set(o.TEXTURE4),u.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=c):(l=this.terrainTileForTile[t.tileID.key],a.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(t,l,s)?l.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE)),a.activeTexture.set(o.TEXTURE3),i&&i.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),this._depthFBO&&(s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.u_depth_size_inv=[1,1]),i&&i.useMeterToDem&&l){var f=(1<<l.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=f}if(i&&i.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(a,s),"globe"===this.painter.transform.projection.name){var p=this.globeUniformValues(this.painter.transform,t.tileID.canonical,i&&i.useDenormalizedUpVectorScale);n.setGlobeUniformValues(a,p)}}},{key:"globeUniformValues",value:function(t,n,i){var r=t.projection;return{u_tile_tl_up:r.upVector(n,0,0),u_tile_tr_up:r.upVector(n,e.EXTENT,0),u_tile_br_up:r.upVector(n,e.EXTENT,e.EXTENT),u_tile_bl_up:r.upVector(n,0,e.EXTENT),u_tile_up_scale:i?e.globeMetersToEcef(1):r.upVectorScale(n,t.center.lat,t.worldSize).metersToTile}}},{key:"renderToBackBuffer",value:function(t){var n=this.painter,i=this.painter.context;0!==t.length&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,n,i,r,a){if("globe"===t.transform.projection.name)!function(t,n,i,r,a){var o,s,l=t.context,u=l.gl,c=t.options.showTerrainWireframe?2:0,h=t.transform,d=e.globeUseCustomAntiAliasing(t,l,h),f=function(e,n){if(s!==e){var i=[wn[e],"PROJECTION_GLOBE_VIEW"];d&&i.push("CUSTOM_ANTIALIASING"),n&&i.push(wn[c]),o=t.useProgram("globeRaster",null,i),s=e}},p=t.colorModeForRenderPass(),m=new e.DepthMode(u.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);bn.update(a);var v=e.calculateGlobeMercatorMatrix(h),g=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],y=c?[!1,!0]:[!1],_=t.globeSharedBuffers,x=[h.width*e.exported.devicePixelRatio,h.height*e.exported.devicePixelRatio],b=Float32Array.from(h.globeMatrix),w={useDenormalizedUpVectorScale:!0};if(y.forEach((function(c){var h=t.transform,d=kn(h.zoom)*n.exaggeration();s=-1;var y,k=c?u.LINES:u.TRIANGLES,C=_createForOfIteratorHelper(r);try{for(C.s();!(y=C.n()).done;){var S=y.value,T=i.getTile(S),E=e.StencilMode.disabled,P=n.prevTerrainTileForTile[S.key],M=n.terrainTileForTile[S.key];xn(P,M)&&bn.newMorphing(S.key,P,M,a,250),l.activeTexture.set(u.TEXTURE0),T.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE);var I=bn.getMorphValuesForProxy(S.key),A=I?1:0;I&&e.extend$1(w,{morphing:{srcDemTile:I.from,dstDemTile:I.to,phase:e.easeCubicInOut(I.phase)}});var R=e.tileCornersToBounds(S.canonical),O=e.getLatitudinalLod(R.getCenter().lat),N=e.getGridMatrix(S.canonical,R,O,h.worldSize/h._pixelsPerMercatorPixel),D=e.globeNormalizeECEF(e.globeTileBounds(S.canonical)),z=_n(h.projMatrix,b,v,D,e.globeToMercatorTransition(h.zoom),g,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,x,d,N);if(f(A,c),n.setupElevationDraw(T,o,w),t.prepareDrawProgram(l,o,S.toUnwrapped()),_){var L=_slicedToArray(c?_.getWirefameBuffers(t.context,O):_.getGridBuffers(O,0!==d),3),B=L[0],F=L[1],j=L[2];o.draw(l,k,m,E,p,e.CullFaceMode.backCCW,z,"globe_raster",B,F,j)}}}catch(H){C.e(H)}finally{C.f()}})),_){var k=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];d&&k.push("CUSTOM_ANTIALIASING"),o=t.useProgram("globeRaster",null,k);var C,S=_createForOfIteratorHelper(r);try{var T=function(){var r=C.value,a=r.canonical,s=a.x,c=a.y,d=a.z,f=0===c,v=c===(1<<d)-1,y=_slicedToArray(_.getPoleBuffers(d),4),b=y[0],k=y[1],S=y[2],T=y[3];if(T&&(f||v)){var E=i.getTile(r);l.activeTexture.set(u.TEXTURE0),E.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE);var P=e.globePoleMatrixForTile(d,s,h),M=e.globeNormalizeECEF(e.globeTileBounds(r.canonical)),I=function(t,n){return t.draw(l,u.TRIANGLES,m,e.StencilMode.disabled,p,e.CullFaceMode.disabled,_n(h.projMatrix,P,P,M,0,g,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,x,0),"globe_pole_raster",n,S,T)};n.setupElevationDraw(E,o,w),t.prepareDrawProgram(l,o,r.toUnwrapped()),f&&I(o,b),v&&(P=e.scale(e.create(),P,[1,-1,1]),I(o,k))}};for(S.s();!(C=S.n()).done;)T()}catch(E){S.e(E)}finally{S.f()}}}(t,n,i,r,a);else{var o,s,l=t.context,u=l.gl,c=t.options.showTerrainWireframe?2:0,h=function(e,n){if(s!==e){var i=[wn[e]];n&&i.push(wn[c]),o=t.useProgram("terrainRaster",null,i),s=e}},d=t.colorModeForRenderPass(),f=new e.DepthMode(u.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);bn.update(a);var p=t.transform,m=kn(p.zoom)*n.exaggeration();(c?[!1,!0]:[!1]).forEach((function(c){s=-1;var v,g=c?u.LINES:u.TRIANGLES,y=_slicedToArray(c?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments],2),_=y[0],x=y[1],b=_createForOfIteratorHelper(r);try{for(b.s();!(v=b.n()).done;){var w=v.value,k=i.getTile(w),C=e.StencilMode.disabled,S=n.prevTerrainTileForTile[w.key],T=n.terrainTileForTile[w.key];xn(S,T)&&bn.newMorphing(w.key,S,T,a,250),l.activeTexture.set(u.TEXTURE0),k.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE,u.LINEAR_MIPMAP_NEAREST);var E=bn.getMorphValuesForProxy(w.key),P=E?1:0,M=void 0;E&&(M={morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:e.easeCubicInOut(E.phase)}});var I=yn(w.projMatrix,Cn(w.canonical,p.renderWorldCopies)?m/10:m);h(P,c),n.setupElevationDraw(k,o,M),t.prepareDrawProgram(l,o,w.toUnwrapped()),o.draw(l,g,f,C,d,e.CullFaceMode.backCCW,I,"terrain_raster",n.gridBuffer,_,x)}}catch(A){b.e(A)}finally{b.f()}}))}}(n,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}},{key:"renderBatch",value:function(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;var n,i=this.painter,r=this.painter.context,a=this.proxySourceCache,o=this.proxiedCoords[a.id],s=this._drapedRenderBatches.shift(),l=[],u=i.style.order,c=0,h=_createForOfIteratorHelper(o);try{for(h.s();!(n=h.n()).done;){var d=n.value,f=a.getTileByID(d.proxyTileKey),p=a.proxyCachedFBO[d.key]?a.proxyCachedFBO[d.key][t]:void 0,m=void 0!==p?a.renderCache[p]:this.pool[c++],v=void 0!==p;if(f.texture=m.tex,!v||m.dirty){var g=void 0;r.bindFramebuffer.set(m.fb.framebuffer),this.renderedToTile=!1,m.dirty&&(r.clear({color:e.Color.transparent,stencil:0}),m.dirty=!1);for(var y=s.start;y<=s.end;++y){var _=i.style._layers[u[y]];if(!_.isHidden(i.transform.zoom)){var x=i.style._getLayerSourceCache(_),b=x?this.proxyToSource[d.key][x.id]:[d];if(b){var w=b;r.viewport.set([0,0,m.fb.width,m.fb.height]),g!==(x?x.id:null)&&(this._setupStencil(m,b,_,x),g=x?x.id:null),i.renderLayer(i,x,_,w)}}}this.renderedToTile?(m.dirty=!0,l.push(f.tileID)):v||--c,5===c&&(c=0,this.renderToBackBuffer(l))}else l.push(f.tileID)}}catch(k){h.e(k)}finally{h.f()}return this.renderToBackBuffer(l),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,i.width,i.height]),s.end+1}},{key:"postRender",value:function(){}},{key:"renderCacheEfficiency",value:function(e){var t=e.order.length;if(0===t)return{efficiency:100};for(var n,i=0,r=0,a=!1,o=0;o<t;++o){var s=e._layers[e.order[o]];this._style.isLayerDraped(s)?(a&&++i,++r):a||(a=!0,n=s.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-i/r),firstUndrapedLayer:n}}},{key:"getMinElevationBelowMSL",value:function(){var e=0;return this._visibleDemTiles.filter((function(e){return e.dem})).forEach((function(t){e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}},{key:"raycast",value:function(e,t,n){if(!this._visibleDemTiles)return null;var i=this._visibleDemTiles.filter((function(e){return e.dem})).map((function(i){var r=i.tileID,a=1<<r.overscaledZ,o=r.canonical,s=o.x,l=o.y,u=s/a,c=(s+1)/a,h=l/a,d=(l+1)/a;return{minx:u,miny:h,maxx:c,maxy:d,t:i.dem.tree.raycastRoot(u,h,c,d,e,t,n),tile:i}}));i.sort((function(e,t){return(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)}));var r,a=_createForOfIteratorHelper(i);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(null==o.t)return null;var s=o.tile.dem.tree.raycast(o.minx,o.miny,o.maxx,o.maxy,e,t,n);if(null!=s)return s}}catch(l){a.e(l)}finally{a.f()}return null}},{key:"_createFBO",value:function(){var t=this.painter.context,n=t.gl,i=this.drapeBufferSize;t.activeTexture.set(n.TEXTURE0);var r=new e.Texture(t,{width:i[0],height:i[1],data:null},n.RGBA);r.bind(n.LINEAR,n.CLAMP_TO_EDGE);var a=t.createFramebuffer(i[0],i[1],!1);return a.colorAttachment.set(r.texture),a.depthAttachment=new we(t,a.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,a.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):a.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:a,tex:r,dirty:!1}}},{key:"_initFBOPool",value:function(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}},{key:"_shouldDisableRenderCache",value:function(){var e=this;if(this._style.light&&this._style.light.hasTransition())return!0;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some((function(t){var n=e._style._layers[t],i=n.isHidden(e.painter.transform.zoom);return"custom"===n.type?!i&&n.shouldRedrape():!i&&n.hasTransition()}))}},{key:"_clearLineLayersFromRenderCache",value:function(){var t,n=!1,i=_createForOfIteratorHelper(this._style._getSources());try{for(i.s();!(t=i.n()).done;){if(t.value instanceof Se){n=!0;break}}}catch(m){i.e(m)}finally{i.f()}if(n)for(var r={},a=0;a<this._style.order.length;++a){var o=this._style._layers[this._style.order[a]],s=this._style._getLayerSourceCache(o);if(s&&!r[s.id]&&!o.isHidden(this.painter.transform.zoom)&&"line"===o.type&&o.widthExpression()instanceof e.ZoomDependentExpression){r[s.id]=!0;var l,u=_createForOfIteratorHelper(this.proxyCoords);try{for(u.s();!(l=u.n()).done;){var c=l.value,h=this.proxyToSource[c.key][s.id];if(h){var d,f=_createForOfIteratorHelper(h);try{for(f.s();!(d=f.n()).done;){var p=d.value;this._clearRenderCacheForTile(s.id,p)}}catch(m){f.e(m)}finally{f.f()}}}}catch(m){u.e(m)}finally{u.f()}}}}},{key:"_clearRasterLayersFromRenderCache",value:function(){var e=!1;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t]._source instanceof Te){e=!0;break}if(e)for(var n={},i=0;i<this._style.order.length;++i){var r=this._style._layers[this._style.order[i]],a=this._style._getLayerSourceCache(r);if(a&&!n[a.id]&&(!r.isHidden(this.painter.transform.zoom)&&"raster"===r.type)){var o,s=r.paint.get("raster-fade-duration"),l=_createForOfIteratorHelper(this.proxyCoords);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=this.proxyToSource[u.key][a.id];if(c){var h,d=_createForOfIteratorHelper(c);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=Tn(a.getTile(f),a.findLoadedParent(f,0),a,this.painter.transform,s);(1!==p.opacity||0!==p.mix)&&this._clearRenderCacheForTile(a.id,f)}}catch(m){d.e(m)}finally{d.f()}}}}catch(m){l.e(m)}finally{l.f()}}}}},{key:"_setupDrapedRenderBatches",value:function(){var e=this._style.order,t=e.length;if(0!==t){for(var n,i=[],r=0,a=this._style._layers[e[r]];!this._style.isLayerDraped(a)&&a.isHidden(this.painter.transform.zoom)&&++r<t;)a=this._style._layers[e[r]];for(;r<t;++r){var o=this._style._layers[e[r]];o.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(o)?void 0===n&&(n=r):void 0!==n&&(i.push({start:n,end:r-1}),n=void 0))}void 0!==n&&i.push({start:n,end:r-1}),this._drapedRenderBatches=i}}},{key:"_setupRenderCache",value:function(e){var t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){var n=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(var i=0;i<n.length;++i){var r,a=Object.values(n[i]);(r=t.renderCachePool).push.apply(r,a)}}}else{this._clearRasterLayersFromRenderCache();for(var o=this.proxyCoords,s=this._tilesDirty,l=o.length-1;l>=0;l--){var u=o[l];if(t.getTileByID(u.key),void 0!==t.proxyCachedFBO[u.key]){var c=e[u.key],h=this.proxyToSource[u.key],d=0,f=function(e){var t=h[e],n=c[e];if(!n||n.length!==t.length||t.some((function(t,i){return t!==n[i]||s[e]&&s[e].hasOwnProperty(t.key)})))return d=-1,1;++d};for(var p in h)if(f(p))break;for(var m in t.proxyCachedFBO[u.key])t.renderCache[t.proxyCachedFBO[u.key][m]].dirty=d<0||d!==Object.values(c).length}}var v=_toConsumableArray(this._drapedRenderBatches);v.sort((function(e,t){return t.end-t.start-(e.end-e.start)}));var g,y=_createForOfIteratorHelper(v);try{for(y.s();!(g=y.n()).done;){var _,x=g.value,b=_createForOfIteratorHelper(o);try{for(b.s();!(_=b.n()).done;){var w=_.value;if(!t.proxyCachedFBO[w.key]){var k=t.renderCachePool.pop();void 0===k&&t.renderCache.length<50&&(k=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==k&&(t.proxyCachedFBO[w.key]={},t.proxyCachedFBO[w.key][x.start]=k,t.renderCache[k].dirty=!0)}}}catch(C){b.e(C)}finally{b.f()}}}catch(C){y.e(C)}finally{y.f()}this._tilesDirty={}}}},{key:"_setupStencil",value:function(e,t,n,i){if(i&&this._sourceTilesOverlap[i.id]){var r=this.painter.context,a=r.gl;if(t.length<=1)this._overlapStencilType=!1;else{var o;if(n.isTileClipped())o=t.length,this._overlapStencilMode.test={func:a.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:a.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}}else this._overlapStencilType&&(this._overlapStencilType=!1)}},{key:"clipOrMaskOverlapStencilType",value:function(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}},{key:"stencilModeForRTTOverlap",value:function(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}},{key:"_renderTileClippingMasks",value:function(t,n){var i=this.painter,r=this.painter.context,a=r.gl;i._tileClippingMaskIDs={},r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);var o,s=i.useProgram("clippingMask"),l=_createForOfIteratorHelper(t);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=i._tileClippingMaskIDs[u.key]=--n;s.draw(r,a.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:a.ALWAYS,mask:0},c,255,a.KEEP,a.KEEP,a.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Sn(u.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}catch(h){l.e(h)}finally{l.f()}}},{key:"pointCoordinate",value:function(t){var n=this.painter.transform;if(t.x<0||t.x>n.width||t.y<0||t.y>n.height)return null;var i=[t.x,t.y,1,1];e.transformMat4$1(i,i,n.pixelMatrixInverse),e.scale$1(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;var r=n._camera.position,a=e.mercatorZfromAltitude(1,n.center.lat),o=[r[0],r[1],r[2]/a,0],s=e.subtract([],i.slice(0,3),o);e.normalize(s,s);var l=this.raycast(o,s,this._exaggeration);return null!==l&&l?(e.scaleAndAdd(o,o,s,l),o[3]=o[2],o[2]*=a,o):null}},{key:"drawDepth",value:function(){var t=this.painter,n=t.context,i=this.proxySourceCache,r=Math.ceil(t.width),a=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===a||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){var o=n.gl,s=n.createFramebuffer(r,a,!0);n.activeTexture.set(o.TEXTURE0);var l=new e.Texture(n,{width:r,height:a,data:null},o.RGBA);l.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.colorAttachment.set(l.texture);var u=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,r,a);s.depthAttachment.set(u),this._depthFBO=s,this._depthTexture=l}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,r,a]),function(t,n,i,r){if("globe"!==t.transform.projection.name){var a=t.context,o=a.gl;a.clear({depth:1});var s,l=t.useProgram("terrainDepth"),u=new e.DepthMode(o.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D),c=_createForOfIteratorHelper(r);try{for(c.s();!(s=c.n()).done;){var h=s.value,d=i.getTile(h),f=yn(h.projMatrix,0);n.setupElevationDraw(d,l),l.draw(a,o.TRIANGLES,u,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,f,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}catch(p){c.e(p)}finally{c.f()}}}(t,this,i,this.proxyCoords)}},{key:"_setupProxiedCoordsForOrtho",value:function(e,t,n){if(e.getSource()instanceof Pe)return this._setupProxiedCoordsForImageSource(e,t,n);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};for(var i=this.proxiedCoords[e.id]=[],r=this.proxyCoords,a=0;a<r.length;a++){var o=r[a],s=this._findTileCoveringTileID(o,e);if(s){var l=this._createProxiedId(o,s,n[o.key]&&n[o.key][e.id]);i.push(l),this.proxyToSource[o.key][e.id]=[l]}}for(var u=!1,c=0;c<t.length;c++){var h=e.getTile(t[c]);if(h&&h.hasData()){var d=this._findTileCoveringTileID(h.tileID,this.proxySourceCache);if(d&&d.tileID.canonical.z!==h.tileID.canonical.z){var f=this.proxyToSource[d.tileID.key][e.id],p=this._createProxiedId(d.tileID,h,n[d.tileID.key]&&n[d.tileID.key][e.id]);f?f.splice(f.length-1,0,p):this.proxyToSource[d.tileID.key][e.id]=[p],i.push(p),u=!0}}}this._sourceTilesOverlap[e.id]=u}},{key:"_setupProxiedCoordsForImageSource",value:function(t,n,i){if(t.getSource().loaded())for(var r=this.proxiedCoords[t.id]=[],a=this.proxyCoords,o=t.getSource(),s=new e.Point(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),l=o.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce((function(e,t){return e.min.x=Math.min(e.min.x,t.x-s.x),e.min.y=Math.min(e.min.y,t.y-s.y),e.max.x=Math.max(e.max.x,t.x-s.x),e.max.y=Math.max(e.max.y,t.y-s.y),e}),{min:new e.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=function(t,n){var i=t.wrap+t.canonical.x/(1<<t.canonical.z),r=t.canonical.y/(1<<t.canonical.z),a=e.EXTENT/(1<<t.canonical.z),o=n.wrap+n.canonical.x/(1<<n.canonical.z),s=n.canonical.y/(1<<n.canonical.z);return i+a<o+l.min.x||i>o+l.max.x||r+a<s+l.min.y||r>s+l.max.y},c=0;c<a.length;c++)for(var h=a[c],d=0;d<n.length;d++){var f=t.getTile(n[d]);if(f&&f.hasData()&&!u(h,f.tileID)){var p=this._createProxiedId(h,f,i[h.key]&&i[h.key][t.id]),m=this.proxyToSource[h.key][t.id];m?m.push(p):this.proxyToSource[h.key][t.id]=[p],r.push(p)}}}},{key:"_createProxiedId",value:function(t,n,i){var r=this.orthoMatrix;if(i){var a=i.find((function(e){return e.key===n.tileID.key}));if(a)return a}if(n.tileID.key!==t.key){var o,s,l,u=t.canonical.z-n.tileID.canonical.z;r=e.create();var c=n.tileID.wrap-t.wrap<<t.overscaledZ;u>0?(s=(o=e.EXTENT>>u)*((n.tileID.canonical.x<<u)-t.canonical.x+c),l=o*((n.tileID.canonical.y<<u)-t.canonical.y)):(o=e.EXTENT<<-u,s=e.EXTENT*(n.tileID.canonical.x-(t.canonical.x+c<<-u)),l=e.EXTENT*(n.tileID.canonical.y-(t.canonical.y<<-u))),e.ortho(r,0,o,0,o,0,1),e.translate(r,r,[s,l,0])}return new Mn(n.tileID,t.key,r)}},{key:"_findTileCoveringTileID",value:function(t,n){var i=n.getTile(t);if(i&&i.hasData())return i;var r=this._findCoveringTileCache[n.id],a=r[t.key];if((i=a?n.getTileByID(a):null)&&i.hasData()||null===a)return i;var o=i?i.tileID:t,s=o.overscaledZ,l=n.getSource().minzoom,u=[];if(!a){var c=n.getSource().maxzoom;if(t.canonical.z>=c){var h=t.canonical.z-c;n.getSource().reparseOverscaled?(s=Math.max(t.canonical.z+2,n.transform.tileZoom),o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h)):0!==h&&(s=c,o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h))}o.key!==t.key&&(u.push(o.key),i=n.getTile(o))}var d=function(e){u.forEach((function(t){r[t]=e})),u.length=0};for(s-=1;s>=l&&(!i||!i.hasData());s--){i&&d(i.tileID.key);var f=o.calculateScaledKey(s);if((i=n.getTileByID(f))&&i.hasData())break;var p=r[f];if(null===p)break;void 0===p?u.push(f):i=n.getTileByID(p)}return d(i?i.tileID.key:null),i&&i.hasData()?i:null}},{key:"findDEMTileFor",value:function(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}},{key:"prepareDrawTile",value:function(){this.renderedToTile=!0}},{key:"_clearRenderCacheForTile",value:function(e,t){var n=this._tilesDirty[e];n||(n=this._tilesDirty[e]={}),n[t.key]=!0}},{key:"getWirefameBuffer",value:function(){if(!this.wireframeSegments){var t=function(t){for(var n=0,i=new e.StructArrayLayout2ui4,r=131,a=1;a<129;a++){for(var o=1;o<129;o++)n=a*r+o,i.emplaceBack(n,n+1),i.emplaceBack(n,n+r),i.emplaceBack(n+1,n+r),128===a&&i.emplaceBack(n+r,n+r+1);i.emplaceBack(n+1,n+1+r)}return i}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}]),n}(e.Elevation),An=function(){function t(n,i,r,a,o,s){_classCallCheck(this,t);var l=n.gl;this.program=l.createProgram();var u=function(e){for(var t=[],n=0;n<e.length;n++)if(null!==e[n]){var i=e[n].split(" ");t.push(i.pop())}return t}(r.staticAttributes),c=a?a.getBinderAttributes():[],h=u.concat(c),d=a?a.defines():[];d=d.concat(s.map((function(e){return"#define "+e})));var f=n.isWebGL2?"#version 300 es\n":"",p=f+d.concat(n.extStandardDerivatives&&0===f.length?"#extension GL_OES_standard_derivatives : enable\n".concat(ln):ln,ln,sn,on.fragmentSource,Qt.fragmentSource,r.fragmentSource).join("\n"),m=f+d.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",sn,on.vertexSource,Qt.vertexSource,Jt.vertexSource,r.vertexSource).join("\n"),v=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost())this.failedToCreate=!0;else{l.shaderSource(v,p),l.compileShader(v),l.attachShader(this.program,v);var g=l.createShader(l.VERTEX_SHADER);if(l.isContextLost())this.failedToCreate=!0;else{l.shaderSource(g,m),l.compileShader(g),l.attachShader(this.program,g),this.attributes={},this.numAttributes=h.length;for(var y=0;y<this.numAttributes;y++)h[y]&&(l.bindAttribLocation(this.program,y,h[y]),this.attributes[h[y]]=y);l.linkProgram(this.program),l.deleteShader(g),l.deleteShader(v),this.fixedUniforms=o(n),this.binderUniforms=a?a.getUniforms(n):[],s.includes("TERRAIN")&&(this.terrainUniforms=function(t){return{u_dem:new e.Uniform1i(t),u_dem_prev:new e.Uniform1i(t),u_dem_unpack:new e.Uniform4f(t),u_dem_tl:new e.Uniform2f(t),u_dem_scale:new e.Uniform1f(t),u_dem_tl_prev:new e.Uniform2f(t),u_dem_scale_prev:new e.Uniform1f(t),u_dem_size:new e.Uniform1f(t),u_dem_lerp:new e.Uniform1f(t),u_exaggeration:new e.Uniform1f(t),u_depth:new e.Uniform1i(t),u_depth_size_inv:new e.Uniform2f(t),u_meter_to_dem:new e.Uniform1f(t),u_label_plane_matrix_inv:new e.UniformMatrix4f(t)}}(n)),s.includes("GLOBE")&&(this.globeUniforms=function(t){return{u_tile_tl_up:new e.Uniform3f(t),u_tile_tr_up:new e.Uniform3f(t),u_tile_br_up:new e.Uniform3f(t),u_tile_bl_up:new e.Uniform3f(t),u_tile_up_scale:new e.Uniform1f(t)}}(n)),s.includes("FOG")&&(this.fogUniforms=function(t){return{u_fog_matrix:new e.UniformMatrix4f(t),u_fog_range:new e.Uniform2f(t),u_fog_color:new e.Uniform4f(t),u_fog_horizon_blend:new e.Uniform1f(t),u_fog_temporal_offset:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_globe_transition:new e.Uniform1f(t),u_is_globe:new e.Uniform1i(t),u_viewport:new e.Uniform2f(t)}}(n))}}}return _createClass(t,[{key:"setTerrainUniformValues",value:function(e,t){if(this.terrainUniforms){var n=this.terrainUniforms;if(!this.failedToCreate)for(var i in e.program.set(this.program),t)n[i]&&n[i].set(this.program,i,t[i])}}},{key:"setGlobeUniformValues",value:function(e,t){if(this.globeUniforms){var n=this.globeUniforms;if(!this.failedToCreate)for(var i in e.program.set(this.program),t)n[i]&&n[i].set(this.program,i,t[i])}}},{key:"setFogUniformValues",value:function(e,t){if(this.fogUniforms){var n=this.fogUniforms;if(!this.failedToCreate)for(var i in e.program.set(this.program),t)n[i].set(this.program,i,t[i])}}},{key:"draw",value:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p){var m=e.gl;if(!this.failedToCreate){e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(i),e.setColorMode(r),e.setCullFace(a);for(var v=0,g=Object.keys(this.fixedUniforms);v<g.length;v++){var y=g[v];this.fixedUniforms[y].set(this.program,y,o[y])}f&&f.setUniforms(this.program,e,this.binderUniforms,h,{zoom:d});var _,x=_defineProperty(_defineProperty(_defineProperty({},m.LINES,2),m.TRIANGLES,3),m.LINE_STRIP,1)[t],b=_createForOfIteratorHelper(c.get());try{for(b.s();!(_=b.n()).done;){var w=_.value,k=w.vaos||(w.vaos={});(k[s]||(k[s]=new dn)).bind(e,this,l,f?f.getPaintVertexBuffers():[],u,w.vertexOffset,p||[]),m.drawElements(t,w.primitiveLength*x,m.UNSIGNED_SHORT,w.primitiveOffset*x*2)}}catch(C){b.e(C)}finally{b.f()}}}}],[{key:"cacheKey",value:function(e,t,n,i){var r,a="".concat(t).concat(i?i.cacheKey:""),o=_createForOfIteratorHelper(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;e.usedDefines.includes(s)&&(a+="/"+s)}}catch(l){o.e(l)}finally{o.f()}return a}}]),t}();function Rn(e,t){var n=Math.pow(2,t.tileID.overscaledZ),i=t.tileSize*Math.pow(2,e.transform.tileZoom)/n,r=i*(t.tileID.canonical.x+t.tileID.wrap*n),a=i*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/I(t,1,e.transform.tileZoom),u_pixel_coord_upper:[r>>16,a>>16],u_pixel_coord_lower:[65535&r,65535&a]}}var On=e.create(),Nn=function(t,n,i,r,a,o,s,l,u,c,h){var d=n.style.light,f=d.properties.get("position"),p=[f.x,f.y,f.z],m=e.create$1();"viewport"===d.properties.get("anchor")&&(e.fromRotation(m,-n.transform.angle),e.transformMat3(p,p,m));var v=d.properties.get("color"),g=n.transform,y={u_matrix:t,u_lightpos:p,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[v.r,v.g,v.b],u_vertical_gradient:+i,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:On,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:a,u_edge_radius:o};return"globe"===g.projection.name&&(y.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],y.u_zoom_transition=u,y.u_inv_rot_matrix=h,y.u_merc_center=c,y.u_up_dir=g.projection.upVector(new e.CanonicalTileID(0,0,0),c[0]*e.EXTENT,c[1]*e.EXTENT),y.u_height_lift=l),y},Dn=function(t,n,i,r,a,o,s,l,u,c,h,d){var f=Nn(t,n,i,r,a,o,s,u,c,h,d),p={u_height_factor:-Math.pow(2,s.overscaledZ)/l.tileSize/8};return e.extend(f,Rn(n,l),p)},zn=function(e){return{u_matrix:e}},Ln=function(t,n,i){return e.extend(zn(t),Rn(n,i))},Bn=function(e,t){return{u_matrix:e,u_world:t}},Fn=function(t,n,i,r){return e.extend(Ln(t,n,i),{u_world:r})},jn=e.create(),Hn=function(t,n,i,r,a,o){var s,l=t.transform,u="globe"===l.projection.name;if("map"===o.paint.get("circle-pitch-alignment"))if(u){var c=e.globePixelsToTileUnits(l.zoom,n.canonical)*l._pixelsPerMercatorPixel;s=Float32Array.from([c,0,0,c])}else s=l.calculatePixelsToTileUnitsMatrix(i);else s=new Float32Array([l.pixelsToGLUnits[0],0,0,l.pixelsToGLUnits[1]]);var h={u_camera_to_center_distance:l.cameraToCenterDistance,u_matrix:t.translatePosMatrix(n.projMatrix,i,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:s,u_inv_rot_matrix:jn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){h.u_inv_rot_matrix=r,h.u_merc_center=a,h.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(l.zoom);var d=a[0]*e.EXTENT,f=a[1]*e.EXTENT;h.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),d,f)}return h},Vn=function(e){var t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},Un=function(t,n,i,r){var a=e.EXTENT/i.tileSize;return{u_matrix:t,u_camera_to_center_distance:n.getCameraToCenterDistance(r),u_extrude_scale:[n.pixelsToGLUnits[0]/a,n.pixelsToGLUnits[1]/a]}},qn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:n}},Gn=e.create(),Wn=function(t,n,i,r,a,o,s){var l=t.transform,u="globe"===l.projection.name,c=u?e.globePixelsToTileUnits(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:I(i,1,o),h={u_matrix:n.projMatrix,u_extrude_scale:c,u_intensity:s,u_inv_rot_matrix:Gn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){h.u_inv_rot_matrix=r,h.u_merc_center=a,h.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(l.zoom);var d=a[0]*e.EXTENT,f=a[1]*e.EXTENT;h.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),d,f)}return h};function Zn(e,t){return 1/I(e,1,t.tileZoom)}function Xn(e,t,n,i){return e.translatePosMatrix(i||t.tileID.projMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}function Kn(e){var t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}var Yn=function(e,t,n,i,r,a){return{u_matrix:e,u_tl_parent:t,u_scale_parent:n,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(s=r.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Jn(r.paint.get("raster-hue-rotate")),u_perspective_transform:a};var o,s};function Jn(e){e*=Math.PI/180;var t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}var Qn,$n=e.create(),ei=function(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v){var g=a.transform,y={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:g.cameraToCenterDistance,u_rotate_symbol:+i,u_aspect_ratio:g.width/g.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$n,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:$n,u_up_vector:[0,-1,0]};return"globe"===v.name&&(y.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],y.u_zoom_transition=d,y.u_inv_rot_matrix=p,y.u_merc_center=f,y.u_camera_forward=g._camera.forward(),y.u_ecef_origin=e.globeECEFOrigin(g.globeMatrix,h.toUnwrapped()),y.u_tile_matrix=Float32Array.from(g.globeMatrix),y.u_up_vector=m),y},ti=function(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g){return e.extend(ei(t,n,i,r,a,o,s,l,u,c,d,f,p,m,v,g),{u_gamma_scale:r?a.transform.cameraToCenterDistance*Math.cos(a.terrain?0:a.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+h})},ni=function(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v){return e.extend(ti(t,n,i,r,a,o,s,l,!0,u,!0,h,d,f,p,m,v),{u_texsize_icon:c,u_texture_icon:1})},ii=function(e,t,n){return{u_matrix:e,u_opacity:t,u_color:n}},ri=function(t,n,i,r,a){return e.extend(function(e,t,n){var i=t.imageManager.getPattern(e.toString()),r=t.imageManager.getPixelSize(),a=r.width,o=r.height,s=Math.pow(2,n.tileID.overscaledZ),l=n.tileSize*Math.pow(2,t.transform.tileZoom)/s,u=l*(n.tileID.canonical.x+n.tileID.wrap*s),c=l*n.tileID.canonical.y;return{u_image:0,u_pattern_tl:i.tl,u_pattern_br:i.br,u_texsize:[a,o],u_pattern_size:i.displaySize,u_tile_units_to_pixels:1/I(n,1,t.transform.tileZoom),u_pixel_coord_upper:[u>>16,c>>16],u_pixel_coord_lower:[65535&u,65535&c]}}(r,i,a),{u_matrix:t,u_opacity:n})},ai={fillExtrusion:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t)}},fillExtrusionPattern:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_height_factor:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t)}},fill:function(t){return{u_matrix:new e.UniformMatrix4f(t)}},fillPattern:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}},fillOutline:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t)}},fillOutlinePattern:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}},circle:function(t){return{u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}},collisionBox:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.Uniform2f(t)}},collisionCircle:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_inv_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_viewport_size:new e.Uniform2f(t)}},debug:function(t){return{u_color:new e.UniformColor(t),u_matrix:new e.UniformMatrix4f(t),u_overlay:new e.Uniform1i(t),u_overlay_scale:new e.Uniform1f(t)}},clippingMask:function(t){return{u_matrix:new e.UniformMatrix4f(t)}},heatmap:function(t){return{u_extrude_scale:new e.Uniform1f(t),u_intensity:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}},heatmapTexture:function(t){return{u_image:new e.Uniform1i(t),u_color_ramp:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t)}},hillshade:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_latrange:new e.Uniform2f(t),u_light:new e.Uniform2f(t),u_shadow:new e.UniformColor(t),u_highlight:new e.UniformColor(t),u_accent:new e.UniformColor(t)}},hillshadePrepare:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_dimension:new e.Uniform2f(t),u_zoom:new e.Uniform1f(t),u_unpack:new e.Uniform4f(t)}},line:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_units_to_pixels:new e.Uniform2f(t),u_dash_image:new e.Uniform1i(t),u_gradient_image:new e.Uniform1i(t),u_image_height:new e.Uniform1f(t),u_texsize:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t),u_trim_offset:new e.Uniform2f(t)}},linePattern:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_texsize:new e.Uniform2f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_units_to_pixels:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t)}},raster:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_tl_parent:new e.Uniform2f(t),u_scale_parent:new e.Uniform1f(t),u_fade_t:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_image0:new e.Uniform1i(t),u_image1:new e.Uniform1i(t),u_brightness_low:new e.Uniform1f(t),u_brightness_high:new e.Uniform1f(t),u_saturation_factor:new e.Uniform1f(t),u_contrast_factor:new e.Uniform1f(t),u_spin_weights:new e.Uniform3f(t),u_perspective_transform:new e.Uniform2f(t)}},symbolIcon:function(t){return{u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_texture:new e.Uniform1i(t)}},symbolSDF:function(t){return{u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_is_halo:new e.Uniform1i(t)}},symbolTextAndIcon:function(t){return{u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texsize_icon:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_texture_icon:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_is_halo:new e.Uniform1i(t)}},background:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_color:new e.UniformColor(t)}},backgroundPattern:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_pattern_tl:new e.Uniform2f(t),u_pattern_br:new e.Uniform2f(t),u_texsize:new e.Uniform2f(t),u_pattern_size:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}},terrainRaster:gn,terrainDepth:gn,skybox:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_sun_direction:new e.Uniform3f(t),u_cubemap:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}},skyboxGradient:function(t){return{u_matrix:new e.UniformMatrix4f(t),u_color_ramp:new e.Uniform1i(t),u_center_direction:new e.Uniform3f(t),u_radius:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}},skyboxCapture:function(t){return{u_matrix_3f:new e.UniformMatrix3f(t),u_sun_direction:new e.Uniform3f(t),u_sun_intensity:new e.Uniform1f(t),u_color_tint_r:new e.Uniform4f(t),u_color_tint_m:new e.Uniform4f(t),u_luminance:new e.Uniform1f(t)}},globeRaster:function(t){return{u_proj_matrix:new e.UniformMatrix4f(t),u_globe_matrix:new e.UniformMatrix4f(t),u_normalize_matrix:new e.UniformMatrix4f(t),u_merc_matrix:new e.UniformMatrix4f(t),u_zoom_transition:new e.Uniform1f(t),u_merc_center:new e.Uniform2f(t),u_image0:new e.Uniform1i(t),u_grid_matrix:new e.UniformMatrix3f(t),u_skirt_height:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_viewport:new e.Uniform2f(t)}},globeAtmosphere:function(t){return{u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_horizon:new e.Uniform1f(t),u_transition:new e.Uniform1f(t),u_fadeout_range:new e.Uniform1f(t),u_color:new e.Uniform4f(t),u_high_color:new e.Uniform4f(t),u_space_color:new e.Uniform4f(t),u_star_intensity:new e.Uniform1f(t),u_star_density:new e.Uniform1f(t),u_star_size:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t),u_horizon_angle:new e.Uniform1f(t),u_rotation_matrix:new e.UniformMatrix4f(t)}}};function oi(t,n,i,r,a,o,s){for(var l=t.context,u=l.gl,c=t.transform,h=t.useProgram("collisionBox"),d=[],f=0,p=0,m=0;m<r.length;m++){var v=r[m],g=n.getTile(v),y=g.getBucket(i);if(y){var _=gt(v,y,c),x=_;0===a[0]&&0===a[1]||(x=t.translatePosMatrix(_,g,a,o));var b=s?y.textCollisionBox:y.iconCollisionBox,w=y.collisionCircleArray;if(w.length>0){var k=e.create(),C=x;e.mul(k,y.placementInvProjMatrix,c.glCoordMatrix),e.mul(k,k,y.placementViewportMatrix),d.push({circleArray:w,circleOffset:p,transform:C,invTransform:k,projection:y.getProjection()}),p=f+=w.length/4}b&&(t.terrain&&t.terrain.setupElevationDraw(g,h),h.draw(l,u.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,Un(x,c,g,y.getProjection()),i.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,null,c.zoom,null,[b.collisionVertexBuffer,b.collisionVertexBufferExt]))}}if(s&&d.length){var S=t.useProgram("collisionCircle"),T=new e.StructArrayLayout2f1f2i16;T.resize(4*f),T._trim();for(var E=0,P=0,M=d;P<M.length;P++)for(var I=M[P],A=0;A<I.circleArray.length/4;A++){var R=4*A,O=I.circleArray[R+0],N=I.circleArray[R+1],D=I.circleArray[R+2],z=I.circleArray[R+3];T.emplace(E++,O,N,D,z,0),T.emplace(E++,O,N,D,z,1),T.emplace(E++,O,N,D,z,2),T.emplace(E++,O,N,D,z,3)}(!Qn||Qn.length<2*f)&&(Qn=function(t){var n=2*t,i=new e.StructArrayLayout3ui6;i.resize(n),i._trim();for(var r=0;r<n;r++){var a=6*r;i.uint16[a+0]=4*r+0,i.uint16[a+1]=4*r+1,i.uint16[a+2]=4*r+2,i.uint16[a+3]=4*r+2,i.uint16[a+4]=4*r+3,i.uint16[a+5]=4*r+0}return i}(f));for(var L,B=l.createIndexBuffer(Qn,!0),F=l.createVertexBuffer(T,e.collisionCircleLayout.members,!0),j=0,H=d;j<H.length;j++){var V=H[j],U={u_matrix:V.transform,u_inv_matrix:V.invTransform,u_camera_to_center_distance:(L=c).getCameraToCenterDistance(V.projection),u_viewport_size:[L.width,L.height]};S.draw(l,u.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,U,i.id,F,B,e.SegmentVector.simpleSegment(0,2*V.circleOffset,V.circleArray.length,V.circleArray.length/2),null,c.zoom)}F.destroy(),B.destroy()}}var si=e.create();function li(t,n){var i=t.width,r=t.height,a=t.anchor,o=t.textOffset,s=t.textScale,l=e.getAnchorAlignment(a),u=-(l.horizontalAlign-.5)*i,c=-(l.verticalAlign-.5)*r,h=e.evaluateVariableOffset(a,o);return new e.Point((u/s+h[0])*n,(c/s+h[1])*n)}function ui(t,n,i,r,a,o,s,l,u,c,h){var d=t.text.placedSymbolArray,f=t.text.dynamicLayoutVertexArray,p=t.icon.dynamicLayoutVertexArray,m={},v=t.getProjection(),g=yt(l,v,o),y=o.elevation,_=v.upVectorScale(l.canonical,o.center.lat,o.worldSize).metersToTile;f.clear();for(var x=0;x<d.length;x++){var b=d.get(x),w=b.tileAnchorX,k=b.tileAnchorY,C=b.numGlyphs,S=b.hidden||!b.crossTileID||t.allowVerticalPlacement&&!b.placedOrientation?null:r[b.crossTileID];if(S){var T,E,P=0,M=0,I=0;if(y){var A=y?y.getAtTileOffset(l,w,k):0,R=_slicedToArray(v.upVector(l.canonical,w,k),3);P=A*R[0]*_,M=A*R[1]*_,I=A*R[2]*_}var O=_slicedToArray(nt(b.projectedAnchorX+P,b.projectedAnchorY+M,b.projectedAnchorZ+I,i?g:s),4),N=O[0],D=O[1],z=O[2],L=O[3],B=it(o.getCameraToCenterDistance(v),L),F=a.evaluateSizeForFeature(t.textSizeData,c,b)*B/e.ONE_EM;i&&(F*=t.tilePixelRatio/u);var j=li(S,F);i?(N=(E=_slicedToArray(nt((N=(T=v.projectTilePoint(w+j.x,k+j.y,l.canonical)).x)+P,(D=T.y)+M,(z=T.z)+I,s),3))[0],D=E[1],z=E[2]):(n&&j._rotate(-o.angle),N+=j.x,D+=j.y,z=0);for(var H=t.allowVerticalPlacement&&b.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,V=0;V<C;V++)e.addDynamicAttributes(f,N,D,z,H);h&&b.associatedIconIndex>=0&&(m[b.associatedIconIndex]={x:N,y:D,z:z,angle:H})}else dt(C,f)}if(h){p.clear();for(var U=t.icon.placedSymbolArray,q=0;q<U.length;q++){var G=U.get(q),W=G.numGlyphs,Z=m[q];if(G.hidden||!Z)dt(W,p);else for(var X=Z.x,K=Z.y,Y=Z.z,J=Z.angle,Q=0;Q<W;Q++)e.addDynamicAttributes(p,X,K,Y,J)}t.icon.dynamicLayoutVertexBuffer.updateData(p)}t.text.dynamicLayoutVertexBuffer.updateData(f)}function ci(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function hi(t,n,i,r,a,o,s,l,u,c,h,d){var f=t.context,p=f.gl,m=t.transform,v="map"===l,g="map"===u,y=v&&"point"!==i.layout.get("symbol-placement"),_=v&&!g&&!y,x=void 0!==i.layout.get("symbol-sort-key").constantOr(1),b=!1,w=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),k=[e.mercatorXfromLng(m.center.lng),e.mercatorYfromLat(m.center.lat)],C=i.layout.get("text-variable-anchor"),S="globe"===m.projection.name,T=[],E=[0,-1,0],P=E;!S&&!m.mercatorFromTransition||v||(P=function(t){var n=t._camera.getWorldToCamera(t.worldSize,1),i=e.multiply([],n,t.globeMatrix);e.invert(i,i);var r=[0,0,0],a=[0,1,0,0];return e.transformMat4$1(a,a,i),r[0]=a[0],r[1]=a[1],r[2]=a[2],e.normalize(r,r),r}(m));var M,I=_createForOfIteratorHelper(r);try{for(I.s();!(M=I.n()).done;){var A=M.value,R=n.getTile(A),O=R.getBucket(i);if(O&&("mercator"!==O.projection.name||!S)){var N=a?O.text:O.icon;if(N&&!O.fullyClipped&&N.segments.get().length){var D=N.programConfigurations.get(i.id),z=a||O.sdfIcons,L=a?O.textSizeData:O.iconSizeData,B=g||0!==m.pitch,F=e.evaluateSizeForZoom(L,m.zoom),j=void 0,H=void 0,V=void 0,U=void 0,q=[0,0],G=null;if(a)H=R.glyphAtlasTexture,V=p.LINEAR,j=R.glyphAtlasTexture.size,O.iconsInText&&(q=R.imageAtlasTexture.size,G=R.imageAtlasTexture,U=B||t.options.rotating||t.options.zooming||"composite"===L.kind||"camera"===L.kind?p.LINEAR:p.NEAREST);else{var W=1!==i.layout.get("icon-size").constantOr(0)||O.iconsNeedLinear;H=R.imageAtlasTexture,V=z||t.options.rotating||t.options.zooming||W||B?p.LINEAR:p.NEAREST,j=R.imageAtlasTexture.size}var Z="globe"===O.projection.name,X=Z?P:E,K=Z?e.globeToMercatorTransition(m.zoom):0,Y=yt(A,O.getProjection(),m),J=m.calculatePixelsToTileUnitsMatrix(R),Q=$e(Y,R.tileID.canonical,g,v,m,O.getProjection(),J),$=t.terrain&&g&&y?e.invert(e.create(),Q):si,ee=tt(Y,R.tileID.canonical,g,v,m,O.getProjection(),J),te=C&&O.hasTextData(),ne="none"!==i.layout.get("icon-text-fit")&&te&&O.hasIconData();if(y){var ie=m.elevation,re=ie?ie.getAtTileOffsetFunc(A,m.center.lat,m.worldSize,O.getProjection()):null,ae=et(Y,R.tileID.canonical,g,v,m,O.getProjection(),J);at(O,Y,t,a,ae,ee,g,c,re,A)}var oe=y||a&&C||ne,se=t.translatePosMatrix(Y,R,o,s),le=oe?si:Q,ue=t.translatePosMatrix(ee,R,o,s,!0),ce=O.getProjection().createInversionMatrix(m,A.canonical),he=[];t.terrainRenderModeElevated()&&g&&he.push("PITCH_WITH_MAP_TERRAIN"),Z&&he.push("PROJECTION_GLOBE_VIEW"),oe&&he.push("PROJECTED_POS_ON_VIEWPORT");var de,fe=z&&0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);de=z?O.iconsInText?ni(L.kind,F,_,g,t,se,le,ue,j,q,A,K,k,ce,X,O.getProjection()):ti(L.kind,F,_,g,t,se,le,ue,a,j,!0,A,K,k,ce,X,O.getProjection()):ei(L.kind,F,_,g,t,se,le,ue,a,j,A,K,k,ce,X,O.getProjection());var pe={program:t.useProgram(ci(z,a,O),D,he),buffers:N,uniformValues:de,atlasTexture:H,atlasTextureIcon:G,atlasInterpolation:V,atlasInterpolationIcon:U,isSDF:z,hasHalo:fe,tile:R,labelPlaneMatrixInv:$};if(x&&O.canOverlap){b=!0;var me,ve=_createForOfIteratorHelper(N.segments.get());try{for(ve.s();!(me=ve.n()).done;){var ge=me.value;T.push({segments:new e.SegmentVector([ge]),sortKey:ge.sortKey,state:pe})}}catch(ke){ve.e(ke)}finally{ve.f()}}else T.push({segments:N.segments,sortKey:0,state:pe})}}}}catch(ke){I.e(ke)}finally{I.f()}b&&T.sort((function(e,t){return e.sortKey-t.sortKey}));for(var ye=0,_e=T;ye<_e.length;ye++){var xe=_e[ye],be=xe.state;if(t.terrain&&t.terrain.setupElevationDraw(be.tile,be.program,{useDepthForOcclusion:!S,labelPlaneMatrixInv:be.labelPlaneMatrixInv}),f.activeTexture.set(p.TEXTURE0),be.atlasTexture.bind(be.atlasInterpolation,p.CLAMP_TO_EDGE),be.atlasTextureIcon&&(f.activeTexture.set(p.TEXTURE1),be.atlasTextureIcon&&be.atlasTextureIcon.bind(be.atlasInterpolationIcon,p.CLAMP_TO_EDGE)),be.isSDF){var we=be.uniformValues;be.hasHalo&&(we.u_is_halo=1,di(be.buffers,xe.segments,i,t,be.program,w,h,d,we)),we.u_is_halo=0}di(be.buffers,xe.segments,i,t,be.program,w,h,d,be.uniformValues)}}function di(t,n,i,r,a,o,s,l,u){var c=r.context,h=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer];a.draw(c,c.gl.TRIANGLES,o,s,l,e.CullFaceMode.disabled,u,i.id,t.layoutVertexBuffer,t.indexBuffer,n,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),h)}function fi(t,n,i,r,a,o,s){var l,u,c,h,d,f=t.context.gl,p=i.paint.get("fill-pattern"),m=p&&p.constantOr(1);s?(u=m&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",l=f.LINES):(u=m?"fillPattern":"fill",l=f.TRIANGLES);var v,g=_createForOfIteratorHelper(r);try{for(g.s();!(v=g.n()).done;){var y=v.value,_=n.getTile(y);if(!m||_.patternsLoaded()){var x=_.getBucket(i);if(x){t.prepareDrawTile();var b=x.programConfigurations.get(i.id),w=t.useProgram(u,b);m&&(t.context.activeTexture.set(f.TEXTURE0),_.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),b.updatePaintBuffers());var k=p.constantOr(null);if(k&&_.imageAtlas){var C=_.imageAtlas.patternPositions[k.toString()];C&&b.setConstantPatternPositions(C)}var S=t.translatePosMatrix(y.projMatrix,_,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(s){h=x.indexBuffer2,d=x.segments2;var T=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[f.drawingBufferWidth,f.drawingBufferHeight];c="fillOutlinePattern"===u&&m?Fn(S,t,_,T):Bn(S,T)}else h=x.indexBuffer,d=x.segments,c=m?Ln(S,t,_):zn(S);t.prepareDrawProgram(t.context,w,y.toUnwrapped()),w.draw(t.context,l,a,t.stencilModeForClipping(y),o,e.CullFaceMode.disabled,c,i.id,x.layoutVertexBuffer,h,d,i.paint,t.transform.zoom,b)}}}}catch(E){g.e(E)}finally{g.f()}}function pi(t,n,i,r,a,o,s){var l=t.context,u=l.gl,c=t.transform,h=i.paint.get("fill-extrusion-pattern"),d=h.constantOr(1),f=i.paint.get("fill-extrusion-opacity"),p=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),i.paint.get("fill-extrusion-ambient-occlusion-radius")],m=i.layout.get("fill-extrusion-edge-radius"),v=m>0&&!i.paint.get("fill-extrusion-rounded-roof"),g=v?0:m,y="globe"===c.projection.name?e.fillExtrusionHeightLift():0,_="globe"===c.projection.name,x=_?e.globeToMercatorTransition(c.zoom):0,b=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)],w=[];_&&w.push("PROJECTION_GLOBE_VIEW"),p[0]>0&&w.push("FAUX_AO"),v&&w.push("ZERO_ROOF_RADIUS");var k,C=_createForOfIteratorHelper(r);try{for(C.s();!(k=C.n()).done;){var S=k.value,T=n.getTile(S),E=T.getBucket(i);if(E&&E.projection.name===c.projection.name){var P=E.programConfigurations.get(i.id),M=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",P,w);if(t.terrain){var I=t.terrain;if(t.style.terrainSetForDrapingOnly())I.setupElevationDraw(T,M,{useMeterToDem:!0});else{if(!E.enableTerrain)continue;if(I.setupElevationDraw(T,M,{useMeterToDem:!0}),mi(l,n,S,E,i,I),!E.centroidVertexBuffer){var A=M.attributes.a_centroid_pos;void 0!==A&&u.vertexAttrib2f(A,0,0)}}}d&&(t.context.activeTexture.set(u.TEXTURE0),T.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),P.updatePaintBuffers());var R=h.constantOr(null);if(R&&T.imageAtlas){var O=T.imageAtlas.patternPositions[R.toString()];O&&P.setConstantPatternPositions(O)}var N=t.translatePosMatrix(S.projMatrix,T,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),D=c.projection.createInversionMatrix(c,S.canonical),z=i.paint.get("fill-extrusion-vertical-gradient"),L=d?Dn(N,t,z,f,p,g,S,T,y,x,b,D):Nn(N,t,z,f,p,g,S,y,x,b,D);t.prepareDrawProgram(l,M,S.toUnwrapped());var B=[];t.terrain&&B.push(E.centroidVertexBuffer),_&&B.push(E.layoutVertexExtBuffer),M.draw(l,l.gl.TRIANGLES,a,o,s,e.CullFaceMode.backCCW,L,i.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,i.paint,t.transform.zoom,P,B)}}}catch(F){C.e(F)}finally{C.f()}}function mi(t,n,i,r,a,o){for(var s,l,u,c=[function(t){var n=t.canonical.x-1,i=t.wrap;return n<0&&(n=(1<<t.canonical.z)-1,i--),new e.OverscaledTileID(t.overscaledZ,i,t.canonical.z,n,t.canonical.y)},function(t){var n=t.canonical.x+1,i=t.wrap;return n===1<<t.canonical.z&&(n=0,i++),new e.OverscaledTileID(t.overscaledZ,i,t.canonical.z,n,t.canonical.y)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)}],h=function(e){for(var t=n.getSource().minzoom,i=function(e){var t=n.getTileByID(e);if(t&&t.hasData())return t.getBucket(a)},r=0,o=[0,-1,1];r<o.length;r++){var s=o[r];if(!(e.overscaledZ+s<t)){var l=i(e.calculateScaledKey(e.overscaledZ+s));if(l)return l}}},d=[0,0,0],f=function(t,n){return d[0]=Math.min(t.min.y,n.min.y),d[1]=Math.max(t.max.y,n.max.y),d[2]=e.EXTENT-n.min.x>t.max.x?n.min.x-e.EXTENT:t.max.x,d},p=function(t,n){return d[0]=Math.min(t.min.x,n.min.x),d[1]=Math.max(t.max.x,n.max.x),d[2]=e.EXTENT-n.min.y>t.max.y?n.min.y-e.EXTENT:t.max.y,d},m=[function(e,t){return f(e,t)},function(e,t){return f(t,e)},function(e,t){return p(e,t)},function(e,t){return p(t,e)}],v=new e.Point(0,0),g=function(t,n,r,a,c){var h=[[a?r:t,a?t:r,0],[a?r:n,a?n:r,0]],d=c<0?e.EXTENT+c:c,f=[a?d:(t+n)/2,a?(t+n)/2:d,0];return 0===r&&c<0||0!==r&&c>0?o.getForTilePoints(u,[f],!0,l):h.push(f),o.getForTilePoints(i,h,!0,s),Math.max(h[0][2],h[1][2],f[2])/o.exaggeration()},y=0;y<4;y++){var _=(y<2?1:5)-y,x=r.borders[y];if(0!==x.length){var b=u=c[y](i),w=h(b);if(w&&w instanceof e.FillExtrusionBucket&&w.enableTerrain&&(r.borderDoneWithNeighborZ[y]!==w.canonical.z||w.borderDoneWithNeighborZ[_]!==r.canonical.z)&&(l=o.findDEMTileFor(b))&&l.dem){if(!s){var k=o.findDEMTileFor(i);if(!k||!k.dem)return;s=k}var C=w.borders[_],S=0,T=w.borderDoneWithNeighborZ[_]!==r.canonical.z;if(r.canonical.z===w.canonical.z){for(var E=0;E<x.length;E++){for(var P=r.featuresOnBorder[x[E]],M=P.borders[y],I=void 0;S<C.length&&!((I=w.featuresOnBorder[C[S]]).borders[_][1]>M[0]+3);)T&&w.encodeCentroid(void 0,I,!1),S++;if(I&&S<C.length){for(var A=S,R=0;!(I.borders[_][0]>M[1]-3)&&(R++,++S!==C.length);)I=w.featuresOnBorder[C[S]];if(I=w.featuresOnBorder[C[A]],P.intersectsCount()>1||I.intersectsCount()>1||1!==R){1!==R&&(S=A),r.encodeCentroid(void 0,P,!1),T&&w.encodeCentroid(void 0,I,!1);continue}var O=m[y](P,I),N=y%2?e.EXTENT-1:0;v.x=g(O[0],Math.min(e.EXTENT-1,O[1]),N,y<2,O[2]),v.y=0,r.encodeCentroid(v,P,!1),T&&w.encodeCentroid(v,I,!1)}else r.encodeCentroid(void 0,P,!1)}r.borderDoneWithNeighborZ[y]=w.canonical.z,r.needsCentroidUpdate=!0,T&&(w.borderDoneWithNeighborZ[_]=r.canonical.z,w.needsCentroidUpdate=!0)}else{var D,z=_createForOfIteratorHelper(x);try{for(z.s();!(D=z.n()).done;){var L=D.value;r.encodeCentroid(void 0,r.featuresOnBorder[L],!1)}}catch(H){z.e(H)}finally{z.f()}if(T){var B,F=_createForOfIteratorHelper(C);try{for(F.s();!(B=F.n()).done;){var j=B.value;w.encodeCentroid(void 0,w.featuresOnBorder[j],!1)}}catch(H){F.e(H)}finally{F.f()}w.borderDoneWithNeighborZ[_]=r.canonical.z,w.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[y]=w.canonical.z,r.needsCentroidUpdate=!0}}}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(t)}var vi=new e.Color(1,0,0,1),gi=new e.Color(0,1,0,1),yi=new e.Color(0,0,1,1),_i=new e.Color(1,0,1,1),xi=new e.Color(0,1,1,1);function bi(t,n,i){var r=t.context,a=t.transform,o=r.gl,s="globe"===a.projection.name,l=s?["PROJECTION_GLOBE_VIEW"]:null,u=i.projMatrix;if(s&&e.globeToMercatorTransition(a.zoom)>0){var c=e.transitionTileAABBinECEF(i.canonical,a),h=e.globeDenormalizeECEF(c);u=e.multiply(new Float32Array(16),a.globeMatrix,h),e.multiply(u,a.projMatrix,u)}var d=t.useProgram("debug",null,l),f=n.getTileByID(i.key);t.terrain&&t.terrain.setupElevationDraw(f,d);var p=e.DepthMode.disabled,m=e.StencilMode.disabled,v=t.colorModeForRenderPass(),g="$debug";r.activeTexture.set(o.TEXTURE0),t.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s?f._makeGlobeTileDebugBuffers(t.context,a):f._makeDebugTileBoundsBuffers(t.context,a.projection);var y=f._tileDebugBuffer||t.debugBuffer,_=f._tileDebugIndexBuffer||t.debugIndexBuffer,x=f._tileDebugSegments||t.debugSegments;d.draw(r,o.LINE_STRIP,p,m,v,e.CullFaceMode.disabled,qn(u,e.Color.red),g,y,_,x,null,null,null,[f._globeTileDebugBorderBuffer]);var b=f.latestRawTileData,w=Math.floor((b&&b.byteLength||0)/1024),k=n.getTile(i).tileSize,C=512/Math.min(k,512)*(i.overscaledZ/a.zoom)*.5,S=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(S+=" => "+i.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var n=e.debugOverlayCanvas,i=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,S+=" ".concat(w,"kb"));var T=f._tileDebugTextBuffer||t.debugBuffer,E=f._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,P=f._tileDebugTextSegments||t.debugSegments;d.draw(r,o.TRIANGLES,p,m,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,qn(u,e.Color.transparent,C),g,T,E,P,null,null,null,[f._globeTileDebugTextBuffer])}function wi(e,t,n,i){Ci(e,0,t+n/2,e.transform.width,n,i)}function ki(e,t,n,i){Ci(e,t-n/2,0,n,e.transform.height,i)}function Ci(t,n,i,r,a,o){var s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*e.exported.devicePixelRatio,i*e.exported.devicePixelRatio,r*e.exported.devicePixelRatio,a*e.exported.devicePixelRatio),s.clear({color:o}),l.disable(l.SCISSOR_TEST)}var Si=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]).members;function Ti(e,t,n,i){e.emplaceBack(t,n,i)}var Ei=_createClass((function t(n){_classCallCheck(this,t),this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,Ti(this.vertexArray,-1,-1,1),Ti(this.vertexArray,1,-1,1),Ti(this.vertexArray,-1,1,1),Ti(this.vertexArray,1,1,1),Ti(this.vertexArray,-1,-1,-1),Ti(this.vertexArray,1,-1,-1),Ti(this.vertexArray,-1,1,-1),Ti(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,Si),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}));function Pi(t,n,i,r,a,o){var s=t.gl,l=n.paint.get("sky-atmosphere-color"),u=n.paint.get("sky-atmosphere-halo-color"),c=n.paint.get("sky-atmosphere-sun-intensity"),h=function(e,t,n,i,r){return{u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:n,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}}(e.fromMat4(e.create$1(),r),a,c,l,u);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+o,n.skyboxTexture,0),i.draw(t,s.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}var Mi=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),Ii=function(){function t(n){_classCallCheck(this,t);var i=new e.StructArrayLayout5f20;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);var r=new e.StructArrayLayout3ui6;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(i,Mi.members),this.indexBuffer=n.createIndexBuffer(r),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}return _createClass(t,[{key:"destroy",value:function(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}]),t}(),Ai={symbol:function(t,n,i,r,a){if("translucent"===t.renderPass){var o=e.StencilMode.disabled,s=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,n,i,r,a,o,s){var l,u=n.transform,c="map"===a,h="map"===o,d=_createForOfIteratorHelper(t);try{for(d.s();!(l=d.n()).done;){var f=l.value,p=r.getTile(f),m=p.getBucket(i);if(m&&m.text&&m.text.segments.get().length){var v=e.evaluateSizeForZoom(m.textSizeData,u.zoom),g=yt(f,m.getProjection(),u),y=u.calculatePixelsToTileUnitsMatrix(p),_=$e(g,p.tileID.canonical,h,c,u,m.getProjection(),y),x="none"!==i.layout.get("icon-text-fit")&&m.hasIconData();if(v){var b=Math.pow(2,u.zoom-p.tileID.overscaledZ);ui(m,c,h,s,e.symbolSize,u,_,f,b,v,x)}}}}catch(w){d.e(w)}finally{d.f()}}(r,t,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),a),0!==i.paint.get("icon-opacity").constantOr(1)&&hi(t,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),o,s),0!==i.paint.get("text-opacity").constantOr(1)&&hi(t,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),o,s),n.map.showCollisionBoxes&&(oi(t,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),oi(t,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(t,n,i,r){if("translucent"===t.renderPass){var a=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==a.constantOr(1)||0!==o.constantOr(1)&&0!==s.constantOr(1)){for(var u=t.context,c=u.gl,h=t.transform,d=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),f=e.StencilMode.disabled,p=t.colorModeForRenderPass(),m="globe"===h.projection.name,v=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],g=[],y=0;y<r.length;y++){var _=r[y],x=n.getTile(_),b=x.getBucket(i);if(b&&b.projection.name===h.projection.name){var w=b.programConfigurations.get(i.id),k=Vn(i);m&&k.push("PROJECTION_GLOBE_VIEW");var C=t.useProgram("circle",w,k),S=b.layoutVertexBuffer,T=b.globeExtVertexBuffer,E=b.indexBuffer,P=h.projection.createInversionMatrix(h,_.canonical),M={programConfiguration:w,program:C,layoutVertexBuffer:S,globeExtVertexBuffer:T,indexBuffer:E,uniformValues:Hn(t,_,x,P,v,i),tile:x};if(l){var I,A=_createForOfIteratorHelper(b.segments.get());try{for(A.s();!(I=A.n()).done;){var R=I.value;g.push({segments:new e.SegmentVector([R]),sortKey:R.sortKey,state:M})}}catch(W){A.e(W)}finally{A.f()}}else g.push({segments:b.segments,sortKey:0,state:M})}}l&&g.sort((function(e,t){return e.sortKey-t.sortKey}));for(var O={useDepthForOcclusion:!m},N=0,D=g;N<D.length;N++){var z=D[N],L=z.state,B=L.programConfiguration,F=L.program,j=L.layoutVertexBuffer,H=L.globeExtVertexBuffer,V=L.indexBuffer,U=L.uniformValues,q=L.tile,G=z.segments;t.terrain&&t.terrain.setupElevationDraw(q,F,O),t.prepareDrawProgram(u,F,q.tileID.toUnwrapped()),F.draw(u,c.TRIANGLES,d,f,p,e.CullFaceMode.disabled,U,i.id,j,V,G,i.paint,h.zoom,B,[H])}}}},heatmap:function(t,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var a=t.context,o=a.gl,s=e.StencilMode.disabled,l=new e.ColorMode([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,n,i){var r=e.gl,a=t.width*i,o=t.height*i;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,a,o]);var s=n.heatmapFbo;if(!s||s&&(s.width!==a||s.height!==o)){s&&s.destroy();var l=r.createTexture();r.bindTexture(r.TEXTURE_2D,l),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),s=n.heatmapFbo=e.createFramebuffer(a,o,!1),function(e,t,n,i,r,a){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,e.isWebGL2&&e.extRenderToTextureHalfFloat?o.RGBA16F:o.RGBA,r,a,0,o.RGBA,e.extRenderToTextureHalfFloat?e.isWebGL2?o.HALF_FLOAT:e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(e,0,l,s,a,o)}else r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),e.bindFramebuffer.set(s.framebuffer)}(a,t,i,"globe"===t.transform.projection.name?.5:.25),a.clear({color:e.Color.transparent});for(var u=t.transform,c="globe"===u.projection.name,h=c?["PROJECTION_GLOBE_VIEW"]:null,d=c?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,f=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],p=0;p<r.length;p++){var m=r[p];if(!n.hasRenderableParent(m)){var v=n.getTile(m),g=v.getBucket(i);if(g&&g.projection.name===u.projection.name){var y=g.programConfigurations.get(i.id),_=t.useProgram("heatmap",y,h),x=t.transform.zoom;t.terrain&&t.terrain.setupElevationDraw(v,_),t.prepareDrawProgram(a,_,m.toUnwrapped());var b=u.projection.createInversionMatrix(u,m.canonical);_.draw(a,o.TRIANGLES,e.DepthMode.disabled,s,l,d,Wn(t,m,v,b,f,x,i.paint.get("heatmap-intensity")),i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,i.paint,t.transform.zoom,y,c?[g.globeExtVertexBuffer]:null)}}}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,n){var i=t.context,r=i.gl,a=n.heatmapFbo;if(a){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var o=n.colorRampTexture;o||(o=n.colorRampTexture=new e.Texture(i,n.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,function(e,t,n,i){return{u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}}(0,n),n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom)}}(t,i))},line:function(t,n,i,r){if("translucent"===t.renderPass){var a=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0!==a.constantOr(1)&&0!==o.constantOr(1)){var s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,c=i.paint.get("line-dasharray"),h=c.constantOr(1),d=i.layout.get("line-cap"),f=i.paint.get("line-pattern"),p=f.constantOr(1),m=i.paint.get("line-gradient"),v=p?"linePattern":"line",g=t.context,y=g.gl,_=function(e){var t=[];Kn(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");var n=e.paint.get("line-trim-offset");0===n[0]&&0===n[1]||t.push("RENDER_LINE_TRIM_OFFSET");var i=e.paint.get("line-pattern").constantOr(1),r=1!==e.paint.get("line-opacity").constantOr(1);return!i&&r&&t.push("RENDER_LINE_ALPHA_DISCARD"),t}(i),x=_.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(x=!1);var b,w=_createForOfIteratorHelper(r);try{var k=function(){var r=b.value,a=n.getTile(r);if(p&&!a.patternsLoaded())return 0;var o=a.getBucket(i);if(!o)return 0;t.prepareDrawTile();var w=o.programConfigurations.get(i.id),k=t.useProgram(v,w,_),C=f.constantOr(null);if(C&&a.imageAtlas){var S=a.imageAtlas.patternPositions[C.toString()];S&&w.setConstantPatternPositions(S)}var T=c.constantOr(null),E=d.constantOr(null);if(!p&&T&&E&&a.lineAtlas){var P=a.lineAtlas.getDash(T,E);P&&w.setConstantPatternPositions(P)}var M=_slicedToArray(i.paint.get("line-trim-offset"),2),I=M[0],A=M[1];if("round"===E||"square"===E){I!==A&&(0===I&&(I-=1),1===A&&(A+=1))}var R=t.terrain?r.projMatrix:null,O=p?function(e,t,n,i,r){var a=e.transform;return{u_matrix:Xn(e,t,n,i),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:a.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:r,u_image:0,u_tile_units_to_pixels:Zn(t,a),u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}}(t,a,i,R,u):function(e,t,n,i,r,a,o){var s=e.transform,l=s.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:Xn(e,t,n,i),u_pixels_to_tile_units:l,u_device_pixel_ratio:a,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:r,u_texsize:Kn(n)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Zn(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:o}}(t,a,i,R,o.lineClipsArray.length,u,[I,A]);if(m){var N=o.gradients[i.id],D=N.texture;if(i.gradientVersion!==N.version){var z=256;if(i.stepInterpolant){var L=n.getSource().maxzoom,B=r.canonical.z===L?Math.ceil(1<<t.transform.maxZoom-r.canonical.z):1;z=e.clamp(e.nextPowerOfTwo(o.maxLineLength/e.EXTENT*1024*B),256,g.maxTextureSize)}N.gradient=e.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:z,image:N.gradient||void 0,clips:o.lineClipsArray}),N.texture?N.texture.update(N.gradient):N.texture=new e.Texture(g,N.gradient,y.RGBA),N.version=i.gradientVersion,D=N.texture}g.activeTexture.set(y.TEXTURE1),D.bind(i.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}h&&(g.activeTexture.set(y.TEXTURE0),a.lineAtlasTexture.bind(y.LINEAR,y.REPEAT),w.updatePaintBuffers()),p&&(g.activeTexture.set(y.TEXTURE0),a.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),w.updatePaintBuffers()),t.prepareDrawProgram(g,k,r.toUnwrapped());var F=function(n){k.draw(g,y.TRIANGLES,s,n,l,e.CullFaceMode.disabled,O,i.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,i.paint,t.transform.zoom,w,[o.layoutVertexBuffer2])};if(x){var j=t.stencilModeForClipping(r).ref;0===j&&t.terrain&&g.clear({stencil:0});var H={func:y.EQUAL,mask:255};O.u_alpha_discard_threshold=.8,F(new e.StencilMode(H,j,255,y.KEEP,y.KEEP,y.INVERT)),O.u_alpha_discard_threshold=0,F(new e.StencilMode(H,j,255,y.KEEP,y.KEEP,y.KEEP))}else F(t.stencilModeForClipping(r))};for(w.s();!(b=w.n()).done;)k()}catch(C){w.e(C)}finally{w.f()}x&&(t.resetStencilClippingMasks(),t.terrain&&g.clear({stencil:0}))}}},fill:function(t,n,i,r){var a=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=t.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===u){var c=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);fi(t,n,i,r,c,s,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){var h=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);fi(t,n,i,r,h,s,!0)}}},"fill-extrusion":function(t,n,i,r){var a=i.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===t.renderPass){var o=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==a||i.paint.get("fill-extrusion-pattern").constantOr(1))pi(t,n,i,r,o,e.StencilMode.disabled,e.ColorMode.disabled),pi(t,n,i,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{var s=t.colorModeForRenderPass();pi(t,n,i,r,o,e.StencilMode.disabled,s)}}},hillshade:function(t,n,i,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var a,o=t.context,s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture,c=_slicedToArray("translucent"!==t.renderPass||u?[{},r]:t.stencilConfigForOverlap(r),2),h=c[0],d=_createForOfIteratorHelper(c[1]);try{for(d.s();!(a=d.n()).done;){var f=a.value,p=n.getTile(f);if(p.needsHillshadePrepare&&"offscreen"===t.renderPass)vn(t,p,i,s,e.StencilMode.disabled,l);else if("translucent"===t.renderPass){var m=u&&t.terrain?t.terrain.stencilModeForRTTOverlap(f):h[f.overscaledZ];pn(t,f,p,i,s,m,l)}}}catch(v){d.e(v)}finally{d.f()}o.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()}},raster:function(t,n,i,r,a,o){if("translucent"===t.renderPass&&0!==i.paint.get("raster-opacity")&&r.length){var s,l=t.context,u=l.gl,c=n.getSource(),h=t.useProgram("raster"),d=t.colorModeForRenderPass(),f=t.terrain&&t.terrain.renderingToTexture,p=_slicedToArray(c instanceof Pe||f?[{},r]:t.stencilConfigForOverlap(r),2),m=p[0],v=p[1],g=v[v.length-1].overscaledZ,y=!t.options.moving,_=_createForOfIteratorHelper(v);try{for(_.s();!(s=_.n()).done;){var x=s.value,b=f?e.DepthMode.disabled:t.depthModeForSublayer(x.overscaledZ-g,1===i.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,u.LESS),w=x.toUnwrapped(),k=n.getTile(x);if(!f||k&&k.hasData()){var C=f?x.projMatrix:t.transform.calculateProjMatrix(w,y),S=t.terrain&&f?t.terrain.stencilModeForRTTOverlap(x):m[x.overscaledZ],T=o?0:i.paint.get("raster-fade-duration");k.registerFadeDuration(T);var E=n.findLoadedParent(x,0),P=Tn(k,E,n,t.transform,T),M=void 0,I=void 0;t.terrain&&t.terrain.prepareDrawTile();var A="nearest"===i.paint.get("raster-resampling")?u.NEAREST:u.LINEAR;l.activeTexture.set(u.TEXTURE0),k.texture.bind(A,u.CLAMP_TO_EDGE),l.activeTexture.set(u.TEXTURE1),E?(E.texture.bind(A,u.CLAMP_TO_EDGE),M=Math.pow(2,E.tileID.overscaledZ-k.tileID.overscaledZ),I=[k.tileID.canonical.x*M%1,k.tileID.canonical.y*M%1]):k.texture.bind(A,u.CLAMP_TO_EDGE),k.texture.useMipmap&&l.extTextureFilterAnisotropic&&t.transform.pitch>20&&u.texParameterf(u.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax);var R=Yn(C,I||[0,0],M||1,P,i,c instanceof Pe?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(l,h,w),c instanceof Pe)c.boundsBuffer&&c.boundsSegments&&h.draw(l,u.TRIANGLES,b,e.StencilMode.disabled,d,e.CullFaceMode.disabled,R,i.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{var O=t.getTileBoundsBuffers(k),N=O.tileBoundsBuffer,D=O.tileBoundsIndexBuffer,z=O.tileBoundsSegments;h.draw(l,u.TRIANGLES,b,S,d,e.CullFaceMode.disabled,R,i.id,N,D,z)}}}}catch(L){_.e(L)}finally{_.f()}t.resetStencilClippingMasks()}},background:function(t,n,i,r){var a=i.paint.get("background-color"),o=i.paint.get("background-opacity");if(0!==o){var s=t.context,l=s.gl,u=t.transform,c=u.tileSize,h=i.paint.get("background-pattern");if(!t.isPatternMissing(h)){var d=!h&&1===a.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===d){var f,p=e.StencilMode.disabled,m=t.depthModeForSublayer(0,"opaque"===d?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),v=t.colorModeForRenderPass(),g=t.useProgram(h?"backgroundPattern":"background"),y=r;y||(f=t.getBackgroundTiles(),y=Object.values(f).map((function(e){return e.tileID}))),h&&(s.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));var _,x=_createForOfIteratorHelper(y);try{for(x.s();!(_=x.n()).done;){var b=_.value,w=b.toUnwrapped(),k=r?b.projMatrix:t.transform.calculateProjMatrix(w);t.prepareDrawTile();var C=n?n.getTile(b):f?f[b.key]:new e.Tile(b,c,u.zoom,t),S=h?ri(k,o,t,h,{tileID:b,tileSize:c}):ii(k,o,a);t.prepareDrawProgram(s,g,w);var T=t.getTileBoundsBuffers(C),E=T.tileBoundsBuffer,P=T.tileBoundsIndexBuffer,M=T.tileBoundsSegments;g.draw(s,l.TRIANGLES,m,p,v,e.CullFaceMode.disabled,S,i.id,E,P,M)}}catch(I){x.e(I)}finally{x.f()}}}}},sky:function(t,n,i){var r=t.transform,a="mercator"===r.projection.name||"globe"===r.projection.name?1:e.smoothstep(7,8,r.zoom),o=i.paint.get("sky-opacity")*a;if(0!==o){var s=t.context,l=i.paint.get("sky-type"),u=new e.DepthMode(s.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),c=t.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===t.renderPass?i.needsSkyboxCapture(t)&&(function(t,n,i,r){var a=t.context,o=a.gl,s=n.skyboxFbo;if(!s){s=n.skyboxFbo=a.createFramebuffer(32,32,!1),n.skyboxGeometry=new Ei(a),n.skyboxTexture=a.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,n.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(var l=0;l<6;++l)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}a.bindFramebuffer.set(s.framebuffer),a.viewport.set([0,0,32,32]);var u=n.getCenter(t,!0),c=t.useProgram("skyboxCapture"),h=new Float64Array(16);e.identity(h),e.rotateY(h,h,.5*-Math.PI),Pi(a,n,c,h,u,0),e.identity(h),e.rotateY(h,h,.5*Math.PI),Pi(a,n,c,h,u,1),e.identity(h),e.rotateX(h,h,.5*-Math.PI),Pi(a,n,c,h,u,2),e.identity(h),e.rotateX(h,h,.5*Math.PI),Pi(a,n,c,h,u,3),e.identity(h),Pi(a,n,c,h,u,4),e.identity(h),e.rotateY(h,h,Math.PI),Pi(a,n,c,h,u,5),a.viewport.set([0,0,t.width,t.height])}(t,i),i.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,n,i,r,a){var o=t.context,s=o.gl,l=t.transform,u=t.useProgram("skybox");o.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture);var c=function(e,t,n,i,r){return{u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:i,u_temporal_offset:r}}(l.skyboxMatrix,n.getCenter(t,!1),0,r,a);t.prepareDrawProgram(o,u),u.draw(o,s.TRIANGLES,i,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,c,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(t,i,u,o,c):"gradient"===l&&"sky"===t.renderPass&&function(t,n,i,r,a){var o=t.context,s=o.gl,l=t.transform,u=t.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new Ei(o)),o.activeTexture.set(s.TEXTURE0);var c=n.colorRampTexture;c||(c=n.colorRampTexture=new e.Texture(o,n.colorRamp,s.RGBA)),c.bind(s.LINEAR,s.CLAMP_TO_EDGE);var h=function(t,n,i,r,a){return{u_matrix:t,u_color_ramp:0,u_center_direction:n,u_radius:e.degToRad(i),u_opacity:r,u_temporal_offset:a}}(l.skyboxMatrix,n.getCenter(t,!1),n.paint.get("sky-gradient-radius"),r,a);t.prepareDrawProgram(o,u),u.draw(o,s.TRIANGLES,i,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(t,i,u,o,c)}},debug:function(e,t,n){for(var i=0;i<n.length;i++)bi(e,t,n[i])},custom:function(t,n,i,r){var a=t.context,o=i.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&i.isLayerDraped()){if("offscreen"===t.renderPass){var s=o.prerender;if(s){if(t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){var l=t.transform.pointMerc;s.call(o,a.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[l.x,l.y],t.transform.pixelsPerMeterRatio)}else s.call(o,a.gl,t.transform.customLayerMatrix());a.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){var u=o.renderToTile;if(u){var c=r[0].canonical,h=new e.MercatorCoordinate(c.x+r[0].wrap*(1<<c.z),c.y,c.z);a.setDepthMode(e.DepthMode.disabled),a.setStencilMode(e.StencilMode.disabled),a.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),u.call(o,a.gl,h),a.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),a.setStencilMode(e.StencilMode.disabled);var d="3d"===o.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);if(a.setDepthMode(d),"globe"===t.transform.projection.name){var f=t.transform.pointMerc;o.render(a.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[f.x,f.y],t.transform.pixelsPerMeterRatio)}else o.render(a.gl,t.transform.customLayerMatrix());a.setDirty(),t.setBaseState(),a.bindFramebuffer.set(null)}}else e.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}},Ri=function(){function t(n,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.context=new Ce(n,r),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}return _createClass(t,[{key:"updateTerrain",value:function(e,t){var n=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(n||this._terrain&&this._terrain.enabled){this._terrain||(this._terrain=new In(this,e));var i=this._terrain;this.transform.elevation=n?i:null,i.update(e,this.transform,t)}}},{key:"_updateFog",value:function(e){var t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)this.transform.fogCullDistSq=null;else{var n=_slicedToArray(t.getFovAdjustedRange(this.transform._fov),2),i=n[0],r=n[1];if(i>r)this.transform.fogCullDistSq=null;else{var a=i+.78*(r-i);this.transform.fogCullDistSq=a*a}}}},{key:"terrain",get:function(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}},{key:"resize",value:function(t,n){if(this.width=t*e.exported.devicePixelRatio,this.height=n*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style){var i,r=_createForOfIteratorHelper(this.style.order);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.style._layers[a].resize()}}catch(o){r.e(o)}finally{r.f()}}}},{key:"setup",value:function(){var t=this.context,n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var r=new e.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout4i8;a.emplaceBack(0,0,0,0),a.emplaceBack(e.EXTENT,0,e.EXTENT,0),a.emplaceBack(0,e.EXTENT,0,e.EXTENT),a.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(a,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);for(var s=new e.StructArrayLayout1ui2,l=0,u=[0,1,3,2,0];l<u.length;l++){var c=u[l];s.emplaceBack(c)}this.debugIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();var h=this.context.gl;this.stencilClearMode=new e.StencilMode({func:h.ALWAYS,mask:0},0,255,h.ZERO,h.ZERO,h.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new Ii(this.context)}},{key:"getMercatorTileBoundsBuffers",value:function(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}},{key:"getTileBoundsBuffers",value:function(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}},{key:"clearStencil",value:function(){var t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,n.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,Sn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}},{key:"resetStencilClippingMasks",value:function(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}},{key:"_renderTileClippingMasks",value:function(t,n,i){if(n&&this.currentStencilSource!==n.id&&t.isTileClipped()&&i&&0!==i.length){if(this._tileClippingMaskIDs&&!this.terrain){var r,a=!1,o=_createForOfIteratorHelper(i);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(void 0===this._tileClippingMaskIDs[s.key]){a=!0;break}}}catch(x){o.e(x)}finally{o.f()}if(!a)return}this.currentStencilSource=n.id;var l=this.context,u=l.gl;this.nextStencilID+i.length>256&&this.clearStencil(),l.setColorMode(e.ColorMode.disabled),l.setDepthMode(e.DepthMode.disabled);var c=this.useProgram("clippingMask");this._tileClippingMaskIDs={};var h,d=_createForOfIteratorHelper(i);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=n.getTile(f),m=this._tileClippingMaskIDs[f.key]=this.nextStencilID++,v=this.getTileBoundsBuffers(p),g=v.tileBoundsBuffer,y=v.tileBoundsIndexBuffer,_=v.tileBoundsSegments;c.draw(l,u.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:u.ALWAYS,mask:0},m,255,u.KEEP,u.KEEP,u.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Sn(f.projMatrix),"$clipping",g,y,_)}}catch(x){d.e(x)}finally{d.f()}}}},{key:"stencilModeFor3D",value:function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,n=this.context.gl;return new e.StencilMode({func:n.NOTEQUAL,mask:255},t,255,n.KEEP,n.KEEP,n.REPLACE)}},{key:"stencilModeForClipping",value:function(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);var n=this.context.gl;return new e.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,n.KEEP,n.KEEP,n.REPLACE)}},{key:"stencilConfigForOverlap",value:function(t){var n=this.context.gl,i=t.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),r=i[i.length-1].overscaledZ,a=i[0].overscaledZ-r+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();for(var o={},s=0;s<a;s++)o[s+r]=new e.StencilMode({func:n.GEQUAL,mask:255},s+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=a,[o,i]}return[_defineProperty({},r,e.StencilMode.disabled),i]}},{key:"colorModeForRenderPass",value:function(){var t=this.context.gl;if(this._showOverdrawInspector){return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}},{key:"depthModeForSublayer",value:function(t,n,i){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(i||this.context.gl.LEQUAL,n,[r,r])}},{key:"opaquePassEnabledForLayer",value:function(){return this.currentLayer<this.opaquePassCutoff}},{key:"render",value:function(t,n){var i=this;this.style=t,this.options=n,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();var r=this.style.order,a=this.style._sourceCaches;for(var o in a){var s=a[o];s.used&&s.prepare(this.context)}var l={},u={},c={};for(var h in a){var d=a[h];l[h]=d.getVisibleCoordinates(),u[h]=l[h].slice().reverse(),c[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var f=0;f<r.length;f++)if(this.style._layers[r[f]].is3D()){this.opaquePassCutoff=f;break}if(this.terrain&&(this.terrain.updateTileBinding(c),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),e.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";var p,m=_createForOfIteratorHelper(r);try{for(m.s();!(p=m.n()).done;){var v=p.value,g=this.style._layers[v],y=t._getLayerSourceCache(g);if(g.hasOffscreenPass()&&!g.isHidden(this.transform.zoom)){var _=y?u[y.id]:void 0;("custom"===g.type||g.isSky()||_&&_.length)&&this.renderLayer(this,y,g,_)}}}catch(I){m.e(I)}finally{m.f()}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon];var x=this.terrain;if(x&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&x.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:n.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[r[this.currentLayer]],w=t._getLayerSourceCache(b);if(!b.isSky()){var k=w?u[w.id]:void 0;this._renderTileClippingMasks(b,w,k),this.renderLayer(this,w,b,k)}}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,n){var i=t.context,r=i.gl,a=t.transform,o=new e.DepthMode(r.LEQUAL,e.DepthMode.ReadOnly,[0,1]),s=t.useProgram("globeAtmosphere",null,"globe"===a.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=e.globeToMercatorTransition(a.zoom),u=n.properties.get("color").toArray01(),c=n.properties.get("high-color").toArray01(),h=n.properties.get("space-color").toArray01PremultipliedAlpha(),d=e.identity$1([]);e.rotateY$1(d,d,-e.degToRad(a._center.lng)),e.rotateX$1(d,d,e.degToRad(a._center.lat)),e.rotateZ$1(d,d,a.angle),e.rotateX$1(d,d,-a._pitch);var f=e.fromQuat(new Float32Array(16),d),p=e.mapValue(n.properties.get("star-intensity"),0,1,0,.25),m=5e-4,v=e.mapValue(n.properties.get("horizon-blend"),0,1,m,.25),g=e.globeUseCustomAntiAliasing(t,i,a)&&v===m?a.worldSize/(2*Math.PI*1.025)-1:a.globeRadius,y=t.frameCounter/1e3%1,_=e.length(a.globeCenterInViewSpace),x=Math.sqrt(Math.pow(_,2)-Math.pow(g,2)),b=Math.acos(x/_),w=function(t,n,i,r,a,o,s,l,u,c,h,d,f,p){return{u_frustum_tl:t,u_frustum_tr:n,u_frustum_br:i,u_frustum_bl:r,u_horizon:a,u_transition:o,u_fadeout_range:s,u_color:l,u_high_color:u,u_space_color:c,u_star_intensity:h,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:d,u_horizon_angle:f,u_rotation_matrix:p}}(a.frustumCorners.TL,a.frustumCorners.TR,a.frustumCorners.BR,a.frustumCorners.BL,a.frustumCorners.horizon,l,v,u,c,h,p,y,b,f);t.prepareDrawProgram(i,s);var k=t.atmosphereBuffer;k&&s.draw(i,r.TRIANGLES,o,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",k.vertexBuffer,k.indexBuffer,k.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var C=this.style._layers[r[this.currentLayer]],S=t._getLayerSourceCache(C);C.isSky()&&this.renderLayer(this,S,C,S?u[S.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;){var T=this.style._layers[r[this.currentLayer]],E=t._getLayerSourceCache(T);if(T.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(T)){if(T.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer)}else{var P=E?("symbol"===T.type?c:u)[E.id]:void 0;this._renderTileClippingMasks(T,E,E?l[E.id]:void 0),this.renderLayer(this,E,T,P),++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){var M=null;e.values(this.style._layers).forEach((function(e){var n=t._getLayerSourceCache(e);n&&!e.isHidden(i.transform.zoom)&&(!M||M.getSource().maxzoom<n.getSource().maxzoom)&&(M=n)})),M&&this.options.showTileBoundaries&&Ai.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(e){var t=e.transform.padding;wi(e,e.transform.height-(t.top||0),3,vi),wi(e,t.bottom||0,3,gi),ki(e,t.left||0,3,yi),ki(e,e.transform.width-(t.right||0),3,_i);var n=e.transform.centerPoint;!function(e,t,n,i){Ci(e,t-1,n-10,2,20,i),Ci(e,t-10,n-1,20,2,i)}(e,n.x,e.transform.height-n.y,xi)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}}},{key:"renderLayer",value:function(e,t,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||i&&i.length)&&(this.id=n.id,this.gpuTimingStart(n),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(n.type)||e.terrain&&"custom"===n.type)&&Ai[n.type](e,t,n,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}},{key:"gpuTimingStart",value:function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,n=this.gpuTimers[e.id];n||(n=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),n.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,n.query)}}},{key:"gpuTimingDeferredRenderStart",value:function(){if(this.options.gpuTimingDeferredRender){var e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}},{key:"gpuTimingDeferredRenderEnd",value:function(){if(this.options.gpuTimingDeferredRender){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}}},{key:"gpuTimingEnd",value:function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}}},{key:"collectGpuTimers",value:function(){var e=this.gpuTimers;return this.gpuTimers={},e}},{key:"collectDeferredRenderGpuQueries",value:function(){var e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}},{key:"queryGpuTimers",value:function(e){var t={};for(var n in e){var i=e[n],r=this.context.extTimerQuery,a=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),t[n]=a}return t}},{key:"queryGpuTimeDeferredRender",value:function(e){if(!this.options.gpuTimingDeferredRender)return 0;var t,n=this.context.extTimerQuery,i=0,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;i+=n.getQueryObjectEXT(a,n.QUERY_RESULT_EXT)/1e6,n.deleteQueryEXT(a)}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"translatePosMatrix",value:function(t,n,i,r,a){if(!i[0]&&!i[1])return t;var o=a?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){var s=Math.sin(o),l=Math.cos(o);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var u=[a?i[0]:I(n,i[0],this.transform.zoom),a?i[1]:I(n,i[1],this.transform.zoom),0],c=new Float32Array(16);return e.translate(c,t,u),c}},{key:"saveTileTexture",value:function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}},{key:"getTileTexture",value:function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null}},{key:"isPatternMissing",value:function(e){return null===e||void 0!==e&&!this.imageManager.getPattern(e.toString())}},{key:"terrainRenderModeElevated",value:function(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}},{key:"currentGlobalDefines",value:function(){var e=this.terrain&&this.terrain.renderingToTexture,t=this.terrain&&0===this.terrain.exaggeration(),n=this.style&&this.style.fog,i=[];return this.terrainRenderModeElevated()&&i.push("TERRAIN"),"globe"===this.transform.projection.name&&i.push("GLOBE"),t&&i.push("ZERO_EXAGGERATION"),n&&!e&&0!==n.getOpacity(this.transform.pitch)&&i.push("FOG"),e&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}},{key:"useProgram",value:function(e,t,n){this.cache=this.cache||{};var i=n||[],r=this.currentGlobalDefines().concat(i),a=An.cacheKey(un[e],e,r,t);return this.cache[a]||(this.cache[a]=new An(this.context,e,un[e],t,ai[e],r)),this.cache[a]}},{key:"setCustomLayerDefaults",value:function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}},{key:"setBaseState",value:function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}},{key:"initDebugOverlayCanvas",value:function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}},{key:"destroy",value:function(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}},{key:"prepareDrawTile",value:function(){this.terrain&&this.terrain.prepareDrawTile()}},{key:"prepareDrawProgram",value:function(t,n,i){if(!this.terrain||!this.terrain.renderingToTexture){var r=this.style.fog;if(r){var a=r.getOpacity(this.transform.pitch),o=function(t,n,i,r,a,o,s,l,u,c,h){var d=t.transform,f=n.properties.get("color").toArray01();f[3]=r;var p=t.frameCounter/1e3%1;return{u_fog_matrix:i?d.calculateFogTileMatrix(i):t.identityMat,u_fog_range:n.getFovAdjustedRange(d._fov),u_fog_color:f,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_temporal_offset:p,u_frustum_tl:a,u_frustum_tr:o,u_frustum_br:s,u_frustum_bl:l,u_globe_pos:u,u_globe_radius:c,u_viewport:h,u_globe_transition:e.globeToMercatorTransition(d.zoom),u_is_globe:+("globe"===d.projection.name)}}(this,r,i,a,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);n.setFogUniformValues(t,o)}}}},{key:"setTileLoadedFlag",value:function(e){this.tileLoaded=e}},{key:"saveCanvasCopy",value:function(){var e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}},{key:"canvasCopy",value:function(){var e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}},{key:"getCanvasCopiesAndTimestamps",value:function(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}},{key:"averageElevationNeedsEasing",value:function(){if(!this.transform._elevation)return!1;var e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}},{key:"getBackgroundTiles",value:function(){var t,n=this._backgroundTiles,i=this._backgroundTiles={},r=_createForOfIteratorHelper(this.transform.coveringTiles({tileSize:512}));try{for(r.s();!(t=r.n()).done;){var a=t.value;i[a.key]=n[a.key]||new e.Tile(a,512,this.transform.tileZoom,this)}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"clearBackgroundTiles",value:function(){this._backgroundTiles={}}}]),t}(),Oi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(_classCallCheck(this,t),isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=i,this.right=r}return _createClass(t,[{key:"interpolate",value:function(t,n,i){return null!=n.top&&null!=t.top&&(this.top=e.number(t.top,n.top,i)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,n.bottom,i)),null!=n.left&&null!=t.left&&(this.left=e.number(t.left,n.left,i)),null!=n.right&&null!=t.right&&(this.right=e.number(t.right,n.right,i)),this}},{key:"getCenter",value:function(t,n){var i=e.clamp((this.left+t-this.right)/2,0,t),r=e.clamp((this.top+n-this.bottom)/2,0,n);return new e.Point(i,r)}},{key:"equals",value:function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}},{key:"clone",value:function(){return new t(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),t}();function Ni(t,n){var i=e.getColumn(t,3);e.fromQuat(t,n),e.setColumn(t,3,i)}function Di(t,n){var i=e.identity$1([]);return e.rotateZ$1(i,i,-n),e.rotateX$1(i,i,-t),i}function zi(t,n){var i=[t[0],t[1],0],r=[n[0],n[1],0];if(e.length(i)>=1e-15){var a=e.normalize([],i);e.scale$2(r,a,e.dot(r,a)),n[0]=r[0],n[1]=r[1]}var o=e.cross([],n,t);if(e.len(o)<1e-15)return null;var s=Math.atan2(-o[1],o[0]);return Di(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}var Li=function(){function t(e,n){_classCallCheck(this,t),this.position=e,this.orientation=n}return _createClass(t,[{key:"position",get:function(){return this._position},set:function(t){if(t){var n=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(n.x=e.wrap(n.x,0,1)),this._position=n}else this._position=null}},{key:"lookAtPoint",value:function(t,n){if(this.orientation=null,this.position){var i=this.position,r=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,a=e.MercatorCoordinate.fromLngLat(t,r),o=[a.x-i.x,a.y-i.y,a.z-i.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=zi(o,n)}}},{key:"setPitchBearing",value:function(t,n){this.orientation=Di(e.degToRad(t),e.degToRad(-n))}}]),t}(),Bi=function(){function t(n,i){_classCallCheck(this,t),this._transform=e.identity([]),this.orientation=i,this.position=n}return _createClass(t,[{key:"mercatorPosition",get:function(){var t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}},{key:"position",get:function(){var t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]},set:function(t){var n;t&&e.setColumn(this._transform,3,[(n=t)[0],n[1],n[2],1])}},{key:"orientation",get:function(){return this._orientation},set:function(t){this._orientation=t||e.identity$1([]),t&&Ni(this._transform,this._orientation)}},{key:"getPitchBearing",value:function(){var e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}},{key:"setPitchBearing",value:function(e,t){this._orientation=Di(e,t),Ni(this._transform,this._orientation)}},{key:"forward",value:function(){var t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}},{key:"up",value:function(){var t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}},{key:"right",value:function(){var t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}},{key:"getCameraToWorld",value:function(t,n){var i=new Float64Array(16);return e.invert(i,this.getWorldToCamera(t,n)),i}},{key:"getWorldToCameraPosition",value:function(t,n,i){var r=this.position;e.scale$2(r,r,-t);var a=new Float64Array(16);return e.fromScaling(a,[i,i,i]),e.translate(a,a,r),a[10]*=n,a}},{key:"getWorldToCamera",value:function(t,n){var i=new Float64Array(16),r=new Float64Array(4),a=this.position;return e.conjugate(r,this._orientation),e.scale$2(a,a,-t),e.fromQuat(i,r),e.translate(i,i,a),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}},{key:"getCameraToClipPerspective",value:function(t,n,i,r){var a=new Float64Array(16);return e.perspective(a,t,n,i,r),a}},{key:"getDistanceToElevation",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0===t?0:e.mercatorZfromAltitude(t,n?e.latFromMercatorY(this.position[1]):this.position[1]),r=this.forward();return(i-this.position[2])/r[2]}},{key:"clone",value:function(){return new t(_toConsumableArray(this.position),_toConsumableArray(this.orientation))}}]),t}();function Fi(t,n){var i=Hi(t.projection,t.zoom,t.width,t.height),r=function(t,n,i,r,a){var o=new e.LngLat(i.lng-180*Vi,i.lat),s=new e.LngLat(i.lng+180*Vi,i.lat),l=t.project(o.lng,o.lat),u=t.project(s.lng,s.lat),c=-Math.atan2(u.y-l.y,u.x-l.x),h=e.MercatorCoordinate.fromLngLat(i);h.y=e.clamp(h.y,-1+Vi,1-Vi);var d=h.toLngLat(),f=t.project(d.lng,d.lat),p=e.MercatorCoordinate.fromLngLat(d);p.x+=Vi;var m=p.toLngLat(),v=t.project(m.lng,m.lat),g=qi(v.x-f.x,v.y-f.y,c),y=e.MercatorCoordinate.fromLngLat(d);y.y+=Vi;var _=y.toLngLat(),x=t.project(_.lng,_.lat),b=qi(x.x-f.x,x.y-f.y,c),w=Math.abs(g.x)/Math.abs(b.y),k=e.identity([]);e.rotateZ(k,k,-c*(1-(a?0:r)));var C=e.identity([]);return e.scale(C,C,[1,1-(1-w)*r,1]),C[4]=-b.x/b.y*r,e.rotateZ(C,C,c),e.multiply(C,k,C),C}(t.projection,0,t.center,i,n),a=ji(t);return e.scale(r,r,[a,a,1]),r}function ji(t){var n=t.projection,i=Hi(t.projection,t.zoom,t.width,t.height),r=Ui(n,t.center),a=Ui(n,e.LngLat.convert(n.center));return Math.pow(2,r*i+(1-i)*a)}function Hi(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=t.range;if(!o)return 0;var s=Math.min(a,Math.max(i,r)),l=Math.log(s/1024)/Math.LN2;return e.smoothstep(o[0]+l,o[1]+l,n)}var Vi=1/4e4;function Ui(t,n){var i=e.clamp(n.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),r=new e.LngLat(n.lng-180*Vi,i),a=new e.LngLat(n.lng+180*Vi,i),o=t.project(r.lng,i),s=t.project(a.lng,i),l=e.MercatorCoordinate.fromLngLat(r),u=e.MercatorCoordinate.fromLngLat(a),c=s.x-o.x,h=s.y-o.y,d=u.x-l.x,f=u.y-l.y,p=Math.sqrt((d*d+f*f)/(c*c+h*h));return Math.log(p)/Math.LN2}function qi(e,t,n){var i=Math.cos(n),r=Math.sin(n);return{x:e*i-t*r,y:e*r+t*i}}var Gi=function(){function n(t,i,r,a,o,s,l){_classCallCheck(this,n),this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=null==r?0:r,this._maxPitch=null==a?60:a,this.setProjection(s),this.setMaxBounds(l),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Oi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Bi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}return _createClass(n,[{key:"clone",value:function(){var e=new n(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}},{key:"elevation",get:function(){return this._elevation},set:function(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}},{key:"updateElevation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(e||n)&&this._constrainCamera(t),this._calcMatrices()}},{key:"getProjection",value:function(){return e.pick(this.projection,["name","center","parallels"])}},{key:"setProjection",value:function(n){this.projectionOptions=n||{name:"mercator"};var i=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);var r=!t(i,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}},{key:"setMercatorFromTransition",value:function(){var t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.getProjection({name:"mercator"});var n=t!==this.projection.name;return n&&this._calcMatrices(),n}},{key:"minZoom",get:function(){return this._minZoom},set:function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}},{key:"minPitch",get:function(){return this._minPitch},set:function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies},set:function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"cameraWorldSizeForFog",get:function(){var e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}},{key:"cameraWorldSize",get:function(){var e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}},{key:"pixelsPerMeter",get:function(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}},{key:"cameraPixelsPerMeter",get:function(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new e.Point(this.width,this.height)}},{key:"bearing",get:function(){return e.wrap(this.rotation,-180,180)},set:function(e){this.rotation=e}},{key:"rotation",get:function(){return-this.angle/Math.PI*180},set:function(t){var n,i=-t*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=(n=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);e[0]=i*l+a*s,e[1]=r*l+o*s,e[2]=i*-s+a*l,e[3]=r*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var n=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}},{key:"aspect",get:function(){return this.width/this.height}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.degToRad(t),this._calcMatrices())}},{key:"fovX",get:function(){return this._fov}},{key:"fovY",get:function(){var e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}},{key:"averageElevation",get:function(){return this._averageElevation},set:function(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}},{key:"zoom",get:function(){return this._zoom},set:function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}},{key:"_setZoom",value:function(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}},{key:"_updateCameraOnTerrain",value:function(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);var e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}},{key:"_updateSeaLevelZoom",value:function(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}},{key:"sampleAverageElevation",value:function(){if(!this._elevation)return 0;for(var t=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop(),r=0,a=0,o=0;o<n.length;o++){var s=new e.Point(n[o][0]*this.width,i+n[o][1]*(this.height-i)),l=t.pointCoordinate(s);if(l){var u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*u,a+=u}}return 0===a?NaN:r/a}},{key:"center",get:function(){return this._center},set:function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}},{key:"_updateZoomFromElevation",value:function(){if(null!=this._seaLevelZoom&&this._elevation){var e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*t,i=this._mercatorZfromZoom(e),r=this._mercatorZfromZoom(this._maxZoom),a=Math.max(i-n,r);this._setZoom(this._zoomFromMercatorZ(a))}}},{key:"padding",get:function(){return this._edgeInsets.toJSON()},set:function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}},{key:"computeZoomRelativeTo",value:function(t){var n,i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));n=t.z<this._camera.position[2]?[i.x,i.y,i.z]:[t.x,t.y,t.z];var r=e.length(e.sub([],this._camera.position,n));return e.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}},{key:"setFreeCameraOptions",value:function(t){if(this.height&&(t.position||t.orientation)){this._updateCameraState();var n=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(t.orientation)),t.position){var i=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}}},{key:"getFreeCameraOptions",value:function(){this._updateCameraState();var t=this._camera.position,n=new Li;return n.position=new e.MercatorCoordinate(t[0],t[1],t[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}},{key:"_setCameraOrientation",value:function(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);var n=e.transformQuat([],[0,0,-1],t),i=e.transformQuat([],[0,-1,0],t);if(i[2]<0)return!1;var r=zi(n,i);return!!r&&(this._camera.orientation=r,!0)}},{key:"_setCameraPosition",value:function(t){var n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;t[2]=e.clamp(t[2],r/i,r/n),this._camera.position=t}},{key:"centerPoint",get:function(){return this._edgeInsets.getCenter(this.width,this.height)}},{key:"fovAboveCenter",get:function(){return this._fov*(.5+this.centerOffset.y/this.height)}},{key:"isPaddingEqual",value:function(e){return this._edgeInsets.equals(e)}},{key:"interpolatePadding",value:function(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}},{key:"coveringZoomLevel",value:function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}},{key:"getVisibleUnwrappedCoordinates",value:function(t){var n=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies)for(var i=this.pointCoordinate(new e.Point(0,0)),r=this.pointCoordinate(new e.Point(this.width,0)),a=this.pointCoordinate(new e.Point(this.width,this.height)),o=this.pointCoordinate(new e.Point(0,this.height)),s=Math.floor(Math.min(i.x,r.x,a.x,o.x)),l=Math.floor(Math.max(i.x,r.x,a.x,o.x)),u=s-1;u<=l+1;u++)0!==u&&n.push(new e.UnwrappedTileID(u,t));return n}},{key:"coveringTiles",value:function(t){var n=this,i=this.coveringZoomLevel(t),r=i,a=this.elevation&&!t.isTerrainDEM,o="mercator"===this.projection.name;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);var s=this.locationCoordinate(this.center),l=this.center.lat,u=1<<i,c=[u*s.x,u*s.y,0],h="globe"===this.projection.name,d=!h,f=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,d),p=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=u*e.mercatorZfromAltitude(1,this.center.lat),v=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),g=[u*p.x,u*p.y,v*(d?1:m)],y=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),_=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?i:0,x=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,b=t.isTerrainDEM?-x:this._elevation?this._elevation.getMinElevationBelowMSL():0,w=this.projection.isReprojectedInTileSpace?ji(this):1,k=function(t){var i=x,r=b;return{aabb:e.tileAABB(n,u,0,0,0,t,r,i,n.projection),zoom:0,x:0,y:0,minZ:r,maxZ:i,wrap:t,fullyVisible:!1}},C=[],S=[],T=i,E=t.reparseOverscaled?r:i,P=function(e){return e*e},M=P((v-this._centerAltitude)*m),I=function(e){if(n._elevation&&e.tileID&&o){var t=n._elevation.getMinMaxForTile(e.tileID),i=e.aabb;t?(i.min[2]=t.min,i.max[2]=t.max,i.center[2]=(i.min[2]+i.max[2])/2):(e.shouldSplit=A(e),e.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=n._centerAltitude))}},A=function(t){if(t.zoom<_)return!0;if(t.zoom===T)return!1;if(null!=t.shouldSplit)return t.shouldSplit;var i=t.aabb.distanceX(g),o=t.aabb.distanceY(g),s=M,u=1;if(h){s=P(t.aabb.distanceZ(g));var c=Math.pow(2,t.zoom),d=e.latFromMercatorY((t.y+1)/c),f=e.latFromMercatorY(t.y/c),p=Math.min(Math.max(l,d),f),v=e.circumferenceAtLatitude(p)/e.circumferenceAtLatitude(l);if(u=p===l?1/Math.max(1,n._mercatorScaleRatio-.3):Math.min(1,v/n._mercatorScaleRatio),n.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===T-1&&v>=.9)return!0}else if(a&&(s=P(t.aabb.distanceZ(g)*m)),n.projection.isReprojectedInTileSpace&&r<=5){var x=Math.pow(2,t.zoom),b=function(t){var i=1/4e4,r=new e.MercatorCoordinate(t.x+i,t.y,t.z),a=new e.MercatorCoordinate(t.x,t.y+i,t.z),o=t.toLngLat(),s=r.toLngLat(),l=a.toLngLat(),u=n.locationCoordinate(o),c=n.locationCoordinate(s),h=n.locationCoordinate(l),d=Math.hypot(c.x-u.x,c.y-u.y),f=Math.hypot(h.x-u.x,h.y-u.y);return Math.sqrt(d*f)*w/i}(new e.MercatorCoordinate((t.x+.5)/x,(t.y+.5)/x));u=b>.85?1:b}var k=i*i+o*o+s;return k<P((1<<T-t.zoom)*y*u*function(e,t){if(t*P(.707)<e)return 1;var n=Math.sqrt(t/e);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)}(Math.max(s,M),k))};if(this.renderWorldCopies)for(var R=1;R<=3;R++)C.push(k(-R)),C.push(k(R));for(C.push(k(0));C.length>0;){var O=C.pop(),N=O.x,D=O.y,z=O.fullyVisible;if(!z){var L=O.aabb.intersects(f);if(0===L)continue;z=2===L}if(O.zoom!==T&&A(O))for(var B=0;B<4;B++){var F=(N<<1)+B%2,j=(D<<1)+(B>>1),H={aabb:o?O.aabb.quadrant(B):e.tileAABB(this,u,O.zoom+1,F,j,O.wrap,O.minZ,O.maxZ,this.projection),zoom:O.zoom+1,x:F,y:j,wrap:O.wrap,fullyVisible:z,tileID:void 0,shouldSplit:void 0,minZ:O.minZ,maxZ:O.maxZ};a&&!h&&(H.tileID=new e.OverscaledTileID(O.zoom+1===T?E:O.zoom+1,O.wrap,O.zoom+1,F,j),I(H)),C.push(H)}else{var V=O.zoom===T?E:O.zoom;if(t.minzoom&&t.minzoom>V)continue;var U=c[0]-(.5+N+(O.wrap<<O.zoom))*(1<<i-O.zoom),q=c[1]-.5-D,G=O.tileID?O.tileID:new e.OverscaledTileID(V,O.wrap,O.zoom,N,D);S.push({tileID:G,distanceSq:U*U+q*q})}}if(this.fogCullDistSq){var W=this.fogCullDistSq,Z=this.horizonLineFromTop();S=S.filter((function(i){var r=[0,0,0,1],a=[e.EXTENT,e.EXTENT,0,1],o=n.calculateFogTileMatrix(i.tileID.toUnwrapped());e.transformMat4$1(r,r,o),e.transformMat4$1(a,a,o);var s=e.getAABBPointSquareDist(r,a);if(0===s)return!0;var l=!1,u=n._elevation;if(u&&s>W&&0!==Z){var c,h=n.calculateProjMatrix(i.tileID.toUnwrapped());t.isTerrainDEM||(c=u.getMinMaxForTile(i.tileID)),c||(c={min:b,max:x});var d=e.furthestTileCorner(n.rotation),f=[d[0]*e.EXTENT,d[1]*e.EXTENT,c.max];e.transformMat4(f,f,h),l=(1-f[1])*n.height*.5<Z}return s<W||l}))}return S.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}},{key:"unmodified",get:function(){return this._unmodified}},{key:"zoomScale",value:function(e){return Math.pow(2,e)}},{key:"scaleZoom",value:function(e){return Math.log(e)/Math.LN2}},{key:"project",value:function(t){var n=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),i=this.projection.project(t.lng,n);return new e.Point(i.x*this.worldSize,i.y*this.worldSize)}},{key:"unproject",value:function(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}},{key:"point",get:function(){return this.project(this.center)}},{key:"pointMerc",get:function(){return this.point._div(this.worldSize)}},{key:"pixelsPerMeterRatio",get:function(){return this.pixelsPerMeter/e.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}},{key:"setLocationAtPoint",value:function(t,n){var i,r,a=this.centerPoint;if("globe"===this.projection.name){var o=this.worldSize;i=(n.x-a.x)/o,r=(n.y-a.y)/o}else{var s=this.pointCoordinate(n),l=this.pointCoordinate(a);i=s.x-l.x,r=s.y-l.y}var u=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(u.x-i,u.y-r))}},{key:"setLocation",value:function(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}},{key:"locationPoint",value:function(e){return this.projection.locationPoint(this,e)}},{key:"locationPoint3D",value:function(e){return this.projection.locationPoint(this,e,!0)}},{key:"pointLocation",value:function(e){return this.coordinateLocation(this.pointCoordinate(e))}},{key:"pointLocation3D",value:function(e){return this.coordinateLocation(this.pointCoordinate3D(e))}},{key:"locationCoordinate",value:function(t,n){var i=n?e.mercatorZfromAltitude(n,t.lat):void 0,r=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(r.x,r.y,i)}},{key:"coordinateLocation",value:function(e){return this.projection.unproject(e.x,e.y)}},{key:"pointRayIntersection",value:function(t,n){var i=null!=n?n:this._centerAltitude,r=[t.x,t.y,0,1],a=[t.x,t.y,1,1];e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(a,a,this.pixelMatrixInverse);var o=a[3];e.scale$1(r,r,1/r[3]),e.scale$1(a,a,1/o);var s=r[2],l=a[2];return{p0:r,p1:a,t:s===l?0:(i-s)/(l-s)}}},{key:"screenPointToMercatorRay",value:function(t){var n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];return e.transformMat4$1(n,n,this.pixelMatrixInverse),e.transformMat4$1(i,i,this.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),e.scale$1(i,i,1/i[3]),n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,i[2]=e.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,e.scale$1(n,n,1/this.worldSize),e.scale$1(i,i,1/this.worldSize),new e.Ray([n[0],n[1],n[2]],e.normalize([],e.sub([],i,n)))}},{key:"rayIntersectionCoordinate",value:function(t){var n=t.p0,i=t.p1,r=t.t,a=e.mercatorZfromAltitude(n[2],this._center.lat),o=e.mercatorZfromAltitude(i[2],this._center.lat);return new e.MercatorCoordinate(e.number(n[0],i[0],r)/this.worldSize,e.number(n[1],i[1],r)/this.worldSize,e.number(a,o,r))}},{key:"pointCoordinate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,e.x,e.y,t)}},{key:"pointCoordinate3D",value:function(t){if(!this.elevation)return this.pointCoordinate(t);var n=this.projection.pointCoordinate3D(this,t.x,t.y);if(n)return new e.MercatorCoordinate(n[0],n[1],n[2]);var i=0,r=this.horizonLineFromTop();if(t.y>r)return this.pointCoordinate(t);for(var a=.02*r,o=t.clone(),s=0;s<10&&r-i>a;s++){o.y=e.number(i,r,.66);var l=this.projection.pointCoordinate3D(this,o.x,o.y);l?(r=o.y,n=l):i=o.y}return n?new e.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(t)}},{key:"isPointAboveHorizon",value:function(e){return this.projection.isPointAboveHorizon(this,e)}},{key:"isPointOnSurface",value:function(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(t);var n=this.pointCoordinate(t);return n.y>=0&&n.y<=1}},{key:"_coordinatePoint",value:function(t,n){var i=n&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,r=[t.x*this.worldSize,t.y*this.worldSize,i+t.toAltitude(),1];return e.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new e.Point(r[0]/r[3],r[1]/r[3]):new e.Point(Number.MAX_VALUE,Number.MAX_VALUE)}},{key:"_getBoundsNonRectangular",value:function(){var t=this,n=this._edgeInsets,i=n.top,r=n.left,a=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,s=this.pointLocation3D(new e.Point(r,i)),l=this.pointLocation3D(new e.Point(o,i)),u=this.pointLocation3D(new e.Point(o,a)),c=this.pointLocation3D(new e.Point(r,a)),h=Math.min(s.lng,l.lng,u.lng,c.lng),d=Math.max(s.lng,l.lng,u.lng,c.lng),f=Math.min(s.lat,l.lat,u.lat,c.lat),p=Math.max(s.lat,l.lat,u.lat,c.lat),m=Math.pow(2,-this.zoom)/16*270,v="globe"===this.projection.name?1:4,g=function n(i,r,a,o,s){var l=(i+a)/2,u=(r+o)/2,c=new e.Point(l,u),g=t.pointLocation3D(c),y=g.lng,_=g.lat,x=Math.max(0,h-y,f-_,y-d,_-p);h=Math.min(h,y),d=Math.max(d,y),f=Math.min(f,_),p=Math.max(p,_),(s<v||x>m)&&(n(i,r,l,u,s+1),n(l,u,a,o,s+1))};if(g(r,i,o,i,1),g(o,i,o,a,1),g(o,a,r,a,1),g(r,a,r,i,1),"globe"===this.projection.name){var y=_slicedToArray(e.polesInViewport(this),2),_=y[0],x=y[1];_?(p=90,d=180,h=-180):x&&(f=-90,d=180,h=-180)}return new e.LngLatBounds(new e.LngLat(h,f),new e.LngLat(d,p))}},{key:"_getBoundsRectangular",value:function(t,n){var i=this._edgeInsets,r=i.top,a=i.left,o=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,l=new e.Point(a,r),u=new e.Point(s,r),c=new e.Point(s,o),h=new e.Point(a,o),d=this.pointCoordinate(l,t),f=this.pointCoordinate(u,t),p=this.pointCoordinate(c,n),m=this.pointCoordinate(h,n),v=function(e,t){return(t.y-e.y)/(t.x-e.x)};return d.y>1&&f.y>=0?d=new e.MercatorCoordinate((1-m.y)/v(m,d)+m.x,1):d.y<0&&f.y<=1&&(d=new e.MercatorCoordinate(-m.y/v(m,d)+m.x,0)),f.y>1&&d.y>=0?f=new e.MercatorCoordinate((1-p.y)/v(p,f)+p.x,1):f.y<0&&d.y<=1&&(f=new e.MercatorCoordinate(-p.y/v(p,f)+p.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(m)).extend(this.coordinateLocation(p))}},{key:"_getBoundsRectangularTerrain",value:function(){var e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);var t=e.visibleDemTiles.reduce((function(e,t){if(t.dem){var n=t.dem.tree;e.min=Math.min(e.min,n.minimums[0]),e.max=Math.max(e.max,n.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}},{key:"getBounds",value:function(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}},{key:"horizonLineFromTop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,n):n}},{key:"getMaxBounds",value:function(){return this.maxBounds}},{key:"setMaxBounds",value:function(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}},{key:"calculatePosMatrix",value:function(e,t){return this.projection.createTileMatrix(this,t,e)}},{key:"calculateDistanceTileData",value:function(t){var n=t.key,i=this._distanceTileDataCache;if(i[n])return i[n];var r=t.canonical,a=1/this.height,o=this.cameraWorldSize,s=o/this.zoomScale(r.z),l=(r.x+Math.pow(2,r.z)*t.wrap)*s,u=r.y*s,c=this.point;c.x*=o/this.worldSize,c.y*=o/this.worldSize;var h=this.angle,d=Math.sin(-h),f=-Math.cos(-h);return i[n]={bearing:[d,f],center:[(c.x-l)*a,(c.y-u)*a],scale:s/e.EXTENT*a},i[n]}},{key:"calculateFogTileMatrix",value:function(t){var n=t.key,i=this._fogTileMatrixCache;if(i[n])return i[n];var r=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.multiply(r,this.worldToFogMatrix,r),i[n]=new Float32Array(r),i[n]}},{key:"calculateProjMatrix",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.key,r=n?this._alignedProjMatrixCache:this._projMatrixCache;if(r[i])return r[i];var a=this.calculatePosMatrix(t,this.worldSize);return e.multiply(a,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:n?this.alignedProjMatrix:this.projMatrix,a),r[i]=new Float32Array(a),r[i]}},{key:"calculatePixelsToTileUnitsMatrix",value:function(t){var n=t.tileID.key,i=this._pixelsToTileUnitsCache;if(i[n])return i[n];var r=function(t,n){var i,r,a,o,s,l,u,c,h=t.tileTransform.scale*e.EXTENT/(t.tileSize*Math.pow(2,n.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return i=new Float32Array(4),o=(r=n.inverseAdjustmentMatrix)[1],s=r[2],l=r[3],c=(a=[h,h])[1],i[0]=r[0]*(u=a[0]),i[1]=o*u,i[2]=s*c,i[3]=l*c,i}(t,this);return i[n]=r,i[n]}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"globeToMercatorMatrix",value:function(){if("globe"===this.projection.name){var t=1/this.worldSize,n=e.fromScaling([],[t,t,t]);return e.multiply(n,n,this.globeMatrix),n}}},{key:"recenterOnTerrain",value:function(){if(this._elevation&&"globe"!==this.projection.name){var t=this._elevation;this._updateCameraState();var n=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(n),r=this._camera.forward(),a=e.mercatorZfromAltitude(1,this._center.lat);i[2]/=a,r[2]/=a,e.normalize(r,r);var o=t.raycast(i,r,t.exaggeration());if(o){var s=e.scaleAndAdd([],i,r,o),l=new e.MercatorCoordinate(s[0],s[1],e.mercatorZfromAltitude(s[2],e.latFromMercatorY(s[1]))),u=(l.z+e.length([l.x-i[0],l.y-i[1],l.z-i[2]*a]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(u),this._centerAltitude=l.toAltitude(),this._center=this.coordinateLocation(l),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}}},{key:"_constrainCamera",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._elevation){var n=this._elevation,i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(i),a=n.getAtPointOrZero(_construct2(e.MercatorCoordinate,_toConsumableArray(r))),o=this.pixelsPerMeter/this.worldSize*a,s=this._minimumHeightOverTerrain(),l=r[2]-o;if(l<=s)if(l<0||t){var u=this.locationCoordinate(this._center,this._centerAltitude),c=[r[0],r[1],u.z-r[2]],h=e.length(c);c[2]-=(s-l)/this._pixelsPerMercatorPixel;var d=e.length(c);if(0===d)return;e.scale$2(c,c,h/d*this._pixelsPerMercatorPixel),this._camera.position=[r[0],r[1],u.z*this._pixelsPerMercatorPixel-c[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}}},{key:"_constrain",value:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){var n=this.center;return n.lat=e.clamp(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(n.lng=e.clamp(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}var i=this._unmodified,r=this.point,a=r.x,o=r.y,s=0,l=a,u=o,c=this.width/2,h=this.height/2,d=this.worldMinY*this.scale,f=this.worldMaxY*this.scale;if(o-h<d&&(u=d+h),o+h>f&&(u=f-h),f-d<this.height&&(s=Math.max(s,this.height/(f-d)),u=(f+d)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){var p=this.worldMinX*this.scale,m=this.worldMaxX*this.scale,v=this.worldSize/2-(p+m)/2;(l=(a+v+this.worldSize)%this.worldSize-v)-c<p&&(l=p+c),l+c>m&&(l=m-c),m-p<this.width&&(s=Math.max(s,this.width/(m-p)),l=(m+p)/2)}l===a&&u===o||(this.center=this.unproject(new e.Point(l,u))),s&&(this.zoom+=this.scaleZoom(s)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}}},{key:"_minZoomForBounds",value:function(){var e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}},{key:"_maxCameraBoundsDistance",value:function(){return this._mercatorZfromZoom(this._minZoomForBounds())}},{key:"_calcMatrices",value:function(){if(this.height){var t=this.centerOffset,n=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.mercatorZfromAltitude(1,this.center.lat)/e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE));var i=Hi(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,i),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;var r="meters"===this.projection.zAxisUnit?n:1,a=this._camera.getWorldToCamera(this.worldSize,r),o=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);o[8]=2*-t.x/this.width,o[9]=2*t.y/this.height;var s=e.mul([],o,a);if(this.projection.isReprojectedInTileSpace){var l=this.locationCoordinate(this.center),u=e.identity([]);e.translate(u,u,[l.x*this.worldSize,l.y*this.worldSize,0]),e.multiply(u,u,Fi(this)),e.translate(u,u,[-l.x*this.worldSize,-l.y*this.worldSize,0]),e.multiply(s,s,u),this.inverseAdjustmentMatrix=function(e){var t=Fi(e,!0);return y([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],s,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=s,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);var c=e.invert([],o);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(c,this.horizonLineFromTop(),this.height);var h=new Float32Array(16);e.identity(h),e.scale(h,h,[1,-1,1]),e.rotateX(h,h,this._pitch),e.rotateZ(h,h,this.angle);var d=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;d[8]=2*-t.x/this.width,d[9]=2*(t.y+f)/this.height,this.skyboxMatrix=e.multiply(h,d,h);var p=this.point,m=p.x,v=p.y,g=this.width%2/2,_=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),w=m-Math.round(m)+x*g+b*_,k=v-Math.round(v)+x*_+b*g,C=new Float64Array(s);if(e.translate(C,C,[w>.5?w-1:w,k>.5?k-1:k,0]),this.alignedProjMatrix=C,s=e.create(),e.scale(s,s,[this.width/2,-this.height/2,1]),e.translate(s,s,[1,-1,0]),this.labelPlaneMatrix=s,s=e.create(),e.scale(s,s,[1,-1,1]),e.translate(s,s,[-1,-1,0]),e.scale(s,s,[2/this.width,2/this.height,1]),this.glCoordMatrix=s,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},!(s=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=s,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);var S=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(S,S,a),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=s;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}}},{key:"_calcFogMatrices",value:function(){this._fogTileMatrixCache={};var t=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,i=this._camera.position,r=1/this.height/this._pixelsPerMercatorPixel,a=[t,t,n];e.scale$2(a,a,r),e.scale$2(i,i,-1),e.multiply$2(i,i,a);var o=e.create();e.translate(o,o,i),e.scale(o,o,a),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,n,r)}},{key:"_computeCameraPosition",value:function(e){var t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),i=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[i.x/this.worldSize-n[0]*r,i.y/this.worldSize-n[1]*r,e/this.worldSize*this._centerAltitude-n[2]*r]}},{key:"_updateCameraState",value:function(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}},{key:"_translateCameraConstrained",value:function(t){var n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],r=t[2],a=1;this.projection.wrap&&(this.center=this.center.wrap()),r>0&&(a=Math.min((n-i)/r,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,a),this._updateStateFromCamera()}},{key:"_updateStateFromCamera",value:function(){var t=this._camera.position,n=this._camera.forward(),i=this._camera.getPitchBearing(),r=i.pitch,a=i.bearing,o=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),l=Math.max((t[2]-o)/Math.cos(r),s),u=this._zoomFromMercatorZ(l);e.scaleAndAdd(t,t,n,l),this._pitch=e.clamp(r,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(a,-Math.PI,Math.PI),this._setZoom(e.clamp(u,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}},{key:"_worldSizeFromZoom",value:function(e){return Math.pow(2,e)*this.tileSize}},{key:"_mercatorZfromZoom",value:function(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}},{key:"_minimumHeightOverTerrain",value:function(){var e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}},{key:"_zoomFromMercatorZ",value:function(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}},{key:"zoomFromMercatorZAdjusted",value:function(t){for(var n=0,i=e.GLOBE_ZOOM_THRESHOLD_MAX,r=0,a=1/0;i-n>1e-6&&i>n;){var o=n+.5*(i-n),s=this.tileSize*Math.pow(2,o),l=this.getCameraToCenterDistance(this.projection,o,s),u=this.scaleZoom(l/(t*this.tileSize)),c=Math.abs(o-u);c<a&&(a=c,r=o),o<u?n=o:i=o}return r}},{key:"_terrainEnabled",value:function(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}},{key:"anyCornerOffEdge",value:function(t,n){var i=Math.min(t.x,n.x),r=Math.max(t.x,n.x),a=Math.min(t.y,n.y),o=Math.max(t.y,n.y);if(a<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;for(var s=[new e.Point(i,a),new e.Point(r,o),new e.Point(i,o),new e.Point(r,a)],l=this.renderWorldCopies?-3:0,u=this.renderWorldCopies?4:1,c=0,h=s;c<h.length;c++){var d=h[c],f=this.pointRayIntersection(d);if(f.t<0)return!0;var p=this.rayIntersectionCoordinate(f);if(p.x<l||p.y<0||p.x>u||p.y>1)return!0}return!1}},{key:"isHorizonVisible",value:function(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.Point(0,0),new e.Point(this.width,this.height))}},{key:"zoomDeltaToMovement",value:function(t,n){var i=e.length(e.sub([],this._camera.position,t)),r=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(r)}},{key:"getCameraPoint",value:function(){if("globe"===this.projection.name){var t=function(t,n){var i=_slicedToArray(t,3),r=[i[0],i[1],i[2],1];e.transformMat4$1(r,r,n);var a=r[3]=Math.max(r[3],1e-6);return r[0]/=a,r[1]/=a,r[2]/=a,r}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.Point(t[0],t[1])}var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,n))}},{key:"getCameraToCenterDistance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize,i=Hi(e,t,this.width,this.height,1024),r=e.pixelSpaceConversion(this.center.lat,n,i);return.5/Math.tan(.5*this._fov)*this.height*r}},{key:"getWorldToCameraMatrix",value:function(){var t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.multiply(t,t,this.globeMatrix),t}}]),n}();function Wi(e,t){var n=!1,i=null;return function(){return n=!0,i||function r(){i=null,n&&(e(),i=setTimeout(r,t),n=!1)}(),i}}var Zi=function(){function t(n){_classCallCheck(this,t),this._hashName=n&&encodeURIComponent(n),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Wi(this._updateHashUnthrottled.bind(this),300)}return _createClass(t,[{key:"addTo",value:function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}},{key:"remove",value:function(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}},{key:"getHashString",value:function(){var t=this._map;if(!t)return"";var n=Xi(t);if(this._hashName){var i=this._hashName,r=!1,a=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===i?(r=!0,"".concat(t,"=").concat(n)):e})).filter((function(e){return e}));return r||a.push("".concat(i,"=").concat(n)),"#"+a.join("&")}return"#"+n}},{key:"_getCurrentHash",value:function(){var t,n=this,i=e.window.location.hash.replace("#","");return this._hashName?(i.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===n._hashName&&(t=e)})),(t&&t[1]||"").split("/")):i.split("/")}},{key:"_onHashChange",value:function(){var e=this._map;if(!e)return!1;var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(e){return isNaN(e)}))){var n=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:n,pitch:+(t[4]||0)}),!0}return!1}},{key:"_updateHashUnthrottled",value:function(){var t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}]),t}();function Xi(e,t){var n=e.getCenter(),i=Math.round(100*e.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,r),o=Math.round(n.lng*a)/a,s=Math.round(n.lat*a)/a,l=e.getBearing(),u=e.getPitch(),c=t?"/".concat(o,"/").concat(s,"/").concat(i):"".concat(i,"/").concat(s,"/").concat(o);return(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/"+Math.round(u)),c}var Ki={linearity:.3,easing:e.bezier(0,0,.3,1)},Yi=e.extend({deceleration:2500,maxSpeed:1400},Ki),Ji=e.extend({deceleration:20,maxSpeed:1400},Ki),Qi=e.extend({deceleration:1e3,maxSpeed:360},Ki),$i=e.extend({deceleration:1e3,maxSpeed:90},Ki),er=function(){function t(e){_classCallCheck(this,t),this._map=e,this.clear()}return _createClass(t,[{key:"clear",value:function(){this._inertiaBuffer=[]}},{key:"record",value:function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}},{key:"_drainInertiaBuffer",value:function(){for(var t=this._inertiaBuffer,n=e.exported.now();t.length>0&&n-t[0].time>160;)t.shift()}},{key:"_onMoveEnd",value:function(t){if(!(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))){var n,i={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},r=_createForOfIteratorHelper(this._inertiaBuffer);try{for(r.s();!(n=r.n()).done;){var a=n.value.settings;i.zoom+=a.zoomDelta||0,i.bearing+=a.bearingDelta||0,i.pitch+=a.pitchDelta||0,a.panDelta&&i.pan._add(a.panDelta),a.around&&(i.around=a.around),a.pinchAround&&(i.pinchAround=a.pinchAround)}}catch(f){r.e(f)}finally{r.f()}var o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(i.pan.mag()){var l=nr(i.pan.mag(),o,e.extend({},Yi,t||{}));s.offset=i.pan.mult(l.amount/i.pan.mag()),s.center=this._map.transform.center,tr(s,l)}if(i.zoom){var u=nr(i.zoom,o,Ji);s.zoom=this._map.transform.zoom+u.amount,tr(s,u)}if(i.bearing){var c=nr(i.bearing,o,Qi);s.bearing=this._map.transform.bearing+e.clamp(c.amount,-179,179),tr(s,c)}if(i.pitch){var h=nr(i.pitch,o,$i);s.pitch=this._map.transform.pitch+h.amount,tr(s,h)}if(s.zoom||s.bearing){var d=void 0===i.pinchAround?i.around:i.pinchAround;s.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),s.noMoveStart=!0,s}}}]),t}();function tr(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function nr(t,n,i){var r=i.maxSpeed,a=i.linearity,o=i.deceleration,s=e.clamp(t*a/(n/1e3),-r,r),l=Math.abs(s)/(o*a);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}var ir=function(t){function n(t,i,r){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,n);var s=p(i.getCanvasContainer(),r),l=i.unproject(s);return(a=_callSuper(this,n,[t,e.extend({point:s,lngLat:l,originalEvent:r},o)]))._defaultPrevented=!1,a.target=i,a}return _inherits(n,t),_createClass(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),rr=function(t){function n(t,i,r){var a;_classCallCheck(this,n);var o="touchend"===t?r.changedTouches:r.touches,s=m(i.getCanvasContainer(),o),l=s.map((function(e){return i.unproject(e)})),u=s.reduce((function(e,t,n,i){return e.add(t.div(i.length))}),new e.Point(0,0));return(a=_callSuper(this,n,[t,{points:s,point:u,lngLats:l,lngLat:i.unproject(u),originalEvent:r}]))._defaultPrevented=!1,a}return _inherits(n,t),_createClass(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),ar=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,{originalEvent:i}]))._defaultPrevented=!1,r}return _inherits(t,e),_createClass(t,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),t}(e.Event),or=function(){function t(e,n){_classCallCheck(this,t),this._map=e,this._clickTolerance=n.clickTolerance}return _createClass(t,[{key:"reset",value:function(){this._mousedownPos=void 0}},{key:"wheel",value:function(e){return this._firePreventable(new ar(e.type,this._map,e))}},{key:"mousedown",value:function(e,t){return this._mousedownPos=t,this._firePreventable(new ir(e.type,this._map,e))}},{key:"mouseup",value:function(e){this._map.fire(new ir(e.type,this._map,e))}},{key:"preclick",value:function(t){var n=e.extend({},t);n.type="preclick",this._map.fire(new ir(n.type,this._map,n))}},{key:"click",value:function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new ir(e.type,this._map,e)))}},{key:"dblclick",value:function(e){return this._firePreventable(new ir(e.type,this._map,e))}},{key:"mouseover",value:function(e){this._map.fire(new ir(e.type,this._map,e))}},{key:"mouseout",value:function(e){this._map.fire(new ir(e.type,this._map,e))}},{key:"touchstart",value:function(e){return this._firePreventable(new rr(e.type,this._map,e))}},{key:"touchmove",value:function(e){this._map.fire(new rr(e.type,this._map,e))}},{key:"touchend",value:function(e){this._map.fire(new rr(e.type,this._map,e))}},{key:"touchcancel",value:function(e){this._map.fire(new rr(e.type,this._map,e))}},{key:"_firePreventable",value:function(e){if(this._map.fire(e),e.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),t}(),sr=function(){function e(t){_classCallCheck(this,e),this._map=t}return _createClass(e,[{key:"reset",value:function(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}},{key:"mousemove",value:function(e){this._map.fire(new ir(e.type,this._map,e))}},{key:"mousedown",value:function(){this._delayContextMenu=!0}},{key:"mouseup",value:function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ir("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}},{key:"contextmenu",value:function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new ir(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),e}(),lr=function(){function t(e,n){_classCallCheck(this,t),this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}return _createClass(t,[{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active}},{key:"enable",value:function(){this.isEnabled()||(this._enabled=!0)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"mousedown",value:function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(c(),this._startPos=this._lastPos=t,this._active=!0)}},{key:"mousemoveWindow",value:function(e,t){var n=this;if(this._active){var i=t,r=this._startPos,o=this._lastPos;if(!(!r||!o||o.equals(i)||!this._box&&i.dist(r)<this._clickTolerance)){this._lastPos=i,this._box||(this._box=a("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var s=Math.min(r.x,i.x),l=Math.max(r.x,i.x),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y);this._map._requestDomTask((function(){n._box&&(n._box.style.transform="translate(".concat(s,"px,").concat(u,"px)"),n._box.style.width=l-s+"px",n._box.style.height=c-u+"px")}))}}}},{key:"mouseupWindow",value:function(t,n){var i=this;if(this._active){var r=this._startPos,a=n;if(r&&0===t.button){if(this.reset(),f(),r.x!==a.x||r.y!==a.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(r,a,i._map.getBearing(),{linear:!1})}};this._fireEvent("boxzoomcancel",t)}}}},{key:"keydown",value:function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}},{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),h(),delete this._startPos,delete this._lastPos}},{key:"_fireEvent",value:function(t,n){return this._map.fire(new e.Event(t,{originalEvent:n}))}}]),t}();function ur(e,t){for(var n={},i=0;i<e.length;i++)n[e[i].identifier]=t[i];return n}var cr=function(){function t(e){_classCallCheck(this,t),this.reset(),this.numTouches=e.numTouches}return _createClass(t,[{key:"reset",value:function(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}},{key:"touchstart",value:function(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){var n,i=new e.Point(0,0),r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;i._add(a)}}catch(o){r.e(o)}finally{r.f()}return i.div(t.length)}(n),this.touches=ur(i,n)))}},{key:"touchmove",value:function(e,t,n){if(!this.aborted&&this.centroid){var i=ur(n,t);for(var r in this.touches){var a=i[r];(!a||a.dist(this.touches[r])>30)&&(this.aborted=!0)}}}},{key:"touchend",value:function(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var i=!this.aborted&&this.centroid;if(this.reset(),i)return i}}}]),t}(),hr=function(){function e(t){_classCallCheck(this,e),this.singleTap=new cr(t),this.numTaps=t.numTaps,this.reset()}return _createClass(e,[{key:"reset",value:function(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(e,t,n){this.singleTap.touchstart(e,t,n)}},{key:"touchmove",value:function(e,t,n){this.singleTap.touchmove(e,t,n)}},{key:"touchend",value:function(e,t,n){var i=this.singleTap.touchend(e,t,n);if(i){var r=e.timeStamp-this.lastTime<500,a=!this.lastTap||this.lastTap.dist(i)<30;if(r&&a||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}]),e}(),dr=function(){function e(){_classCallCheck(this,e),this._zoomIn=new hr({numTouches:1,numTaps:2}),this._zoomOut=new hr({numTouches:2,numTaps:1}),this.reset()}return _createClass(e,[{key:"reset",value:function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}},{key:"touchstart",value:function(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}},{key:"touchmove",value:function(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}},{key:"touchend",value:function(e,t,n){var i=this,r=this._zoomIn.touchend(e,t,n),a=this._zoomOut.touchend(e,t,n);return r?(this._active=!0,e.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(r)},{originalEvent:e})}}):a?(this._active=!0,e.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(a)},{originalEvent:e})}}):void 0}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),fr={0:1,2:2},pr=function(){function e(t){_classCallCheck(this,e),this.reset(),this._clickTolerance=t.clickTolerance||1}return _createClass(e,[{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}},{key:"_correctButton",value:function(e,t){return!1}},{key:"_move",value:function(e,t){return{}}},{key:"mousedown",value:function(e,t){if(!this._lastPoint){var n=v(e);this._correctButton(e,n)&&(this._lastPoint=t,this._eventButton=n)}}},{key:"mousemoveWindow",value:function(e,t){var n=this._lastPoint;if(n)if(e.preventDefault(),null!=this._eventButton&&function(e,t){var n=fr[t];return void 0===e.buttons||(e.buttons&n)!==n}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(n,t)}},{key:"mouseupWindow",value:function(e){this._lastPoint&&v(e)===this._eventButton&&(this._moved&&f(),this.reset())}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),mr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"mousedown",value:function(e,n){_get(_getPrototypeOf2(t.prototype),"mousedown",this).call(this,e,n),this._lastPoint&&(this._active=!0)}},{key:"_correctButton",value:function(e,t){return 0===t&&!e.ctrlKey}},{key:"_move",value:function(e,t){return{around:t,panDelta:t.sub(e)}}}]),t}(pr),vr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var n=.8*(t.x-e.x);if(n)return this._active=!0,{bearingDelta:n}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),t}(pr),gr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var n=-.5*(t.y-e.y);if(n)return this._active=!0,{pitchDelta:n}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),t}(pr),yr=function(){function t(n,i){_classCallCheck(this,t),this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}return _createClass(t,[{key:"reset",value:function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)}},{key:"touchstart",value:function(e,t,n){return this._calculateTransform(e,t,n)}},{key:"touchmove",value:function(t,n,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length&&!e.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,n,i)}}},{key:"touchend",value:function(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this._minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"_calculateTransform",value:function(t,n,i){i.length>0&&(this._active=!0);var r=ur(i,n),a=new e.Point(0,0),o=new e.Point(0,0),s=0;for(var l in r){var u=r[l],c=this._touches[l];c&&(a._add(u),o._add(u.sub(c)),s++,r[l]=u)}if(this._touches=r,!(s<this._minTouches)&&o.mag()){var h=o.div(s);return this._sum._add(h),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:h}}}},{key:"enable",value:function(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}},{key:"disable",value:function(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}},{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active}},{key:"_addTouchPanBlocker",value:function(){this._map&&!this._alertContainer&&(this._alertContainer=a("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))+"px")}},{key:"_showTouchPanBlockerAlert",value:function(){var e=this;this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((function(){e._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),e._alertContainer.setAttribute("role","null")}),500)}}]),t}(),_r=function(){function e(){_classCallCheck(this,e),this.reset()}return _createClass(e,[{key:"reset",value:function(){this._active=!1,this._firstTwoTouches=void 0}},{key:"_start",value:function(e){}},{key:"_move",value:function(e,t,n){return{}}},{key:"touchstart",value:function(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}},{key:"touchmove",value:function(e,t,n){var i=this._firstTwoTouches;if(i){e.preventDefault();var r=_slicedToArray(i,2),a=r[0],o=r[1],s=xr(n,t,a),l=xr(n,t,o);if(s&&l){var u=this._aroundCenter?null:s.add(l).div(2);return this._move([s,l],u,e)}}}},{key:"touchend",value:function(e,t,n){if(this._firstTwoTouches){var i=_slicedToArray(this._firstTwoTouches,2),r=i[0],a=i[1],o=xr(n,t,r),s=xr(n,t,a);o&&s||(this._active&&f(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}();function xr(e,t,n){for(var i=0;i<e.length;i++)if(e[i].identifier===n)return t[i]}function br(e,t){return Math.log(e/t)/Math.LN2}var wr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){_get(_getPrototypeOf2(t.prototype),"reset",this).call(this),this._distance=0,this._startDistance=0}},{key:"_start",value:function(e){this._startDistance=this._distance=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var n=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(br(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:br(this._distance,n),pinchAround:t}}}]),t}(_r);function kr(e,t){return 180*e.angleWith(t)/Math.PI}var Cr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){_get(_getPrototypeOf2(t.prototype),"reset",this).call(this),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}},{key:"_start",value:function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var n=this._vector;if(this._vector=e[0].sub(e[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:kr(this._vector,n),pinchAround:t}}},{key:"_isBelowThreshold",value:function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;var i=kr(e,n);return Math.abs(i)<t}}]),t}(_r);function Sr(e){return Math.abs(e.y)>Math.abs(e.x)}var Tr=function(t){function n(e){var t;return _classCallCheck(this,n),(t=_callSuper(this,n))._map=e,t}return _inherits(n,t),_createClass(n,[{key:"reset",value:function(){_get(_getPrototypeOf2(n.prototype),"reset",this).call(this),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}},{key:"_start",value:function(e){this._lastPoints=e,Sr(e[0].sub(e[1]))&&(this._valid=!1)}},{key:"_move",value:function(t,n,i){var r=this._lastPoints;if(r){var a=t[0].sub(r[0]),o=t[1].sub(r[1]);return this._map._cooperativeGestures&&!e.isFullscreen()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(a,o,i.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(a.y+o.y)/2*-.5})}}},{key:"gestureBeginsVertically",value:function(e,t,n){if(void 0!==this._valid)return this._valid;var i=e.mag()>=2,r=t.mag()>=2;if(i||r){if(!i||!r)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var a=e.y>0==t.y>0;return Sr(e)&&Sr(t)&&a}}}]),n}(_r),Er={panStep:100,bearingStep:15,pitchStep:10},Pr=function(){function e(){_classCallCheck(this,e);var t=Er;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}return _createClass(e,[{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1}},{key:"keydown",value:function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var n=0,i=0,r=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Mr,zoom:n?Math.round(l)+n*(e.shiftKey?2:1):l,bearing:s.getBearing()+i*t._bearingStep,pitch:s.getPitch()+r*t._pitchStep,offset:[-a*t._panStep,-o*t._panStep],center:s.getCenter()},{originalEvent:e})}}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}},{key:"disableRotation",value:function(){this._rotationDisabled=!0}},{key:"enableRotation",value:function(){this._rotationDisabled=!1}}]),e}();function Mr(e){return e*(2-e)}var Ir=4.000244140625,Ar=function(){function t(n,i){_classCallCheck(this,t),this._map=n,this._el=n.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}return _createClass(t,[{key:"setZoomRate",value:function(e){this._defaultZoomRate=e}},{key:"setWheelZoomRate",value:function(e){this._wheelZoomRate=e}},{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return this._active||void 0!==this._finishTimeout}},{key:"isZooming",value:function(){return!!this._zooming}},{key:"enable",value:function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}},{key:"wheel",value:function(t){if(this.isEnabled()){if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}var n=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,i=e.exported.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%Ir==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}}},{key:"_onTimeout",value:function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}},{key:"_start",value:function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var t=p(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}}},{key:"renderFrame",value:function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;"wheel"===this._type&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);var i=function(){return n._terrainEnabled()&&t._aroundCoord?n.computeZoomRelativeTo(t._aroundCoord):n.zoom};if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>Ir?this._wheelZoomRate:this._defaultZoomRate,a=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==a&&(a=1/a);var o=i(),s=Math.pow(2,o),l="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(l*a))),"wheel"===this._type&&(this._startZoom=o,this._easing=this._smoothOutEasing(200)),this._delta=0}var u,c="number"==typeof this._targetZoom?this._targetZoom:i(),h=this._startZoom,d=this._easing,f=!1;if("wheel"===this._type&&h&&d){var p=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),m=d(p);u=e.number(h,c,m),p<1?this._frameId||(this._frameId=!0):f=!0}else u=c,f=!0;return this._active=!0,f&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!f,zoomDelta:u-i(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}}},{key:"_smoothOutEasing",value:function(t){var n=e.ease;if(this._prevEase){var i=this._prevEase,r=(e.exported.now()-i.start)/i.duration,a=i.easing(r+.01)-i.easing(r),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=e.bezier(o,s,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:n},n}},{key:"blur",value:function(){this.reset()}},{key:"reset",value:function(){this._active=!1}},{key:"_addScrollZoomBlocker",value:function(){this._map&&!this._alertContainer&&(this._alertContainer=a("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))+"px")}},{key:"_showBlockerAlert",value:function(){var e=this;this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((function(){e._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),e._alertContainer.setAttribute("role","null")}),200)}}]),t}(),Rr=function(){function e(t,n){_classCallCheck(this,e),this._clickZoom=t,this._tapZoom=n}return _createClass(e,[{key:"enable",value:function(){this._clickZoom.enable(),this._tapZoom.enable()}},{key:"disable",value:function(){this._clickZoom.disable(),this._tapZoom.disable()}},{key:"isEnabled",value:function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}},{key:"isActive",value:function(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}]),e}(),Or=function(){function e(){_classCallCheck(this,e),this.reset()}return _createClass(e,[{key:"reset",value:function(){this._active=!1}},{key:"blur",value:function(){this.reset()}},{key:"dblclick",value:function(e,t){return e.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(e.shiftKey?-1:1),around:n.unproject(t)},{originalEvent:e})}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Nr=function(){function e(){_classCallCheck(this,e),this._tap=new hr({numTouches:1,numTaps:1}),this.reset()}return _createClass(e,[{key:"reset",value:function(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}},{key:"touchstart",value:function(e,t,n){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=t[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(e,t,n))}},{key:"touchmove",value:function(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var i=t[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,n)}},{key:"touchend",value:function(e,t,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(e,t,n)&&(this._tapTime=e.timeStamp)}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Dr=function(){function e(t,n,i){_classCallCheck(this,e),this._el=t,this._mousePan=n,this._touchPan=i}return _createClass(e,[{key:"enable",value:function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}},{key:"disable",value:function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}},{key:"isEnabled",value:function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}},{key:"isActive",value:function(){return this._mousePan.isActive()||this._touchPan.isActive()}}]),e}(),zr=function(){function e(t,n,i){_classCallCheck(this,e),this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=n,this._mousePitch=i}return _createClass(e,[{key:"enable",value:function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}},{key:"disable",value:function(){this._mouseRotate.disable(),this._mousePitch.disable()}},{key:"isEnabled",value:function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}},{key:"isActive",value:function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}]),e}(),Lr=function(){function e(t,n,i,r){_classCallCheck(this,e),this._el=t,this._touchZoom=n,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}return _createClass(e,[{key:"enable",value:function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}},{key:"disable",value:function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this._rotationDisabled=!0,this._touchRotate.disable()}},{key:"enableRotation",value:function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}]),e}(),Br=function(e){return e.zoom||e.drag||e.pitch||e.rotate},Fr=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(e.Event),jr=function(){function t(){_classCallCheck(this,t),this.constants=[1,1,.01],this.radius=0}return _createClass(t,[{key:"setup",value:function(t,n){var i=e.sub([],n,t);this.radius=e.length(i[2]<0?e.div([],i,this.constants):[i[0],i[1],0])}},{key:"projectRay",value:function(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);var n=e.scale$2([],t,this.radius);if(n[2]>0){var i=e.scale$2([],[0,0,1],e.dot(n,[0,0,1])),r=e.scale$2([],e.normalize([],[n[0],n[1],0]),this.radius),a=e.add([],n,e.scale$2([],e.sub([],e.add([],r,i),n),2));n[0]=a[0],n[1]=a[1]}return n}}]),t}();function Hr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var Vr=function(){function t(n,i){_classCallCheck(this,t),this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new er(n),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),e.bindAll(["handleEvent","handleWindowEvent"],this);var r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[e.window,"blur",void 0]];var a,o=_createForOfIteratorHelper(this._listeners);try{for(o.s();!(a=o.n()).done;){var s=_slicedToArray(a.value,3),l=s[0],u=s[1],c=s[2];l.addEventListener(u,l===e.window.document?this.handleWindowEvent:this.handleEvent,c)}}catch(h){o.e(h)}finally{o.f()}}return _createClass(t,[{key:"destroy",value:function(){var t,n=_createForOfIteratorHelper(this._listeners);try{for(n.s();!(t=n.n()).done;){var i=_slicedToArray(t.value,3),r=i[0],a=i[1],o=i[2];r.removeEventListener(a,r===e.window.document?this.handleWindowEvent:this.handleEvent,o)}}catch(s){n.e(s)}finally{n.f()}}},{key:"_addDefaultHandlers",value:function(e){var t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new or(t,e));var i=t.boxZoom=new lr(t,e);this._add("boxZoom",i);var r=new dr,a=new Or;t.doubleClickZoom=new Rr(a,r),this._add("tapZoom",r),this._add("clickZoom",a);var o=new Nr;this._add("tapDragZoom",o);var s=t.touchPitch=new Tr(t);this._add("touchPitch",s);var l=new vr(e),u=new gr(e);t.dragRotate=new zr(e,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new mr(e),h=new yr(t,e);t.dragPan=new Dr(n,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);var d=new Cr,f=new wr;t.touchZoomRotate=new Lr(n,f,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]),this._add("blockableMapEvent",new sr(t));var p=t.scrollZoom=new Ar(t,this);this._add("scrollZoom",p,["mousePan"]);var m=t.keyboard=new Pr;this._add("keyboard",m);for(var v=0,g=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];v<g.length;v++){var y=g[v];e.interactive&&e[y]&&t[y].enable(e[y])}}},{key:"_add",value:function(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}},{key:"stop",value:function(e){if(!this._updatingCamera){var t,n=_createForOfIteratorHelper(this._handlers);try{for(n.s();!(t=n.n()).done;){t.value.handler.reset()}}catch(i){n.e(i)}finally{n.f()}this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}},{key:"isActive",value:function(){var e,t=_createForOfIteratorHelper(this._handlers);try{for(t.s();!(e=t.n()).done;){if(e.value.handler.isActive())return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this._eventsInProgress.rotate}},{key:"isMoving",value:function(){return!!Br(this._eventsInProgress)||this.isZooming()}},{key:"_isDragging",value:function(){return!!this._eventsInProgress.drag}},{key:"_blockedByActive",value:function(e,t,n){for(var i in e)if(i!==n&&(!t||t.indexOf(i)<0))return!0;return!1}},{key:"handleWindowEvent",value:function(e){this.handleEvent(e,e.type+"Window")}},{key:"_getMapTouches",value:function(e){var t,n=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this._el.contains(r.target)&&n.push(r)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"handleEvent",value:function(e,t){this._updatingCamera=!0;var n,i="renderFrame"===e.type,r=i?void 0:e,a={needsRenderFrame:!1},o={},s={},l=e.touches?this._getMapTouches(e.touches):void 0,u=l?m(this._el,l):i?void 0:p(this._el,e),c=_createForOfIteratorHelper(this._handlers);try{for(c.s();!(n=c.n()).done;){var h=n.value,d=h.handlerName,f=h.handler,v=h.allowed;if(f.isEnabled()){var g=void 0;this._blockedByActive(s,v,d)?f.reset():f[t||e.type]&&(g=f[t||e.type](e,u,l),this.mergeHandlerResult(a,o,g,d,r),g&&g.needsRenderFrame&&this._triggerRenderFrame()),(g||f.isActive())&&(s[d]=f)}}}catch(b){c.e(b)}finally{c.f()}var y={};for(var _ in this._previousActiveHandlers)s[_]||(y[_]=r);this._previousActiveHandlers=s,(Object.keys(y).length||Hr(a))&&(this._changes.push([a,o,y]),this._triggerRenderFrame()),(Object.keys(s).length||Hr(a))&&this._map._stop(!0),this._updatingCamera=!1;var x=a.cameraAnimation;x&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],x(this._map))}},{key:"mergeHandlerResult",value:function(t,n,i,r,a){if(i){e.extend(t,i);var o={handlerName:r,originalEvent:i.originalEvent||a};void 0!==i.zoomDelta&&(n.zoom=o),void 0!==i.panDelta&&(n.drag=o),void 0!==i.pitchDelta&&(n.pitch=o),void 0!==i.bearingDelta&&(n.rotate=o)}}},{key:"_applyChanges",value:function(){var t,n={},i={},r={},a=_createForOfIteratorHelper(this._changes);try{for(a.s();!(t=a.n()).done;){var o=_slicedToArray(t.value,3),s=o[0],l=o[1],u=o[2];s.panDelta&&(n.panDelta=(n.panDelta||new e.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(n.around=s.around),void 0!==s.aroundCoord&&(n.aroundCoord=s.aroundCoord),void 0!==s.pinchAround&&(n.pinchAround=s.pinchAround),s.noInertia&&(n.noInertia=s.noInertia),e.extend(i,l),e.extend(r,u)}}catch(c){a.e(c)}finally{a.f()}this._updateMapTransform(n,i,r),this._changes=[]}},{key:"_updateMapTransform",value:function(t,n,i){var r=this,a=this._map,o=a.transform,s=function(e){return[e.x,e.y,e.z]};if(function(e){var t=r._eventsInProgress.drag;return t&&!r._handlersById[t.handlerName].isActive()}()&&!Hr(t)){var l=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",l!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&a._stop(!0),Hr(t)){var u=t.panDelta,c=t.zoomDelta,h=t.bearingDelta,d=t.pitchDelta,f=t.around,p=t.aroundCoord,m=t.pinchAround;o._isCameraConstrained&&(c>0&&(c=0),o._isCameraConstrained=!1),void 0!==m&&(f=m),(c||function(e){return n[e]&&!r._eventsInProgress[e]}("drag"))&&f&&(this._dragOrigin=s(o.pointCoordinate3D(f)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",a._stop(!0),f=f||a.transform.centerPoint,h&&(o.bearing+=h),d&&(o.pitch+=d),o._updateCameraState();var v=[0,0,0];if(u)if("mercator"===o.projection.name){var g=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(f).dir),y=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(f.sub(u)).dir);v[0]=y[0]-g[0],v[1]=y[1]-g[1]}else{var _=o.pointCoordinate(f);if("globe"===o.projection.name){u=u.rotate(-o.angle);var x=o._pixelsPerMercatorPixel/o.worldSize;v[0]=-u.x*e.mercatorScale(e.latFromMercatorY(_.y))*x,v[1]=-u.y*e.mercatorScale(o.center.lat)*x}else{var b=o.pointCoordinate(f.sub(u));_&&b&&(v[0]=b.x-_.x,v[1]=b.y-_.y)}}var w=o.zoom,k=[0,0,0];if(c){var C=s(p||o.pointCoordinate3D(f)),S={dir:e.normalize([],e.sub([],C,o._camera.position))};if(S.dir[2]<0){var T=o.zoomDeltaToMovement(C,c);e.scale$2(k,S.dir,T)}}var E=e.add(v,v,k);o._translateCameraConstrained(E),c&&Math.abs(o.zoom-w)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,i,!0)}else this._fireEvents(n,i,!0)}},{key:"_fireEvents",value:function(t,n,i){var r=this,a=Br(this._eventsInProgress),o=Br(t),s={};for(var l in t){var u=t[l].originalEvent;this._eventsInProgress[l]||(s[l+"start"]=u),this._eventsInProgress[l]=t[l]}for(var c in!a&&o&&this._fireEvent("movestart",o.originalEvent),s)this._fireEvent(c,s[c]);for(var h in o&&this._fireEvent("move",o.originalEvent),t){var d=t[h].originalEvent;this._fireEvent(h,d)}var f,p={};for(var m in this._eventsInProgress){var v=this._eventsInProgress[m],g=v.handlerName,y=v.originalEvent;this._handlersById[g].isActive()||(delete this._eventsInProgress[m],f=n[g]||y,p[m+"end"]=f)}for(var _ in p)this._fireEvent(_,p[_]);var x=Br(this._eventsInProgress);if(i&&(a||o)&&!x){this._updatingCamera=!0;var b=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),w=function(e){return 0!==e&&-r._bearingSnap<e&&e<r._bearingSnap};b?(w(b.bearing||this._map.getBearing())&&(b.bearing=0),this._map.easeTo(b,{originalEvent:f})):(this._map.fire(new e.Event("moveend",{originalEvent:f})),w(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}},{key:"_fireEvent",value:function(t,n){this._map.fire(new e.Event(t,n?{originalEvent:n}:{}))}},{key:"_requestFrame",value:function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(t){e._frameId=void 0,e.handleEvent(new Fr("renderFrame",{timeStamp:t})),e._applyChanges()}))}},{key:"_triggerRenderFrame",value:function(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}]),t}(),Ur="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.",qr=function(t){function n(t,i){var r;return _classCallCheck(this,n),(r=_callSuper(this,n))._moving=!1,r._zooming=!1,r.transform=t,r._bearingSnap=i.bearingSnap,r._respectPrefersReducedMotion=!1!==i.respectPrefersReducedMotion,e.bindAll(["_renderFrameCallback"],_assertThisInitialized2(r)),r}return _inherits(n,t),_createClass(n,[{key:"getCenter",value:function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}},{key:"setCenter",value:function(e,t){return this.jumpTo({center:e},t)}},{key:"panBy",value:function(t,n,i){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},n),i)}},{key:"panTo",value:function(t,n,i){return this.easeTo(e.extend({center:t},n),i)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"setZoom",value:function(e,t){return this.jumpTo({zoom:e},t),this}},{key:"zoomTo",value:function(t,n,i){return this.easeTo(e.extend({zoom:t},n),i)}},{key:"zoomIn",value:function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}},{key:"zoomOut",value:function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"setBearing",value:function(e,t){return this.jumpTo({bearing:e},t),this}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(e,t){return this.jumpTo({padding:e},t),this}},{key:"rotateTo",value:function(t,n,i){return this.easeTo(e.extend({bearing:t},n),i)}},{key:"resetNorth",value:function(t,n){return this.rotateTo(0,e.extend({duration:1e3},t),n),this}},{key:"resetNorthPitch",value:function(t,n){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),n),this}},{key:"snapToNorth",value:function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setPitch",value:function(e,t){return this.jumpTo({pitch:e},t),this}},{key:"cameraForBounds",value:function(t,n){t=e.LngLatBounds.convert(t);var i=n&&n.bearing||0,r=n&&n.pitch||0,a=t.getNorthWest(),o=t.getSouthEast();return this._cameraForBounds(this.transform,a,o,i,r,n)}},{key:"_extendCameraOptions",value:function(t){var n={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){var i=t.padding;t.padding={top:i,bottom:i,right:i,left:i}}return t.padding=e.extend(n,t.padding),t}},{key:"_minimumAABBFrustumDistance",value:function(e,t){var n=t.max[0]-t.min[0],i=t.max[1]-t.min[1];return n/i>e.aspect?n/(2*Math.tan(.5*e.fovX)*e.aspect):i/(2*Math.tan(.5*e.fovY)*e.aspect)}},{key:"_cameraForBoundsOnGlobe",value:function(t,n,i,r,a,o){var s=t.clone(),l=this._extendCameraOptions(o);s.bearing=r,s.pitch=a;var u=e.LngLat.convert(n),c=e.LngLat.convert(i),h=.5*(u.lat+c.lat),d=.5*(u.lng+c.lng),f=e.latLngToECEF(h,d),p=e.normalize([],f),m=e.normalize([],e.cross([],p,[0,1,0])),v=e.cross([],m,p),g=[m[0],m[1],m[2],0,v[0],v[1],v[2],0,p[0],p[1],p[2],0,0,0,0,1],y=[f,e.latLngToECEF(u.lat,u.lng),e.latLngToECEF(c.lat,u.lng),e.latLngToECEF(c.lat,c.lng),e.latLngToECEF(u.lat,c.lng),e.latLngToECEF(h,u.lng),e.latLngToECEF(h,c.lng),e.latLngToECEF(u.lat,d),e.latLngToECEF(c.lat,d)],_=e.Aabb.fromPoints(y.map((function(t){return[e.dot(m,t),e.dot(v,t),e.dot(p,t)]}))),x=e.transformMat4([],_.center,g);0===e.squaredLength(x)&&e.set(x,0,0,1),e.normalize(x,x),e.scale$2(x,x,e.GLOBE_RADIUS),s.center=e.ecefToLatLng(x);var b=s.getWorldToCameraMatrix(),w=e.invert(new Float64Array(16),b);_=e.Aabb.applyTransform(_,e.multiply([],b,g)),e.transformMat4(x,x,b);var k=.5*(_.max[2]-_.min[2]),C=this._minimumAABBFrustumDistance(s,_),S=e.scale$2([],[0,0,1],k),T=e.add(S,x,S),E=C+(0===s.pitch?0:e.distance(x,T)),P=s.globeCenterInViewSpace,M=e.sub([],x,[P[0],P[1],P[2]]);e.normalize(M,M),e.scale$2(M,M,E);var I=e.add([],x,M);e.transformMat4(I,I,w);var A=e.earthRadius/e.GLOBE_RADIUS,R=e.length(I),O=e.mercatorZfromAltitude(Math.max(R*A-e.earthRadius,Number.EPSILON),0),N=Math.min(s.zoomFromMercatorZAdjusted(O),l.maxZoom);return N>.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(s.setProjection({name:"mercator"}),s.zoom=N,this._cameraForBounds(s,n,i,r,a,o)):{center:s.center,zoom:N,bearing:r,pitch:a}}},{key:"queryTerrainElevation",value:function(t,n){var i=this.transform.elevation;return i?(n=e.extend({},{exaggerated:!0},n),i.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,n.exaggerated)):null}},{key:"_cameraForBounds",value:function(t,n,i,r,a,o){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,n,i,r,a,o);var s=t.clone(),l=this._extendCameraOptions(o),u=s.padding;s.bearing=r,s.pitch=a;var c=e.LngLat.convert(n),h=e.LngLat.convert(i),d=new e.LngLat(c.lng,h.lat),f=new e.LngLat(h.lng,c.lat),p=s.project(c),m=s.project(h),v=this.queryTerrainElevation(c),g=this.queryTerrainElevation(h),y=this.queryTerrainElevation(d),_=this.queryTerrainElevation(f),x=[[p.x,p.y,Math.min(v||0,g||0,y||0,_||0)],[m.x,m.y,Math.max(v||0,g||0,y||0,_||0)]],b=e.Aabb.fromPoints(x),w=s.getWorldToCameraMatrix(),k=e.invert(new Float64Array(16),w);b=e.Aabb.applyTransform(b,w);var C=e.sub([],b.max,b.min),S=u.left||0,T=u.right||0,E=u.bottom||0,P=u.top||0,M=l.padding,I=M.left,A=M.right,R=M.top,O=M.bottom,N=.5*(S+T),D=.5*(P+E),z=Math.min(s.scaleZoom(s.scale*Math.min((s.width-(S+T+I+A))/C[0],(s.height-(E+P+O+R))/C[1])),l.maxZoom),L=s.scale/s.zoomScale(z);b=new e.Aabb([b.min[0]-(I+N)*L,b.min[1]-(O+D)*L,b.min[2]],[b.max[0]+(A+N)*L,b.max[1]+(R+D)*L,b.max[2]]);var B=.5*C[2],F=this._minimumAABBFrustumDistance(s,b),j=[0,0,1,0];e.transformMat4$1(j,j,w),e.normalize$2(j,j);var H=e.scale$2([],j,F+B),V=e.add([],b.center,H),U=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new e.Point(l.offset.x,l.offset.y):e.Point.convert(l.offset)).rotate(-e.degToRad(r));b.center[0]-=U.x*L,b.center[1]+=U.y*L,e.transformMat4(b.center,b.center,k),e.transformMat4(V,V,k);var q=[b.center[0],b.center[1],V[2]*s.pixelsPerMeter];e.scale$2(q,q,1/s.worldSize);var G=e.lngFromMercatorX(q[0]),W=e.latFromMercatorY(q[1]),Z=Math.min(s._zoomFromMercatorZ(q[2]),l.maxZoom),X=new e.LngLat(G,W);return s.mercatorFromTransition&&Z<.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(s.setProjection({name:"globe"}),s.zoom=Z,this._cameraForBounds(s,n,i,r,a,o)):{center:X,zoom:Z,bearing:r,pitch:a}}},{key:"fitBounds",value:function(e,t,n){var i=this.cameraForBounds(e,t);return this._fitInternal(i,t,n)}},{key:"fitScreenCoordinates",value:function(t,n,i,r,a){var o=e.Point.convert(t),s=e.Point.convert(n),l=new e.Point(Math.min(o.x,s.x),Math.min(o.y,s.y)),u=new e.Point(Math.max(o.x,s.x),Math.max(o.y,s.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(o,s))return this;var c=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(u),d=this.transform.pointLocation3D(new e.Point(l.x,u.y)),f=this.transform.pointLocation3D(new e.Point(u.x,l.y)),p=[Math.min(c.lng,h.lng,d.lng,f.lng),Math.min(c.lat,h.lat,d.lat,f.lat)],m=[Math.max(c.lng,h.lng,d.lng,f.lng),Math.max(c.lat,h.lat,d.lat,f.lat)],v=r&&r.pitch?r.pitch:this.getPitch(),g=this._cameraForBounds(this.transform,p,m,i,v,r);return this._fitInternal(g,r,a)}},{key:"_fitInternal",value:function(t,n,i){return t?(delete(n=e.extend(t,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}},{key:"jumpTo",value:function(t,n){this.stop();var i=t.preloadOnly?this.transform.clone():this.transform,r=!1,a=!1,o=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(r=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=e.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(a=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(o=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),t.preloadOnly?(this._preloadTiles(i),this):(this.fire(new e.Event("movestart",n)).fire(new e.Event("move",n)),r&&this.fire(new e.Event("zoomstart",n)).fire(new e.Event("zoom",n)).fire(new e.Event("zoomend",n)),a&&this.fire(new e.Event("rotatestart",n)).fire(new e.Event("rotate",n)).fire(new e.Event("rotateend",n)),o&&this.fire(new e.Event("pitchstart",n)).fire(new e.Event("pitch",n)).fire(new e.Event("pitchend",n)),this.fire(new e.Event("moveend",n)))}},{key:"getFreeCameraOptions",value:function(){return this.transform.projection.supportsFreeCamera||e.warnOnce(Ur),this.transform.getFreeCameraOptions()}},{key:"setFreeCameraOptions",value:function(t,n){var i=this.transform;if(!i.projection.supportsFreeCamera)return e.warnOnce(Ur),this;this.stop();var r=i.zoom,a=i.pitch,o=i.bearing;i.setFreeCameraOptions(t);var s=r!==i.zoom,l=a!==i.pitch,u=o!==i.bearing;return this.fire(new e.Event("movestart",n)).fire(new e.Event("move",n)),s&&this.fire(new e.Event("zoomstart",n)).fire(new e.Event("zoom",n)).fire(new e.Event("zoomend",n)),u&&this.fire(new e.Event("rotatestart",n)).fire(new e.Event("rotate",n)).fire(new e.Event("rotateend",n)),l&&this.fire(new e.Event("pitchstart",n)).fire(new e.Event("pitch",n)).fire(new e.Event("pitchend",n)),this.fire(new e.Event("moveend",n)),this}},{key:"easeTo",value:function(t,n){var i=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);var r,a,o,s=this.transform,l=this.getZoom(),u=this.getBearing(),c=this.getPitch(),h=this.getPadding(),d="zoom"in t?+t.zoom:l,f="bearing"in t?this._normalizeBearing(t.bearing,u):u,p="pitch"in t?+t.pitch:c,m="padding"in t?t.padding:s.padding,v=e.Point.convert(t.offset);if("globe"===s.projection.name){var g=e.MercatorCoordinate.fromLngLat(s.center),y=v.rotate(-s.angle);g.x+=y.x/s.worldSize,g.y+=y.y/s.worldSize;var _=g.toLngLat(),x=e.LngLat.convert(t.center||_);this._normalizeCenter(x),r=s.centerPoint.add(y),a=new e.Point(g.x,g.y).mult(s.worldSize),o=new e.Point(e.mercatorXfromLng(x.lng),e.mercatorYfromLat(x.lat)).mult(s.worldSize).sub(a)}else{r=s.centerPoint.add(v);var b=s.pointLocation(r),w=e.LngLat.convert(t.center||b);this._normalizeCenter(w),a=s.project(b),o=s.project(w).sub(a)}var k,C,S=s.zoomScale(d-l);t.around&&(k=e.LngLat.convert(t.around),C=s.locationPoint(k));var T=this._zooming||d!==l,E=this._rotating||u!==f,P=this._pitching||p!==c,M=!s.isPaddingEqual(m),I=function(s){return function(g){if(T&&(s.zoom=e.number(l,d,g)),E&&(s.bearing=e.number(u,f,g)),P&&(s.pitch=e.number(c,p,g)),M&&(s.interpolatePadding(h,m,g),r=s.centerPoint.add(v)),k)s.setLocationAtPoint(k,C);else{var y=s.zoomScale(s.zoom-l),_=d>l?Math.min(2,S):Math.max(.5,S),x=Math.pow(_,1-g),b=s.unproject(a.add(o.mult(g*x)).mult(y));s.setLocationAtPoint(s.renderWorldCopies?b.wrap():b,r)}return t.preloadOnly||i._fireMoveEvents(n),s}};if(t.preloadOnly){var A=this._emulate(I,t.duration,s);return this._preloadTiles(A),this}var R={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=T,this._rotating=E,this._pitching=P,this._padding=M,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,R),this._ease(I(s),(function(e){s.recenterOnTerrain(),i._afterEase(n,e)}),t),this}},{key:"_prepareEase",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",n||i.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!i.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new e.Event("pitchstart",t))}},{key:"_fireMoveEvents",value:function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}},{key:"_afterEase",value:function(t,n){if(!this._easeId||!n||this._easeId!==n){this._easeId=void 0,this.transform.cameraElevationReference="ground";var i=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),a&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}}},{key:"flyTo",value:function(t,n){var i=this;if(this._prefersReducedMotion(t)){var r=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var a=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in t?e.clamp(+t.zoom,a.minZoom,a.maxZoom):o,h="bearing"in t?this._normalizeBearing(t.bearing,s):s,d="pitch"in t?+t.pitch:l,f="padding"in t?t.padding:a.padding,p=a.zoomScale(c-o),m=e.Point.convert(t.offset),v=a.centerPoint.add(m),g=a.pointLocation(v),y=e.LngLat.convert(t.center||g);this._normalizeCenter(y);var _=a.project(g),x=a.project(y).sub(_),b=t.curve,w=Math.max(a.width,a.height),k=w/p,C=x.mag();if("minZoom"in t){var S=e.clamp(Math.min(t.minZoom,o,c),a.minZoom,a.maxZoom),T=w/a.zoomScale(S-o);b=Math.sqrt(T/C*2)}var E=b*b;function P(e){var t=(k*k-w*w+(e?-1:1)*E*E*C*C)/(2*(e?k:w)*E*C);return Math.log(Math.sqrt(t*t+1)-t)}function M(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}var A=P(0),R=function(e){return I(A)/I(A+b*e)},O=function(e){return w*((I(A)*(M(t=A+b*e)/I(t))-M(A))/E)/C;var t},N=(P(1)-A)/b;if(Math.abs(C)<1e-6||!isFinite(N)){if(Math.abs(w-k)<1e-6)return this.easeTo(t,n);var D=k<w?-1:1;N=Math.abs(Math.log(k/w))/b,O=function(){return 0},R=function(e){return Math.exp(D*b*e)}}t.duration="duration"in t?+t.duration:1e3*N/("screenSpeed"in t?+t.screenSpeed/b:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);var z=s!==h,L=d!==l,B=!a.isPaddingEqual(f),F=function(r){return function(a){var p=a*N,g=1/R(p);r.zoom=1===a?c:o+r.scaleZoom(g),z&&(r.bearing=e.number(s,h,a)),L&&(r.pitch=e.number(l,d,a)),B&&(r.interpolatePadding(u,f,a),v=r.centerPoint.add(m));var b=1===a?y:r.unproject(_.add(x.mult(O(p))).mult(g));return r.setLocationAtPoint(r.renderWorldCopies?b.wrap():b,v),r._updateCameraOnTerrain(),t.preloadOnly||i._fireMoveEvents(n),r}};if(t.preloadOnly){var j=this._emulate(F,t.duration,a);return this._preloadTiles(j),this}return this._zooming=!0,this._rotating=z,this._pitching=L,this._padding=B,this._prepareEase(n,!1),this._ease(F(a),(function(){return i._afterEase(n)}),t),this}},{key:"isEasing",value:function(){return!!this._easeFrameId}},{key:"stop",value:function(){return this._stop()}},{key:"_stop",value:function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){var n=this._onEaseEnd;this._onEaseEnd=void 0,n.call(this,t)}if(!e){var i=this.handlers;i&&i.stop(!1)}return this}},{key:"_ease",value:function(t,n,i){!1===i.animate||0===i.duration?(t(1),n()):(this._easeStart=e.exported.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}},{key:"_renderFrameCallback",value:function(){var t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}},{key:"_normalizeBearing",value:function(t,n){t=e.wrap(t,-180,180);var i=Math.abs(t-n);return Math.abs(t-360-n)<i&&(t-=360),Math.abs(t+360-n)<i&&(t+=360),t}},{key:"_normalizeCenter",value:function(e){var t=this.transform;if(t.renderWorldCopies&&!t.maxBounds){var n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}}},{key:"_prefersReducedMotion",value:function(t){return this._respectPrefersReducedMotion&&e.exported.prefersReducedMotion&&!(t&&t.essential)}},{key:"_emulate",value:function(e,t,n){for(var i=Math.ceil(15*t/1e3),r=[],a=e(n.clone()),o=0;o<=i;o++){var s=a(o/i);r.push(s.clone())}return r}}]),n}(e.Evented),Gr=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.options=n,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}return _createClass(t,[{key:"getDefaultPosition",value:function(){return"bottom-right"}},{key:"onAdd",value:function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=a("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=a("button","mapboxgl-ctrl-attrib-button",this._container),a("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=a("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}},{key:"_setElementTitle",value:function(e,t){var n=this._map._getUIString("AttributionControl."+t);e.setAttribute("aria-label",n),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}},{key:"_toggleAttribution",value:function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}},{key:"_updateEditLink",value:function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var i=n.reduce((function(e,t,i){return t.value&&(e+="".concat(t.key,"=").concat(t.value).concat(i<n.length-1?"&":"")),e}),"?");t.href="".concat(e.config.FEEDBACK_URL,"/").concat(i,"#").concat(Xi(this._map,!0)),t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}},{key:"_updateData",value:function(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}},{key:"_updateAttributions",value:function(){if(this._map.style){var e=[];if(this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var n=this._map.style._sourceCaches;for(var i in n){var r=n[i];if(r.used){var a=r.getSource();a.attribution&&e.indexOf(a.attribution)<0&&e.push(a.attribution)}}e.sort((function(e,t){return e.length-t.length})),e=e.filter((function(t,n){for(var i=n+1;i<e.length;i++)if(e[i].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[].concat(_toConsumableArray(this.options.customAttribution),_toConsumableArray(e)):e.unshift(this.options.customAttribution));var o=e.join(" | ");o!==this._attribHTML&&(this._attribHTML=o,e.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}}},{key:"_updateCompact",value:function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}]),t}(),Wr=function(){function t(){_classCallCheck(this,t),e.bindAll(["_updateLogo","_updateCompact"],this)}return _createClass(t,[{key:"onAdd",value:function(e){this._map=e,this._container=a("div","mapboxgl-ctrl");var t=a("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}},{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_updateLogo",value:function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}},{key:"_logoRequired",value:function(){if(!this._map.style)return!0;var e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(var t in e){var n=e[t].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}},{key:"_updateCompact",value:function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}]),t}(),Zr=function(){function e(){_classCallCheck(this,e),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return _createClass(e,[{key:"add",value:function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}},{key:"remove",value:function(e){var t,n=this._currentlyRunning,i=_createForOfIteratorHelper(n?this._queue.concat(n):this._queue);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.id===e)return void(r.cancelled=!0)}}catch(a){i.e(a)}finally{i.f()}}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._currentlyRunning=this._queue;this._queue=[];var n,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!r.cancelled&&(r.callback(e),this._cleared))break}}catch(a){i.e(a)}finally{i.f()}this._cleared=!1,this._currentlyRunning=!1}},{key:"clear",value:function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}]),e}();function Xr(t,n,i){if(t=new e.LngLat(t.lng,t.lat),n){var r=new e.LngLat(t.lng-360,t.lat),a=new e.LngLat(t.lng+360,t.lat),o=360*Math.ceil(Math.abs(t.lng-i.center.lng)/360),s=i.locationPoint(t).distSqr(n),l=n.x<0||n.y<0||n.x>i.width||n.y>i.height;i.locationPoint(r).distSqr(n)<s&&(l||Math.abs(r.lng-i.center.lng)<o)?t=r:i.locationPoint(a).distSqr(n)<s&&(l||Math.abs(a.lng-i.center.lng)<o)&&(t=a)}for(;Math.abs(t.lng-i.center.lng)>180;){var u=i.locationPoint(t);if(u.x>=0&&u.y>=0&&u.x<=i.width&&u.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}var Kr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Yr=function(t){function n(t,i){var r;if(_classCallCheck(this,n),r=_callSuper(this,n),(t instanceof e.window.HTMLElement||i)&&(t=e.extend({element:t},i)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],_assertThisInitialized2(r)),r._anchor=t&&t.anchor||"center",r._color=t&&t.color||"#3FB1CE",r._scale=t&&t.scale||1,r._draggable=t&&t.draggable||!1,r._clickTolerance=t&&t.clickTolerance||0,r._isDragging=!1,r._state="inactive",r._rotation=t&&t.rotation||0,r._rotationAlignment=t&&t.rotationAlignment||"auto",r._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",r._updateMoving=function(){return r._update(!0)},r._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)r._element=t.element,r._offset=e.Point.convert(t&&t.offset||[0,0]);else{r._defaultMarker=!0,r._element=a("div");var s=o("svg",{display:"block",height:41*r._scale+"px",width:27*r._scale+"px",viewBox:"0 0 ".concat(27," ").concat(41)},r._element),l=o("radialGradient",{id:"shadowGradient"},o("defs",{},s));o("stop",{offset:"10%","stop-opacity":.4},l),o("stop",{offset:"100%","stop-opacity":.05},l),o("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},s),o("path",{fill:r._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},s),o("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},s),o("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},s),r._offset=e.Point.convert(t&&t.offset||[0,-14])}r._element.hasAttribute("aria-label")||r._element.setAttribute("aria-label","Map marker"),r._element.classList.add("mapboxgl-marker"),r._element.addEventListener("dragstart",(function(e){e.preventDefault()})),r._element.addEventListener("mousedown",(function(e){e.preventDefault()}));var u=r._element.classList;for(var c in Kr)u.remove("mapboxgl-marker-anchor-"+c);return u.add("mapboxgl-marker-anchor-"+r._anchor),r._popup=null,_possibleConstructorReturn(r)}return _inherits(n,t),_createClass(n,[{key:"addTo",value:function(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}},{key:"remove",value:function(){var e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}},{key:"getElement",value:function(){return this._element}},{key:"setPopup",value:function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}},{key:"_onKeyPress",value:function(e){var t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()}},{key:"_onMapClick",value:function(e){var t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()}},{key:"getPopup",value:function(){return this._popup}},{key:"togglePopup",value:function(){var e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}},{key:"_behindTerrain",value:function(){var e=this._map,t=this._pos;if(!e||!t)return!1;var n=e.unproject(t),i=e.getFreeCameraOptions();if(!i.position)return!1;var r=i.position.toLngLat();return r.distanceTo(n)<.9*r.distanceTo(this._lngLat)}},{key:"_evaluateOpacity",value:function(){var t=this._map;if(t){var n=this._pos;if(!n||n.x<0||n.x>t.transform.width||n.y<0||n.y>t.transform.height)this._clearFadeTimer();else{var i,r=t.unproject(n);t._showingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?i=0:(i=1-t._queryFogOpacity(r),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(i*=this._occludedOpacity)),this._element.style.opacity=""+i,this._element.style.pointerEvents=i>0?"auto":"none",this._popup&&this._popup._setOpacity(i),this._fadeTimer=null}}}},{key:"_clearFadeTimer",value:function(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}},{key:"_updateDOM",value:function(){var e=this._pos;if(e&&this._map){var t=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(e.x,"px,").concat(e.y,"px)\n            ").concat(Kr[this._anchor],"\n            ").concat(this._calculateXYTransform()," ").concat(this._calculateZTransform(),"\n            translate(").concat(t.x,"px,").concat(t.y,"px)\n        ")}}},{key:"_calculateXYTransform",value:function(){var t=this._pos,n=this._map,i=this.getPitchAlignment();if(!n||!t||"map"!==i)return"";if(!n._showingGlobe()){var r=n.getPitch();return r?"rotateX(".concat(r,"deg)"):""}var a=e.radToDeg(e.globeTiltAtLngLat(n.transform,this._lngLat)),o=t.sub(e.globeCenterToScreenPoint(n.transform)),s=Math.abs(o.x)+Math.abs(o.y);if(0===s)return"";var l=a/s;return"rotateX(".concat(-o.y*l,"deg) rotateY(").concat(o.x*l,"deg)")}},{key:"_calculateZTransform",value:function(){var t=this._pos,n=this._map;if(!n||!t)return"";var i=0,r=this.getRotationAlignment();if("map"===r)if(n._showingGlobe()){var a=n.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),o=n.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(a);i=e.radToDeg(Math.atan2(o.y,o.x))-90}else i=-n.getBearing();else if("horizon"===r){var s=e.smoothstep(4,6,n.getZoom()),l=e.globeCenterToScreenPoint(n.transform);l.y+=s*n.transform.height;var u=t.sub(l),c=e.radToDeg(Math.atan2(u.y,u.x));i=(c>90?c-270:c+90)*(1-s)}return(i+=this._rotation)?"rotateZ(".concat(i,"deg)"):""}},{key:"_update",value:function(t){var n=this;e.window.cancelAnimationFrame(this._updateFrameId);var i=this._map;i&&(i.transform.renderWorldCopies&&(this._lngLat=Xr(this._lngLat,this._pos,i.transform)),this._pos=i.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame((function(){n._element&&n._pos&&n._anchor&&(n._pos=n._pos.round(),n._updateDOM())})):this._pos=this._pos.round(),i._requestDomTask((function(){n._map&&(n._element&&n._pos&&n._anchor&&n._updateDOM(),(i._showingGlobe()||i.getTerrain()||i.getFog())&&!n._fadeTimer&&(n._fadeTimer=setTimeout(n._evaluateOpacity.bind(n),60)))})))}},{key:"getOffset",value:function(){return this._offset}},{key:"setOffset",value:function(t){return this._offset=e.Point.convert(t),this._update(),this}},{key:"_onMove",value:function(t){var n=this._map;if(n){var i=this._pointerdownPos,r=this._positionDelta;if(i&&r){if(!this._isDragging){var a=this._clickTolerance||n._clickTolerance;if(t.point.dist(i)<a)return;this._isDragging=!0}this._pos=t.point.sub(r),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))}}}},{key:"_onUp",value:function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;var t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}},{key:"_addDragHandler",value:function(e){var t=this._map,n=this._pos;t&&n&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(n),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}},{key:"setDraggable",value:function(e){this._draggable=!!e;var t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}},{key:"isDraggable",value:function(){return this._draggable}},{key:"setRotation",value:function(e){return this._rotation=e||0,this._update(),this}},{key:"getRotation",value:function(){return this._rotation}},{key:"setRotationAlignment",value:function(e){return this._rotationAlignment=e||"auto",this._update(),this}},{key:"getRotationAlignment",value:function(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}},{key:"setPitchAlignment",value:function(e){return this._pitchAlignment=e||"auto",this._update(),this}},{key:"getPitchAlignment",value:function(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}},{key:"setOccludedOpacity",value:function(e){return this._occludedOpacity=e||.2,this._update(),this}},{key:"getOccludedOpacity",value:function(){return this._occludedOpacity}}]),n}(e.Evented),Jr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Qr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.Point(0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof t){var i=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(n){case"top":return new e.Point(0,t);case"top-left":return new e.Point(i,i);case"top-right":return new e.Point(-i,i);case"bottom":return new e.Point(0,-t);case"bottom-left":return new e.Point(i,-i);case"bottom-right":return new e.Point(-i,-i);case"left":return new e.Point(t,0);case"right":return new e.Point(-t,0)}return new e.Point(0,0)}return t instanceof e.Point||Array.isArray(t)?e.Point.convert(t):e.Point.convert(t[n]||[0,0])}var ea=function(){function t(e){_classCallCheck(this,t),this.jumpTo(e)}return _createClass(t,[{key:"getValue",value:function(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;var n=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}},{key:"isEasing",value:function(e){return e>=this._startTime&&e<=this._endTime}},{key:"jumpTo",value:function(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}},{key:"easeTo",value:function(e,t,n){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+n}}]),t}(),ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},na={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},ia={showCompass:!0,showZoom:!0,visualizePitch:!1},ra=function(){function t(n,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this._clickTolerance=10,this.element=i,this.mouseRotate=new vr({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,r&&(this.mousePitch=new gr({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}return _createClass(t,[{key:"down",value:function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),c()}},{key:"move",value:function(e,t){var n=this.map,i=this.mouseRotate.mousemoveWindow(e,t),r=i&&i.bearingDelta;if(r&&n.setBearing(n.getBearing()+r),this.mousePitch){var a=this.mousePitch.mousemoveWindow(e,t),o=a&&a.pitchDelta;o&&n.setPitch(n.getPitch()+o)}}},{key:"off",value:function(){var e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}},{key:"offTemp",value:function(){h(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}},{key:"mousedown",value:function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),p(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}},{key:"mousemove",value:function(e){this.move(e,p(this.element,e))}},{key:"mouseup",value:function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}},{key:"touchstart",value:function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=m(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))}},{key:"touchmove",value:function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=m(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))}},{key:"touchend",value:function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}},{key:"reset",value:function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}]),t}(),aa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},oa={maxWidth:100,unit:"metric"},sa={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},la={version:e.version,supported:n,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:function(t){function r(t){var n;if(_classCallCheck(this,r),e.LivePerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},na,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),(n=_callSuper(this,r,[new Gi(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t]))._interactive=t.interactive,n._minTileCacheSize=t.minTileCacheSize,n._maxTileCacheSize=t.maxTileCacheSize,n._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,n._preserveDrawingBuffer=t.preserveDrawingBuffer,n._antialias=t.antialias,n._useWebGL2=t.useWebGL2,n._trackResize=t.trackResize,n._bearingSnap=t.bearingSnap,n._refreshExpiredTiles=t.refreshExpiredTiles,n._fadeDuration=t.fadeDuration,n._isInitialLoad=!0,n._crossSourceCollisions=t.crossSourceCollisions,n._collectResourceTiming=t.collectResourceTiming,n._optimizeForTerrain=t.optimizeForTerrain,n._language=n._parseLanguage(t.language),n._worldview=t.worldview,n._renderTaskQueue=new Zr,n._domRenderTaskQueue=new Zr,n._controls=[],n._markers=[],n._popups=[],n._mapId=e.uniqueId(),n._locale=e.extend({},ta,t.locale),n._clickTolerance=t.clickTolerance,n._cooperativeGestures=t.cooperativeGestures,n._performanceMetricsCollection=t.performanceMetricsCollection,n._containerWidth=0,n._containerHeight=0,n._averageElevationLastSampledAt=-1/0,n._averageElevationExaggeration=0,n._averageElevation=new ea(0),n._interactionRange=[1/0,-1/0],n._visibilityHidden=0,n._useExplicitProjection=!1,n._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),n._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(n._container=e.window.document.getElementById(t.container),!n._container)throw new Error("Container '".concat(t.container,"' not found."))}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");n._container=t.container}if(n._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&n.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],_assertThisInitialized2(n)),n._setupContainer(),n._setupPainter(),void 0===n.painter)throw new Error("Failed to initialize WebGL.");return n.on("move",(function(){return n._update(!1)})),n.on("moveend",(function(){return n._update(!1)})),n.on("zoom",(function(){return n._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",n._onWindowOnline,!1),e.window.addEventListener("resize",n._onWindowResize,!1),e.window.addEventListener("orientationchange",n._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",n._onWindowResize,!1),e.window.addEventListener("visibilitychange",n._onVisibilityChange,!1)),n.handlers=new Vr(_assertThisInitialized2(n),t),n._localFontFamily=t.localFontFamily,n._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&n.setStyle(t.style,{localFontFamily:n._localFontFamily,localIdeographFontFamily:n._localIdeographFontFamily}),t.projection&&n.setProjection(t.projection),n._hash=t.hash&&new Zi("string"==typeof t.hash&&t.hash||void 0).addTo(_assertThisInitialized2(n)),n._hash&&n._hash._onHashChange()||(n.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(n.resize(),n.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),n.resize(),t.attributionControl&&n.addControl(new Gr({customAttribution:t.customAttribution})),n._logoControl=new Wr,n.addControl(n._logoControl,t.logoPosition),n.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),n.on("data",(function(t){n._update("style"===t.dataType),n.fire(new e.Event(t.dataType+"data",t))})),n.on("dataloading",(function(t){n.fire(new e.Event(t.dataType+"dataloading",t))})),_possibleConstructorReturn(n)}return _inherits(r,t),_createClass(r,[{key:"_getMapId",value:function(){return this._mapId}},{key:"addControl",value:function(t,n){if(void 0===n&&(n=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=t.onAdd(this);this._controls.push(t);var r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}},{key:"removeControl",value:function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this}},{key:"hasControl",value:function(e){return this._controls.indexOf(e)>-1}},{key:"getContainer",value:function(){return this._container}},{key:"getCanvasContainer",value:function(){return this._canvasContainer}},{key:"getCanvas",value:function(){return this._canvas}},{key:"resize",value:function(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));var n=!this._moving;return n&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),n&&this.fire(new e.Event("moveend",t)),this}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()||null}},{key:"setMaxBounds",value:function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}},{key:"setMinZoom",value:function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}},{key:"getLanguage",value:function(){return this._language}},{key:"_parseLanguage",value:function(t){return"auto"===t?e.window.navigator.language:Array.isArray(t)?0===t.length?void 0:t.map((function(t){return"auto"===t?e.window.navigator.language:t})):t}},{key:"setLanguage",value:function(e){var t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();var n,i=_createForOfIteratorHelper(this._controls);try{for(i.s();!(n=i.n()).done;){var r=n.value;r._setLanguage&&r._setLanguage(this._language)}}catch(a){i.e(a)}finally{i.f()}return this}},{key:"getWorldview",value:function(){return this._worldview}},{key:"setWorldview",value:function(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style._reloadSources(),this):this}},{key:"getProjection",value:function(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}},{key:"_showingGlobe",value:function(){return"globe"===this.transform.projection.name}},{key:"setProjection",value:function(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.stylesheet?this.style.stylesheet.projection:null)}},{key:"_updateProjectionTransition",value:function(){if("globe"===this.getProjection().name){var t,n=this.transform,i=n.projection.name;"globe"===i&&n.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(n.setMercatorFromTransition(),t=!0):"mercator"===i&&n.zoom<e.GLOBE_ZOOM_THRESHOLD_MAX&&(n.setProjection({name:"globe"}),t=!0),t&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}}},{key:"_prioritizeAndUpdateProjection",value:function(e,t){return this._updateProjection(e||t||{name:"mercator"})}},{key:"_updateProjection",value:function(t){var n;if(n="globe"===t.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),n){for(var i in this.painter.clearBackgroundTiles(),this.style._sourceCaches)this.style._sourceCaches[i].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}},{key:"project",value:function(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}},{key:"unproject",value:function(t){return this.transform.pointLocation3D(e.Point.convert(t))}},{key:"isMoving",value:function(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}},{key:"isZooming",value:function(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}},{key:"isRotating",value:function(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}},{key:"_isDragging",value:function(){return this.handlers&&this.handlers._isDragging()||!1}},{key:"_createDelegatedListener",value:function(e,t,n){var i=this;if("mouseenter"===e||"mouseover"===e){var r=!1;return{layers:new Set(t),listener:n,delegates:{mousemove:function(a){var o=t.filter((function(e){return i.getLayer(e)})),s=o.length?i.queryRenderedFeatures(a.point,{layers:o}):[];s.length?r||(r=!0,n.call(i,new ir(e,i,a.originalEvent,{features:s}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"===e||"mouseout"===e){var a=!1;return{layers:new Set(t),listener:n,delegates:{mousemove:function(r){var o=t.filter((function(e){return i.getLayer(e)}));(o.length?i.queryRenderedFeatures(r.point,{layers:o}):[]).length?a=!0:a&&(a=!1,n.call(i,new ir(e,i,r.originalEvent)))},mouseout:function(t){a&&(a=!1,n.call(i,new ir(e,i,t.originalEvent)))}}}}return{layers:new Set(t),listener:n,delegates:_defineProperty({},e,(function(e){var r=t.filter((function(e){return i.getLayer(e)})),a=r.length?i.queryRenderedFeatures(e.point,{layers:r}):[];a.length&&(e.features=a,n.call(i,e),delete e.features)}))}}},{key:"on",value:function(e,t,n){if(void 0===n)return _get(_getPrototypeOf2(r.prototype),"on",this).call(this,e,t);Array.isArray(t)||(t=[t]);var i=this._createDelegatedListener(e,t,n);for(var a in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(i),i.delegates)this.on(a,i.delegates[a]);return this}},{key:"once",value:function(e,t,n){if(void 0===n)return _get(_getPrototypeOf2(r.prototype),"once",this).call(this,e,t);Array.isArray(t)||(t=[t]);var i=this._createDelegatedListener(e,t,n);for(var a in i.delegates)this.once(a,i.delegates[a]);return this}},{key:"off",value:function(e,t,n){var i=this;if(void 0===n)return _get(_getPrototypeOf2(r.prototype),"off",this).call(this,e,t);t=new Set(Array.isArray(t)?t:[t]);var a=function(e,t){if(e.size!==t.size)return!1;var n,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!t.has(r))return!1}}catch(a){i.e(a)}finally{i.f()}return!0},o=this._delegatedListeners?this._delegatedListeners[e]:void 0;return o&&function(e){for(var r=0;r<e.length;r++){var o=e[r];if(o.listener===n&&a(o.layers,t)){for(var s in o.delegates)i.off(s,o.delegates[s]);return e.splice(r,1),i}}}(o),this}},{key:"queryRenderedFeatures",value:function(t,n){return this.style?(void 0!==n||void 0===t||t instanceof e.Point||Array.isArray(t)||(n=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}},{key:"querySourceFeatures",value:function(e,t){return this.style.querySourceFeatures(e,t)}},{key:"isPointOnSurface",value:function(t){var n=this.transform.projection.name;return"globe"!==n&&"mercator"!==n&&e.warnOnce(n+" projection does not support isPointOnSurface, this API may behave unexpectedly."),this.transform.isPointOnSurface(e.Point.convert(t))}},{key:"setStyle",value:function(t,n){return!1!==(n=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(t,n))}},{key:"_getUIString",value:function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}},{key:"_updateStyle",value:function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new Yt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}},{key:"_lazyInitEmptyStyle",value:function(){this.style||(this.style=new Yt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}},{key:"_diffStyle",value:function(t,n){var i=this;if("string"==typeof t){var r=this._requestManager.normalizeStyleURL(t),a=this._requestManager.transformRequest(r,e.ResourceType.Style);e.getJSON(a,(function(t,r){t?i.fire(new e.ErrorEvent(t)):r&&i._updateDiff(r,n)}))}else"object"==typeof t&&this._updateDiff(t,n)}},{key:"_updateDiff",value:function(t,n){try{this.style.setState(t)&&this._update(!0)}catch(i){e.warnOnce("Unable to perform style diff: ".concat(i.message||i.error||i,".  Rebuilding the style from scratch.")),this._updateStyle(t,n)}}},{key:"getStyle",value:function(){if(this.style)return this.style.serialize()}},{key:"isStyleLoaded",value:function(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}},{key:"addSource",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}},{key:"isSourceLoaded",value:function(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}},{key:"areTilesLoaded",value:function(){var e=this.style&&this.style._sourceCaches;for(var t in e){var n=e[t]._tiles;for(var i in n){var r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0}},{key:"addSourceType",value:function(e,t,n){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,n)}},{key:"removeSource",value:function(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}},{key:"getSource",value:function(e){return this.style.getSource(e)}},{key:"addImage",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.pixelRatio,a=void 0===r?1:r,o=i.sdf,s=void 0!==o&&o,l=i.stretchX,u=i.stretchY,c=i.content;if(this._lazyInitEmptyStyle(),n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap){var h=e.exported.getImageData(n),d=h.width,f=h.height,p=h.data;this.style.addImage(t,{data:new e.RGBAImage({width:d,height:f},p),pixelRatio:a,stretchX:l,stretchY:u,content:c,sdf:s,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{var m=n.width,v=n.height,g=n;this.style.addImage(t,{data:new e.RGBAImage({width:m,height:v},new Uint8Array(g.data)),pixelRatio:a,stretchX:l,stretchY:u,content:c,sdf:s,version:0,userImage:g}),g.onAdd&&g.onAdd(this,t)}}},{key:"updateImage",value:function(t,n){var i=this.style.getImage(t);if(i){var r=n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap?e.exported.getImageData(n):n,a=r.width,o=r.height;void 0!==a&&void 0!==o?a===i.data.width&&o===i.data.height?(i.data.replace(r.data,!(n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap)),this.style.updateImage(t,i)):this.fire(new e.ErrorEvent(new Error("The width and height of the updated image (".concat(a,", ").concat(o,")\n                must be that same as the previous version of the image\n                (").concat(i.data.width,", ").concat(i.data.height,")")))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}else this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")))}},{key:"hasImage",value:function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}},{key:"removeImage",value:function(e){this.style.removeImage(e)}},{key:"loadImage",value:function(t,n){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),(function(t,i){n(t,i instanceof e.window.HTMLImageElement?e.exported.getImageData(i):i)}))}},{key:"listImages",value:function(){return this.style.listImages()}},{key:"addLayer",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}},{key:"moveLayer",value:function(e,t){return this.style.moveLayer(e,t),this._update(!0)}},{key:"removeLayer",value:function(e){return this.style.removeLayer(e),this._update(!0)}},{key:"getLayer",value:function(e){return this.style.getLayer(e)}},{key:"setLayerZoomRange",value:function(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)}},{key:"setFilter",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,n),this._update(!0)}},{key:"getFilter",value:function(e){return this.style.getFilter(e)}},{key:"setPaintProperty",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,n,i),this._update(!0)}},{key:"getPaintProperty",value:function(e,t){return this.style.getPaintProperty(e,t)}},{key:"setLayoutProperty",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,n,i),this._update(!0)}},{key:"getLayoutProperty",value:function(e,t){return this.style.getLayoutProperty(e,t)}},{key:"setLight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}},{key:"getLight",value:function(){return this.style.getLight()}},{key:"setTerrain",value:function(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}},{key:"getTerrain",value:function(){return this.style?this.style.getTerrain():null}},{key:"setFog",value:function(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}},{key:"getFog",value:function(){return this.style?this.style.getFog():null}},{key:"_queryFogOpacity",value:function(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}},{key:"setFeatureState",value:function(e,t){return this.style.setFeatureState(e,t),this._update()}},{key:"removeFeatureState",value:function(e,t){return this.style.removeFeatureState(e,t),this._update()}},{key:"getFeatureState",value:function(e){return this.style.getFeatureState(e)}},{key:"_updateContainerDimensions",value:function(){if(this._container){for(var t,n,i,r=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300,o=this._container;o&&(!n||!i);){var s=e.window.getComputedStyle(o).transform;s&&"none"!==s&&((t=s.match(/matrix.*\((.+)\)/)[1].split(", "))[0]&&"0"!==t[0]&&"1"!==t[0]&&(n=t[0]),t[3]&&"0"!==t[3]&&"1"!==t[3]&&(i=t[3])),o=o.parentElement}this._containerWidth=n?Math.abs(r/n):r,this._containerHeight=i?Math.abs(a/i):a}}},{key:"_detectMissingCSS",value:function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}},{key:"_setupContainer",value:function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=a("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=a("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=a("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);var n=this._controlContainer=a("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){i[e]=a("div","mapboxgl-ctrl-"+e,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}},{key:"_resizeCanvas",value:function(t,n){var i=e.exported.devicePixelRatio||1;this._canvas.width=i*Math.ceil(t),this._canvas.height=i*Math.ceil(n),this._canvas.style.width=t+"px",this._canvas.style.height=n+"px"}},{key:"_addMarker",value:function(e){this._markers.push(e)}},{key:"_removeMarker",value:function(e){var t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}},{key:"_addPopup",value:function(e){this._popups.push(e)}},{key:"_removePopup",value:function(e){var t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}},{key:"_setupPainter",value:function(){var t=this,i=e.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",i),a=r||this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);a?(this._useWebGL2&&!r&&e.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),e.storeAuthState(a,!0),this.painter=new Ri(a,this.transform,!!r),this.on("data",(function(e){"source"===e.dataType&&t.painter.setTileLoadedFlag(!0)})),e.exported$1.testSupport(a)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}},{key:"_contextLost",value:function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}},{key:"_contextRestored",value:function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}},{key:"_onMapScroll",value:function(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}},{key:"loaded",value:function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}},{key:"_update",value:function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}},{key:"_requestRenderFrame",value:function(e){return this._update(),this._renderTaskQueue.add(e)}},{key:"_cancelRenderFrame",value:function(e){this._renderTaskQueue.remove(e)}},{key:"_requestDomTask",value:function(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}},{key:"_render",value:function(t){var n,i=this,r=this.painter.context.extTimerQuery,a=e.exported.now();if(this.listens("gpu-timing-frame")&&(n=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],e.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],e.window.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),!this._removed){this._updateProjectionTransition();var o=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=this.transform.pitch,u=e.exported.now(),c=new e.EvaluationParameters(s,{now:u,fadeDuration:o,pitch:l,transition:this.style.getTransition()});this.style.update(c)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);var h=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),h=this._updateAverageElevation(a),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):h=this._updateAverageElevation(a),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){var d=e.exported.now()-a;r.endQueryEXT(r.TIME_ELAPSED_EXT,n),setTimeout((function(){var t=r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n),i.fire(new e.Event("gpu-timing-frame",{cpuTime:d,gpuTime:t})),e.window.performance.mark("frame-gpu",{startTime:a,detail:{gpuTime:t}})}),50)}if(this.listens("gpu-timing-layer")){var f=this.painter.collectGpuTimers();setTimeout((function(){var t=i.painter.queryGpuTimers(f);i.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}if(this.listens("gpu-timing-deferred-render")){var p=this.painter.collectDeferredRenderGpuQueries();setTimeout((function(){var t=i.painter.queryGpuTimeDeferredRender(p);i.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:t}))}),50)}var m=this._sourcesDirty||this._styleDirty||this._placementDirty||h;if(m||this._repaint)this.triggerRepaint();else{var v=!this.isMoving()&&this.loaded();if(v&&(h=this._updateAverageElevation(a,!0)),h)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){var g=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:g})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||m||(this._fullyLoaded=!0,e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&e.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}}},{key:"_forceMarkerAndPopupUpdate",value:function(e){var t,n=_createForOfIteratorHelper(this._markers);try{for(n.s();!(t=n.n()).done;){var i=t.value;e&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update()}}catch(s){n.e(s)}finally{n.f()}var r,a=_createForOfIteratorHelper(this._popups);try{for(a.s();!(r=a.n()).done;){var o=r.value;!e||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}}catch(s){a.e(s)}finally{a.f()}}},{key:"_updateAverageElevation",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=function(e){return t.transform.averageElevation=e,t._update(!1),!0};if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);if((n||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){var r=this.transform.averageElevation,a=this.transform.sampleAverageElevation(),o=!1;this.transform.elevation&&(o=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(a)?a=0:this._averageElevationLastSampledAt=e;var s=Math.abs(r-a);if(s>1){if(this._isInitialLoad||o)return this._averageElevation.jumpTo(a),i(a);this._averageElevation.easeTo(a,e,300)}else if(s>1e-4)return this._averageElevation.jumpTo(a),i(a)}return!!this._averageElevation.isEasing(e)&&i(this._averageElevation.getValue(e))}},{key:"_authenticate",value:function(){var t=this;e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(n){if(n&&(n.message===e.AUTH_ERR_MSG||401===n.status)){var i=t.painter.context.gl;e.storeAuthState(i,!1),t._logoControl instanceof Wr&&t._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),t._silenceAuthErrors||t.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(){}))}},{key:"_updateTerrain",value:function(){var e=this._isDragging();this.painter.updateTerrain(this.style,e)}},{key:"_calculateSpeedIndex",value:function(){var e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());var n=this.painter.context.gl,i=n.createFramebuffer();function r(e){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);var t=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,t),t}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(r(e),t.canvasCopies.map(r),t.timeStamps)}},{key:"_canvasPixelComparison",value:function(e,t,n){for(var i=n[1]-n[0],r=e.length/4,a=0;a<t.length;a++){for(var o=t[a],s=0,l=0;l<o.length;l+=4)o[l]===e[l]&&o[l+1]===e[l+1]&&o[l+2]===e[l+2]&&o[l+3]===e[l+3]&&(s+=1);i+=(n[a+2]-n[a+1])*(1-s/r)}return i}},{key:"remove",value:function(){this._hash&&this._hash.remove();var t,n=_createForOfIteratorHelper(this._controls);try{for(n.s();!(t=n.n()).done;){t.value.onRemove(this)}}catch(r){n.e(r)}finally{n.f()}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1),e.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}},{key:"triggerRepaint",value:function(){this._triggerFrame(!0)}},{key:"_triggerFrame",value:function(t){var n=this;this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame((function(e){var t=!!n._renderNextFrame;n._frame=null,n._renderNextFrame=null,t&&n._render(e)})))}},{key:"_preloadTiles",value:function(t){var n=this,i=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(i,(function(e,n){return e._preloadTiles(t,n)}),(function(){n.triggerRepaint()})),this}},{key:"_onWindowOnline",value:function(){this._update()}},{key:"_onWindowResize",value:function(e){this._trackResize&&this.resize({originalEvent:e})._update()}},{key:"_onVisibilityChange",value:function(){"hidden"===e.window.document.visibilityState&&this._visibilityHidden++}},{key:"showTileBoundaries",get:function(){return!!this._showTileBoundaries},set:function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}},{key:"showTerrainWireframe",get:function(){return!!this._showTerrainWireframe},set:function(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}},{key:"speedIndexTiming",get:function(){return!!this._speedIndexTiming},set:function(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}},{key:"showPadding",get:function(){return!!this._showPadding},set:function(e){this._showPadding!==e&&(this._showPadding=e,this._update())}},{key:"showCollisionBoxes",get:function(){return!!this._showCollisionBoxes},set:function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}},{key:"showOverdrawInspector",get:function(){return!!this._showOverdrawInspector},set:function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}},{key:"repaint",get:function(){return!!this._repaint},set:function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}},{key:"vertices",get:function(){return!!this._vertices},set:function(e){this._vertices=e,this._update()}},{key:"showTileAABBs",get:function(){return!!this._showTileAABBs},set:function(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}},{key:"_setCacheLimits",value:function(t,n){e.setCacheLimits(t,n)}},{key:"version",get:function(){return e.version}}]),r}(qr),NavigationControl:function(){function t(n){var i=this;_classCallCheck(this,t),this.options=e.extend({},ia,n),this._container=a("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){i._map&&i._map.zoomIn({},{originalEvent:e})})),a("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){i._map&&i._map.zoomOut({},{originalEvent:e})})),a("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){var t=i._map;t&&(i.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=a("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}return _createClass(t,[{key:"_updateZoomButtons",value:function(){var e=this._map;if(e){var t=e.getZoom(),n=t===e.getMaxZoom(),i=t===e.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}}},{key:"_rotateCompassArrow",value:function(){var e=this,t=this._map;if(t){var n=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(t.transform.pitch,"deg) rotateZ(").concat(t.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(t.transform.angle*(180/Math.PI),"deg)");t._requestDomTask((function(){e._compassIcon&&(e._compassIcon.style.transform=n)}))}}},{key:"onAdd",value:function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ra(e,this._compass,this.options.visualizePitch)),this._container}},{key:"onRemove",value:function(){var e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}},{key:"_createButton",value:function(e,t){var n=a("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}},{key:"_setButtonTitle",value:function(e,t){if(this._map){var n=this._map._getUIString("NavigationControl."+t);e.setAttribute("aria-label",n),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}}}]),t}(),GeolocateControl:function(t){function n(t){var i;return _classCallCheck(this,n),(i=_callSuper(this,n)).options=e.extend({geolocation:e.window.navigator.geolocation},aa,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],_assertThisInitialized2(i)),i._updateMarkerRotationThrottled=Wi(i._updateMarkerRotation,20),i._numberOfWatches=0,i}return _inherits(n,t),_createClass(n,[{key:"onAdd",value:function(e){return this._map=e,this._container=a("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}},{key:"onRemove",value:function(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}},{key:"_checkGeolocationSupport",value:function(t){var n=this,i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!n.options.geolocation;n._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){return i("denied"!==e.state)})).catch((function(){return i()})):i()}},{key:"_isOutOfMapMaxBounds",value:function(e){var t=this._map.getMaxBounds(),n=e.coords;return!!t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}},{key:"_setErrorState",value:function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}},{key:"_onSuccess",value:function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}},{key:"_updateCamera",value:function(t){var n=new e.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=this._map.getBearing(),a=e.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),a,{geolocateSource:!0})}},{key:"_updateMarker",value:function(t){if(t){var n=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}},{key:"_updateCircleRadius",value:function(){var t=this._map.transform,n=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,i=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=i+"px",this._circleElement.style.height=i+"px"}},{key:"_onZoom",value:function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}},{key:"_updateMarkerRotation",value:function(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}},{key:"_onError",value:function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}},{key:"_finish",value:function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}},{key:"_setupUI",value:function(t){var n=this;if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=a("button","mapboxgl-ctrl-geolocate",this._container),a("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{var r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=a("div","mapboxgl-user-location"),this._dotElement.appendChild(a("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(a("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Yr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=a("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==n._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new e.Event("trackuserlocationend")))}))}}},{key:"_onDeviceOrientation",value:function(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}},{key:"trigger",value:function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}},{key:"_addDeviceOrientationListener",value:function(){var t=this,n=function(){e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",t._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&n()})).catch(console.error):n()}},{key:"_clearWatch",value:function(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}}]),n}(e.Evented),AttributionControl:Gr,ScaleControl:function(){function t(n){_classCallCheck(this,t),this.options=e.extend({},oa,n),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.bindAll(["_update","_setScale","setUnit"],this)}return _createClass(t,[{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_update",value:function(){var e=this.options.maxWidth||100,t=this._map,n=t._containerHeight/2,i=t._containerWidth/2-e/2,r=t.unproject([i,n]),a=t.unproject([i+e,n]),o=r.distanceTo(a);if("imperial"===this.options.unit){var s=3.2808*o;s>5280?this._setScale(e,s/5280,"mile"):this._setScale(e,s,"foot")}else"nautical"===this.options.unit?this._setScale(e,o/1852,"nautical-mile"):o>=1e3?this._setScale(e,o/1e3,"kilometer"):this._setScale(e,o,"meter")}},{key:"_setScale",value:function(e,t,n){var i=this;this._map._requestDomTask((function(){var r=function(e){var t=Math.pow(10,(""+Math.floor(e)).length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(n))}(t),a=r/t;i._container.innerHTML=i._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(i._language,{style:"unit",unitDisplay:"short",unit:n}).format(r):"".concat(r,"&nbsp;").concat(sa[n]),i._container.style.width=e*a+"px"}))}},{key:"onAdd",value:function(e){return this._map=e,this._language=e.getLanguage(),this._container=a("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}},{key:"onRemove",value:function(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}},{key:"_setLanguage",value:function(e){this._language=e,this._update()}},{key:"setUnit",value:function(e){this.options.unit=e,this._update()}}]),t}(),FullscreenControl:function(){function t(n){_classCallCheck(this,t),this._fullscreen=!1,n&&n.container&&(n.container instanceof e.window.HTMLElement?this._container=n.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}return _createClass(t,[{key:"onAdd",value:function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=a("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}},{key:"onRemove",value:function(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_checkFullscreenSupport",value:function(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}},{key:"_setupUI",value:function(){var t=this._fullscreenButton=a("button","mapboxgl-ctrl-fullscreen",this._controlContainer);a("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_updateTitle",value:function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}},{key:"_getTitle",value:function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}},{key:"_isFullscreen",value:function(){return this._fullscreen}},{key:"_changeIcon",value:function(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}},{key:"_onClickFullscreen",value:function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}}]),t}(),Popup:function(t){function n(t){var i;return _classCallCheck(this,n),(i=_callSuper(this,n)).options=e.extend(Object.create(Jr),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],_assertThisInitialized2(i)),i._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[]),i}return _inherits(n,t),_createClass(n,[{key:"addTo",value:function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}},{key:"isOpen",value:function(){return!!this._map}},{key:"remove",value:function(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);var t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.Event("close")),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();var n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}},{key:"trackPointer",value:function(){this._trackPointer=!0,this._pos=null,this._update();var e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}},{key:"getElement",value:function(){return this._container}},{key:"setText",value:function(t){return this.setDOMContent(e.window.document.createTextNode(t))}},{key:"setHTML",value:function(t){var n,i=e.window.document.createDocumentFragment(),r=e.window.document.createElement("body");for(r.innerHTML=t;n=r.firstChild;)i.appendChild(n);return this.setDOMContent(i)}},{key:"getMaxWidth",value:function(){return this._container&&this._container.style.maxWidth}},{key:"setMaxWidth",value:function(e){return this.options.maxWidth=e,this._update(),this}},{key:"setDOMContent",value:function(e){var t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=a("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){var n=this._closeButton=a("button","mapboxgl-popup-close-button",t);n.type="button",n.setAttribute("aria-label","Close popup"),n.setAttribute("aria-hidden","true"),n.innerHTML="&#215;",n.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}},{key:"addClassName",value:function(e){return this._classList.add(e),this._updateClassList(),this}},{key:"removeClassName",value:function(e){return this._classList.delete(e),this._updateClassList(),this}},{key:"setOffset",value:function(e){return this.options.offset=e,this._update(),this}},{key:"toggleClassName",value:function(e){var t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}},{key:"_onMouseEvent",value:function(e){this._update(e.point)}},{key:"_getAnchor",value:function(e){if(this.options.anchor)return this.options.anchor;var t=this._map,n=this._container,i=this._pos;if(!t||!n||!i)return"bottom";var r=n.offsetWidth,a=n.offsetHeight,o=i.x<r/2,s=i.x>t.transform.width-r/2;if(i.y+e<a)return o?"top-left":s?"top-right":"top";if(i.y>t.transform.height-a){if(o)return"bottom-left";if(s)return"bottom-right"}return o?"left":s?"right":"bottom"}},{key:"_updateClassList",value:function(){var e=this._container;if(e){var t=_toConsumableArray(this._classList);t.push("mapboxgl-popup"),this._anchor&&t.push("mapboxgl-popup-anchor-"+this._anchor),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}}},{key:"_update",value:function(t){var n=this,i=this._map,r=this._content;if(i&&(this._lngLat||this._trackPointer)&&r){var o=this._container;if(o||(o=this._container=a("div","mapboxgl-popup",i.getContainer()),this._tip=a("div","mapboxgl-popup-tip",o),o.appendChild(r)),this.options.maxWidth&&o.style.maxWidth!==this.options.maxWidth&&(o.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xr(this._lngLat,this._pos,i.transform)),!this._trackPointer||t){var s=this._pos=this._trackPointer&&t?t:i.project(this._lngLat),l=$r(this.options.offset),u=this._anchor=this._getAnchor(l.y),c=$r(this.options.offset,u),h=s.add(c).round();i._requestDomTask((function(){n._container&&u&&(n._container.style.transform="".concat(Kr[u]," translate(").concat(h.x,"px,").concat(h.y,"px)"))}))}if(!this._marker&&i._showingGlobe()){var d=e.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(d)}this._updateClassList()}}},{key:"_focusFirstElement",value:function(){if(this.options.focusAfterOpen&&this._container){var e=this._container.querySelector(Qr);e&&e.focus()}}},{key:"_onClose",value:function(){this.remove()}},{key:"_setOpacity",value:function(e){this._container&&(this._container.style.opacity=""+e),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}}]),n}(e.Evented),Marker:Yr,Style:Yt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:Li,Evented:e.Evented,config:e.config,prewarm:function(){Fe().acquire(Le)},clearPrewarmedResources:function(){var e=ze;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Le),ze=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Be.workerCount},set workerCount(e){Be.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return la})),n}()},"4b23":function(e,t,n){"use strict";n.r(t),n.d(t,"nanoid",(function(){return s})),n.d(t,"customAlphabet",(function(){return o})),n.d(t,"customRandom",(function(){return a})),n.d(t,"urlAlphabet",(function(){return i})),n.d(t,"random",(function(){return r}));var i="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",r=function(e){return crypto.getRandomValues(new Uint8Array(e))},a=function(e,t,n){var i=(2<<Math.log(e.length-1)/Math.LN2)-1,r=-~(1.6*i*t/e.length);return function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,o="";;)for(var s=n(r),l=r;l--;)if((o+=e[s[l]&i]||"").length===a)return o}},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:21;return a(e,t,r)},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")}),"")}},"5K5J":function(e,t,n){var i;i=function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function t(t){return t.match(e)||[]}function n(e){return{language:(e=t(e))[1]||"",extlang:e[2]||"",script:e[3]||"",region:e[4]||""}}function i(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!0})}function r(e,r,a){function o(n){return t(n)[e]||""}i(o,"pattern",r),i(n,a,o)}return r(1,/^[a-zA-Z]{2,3}$/,"language"),r(2,/^[a-zA-Z]{3}$/,"extlang"),r(3,/^[a-zA-Z]{4}$/,"script"),r(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),i(n,"split",(function(e){return t(e).filter((function(e,t){return e&&t}))})),n},e.exports?e.exports=i():this.subtag=i()},"5k+i":function(e,t){function n(){}n.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){var e={enableHighAccuracy:!0};return new Promise((function(t,n){window.navigator.geolocation.getCurrentPosition(t,n,e)}))}},e.exports=n},"73jG":function(e,t,n){"use strict";var i=n("jLWS");e.exports=function(e){var t,n=e.type||i.ERROR_HTTP;if(e.body)try{t=JSON.parse(e.body)}catch(a){t=e.body}else t=null;var r=e.message||null;r||("string"==typeof t?r=t:t&&"string"==typeof t.message?r=t.message:n===i.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=n,this.statusCode=e.statusCode||null,this.request=e.request,this.body=t}},"7fnu":function(e,t){function n(e){var t=e.address||"",n=e.text||"",i=e.place_name||"",r={address:i.split(",")[0],houseNumber:t,street:n,placeName:i};return e.context.forEach((function(e){var t=e.id.split(".")[0];r[t]=e.text})),r}e.exports={transformFeatureToGeolocationText:function(e,t){var i=n(e),r=["address","street","place","country"];if("function"==typeof t)return t(i);var a=r.indexOf(t);return(-1===a?r:r.slice(a)).reduce((function(e,t){return i[t]?(""!==e&&(e+=", "),e+i[t]):e}),"")},getAddressInfo:n,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},"9/5/":function(e,t){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,s="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,u=s||l||Function("return this")(),c=Object.prototype.toString,h=Math.max,d=Math.min,f=function(){return u.Date.now()};function p(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(p(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=p(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var s=r.test(e);return s||a.test(e)?o(e.slice(2),s?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var i,r,a,o,s,l,u=0,c=!1,v=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,a=r;return i=r=void 0,u=t,o=e.apply(a,n)}function _(e){return u=e,s=setTimeout(b,t),c?y(e):o}function x(e){var n=e-l;return void 0===l||n>=t||n<0||v&&e-u>=a}function b(){var e=f();if(x(e))return w(e);s=setTimeout(b,function(e){var n=t-(e-l);return v?d(n,a-(e-u)):n}(e))}function w(e){return s=void 0,g&&i?y(e):(i=r=void 0,o)}function k(){var e=f(),n=x(e);if(i=arguments,r=this,l=e,n){if(void 0===s)return _(l);if(v)return s=setTimeout(b,t),y(l)}return void 0===s&&(s=setTimeout(b,t)),o}return t=m(t)||0,p(n)&&(c=!!n.leading,a=(v="maxWait"in n)?h(m(n.maxWait)||0,t):a,g="trailing"in n?!!n.trailing:g),k.cancel=function(){void 0!==s&&clearTimeout(s),u=0,i=l=r=s=void 0},k.flush=function(){return void 0===s?o:w(f())},k}},"A1R+":function(e,t,n){"use strict";e.exports=r,e.exports.default=r;var i=n("U3f8");function r(e,t){if(!(this instanceof r))return new r(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function a(e,t,n){if(!n)return t.indexOf(e);for(var i=0;i<t.length;i++)if(n(e,t[i]))return i;return-1}function o(e,t){s(e,0,e.children.length,t,e)}function s(e,t,n,i,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a,o=t;o<n;o++)a=e.children[o],l(r,e.leaf?i(a):a);return r}function l(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,t,n,r,a){for(var o,s=[t,n];s.length;)(n=s.pop())-(t=s.pop())<=r||(o=t+Math.ceil((n-t)/r/2)*r,i(e,o,t,n,a),s.push(t,o,o,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],i=this.toBBox;if(!p(e,t))return n;for(var r,a,o,s,l=[];t;){for(r=0,a=t.children.length;r<a;r++)o=t.children[r],p(e,s=t.leaf?i(o):o)&&(t.leaf?n.push(o):f(e,s)?this._all(o,n):l.push(o));t=l.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!p(e,t))return!1;for(var i,r,a,o,s=[];t;){for(i=0,r=t.children.length;i<r;i++)if(a=t.children[i],p(e,o=t.leaf?n(a):a)){if(t.leaf||f(e,o))return!0;s.push(a)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var n,i,r,o,s=this.data,l=this.toBBox(e),u=[],c=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=c.pop(),o=!0),s.leaf&&-1!==(r=a(e,s.children,t)))return s.children.splice(r,1),u.push(s),this._condense(u),this;o||s.leaf||!f(s,l)?i?(n++,s=i.children[n],o=!1):s=null:(u.push(s),c.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,i){var r,a=n-t+1,s=this._maxEntries;if(a<=s)return o(r=m(e.slice(t,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(r=m([])).leaf=!1,r.height=i;var l,u,c,h,d=Math.ceil(a/s),f=d*Math.ceil(Math.sqrt(s));for(v(e,t,n,f,this.compareMinX),l=t;l<=n;l+=f)for(v(e,l,c=Math.min(l+f-1,n),d,this.compareMinY),u=l;u<=c;u+=d)h=Math.min(u+d-1,c),r.children.push(this._build(e,u,h,i-1));return o(r,this.toBBox),r},_chooseSubtree:function(e,t,n,i){for(var r,a,o,s,l,u,c,d,f,p;i.push(t),!t.leaf&&i.length-1!==n;){for(c=d=1/0,r=0,a=t.children.length;r<a;r++)l=h(o=t.children[r]),f=e,p=o,(u=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<d?(d=u,c=l<c?l:c,s=o):u===d&&l<c&&(c=l,s=o);t=s||t.children[0]}return t},_insert:function(e,t,n){var i=n?e:(0,this.toBBox)(e),r=[],a=this._chooseSubtree(i,this.data,t,r);for(a.children.push(e),l(a,i);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(i,r,t)},_split:function(e,t){var n=e[t],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var a=this._chooseSplitIndex(n,r,i),s=m(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var i,r,a,o,l,u,c,d,f,p,m,v,g,y;for(u=c=1/0,i=t;i<=n-t;i++)f=r=s(e,0,i,this.toBBox),p=a=s(e,i,n,this.toBBox),m=Math.max(f.minX,p.minX),v=Math.max(f.minY,p.minY),g=Math.min(f.maxX,p.maxX),y=Math.min(f.maxY,p.maxY),o=Math.max(0,g-m)*Math.max(0,y-v),l=h(r)+h(a),o<u?(u=o,d=i,c=l<c?l:c):o===u&&l<c&&(c=l,d=i);return d},_chooseSplitAxis:function(e,t,n){var i=e.leaf?this.compareMinX:u,r=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,n,i)<this._allDistMargin(e,t,n,r)&&e.children.sort(i)},_allDistMargin:function(e,t,n,i){e.children.sort(i);var r,a,o=this.toBBox,u=s(e,0,t,o),c=s(e,n-t,n,o),h=d(u)+d(c);for(r=t;r<n-t;r++)a=e.children[r],l(u,e.leaf?o(a):a),h+=d(u);for(r=n-t-1;r>=t;r--)a=e.children[r],l(c,e.leaf?o(a):a),h+=d(c);return h},_adjustParentBBoxes:function(e,t,n){for(var i=n;i>=0;i--)l(t[i],e)},_condense:function(e){for(var t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children).splice(t.indexOf(e[n]),1):this.clear():o(e[n],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},AxvH:function(e,t,n){"use strict";e.exports=function(e){return e?e.split(/,\s*</).reduce((function(e,t){var n=function(e){var t=e.match(/<?([^>]*)>(.*)/);if(!t)return null;var n=t[1],i=t[2].split(";"),r=null,a=i.reduce((function(e,t){var n=function(e){var t=e.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return t?{key:t[1],value:t[2]}:null}(t);return n?"rel"===n.key?(r||(r=n.value),e):(e[n.key]=n.value,e):e}),{});return r?{url:n,rel:r,params:a}:null}(t);return n?(n.rel.split(/\s+/).forEach((function(t){e[t]||(e[t]={url:n.url,params:n.params})})),e):e}),{}):{}}},Bi8L:function(e,t,n){"use strict";var i=n("R/WN");e.exports=i,"undefined"!=typeof window&&(window.Suggestions=i)},Cu2R:function(e,t,n){"use strict";var i=n("ncV3"),r=n("KXza");e.exports=function(e){return function(t){var n;n=i.prototype.isPrototypeOf(t)?t:r(t);var a=Object.create(e);return a.client=n,a}}},KXza:function(e,t,n){"use strict";var i=n("oGbY"),r=n("ncV3");function a(e){r.call(this,e)}(a.prototype=Object.create(r.prototype)).constructor=a,a.prototype.sendRequest=i.browserSend,a.prototype.abortRequest=i.browserAbort,e.exports=function(e){return new a(e)}},KtRk:function(e,t,n){"use strict";var i=n("U6jy"),r=n("pit/");e.exports=i(r,{file:function(e){if("undefined"!=typeof window){if(e instanceof global.Blob||e instanceof global.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof e&&void 0===e.pipe)return"Filename or Readable stream"},date:function(e){if("boolean"==typeof e)return"date";try{var t=new Date(e);if(t.getTime&&isNaN(t.getTime()))return"date"}catch(n){return"date"}},coordinates:function(e){return r.tuple(r.number,r.number)(e)},assertShape:function(e,t){return r.assert(r.strictShape(e),t)}})},LFDd:function(e,t,n){"use strict";var i=n("U6jy"),r=n("KtRk"),a=n("baNz"),o=n("eFQn"),s=n("Cu2R"),l={},u=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];l.forwardGeocode=function(e){r.assertShape({query:r.required(r.string),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),proximity:r.oneOf(r.coordinates,"ip"),types:r.arrayOf(r.oneOf(u)),autocomplete:r.boolean,bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),routing:r.boolean,fuzzyMatch:r.boolean,worldview:r.string})(e),e.mode=e.mode||"mapbox.places";var t=o(i({country:e.countries},a(e,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:a(e,["mode","query"]),query:t})},l.reverseGeocode=function(e){r.assertShape({query:r.required(r.coordinates),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),types:r.arrayOf(r.oneOf(u)),bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),reverseMode:r.oneOf("distance","score"),routing:r.boolean,worldview:r.string})(e),e.mode=e.mode||"mapbox.places";var t=o(i({country:e.countries},a(e,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:a(e,["mode","query"]),query:t})},e.exports=s(l)},"NkL+":function(e,t,n){"use strict";var i=Object.prototype.toString;e.exports=function(e){var t;return"[object Object]"===i.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))}},"P8+q":function(e,t,n){var i;e.exports=i={},i.simpleFilter=function(e,t){return t.filter((function(t){return i.test(e,t)}))},i.test=function(e,t){return null!==i.match(e,t)},i.match=function(e,t,n){var i,r=0,a=[],o=t.length,s=0,l=0,u=(n=n||{}).pre||"",c=n.post||"",h=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var d=0;d<o;d++)i=t[d],h[d]===e[r]?(i=u+i+c,r+=1,l+=1+l):l=0,s+=l,a[a.length]=i;return r===e.length?(s=h===e?1/0:s,{rendered:a.join(""),score:s}):null},i.filter=function(e,t,n){return t&&0!==t.length?"string"!=typeof e?t:(n=n||{},t.reduce((function(t,r,a,o){var s=r;n.extract&&(s=n.extract(r));var l=i.match(e,s,n);return null!=l&&(t[t.length]={string:l.rendered,score:l.score,index:a,original:r}),t}),[]).sort((function(e,t){return t.score-e.score||e.index-t.index}))):[]}},"R/WN":function(e,t,n){"use strict";var i=n("U6jy"),r=n("P8+q"),a=n("SX8C"),o=function(e,t,n){return this.options=i({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n=n||{}),this.el=e,this.data=t||[],this.list=new a(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(e){this.handleKeyUp(e.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(e){this.handleKeyDown(e)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(e){this.handlePaste(e)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};o.prototype.handleKeyUp=function(e){40!==e&&38!==e&&27!==e&&13!==e&&9!==e&&this.handleInputChange(this.el.value)},o.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},o.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},o.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout((function(){t.handleInputChange(e.target.value)}),100)}},o.prototype.handleInputChange=function(e){this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates((function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}).bind(this))},o.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},o.prototype.update=function(e){this.data=e,this.handleKeyUp()},o.prototype.clear=function(){this.data=[],this.list.clear()},o.prototype.normalize=function(e){return e.toLowerCase()},o.prototype.match=function(e,t){return e.indexOf(t)>-1},o.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},o.prototype.getCandidates=function(e){var t={pre:"<strong>",post:"</strong>",extract:(function(e){return this.getItemValue(e)}).bind(this)};e(this.options.filter?r.filter(this.query,this.data,t).map((function(e){return{original:e.original,string:this.render(e.original,e.string)}}).bind(this)):this.data.map((function(e){return{original:e,string:this.render(e)}}).bind(this)))},o.prototype.getItemValue=function(e){return e},o.prototype.render=function(e,t){if(t)return t;for(var n=this.getItemValue(e.original?e.original:e),i=this.normalize(n),r=i.lastIndexOf(this.query);r>-1;){var a=r+this.query.length;n=n.slice(0,r)+"<strong>"+n.slice(r,a)+"</strong>"+n.slice(a),r=i.slice(0,r).lastIndexOf(this.query)}return n},o.prototype.renderError=function(e){this.list.drawError(e)},e.exports=o},SX8C:function(e,t,n){"use strict";var i=function(e){return this.component=e,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};i.prototype.show=function(){this.element.style.display="block"},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.add=function(e){this.items.push(e)},i.prototype.clear=function(){this.items=[],this.active=0},i.prototype.isEmpty=function(){return!this.items.length},i.prototype.isVisible=function(){return"block"===this.element.style.display},i.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()}else this.hide()},i.prototype.drawItem=function(e,t){var n=document.createElement("li"),i=document.createElement("a");t&&(n.className+=" active"),i.innerHTML=e.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),n.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,e)}).bind(this))},i.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()},i.prototype.move=function(e){this.active=e,this.draw()},i.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},i.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},i.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()},e.exports=i},"Smn/":function(e,t,n){"use strict";e.exports=function(e,t){return Object.keys(e).reduce((function(n,i){return n[i]=t(i,e[i]),n}),{})}},SsYf:function(e,t){e.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},U3f8:function(e,t,n){e.exports=function(){"use strict";function e(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function t(e,t){return e<t?-1:e>t?1:0}return function(n,i,r,a,o){!function t(n,i,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(a,Math.floor(i+(s-l)*c/s+h)),o)}var d=n[i],f=r,p=a;for(e(n,r,i),o(n[a],d)>0&&e(n,r,a);f<p;){for(e(n,f,p),f++,p--;o(n[f],d)<0;)f++;for(;o(n[p],d)>0;)p--}0===o(n[r],d)?e(n,r,p):e(n,++p,a),p<=i&&(r=p+1),i<=p&&(a=p-1)}}(n,i,r||0,a||n.length-1,o||t)}}()},U6jy:function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i)n.call(i,r)&&(e[r]=i[r])}return e};var n=Object.prototype.hasOwnProperty},Vfn7:function(e,t,n){var i;!function(){"use strict";function r(e,t,n){var i=t.x,r=t.y,a=n.x-i,o=n.y-r;if(0!==a||0!==o){var s=((e.x-i)*a+(e.y-r)*o)/(a*a+o*o);s>1?(i=n.x,r=n.y):s>0&&(i+=a*s,r+=o*s)}return(a=e.x-i)*a+(o=e.y-r)*o}function a(e,t,n){if(e.length<=2)return e;var i=void 0!==t?t*t:1;return function(e,t){var n=e.length-1,i=[e[0]];return function e(t,n,i,a,o){for(var s,l=a,u=n+1;u<i;u++){var c=r(t[u],t[n],t[i]);c>l&&(s=u,l=c)}l>a&&(s-n>1&&e(t,n,s,a,o),o.push(t[s]),i-s>1&&e(t,s,i,a,o))}(e,0,n,t,i),i.push(e[n]),i}(e=n?e:function(e,t){for(var n,i,r,a,o,s=e[0],l=[s],u=1,c=e.length;u<c;u++)(a=(i=n=e[u]).x-(r=s).x)*a+(o=i.y-r.y)*o>t&&(l.push(n),s=n);return s!==n&&l.push(n),l}(e,i),i)}void 0===(i=(function(){return a}).call(t,n,t,e))||(e.exports=i)}()},WpKc:function(e,t,n){"use strict";var i=n("4b23").nanoid;function r(e){this.origin=e.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=e.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=e,this.send=this.send.bind(this),this.countries=e.countries?e.countries.split(","):null,this.types=e.types?e.types.split(","):null,this.bbox=e.bbox?e.bbox:null,this.language=e.language?e.language.split(","):null,this.limit=e.limit?+e.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(e),this.eventQueue=new Array,this.flushInterval=e.flushInterval||1e3,this.maxQueueSize=e.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}r.prototype={select:function(e,t){var n=this.getSelectedIndex(e,t),i=this.getEventPayload("search.select",t);if(i.resultIndex=n,i.resultPlaceName=e.place_name,i.resultId=e.id,(n!==this.lastSentIndex||i.queryString!==this.lastSentInput)&&-1!=n&&(this.lastSentIndex=n,this.lastSentInput=i.queryString,i.queryString))return this.push(i)},start:function(e){var t=this.getEventPayload("search.start",e);if(t.queryString)return this.push(t)},keyevent:function(e,t){if(e.key&&!e.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(e.keyCode)){var n=this.getEventPayload("search.keystroke",t);if(n.lastAction=e.key,n.queryString)return this.push(n)}},send:function(e,t){if(!this.enableEventLogging)return t?t():void 0;var n=this.getRequestOptions(e);this.request(n,(function(e){return e?this.handleError(e,t):t?t():void 0}).bind(this))},getRequestOptions:function(e){return Array.isArray(e)||(e=[e]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}},getEventPayload:function(e,t){var n;n=t.options.proximity?"object"==typeof t.options.proximity?[t.options.proximity.longitude,t.options.proximity.latitude]:"ip"===t.options.proximity?[999,999]:t.options.proximity:null;var i=t._map?t._map.getZoom():void 0,r={event:e,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:t.options.autocomplete,fuzzyMatch:t.options.fuzzyMatch,proximity:n,limit:t.options.limit,routing:t.options.routing,worldview:t.options.worldview,mapZoom:i,keyboardLocale:this.locale};return r.queryString="search.select"===e?t.inputString:"search.select"!=e&&t._inputEl?t._inputEl.value:t.inputString,r},request:function(e,t){var n=new XMLHttpRequest;for(var i in n.onreadystatechange=function(){if(4==this.readyState)return t(204==this.status?null:this.statusText)},n.open(e.method,e.host+"/"+e.path,!0),e.headers)n.setRequestHeader(i,e.headers[i]);n.send(e.body)},handleError:function(e,t){if(t)return t(e)},generateSessionID:function(){return i()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(e,t){if(t._typeahead){var n=e.id;return t._typeahead.data.map((function(e){return e.id})).indexOf(n)}},shouldEnableLogging:function(e){return!(!1===e.enableEventLogging||e.origin&&"https://api.mapbox.com"!==e.origin||e.localGeocoder||e.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(e,t){this.eventQueue.push(e),(this.eventQueue.length>=this.maxQueueSize||t)&&this.flush()},remove:function(){this.flush()}},e.exports=r},YI60:function(e,t,n){"use strict";var i=n("aqBw"),r={};function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){if(r[e])return r[e];var t=e.split("."),n=t[0],o=t[1];if(!o)throw new Error("Invalid token");var s=function(e){try{return JSON.parse(i.decode(e))}catch(t){throw new Error("Invalid token")}}(o),l={usage:n,user:s.u};return a(s,"a")&&(l.authorization=s.a),a(s,"exp")&&(l.expires=1e3*s.exp),a(s,"iat")&&(l.created=1e3*s.iat),a(s,"scopes")&&(l.scopes=s.scopes),a(s,"client")&&(l.client=s.client),a(s,"ll")&&(l.lastLogin=s.ll),a(s,"iu")&&(l.impersonator=s.iu),r[e]=l,l}},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},aqBw:function(e,t,n){(function(e){var i;!function(r){"object"==typeof global&&global;var a=function(e){this.message=e};(a.prototype=new Error).name="InvalidCharacterError";var o=function(e){throw new a(e)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=/[\t\n\f\r ]/g,u={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&o("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,i,r,a=e.length%3,l="",u=-1,c=e.length-a;++u<c;)t=e.charCodeAt(u)<<16,n=e.charCodeAt(++u)<<8,i=e.charCodeAt(++u),l+=s.charAt((r=t+n+i)>>18&63)+s.charAt(r>>12&63)+s.charAt(r>>6&63)+s.charAt(63&r);return 2==a?(t=e.charCodeAt(u)<<8,n=e.charCodeAt(++u),l+=s.charAt((r=t+n)>>10)+s.charAt(r>>4&63)+s.charAt(r<<2&63)+"="):1==a&&(r=e.charCodeAt(u),l+=s.charAt(r>>2)+s.charAt(r<<4&63)+"=="),l},decode:function(e){var t=(e=String(e).replace(l,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&o("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,a="",u=-1;++u<t;)i=s.indexOf(e.charAt(u)),n=r%4?64*n+i:i,r++%4&&(a+=String.fromCharCode(255&n>>(-2*r&6)));return a},version:"0.1.0"};void 0===(i=(function(){return u}).call(t,n,t,e))||(e.exports=i)}()}).call(this,n("YuTi")(e))},baNz:function(e,t,n){"use strict";e.exports=function(e,t){var n=function(e,n){return-1!==t.indexOf(e)&&void 0!==n};return"function"==typeof t&&(n=t),Object.keys(e).filter((function(t){return n(t,e[t])})).reduce((function(t,n){return t[n]=e[n],t}),{})}},cRm7:function(e,t,n){"use strict";var i=n("AxvH");function r(e,t){this.request=e,this.headers=t.headers,this.rawBody=t.body,this.statusCode=t.statusCode;try{this.body=JSON.parse(t.body||"{}")}catch(n){this.body=t.body}this.links=i(this.headers.link)}r.prototype.hasNextPage=function(){return!!this.links.next},r.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},e.exports=r},cryX:function(e,t,n){"use strict";e.exports=function(e){var t={};return e?(e.trim().split(/[\r|\n]+/).forEach((function(e){var n=function(e){var t=e.indexOf(":");return{name:e.substring(0,t).trim().toLowerCase(),value:e.substring(t+1).trim()}}(e);t[n.name]=n.value})),t):t}},d0rS:function(e,t,n){"use strict";function i(e){return Array.isArray(e)?e.map(encodeURIComponent).join(","):encodeURIComponent(String(e))}function r(e,t,n){if(!1===n||null===n)return e;var r=/\?/.test(e)?"&":"?",a=encodeURIComponent(t);return void 0!==n&&""!==n&&!0!==n&&(a+="="+i(n)),""+e+r+a}e.exports={appendQueryObject:function(e,t){if(!t)return e;var n=e;return Object.keys(t).forEach((function(e){var i=t[e];void 0!==i&&(Array.isArray(i)&&(i=i.filter((function(e){return null!=e})).join(",")),n=r(n,e,i))})),n},appendQueryParam:r,prependOrigin:function(e,t){if(!t)return e;if("http"===e.slice(0,4))return e;var n="/"===e[0]?"":"/";return""+t.replace(/\/$/,"")+n+e},interpolateRouteParams:function(e,t){return t?e.replace(/\/:([a-zA-Z0-9]+)/g,(function(e,n){var r=t[n];if(void 0===r)throw new Error("Unspecified route parameter "+n);return"/"+i(r)})):e}}},eFQn:function(e,t,n){"use strict";var i=n("Smn/");e.exports=function(e){return i(e,(function(e,t){return"boolean"==typeof t?JSON.stringify(t):t}))}},iFvi:function(e,t,n){"use strict";var i=n("Bi8L"),r=n("9/5/"),a=n("U6jy"),o=n("+qE3").EventEmitter,s=n("SsYf"),l=n("0KjW"),u=n("LFDd"),c=n("WpKc"),h=n("/5w7"),d=n("5K5J"),f=n("5k+i"),p=n("7fnu");function m(e){this._eventEmitter=new o,this.options=a({},this.options,e),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new f}m.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(e){return e.place_name},render:function(e){var t=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"}},addTo:function(e){function t(e,t){if(!document.body.contains(t))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var n=e.onAdd();t.appendChild(n)}if(e._controlContainer)e.addControl(this);else if(e instanceof HTMLElement)t(this,e);else{if("string"!=typeof e)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");var n=document.querySelectorAll(e);if(0===n.length)throw new Error("Element ",e,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,n[0])}},onAdd:function(e){if(e&&"string"!=typeof e&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=u(l({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new c(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",r(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(e){this.eventManager.keyevent(e,this)}).bind(this));var a=document.createElement("div");a.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),a.appendChild(this._clearEl),a.appendChild(this._loadingEl),t.appendChild(n),t.appendChild(this._inputEl),t.appendChild(a),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var s=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(s),a.appendChild(this._geolocateEl),this._showGeolocateButton()}var h=this._typeahead=new i(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),h.getItemValue=this.options.getItemValue;var d,f=h.list.draw,p=this._footerNode=((d=document.createElement("div")).className="mapboxgl-ctrl-geocoder--powered-by",d.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',d);return h.list.draw=function(){f.call(this),p.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),p.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(p)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),t},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(e){this._hideLoadingIcon();var t={geometry:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]}};this._handleMarker(t),this._fly(t),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(t),this._showClearButton(),this.fresh=!1;var n={limit:1,language:[this.options.language],query:t.geometry.coordinates,types:["address"]};this.options.localGeocoderOnly?(this._setInputValue(t.geometry.coordinates[0]+","+t.geometry.coordinates[1]),this._eventEmitter.emit("result",{result:t})):this.geocoderService.reverseGeocode(n).send().then((function(e){var n=e.body.features[0];if(n){var i=p.transformFeatureToGeolocationText(n,this.options.addressAccuracy);this._setInputValue(i),n.user_coordinates=t.geometry.coordinates,this._eventEmitter.emit("result",{result:n})}else this._eventEmitter.emit("result",{result:{user_coordinates:t.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(e){1===e.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+e),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),n.innerHTML=t,n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(e){this._inputEl.value=e,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this._geocode(t)},_onKeyDown:function(e){var t=27,n=9;if(e.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(e),this._inputEl.blur();var i=e.target&&e.target.shadowRoot?e.target.shadowRoot.activeElement:e.target;if(!i||!i.value)return this.fresh=!0,e.keyCode!==n&&this.clear(e),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),e.metaKey||-1!==[n,t,37,39,13,38,40].indexOf(e.keyCode)||i.value.length>=this.options.minLength&&this._geocode(i.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()},_onChange:function(){var e=this._typeahead.selected;e&&JSON.stringify(e)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(e),this.options.marker&&this._mapboxgl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._eventEmitter.emit("result",{result:e}),this.eventManager.select(e,this))},_fly:function(e){var t;if(e.properties&&s[e.properties.short_code])t=a({},this.options.flyTo),this._map&&this._map.fitBounds(s[e.properties.short_code].bbox,t);else if(e.bbox){var n=e.bbox;t=a({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],t)}else t=a({},{zoom:this.options.zoom},this.options.flyTo),e.center?t.center=e.center:e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&(t.center=e.geometry.coordinates),this._map&&this._map.flyTo(t)},_requestType:function(e,t){return e.localGeocoderOnly?1:e.reverseGeocode&&p.REVERSE_GEOCODE_COORD_RGX.test(t)?2:0},_setupConfig:function(e,t){var n=/[\s,]+/,i=this,r=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce((function(e,t){return null==i.options[t]||(e[t]=["countries","types","language"].indexOf(t)>-1?i.options[t].split(n):i.options[t],"proximity"===t&&"number"==typeof i.options[t].longitude&&"number"==typeof i.options[t].latitude&&(e[t]=[i.options[t].longitude,i.options[t].latitude])),e}),{});switch(e){case 2:var o=t.split(n).map((function(e){return parseFloat(e,10)}));i.options.flipCoordinates||o.reverse(),r=a(r,{query:o,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach((function(e){e in r&&delete r[e]}));break;case 0:var s=t.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(s)&&(t=t.replace(/,/g," ")),r=a(r,{query:t})}return r},_geocode:function(e){this.inputString=e,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:e});var t,n=this._requestType(this.options,e),i=this._setupConfig(n,e);switch(n){case 1:t=Promise.resolve();break;case 0:t=this.geocoderService.forwardGeocode(i).send();break;case 2:t=this.geocoderService.reverseGeocode(i).send()}var r=this.options.localGeocoder&&this.options.localGeocoder(e)||[],a=[],o=null;return t.catch((function(e){o=e}).bind(this)).then((function(t){this._hideLoadingIcon();var n={};return t?"200"==t.statusCode&&((n=t.body).request=t.request,n.headers=t.headers):n={type:"FeatureCollection",features:[]},n.config=i,this.fresh&&(this.eventManager.start(this),this.fresh=!1),n.features=n.features?r.concat(n.features):r,this.options.externalGeocoder?(a=this.options.externalGeocoder(e,n.features)||Promise.resolve([])).then((function(e){return n.features=n.features?e.concat(n.features):e,n}),(function(){return n})):n}).bind(this)).then((function(e){if(o)throw o;this.options.filter&&e.features.length&&(e.features=e.features.filter(this.options.filter)),e.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",e),this._typeahead.update(e.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",e))}).bind(this)).catch((function(e){this._hideLoadingIcon(),this._hideAttribution(),r.length&&this.options.localGeocoder||a.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(r)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:r}),this._eventEmitter.emit("error",{error:e})}).bind(this)),t},_clear:function(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(e){this._clear(e),this._inputEl.focus()},_clearOnBlur:function(e){e.relatedTarget&&this._clear(e)},_onQueryResult:function(e){var t=e.body;if(t.features.length){var n=t.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity)if(this._map.getZoom()>9){var e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(e){return this._geocode(e).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var e=this.options.language.split(",")[0],t=d.language(e),n=h.placeholder[t];if(n)return n}return"Search"},setInput:function(e,t){return void 0===t&&(t=!1),this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&(t?this._geocode(e):this._onChange()),this},setProximity:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.options.proximity=e,t&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(e){return e&&"function"==typeof e&&(this._typeahead.render=e),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(e){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=e||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(e){return this.options.zoom=e,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(e){return this.options.flyTo=e,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(e){return this.options.placeholder=e||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(e){return this.options.bbox=e,this},getCountries:function(){return this.options.countries},setCountries:function(e){return this.options.countries=e,this},getTypes:function(){return this.options.types},setTypes:function(e){return this.options.types=e,this},getMinLength:function(){return this.options.minLength},setMinLength:function(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this},getLimit:function(){return this.options.limit},setLimit:function(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this},getFilter:function(){return this.options.filter},setFilter:function(e){return this.options.filter=e,this},setOrigin:function(e){return this.options.origin=e,this.geocoderService=u(l({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(e){return this.options.accessToken=e,this.geocoderService=u(l({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(e){return this.options.autocomplete=e,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(e){return this.options.fuzzyMatch=e,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(e){return this.options.routing=e,this},getRouting:function(){return this.options.routing},setWorldview:function(e){return this.options.worldview=e,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(e){if(this._map){this._removeMarker();var t=a({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(t),e.center?this.mapMarker.setLngLat(e.center).addTo(this._map):e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(e,t){return this._eventEmitter.on(e,t),this},off:function(e,t){return this._eventEmitter.removeListener(e,t),this.eventManager.remove(),this}},e.exports=m},jLWS:function(e,t,n){"use strict";e.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},ncV3:function(e,t,n){"use strict";var i=n("YI60"),r=n("2+Hy"),a=n("jLWS");function o(e){if(!e||!e.accessToken)throw new Error("Cannot create a client without an access token");i(e.accessToken),this.accessToken=e.accessToken,this.origin=e.origin||a.API_ORIGIN}o.prototype.createRequest=function(e){return new r(this,e)},e.exports=o},oGbY:function(e,t,n){"use strict";var i=n("cRm7"),r=n("73jG"),a=n("jLWS"),o=n("cryX"),s={};function l(e){var t=e.total,n=e.loaded;return{total:t,transferred:n,percent:100*n/t}}function u(e,t){return new Promise((function(n,i){t.onprogress=function(t){e.emitter.emit(a.EVENT_PROGRESS_DOWNLOAD,l(t))};var o=e.file;o&&(t.upload.onprogress=function(t){e.emitter.emit(a.EVENT_PROGRESS_UPLOAD,l(t))}),t.onerror=function(e){i(e)},t.onabort=function(){var t=new r({request:e,type:a.ERROR_REQUEST_ABORTED});i(t)},t.onload=function(){if(delete s[e.id],t.status<200||t.status>=400){var a=new r({request:e,body:t.response,statusCode:t.status});i(a)}else n(t)};var u=e.body;"string"==typeof u?t.send(u):u?t.send(JSON.stringify(u)):o?t.send(o):t.send(),s[e.id]=t})).then((function(t){return function(e,t){return new i(e,{body:t.response,headers:o(t.getAllResponseHeaders()),statusCode:t.status})}(e,t)}))}function c(e,t){var n=e.url(t),i=new window.XMLHttpRequest;return i.open(e.method,n),Object.keys(e.headers).forEach((function(t){i.setRequestHeader(t,e.headers[t])})),i}e.exports={browserAbort:function(e){var t=s[e.id];t&&(t.abort(),delete s[e.id])},sendRequestXhr:u,browserSend:function(e){return Promise.resolve().then((function(){var t=c(e,e.client.accessToken);return u(e,t)}))},createRequestXhr:c}},"pit/":function(e,t,n){"use strict";var i=n("NkL+"),r=n("U6jy"),a={};function o(e){var t=Array.isArray(e);return function(n){var i=s(a.plainArray,n);if(i)return i;if(t&&n.length!==e.length)return"an array with "+e.length+" items";for(var r=0;r<n.length;r++)if(i=s(t?e[r]:e,n[r]))return[r].concat(i)}}function s(e,t){if(null!=t||e.hasOwnProperty("__required")){var n=e(t);return n?Array.isArray(n)?n:[n]:void 0}}function l(e,t){var n=e.length,i=e[n-1],a=e.slice(0,n-1);return 0===a.length&&(a=["value"]),t=r(t,{path:a}),"function"==typeof i?i(t):c(t,function(e){return"must be "+(/^an? /.test(t=e)?t:/^[aeiou]/i.test(t)?"an "+t:/^[a-z]/i.test(t)?"a "+t:t)+".";var t}(i))}function u(e){return e.length<2?e[0]:2===e.length?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e.slice(-1)}function c(e,t){return(h(e.path)?"Item at position ":"")+e.path.join(".")+" "+t}function h(e){return"number"==typeof e[e.length-1]||"number"==typeof e[0]}a.assert=function(e,t){return t=t||{},function(n){var i=s(e,n);if(i){var r=l(i,t);throw t.apiName&&(r=t.apiName+": "+r),new Error(r)}}},a.shape=function(e){var t,n=(t=e,Object.keys(t||{}).map((function(e){return{key:e,value:t[e]}})));return function(e){var t,i=s(a.plainObject,e);if(i)return i;for(var r=[],o=0;o<n.length;o++)(i=s(n[o].value,e[t=n[o].key]))&&r.push([t].concat(i));return r.length<2?r[0]:function(e){r=r.map((function(t){return"- "+t[0]+": "+l(t,e).split("\n").join("\n  ")}));var t=e.path.join(".");return"The following properties"+("value"===t?"":" of "+t)+" have invalid values:\n  "+r.join("\n  ")}}},a.strictShape=function(e){var t=a.shape(e);return function(n){var i=t(n);if(i)return i;var r=Object.keys(n).reduce((function(t,n){return void 0===e[n]&&t.push(n),t}),[]);return 0!==r.length?function(){return"The following keys are invalid: "+r.join(", ")}:void 0}},a.arrayOf=function(e){return o(e)},a.tuple=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return o(e)},a.required=function(e){function t(t){return null==t?function(e){return c(e,h(e.path)?"cannot be undefined/null.":"is required.")}:e.apply(this,arguments)}return t.__required=!0,t},a.oneOfType=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(t){var n=e.map((function(e){return s(e,t)})).filter(Boolean);if(n.length===e.length)return n.every((function(e){return 1===e.length&&"string"==typeof e[0]}))?u(n.map((function(e){return e[0]}))):n.reduce((function(e,t){return t.length>e.length?t:e}))}},a.equal=function(e){return function(t){if(t!==e)return JSON.stringify(e)}},a.oneOf=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),t=e.map((function(e){return a.equal(e)}));return a.oneOfType.apply(this,t)},a.range=function(e){var t=e[0],n=e[1];return function(e){if(s(a.number,e)||e<t||e>n)return"number between "+t+" & "+n+" (inclusive)"}},a.any=function(){},a.boolean=function(e){if("boolean"!=typeof e)return"boolean"},a.number=function(e){if("number"!=typeof e)return"number"},a.plainArray=function(e){if(!Array.isArray(e))return"array"},a.plainObject=function(e){if(!i(e))return"object"},a.string=function(e){if("string"!=typeof e)return"string"},a.func=function(e){if("function"!=typeof e)return"function"},a.validate=s,a.processMessage=l,e.exports=a},uhBA:function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function a(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,i,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(r=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=this._events[r?r+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,i=t.length,a=new Array(i);n<i;n++)a[n]=t[n].fn;return a},u.prototype.listenerCount=function(e){var t=this._events[r?r+e:e];return t?t.fn?1:t.length:0},u.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||l(this,a);else{for(var s=0,u=[],c=o.length;s<c;s++)(o[s].fn!==t||i&&!o[s].once||n&&o[s].context!==n)&&u.push(o[s]);u.length?this._events[a]=1===u.length?u[0]:u:l(this,a)}return this},u.prototype.removeAllListeners=function(e){var t;return e?this._events[t=r?r+e:e]&&l(this,t):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u},zUnb:function(e,t,n){"use strict";var i=_regeneratorRuntime().mark(lJ);n.r(t);var r={};function a(e){return"function"==typeof e}n.r(r),n.d(r,"BlobServiceProperties",(function(){return zU})),n.d(r,"Logging",(function(){return LU})),n.d(r,"RetentionPolicy",(function(){return BU})),n.d(r,"Metrics",(function(){return FU})),n.d(r,"CorsRule",(function(){return jU})),n.d(r,"StaticWebsite",(function(){return HU})),n.d(r,"StorageError",(function(){return VU})),n.d(r,"BlobServiceStatistics",(function(){return UU})),n.d(r,"GeoReplication",(function(){return qU})),n.d(r,"ListContainersSegmentResponse",(function(){return GU})),n.d(r,"ContainerItem",(function(){return WU})),n.d(r,"ContainerProperties",(function(){return ZU})),n.d(r,"KeyInfo",(function(){return XU})),n.d(r,"UserDelegationKey",(function(){return KU})),n.d(r,"FilterBlobSegment",(function(){return YU})),n.d(r,"FilterBlobItem",(function(){return JU})),n.d(r,"BlobTags",(function(){return QU})),n.d(r,"BlobTag",(function(){return $U})),n.d(r,"SignedIdentifier",(function(){return eq})),n.d(r,"AccessPolicy",(function(){return tq})),n.d(r,"ListBlobsFlatSegmentResponse",(function(){return nq})),n.d(r,"BlobFlatListSegment",(function(){return iq})),n.d(r,"BlobItemInternal",(function(){return rq})),n.d(r,"BlobName",(function(){return aq})),n.d(r,"BlobPropertiesInternal",(function(){return oq})),n.d(r,"ListBlobsHierarchySegmentResponse",(function(){return sq})),n.d(r,"BlobHierarchyListSegment",(function(){return lq})),n.d(r,"BlobPrefix",(function(){return uq})),n.d(r,"BlockLookupList",(function(){return cq})),n.d(r,"BlockList",(function(){return hq})),n.d(r,"Block",(function(){return dq})),n.d(r,"PageList",(function(){return fq})),n.d(r,"PageRange",(function(){return pq})),n.d(r,"ClearRange",(function(){return mq})),n.d(r,"QueryRequest",(function(){return vq})),n.d(r,"QuerySerialization",(function(){return gq})),n.d(r,"QueryFormat",(function(){return yq})),n.d(r,"DelimitedTextConfiguration",(function(){return _q})),n.d(r,"JsonTextConfiguration",(function(){return xq})),n.d(r,"ArrowConfiguration",(function(){return bq})),n.d(r,"ArrowField",(function(){return wq})),n.d(r,"ServiceSetPropertiesHeaders",(function(){return kq})),n.d(r,"ServiceSetPropertiesExceptionHeaders",(function(){return Cq})),n.d(r,"ServiceGetPropertiesHeaders",(function(){return Sq})),n.d(r,"ServiceGetPropertiesExceptionHeaders",(function(){return Tq})),n.d(r,"ServiceGetStatisticsHeaders",(function(){return Eq})),n.d(r,"ServiceGetStatisticsExceptionHeaders",(function(){return Pq})),n.d(r,"ServiceListContainersSegmentHeaders",(function(){return Mq})),n.d(r,"ServiceListContainersSegmentExceptionHeaders",(function(){return Iq})),n.d(r,"ServiceGetUserDelegationKeyHeaders",(function(){return Aq})),n.d(r,"ServiceGetUserDelegationKeyExceptionHeaders",(function(){return Rq})),n.d(r,"ServiceGetAccountInfoHeaders",(function(){return Oq})),n.d(r,"ServiceGetAccountInfoExceptionHeaders",(function(){return Nq})),n.d(r,"ServiceSubmitBatchHeaders",(function(){return Dq})),n.d(r,"ServiceSubmitBatchExceptionHeaders",(function(){return zq})),n.d(r,"ServiceFilterBlobsHeaders",(function(){return Lq})),n.d(r,"ServiceFilterBlobsExceptionHeaders",(function(){return Bq})),n.d(r,"ContainerCreateHeaders",(function(){return Fq})),n.d(r,"ContainerCreateExceptionHeaders",(function(){return jq})),n.d(r,"ContainerGetPropertiesHeaders",(function(){return Hq})),n.d(r,"ContainerGetPropertiesExceptionHeaders",(function(){return Vq})),n.d(r,"ContainerDeleteHeaders",(function(){return Uq})),n.d(r,"ContainerDeleteExceptionHeaders",(function(){return qq})),n.d(r,"ContainerSetMetadataHeaders",(function(){return Gq})),n.d(r,"ContainerSetMetadataExceptionHeaders",(function(){return Wq})),n.d(r,"ContainerGetAccessPolicyHeaders",(function(){return Zq})),n.d(r,"ContainerGetAccessPolicyExceptionHeaders",(function(){return Xq})),n.d(r,"ContainerSetAccessPolicyHeaders",(function(){return Kq})),n.d(r,"ContainerSetAccessPolicyExceptionHeaders",(function(){return Yq})),n.d(r,"ContainerRestoreHeaders",(function(){return Jq})),n.d(r,"ContainerRestoreExceptionHeaders",(function(){return Qq})),n.d(r,"ContainerRenameHeaders",(function(){return $q})),n.d(r,"ContainerRenameExceptionHeaders",(function(){return eG})),n.d(r,"ContainerSubmitBatchHeaders",(function(){return tG})),n.d(r,"ContainerSubmitBatchExceptionHeaders",(function(){return nG})),n.d(r,"ContainerFilterBlobsHeaders",(function(){return iG})),n.d(r,"ContainerFilterBlobsExceptionHeaders",(function(){return rG})),n.d(r,"ContainerAcquireLeaseHeaders",(function(){return aG})),n.d(r,"ContainerAcquireLeaseExceptionHeaders",(function(){return oG})),n.d(r,"ContainerReleaseLeaseHeaders",(function(){return sG})),n.d(r,"ContainerReleaseLeaseExceptionHeaders",(function(){return lG})),n.d(r,"ContainerRenewLeaseHeaders",(function(){return uG})),n.d(r,"ContainerRenewLeaseExceptionHeaders",(function(){return cG})),n.d(r,"ContainerBreakLeaseHeaders",(function(){return hG})),n.d(r,"ContainerBreakLeaseExceptionHeaders",(function(){return dG})),n.d(r,"ContainerChangeLeaseHeaders",(function(){return fG})),n.d(r,"ContainerChangeLeaseExceptionHeaders",(function(){return pG})),n.d(r,"ContainerListBlobFlatSegmentHeaders",(function(){return mG})),n.d(r,"ContainerListBlobFlatSegmentExceptionHeaders",(function(){return vG})),n.d(r,"ContainerListBlobHierarchySegmentHeaders",(function(){return gG})),n.d(r,"ContainerListBlobHierarchySegmentExceptionHeaders",(function(){return yG})),n.d(r,"ContainerGetAccountInfoHeaders",(function(){return _G})),n.d(r,"ContainerGetAccountInfoExceptionHeaders",(function(){return xG})),n.d(r,"BlobDownloadHeaders",(function(){return bG})),n.d(r,"BlobDownloadExceptionHeaders",(function(){return wG})),n.d(r,"BlobGetPropertiesHeaders",(function(){return kG})),n.d(r,"BlobGetPropertiesExceptionHeaders",(function(){return CG})),n.d(r,"BlobDeleteHeaders",(function(){return SG})),n.d(r,"BlobDeleteExceptionHeaders",(function(){return TG})),n.d(r,"BlobUndeleteHeaders",(function(){return EG})),n.d(r,"BlobUndeleteExceptionHeaders",(function(){return PG})),n.d(r,"BlobSetExpiryHeaders",(function(){return MG})),n.d(r,"BlobSetExpiryExceptionHeaders",(function(){return IG})),n.d(r,"BlobSetHttpHeadersHeaders",(function(){return AG})),n.d(r,"BlobSetHttpHeadersExceptionHeaders",(function(){return RG})),n.d(r,"BlobSetImmutabilityPolicyHeaders",(function(){return OG})),n.d(r,"BlobSetImmutabilityPolicyExceptionHeaders",(function(){return NG})),n.d(r,"BlobDeleteImmutabilityPolicyHeaders",(function(){return DG})),n.d(r,"BlobDeleteImmutabilityPolicyExceptionHeaders",(function(){return zG})),n.d(r,"BlobSetLegalHoldHeaders",(function(){return LG})),n.d(r,"BlobSetLegalHoldExceptionHeaders",(function(){return BG})),n.d(r,"BlobSetMetadataHeaders",(function(){return FG})),n.d(r,"BlobSetMetadataExceptionHeaders",(function(){return jG})),n.d(r,"BlobAcquireLeaseHeaders",(function(){return HG})),n.d(r,"BlobAcquireLeaseExceptionHeaders",(function(){return VG})),n.d(r,"BlobReleaseLeaseHeaders",(function(){return UG})),n.d(r,"BlobReleaseLeaseExceptionHeaders",(function(){return qG})),n.d(r,"BlobRenewLeaseHeaders",(function(){return GG})),n.d(r,"BlobRenewLeaseExceptionHeaders",(function(){return WG})),n.d(r,"BlobChangeLeaseHeaders",(function(){return ZG})),n.d(r,"BlobChangeLeaseExceptionHeaders",(function(){return XG})),n.d(r,"BlobBreakLeaseHeaders",(function(){return KG})),n.d(r,"BlobBreakLeaseExceptionHeaders",(function(){return YG})),n.d(r,"BlobCreateSnapshotHeaders",(function(){return JG})),n.d(r,"BlobCreateSnapshotExceptionHeaders",(function(){return QG})),n.d(r,"BlobStartCopyFromURLHeaders",(function(){return $G})),n.d(r,"BlobStartCopyFromURLExceptionHeaders",(function(){return eW})),n.d(r,"BlobCopyFromURLHeaders",(function(){return tW})),n.d(r,"BlobCopyFromURLExceptionHeaders",(function(){return nW})),n.d(r,"BlobAbortCopyFromURLHeaders",(function(){return iW})),n.d(r,"BlobAbortCopyFromURLExceptionHeaders",(function(){return rW})),n.d(r,"BlobSetTierHeaders",(function(){return aW})),n.d(r,"BlobSetTierExceptionHeaders",(function(){return oW})),n.d(r,"BlobGetAccountInfoHeaders",(function(){return sW})),n.d(r,"BlobGetAccountInfoExceptionHeaders",(function(){return lW})),n.d(r,"BlobQueryHeaders",(function(){return uW})),n.d(r,"BlobQueryExceptionHeaders",(function(){return cW})),n.d(r,"BlobGetTagsHeaders",(function(){return hW})),n.d(r,"BlobGetTagsExceptionHeaders",(function(){return dW})),n.d(r,"BlobSetTagsHeaders",(function(){return fW})),n.d(r,"BlobSetTagsExceptionHeaders",(function(){return pW})),n.d(r,"PageBlobCreateHeaders",(function(){return mW})),n.d(r,"PageBlobCreateExceptionHeaders",(function(){return vW})),n.d(r,"PageBlobUploadPagesHeaders",(function(){return gW})),n.d(r,"PageBlobUploadPagesExceptionHeaders",(function(){return yW})),n.d(r,"PageBlobClearPagesHeaders",(function(){return _W})),n.d(r,"PageBlobClearPagesExceptionHeaders",(function(){return xW})),n.d(r,"PageBlobUploadPagesFromURLHeaders",(function(){return bW})),n.d(r,"PageBlobUploadPagesFromURLExceptionHeaders",(function(){return wW})),n.d(r,"PageBlobGetPageRangesHeaders",(function(){return kW})),n.d(r,"PageBlobGetPageRangesExceptionHeaders",(function(){return CW})),n.d(r,"PageBlobGetPageRangesDiffHeaders",(function(){return SW})),n.d(r,"PageBlobGetPageRangesDiffExceptionHeaders",(function(){return TW})),n.d(r,"PageBlobResizeHeaders",(function(){return EW})),n.d(r,"PageBlobResizeExceptionHeaders",(function(){return PW})),n.d(r,"PageBlobUpdateSequenceNumberHeaders",(function(){return MW})),n.d(r,"PageBlobUpdateSequenceNumberExceptionHeaders",(function(){return IW})),n.d(r,"PageBlobCopyIncrementalHeaders",(function(){return AW})),n.d(r,"PageBlobCopyIncrementalExceptionHeaders",(function(){return RW})),n.d(r,"AppendBlobCreateHeaders",(function(){return OW})),n.d(r,"AppendBlobCreateExceptionHeaders",(function(){return NW})),n.d(r,"AppendBlobAppendBlockHeaders",(function(){return DW})),n.d(r,"AppendBlobAppendBlockExceptionHeaders",(function(){return zW})),n.d(r,"AppendBlobAppendBlockFromUrlHeaders",(function(){return LW})),n.d(r,"AppendBlobAppendBlockFromUrlExceptionHeaders",(function(){return BW})),n.d(r,"AppendBlobSealHeaders",(function(){return FW})),n.d(r,"AppendBlobSealExceptionHeaders",(function(){return jW})),n.d(r,"BlockBlobUploadHeaders",(function(){return HW})),n.d(r,"BlockBlobUploadExceptionHeaders",(function(){return VW})),n.d(r,"BlockBlobPutBlobFromUrlHeaders",(function(){return UW})),n.d(r,"BlockBlobPutBlobFromUrlExceptionHeaders",(function(){return qW})),n.d(r,"BlockBlobStageBlockHeaders",(function(){return GW})),n.d(r,"BlockBlobStageBlockExceptionHeaders",(function(){return WW})),n.d(r,"BlockBlobStageBlockFromURLHeaders",(function(){return ZW})),n.d(r,"BlockBlobStageBlockFromURLExceptionHeaders",(function(){return XW})),n.d(r,"BlockBlobCommitBlockListHeaders",(function(){return KW})),n.d(r,"BlockBlobCommitBlockListExceptionHeaders",(function(){return YW})),n.d(r,"BlockBlobGetBlockListHeaders",(function(){return JW})),n.d(r,"BlockBlobGetBlockListExceptionHeaders",(function(){return QW}));var o=!1,s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else o&&console.log("RxJS: Back to a better error behavior. Thank you. <3");o=e},get useDeprecatedSynchronousErrorHandling(){return o}};function l(e){setTimeout((function(){throw e}),0)}var u={closed:!0,next:function(e){},error:function(e){if(s.useDeprecatedSynchronousErrorHandling)throw e;l(e)},complete:function(){}},c=Array.isArray||function(e){return e&&"number"==typeof e.length};function h(e){return null!==e&&"object"==typeof e}var d,f=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),p=((d=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,i=this._unsubscribe,r=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var o=0;o<n.length;++o)n[o].remove(this);if(a(i))try{i.call(this)}catch(d){t=d instanceof f?m(d.errors):[d]}if(c(r))for(var s=-1,l=r.length;++s<l;){var u=r[s];if(h(u))try{u.unsubscribe()}catch(d){t=t||[],d instanceof f?t=t.concat(m(d.errors)):t.push(d)}}if(t)throw new f(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=n._parentOrParents;if(null===r)n._parentOrParents=this;else if(r instanceof e){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var a=this._subscriptions;return null===a?this._subscriptions=[n]:a.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new d),d);function m(e){return e.reduce((function(e,t){return e.concat(t instanceof f?t.errors:t)}),[])}var v="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),g=function(e){function t(e,n,i){var r;switch(_classCallCheck(this,t),(r=_callSuper(this,t)).syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,arguments.length){case 0:r.destination=u;break;case 1:if(!e){r.destination=u;break}if("object"==typeof e){e instanceof t?(r.syncErrorThrowable=e.syncErrorThrowable,r.destination=e,e.add(_assertThisInitialized2(r))):(r.syncErrorThrowable=!0,r.destination=new y(_assertThisInitialized2(r),e));break}default:r.syncErrorThrowable=!0,r.destination=new y(_assertThisInitialized2(r),e,n,i)}return r}return _inherits(t,e),_createClass(t,[{key:v,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf2(t.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,n,i){var r=new t(e,n,i);return r.syncErrorThrowable=!1,r}}]),t}(p),y=function(e){function t(e,n,i,r){var o,s;_classCallCheck(this,t),(o=_callSuper(this,t))._parentSubscriber=e;var l=_assertThisInitialized2(o);return a(n)?s=n:n&&(s=n.next,i=n.error,r=n.complete,n!==u&&(a((l=Object.create(n)).unsubscribe)&&o.add(l.unsubscribe.bind(l)),l.unsubscribe=o.unsubscribe.bind(_assertThisInitialized2(o)))),o._context=l,o._next=s,o._error=i,o._complete=r,o}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=s.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):l(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;l(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw n;l(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(i){return s.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(l(i),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(g),_="function"==typeof Symbol&&Symbol.observable||"@@observable";function x(e){return e}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(t)}function w(e){return 0===e.length?x:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var k,C=((k=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var i=this.operator,r=function(e,t,n){if(e){if(e instanceof g)return e;if(e[v])return e[v]()}return e||t||n?new g(e,t,n):new g(u)}(e,t,n);if(r.add(i?i.call(r,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),s.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){s.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,i=t.destination,r=t.isStopped;if(n||r)return!1;e=i&&i instanceof g?i:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=S(t))((function(t,i){var r;r=n.subscribe((function(t){try{e(t)}catch(n){i(n),r&&r.unsubscribe()}}),i,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:_,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:w(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=S(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))}}]),e}()).create=function(e){return new k(e)},k);function S(e){if(e||(e=s.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var T,E=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),P=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).subject=e,i.subscriber=n,i.closed=!1,i}return _inherits(t,e),_createClass(t,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),t}(p),M=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).destination=e,n}return _inherits(t,e),_createClass(t)}(g),I=((T=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _inherits(t,e),_createClass(t,[{key:v,value:function(){return new M(this)}},{key:"lift",value:function(e){var t=new A(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new E;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].next(e)}},{key:"error",value:function(e){if(this.closed)throw new E;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new E;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new E;return _get(_getPrototypeOf2(t.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new E;return this.hasError?(e.error(this.thrownError),p.EMPTY):this.isStopped?(e.complete(),p.EMPTY):(this.observers.push(e),new P(this,e))}},{key:"asObservable",value:function(){var e=new C;return e.source=this,e}}]),t}(C)).create=function(e,t){return new A(e,t)},T),A=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).destination=e,i.source=n,i}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):p.EMPTY}}]),t}(I);function R(e){return e&&"function"==typeof e.schedule}var O=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).parent=e,r.outerValue=n,r.outerIndex=i,r.index=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}(g),N=function(e){return function(t){for(var n=0,i=e.length;n<i&&!t.closed;n++)t.next(e[n]);t.complete()}};var D="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",z=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function L(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var B=function(e){if(e&&"function"==typeof e[_])return i=e,function(e){var t=i[_]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(z(e))return N(e);if(L(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,l),e};if(e&&"function"==typeof e[D])return t=e,function(e){for(var n=t[D]();;){var i=n.next();if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,i,r=h(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(r," where a stream was expected. You can provide an Observable, Promise, Array, or Iterable."))};function F(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new O(e,n,i);if(!r.closed)return t instanceof C?t.subscribe(r):B(t)(r)}var j=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,i,r){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),t}(g);function H(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new V(e,t))}}var V=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new U(e,this.project,this.thisArg))}}]),e}(),U=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).project=n,r.count=0,r.thisArg=i||_assertThisInitialized2(r),r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(g);function q(e,t){return new C((function(n){var i=new p,r=0;return i.add(t.schedule((function(){r!==e.length?(n.next(e[r++]),n.closed||i.add(this.schedule())):n.complete()}))),i}))}function G(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[_]}(e))return function(e,t){return new C((function(n){var i=new p;return i.add(t.schedule((function(){var r=e[_]();i.add(r.subscribe({next:function(e){i.add(t.schedule((function(){return n.next(e)})))},error:function(e){i.add(t.schedule((function(){return n.error(e)})))},complete:function(){i.add(t.schedule((function(){return n.complete()})))}}))}))),i}))}(e,t);if(L(e))return function(e,t){return new C((function(n){var i=new p;return i.add(t.schedule((function(){return e.then((function(e){i.add(t.schedule((function(){n.next(e),i.add(t.schedule((function(){return n.complete()})))})))}),(function(e){i.add(t.schedule((function(){return n.error(e)})))}))}))),i}))}(e,t);if(z(e))return q(e,t);if(function(e){return e&&"function"==typeof e[D]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new C((function(n){var i,r=new p;return r.add((function(){i&&"function"==typeof i.return&&i.return()})),r.add(t.schedule((function(){i=e[D](),r.add(t.schedule((function(){if(!n.closed){var e,t;try{var r=i.next();e=r.value,t=r.done}catch(a){return void n.error(a)}t?n.complete():(n.next(e),this.schedule())}})))}))),r}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof C?e:new C(B(e))}function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(i){return i.pipe(W((function(n,i){return G(e(n,i)).pipe(H((function(e,r){return t(n,e,i,r)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new Z(e,n))})}var Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new X(e,this.project,this.concurrent))}}]),e}(),X=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var i=new O(this,t,n),r=this.destination;r.add(i);var a=F(this,e,void 0,void 0,i);a!==i&&r.add(a)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,i,r){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),t}(j);function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return W(x,e)}function Y(e,t){return t?q(e,t):new C(N(e))}function J(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Number.POSITIVE_INFINITY,r=null,a=t[t.length-1];return R(a)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(i=t.pop())):"number"==typeof a&&(i=t.pop()),null===r&&1===t.length&&t[0]instanceof C?t[0]:K(i)(Y(t,r))}function Q(){return function(e){return e.lift(new ee(e))}}var $,ee=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var i=new te(e,n),r=t.subscribe(i);return i.closed||(i.connection=n.connect()),r}}]),e}(),te=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).connectable=n,i}return _inherits(t,e),_createClass(t,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,i=e._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}else this.connection=null}}]),t}(g),ne={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:($=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).source=e,i.subjectFactory=n,i._refCount=0,i._isComplete=!1,i}return _inherits(t,e),_createClass(t,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new p).add(this.source.subscribe(new ie(this.getSubject(),this))),e.closed&&(this._connection=null,e=p.EMPTY)),e}},{key:"refCount",value:function(){return Q()(this)}}]),t}(C).prototype)._subscribe},_isComplete:{value:$._isComplete,writable:!0},getSubject:{value:$.getSubject},connect:{value:$.connect},refCount:{value:$.refCount}},ie=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).connectable=n,i}return _inherits(t,e),_createClass(t,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf2(t.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf2(t.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),t}(M);function re(){return new I}function ae(){return function(e){return Q()((t=re,function(e){var n;n="function"==typeof t?t:function(){return t};var i=Object.create(e,ne);return i.source=e,i.subjectFactory=n,i})(e));var t}}function oe(e){return{toString:e}.toString()}function se(e,t,n){return oe((function(){var i=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof r)return i.apply(this,t),this;var a=_construct2(r,t);return o.annotation=a,o;function o(e,t,n){for(var i=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;i.length<=n;)i.push(null);return(i[n]=i[n]||[]).push(a),e}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r}))}var le=se("Inject",(function(e){return{token:e}})),ue=se("Optional"),ce=se("Self"),he=se("SkipSelf"),de=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function fe(e){for(var t in e)if(e[t]===fe)return t;throw Error("Could not find renamed property on target object.")}function pe(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function me(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ve(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function ge(e){return ye(e,e[xe])||ye(e,e[ke])}function ye(e,t){return t&&t.token===e?t:null}function _e(e){return e&&(e.hasOwnProperty(be)||e.hasOwnProperty(Ce))?e[be]:null}var xe=fe({"\u0275prov":fe}),be=fe({"\u0275inj":fe}),we=fe({"\u0275provFallback":fe}),ke=fe({ngInjectableDef:fe}),Ce=fe({ngInjectorDef:fe});function Se(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Se).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return""+e.overriddenName;if(e.name)return""+e.name;var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Te(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Ee=fe({__forward_ref__:fe});function Pe(e){return e.__forward_ref__=Pe,e.toString=function(){return Se(this())},e}function Me(e){return Ie(e)?e():e}function Ie(e){return"function"==typeof e&&e.hasOwnProperty(Ee)&&e.__forward_ref__===Pe}var Ae,Re="undefined"!=typeof globalThis&&globalThis,Oe="undefined"!=typeof window&&window,Ne="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,De="undefined"!=typeof global&&global,ze=Re||De||Oe||Ne,Le=fe({"\u0275cmp":fe}),Be=fe({"\u0275dir":fe}),Fe=fe({"\u0275pipe":fe}),je=fe({"\u0275mod":fe}),He=fe({"\u0275loc":fe}),Ve=fe({"\u0275fac":fe}),Ue=fe({__NG_ELEMENT_ID__:fe}),qe=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=me({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken "+this._desc}}]),e}(),Ge=new qe("INJECTOR",-1),We={},Ze=/\n/gm,Xe=fe({provide:String,useValue:fe}),Ke=void 0;function Ye(e){var t=Ke;return Ke=e,t}function Je(e){var t=Ae;return Ae=e,t}function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de.Default;if(void 0===Ke)throw new Error("inject() must be called from an injection context");return null===Ke?tt(e,void 0,t):Ke.get(e,t&de.Optional?null:void 0,t)}function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de.Default;return(Ae||Qe)(Me(e),t)}var et=$e;function tt(e,t,n){var i=ge(e);if(i&&"root"==i.providedIn)return void 0===i.value?i.value=i.factory():i.value;if(n&de.Optional)return null;if(void 0!==t)return t;throw new Error("Injector: NOT_FOUND [".concat(Se(e),"]"))}function nt(e){for(var t=[],n=0;n<e.length;n++){var i=Me(e[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");for(var r=void 0,a=de.Default,o=0;o<i.length;o++){var s=i[o];s instanceof ue||"Optional"===s.ngMetadataName||s===ue?a|=de.Optional:s instanceof he||"SkipSelf"===s.ngMetadataName||s===he?a|=de.SkipSelf:s instanceof ce||"Self"===s.ngMetadataName||s===ce?a|=de.Self:r=s instanceof le||s===le?s.token:s}t.push($e(r,a))}else t.push($e(i))}return t}var it=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We;if(t===We){var n=new Error("NullInjectorError: No provider for ".concat(Se(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),rt=_createClass((function e(){_classCallCheck(this,e)})),at=_createClass((function e(){_classCallCheck(this,e)}));function ot(e,t){e.forEach((function(e){return Array.isArray(e)?ot(e,t):t(e)}))}function st(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function lt(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ut(e,t){for(var n=[],i=0;i<e;i++)n.push(t);return n}function ct(e,t,n){var i=dt(e,t);return i>=0?e[1|i]=n:function(e,t,n,i){var r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i=~i,t,n),i}function ht(e,t){var n=dt(e,t);if(n>=0)return e[1|n]}function dt(e,t){return function(e,t,n){for(var i=0,r=e.length>>1;r!==i;){var a=i+(r-i>>1),o=e[a<<1];if(t===o)return a<<1;o>t?r=a:i=a+1}return~(r<<1)}(e,t)}var ft=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),pt=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),mt={},vt=[],gt=0;function yt(e){return oe((function(){var t=e.type,n=t.prototype,i={},r={type:t,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:e.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:e.changeDetection===ft.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||vt,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||pt.Emulated,id:"c",styles:e.styles||vt,_:null,setInput:null,schemas:e.schemas||null,tView:null},a=e.directives,o=e.features,s=e.pipes;return r.id+=gt++,r.inputs=kt(e.inputs,i),r.outputs=kt(e.outputs),o&&o.forEach((function(e){return e(r)})),r.directiveDefs=a?function(){return("function"==typeof a?a():a).map(_t)}:null,r.pipeDefs=s?function(){return("function"==typeof s?s():s).map(xt)}:null,r}))}function _t(e){return St(e)||function(e){return e[Be]||null}(e)}function xt(e){return function(e){return e[Fe]||null}(e)}var bt={};function wt(e){var t={type:e.type,bootstrap:e.bootstrap||vt,declarations:e.declarations||vt,imports:e.imports||vt,exports:e.exports||vt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&oe((function(){bt[e.id]=e.type})),t}function kt(e,t){if(null==e)return mt;var n={};for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],a=r;Array.isArray(r)&&(a=r[1],r=r[0]),n[r]=i,t&&(t[r]=a)}return n}var Ct=yt;function St(e){return e[Le]||null}function Tt(e,t){return e.hasOwnProperty(Ve)?e[Ve]:null}function Et(e,t){var n=e[je]||null;if(!n&&!0===t)throw new Error("Type ".concat(Se(e)," does not have '\u0275mod' property."));return n}function Pt(e){return Array.isArray(e)&&"object"==typeof e[1]}function Mt(e){return Array.isArray(e)&&!0===e[1]}function It(e){return 0!=(8&e.flags)}function At(e){return 2==(2&e.flags)}function Rt(e){return 1==(1&e.flags)}function Ot(e){return null!==e.template}function Nt(e){return 0!=(512&e[2])}var Dt=void 0;function zt(e){return!!e.listen}var Lt={createRenderer:function(e,t){return void 0!==Dt?Dt:"undefined"!=typeof document?document:void 0}};function Bt(e){for(;Array.isArray(e);)e=e[0];return e}function Ft(e,t){return Bt(t[e+20])}function jt(e,t){return Bt(t[e.index])}function Ht(e,t){return e.data[t+20]}function Vt(e,t){return e[t+20]}function Ut(e,t){var n=t[e];return Pt(n)?n:n[0]}function qt(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Gt(e){return 4==(4&e[2])}function Wt(e){return 128==(128&e[2])}function Zt(e,t){return null===e||null==t?null:e[t]}function Xt(e){e[18]=0}function Kt(e,t){e[5]+=t;for(var n=e,i=e[3];null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}var Yt={lFrame:_n(null),bindingsEnabled:!0,checkNoChangesMode:!1};function Jt(){return Yt.bindingsEnabled}function Qt(){return Yt.lFrame.lView}function $t(){return Yt.lFrame.tView}function en(e){Yt.lFrame.contextLView=e}function tn(){return Yt.lFrame.previousOrParentTNode}function nn(e,t){Yt.lFrame.previousOrParentTNode=e,Yt.lFrame.isParent=t}function rn(){return Yt.lFrame.isParent}function an(){Yt.lFrame.isParent=!1}function on(){return Yt.checkNoChangesMode}function sn(e){Yt.checkNoChangesMode=e}function ln(){var e=Yt.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function un(){return Yt.lFrame.bindingIndex++}function cn(e){var t=Yt.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function hn(e,t){var n=Yt.lFrame;n.bindingIndex=n.bindingRootIndex=e,dn(t)}function dn(e){Yt.lFrame.currentDirectiveIndex=e}function fn(e){var t=Yt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}function pn(){return Yt.lFrame.currentQueryIndex}function mn(e){Yt.lFrame.currentQueryIndex=e}function vn(e,t){var n=yn();Yt.lFrame=n,n.previousOrParentTNode=t,n.lView=e}function gn(e,t){var n=yn(),i=e[1];Yt.lFrame=n,n.previousOrParentTNode=t,n.lView=e,n.tView=i,n.contextLView=e,n.bindingIndex=i.bindingStartIndex}function yn(){var e=Yt.lFrame,t=null===e?null:e.child;return null===t?_n(e):t}function _n(e){var t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function xn(){var e=Yt.lFrame;return Yt.lFrame=e.parent,e.previousOrParentTNode=null,e.lView=null,e}var bn=xn;function wn(){var e=xn();e.isParent=!0,e.tView=null,e.selectedIndex=0,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.currentSanitizer=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function kn(){return Yt.lFrame.selectedIndex}function Cn(e){Yt.lFrame.selectedIndex=e}function Sn(){var e=Yt.lFrame;return Ht(e.tView,e.selectedIndex)}function Tn(){Yt.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function En(e,t){for(var n=t.directiveStart,i=t.directiveEnd;n<i;n++){var r=e.data[n];r.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-n,r.afterContentInit),r.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(n,r.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,r.afterContentChecked)),r.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-n,r.afterViewInit),r.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(n,r.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,r.afterViewChecked)),null!=r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(n,r.onDestroy)}}function Pn(e,t,n){An(e,t,3,n)}function Mn(e,t,n,i){(3&e[2])===n&&An(e,t,n,i)}function In(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function An(e,t,n,i){for(var r=null!=i?i:-1,a=0,o=void 0!==i?65535&e[18]:0;o<t.length;o++)if("number"==typeof t[o+1]){if(a=t[o],null!=i&&a>=i)break}else t[o]<0&&(e[18]+=65536),(a<r||-1==r)&&(Rn(e,n,t,o),e[18]=(4294901760&e[18])+o+2),o++}function Rn(e,t,n,i){var r=n[i]<0,a=n[i+1],o=e[r?-n[i]:n[i]];r?e[2]>>11<e[18]>>16&&(3&e[2])===t&&(e[2]+=2048,a.call(o)):a.call(o)}var On=_createClass((function e(t,n,i){_classCallCheck(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}));function Nn(e,t,n){for(var i=zt(e),r=0;r<n.length;){var a=n[r];if("number"==typeof a){if(0!==a)break;r++;var o=n[r++],s=n[r++],l=n[r++];i?e.setAttribute(t,s,l,o):t.setAttributeNS(o,s,l)}else{var u=a,c=n[++r];zn(u)?i&&e.setProperty(t,u,c):i?e.setAttribute(t,u,c):t.setAttribute(u,c),r++}}return r}function Dn(e){return 3===e||4===e||6===e}function zn(e){return 64===e.charCodeAt(0)}function Ln(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,i=0;i<t.length;i++){var r=t[i];"number"==typeof r?n=r:0===n||Bn(e,n,r,null,-1===n||2===n?t[++i]:null)}return e}function Bn(e,t,n,i,r){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var l=e[a];if("number"==typeof l)break;if(l===n){if(null===i)return void(null!==r&&(e[a+1]=r));if(i===e[a+1])return void(e[a+2]=r)}a++,null!==i&&a++,null!==r&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==i&&e.splice(a++,0,i),null!==r&&e.splice(a++,0,r)}function Fn(e){return-1!==e}function jn(e){return 32767&e}function Hn(e){return e>>16}function Vn(e,t){for(var n=Hn(e),i=t;n>0;)i=i[15],n--;return i}function Un(e){return"string"==typeof e?e:null==e?"":""+e}function qn(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Un(e)}var Gn=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ze);function Wn(e){return{name:"body",target:e.ownerDocument.body}}function Zn(e){return e instanceof Function?e():e}var Xn=!0;function Kn(e){var t=Xn;return Xn=e,t}var Yn=0;function Jn(e,t){var n=$n(e,t);if(-1!==n)return n;var i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,Qn(i.data,e),Qn(t,null),Qn(i.blueprint,null));var r=ei(e,t),a=e.injectorIndex;if(Fn(r))for(var o=jn(r),s=Vn(r,t),l=s[1].data,u=0;u<8;u++)t[a+u]=s[o+u]|l[o+u];return t[a+8]=r,a}function Qn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function $n(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function ei(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=t[6],i=1;n&&-1===n.injectorIndex;)n=(t=t[15])?t[6]:null,i++;return n?n.injectorIndex|i<<16:-1}function ti(e,t,n){!function(e,t,n){var i="string"!=typeof n?n[Ue]:n.charCodeAt(0)||0;null==i&&(i=n[Ue]=Yn++);var r=255&i,a=1<<r,o=64&r,s=32&r,l=t.data;128&r?o?s?l[e+7]|=a:l[e+6]|=a:s?l[e+5]|=a:l[e+4]|=a:o?s?l[e+3]|=a:l[e+2]|=a:s?l[e+1]|=a:l[e]|=a}(e,t,n)}function ni(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:de.Default,r=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e[Ue];return"number"==typeof t&&t>0?255&t:t}(n);if("function"==typeof a){vn(t,e);try{var o=a();if(null!=o||i&de.Optional)return o;throw new Error("No provider for ".concat(qn(n),"!"))}finally{bn()}}else if("number"==typeof a){if(-1===a)return new ui(e,t);var s=null,l=$n(e,t),u=-1,c=i&de.Host?t[16][6]:null;for((-1===l||i&de.SkipSelf)&&(u=-1===l?ei(e,t):t[l+8],li(i,!1)?(s=t[1],l=jn(u),t=Vn(u,t)):l=-1);-1!==l;){u=t[l+8];var h=t[1];if(si(a,l,h.data)){var d=ri(l,t,n,s,i,c);if(d!==ii)return d}li(i,t[1].data[l+8]===c)&&si(a,l,t)?(s=h,l=jn(u),t=Vn(u,t)):l=-1}}}if(i&de.Optional&&void 0===r&&(r=null),0==(i&(de.Self|de.Host))){var f=t[9],p=Je(void 0);try{return f?f.get(n,r,i&de.Optional):tt(n,r,i&de.Optional)}finally{Je(p)}}if(i&de.Optional)return r;throw new Error("NodeInjector: NOT_FOUND [".concat(qn(n),"]"))}var ii={};function ri(e,t,n,i,r,a){var o=t[1],s=o.data[e+8],l=ai(s,o,n,null==i?At(s)&&Xn:i!=o&&3===s.type,r&de.Host&&a===s);return null!==l?oi(t,o,l,s):ii}function ai(e,t,n,i,r){for(var a=e.providerIndexes,o=t.data,s=65535&a,l=e.directiveStart,u=a>>16,c=r?s+u:e.directiveEnd,h=i?s:s+u;h<c;h++){var d=o[h];if(h<l&&n===d||h>=l&&d.type===n)return h}if(r){var f=o[l];if(f&&Ot(f)&&f.type===n)return l}return null}function oi(e,t,n,i){var r=e[n],a=t.data;if(r instanceof On){var o=r;if(o.resolving)throw new Error("Circular dep for "+qn(a[n]));var s,l=Kn(o.canSeeViewProviders);o.resolving=!0,o.injectImpl&&(s=Je(o.injectImpl)),vn(e,i);try{r=e[n]=o.factory(void 0,a,e,i),t.firstCreatePass&&n>=i.directiveStart&&function(e,t,n){var i=t.onChanges,r=t.onInit,a=t.doCheck;i&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,i)),r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-e,r),a&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,a))}(n,a[n],t)}finally{o.injectImpl&&Je(s),Kn(l),o.resolving=!1,bn()}}return r}function si(e,t,n){var i=64&e,r=32&e;return!!((128&e?i?r?n[t+7]:n[t+6]:r?n[t+5]:n[t+4]:i?r?n[t+3]:n[t+2]:r?n[t+1]:n[t])&1<<e)}function li(e,t){return!(e&de.Self||e&de.Host&&t)}var ui=function(){function e(t,n){_classCallCheck(this,e),this._tNode=t,this._lView=n}return _createClass(e,[{key:"get",value:function(e,t){return ni(this._tNode,this._lView,e,void 0,t)}}]),e}();function ci(e){var t=e;if(Ie(e))return function(){var e=ci(Me(t));return e?e():null};var n=Tt(t);if(null===n){var i=_e(t);n=i&&i.factory}return n||null}function hi(e){return oe((function(){for(var t=e.prototype.constructor,n=t[Ve]||ci(t),i=Object.prototype,r=Object.getPrototypeOf(e.prototype).constructor;r&&r!==i;){var a=r[Ve]||ci(r);if(a&&a!==n)return a;r=Object.getPrototypeOf(r)}return function(e){return new e}}))}function di(e){return e.ngDebugContext}function fi(e){return e.ngOriginalError}function pi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.error.apply(e,n)}var mi=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),i=function(e){return e.ngErrorLogger||pi}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t),n&&i(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?di(e)?di(e):this._findContext(fi(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=fi(e);t&&fi(t);)t=fi(t);return t}}]),e}(),vi=function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}]),e}(),gi=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"HTML"}}]),t}(vi),yi=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"Style"}}]),t}(vi),_i=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"Script"}}]),t}(vi),xi=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"URL"}}]),t}(vi),bi=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),t}(vi);function wi(e){return e instanceof vi?e.changingThisBreaksApplicationSecurity:e}function ki(e,t){var n=Ci(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see http://g.co/ng/security#xss)"))}return n===t}function Ci(e){return e instanceof vi&&e.getTypeName()||null}var Si=!0,Ti=!1;function Ei(){return Ti=!0,Si}var Pi=function(){function e(t){_classCallCheck(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");var n=this.inertDocument.body;if(null==n){var i=this.inertDocument.createElement("html");this.inertDocument.appendChild(i),n=this.inertDocument.createElement("body"),i.appendChild(n)}n.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!n.querySelector||n.querySelector("svg")?(n.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=n.querySelector&&n.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(e,[{key:"getInertBodyElement_XHR",value:function(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(i){return null}var t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);var n=t.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(e){e="<body><remove></remove>"+e+"</body>";try{var t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=e,t;var n=this.inertDocument.createElement("body");return n.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var i=t.item(n).name;"xmlns:ns1"!==i&&0!==i.indexOf("ns1:")||e.removeAttribute(i)}for(var r=e.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}]),e}(),Mi=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Ii=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ai(e){return(e=String(e)).match(Mi)||e.match(Ii)?e:(Ei()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(e," (see http://g.co/ng/security#xss)")),"unsafe:"+e)}function Ri(e){var t,n={},i=_createForOfIteratorHelper(e.split(","));try{for(i.s();!(t=i.n()).done;){n[t.value]=!0}}catch(r){i.e(r)}finally{i.f()}return n}function Oi(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(var r=0,a=n;r<a.length;r++){var o=a[r];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var Ni,Di=Ri("area,br,col,hr,img,wbr"),zi=Ri("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Li=Ri("rp,rt"),Bi=Oi(Li,zi),Fi=Oi(Di,Oi(zi,Ri("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Oi(Li,Ri("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Bi),ji=Ri("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Hi=Ri("srcset"),Vi=Oi(ji,Hi,Ri("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ri("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Ui=Ri("script,style,template"),qi=function(){function e(){_classCallCheck(this,e),this.sanitizedSomething=!1,this.buf=[]}return _createClass(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!Fi.hasOwnProperty(t))return this.sanitizedSomething=!0,!Ui.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n,i=e.attributes,r=0;r<i.length;r++){var a=i.item(r),o=a.name,s=o.toLowerCase();if(Vi.hasOwnProperty(s)){var l=a.value;ji[s]&&(l=Ai(l)),Hi[s]&&(n=l,l=(n=String(n)).split(",").map((function(e){return Ai(e.trim())})).join(", ")),this.buf.push(" ",o,'="',Zi(l),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();Fi.hasOwnProperty(t)&&!Di.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(Zi(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+e.outerHTML);return t}}]),e}(),Gi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Wi=/([^\#-~ |!])/g;function Zi(e){return e.replace(/&/g,"&amp;").replace(Gi,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(Wi,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Xi(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Ki=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),Yi=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Ji=/^url\(([^)]+)\)$/;function Qi(e){var t,n=(t=Qt())&&t[12];return n?n.sanitize(Ki.URL,e)||"":ki(e,"URL")?wi(e):Ai(Un(e))}function $i(e,t){e.__ngContext__=t}function er(e){throw new Error("Multiple components match node with tagname "+e.tagName)}function tr(){throw new Error("Cannot mix multi providers and regular providers")}function nr(e,t,n){for(var i=e.length;;){var r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){var a=t.length;if(r+a===i||e.charCodeAt(r+a)<=32)return r}n=r+1}}function ir(e,t,n){for(var i=0;i<e.length;){var r=e[i++];if(n&&"class"===r){if(-1!==nr((r=e[i]).toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function rr(e){return 0===e.type&&"ng-template"!==e.tagName}function ar(e,t,n){return t===(0!==e.type||n?e.tagName:"ng-template")}function or(e,t,n){for(var i=4,r=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(Dn(e[t]))return t;return e.length}(r),o=!1,s=0;s<t.length;s++){var l=t[s];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ar(e,l,n)||""===l&&1===t.length){if(sr(i))return!1;o=!0}}else{var u=8&i?l:t[++s];if(8&i&&null!==e.attrs){if(!ir(e.attrs,u,n)){if(sr(i))return!1;o=!0}continue}var c=lr(8&i?"class":l,r,rr(e),n);if(-1===c){if(sr(i))return!1;o=!0;continue}if(""!==u){var h;h=c>a?"":r[c+1].toLowerCase();var d=8&i?h:null;if(d&&-1!==nr(d,u,0)||2&i&&u!==h){if(sr(i))return!1;o=!0}}}}else{if(!o&&!sr(i)&&!sr(l))return!1;if(o&&sr(l))continue;o=!1,i=l|1&i}}return sr(i)||o}function sr(e){return 0==(1&e)}function lr(e,t,n,i){if(null===t)return-1;var r=0;if(i||!n){for(var a=!1;r<t.length;){var o=t[r];if(o===e)return r;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++r];"string"==typeof s;)s=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function ur(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0;i<t.length;i++)if(or(e,t[i],n))return!0;return!1}function cr(e,t){e:for(var n=0;n<t.length;n++){var i=t[n];if(e.length===i.length){for(var r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function hr(e,t){return e?":not("+t.trim()+")":t}function dr(e){for(var t=e[0],n=1,i=2,r="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&i){var s=e[++n];r+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""===r||sr(o)||(t+=hr(a,r),r=""),i=o,a=a||!sr(i);n++}return""!==r&&(t+=hr(a,r)),t}var fr={};function pr(e){var t=e[3];return Mt(t)?t[3]:t}function mr(e){return gr(e[13])}function vr(e){return gr(e[4])}function gr(e){for(;null!==e&&!Mt(e);)e=e[4];return e}function yr(e){_r($t(),Qt(),kn()+e,on())}function _r(e,t,n,i){if(!i)if(3==(3&t[2])){var r=e.preOrderCheckHooks;null!==r&&Pn(t,r,n)}else{var a=e.preOrderHooks;null!==a&&Mn(t,a,0,n)}Cn(n)}function xr(e,t){return e<<17|t<<2}function br(e){return e>>17&32767}function wr(e){return 2|e}function kr(e){return(131068&e)>>2}function Cr(e,t){return-131069&e|t<<2}function Sr(e){return 1|e}function Tr(e,t){var n=e.contentQueries;if(null!==n)for(var i=0;i<n.length;i+=2){var r=n[i],a=n[i+1];if(-1!==a){var o=e.data[a];mn(r),o.contentQueries(2,t[a],a)}}}function Er(e,t,n){return zt(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Pr(e,t,n,i,r,a,o,s,l,u){var c=t.blueprint.slice();return c[0]=r,c[2]=140|i,Xt(c),c[3]=c[15]=e,c[8]=n,c[10]=o||e&&e[10],c[11]=s||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=u||e&&e[9]||null,c[6]=a,c[16]=2==t.type?e[16]:c,c}function Mr(e,t,n,i,r,a){var o=n+20,s=e.data[o]||function(e,t,n,i,r,a){var o=tn(),s=rn(),l=s?o:o&&o.parent,u=e.data[n]=Fr(0,l&&l!==t?l:null,i,n,r,a);return null===e.firstChild&&(e.firstChild=u),o&&(!s||null!=o.child||null===u.parent&&2!==o.type?s||(o.next=u):o.child=u),u}(e,t,o,i,r,a);return nn(s,!0),s}function Ir(e,t,n){gn(t,t[6]);try{var i=e.viewQuery;null!==i&&sa(1,i,n);var r=e.template;null!==r&&Or(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Tr(e,t),e.staticViewQueries&&sa(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)na(e,t[n])}(t,a)}catch(o){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),o}finally{t[2]&=-5,wn()}}function Ar(e,t,n,i){var r=t[2];if(256!=(256&r)){gn(t,t[6]);var a=on();try{Xt(t),Yt.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Or(e,t,n,2,i);var o=3==(3&r);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&Pn(t,s,null)}else{var l=e.preOrderHooks;null!==l&&Mn(t,l,0,null),In(t,0)}if(function(e){for(var t=mr(e);null!==t;t=vr(t))if(t[2])for(var n=t[9],i=0;i<n.length;i++){var r=n[i],a=r[3];0==(1024&r[2])&&Kt(a,1),r[2]|=1024}}(t),function(e){for(var t=mr(e);null!==t;t=vr(t))for(var n=10;n<t.length;n++){var i=t[n],r=i[1];Wt(i)&&Ar(r,i,r.template,i[8])}}(t),null!==e.contentQueries&&Tr(e,t),!a)if(o){var u=e.contentCheckHooks;null!==u&&Pn(t,u)}else{var c=e.contentHooks;null!==c&&Mn(t,c,1),In(t,1)}!function(e,t){try{var n=e.expandoInstructions;if(null!==n)for(var i=e.expandoStartIndex,r=-1,a=0;a<n.length;a++){var o=n[a];"number"==typeof o?o<=0?(Cn(0-o),r=i+=9+n[++a]):i+=o:(null!==o&&(hn(i,r),o(2,t[r])),r++)}}finally{Cn(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)ta(e,t[n])}(t,h);var d=e.viewQuery;if(null!==d&&sa(2,d,i),!a)if(o){var f=e.viewCheckHooks;null!==f&&Pn(t,f)}else{var p=e.viewHooks;null!==p&&Mn(t,p,2),In(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Kt(t[3],-1))}finally{wn()}}}function Rr(e,t,n,i){var r=t[10],a=!on(),o=Gt(t);try{a&&!o&&r.begin&&r.begin(),o&&Ir(e,t,i),Ar(e,t,n,i)}finally{a&&!o&&r.end&&r.end()}}function Or(e,t,n,i,r){var a=kn();try{Cn(-1),2&i&&t.length>20&&_r(e,t,0,on()),n(i,r)}finally{Cn(a)}}function Nr(e,t,n){if(It(t))for(var i=t.directiveEnd,r=t.directiveStart;r<i;r++){var a=e.data[r];a.contentQueries&&a.contentQueries(1,n[r],r)}}function Dr(e,t,n){Jt()&&(function(e,t,n,i){var r=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||Jn(n,t),$i(i,t);for(var o=n.initialInputs,s=r;s<a;s++){var l=e.data[s],u=Ot(l);u&&Jr(t,n,l);var c=oi(t,e,s,n);$i(c,t),null!==o&&Qr(0,s-r,c,l,0,o),u&&(Ut(n.index,t)[8]=c)}}(e,t,n,jt(n,t)),128==(128&n.flags)&&function(e,t,n){var i=n.directiveStart,r=n.directiveEnd,a=e.expandoInstructions,o=e.firstCreatePass,s=n.index-20,l=Yt.lFrame.currentDirectiveIndex;try{Cn(s);for(var u=i;u<r;u++){var c=e.data[u],h=t[u];dn(u),null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs?Gr(c,h):o&&a.push(null)}}finally{Cn(-1),dn(l)}}(e,t,n))}function zr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jt,i=t.localNames;if(null!==i)for(var r=t.index+1,a=0;a<i.length;a+=2){var o=i[a+1],s=-1===o?n(t,e):e[o];e[r++]=s}}function Lr(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Br(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Br(e,t,n,i,r,a,o,s,l,u){var c=20+i,h=c+r,d=function(e,t){for(var n=[],i=0;i<t;i++)n.push(i<e?null:fr);return n}(c,h);return d[1]={type:e,id:t,blueprint:d,template:n,queries:null,viewQuery:s,node:null,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:u,incompleteFirstPass:!1}}function Fr(e,t,n,i,r,a){return{type:n,index:i,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:r,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function jr(e,t,n){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function Hr(e,t,n,i,r,a,o,s){var l,u,c=jt(t,n),h=t.inputs;!s&&null!=h&&(l=h[i])?(fa(e,n,l,i,r),At(t)&&function(e,t){var n=Ut(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3===t.type&&(i="class"===(u=i)?"className":"for"===u?"htmlFor":"formaction"===u?"formAction":"innerHtml"===u?"innerHTML":"readonly"===u?"readOnly":"tabindex"===u?"tabIndex":u,r=null!=o?o(r,t.tagName||"",i):r,zt(a)?a.setProperty(c,i,r):zn(i)||(c.setProperty?c.setProperty(i,r):c[i]=r))}function Vr(e,t,n,i){var r=!1;if(Jt()){var a=function(e,t,n){var i=e.directiveRegistry,r=null;if(i)for(var a=0;a<i.length;a++){var o=i[a];ur(n,o.selectors,!1)&&(r||(r=[]),ti(Jn(n,t),e,o.type),Ot(o)?(2&n.flags&&er(n),Zr(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==a){var s=0;r=!0,Kr(n,e.data.length,a.length);for(var l=0;l<a.length;l++){var u=a[l];u.providersResolver&&u.providersResolver(u)}Wr(e,n,a.length);for(var c=!1,h=!1,d=0;d<a.length;d++){var f=a[d];n.mergedAttrs=Ln(n.mergedAttrs,f.hostAttrs),Yr(e,t,f),Xr(e.data.length-1,f,o),null!==f.contentQueries&&(n.flags|=8),null===f.hostBindings&&null===f.hostAttrs&&0===f.hostVars||(n.flags|=128),!c&&(f.onChanges||f.onInit||f.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index-20),c=!0),h||!f.onChanges&&!f.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index-20),h=!0),Ur(e,f),s+=f.hostVars}!function(e,t){for(var n=t.directiveEnd,i=e.data,r=t.attrs,a=[],o=null,s=null,l=t.directiveStart;l<n;l++){var u=i[l],c=u.inputs,h=null===r||rr(t)?null:$r(c,r);a.push(h),o=jr(c,l,o),s=jr(u.outputs,l,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n),qr(e,t,s)}o&&function(e,t,n){if(t)for(var i=e.localNames=[],r=0;r<t.length;r+=2){var a=n[t[r+1]];if(null==a)throw new Error("Export of name '".concat(t[r+1],"' not found!"));i.push(t[r],a)}}(n,i,o)}return n.mergedAttrs=Ln(n.mergedAttrs,n.attrs),r}function Ur(e,t){var n=e.expandoInstructions;n.push(t.hostBindings),0!==t.hostVars&&n.push(t.hostVars)}function qr(e,t,n){for(var i=0;i<n;i++)t.push(fr),e.blueprint.push(fr),e.data.push(null)}function Gr(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Wr(e,t,n){var i=20-t.index,r=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(i,r,n)}function Zr(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Xr(e,t,n){if(n){if(t.exportAs)for(var i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;Ot(t)&&(n[""]=e)}}function Kr(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Yr(e,t,n){e.data.push(n);var i=n.factory||(n.factory=Tt(n.type)),r=new On(i,Ot(n),null);e.blueprint.push(r),t.push(r)}function Jr(e,t,n){var i=jt(t,e),r=Lr(n),a=e[10],o=ia(e,Pr(e,r,null,n.onPush?64:16,i,t,a,a.createRenderer(i,n)));e[t.index]=o}function Qr(e,t,n,i,r,a){var o=a[t];if(null!==o)for(var s=i.setInput,l=0;l<o.length;){var u=o[l++],c=o[l++],h=o[l++];null!==s?i.setInput(n,h,u,c):n[c]=h}}function $r(e,t){for(var n=null,i=0;i<t.length;){var r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function ea(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function ta(e,t){var n=Ut(t,e);if(Wt(n)){var i=n[1];80&n[2]?Ar(i,n,i.template,n[8]):n[5]>0&&function e(t){for(var n=mr(t);null!==n;n=vr(n))for(var i=10;i<n.length;i++){var r=n[i];if(1024&r[2]){var a=r[1];Ar(a,r,a.template,r[8])}else r[5]>0&&e(r)}var o=t[1].components;if(null!==o)for(var s=0;s<o.length;s++){var l=Ut(o[s],t);Wt(l)&&l[5]>0&&e(l)}}(n)}}function na(e,t){var n=Ut(t,e),i=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n),Ir(i,n,n[8])}function ia(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function ra(e){for(;e;){e[2]|=64;var t=pr(e);if(Nt(e)&&!t)return e;e=t}return null}function aa(e,t,n){var i=t[10];i.begin&&i.begin();try{Ar(e,t,e.template,n)}catch(r){throw da(t,r),r}finally{i.end&&i.end()}}function oa(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],i=qt(n),r=i[1];Rr(r,i,r.template,n)}}(e[8])}function sa(e,t,n){mn(0),t(e,n)}var la=Promise.resolve(null);function ua(e){return e[7]||(e[7]=[])}function ca(e){return e.cleanup||(e.cleanup=[])}function ha(e,t,n){return(null===e||Ot(e))&&(n=function(e){for(;Array.isArray(e);){if("object"==typeof e[1])return e;e=e[0]}return null}(n[t.index])),n[11]}function da(e,t){var n=e[9],i=n?n.get(mi,null):null;i&&i.handleError(t)}function fa(e,t,n,i,r){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],l=t[o],u=e.data[o];null!==u.setInput?u.setInput(l,r,i,s):l[s]=r}}function pa(e,t){var n=t[3];return-1===e.index?Mt(n)?n:null:n}function ma(e,t){var n=pa(e,t);return n?Ea(t[11],n[7]):null}function va(e,t,n,i,r){if(null!=i){var a,o=!1;Mt(i)?a=i:Pt(i)&&(o=!0,i=i[0]);var s=Bt(i);0===e&&null!==n?null==r?Sa(t,n,s):Ca(t,n,s,r||null):1===e&&null!==n?Ca(t,n,s,r||null):2===e?function(e,t,n){var i=Ea(e,t);i&&function(e,t,n,i){zt(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,i,r){var a=n[7];a!==Bt(n)&&va(t,e,i,a,r);for(var o=10;o<n.length;o++){var s=n[o];Ra(s[1],s,e,t,i,a)}}(t,e,a,n,r)}}function ga(e,t,n,i){var r=ma(e.node,t);r&&Ra(e,t,t[11],n?1:2,r,i)}function ya(e,t){var n=e[9],i=n.indexOf(t);1024&t[2]&&Kt(t[3],-1),n.splice(i,1)}function _a(e,t){if(!(e.length<=10)){var n=10+t,i=e[n];if(i){var r=i[17];null!==r&&r!==e&&ya(r,i),t>0&&(e[n-1][4]=i[4]);var a=lt(e,10+t);ga(i[1],i,!1,null);var o=a[19];null!==o&&o.detachView(a[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}}function xa(e,t){if(!(256&t[2])){var n=t[11];zt(n)&&n.destroyNode&&Ra(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return wa(e[1],e);for(;t;){var n=null;if(Pt(t))n=t[13];else{var i=t[10];i&&(n=i)}if(!n){for(;t&&!t[4]&&t!==e;)Pt(t)&&wa(t[1],t),t=ba(t,e);null===t&&(t=e),Pt(t)&&wa(t[1],t),n=t&&t[4]}t=n}}(t)}}function ba(e,t){var n;return Pt(e)&&(n=e[6])&&2===n.type?pa(n,e):e[3]===t?null:e[3]}function wa(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var i=0;i<n.length;i+=2){var r=t[n[i]];if(!(r instanceof On)){var a=n[i+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2)a[o+1].call(r[a[o]]);else a.call(r)}}}(e,t),function(e,t){var n=e.cleanup;if(null!==n){for(var i=t[7],r=0;r<n.length-1;r+=2)if("string"==typeof n[r]){var a=n[r+1],o="function"==typeof a?a(t):Bt(t[a]),s=i[n[r+2]],l=n[r+3];"boolean"==typeof l?o.removeEventListener(n[r],s,l):l>=0?i[l]():i[-l].unsubscribe(),r+=2}else n[r].call(i[n[r+1]]);t[7]=null}}(e,t);var n=t[6];n&&3===n.type&&zt(t[11])&&t[11].destroy();var i=t[17];if(null!==i&&Mt(t[3])){i!==t[3]&&ya(i,t);var r=t[19];null!==r&&r.detachView(e)}}}function ka(e,t,n){for(var i=t.parent;null!=i&&(4===i.type||5===i.type);)i=(t=i).parent;if(null==i){var r=n[6];return 2===r.type?ma(r,n):n[0]}if(t&&5===t.type&&4&t.flags)return jt(t,n).parentNode;if(2&i.flags){var a=e.data,o=a[a[i.index].directiveStart].encapsulation;if(o!==pt.ShadowDom&&o!==pt.Native)return null}return jt(i,n)}function Ca(e,t,n,i){zt(e)?e.insertBefore(t,n,i):t.insertBefore(n,i,!0)}function Sa(e,t,n){zt(e)?e.appendChild(t,n):t.appendChild(n)}function Ta(e,t,n,i){null!==i?Ca(e,t,n,i):Sa(e,t,n)}function Ea(e,t){return zt(e)?e.parentNode(t):t.parentNode}function Pa(e,t){if(2===e.type){var n=pa(e,t);return null===n?null:Ia(n.indexOf(t,10)-10,n)}return 4===e.type||5===e.type?jt(e,t):null}function Ma(e,t,n,i){var r=ka(e,i,t);if(null!=r){var a=t[11],o=Pa(i.parent||t[6],t);if(Array.isArray(n))for(var s=0;s<n.length;s++)Ta(a,r,n[s],o);else Ta(a,r,n,o)}}function Ia(e,t){var n=10+e+1;if(n<t.length){var i=t[n],r=i[1].firstChild;if(null!==r)return function e(t,n){if(null!==n){var i=n.type;if(3===i)return jt(n,t);if(0===i)return Ia(-1,t[n.index]);if(4===i||5===i){var r=n.child;if(null!==r)return e(t,r);var a=t[n.index];return Mt(a)?Ia(-1,a):Bt(a)}var o=t[16],s=o[6],l=pr(o),u=s.projection[n.projection];return null!=u?e(l,u):e(t,n.next)}return null}(i,r)}return t[7]}function Aa(e,t,n,i,r,a,o){for(;null!=n;){var s=i[n.index],l=n.type;o&&0===t&&(s&&$i(Bt(s),i),n.flags|=4),64!=(64&n.flags)&&(4===l||5===l?(Aa(e,t,n.child,i,r,a,!1),va(t,e,r,s,a)):1===l?Oa(e,t,i,n,r,a):va(t,e,r,s,a)),n=o?n.projectionNext:n.next}}function Ra(e,t,n,i,r,a){Aa(n,i,e.node.child,t,r,a,!1)}function Oa(e,t,n,i,r,a){var o=n[16],s=o[6].projection[i.projection];if(Array.isArray(s))for(var l=0;l<s.length;l++)va(t,e,r,s[l],a);else Aa(e,t,s,o[3],r,a,!0)}function Na(e,t,n){zt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Da(e,t,n){zt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}var za,La,Ba,Fa=function(){function e(t,n){_classCallCheck(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._viewContainerRef=null}return _createClass(e,[{key:"rootNodes",get:function(){var e=this._lView;return null==e[0]?function e(t,n,i,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==i;){var o=n[i.index];if(null!==o&&r.push(Bt(o)),Mt(o))for(var s=10;s<o.length;s++){var l=o[s],u=l[1].firstChild;null!==u&&e(l[1],l,u,r)}var c=i.type;if(4===c||5===c)e(t,n,i.child,r);else if(1===c){var h=n[16],d=h[6].projection[i.projection];if(Array.isArray(d))r.push.apply(r,_toConsumableArray(d));else{var f=pr(h);e(f[1],f,d,r,!0)}}i=a?i.projectionNext:i.next}return r}(e[1],e,e[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}xa(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){var t,n,i;t=this._lView[1],i=e,ua(n=this._lView).push(i),t.firstCreatePass&&ca(t).push(n[7].length-1,null)}},{key:"markForCheck",value:function(){ra(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){aa(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){sn(!0);try{aa(e,t,n)}finally{sn(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,Ra(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),ja=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e]))._view=e,n}return _inherits(t,e),_createClass(t,[{key:"detectChanges",value:function(){oa(this._view)}},{key:"checkNoChanges",value:function(){!function(e){sn(!0);try{oa(e)}finally{sn(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),t}(Fa);function Ha(e,t,n){return za||(za=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(e)),new za(jt(t,n))}function Va(e,t,n,i){return La||(La=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t))._declarationView=e,r._declarationTContainer=n,r.elementRef=i,r}return _inherits(t,e),_createClass(t,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Pr(this._declarationView,t,e,16,null,t.node);n[17]=this._declarationView[this._declarationTContainer.index];var i=this._declarationView[19];return null!==i&&(n[19]=i.createEmbeddedView(t)),Ir(t,n,e),new Fa(n)}}]),t}(e)),0===n.type?new La(i,n,Ha(t,n,i)):null}function Ua(e,t,n,i){var r;Ba||(Ba=function(e){function n(e,t,i){var r;return _classCallCheck(this,n),(r=_callSuper(this,n))._lContainer=e,r._hostTNode=t,r._hostView=i,r}return _inherits(n,e),_createClass(n,[{key:"element",get:function(){return Ha(t,this._hostTNode,this._hostView)}},{key:"injector",get:function(){return new ui(this._hostTNode,this._hostView)}},{key:"parentInjector",get:function(){var e=ei(this._hostTNode,this._hostView),t=Vn(e,this._hostView),n=function(e,t,n){if(n.parent&&-1!==n.parent.injectorIndex){for(var i=n.parent.injectorIndex,r=n.parent;null!=r.parent&&i==r.parent.injectorIndex;)r=r.parent;return r}for(var a=Hn(e),o=t,s=t[6];a>1;)s=(o=o[15])[6],a--;return s}(e,this._hostView,this._hostTNode);return Fn(e)&&null!=n?new ui(n,t):new ui(null,this._hostView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){return null!==this._lContainer[8]&&this._lContainer[8][e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var i=e.createEmbeddedView(t||{});return this.insert(i,n),i}},{key:"createComponent",value:function(e,t,n,i,r){var a=n||this.parentInjector;if(!r&&null==e.ngModule&&a){var o=a.get(rt,null);o&&(r=o)}var s=e.create(a,i,void 0,r);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var n=e._lView,i=n[1];if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Mt(n[3])){var r=this.indexOf(e);if(-1!==r)this.detach(r);else{var a=n[3],o=new Ba(a,a[6],a[3]);o.detach(o.indexOf(e))}}var s=this._adjustIndex(t);return function(e,t,n,i){var r=10+i,a=n.length;i>0&&(n[r-1][4]=t),i<a-10?(t[4]=n[r],st(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,n,this._lContainer,s),ga(i,n,!0,Ia(s,this._lContainer)),e.attachToViewContainerRef(this),st(this._lContainer[8],s,e),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=this._lContainer[8];return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1);!function(e,t){var n=_a(e,t);n&&xa(n[1],n)}(this._lContainer,t),lt(this._lContainer[8],t)}},{key:"detach",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1),n=_a(this._lContainer,t);return n&&null!=lt(this._lContainer[8],t)?new Fa(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}},{key:"allocateContainerIfNeeded",value:function(){null===this._lContainer[8]&&(this._lContainer[8]=[])}}]),n}(e));var a=i[n.index];if(Mt(a))r=a;else{var o;if(4===n.type)o=Bt(a);else if(o=i[11].createComment(""),Nt(i)){var s=i[11],l=jt(n,i);Ca(s,Ea(s,l),o,function(e,t){return zt(e)?e.nextSibling(t):t.nextSibling}(s,l))}else Ma(i[1],i,o,n);i[n.index]=r=ea(a,i,o,n),ia(i,r)}return new Ba(r,n,i)}function qa(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n){if(!n&&At(e)){var i=Ut(e.index,t);return new Fa(i,i)}return 3===e.type||0===e.type||4===e.type||5===e.type?new Fa(t[16],t):null}(tn(),Qt(),e)}var Ga=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.__NG_ELEMENT_ID__=function(){return Wa()},e}(),Wa=qa,Za=new qe("Set Injector scope."),Xa={},Ka={},Ya=[],Ja=void 0;function Qa(){return void 0===Ja&&(Ja=new it),Ja}function $a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return new eo(e,n,t||Qa(),i)}var eo=function(){function e(t,n,i){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&ot(n,(function(e){return r.processProvider(e,t,n)})),ot([t],(function(e){return r.processInjectorType(e,[],o)})),this.records.set(Ge,io(void 0,this));var s=this.records.get(Za);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:Se(t))}return _createClass(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(e){return e.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:de.Default;this.assertNotDestroyed();var i,r=Ye(this);try{if(!(n&de.SkipSelf)){var a=this.records.get(e);if(void 0===a){var o=("function"==typeof(i=e)||"object"==typeof i&&i instanceof qe)&&ge(e);a=o&&this.injectableDefInScope(o)?io(to(e),Xa):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&de.Self?Qa():this.parent).get(e,t=n&de.Optional&&t===We?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(Se(e)),r)throw s;return function(e,t,n,i){var r=e.ngTempTokenPath;throw t.__source&&r.unshift(t.__source),e.message=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var r=Se(t);if(Array.isArray(t))r=t.map(Se).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):Se(s)))}r="{".concat(a.join(", "),"}")}return"".concat(n).concat(i?"("+i+")":"","[").concat(r,"]: ").concat(e.replace(Ze,"\n  "))}("\n"+e.message,r,"R3InjectorError",i),e.ngTokenPath=r,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{Ye(r)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach((function(t){return e.get(t)}))}},{key:"toString",value:function(){var e=[];return this.records.forEach((function(t,n){return e.push(Se(n))})),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var i=this;if(!(e=Me(e)))return!1;var r=_e(e),a=null==r&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(r=_e(a)),null==r)return!1;if(null!=r.imports&&!s){var l;n.push(o);try{ot(r.imports,(function(e){i.processInjectorType(e,t,n)&&(void 0===l&&(l=[]),l.push(e))}))}finally{}if(void 0!==l)for(var u=function(){var e=l[c],t=e.ngModule,n=e.providers;ot(n,(function(e){return i.processProvider(e,t,n||Ya)}))},c=0;c<l.length;c++)u()}this.injectorDefTypes.add(o),this.records.set(o,io(r.factory,Xa));var h=r.providers;if(null!=h&&!s){var d=e;ot(h,(function(e){return i.processProvider(e,d,h)}))}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var i=ao(e=Me(e))?e:Me(e&&e.provide),r=function(e,t,n){return ro(e)?io(void 0,e.useValue):io(no(e,t,n),Xa)}(e,t,n);if(ao(e)||!0!==e.multi){var a=this.records.get(i);a&&void 0!==a.multi&&tr()}else{var o=this.records.get(i);o?void 0===o.multi&&tr():((o=io(void 0,Xa,!0)).factory=function(){return nt(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,r)}},{key:"hydrate",value:function(e,t){var n;return t.value===Ka?function(e){throw new Error("Cannot instantiate cyclic dependency! "+e)}(Se(e)):t.value===Xa&&(t.value=Ka,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}]),e}();function to(e){var t=ge(e),n=null!==t?t.factory:Tt(e);if(null!==n)return n;var i=_e(e);if(null!==i)return i.factory;if(e instanceof qe)throw new Error("Token ".concat(Se(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=ut(t,"?");throw new Error("Can't resolve all parameters for ".concat(Se(e),": (").concat(n.join(", "),")."))}var i=function(e){var t=e&&(e[xe]||e[ke]||e[we]&&e[we]());if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in v10. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==i?function(){return i.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function no(e,t,n){var i,r=void 0;if(ao(e)){var a=Me(e);return Tt(a)||to(a)}if(ro(e))r=function(){return Me(e.useValue)};else if((i=e)&&i.useFactory)r=function(){return e.useFactory.apply(e,_toConsumableArray(nt(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return $e(Me(e.useExisting))};else{var o=Me(e&&(e.useClass||e.provide));if(o||function(e,t,n){var i="";throw e&&t&&(i=" - only instances of Provider and Type are allowed, got: [".concat(t.map((function(e){return e==n?"?"+n+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(Se(e),"'")+i)}(t,n,e),!function(e){return!!e.deps}(e))return Tt(o)||to(o);r=function(){return _construct2(o,_toConsumableArray(nt(e.deps)))}}return r}function io(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function ro(e){return null!==e&&"object"==typeof e&&Xe in e}function ao(e){return"function"==typeof e}var oo=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0,r=$a(e,t,n,i);return r._resolveInjectorDefTypes(),r}({name:n},t,e,n)},so=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?oo(e,t,""):oo(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=We,e.NULL=new it,e.\u0275prov=me({token:e,providedIn:"any",factory:function(){return $e(Ge)}}),e.__NG_ELEMENT_ID__=-1,e}(),lo=new qe("AnalyzeForEntryComponents"),uo=new Map,co=new Set;function ho(e){return"string"==typeof e?e:e.text()}function fo(e,t,n){var i=n?e.styles:null,r=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?r=Te(r,s):2==a&&(i=Te(i,s+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}var po=null;function mo(){if(!po){var e=ze.Symbol;if(e&&e.iterator)po=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var i=t[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(po=i)}}return po}function vo(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}var go=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function yo(e){return!!_o(e)&&(Array.isArray(e)||!(e instanceof Map)&&mo()in e)}function _o(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function xo(e,t,n){return e[t]=n}function bo(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function wo(e,t,n,i){var r=Qt();return bo(r,un(),t)&&($t(),function(e,t,n,i,r,a){var o=jt(e,t),s=t[11];if(null==i)zt(s)?s.removeAttribute(o,n,a):o.removeAttribute(n);else{var l=null==r?Un(i):r(i,e.tagName||"",n);zt(s)?s.setAttribute(o,n,l,a):a?o.setAttributeNS(a,n,l):o.setAttribute(n,l)}}(Sn(),r,e,t,n,i)),wo}function ko(e,t,n,i){return bo(e,un(),n)?t+Un(n)+i:fr}function Co(e,t,n,i,r,a,o,s){var l=Qt(),u=$t(),c=e+20,h=u.firstCreatePass?function(e,t,n,i,r,a,o,s,l){var u=t.consts,c=Mr(t,n[6],e,0,o||null,Zt(u,s));Vr(t,n,c,Zt(u,l)),En(t,c);var h=c.tViews=Br(2,-1,i,r,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,u),d=Fr(0,null,2,-1,null,null);return d.injectorIndex=c.injectorIndex,h.node=d,null!==t.queries&&(t.queries.template(t,c),h.queries=t.queries.embeddedTView(c)),c}(e,u,l,t,n,i,r,a,o):u.data[c];nn(h,!1);var d=l[11].createComment("");Ma(u,l,d,h),$i(d,l),ia(l,l[c]=ea(d,l,d,h)),Rt(h)&&Dr(u,l,h),null!=o&&zr(l,h,s)}function So(e){return Vt(Yt.lFrame.contextLView,e)}function To(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de.Default,n=Qt();return null==n?$e(e,t):ni(tn(),n,Me(e),t)}function Eo(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var i=n.length,r=0;r<i;){var a=n[r];if(Dn(a))break;if(0===a)r+=2;else if("number"==typeof a)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(a===t)return n[r+1];r+=2}}return null}(tn(),e)}function Po(){throw new Error("invalid")}function Mo(e,t,n){var i=Qt();return bo(i,un(),t)&&Hr($t(),Sn(),i,e,t,i[11],n,!1),Mo}function Io(e,t,n,i,r){var a=r?"class":"style";fa(e,n,t.inputs[a],a,i)}function Ao(e,t,n,i){var r=Qt(),a=$t(),o=20+e,s=r[11],l=r[o]=Er(t,s,Yt.lFrame.currentNamespace),u=a.firstCreatePass?function(e,t,n,i,r,a,o){var s=t.consts,l=Zt(s,a),u=Mr(t,n[6],e,3,r,l);return Vr(t,n,u,Zt(s,o)),null!==u.attrs&&fo(u,u.attrs,!1),null!==u.mergedAttrs&&fo(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(e,a,r,0,t,n,i):a.data[o];nn(u,!0);var c=u.mergedAttrs;null!==c&&Nn(s,l,c);var h=u.classes;null!==h&&Da(s,l,h);var d=u.styles;null!==d&&Na(s,l,d),Ma(a,r,l,u),0===Yt.lFrame.elementDepthCount&&$i(l,r),Yt.lFrame.elementDepthCount++,Rt(u)&&(Dr(a,r,u),Nr(a,u,r)),null!==i&&zr(r,u)}function Ro(){var e=tn();rn()?an():nn(e=e.parent,!1);var t=e;Yt.lFrame.elementDepthCount--;var n=$t();n.firstCreatePass&&(En(n,e),It(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Io(n,t,Qt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Io(n,t,Qt(),t.stylesWithoutHost,!1)}function Oo(e,t,n,i){Ao(e,t,n,i),Ro()}function No(e,t,n){var i=Qt(),r=$t(),a=e+20,o=r.firstCreatePass?function(e,t,n,i,r){var a=t.consts,o=Zt(a,i),s=Mr(t,n[6],e,4,"ng-container",o);return null!==o&&fo(s,o,!0),Vr(t,n,s,Zt(a,r)),null!==t.queries&&t.queries.elementStart(t,s),s}(e,r,i,t,n):r.data[a];nn(o,!0);var s=i[a]=i[11].createComment("");Ma(r,i,s,o),$i(s,i),Rt(o)&&(Dr(r,i,o),Nr(r,o,i)),null!=n&&zr(i,o)}function Do(){var e=tn(),t=$t();rn()?an():nn(e=e.parent,!1),t.firstCreatePass&&(En(t,e),It(e)&&t.queries.elementEnd(e))}function zo(){return Qt()}function Lo(e){return!!e&&"function"==typeof e.then}function Bo(e){return!!e&&"function"==typeof e.subscribe}function Fo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=Qt(),a=$t(),o=tn();return Ho(a,r,r[11],o,e,t,n,i),Fo}function jo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=tn(),a=Qt(),o=$t();return Ho(o,a,ha(fn(o.data),r,a),r,e,t,n,i),jo}function Ho(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,l=Rt(i),u=e.firstCreatePass&&(e.cleanup||(e.cleanup=[])),c=ua(t),h=!0;if(3===i.type){var d=jt(i,t),f=s?s(d):mt,p=f.target||d,m=c.length,v=s?function(e){return s(Bt(e[i.index])).target}:i.index;if(zt(n)){var g=null;if(!s&&l&&(g=function(e,t,n,i){var r=e.cleanup;if(null!=r)for(var a=0;a<r.length-1;a+=2){var o=r[a];if(o===n&&r[a+1]===i){var s=t[7],l=r[a+2];return s.length>l?s[l]:null}"string"==typeof o&&(a+=2)}return null}(e,t,r,i.index)),null!==g)(g.__ngLastListenerFn__||g).__ngNextListenerFn__=a,g.__ngLastListenerFn__=a,h=!1;else{a=Uo(i,t,a,!1);var y=n.listen(f.name||p,r,a);c.push(a,y),u&&u.push(r,v,m,m+1)}}else a=Uo(i,t,a,!0),p.addEventListener(r,a,o),c.push(a),u&&u.push(r,v,m,o)}var _,x=i.outputs;if(h&&null!==x&&(_=x[r])){var b=_.length;if(b)for(var w=0;w<b;w+=2){var k=t[_[w]][_[w+1]].subscribe(a),C=c.length;c.push(a,k),u&&u.push(r,i.index,C,-(C+1))}}}function Vo(e,t,n){try{return!1!==t(n)}catch(i){return da(e,i),!1}}function Uo(e,t,n,i){return function r(a){if(a===Function)return n;var o=2&e.flags?Ut(e.index,t):t;0==(32&t[2])&&ra(o);for(var s=Vo(t,n,a),l=r.__ngNextListenerFn__;l;)s=Vo(t,l,a)&&s,l=l.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function qo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Yt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Yt.lFrame.contextLView))[8]}(e)}function Go(e,t){for(var n=null,i=function(e){var t=e.attrs;if(null!=t){var n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e),r=0;r<t.length;r++){var a=t[r];if("*"!==a){if(null===i?ur(e,a,!0):cr(i,a))return r}else n=r}return n}function Wo(e){var t=Qt()[16][6];if(!t.projection)for(var n=t.projection=ut(e?e.length:1,null),i=n.slice(),r=t.child;null!==r;){var a=e?Go(r,e):0;null!==a&&(i[a]?i[a].projectionNext=r:n[a]=r,i[a]=r),r=r.next}}function Zo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=Qt(),r=$t(),a=Mr(r,i[6],e,1,null,n||null);null===a.projection&&(a.projection=t),an(),function(e,t,n){Oa(t[11],0,t,n,ka(e,n,t),Pa(n.parent||t[6],t))}(r,i,a)}function Xo(e,t,n){return Ko(e,"",t,"",n),Xo}function Ko(e,t,n,i,r){var a=Qt(),o=ko(a,t,n,i);return o!==fr&&Hr($t(),Sn(),a,e,o,a[11],r,!1),Ko}var Yo=[];function Jo(e,t,n,i,r){for(var a=e[n+1],o=null===t,s=i?br(a):kr(a),l=!1;0!==s&&(!1===l||o);){var u=e[s+1];Qo(e[s],t)&&(l=!0,e[s+1]=i?Sr(u):wr(u)),s=i?br(u):kr(u)}l&&(e[n+1]=i?wr(a):Sr(a))}function Qo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&dt(e,t)>=0}var $o={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function es(e){return e.substring($o.key,$o.keyEnd)}function ts(e,t){var n=$o.textEnd;return n===t?-1:(t=$o.keyEnd=function(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,$o.key=t,n),ns(e,t,n))}function ns(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function is(e,t,n){return os(e,t,n,!1),is}function rs(e,t){return os(e,t,null,!0),rs}function as(e,t){for(var n=function(e){return function(e){$o.key=0,$o.keyEnd=0,$o.value=0,$o.valueEnd=0,$o.textEnd=e.length}(e),ts(e,ns(e,0,$o.textEnd))}(t);n>=0;n=ts(t,n))ct(e,es(t),!0)}function os(e,t,n,i){var r,a,o=Qt(),s=$t(),l=cn(2);(s.firstUpdatePass&&ls(s,e,l,i),t!==fr&&bo(o,l,t))&&(null==n&&(r=null===(a=Yt.lFrame)?null:a.currentSanitizer)&&(n=r),hs(s,s.data[kn()+20],o,o[11],e,o[l+1]=function(e,t){return null==e||("function"==typeof t?e=t(e):"string"==typeof t?e+=t:"object"==typeof e&&(e=Se(wi(e)))),e}(t,n),i,l))}function ss(e,t){return t>=e.expandoStartIndex}function ls(e,t,n,i){var r=e.data;if(null===r[n+1]){var a=r[kn()+20],o=ss(e,n);ps(a,i)&&null===t&&!o&&(t=!1),t=function(e,t,n,i){var r=fn(e),a=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=cs(n=us(null,e,t,n,i),t.attrs,i),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=us(r,e,t,n,i),null===a){var s=function(e,t,n){var i=n?t.classBindings:t.styleBindings;if(0!==kr(i))return e[br(i)]}(e,t,i);void 0!==s&&Array.isArray(s)&&function(e,t,n,i){e[br(n?t.classBindings:t.styleBindings)]=i}(e,t,i,s=cs(s=us(null,e,t,s[1],i),t.attrs,i))}else a=function(e,t,n){for(var i=void 0,r=t.directiveEnd,a=1+t.directiveStylingLast;a<r;a++)i=cs(i,e[a].hostAttrs,n);return cs(i,t.attrs,n)}(e,t,i)}return void 0!==a&&(i?t.residualClasses=a:t.residualStyles=a),n}(r,a,t,i),function(e,t,n,i,r,a){var o=a?t.classBindings:t.styleBindings,s=br(o),l=kr(o);e[i]=n;var u,c=!1;if(Array.isArray(n)){var h=n;(null===(u=h[1])||dt(h,u)>0)&&(c=!0)}else u=n;if(r)if(0!==l){var d=br(e[s+1]);e[i+1]=xr(d,s),0!==d&&(e[d+1]=Cr(e[d+1],i)),e[s+1]=131071&e[s+1]|i<<17}else e[i+1]=xr(s,0),0!==s&&(e[s+1]=Cr(e[s+1],i)),s=i;else e[i+1]=xr(l,0),0===s?s=i:e[l+1]=Cr(e[l+1],i),l=i;c&&(e[i+1]=wr(e[i+1])),Jo(e,u,i,!0),Jo(e,u,i,!1),function(e,t,n,i,r){var a=r?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&dt(a,t)>=0&&(n[i+1]=Sr(n[i+1]))}(t,u,e,i,a),o=xr(s,l),a?t.classBindings=o:t.styleBindings=o}(r,a,t,n,o,i)}}function us(e,t,n,i,r){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(i=cs(i,(a=t[s]).hostAttrs,r),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),i}function cs(e,t,n){var i=n?1:2,r=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),ct(e,o,!!n||t[++a]))}return void 0===e?null:e}function hs(e,t,n,i,r,a,o,s){if(3===t.type){var l=e.data,u=l[s+1];fs(1==(1&u)?ds(l,t,n,r,kr(u),o):void 0)||(fs(a)||2==(2&u)&&(a=ds(l,null,n,r,s,o)),function(e,t,n,i,r){var a=zt(e);if(t)r?a?e.addClass(n,i):n.classList.add(i):a?e.removeClass(n,i):n.classList.remove(i);else{var o=-1==i.indexOf("-")?void 0:2;null==r?a?e.removeStyle(n,i,o):n.style.removeProperty(i):a?e.setStyle(n,i,r,o):n.style.setProperty(i,r)}}(i,o,Ft(kn(),n),r,a))}}function ds(e,t,n,i,r,a){for(var o=null===t,s=void 0;r>0;){var l=e[r],u=Array.isArray(l),c=u?l[1]:l,h=null===c,d=n[r+1];d===fr&&(d=h?Yo:void 0);var f=h?ht(d,i):c===i?d:void 0;if(u&&!fs(f)&&(f=ht(l,i)),fs(f)&&(s=f,o))return s;var p=e[r+1];r=o?br(p):kr(p)}if(null!==t){var m=a?t.residualClasses:t.residualStyles;null!=m&&(s=ht(m,i))}return s}function fs(e){return void 0!==e}function ps(e,t){return 0!=(e.flags&(t?16:32))}function ms(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Qt(),i=$t(),r=e+20,a=i.firstCreatePass?Mr(i,n[6],e,3,null,null):i.data[r],o=n[r]=function(e,t){return zt(t)?t.createText(e):t.createTextNode(e)}(t,n[11]);Ma(i,n,o,a),nn(a,!1)}function vs(e){return gs("",e,""),vs}function gs(e,t,n){var i=Qt(),r=ko(i,e,t,n);return r!==fr&&function(e,t,n){var i=Ft(t,e),r=e[11];zt(r)?r.setValue(i,n):i.textContent=n}(i,kn(),r),gs}function ys(e,t,n){var i=Qt();return bo(i,un(),t)&&Hr($t(),Sn(),i,e,t,i[11],n,!0),ys}function _s(e,t,n){var i=Qt();if(bo(i,un(),t)){var r=$t(),a=Sn();Hr(r,a,i,e,t,ha(fn(r.data),a,i),n,!0)}return _s}function xs(e,t){var n=qt(e)[1],i=n.data.length-1;En(n,{directiveStart:i,directiveEnd:i+1})}function bs(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0,i=[e];t;){var r=void 0;if(Ot(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(n){i.push(r);var a=e;a.inputs=ws(e.inputs),a.declaredInputs=ws(e.declaredInputs),a.outputs=ws(e.outputs);var o=r.hostBindings;o&&Ss(e,o);var s=r.viewQuery,l=r.contentQueries;if(s&&ks(e,s),l&&Cs(e,l),pe(e.inputs,r.inputs),pe(e.declaredInputs,r.declaredInputs),pe(e.outputs,r.outputs),Ot(r)&&r.data.animation){var u=e.data;u.animation=(u.animation||[]).concat(r.data.animation)}a.afterContentChecked=a.afterContentChecked||r.afterContentChecked,a.afterContentInit=e.afterContentInit||r.afterContentInit,a.afterViewChecked=e.afterViewChecked||r.afterViewChecked,a.afterViewInit=e.afterViewInit||r.afterViewInit,a.doCheck=e.doCheck||r.doCheck,a.onDestroy=e.onDestroy||r.onDestroy,a.onInit=e.onInit||r.onInit}var c=r.features;if(c)for(var h=0;h<c.length;h++){var d=c[h];d&&d.ngInherit&&d(e),d===bs&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,i=e.length-1;i>=0;i--){var r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Ln(r.hostAttrs,n=Ln(n,r.hostAttrs))}}(i)}function ws(e){return e===mt?{}:e===vt?[]:e}function ks(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,i){t(e,i),n(e,i)}:t}function Cs(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,i,r){t(e,i,r),n(e,i,r)}:t}function Ss(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,i){t(e,i),n(e,i)}:t}var Ts=function(){function e(t,n,i){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=i}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Es(e){e.type.prototype.ngOnChanges&&(e.setInput=Ps,e.onChanges=function(){var e=Ms(this),t=e&&e.current;if(t){var n=e.previous;if(n===mt)e.previous=t;else for(var i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}})}function Ps(e,t,n,i){var r=Ms(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:mt,current:null}),a=r.current||(r.current={}),o=r.previous,s=this.declaredInputs[n],l=o[s];a[s]=new Ts(l&&l.currentValue,t,o===mt),e[i]=t}function Ms(e){return e.__ngSimpleChanges__||null}function Is(e,t,n,i,r){if(e=Me(e),Array.isArray(e))for(var a=0;a<e.length;a++)Is(e[a],t,n,i,r);else{var o=$t(),s=Qt(),l=ao(e)?e:Me(e.provide),u=no(e),c=tn(),h=65535&c.providerIndexes,d=c.directiveStart,f=c.providerIndexes>>16;if(ao(e)||!e.multi){var p=new On(u,r,To),m=Os(l,t,r?h:h+f,d);-1===m?(ti(Jn(c,s),o,l),As(o,e,t.length),t.push(l),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=65536),n.push(p),s.push(p)):(n[m]=p,s[m]=p)}else{var v=Os(l,t,h+f,d),g=Os(l,t,h,h+f),y=v>=0&&n[v],_=g>=0&&n[g];if(r&&!_||!r&&!y){ti(Jn(c,s),o,l);var x=function(e,t,n,i,r){var a=new On(e,n,To);return a.multi=[],a.index=t,a.componentProviders=0,Rs(a,r,i&&!n),a}(r?Ds:Ns,n.length,r,i,u);!r&&_&&(n[g].providerFactory=x),As(o,e,t.length,0),t.push(l),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=65536),n.push(x),s.push(x)}else As(o,e,v>-1?v:g,Rs(n[r?g:v],u,!r&&i));!r&&i&&_&&n[g].componentProviders++}}}function As(e,t,n,i){var r=ao(t);if(r||t.useClass){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[i,a]):o[s+1].push(i,a)}else o.push(n,a)}}}function Rs(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Os(e,t,n,i){for(var r=n;r<i;r++)if(t[r]===e)return r;return-1}function Ns(e,t,n,i){return zs(this.multi,[])}function Ds(e,t,n,i){var r,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=oi(n,n[1],this.providerFactory.index,i);zs(a,r=s.slice(0,o));for(var l=o;l<s.length;l++)r.push(s[l])}else zs(a,r=[]);return r}function zs(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function Ls(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,i){return function(e,t,n){var i=$t();if(i.firstCreatePass){var r=Ot(e);Is(n,i.data,i.blueprint,r,!0),Is(t,i.data,i.blueprint,r,!1)}}(n,i?i(e):e,t)}}}Es.ngInherit=!0;var Bs,Fs=_createClass((function e(){_classCallCheck(this,e)})),js=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(Se(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),Hs=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.NULL=new js,e}(),Vs=function(){var e=_createClass((function e(t){_classCallCheck(this,e),this.nativeElement=t}));return e.__NG_ELEMENT_ID__=function(){return Us(e)},e}(),Us=function(e){return Ha(e,tn(),Qt())},qs=_createClass((function e(){_classCallCheck(this,e)})),Gs=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),Ws=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.__NG_ELEMENT_ID__=function(){return Zs()},e}(),Zs=function(){var e=Qt(),t=Ut(tn().index,e);return function(e){var t=e[11];if(zt(t))return t;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Pt(t)?t:e)},Xs=((Bs=_createClass((function e(){_classCallCheck(this,e)}))).\u0275prov=me({token:Bs,providedIn:"root",factory:function(){return null}}),Bs),Ks=_createClass((function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")})),Ys=new Ks("9.1.13"),Js=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return yo(e)}},{key:"create",value:function(e){return new $s(e)}}]),e}(),Qs=function(e,t){return t},$s=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Qs}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,i=0,r=null;t||n;){var a=!n||t&&t.currentIndex<il(n,i,r)?t:n,o=il(a,i,r),s=a.currentIndex;if(a===n)i--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)i++;else{r||(r=[]);var l=o-i,u=s-i;if(l!=u){for(var c=0;c<l;c++){var h=c<r.length?r[c]:r[c]=0,d=h+c;u<=d&&d<l&&(r[c]=h+1)}r[a.previousIndex]=u-l}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!yo(e))throw new Error("Error trying to diff '".concat(Se(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,i,r,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)i=e[s],r=this._trackByFn(s,i),null!==a&&vo(a.trackById,r)?(o&&(a=this._verifyReinsertion(a,i,r,s)),vo(a.item,i)||this._addIdentityChange(a,i)):(a=this._mismatch(a,i,r,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var i,r=e[mo()]();!(i=r.next()).done;)t(i.value)}(e,(function(e){r=t._trackByFn(n,e),null!==a&&vo(a.trackById,r)?(o&&(a=t._verifyReinsertion(a,e,r,n)),vo(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,r,n),o=!0),a=a._next,n++})),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,i){var r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(vo(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,i)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(vo(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,i)):e=this._addAfter(new el(t,n),r,i),e}},{key:"_verifyReinsertion",value:function(e,t,n,i){var r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?e=this._reinsertAfter(r,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var i=e._prevRemoved,r=e._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new nl),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new nl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),el=_createClass((function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null})),tl=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&vo(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),nl=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new tl,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function il(e,t,n){var i=e.previousIndex;if(null===i)return i;var r=0;return n&&i<n.length&&(r=n[i]),i+t+r}var rl=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||_o(e)}},{key:"create",value:function(){return new al}}]),e}(),al=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||_o(e)))throw new Error("Error trying to diff '".concat(Se(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,i){if(n&&n.key===i)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var r=t._getOrCreateRecordForKey(i,e);n=t._insertBeforeOrAppend(n,r)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}var a=new ol(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){vo(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}}]),e}(),ol=_createClass((function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null})),sl=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var i=n.factories.slice();t=t.concat(i)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new he,new ue]]}}}]),e}();return e.\u0275prov=me({token:e,providedIn:"root",factory:function(){return new e([new Js])}}),e}(),ll=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var i=n.factories.slice();t=t.concat(i)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new he,new ue]]}}}]),e}();return e.\u0275prov=me({token:e,providedIn:"root",factory:function(){return new e([new rl])}}),e}(),ul=[new rl],cl=new sl([new Js]),hl=new ll(ul),dl=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.__NG_ELEMENT_ID__=function(){return fl(e,Vs)},e}(),fl=function(e,t){return Va(e,t,tn(),Qt())},pl=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.__NG_ELEMENT_ID__=function(){return ml(e,Vs)},e}(),ml=function(e,t){return Ua(e,t,tn(),Qt())},vl={},gl=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).ngModule=e,n}return _inherits(t,e),_createClass(t,[{key:"resolveComponentFactory",value:function(e){var t=St(e);return new xl(t,this.ngModule)}}]),t}(Hs);function yl(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var _l=new qe("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Gn}}),xl=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).componentDef=e,i.ngModule=n,i.componentType=e.type,i.selector=e.selectors.map(dr).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!n,i}return _inherits(t,e),_createClass(t,[{key:"inputs",get:function(){return yl(this.componentDef.inputs)}},{key:"outputs",get:function(){return yl(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,i){var r,a,o=(i=i||this.ngModule)?function(e,t){return{get:function(n,i,r){var a=e.get(n,vl,r);return a!==vl||i===vl?a:t.get(n,i,r)}}}(e,i.injector):e,s=o.get(qs,Lt),l=o.get(Xs,null),u=s.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(zt(e))return e.selectRootElement(t,n===pt.ShadowDom);var i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(u,n,this.componentDef.encapsulation):Er(c,s.createRenderer(null,this.componentDef),function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(c)),d=this.componentDef.onPush?576:528,f="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),p={components:[],scheduler:Gn,clean:la,playerHandler:null,flags:0},m=Br(0,-1,null,1,0,null,null,null,null,null),v=Pr(null,m,p,d,null,null,s,u,l,o);gn(v,null);try{var g=function(e,t,n,i,r,a){var o=n[1];n[20]=e;var s=Mr(o,null,0,3,null,null),l=s.mergedAttrs=t.hostAttrs;null!==l&&(fo(s,l,!0),null!==e&&(Nn(r,e,l),null!==s.classes&&Da(r,e,s.classes),null!==s.styles&&Na(r,e,s.styles)));var u=i.createRenderer(e,t),c=Pr(n,Lr(t),null,t.onPush?64:16,n[20],s,i,u,void 0);return o.firstCreatePass&&(ti(Jn(s,n),o,t.type),Zr(o,s),Kr(s,n.length,1)),ia(n,c),n[20]=c}(h,this.componentDef,v,s,u);if(h)if(n)Nn(u,h,["ng-version",Ys.full]);else{var y=function(e){for(var t=[],n=[],i=1,r=2;i<e.length;){var a=e[i];if("string"==typeof a)2===r?""!==a&&t.push(a,e[++i]):8===r&&n.push(a);else{if(!sr(r))break;r=a}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),_=y.attrs,x=y.classes;_&&Nn(u,h,_),x&&x.length>0&&Da(u,h,x.join(" "))}if(a=Ht(m,0),void 0!==t)for(var b=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var k=t[w];b.push(null!=k?Array.from(k):null)}r=function(e,t,n,i,r){var a=n[1],o=function(e,t,n){var i=tn();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Wr(e,i,1),Yr(e,t,n));var r=oi(t,e,t.length-1,i);$i(r,t);var a=jt(i,t);return a&&$i(a,t),r}(a,n,t);i.components.push(o),e[8]=o,r&&r.forEach((function(e){return e(o,t)})),t.contentQueries&&t.contentQueries(1,o,n.length-1);var s=tn();if(a.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){Cn(s.index-20);var l=n[1];Ur(l,t),qr(l,n,t.hostVars),Gr(t,o)}return o}(g,this.componentDef,v,p,[xs]),Ir(m,v,null)}finally{wn()}var C=new bl(this.componentType,r,Ha(Vs,a,v),v,a);return n&&!f||(m.node.child=a),C}}]),t}(Fs),bl=function(e){function t(e,n,i,r,a){var o,s,l,u;return _classCallCheck(this,t),(o=_callSuper(this,t)).location=i,o._rootLView=r,o._tNode=a,o.destroyCbs=[],o.instance=n,o.hostView=o.changeDetectorRef=new ja(r),s=r[1],l=r,null==(u=s.node)&&(s.node=u=Fr(0,null,2,-1,null,null)),l[6]=u,o.componentType=e,o}return _inherits(t,e),_createClass(t,[{key:"injector",get:function(){return new ui(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(e){this.destroyCbs&&this.destroyCbs.push(e)}}]),t}(function(){return _createClass((function e(){_classCallCheck(this,e)}))}()),wl=void 0,kl=["en",[["a","p"],["AM","PM"],wl],[["AM","PM"],wl,wl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wl,"{1} 'at' {0}",wl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Cl={};function Sl(e){return e in Cl||(Cl[e]=ze.ng&&ze.ng.common&&ze.ng.common.locales&&ze.ng.common.locales[e]),Cl[e]}var Tl=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,Directionality:19,PluralCase:20,ExtraData:21};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.Directionality]="Directionality",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();function El(e){var t;null==(t=e)&&function(e,t,n,i){throw new Error("ASSERTION ERROR: Expected localeId to be defined"+" [Expected=> null != ".concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var Pl=new Map,Ml=function(e){function t(e,n){var i;_classCallCheck(this,t),(i=_callSuper(this,t))._parent=n,i._bootstrapComponents=[],i.injector=_assertThisInitialized2(i),i.destroyCbs=[],i.componentFactoryResolver=new gl(_assertThisInitialized2(i));var r=Et(e),a=e[He]||null;return a&&El(a),i._bootstrapComponents=Zn(r.bootstrap),i._r3Injector=$a(e,n,[{provide:rt,useValue:_assertThisInitialized2(i)},{provide:Hs,useValue:i.componentFactoryResolver}],Se(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:so.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:de.Default;return e===so||e===rt||e===Ge?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),t}(rt),Il=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).moduleType=e,null!==Et(e)&&function e(t){if(null!==t.\u0275mod.id){var n=t.\u0275mod.id;(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(Se(t)," vs ").concat(Se(t.name)))})(n,Pl.get(n),t),Pl.set(n,t)}var i=t.\u0275mod.imports;i instanceof Function&&(i=i()),i&&i.forEach((function(t){return e(t)}))}(e),n}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e){return new Ml(this.moduleType,e)}}]),t}(at);function Al(e,t,n,i){return Nl(Qt(),ln(),e,t,n,i)}function Rl(e,t,n,i,r){return function(e,t,n,i,r,a,o){var s=t+n;return function(e,t,n,i){var r=bo(e,t,n);return bo(e,t+1,i)||r}(e,s,r,a)?xo(e,s+2,o?i.call(o,r,a):i(r,a)):Ol(e,s+2)}(Qt(),ln(),e,t,n,i,r)}function Ol(e,t){var n=e[t];return n===fr?void 0:n}function Nl(e,t,n,i,r,a){var o=t+n;return bo(e,o,r)?xo(e,o+1,a?i.call(a,r):i(r)):Ol(e,o+1)}var Dl=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,t),(e=_callSuper(this,t)).__isAsync=n,e}return _inherits(t,e),_createClass(t,[{key:"emit",value:function(e){_get(_getPrototypeOf2(t.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,n,i){var r,a=function(e){return null},o=function(){return null};e&&"object"==typeof e?(r=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(a=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(o=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(r=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},n&&(a=this.__isAsync?function(e){setTimeout((function(){return n(e)}))}:function(e){n(e)}),i&&(o=this.__isAsync?function(){setTimeout((function(){return i()}))}:function(){i()}));var s=_get(_getPrototypeOf2(t.prototype),"subscribe",this).call(this,r,a,o);return e instanceof p&&e.add(s),s}}]),t}(I);function zl(){return this._results[mo()]()}var Ll=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new Dl,this.length=0;var t=mo(),n=e.prototype;n[t]||(n[t]=zl)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,n){void 0===n&&(n=t);for(var i=0;i<t.length;i++){var r=t[i];Array.isArray(r)?(n===t&&(n=t.slice(0,i)),e(r,n)):n!==t&&n.push(r)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),Bl=function(){function e(t){_classCallCheck(this,e),this.queryList=t,this.matches=null}return _createClass(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),Fl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[],a=0;a<i;a++){var o=n.getByIndex(a);r.push(this.queries[o.indexInDeclarationView].clone())}return new e(r)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==nu(e,t).matches&&this.queries[t].setDirty()}}]),e}(),jl=_createClass((function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.predicate=t,this.descendants=n,this.isStatic=i,this.read=r})),Hl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,i=0;i<this.length;i++){var r=null!==n?n.length:0,a=this.getByIndex(i).embeddedTView(t,r);a&&(a.indexInDeclarationView=i,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),Vl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_classCallCheck(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return _createClass(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&!1===this.metadata.descendants){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&4===n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){if(Array.isArray(this.metadata.predicate))for(var n=this.metadata.predicate,i=0;i<n.length;i++)this.matchTNodeWithReadOption(e,t,Ul(t,n[i]));else{var r=this.metadata.predicate;r===dl?0===t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ai(t,e,r,!1,!1))}}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var i=this.metadata.read;if(null!==i)if(i===Vs||i===pl||i===dl&&0===t.type)this.addMatch(t.index,-2);else{var r=ai(t,e,i,!1,!1);null!==r&&this.addMatch(t.index,r)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function Ul(e,t){var n=e.localNames;if(null!==n)for(var i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function ql(e,t,n,i){return-1===n?function(e,t){return 3===e.type||4===e.type?Ha(Vs,e,t):0===e.type?Va(dl,Vs,e,t):null}(t,e):-2===n?function(e,t,n){return n===Vs?Ha(Vs,t,e):n===dl?Va(dl,Vs,t,e):n===pl?Ua(pl,Vs,t,e):void 0}(e,t,i):oi(e,e[1],n,t)}function Gl(e,t,n,i){var r=t[19].queries[i];if(null===r.matches){for(var a=e.data,o=n.matches,s=[],l=0;l<o.length;l+=2){var u=o[l];s.push(u<0?null:ql(t,a[u],o[l+1],n.metadata.read))}r.matches=s}return r.matches}function Wl(e){var t=Qt(),n=$t(),i=pn();mn(i+1);var r=nu(n,i);if(e.dirty&&Gt(t)===r.metadata.isStatic){if(null===r.matches)e.reset([]);else{var a=r.crossesNgTemplate?function e(t,n,i,r){var a=t.queries.getByIndex(i),o=a.matches;if(null!==o)for(var s=Gl(t,n,a,i),l=0;l<o.length;l+=2){var u=o[l];if(u>0)r.push(s[l/2]);else{for(var c=o[l+1],h=n[-u],d=10;d<h.length;d++){var f=h[d];f[17]===f[3]&&e(f[1],f,c,r)}if(null!==h[9])for(var p=h[9],m=0;m<p.length;m++){var v=p[m];e(v[1],v,c,r)}}}return r}(n,t,i,[]):Gl(n,t,r,i);e.reset(a),e.notifyOnChanges()}return!0}return!1}function Zl(e,t,n){Kl($t(),Qt(),e,t,n,!0)}function Xl(e,t,n){Kl($t(),Qt(),e,t,n,!1)}function Kl(e,t,n,i,r,a){e.firstCreatePass&&(tu(e,new jl(n,i,a,r),-1),a&&(e.staticViewQueries=!0)),eu(e,t)}function Yl(e,t,n,i){Ql($t(),Qt(),t,n,i,!1,tn(),e)}function Jl(e,t,n,i){Ql($t(),Qt(),t,n,i,!0,tn(),e)}function Ql(e,t,n,i,r,a,o,s){e.firstCreatePass&&(tu(e,new jl(n,i,a,r),o.index),function(e,t){var n=e.contentQueries||(e.contentQueries=[]);t!==(e.contentQueries.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(e,s),a&&(e.staticContentQueries=!0)),eu(e,t)}function $l(){return e=Qt(),t=pn(),e[19].queries[t].queryList;var e,t}function eu(e,t){var n=new Ll;!function(e,t,n,i){var r=ua(t);r.push(n),e.firstCreatePass&&ca(e).push(i,r.length-1)}(e,t,n,n.destroy),null===t[19]&&(t[19]=new Fl),t[19].queries.push(new Bl(n))}function tu(e,t,n){null===e.queries&&(e.queries=new Hl),e.queries.track(new Vl(t,n))}function nu(e,t){return e.queries.getByIndex(t)}var iu=new qe("Application Initializer"),ru=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var i=0;i<this.appInits.length;i++){var r=this.appInits[i]();Lo(r)&&t.push(r)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)($e(iu,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}(),au=new qe("AppId"),ou={provide:au,useFactory:function(){return"".concat(su()).concat(su()).concat(su())},deps:[]};function su(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var lu=new qe("Platform Initializer"),uu=new qe("Platform ID"),cu=new qe("appBootstrapListener"),hu=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}(),du=new qe("LocaleId"),fu=new qe("DefaultCurrencyCode"),pu=_createClass((function e(t,n){_classCallCheck(this,e),this.ngModuleFactory=t,this.componentFactories=n})),mu=function(e){return new Il(e)},vu=mu,gu=function(e){return Promise.resolve(mu(e))},yu=function(e){var t=mu(e),n=Zn(Et(e).declarations).reduce((function(e,t){var n=St(t);return n&&e.push(new xl(n)),e}),[]);return new pu(t,n)},_u=yu,xu=function(e){return Promise.resolve(yu(e))},bu=function(){var e=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=vu,this.compileModuleAsync=gu,this.compileModuleAndAllComponentsSync=_u,this.compileModuleAndAllComponentsAsync=xu}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}(),wu=new qe("compilerOptions"),ku=Promise.resolve(0);function Cu(e){"undefined"==typeof Zone?ku.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var Su=function(){function e(t){var n,i,r=t.enableLongStackTrace,a=void 0!==r&&r,o=t.shouldCoalesceEventChangeDetection,s=void 0!==o&&o;if(_classCallCheck(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Dl(!1),this.onMicrotaskEmpty=new Dl(!1),this.onStable=new Dl(!1),this.onError=new Dl(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),a&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=s,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=ze.requestAnimationFrame,t=ze.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,i=!!(n=this).shouldCoalesceEventChangeDetection&&n.nativeRequestAnimationFrame&&function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(ze,(function(){e.lastRequestAnimationFrameId=-1,Mu(e),Pu(e)})),Mu(e))}(n)},n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:i},onInvokeTask:function(e,t,r,a,o,s){try{return Iu(n),e.invokeTask(r,a,o,s)}finally{i&&"eventTask"===a.type&&i(),Au(n)}},onInvoke:function(e,t,i,r,a,o,s){try{return Iu(n),e.invoke(i,r,a,o,s)}finally{Au(n)}},onHasTask:function(e,t,i,r){e.hasTask(i,r),t===i&&("microTask"==r.change?(n._hasPendingMicrotasks=r.microTask,Mu(n),Pu(n)):"macroTask"==r.change&&(n.hasPendingMacrotasks=r.macroTask))},onHandleError:function(e,t,i,r){return e.handleError(i,r),n.runOutsideAngular((function(){return n.onError.emit(r)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,i){var r=this._inner,a=r.scheduleEventTask("NgZoneEvent: "+i,e,Eu,Tu,Tu);try{return r.runTask(a,t,n)}finally{r.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function Tu(){}var Eu={};function Pu(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function Mu(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function Iu(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Au(e){e._nesting--,Pu(e)}var Ru,Ou=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Dl,this.onMicrotaskEmpty=new Dl,this.onStable=new Dl,this.onError=new Dl}return _createClass(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,i){return e.apply(t,n)}}]),e}(),Nu=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){Su.assertNotInAngularZone(),Cu((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())Cu((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var i=this,r=-1;t&&t>0&&(r=setTimeout((function(){i._callbacks=i._callbacks.filter((function(e){return e.timeoutId!==r})),e(i._didWork,i.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)($e(Su))},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}(),Du=function(){var e=function(){function e(){_classCallCheck(this,e),this._applications=new Map,zu.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return zu.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}(),zu=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),Lu=function(e,t,n){var i=e.get(wu,[]).concat(t),r=new Il(n);if(0===uo.size)return Promise.resolve(r);var a,o,s=(a=i.map((function(e){return e.providers})),o=[],a.forEach((function(e){return e&&o.push.apply(o,_toConsumableArray(e))})),o);if(0===s.length)return Promise.resolve(r);var l=function(){var e=ze.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),u=so.create({providers:s}).get(l.ResourceLoader);return function(e){var t=[],n=new Map;function i(e){var t=n.get(e);if(!t){var i=function(e){return Promise.resolve(u.get(e))}(e);n.set(e,t=i.then(ho))}return t}return uo.forEach((function(e,n){var r=[];e.templateUrl&&r.push(i(e.templateUrl).then((function(t){e.template=t})));var a=e.styleUrls,o=e.styles||(e.styles=[]),s=e.styles.length;a&&a.forEach((function(t,n){o.push(""),r.push(i(t).then((function(i){o[s+n]=i,a.splice(a.indexOf(t),1),0==a.length&&(e.styleUrls=void 0)})))}));var l=Promise.all(r).then((function(){return function(e){co.delete(e)}(n)}));t.push(l)})),uo=new Map,Promise.all(t).then((function(){}))}().then((function(){return r}))},Bu=new qe("AllowMultipleToken"),Fu=_createClass((function e(t,n){_classCallCheck(this,e),this.name=t,this.token=n}));function ju(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i="Platform: "+t,r=new qe(i);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=Hu();if(!a||a.injector.get(Bu,!1))if(e)e(n.concat(t).concat({provide:r,useValue:!0}));else{var o=n.concat(t).concat({provide:r,useValue:!0},{provide:Za,useValue:"platform"});!function(e){if(Ru&&!Ru.destroyed&&!Ru.injector.get(Bu,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ru=e.get(Vu);var t=e.get(lu,null);t&&t.forEach((function(e){return e()}))}(so.create({providers:o,name:i}))}return function(e){var t=Hu();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function Hu(){return Ru&&!Ru.destroyed?Ru:null}var Vu=function(){var e=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,i,r=this,a=(n=t?t.ngZone:void 0,i=t&&t.ngZoneEventCoalescing||!1,"noop"===n?new Ou:("zone.js"===n?void 0:n)||new Su({enableLongStackTrace:Ei(),shouldCoalesceEventChangeDetection:i})),o=[{provide:Su,useValue:a}];return a.run((function(){var t=so.create({providers:o,parent:r.injector,name:e.moduleType.name}),n=e.create(t),i=n.injector.get(mi,null);if(!i)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return Wu(r._modules,n)})),a.runOutsideAngular((function(){return a.onError.subscribe({next:function(e){i.handleError(e)}})})),function(e,t,i){try{var a=((o=n.injector.get(ru)).runInitializers(),o.donePromise.then((function(){return El(n.injector.get(du,"en-US")||"en-US"),r._moduleDoBootstrap(n),n})));return Lo(a)?a.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):a}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var o}(i,a)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=Uu({},n);return Lu(this.injector,i,e).then((function(e){return t.bootstrapModuleFactory(e,i)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Gu);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(Se(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)($e(so))},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}();function Uu(e,t){return Array.isArray(t)?t.reduce(Uu,e):Object.assign(Object.assign({},e),t)}var qu,Gu=((qu=function(){function e(t,n,i,r,a,o){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=a,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Ei(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var l=new C((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),u=new C((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){Su.assertNotInAngularZone(),Cu((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){Su.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=J(l,u.pipe(ae()))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,i=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof Fs?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var r=n.isBoundToModule?void 0:this._injector.get(rt),a=n.create(so.NULL,[],t||n.selector,r);a.onDestroy((function(){i._unloadComponent(a)}));var o=a.injector.get(Nu,null);return o&&a.injector.get(Du).registerApplication(a.location.nativeElement,o),this._loadComponent(a),Ei()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=_createForOfIteratorHelper(this._views);try{for(n.s();!(t=n.n()).done;)t.value.detectChanges()}catch(a){n.e(a)}finally{n.f()}if(this._enforceNoNewChanges){var i,r=_createForOfIteratorHelper(this._views);try{for(r.s();!(i=r.n()).done;)i.value.checkNoChanges()}catch(a){r.e(a)}finally{r.f()}}}catch(o){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(o)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;Wu(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(cu,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),Wu(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||qu)($e(Su),$e(hu),$e(so),$e(mi),$e(Hs),$e(ru))},qu.\u0275prov=me({token:qu,factory:qu.\u0275fac}),qu);function Wu(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Zu=_createClass((function e(){_classCallCheck(this,e)})),Xu=_createClass((function e(){_classCallCheck(this,e)})),Ku={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Yu=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._compiler=t,this._config=n||Ku}return _createClass(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,i=_slicedToArray(e.split("#"),2),r=i[0],a=i[1];return void 0===a&&(a="default"),n("zn8P")(r).then((function(e){return e[a]})).then((function(e){return Ju(e,r,a)})).then((function(e){return t._compiler.compileModuleAsync(e)}))}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),i=t[0],r=t[1],a="NgFactory";return void 0===r&&(r="default",a=""),n("zn8P")(this._config.factoryPathPrefix+i+this._config.factoryPathSuffix).then((function(e){return e[r+a]})).then((function(e){return Ju(e,i,r)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)($e(bu),$e(Xu,8))},e.\u0275prov=me({token:e,factory:e.\u0275fac}),e}();function Ju(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var Qu=ju(null,"core",[{provide:uu,useValue:"unknown"},{provide:Vu,deps:[so]},{provide:Du,deps:[]},{provide:hu,deps:[]}]),$u=[{provide:Gu,useClass:Gu,deps:[Su,hu,so,mi,Hs,ru]},{provide:_l,deps:[Su],useFactory:function(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}},{provide:ru,useClass:ru,deps:[[new ue,iu]]},{provide:bu,useClass:bu,deps:[]},ou,{provide:sl,useFactory:function(){return cl},deps:[]},{provide:ll,useFactory:function(){return hl},deps:[]},{provide:du,useFactory:function(e){return El(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new le(du),new ue,new he]]},{provide:fu,useValue:"USD"}],ec=function(){var e=_createClass((function e(t){_classCallCheck(this,e)}));return e.\u0275mod=wt({type:e}),e.\u0275inj=ve({factory:function(t){return new(t||e)($e(Gu))},providers:$u}),e}(),tc=null;function nc(){return tc}var ic,rc=new qe("DocumentToken"),ac=((ic=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||ic)},ic.\u0275prov=me({factory:oc,token:ic,providedIn:"platform"}),ic);function oc(){return $e(uc)}var sc,lc=new qe("Location Initialized"),uc=((sc=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._doc=e,n._init(),n}return _inherits(t,e),_createClass(t,[{key:"_init",value:function(){this.location=nc().getLocation(),this._history=nc().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return nc().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){nc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){nc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){cc()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){cc()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}}]),t}(ac)).\u0275fac=function(e){return new(e||sc)($e(rc))},sc.\u0275prov=me({factory:hc,token:sc,providedIn:"platform"}),sc);function cc(){return!!window.history.pushState}function hc(){return new uc($e(rc))}function dc(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function fc(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function pc(e){return e&&"?"!==e[0]?"?"+e:e}var mc,vc=((mc=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||mc)},mc.\u0275prov=me({factory:gc,token:mc,providedIn:"root"}),mc);function gc(e){var t=$e(rc).location;return new wc($e(ac),t&&t.origin||"")}var yc,_c,xc,bc=new qe("appBaseHref"),wc=((xc=function(e){function t(e,n){var i;if(_classCallCheck(this,t),(i=_callSuper(this,t))._platformLocation=e,null==n&&(n=i._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=n,_possibleConstructorReturn(i)}return _inherits(t,e),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return dc(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+pc(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,i){var r=this.prepareExternalUrl(n+pc(i));this._platformLocation.pushState(e,t,r)}},{key:"replaceState",value:function(e,t,n,i){var r=this.prepareExternalUrl(n+pc(i));this._platformLocation.replaceState(e,t,r)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(vc)).\u0275fac=function(e){return new(e||xc)($e(ac),$e(bc,8))},xc.\u0275prov=me({token:xc,factory:xc.\u0275fac}),xc),kc=((_c=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._platformLocation=e,i._baseHref="",null!=n&&(i._baseHref=n),i}return _inherits(t,e),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=dc(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,i){var r=this.prepareExternalUrl(n+pc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(e,t,r)}},{key:"replaceState",value:function(e,t,n,i){var r=this.prepareExternalUrl(n+pc(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,r)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(vc)).\u0275fac=function(e){return new(e||_c)($e(ac),$e(bc,8))},_c.\u0275prov=me({token:_c,factory:_c.\u0275fac}),_c),Cc=((yc=function(){function e(t,n){var i=this;_classCallCheck(this,e),this._subject=new Dl,this._urlChangeListeners=[],this._platformStrategy=t;var r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=fc(Tc(r)),this._platformStrategy.onPopState((function(e){i._subject.emit({url:i.path(!0),pop:!0,state:e.state,type:e.type})}))}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+pc(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,Tc(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+pc(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+pc(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe((function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(e,t)}))}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}()).\u0275fac=function(e){return new(e||yc)($e(vc),$e(ac))},yc.normalizeQueryParams=pc,yc.joinWithSlash=dc,yc.stripTrailingSlash=fc,yc.\u0275prov=me({factory:Sc,token:yc,providedIn:"root"}),yc);function Sc(){return new Cc($e(vc),$e(ac))}function Tc(e){return e.replace(/\/index.html$/,"")}var Ec,Pc=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),Mc=_createClass((function e(){_classCallCheck(this,e)})),Ic=((Ec=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).locale=e,n}return _inherits(t,e),_createClass(t,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return function(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Sl(t);if(n)return n;var i=t.split("-")[0];if(n=Sl(i))return n;if("en"===i)return kl;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[Tl.PluralCase]}(t||this.locale)(e)){case Pc.Zero:return"zero";case Pc.One:return"one";case Pc.Two:return"two";case Pc.Few:return"few";case Pc.Many:return"many";default:return"other"}}}]),t}(Mc)).\u0275fac=function(e){return new(e||Ec)($e(du))},Ec.\u0275prov=me({token:Ec,factory:Ec.\u0275fac}),Ec);function Ac(e,t){t=encodeURIComponent(t);var n,i=_createForOfIteratorHelper(e.split(";"));try{for(i.s();!(n=i.n()).done;){var r=n.value,a=r.indexOf("="),o=_slicedToArray(-1==a?[r,""]:[r.slice(0,a),r.slice(a+1)],2),s=o[0],l=o[1];if(s.trim()===t)return decodeURIComponent(l)}}catch(u){i.e(u)}finally{i.f()}return null}var Rc,Oc,Nc,Dc=((Rc=function(){function e(t,n,i,r){_classCallCheck(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=i,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return _createClass(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(yo(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachRemovedItem((function(e){e.previousValue&&t._toggleClass(e.key,!1)}))}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+Se(e.item));t._toggleClass(e.item,!0)})),e.forEachRemovedItem((function(e){return t._toggleClass(e.item,!1)}))}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!0)})):Object.keys(e).forEach((function(n){return t._toggleClass(n,!!e[n])})))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!1)})):Object.keys(e).forEach((function(e){return t._toggleClass(e,!1)})))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach((function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)}))}}]),e}()).\u0275fac=function(e){return new(e||Rc)(To(sl),To(ll),To(Vs),To(Ws))},Rc.\u0275dir=Ct({type:Rc,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),Rc),zc=function(){function e(t,n,i,r){_classCallCheck(this,e),this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}return _createClass(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),Lc=((Oc=function(){function e(t,n,i){_classCallCheck(this,e),this._viewContainer=t,this._template=n,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return _createClass(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){Ei()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(e),". See https://angular.io/api/common/NgForOf#change-propagation for more information.")),this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(i){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation((function(e,i,r){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new zc(null,t._ngForOf,-1,-1),null===r?void 0:r),o=new Bc(e,a);n.push(o)}else if(null==r)t._viewContainer.remove(null===i?void 0:i);else if(null!==i){var s=t._viewContainer.get(i);t._viewContainer.move(s,r);var l=new Bc(e,s);n.push(l)}}));for(var i=0;i<n.length;i++)this._perViewChange(n[i].view,n[i].record);for(var r=0,a=this._viewContainer.length;r<a;r++){var o=this._viewContainer.get(r);o.context.index=r,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange((function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item}))}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||Oc)(To(pl),To(dl),To(sl))},Oc.\u0275dir=Ct({type:Oc,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),Oc),Bc=_createClass((function e(t,n){_classCallCheck(this,e),this.record=t,this.view=n})),Fc=((Nc=function(){function e(t,n){_classCallCheck(this,e),this._viewContainer=t,this._context=new jc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Hc("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Hc("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||Nc)(To(pl),To(dl))},Nc.\u0275dir=Ct({type:Nc,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),Nc),jc=_createClass((function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null}));function Hc(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(Se(t),"'."))}var Vc,Uc,qc,Gc,Wc,Zc,Xc,Kc,Yc,Jc,Qc,$c=function(){function e(t,n){_classCallCheck(this,e),this._viewContainerRef=t,this._templateRef=n,this._created=!1}return _createClass(e,[{key:"create",value:function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}},{key:"destroy",value:function(){this._created=!1,this._viewContainerRef.clear()}},{key:"enforceState",value:function(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}]),e}(),eh=((qc=function(){function e(){_classCallCheck(this,e),this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return _createClass(e,[{key:"ngSwitch",set:function(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}},{key:"_addCase",value:function(){return this._caseCount++}},{key:"_addDefault",value:function(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}},{key:"_matchCase",value:function(e){var t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}},{key:"_updateDefaultCases",value:function(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(var t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}]),e}()).\u0275fac=function(e){return new(e||qc)},qc.\u0275dir=Ct({type:qc,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),qc),th=((Uc=function(){function e(t,n,i){_classCallCheck(this,e),this.ngSwitch=i,i._addCase(),this._view=new $c(t,n)}return _createClass(e,[{key:"ngDoCheck",value:function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}]),e}()).\u0275fac=function(e){return new(e||Uc)(To(pl),To(dl),To(eh,1))},Uc.\u0275dir=Ct({type:Uc,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),Uc),nh=((Vc=_createClass((function e(t,n,i){_classCallCheck(this,e),i._addDefault(new $c(t,n))}))).\u0275fac=function(e){return new(e||Vc)(To(pl),To(dl),To(eh,1))},Vc.\u0275dir=Ct({type:Vc,selectors:[["","ngSwitchDefault",""]]}),Vc),ih=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createSubscription",value:function(e,t){return e.subscribe({next:t,error:function(e){throw e}})}},{key:"dispose",value:function(e){e.unsubscribe()}},{key:"onDestroy",value:function(e){e.unsubscribe()}}]),e}(),rh=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createSubscription",value:function(e,t){return e.then(t,(function(e){throw e}))}},{key:"dispose",value:function(e){}},{key:"onDestroy",value:function(e){}}]),e}()),ah=new ih,oh=((Xc=function(){function e(t){_classCallCheck(this,e),this._ref=t,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._strategy=null}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._subscription&&this._dispose()}},{key:"transform",value:function(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):vo(this._latestValue,this._latestReturnedValue)?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,go.wrap(this._latestValue)):(e&&this._subscribe(e),this._latestReturnedValue=this._latestValue,this._latestValue)}},{key:"_subscribe",value:function(e){var t=this;this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,(function(n){return t._updateLatestValue(e,n)}))}},{key:"_selectStrategy",value:function(t){if(Lo(t))return rh;if(Bo(t))return ah;throw Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(Se(e),"'"))}},{key:"_dispose",value:function(){this._strategy.dispose(this._subscription),this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null}},{key:"_updateLatestValue",value:function(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())}}]),e}()).\u0275fac=function(e){return new(e||Xc)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de.Default,t=qa(!0);if(null!=t||e&de.Optional)return t;throw new Error("No provider for ChangeDetectorRef!")}())},Xc.\u0275pipe={type:(Zc={name:"async",type:Xc,pure:!1}).type,name:Zc.name,factory:null,pure:!1!==Zc.pure,onDestroy:Zc.type.prototype.ngOnDestroy||null},Xc),sh=((Wc=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Wc}),Wc.\u0275inj=ve({factory:function(e){return new(e||Wc)},providers:[{provide:Mc,useClass:Ic}]}),Wc),lh=((Gc=_createClass((function e(){_classCallCheck(this,e)}))).\u0275prov=me({token:Gc,providedIn:"root",factory:function(){return new uh($e(rc),window,$e(mi))}}),Gc),uh=function(){function e(t,n,i){_classCallCheck(this,e),this.document=t,this.window=n,this.errorHandler=i,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#"+e);if(t)return void this.scrollToElement(t);var n=this.document.querySelector("[name='".concat(e,"']"));if(n)return void this.scrollToElement(n)}catch(i){this.errorHandler.handleError(i)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],i-r[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),ch=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=hh||(hh=document.querySelector("base"))?hh.getAttribute("href"):null;return null==n?null:(t=n,Kc||(Kc=document.createElement("a")),Kc.setAttribute("href",t),"/"===Kc.pathname.charAt(0)?Kc.pathname:"/"+Kc.pathname)}},{key:"resetBaseElement",value:function(){hh=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return Ac(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new t,tc||(tc=e)}}]),t}(function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t)}return _inherits(t,e),_createClass(t,[{key:"supportsDOMEvents",value:function(){return!0}}]),t}(function(){return _createClass((function e(){_classCallCheck(this,e)}))}())),hh=null,dh=new qe("TRANSITION_ID"),fh=[{provide:iu,useFactory:function(e,t,n){return function(){n.get(ru).donePromise.then((function(){var n=nc();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter((function(t){return t.getAttribute("ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[dh,rc,so],multi:!0}],ph=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){ze.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.findTestabilityInTree(t,n);if(null==i)throw new Error("Could not find testability for element.");return i},ze.getAllAngularTestabilities=function(){return e.getAllTestabilities()},ze.getAllAngularRootElements=function(){return e.getAllRootElements()},ze.frameworkStabilizers||(ze.frameworkStabilizers=[]),ze.frameworkStabilizers.push((function(e){var t=ze.getAllAngularTestabilities(),n=t.length,i=!1,r=function(t){i=i||t,0==--n&&e(i)};t.forEach((function(e){e.whenStable(r)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var i=e.getTestability(t);return null!=i?i:n?nc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,zu=t}}]),e}(),mh=new qe("EventManagerPlugins"),vh=((Yc=function(){function e(t,n){var i=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=i})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,i=0;i<n.length;i++){var r=n[i];if(r.supports(e))return this._eventNameToPlugin.set(e,r),r}throw new Error("No event manager plugin found for event "+e)}}]),e}()).\u0275fac=function(e){return new(e||Yc)($e(mh),$e(Su))},Yc.\u0275prov=me({token:Yc,factory:Yc.\u0275fac}),Yc),gh=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var i=nc().getGlobalEventTarget(this._doc,e);if(!i)throw new Error("Unsupported event target ".concat(i," for event ").concat(t));return this.addEventListener(i,t,n)}}]),e}(),yh=((Qc=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||Qc)},Qc.\u0275prov=me({token:Qc,factory:Qc.\u0275fac}),Qc),_h=((Jc=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return _inherits(t,e),_createClass(t,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var i=n._doc.createElement("style");i.textContent=e,n._styleNodes.add(t.appendChild(i))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return nc().remove(e)}))}}]),t}(yh)).\u0275fac=function(e){return new(e||Jc)($e(rc))},Jc.\u0275prov=me({token:Jc,factory:Jc.\u0275fac}),Jc),xh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},bh=/%COMP%/g;function wh(e,t,n){for(var i=0;i<t.length;i++){var r=t[i];Array.isArray(r)?wh(e,r,n):(r=r.replace(bh,e),n.push(r))}return n}function kh(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Ch,Sh,Th,Eh,Ph,Mh,Ih=((Ch=function(){function e(t,n,i){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Ah(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case pt.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new Rh(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case pt.Native:case pt.ShadowDom:return new Oh(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var i=wh(t.id,t.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ch)($e(vh),$e(_h),$e(au))},Ch.\u0275prov=me({token:Ch,factory:Ch.\u0275fac}),Ch),Ah=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(xh[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,i){if(i){t=i+":"+t;var r=xh[i];r?e.setAttributeNS(r,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var i=xh[n];i?e.removeAttributeNS(i,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,i){i&Gs.DashCase?e.style.setProperty(t,n,i&Gs.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&Gs.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,kh(n)):this.eventManager.addEventListener(e,t,kh(n))}}]),e}(),Rh=function(e){function t(e,n,i,r){var a;_classCallCheck(this,t),(a=_callSuper(this,t,[e])).component=i;var o,s=wh(r+"-"+i.id,i.styles,[]);return n.addStyles(s),a.contentAttr="_ngcontent-%COMP%".replace(bh,r+"-"+i.id),a.hostAttr=(o=r+"-"+i.id,"_nghost-%COMP%".replace(bh,o)),a}return _inherits(t,e),_createClass(t,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf2(t.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,n){var i=_get(_getPrototypeOf2(t.prototype),"createElement",this).call(this,e,n);return _get(_getPrototypeOf2(t.prototype),"setAttribute",this).call(this,i,this.contentAttr,""),i}}]),t}(Ah),Oh=function(e){function t(e,n,i,r){var a;_classCallCheck(this,t),(a=_callSuper(this,t,[e])).sharedStylesHost=n,a.hostEl=i,a.component=r,a.shadowRoot=r.encapsulation===pt.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),a.sharedStylesHost.addHost(a.shadowRoot);for(var o=wh(r.id,r.styles,[]),s=0;s<o.length;s++){var l=document.createElement("style");l.textContent=o[s],a.shadowRoot.appendChild(l)}return a}return _inherits(t,e),_createClass(t,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,n){return _get(_getPrototypeOf2(t.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"insertBefore",value:function(e,n,i){return _get(_getPrototypeOf2(t.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),n,i)}},{key:"removeChild",value:function(e,n){return _get(_getPrototypeOf2(t.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf2(t.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),t}(Ah),Nh=((Sh=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var i=this;return e.addEventListener(t,n,!1),function(){return i.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),t}(gh)).\u0275fac=function(e){return new(e||Sh)($e(rc))},Sh.\u0275prov=me({token:Sh,factory:Sh.\u0275fac}),Sh),Dh=["alt","control","meta","shift"],zh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Lh={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Bh={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},Fh=((Ph=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return null!=t.parseEventName(e)}},{key:"addEventListener",value:function(e,n,i){var r=t.parseEventName(n),a=t.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return nc().onAndCancel(e,r.domEventName,a)}))}}],[{key:"parseEventName",value:function(e){var n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;var r=t._normalizeKey(n.pop()),a="";if(Dh.forEach((function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),a+=e+".")})),a+=r,0!=n.length||0===r.length)return null;var o={};return o.domEventName=i,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Lh.hasOwnProperty(t)&&(t=Lh[t]))}return zh[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Dh.forEach((function(i){i!=n&&(0,Bh[i])(e)&&(t+=i+".")})),t+=n}},{key:"eventCallback",value:function(e,n,i){return function(r){t.getEventFullKey(r)===e&&i.runGuarded((function(){return n(r)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),t}(gh)).\u0275fac=function(e){return new(e||Ph)($e(rc))},Ph.\u0275prov=me({token:Ph,factory:Ph.\u0275fac}),Ph),jh=((Eh=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||Eh)},Eh.\u0275prov=me({factory:function(){return $e(Hh)},token:Eh,providedIn:"root"}),Eh),Hh=((Th=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._doc=e,n}return _inherits(t,e),_createClass(t,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case Ki.NONE:return t;case Ki.HTML:return ki(t,"HTML")?wi(t):function(e,t){var n=null;try{Ni=Ni||new Pi(e);var i=t?String(t):"";n=Ni.getInertBodyElement(i);var r=5,a=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=a,a=n.innerHTML,n=Ni.getInertBodyElement(i)}while(i!==a);var o=new qi,s=o.sanitizeChildren(Xi(n)||n);return Ei()&&o.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var l=Xi(n)||n;l.firstChild;)l.removeChild(l.firstChild)}}(this._doc,String(t));case Ki.STYLE:return ki(t,"Style")?wi(t):function(e){if(!(e=String(e).trim()))return"";var t=e.match(Ji);return t&&Ai(t[1])===t[1]||e.match(Yi)&&function(e){for(var t=!0,n=!0,i=0;i<e.length;i++){var r=e.charAt(i);"'"===r&&n?t=!t:'"'===r&&t&&(n=!n)}return t&&n}(e)?e:(Ei()&&console.warn("WARNING: sanitizing unsafe style value ".concat(e," (see http://g.co/ng/security#xss).")),"unsafe")}(t);case Ki.SCRIPT:if(ki(t,"Script"))return wi(t);throw new Error("unsafe value used in a script context");case Ki.URL:return Ci(t),ki(t,"URL")?wi(t):Ai(String(t));case Ki.RESOURCE_URL:if(ki(t,"ResourceURL"))return wi(t);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see http://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return new gi(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new yi(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new _i(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new xi(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new bi(e)}}]),t}(jh)).\u0275fac=function(e){return new(e||Th)($e(rc))},Th.\u0275prov=me({factory:function(){return e=$e(Ge),new Hh(e.get(rc));var e},token:Th,providedIn:"root"}),Th),Vh=ju(Qu,"browser",[{provide:uu,useValue:"browser"},{provide:lu,useValue:function(){ch.makeCurrent(),ph.init()},multi:!0},{provide:rc,useFactory:function(){return function(e){Dt=e}(document),document},deps:[]}]),Uh=[[],{provide:Za,useValue:"root"},{provide:mi,useFactory:function(){return new mi},deps:[]},{provide:mh,useClass:Nh,multi:!0,deps:[rc,Su,uu]},{provide:mh,useClass:Fh,multi:!0,deps:[rc]},[],{provide:Ih,useClass:Ih,deps:[vh,_h,au]},{provide:qs,useExisting:Ih},{provide:yh,useExisting:_h},{provide:_h,useClass:_h,deps:[rc]},{provide:Nu,useClass:Nu,deps:[Su]},{provide:vh,useClass:vh,deps:[mh,Su]},[]],qh=((Mh=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:au,useValue:t.appId},{provide:dh,useExisting:au},fh]}}}]),e}()).\u0275mod=wt({type:Mh}),Mh.\u0275inj=ve({factory:function(e){return new(e||Mh)($e(Mh,12))},providers:Uh,imports:[sh,ec]}),Mh);"undefined"!=typeof window&&window;var Gh=_createClass((function e(){_classCallCheck(this,e)}));function Wh(e,t){return{type:7,name:e,definitions:t,options:{}}}function Zh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:4,styles:t,timings:e}}function Xh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function Kh(e){return{type:6,styles:e,offset:null}}function Yh(e,t,n){return{type:0,name:e,styles:t,options:n}}function Jh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:1,expr:e,animation:t,options:n}}function Qh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:9,options:e}}function $h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:11,selector:e,animation:t,options:n}}function ed(e){Promise.resolve(null).then(e)}var td=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+n}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;ed((function(){return e._onFinish()}))}},{key:"_onStart",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(e){}},{key:"getPosition",value:function(){return 0}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}(),nd=function(){function e(t){var n=this;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var i=0,r=0,a=0,o=this.players.length;0==o?ed((function(){return n._onFinish()})):this.players.forEach((function(e){e.onDone((function(){++i==o&&n._onFinish()})),e.onDestroy((function(){++r==o&&n._onDestroy()})),e.onStart((function(){++a==o&&n._onStart()}))})),this.totalTime=this.players.reduce((function(e,t){return Math.max(e,t.totalTime)}),0)}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach((function(e){return e.init()}))}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach((function(e){return e.play()}))}},{key:"pause",value:function(){this.players.forEach((function(e){return e.pause()}))}},{key:"restart",value:function(){this.players.forEach((function(e){return e.restart()}))}},{key:"finish",value:function(){this._onFinish(),this.players.forEach((function(e){return e.finish()}))}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach((function(e){return e.destroy()})),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach((function(e){return e.reset()})),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach((function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)}))}},{key:"getPosition",value:function(){var e=0;return this.players.forEach((function(t){var n=t.getPosition();e=Math.min(n,e)})),e}},{key:"beforeDestroy",value:function(){this.players.forEach((function(e){e.beforeDestroy&&e.beforeDestroy()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}();function id(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function rd(e){switch(e.length){case 0:return new td;case 1:return e[0];default:return new nd(e)}}function ad(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],l=-1,u=null;if(i.forEach((function(e){var n=e.offset,i=n==l,c=i&&u||{};Object.keys(e).forEach((function(n){var i=n,s=e[n];if("offset"!==n)switch(i=t.normalizePropertyName(i,o),s){case"!":s=r[n];break;case"*":s=a[n];break;default:s=t.normalizeStyleValue(n,i,s,o)}c[i]=s})),i||s.push(c),u=c,l=n})),o.length){var c="\n - ";throw new Error("Unable to animate due to the following errors:".concat(c).concat(o.join(c)))}return s}function od(e,t,n,i){switch(t){case"start":e.onStart((function(){return i(n&&sd(n,"start",e))}));break;case"done":e.onDone((function(){return i(n&&sd(n,"done",e))}));break;case"destroy":e.onDestroy((function(){return i(n&&sd(n,"destroy",e))}))}}function sd(e,t,n){var i=n.totalTime,r=ld(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),a=e._data;return null!=a&&(r._data=a),r}function ld(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:a,disabled:!!o}}function ud(e,t,n){var i;return e instanceof Map?(i=e.get(t))||e.set(t,i=n):(i=e[t])||(i=e[t]=n),i}function cd(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var hd=function(e,t){return!1},dd=function(e,t){return!1},fd=function(e,t,n){return[]},pd=id();(pd||"undefined"!=typeof Element)&&(hd=function(e,t){return e.contains(t)},dd=function(){if(pd||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:dd}(),fd=function(e,t,n){var i=[];if(n)i.push.apply(i,_toConsumableArray(e.querySelectorAll(t)));else{var r=e.querySelector(t);r&&i.push(r)}return i});var md=null,vd=!1;function gd(e){md||(md=("undefined"!=typeof document?document.body:null)||{},vd=!!md.style&&"WebkitAppearance"in md.style);var t=!0;return md.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in md.style)&&vd)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in md.style),t}var yd=dd,_d=hd,xd=fd;function bd(e){var t={};return Object.keys(e).forEach((function(n){var i=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[i]=e[n]})),t}var wd,kd=((wd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return gd(e)}},{key:"matchesElement",value:function(e,t){return yd(e,t)}},{key:"containsElement",value:function(e,t){return _d(e,t)}},{key:"query",value:function(e,t,n){return xd(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,i,r){return arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&arguments[6],new td(n,i)}}]),e}()).\u0275fac=function(e){return new(e||wd)},wd.\u0275prov=me({token:wd,factory:wd.\u0275fac}),wd),Cd=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.NOOP=new kd,e}();function Sd(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Td(parseFloat(t[1]),t[2])}function Td(e,t){switch(t){case"s":return 1e3*e;default:return e}}function Ed(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var i,r=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};i=Td(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(r=Td(parseFloat(s),o[4]));var l=o[5];l&&(a=l)}else i=e;if(!n){var u=!1,c=t.length;i<0&&(t.push("Duration values below 0 are not allowed for this animation step."),u=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),u=!0),u&&t.splice(c,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:i,delay:r,easing:a}}(e,t,n)}function Pd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach((function(n){t[n]=e[n]})),t}function Md(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var i in e)n[i]=e[i];else Pd(e,n);return n}function Id(e,t,n){return n?t+":"+n+";":""}function Ad(e){for(var t="",n=0;n<e.style.length;n++){var i=e.style.item(n);t+=Id(0,i,e.style.getPropertyValue(i))}for(var r in e.style)e.style.hasOwnProperty(r)&&!r.startsWith("_")&&(t+=Id(0,r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[r]));e.setAttribute("style",t)}function Rd(e,t,n){e.style&&(Object.keys(t).forEach((function(i){var r=jd(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]})),id()&&Ad(e))}function Od(e,t){e.style&&(Object.keys(t).forEach((function(t){var n=jd(t);e.style[n]=""})),id()&&Ad(e))}function Nd(e){return Array.isArray(e)?1==e.length?e[0]:Xh(e):e}var Dd=new RegExp("{{\\s*(.+?)\\s*}}","g");function zd(e){var t=[];if("string"==typeof e){for(var n;n=Dd.exec(e);)t.push(n[1]);Dd.lastIndex=0}return t}function Ld(e,t,n){var i=e.toString(),r=i.replace(Dd,(function(e,i){var r=t[i];return t.hasOwnProperty(i)||(n.push("Please provide a value for the animation param "+i),r=""),r.toString()}));return r==i?e:r}function Bd(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var Fd=/-+([a-z0-9])/g;function jd(e){return e.replace(Fd,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()}))}function Hd(e,t){return 0===e||0===t}function Vd(e,t,n){var i=Object.keys(n);if(i.length&&t.length){var r=t[0],a=[];if(i.forEach((function(e){r.hasOwnProperty(e)||a.push(e),r[e]=n[e]})),a.length)for(var o=function(){var n=t[s];a.forEach((function(t){n[t]=qd(e,t)}))},s=1;s<t.length;s++)o()}return t}function Ud(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #"+t.type)}}function qd(e,t){return window.getComputedStyle(e)[t]}var Gd=new Set(["true","1"]),Wd=new Set(["false","0"]);function Zd(e,t){var n=Gd.has(e)||Wd.has(e),i=Gd.has(t)||Wd.has(t);return function(r,a){var o="*"==e||e==r,s="*"==t||t==a;return!o&&n&&"boolean"==typeof r&&(o=r?Gd.has(e):Wd.has(e)),!s&&i&&"boolean"==typeof a&&(s=a?Gd.has(t):Wd.has(t)),o&&s}}var Xd=new RegExp("s*:selfs*,?","g");function Kd(e,t,n){return new Yd(e).build(t,n)}var Yd=function(){function e(t){_classCallCheck(this,e),this._driver=t}return _createClass(e,[{key:"build",value:function(e,t){var n=new Jd(t);return this._resetContextStyleTimingState(n),Ud(this,Nd(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,i=t.queryCount=0,r=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach((function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,l=s.name;l.toString().split(/\s*,\s*/).forEach((function(e){s.name=e,a.push(n.visitState(s,t))})),s.name=l}else if(1==e.type){var u=n.visitTransition(e,t);i+=u.queryCount,r+=u.depCount,o.push(u)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")})),{type:7,name:e.name,states:a,transitions:o,queryCount:i,depCount:r,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){var r=new Set,a=i||{};if(n.styles.forEach((function(e){if(Qd(e)){var t=e;Object.keys(t).forEach((function(e){zd(t[e]).forEach((function(e){a.hasOwnProperty(e)||r.add(e)}))}))}})),r.size){var o=Bd(r.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n,i,r,a=Ud(this,Nd(e.animation),t);return{type:1,matchers:(n=e.expr,i=t.errors,r=[],"string"==typeof n?n.split(/\s*,\s*/).forEach((function(e){return function(e,t,n){if(":"==e[0]){var i=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof i)return void t.push(i);e=i}var r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=r[1],o=r[2],s=r[3];t.push(Zd(a,s)),"<"!=o[0]||"*"==a&&"*"==s||t.push(Zd(s,a))}(e,r,i)})):r.push(n),r),animation:a,queryCount:t.queryCount,depCount:t.depCount,options:$d(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map((function(e){return Ud(n,e,t)})),options:$d(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,i=t.currentTime,r=0,a=e.steps.map((function(e){t.currentTime=i;var a=Ud(n,e,t);return r=Math.max(r,t.currentTime),a}));return t.currentTime=r,{type:3,steps:a,options:$d(e.options)}}},{key:"visitAnimate",value:function(e,t){var n,i=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return ef(Ed(e,t).duration,0,"");var i=e;if(i.split(/\s+/).some((function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)}))){var r=ef(0,0,"");return r.dynamic=!0,r.strValue=i,r}return ef((n=n||Ed(i,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;var r=e.styles?e.styles:Kh({});if(5==r.type)n=this.visitKeyframes(r,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};i.easing&&(s.easing=i.easing),a=Kh(s)}t.currentTime+=i.duration+i.delay;var l=this.visitStyle(a,t);l.isEmptyStep=o,n=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:n,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach((function(e){"string"==typeof e?"*"==e?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)})):n.push(e.styles);var i=!1,r=null;return n.forEach((function(e){if(Qd(e)){var t=e,n=t.easing;if(n&&(r=n,delete t.easing),!i)for(var a in t)if(t[a].toString().indexOf("{{")>=0){i=!0;break}}})),{type:6,styles:n,easing:r,offset:e.offset,containsDynamicStyles:i,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,i=t.currentAnimateTimings,r=t.currentTime,a=t.currentTime;i&&a>0&&(a-=i.duration+i.delay),e.styles.forEach((function(e){"string"!=typeof e&&Object.keys(e).forEach((function(i){if(n._driver.validateStyleProperty(i)){var o,s,l,u,c,h=t.collectedStyles[t.currentQuerySelector],d=h[i],f=!0;d&&(a!=r&&a>=d.startTime&&r<=d.endTime&&(t.errors.push('The CSS property "'.concat(i,'" that exists between the times of "').concat(d.startTime,'ms" and "').concat(d.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(r,'ms"')),f=!1),a=d.startTime),f&&(h[i]={startTime:a,endTime:r}),t.options&&(o=e[i],s=t.options,l=t.errors,u=s.params||{},(c=zd(o)).length&&c.forEach((function(e){u.hasOwnProperty(e)||l.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})))}else t.errors.push('The provided animation property "'.concat(i,'" is not a supported CSS property for animations'))}))}))}},{key:"visitKeyframes",value:function(e,t){var n=this,i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),i;var r=0,a=[],o=!1,s=!1,l=0,u=e.steps.map((function(e){var i=n._makeStyleAst(e,t),u=null!=i.offset?i.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach((function(e){if(Qd(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}}));else if(Qd(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(i.styles),c=0;return null!=u&&(r++,c=i.offset=u),s=s||c<0||c>1,o=o||c<l,l=c,a.push(c),i}));s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var c=e.steps.length,h=0;r>0&&r<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(h=1/(c-1));var d=c-1,f=t.currentTime,p=t.currentAnimateTimings,m=p.duration;return u.forEach((function(e,r){var o=h>0?r==d?1:h*r:a[r],s=o*m;t.currentTime=f+p.delay+s,p.duration=s,n._validateStyleAst(e,t),e.offset=o,i.styles.push(e)})),i}},{key:"visitReference",value:function(e,t){return{type:8,animation:Ud(this,Nd(e.animation),t),options:$d(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:$d(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:$d(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;var r=_slicedToArray(function(e){var t=!!e.split(/\s*,\s*/).find((function(e){return":self"==e}));return t&&(e=e.replace(Xd,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,(function(e){return".ng-trigger-"+e.substr(1)})).replace(/:animating/g,".ng-animating"),t]}(e.selector),2),a=r[0],o=r[1];t.currentQuerySelector=n.length?n+" "+a:a,ud(t.collectedStyles,t.currentQuerySelector,{});var s=Ud(this,Nd(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:a,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:$d(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Ed(e.timings,t.errors,!0);return{type:12,animation:Ud(this,Nd(e.animation),t),timings:n,options:null}}}]),e}(),Jd=_createClass((function e(t){_classCallCheck(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}));function Qd(e){return!Array.isArray(e)&&"object"==typeof e}function $d(e){var t;return e?(e=Pd(e)).params&&(e.params=(t=e.params)?Pd(t):null):e={},e}function ef(e,t,n){return{duration:e,delay:t,easing:n}}function tf(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:a,totalTime:r+a,easing:o,subTimeline:s}}var nf=function(){function e(){_classCallCheck(this,e),this._map=new Map}return _createClass(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,i=this._map.get(e);i||this._map.set(e,i=[]),(n=i).push.apply(n,_toConsumableArray(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),rf=new RegExp(":enter","g"),af=new RegExp(":leave","g");function of(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new sf).buildKeyframes(e,t,n,i,r,a,o,s,l,u)}var sf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"buildKeyframes",value:function(e,t,n,i,r,a,o,s,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];l=l||new nf;var c=new uf(e,t,l,i,r,u,[]);c.options=s,c.currentTimeline.setStyles([a],null,c.errors,s),Ud(this,n,c);var h=c.timelines.filter((function(e){return e.containsAnimation()}));if(h.length&&Object.keys(o).length){var d=h[h.length-1];d.allowOnlyTimelineStyles()||d.setStyles([o],null,c.errors,s)}return h.length?h.map((function(e){return e.buildKeyframes()})):[tf(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var i=t.createSubContext(e.options),r=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,i,i.options);r!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var i=t.currentTimeline.currentTime,r=null!=n.duration?Sd(n.duration):null,a=null!=n.delay?Sd(n.delay):null;return 0!==r&&e.forEach((function(e){var n=t.appendInstructionToTimeline(e,r,a);i=Math.max(i,n.duration+n.delay)})),i}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),Ud(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,i=t.subContextCount,r=t,a=e.options;if(a&&(a.params||a.delay)&&((r=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=lf);var o=Sd(a.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach((function(e){return Ud(n,e,r)})),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,i=[],r=t.currentTimeline.currentTime,a=e.options&&e.options.delay?Sd(e.options.delay):0;e.steps.forEach((function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),Ud(n,o,s),r=Math.max(r,s.currentTimeline.currentTime),i.push(s.currentTimeline)})),i.forEach((function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)})),t.transformIntoNewTimeline(r),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return Ed(t.params?Ld(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());var r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(n.duration),this.visitStyle(r,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();var r=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(r):n.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,i=t.currentTimeline.duration,r=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach((function(e){a.forwardTime((e.offset||0)*r),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()})),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+r),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,i=t.currentTimeline.currentTime,r=e.options||{},a=r.delay?Sd(r.delay):0;a&&(6===t.previousNode.type||0==i&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=lf);var o=i,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=s.length;var l=null;s.forEach((function(i,r){t.currentQueryIndex=r;var s=t.createSubContext(e.options,i);a&&s.delayNextStep(a),i===t.element&&(l=s.currentTimeline),Ud(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)})),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,i=t.currentTimeline,r=e.timings,a=Math.abs(r.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var l=t.currentTimeline;s&&l.delayNextStep(s);var u=l.currentTime;Ud(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-u+(i.startTime-n.currentTimeline.startTime)}}]),e}(),lf={},uf=function(){function e(t,n,i,r,a,o,s,l){_classCallCheck(this,e),this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=lf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new cf(this._driver,n,0),s.push(this.currentTimeline)}return _createClass(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var i=e,r=this.options;null!=i.duration&&(r.duration=Sd(i.duration)),null!=i.delay&&(r.delay=Sd(i.delay));var a=i.params;if(a){var o=r.params;o||(o=this.options.params={}),Object.keys(a).forEach((function(e){t&&o.hasOwnProperty(e)||(o[e]=Ld(a[e],o,n.errors))}))}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach((function(e){n[e]=t[e]}))}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=n||this.element,a=new e(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=lf,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var i={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},r=new hf(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(r),i}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,i,r,a){var o=[];if(i&&o.push(this.element),e.length>0){e=(e=e.replace(rf,"."+this._enterClassName)).replace(af,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,_toConsumableArray(s))}return r||0!=o.length||a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),cf=function(){function e(t,n,i,r){_classCallCheck(this,e),this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return _createClass(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach((function(e){t._backFill[e]=t._globalTimelineStyles[e]||"*",t._currentKeyframe[e]="*"})),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,i){var r=this;t&&(this._previousKeyframe.easing=t);var a=i&&i.params||{},o=function(e,t){var n,i={};return e.forEach((function(e){"*"===e?(n=n||Object.keys(t)).forEach((function(e){i[e]="*"})):Md(e,!1,i)})),i}(e,this._globalTimelineStyles);Object.keys(o).forEach((function(e){var t=Ld(o[e],a,n);r._pendingStyles[e]=t,r._localTimelineStyles.hasOwnProperty(e)||(r._backFill[e]=r._globalTimelineStyles.hasOwnProperty(e)?r._globalTimelineStyles[e]:"*"),r._updateStyle(e,t)}))}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach((function(n){e._currentKeyframe[n]=t[n]})),Object.keys(this._localTimelineStyles).forEach((function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])})))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach((function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)}))}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach((function(n){var i=t._styleSummary[n],r=e._styleSummary[n];(!i||r.time>i.time)&&t._updateStyle(n,r.value)}))}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration,r=[];this._keyframes.forEach((function(a,o){var s=Md(a,!0);Object.keys(s).forEach((function(e){var i=s[e];"!"==i?t.add(e):"*"==i&&n.add(e)})),i||(s.offset=o/e.duration),r.push(s)}));var a=t.size?Bd(t.values()):[],o=n.size?Bd(n.values()):[];if(i){var s=r[0],l=Pd(s);s.offset=0,l.offset=1,r=[s,l]}return tf(this.element,r,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),hf=function(e){function t(e,n,i,r,a,o){var s,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,t),(s=_callSuper(this,t,[e,n,o.delay])).element=n,s.keyframes=i,s.preStyleProps=r,s.postStyleProps=a,s._stretchStartingKeyframe=l,s.timings={duration:o.duration,delay:o.delay,easing:o.easing},s}return _inherits(t,e),_createClass(t,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,i=t.duration,r=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=i+n,s=n/o,l=Md(e[0],!1);l.offset=0,a.push(l);var u=Md(e[0],!1);u.offset=df(s),a.push(u);for(var c=e.length-1,h=1;h<=c;h++){var d=Md(e[h],!1);d.offset=df((n+d.offset*i)/o),a.push(d)}i=o,n=0,r="",e=a}return tf(this.element,e,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}]),t}(cf);function df(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var ff,pf,mf=_createClass((function e(){_classCallCheck(this,e)})),vf=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"normalizePropertyName",value:function(e,t){return jd(e)}},{key:"normalizeStyleValue",value:function(e,t,n,i){var r="",a=n.toString().trim();if(gf[t]&&0!==n&&"0"!==n)if("number"==typeof n)r="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&i.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+r}}]),t}(mf),gf=(ff="width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","),pf={},ff.forEach((function(e){return pf[e]=!0})),pf);function yf(e,t,n,i,r,a,o,s,l,u,c,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:a,toState:i,toStyles:o,timelines:s,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:d}}var _f={},xf=function(){function e(t,n,i){_classCallCheck(this,e),this._triggerName=t,this.ast=n,this._stateStyles=i}return _createClass(e,[{key:"match",value:function(e,t,n,i){return function(e,t,n,i,r){return e.some((function(e){return e(t,n,i,r)}))}(this.ast.matchers,e,t,n,i)}},{key:"buildStyles",value:function(e,t,n){var i=this._stateStyles["*"],r=this._stateStyles[e],a=i?i.buildStyles(t,n):{};return r?r.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,i,r,a,o,s,l,u){var c=[],h=this.ast.options&&this.ast.options.params||_f,d=this.buildStyles(n,o&&o.params||_f,c),f=s&&s.params||_f,p=this.buildStyles(i,f,c),m=new Set,v=new Map,g=new Map,y="void"===i,_={params:Object.assign(Object.assign({},h),f)},x=u?[]:of(e,t,this.ast.animation,r,a,d,p,_,l,c),b=0;if(x.forEach((function(e){b=Math.max(e.duration+e.delay,b)})),c.length)return yf(t,this._triggerName,n,i,y,d,p,[],[],v,g,b,c);x.forEach((function(e){var n=e.element,i=ud(v,n,{});e.preStyleProps.forEach((function(e){return i[e]=!0}));var r=ud(g,n,{});e.postStyleProps.forEach((function(e){return r[e]=!0})),n!==t&&m.add(n)}));var w=Bd(m.values());return yf(t,this._triggerName,n,i,y,d,p,x,w,v,g,b)}}]),e}(),bf=function(){function e(t,n){_classCallCheck(this,e),this.styles=t,this.defaultParams=n}return _createClass(e,[{key:"buildStyles",value:function(e,t){var n={},i=Pd(this.defaultParams);return Object.keys(e).forEach((function(t){var n=e[t];null!=n&&(i[t]=n)})),this.styles.styles.forEach((function(e){if("string"!=typeof e){var r=e;Object.keys(r).forEach((function(e){var a=r[e];a.length>1&&(a=Ld(a,i,t)),n[e]=a}))}})),n}}]),e}(),wf=function(){function e(t,n){var i=this;_classCallCheck(this,e),this.name=t,this.ast=n,this.transitionFactories=[],this.states={},n.states.forEach((function(e){i.states[e.name]=new bf(e.style,e.options&&e.options.params||{})})),kf(this.states,"true","1"),kf(this.states,"false","0"),n.transitions.forEach((function(e){i.transitionFactories.push(new xf(t,e,i.states))})),this.fallbackTransition=new xf(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},this.states)}return _createClass(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,i){return this.transitionFactories.find((function(r){return r.match(e,t,n,i)}))||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function kf(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var Cf=new nf,Sf=function(){function e(t,n,i){_classCallCheck(this,e),this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}return _createClass(e,[{key:"register",value:function(e,t){var n=[],i=Kd(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: "+n.join("\n"));this._animations[e]=i}},{key:"_buildPlayer",value:function(e,t,n){var i=e.element,r=ad(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(i,r,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=of(this._driver,t,o,"ng-enter","ng-leave",{},{},r,Cf,a)).forEach((function(e){var t=ud(s,e.element,{});e.postStyleProps.forEach((function(e){return t[e]=null}))})):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: "+a.join("\n"));s.forEach((function(e,t){Object.keys(e).forEach((function(n){e[n]=i._driver.computeStyle(t,n,"*")}))}));var l=rd(n.map((function(e){var t=s.get(e.element);return i._buildPlayer(e,{},t)})));return this._playersById[e]=l,l.onDestroy((function(){return i.destroy(e)})),this.players.push(l),l}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by "+e);return t}},{key:"listen",value:function(e,t,n,i){var r=ld(t,"","","");return od(this._getPlayer(e),n,r,i),function(){}}},{key:"command",value:function(e,t,n,i){if("register"!=n)if("create"!=n){var r=this._getPlayer(e);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,i[0]||{});else this.register(e,i[0])}}]),e}(),Tf=[],Ef={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Pf={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Mf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_classCallCheck(this,e),this.namespaceId=n;var i,r=t&&t.hasOwnProperty("value");if(this.value=null!=(i=r?t.value:t)?i:null,r){var a=Pd(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return _createClass(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach((function(e){null==n[e]&&(n[e]=t[e])}))}}}]),e}(),If=new Mf("void"),Af=function(){function e(t,n,i){_classCallCheck(this,e),this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Bf(n,this._hostClassName)}return _createClass(e,[{key:"listen",value:function(e,t,n,i){var r,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(r=n)&&"done"!=r)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=ud(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);var l=ud(this._engine.statesByElement,e,{});return l.hasOwnProperty(t)||(Bf(e,"ng-trigger"),Bf(e,"ng-trigger-"+t),l[t]=If),function(){a._engine.afterFlush((function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete l[t]}))}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new Of(this.id,t,e),s=this._engine.statesByElement.get(e);s||(Bf(e,"ng-trigger"),Bf(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,s={}));var l=s[t],u=new Mf(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),s[t]=u,l||(l=If),"void"===u.value||l.value!==u.value){var c=ud(this._engine.playersByElement,e,[]);c.forEach((function(e){e.namespaceId==i.id&&e.triggerName==t&&e.queued&&e.destroy()}));var h=a.matchTransition(l.value,u.value,e,u.params),d=!1;if(!h){if(!r)return;h=a.fallbackTransition,d=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:l,toState:u,player:o,isFallbackTransition:d}),d||(Bf(e,"ng-animate-queued"),o.onStart((function(){Ff(e,"ng-animate-queued")}))),o.onDone((function(){var t=i.players.indexOf(o);t>=0&&i.players.splice(t,1);var n=i._engine.playersByElement.get(e);if(n){var r=n.indexOf(o);r>=0&&n.splice(r,1)}})),this.players.push(o),c.push(o),o}if(!function(e,t){var n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(var r=0;r<n.length;r++){var a=n[r];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(l.params,u.params)){var f=[],p=a.matchStyles(l.value,l.params,f),m=a.matchStyles(u.value,u.params,f);f.length?this._engine.reportError(f):this._engine.afterFlush((function(){Od(e,p),Rd(e,m)}))}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach((function(t,n){delete t[e]})),this._elementListeners.forEach((function(n,i){t._elementListeners.set(i,n.filter((function(t){return t.name!=e})))}))}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach((function(e){return e.destroy()})),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,i=this._engine.driver.query(e,".ng-trigger",!0);i.forEach((function(e){if(!e.__ng_removed){var i=n._engine.fetchNamespacesByElement(e);i.size?i.forEach((function(n){return n.triggerLeaveAnimation(e,t,!1,!0)})):n.clearElementCache(e)}})),this._engine.afterFlushAnimationsDone((function(){return i.forEach((function(e){return n.clearElementCache(e)}))}))}},{key:"triggerLeaveAnimation",value:function(e,t,n,i){var r=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach((function(t){if(r._triggers[t]){var n=r.trigger(e,t,"void",i);n&&o.push(n)}})),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&rd(o).onDone((function(){return r._engine.processLeaveNode(e)})),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e);if(n){var i=new Set;n.forEach((function(n){var r=n.name;if(!i.has(r)){i.add(r);var a=t._triggers[r].fallbackTransition,o=t._engine.statesByElement.get(e)[r]||If,s=new Mf("void"),l=new Of(t.id,r,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:r,transition:a,fromState:o,toState:s,player:l,isFallbackTransition:!0})}}))}}},{key:"removeNode",value:function(e,t){var n=this,i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var r=!1;if(i.totalAnimations){var a=i.players.length?i.playersByQueriedElement.get(e):[];if(a&&a.length)r=!0;else for(var o=e;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{var s=e.__ng_removed;s&&s!==Ef||(i.afterFlush((function(){return n.clearElementCache(e)})),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){Bf(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach((function(i){var r=i.player;if(!r.destroyed){var a=i.element,o=t._elementListeners.get(a);o&&o.forEach((function(t){if(t.name==i.triggerName){var n=ld(a,i.triggerName,i.fromState.value,i.toState.value);n._data=e,od(i.player,t.phase,n,t.callback)}})),r.markedForDestroy?t._engine.afterFlush((function(){r.destroy()})):n.push(i)}})),this._queue=[],n.sort((function(e,n){var i=e.transition.ast.depCount,r=n.transition.ast.depCount;return 0==i||0==r?i-r:t._engine.driver.containsElement(e.element,n.element)?1:-1}))}},{key:"destroy",value:function(e){this.players.forEach((function(e){return e.destroy()})),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find((function(t){return t.element===e}))||t}}]),e}(),Rf=function(){function e(t,n,i){_classCallCheck(this,e),this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return _createClass(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach((function(t){t.players.forEach((function(t){t.queued&&e.push(t)}))})),e}},{key:"createNamespace",value:function(e,t){var n=new Af(e,t,this);return t.parentNode?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var i=!1,r=n;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),i=!0;break}i||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var i=this._fetchNamespace(e);this.afterFlush((function(){n.namespacesByHostElement.delete(i.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(i);t>=0&&n._namespaceList.splice(t,1)})),this.afterFlushAnimationsDone((function(){return i.destroy(t)}))}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var i=Object.keys(n),r=0;r<i.length;r++){var a=n[i[r]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,i){if(Nf(t)){var r=this._fetchNamespace(e);if(r)return r.trigger(t,n,i),!0}return!1}},{key:"insertNode",value:function(e,t,n,i){if(Nf(t)){var r=t.__ng_removed;if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Bf(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Ff(e,"ng-animate-disabled"))}},{key:"removeNode",value:function(e,t,n,i){if(Nf(t)){var r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,i)}}else this._onRemovalComplete(t,i)}},{key:"markElementAsRemoved",value:function(e,t,n,i){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,i,r){return Nf(t)?this._fetchNamespace(e).listen(t,n,i,r):function(){}}},{key:"_buildInstruction",value:function(e,t,n,i,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,r)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,".ng-trigger",!0);n.forEach((function(e){return t.destroyActiveAnimationsForElement(e)})),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,".ng-animating",!0)).forEach((function(e){return t.finishActiveQueriedAnimationOnElement(e)}))}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach((function(e){e.queued?e.markedForDestroy=!0:e.destroy()}))}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach((function(e){return e.finish()}))}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise((function(t){if(e.players.length)return rd(e.players).onDone((function(){return t()}));t()}))}},{key:"processLeaveNode",value:function(e){var t=this,n=e.__ng_removed;if(n&&n.setForRemoval){if(e.__ng_removed=Ef,n.namespaceId){this.destroyInnerAnimations(e);var i=this._fetchNamespace(n.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach((function(e){t.markElementAsDisabled(e,!1)}))}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((function(t,n){return e._balanceNamespaceList(t,n)})),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var i=0;i<this.collectedEnterElements.length;i++)Bf(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var r=[];try{n=this._flushAnimations(r,t)}finally{for(var a=0;a<r.length;a++)r[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach((function(e){return e()})),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?rd(n).onDone((function(){s.forEach((function(e){return e()}))})):s.forEach((function(e){return e()}))}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n "+e.join("\n"))}},{key:"_flushAnimations",value:function(e,t){var n=this,i=new nf,r=[],a=new Map,o=[],s=new Map,l=new Map,u=new Map,c=new Set;this.disabledNodes.forEach((function(e){c.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),i=0;i<t.length;i++)c.add(t[i])}));var h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=Lf(d,this.collectedEnterElements),p=new Map,m=0;f.forEach((function(e,t){var n="ng-enter"+m++;p.set(t,n),e.forEach((function(e){return Bf(e,n)}))}));for(var v=[],g=new Set,y=new Set,_=0;_<this.collectedLeaveElements.length;_++){var x=this.collectedLeaveElements[_],b=x.__ng_removed;b&&b.setForRemoval&&(v.push(x),g.add(x),b.hasAnimation?this.driver.query(x,".ng-star-inserted",!0).forEach((function(e){return g.add(e)})):y.add(x))}var w=new Map,k=Lf(d,Array.from(g));k.forEach((function(e,t){var n="ng-leave"+m++;w.set(t,n),e.forEach((function(e){return Bf(e,n)}))})),e.push((function(){f.forEach((function(e,t){var n=p.get(t);e.forEach((function(e){return Ff(e,n)}))})),k.forEach((function(e,t){var n=w.get(t);e.forEach((function(e){return Ff(e,n)}))})),v.forEach((function(e){n.processLeaveNode(e)}))}));for(var C=[],S=[],T=this._namespaceList.length-1;T>=0;T--)this._namespaceList[T].drainQueuedTransitions(t).forEach((function(e){var t=e.player,a=e.element;if(C.push(t),n.collectedEnterElements.length){var c=a.__ng_removed;if(c&&c.setForMove)return void t.destroy()}var d=!h||!n.driver.containsElement(h,a),f=w.get(a),m=p.get(a),v=n._buildInstruction(e,i,m,f,d);if(v.errors&&v.errors.length)S.push(v);else{if(d)return t.onStart((function(){return Od(a,v.fromStyles)})),t.onDestroy((function(){return Rd(a,v.toStyles)})),void r.push(t);if(e.isFallbackTransition)return t.onStart((function(){return Od(a,v.fromStyles)})),t.onDestroy((function(){return Rd(a,v.toStyles)})),void r.push(t);v.timelines.forEach((function(e){return e.stretchStartingKeyframe=!0})),i.append(a,v.timelines),o.push({instruction:v,player:t,element:a}),v.queriedElements.forEach((function(e){return ud(s,e,[]).push(t)})),v.preStyleProps.forEach((function(e,t){var n=Object.keys(e);if(n.length){var i=l.get(t);i||l.set(t,i=new Set),n.forEach((function(e){return i.add(e)}))}})),v.postStyleProps.forEach((function(e,t){var n=Object.keys(e),i=u.get(t);i||u.set(t,i=new Set),n.forEach((function(e){return i.add(e)}))}))}}));if(S.length){var E=[];S.forEach((function(e){E.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach((function(e){return E.push("- ".concat(e,"\n"))}))})),C.forEach((function(e){return e.destroy()})),this.reportError(E)}var P=new Map,M=new Map;o.forEach((function(e){var t=e.element;i.has(t)&&(M.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,P))})),r.forEach((function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach((function(e){ud(P,t,[]).push(e),e.destroy()}))}));var I=v.filter((function(e){return Hf(e,l,u)})),A=new Map;zf(A,this.driver,y,u,"*").forEach((function(e){Hf(e,l,u)&&I.push(e)}));var R=new Map;f.forEach((function(e,t){zf(R,n.driver,new Set(e),l,"!")})),I.forEach((function(e){var t=A.get(e),n=R.get(e);A.set(e,Object.assign(Object.assign({},t),n))}));var O=[],N=[],D={};o.forEach((function(e){var t=e.element,o=e.player,s=e.instruction;if(i.has(t)){if(c.has(t))return o.onDestroy((function(){return Rd(t,s.toStyles)})),o.disabled=!0,o.overrideTotalTime(s.totalTime),void r.push(o);var l=D;if(M.size>1){for(var u=t,h=[];u=u.parentNode;){var d=M.get(u);if(d){l=d;break}h.push(u)}h.forEach((function(e){return M.set(e,l)}))}var f=n._buildAnimation(o.namespaceId,s,P,a,R,A);if(o.setRealPlayer(f),l===D)O.push(o);else{var p=n.playersByElement.get(l);p&&p.length&&(o.parentPlayer=rd(p)),r.push(o)}}else Od(t,s.fromStyles),o.onDestroy((function(){return Rd(t,s.toStyles)})),N.push(o),c.has(t)&&r.push(o)})),N.forEach((function(e){var t=a.get(e.element);if(t&&t.length){var n=rd(t);e.setRealPlayer(n)}})),r.forEach((function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()}));for(var z=0;z<v.length;z++){var L=v[z],B=L.__ng_removed;if(Ff(L,"ng-leave"),!B||!B.hasAnimation){var F=[];if(s.size){var j=s.get(L);j&&j.length&&F.push.apply(F,_toConsumableArray(j));for(var H=this.driver.query(L,".ng-animating",!0),V=0;V<H.length;V++){var U=s.get(H[V]);U&&U.length&&F.push.apply(F,_toConsumableArray(U))}}var q=F.filter((function(e){return!e.destroyed}));q.length?jf(this,L,q):this.processLeaveNode(L)}}return v.length=0,O.forEach((function(e){n.players.push(e),e.onDone((function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)})),e.play()})),O}},{key:"elementContainsData",value:function(e,t){var n=!1,i=t.__ng_removed;return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,i,r){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var l=!r||"void"==r;s.forEach((function(e){e.queued||(l||e.triggerName==i)&&a.push(e)}))}}return(n||i)&&(a=a.filter((function(e){return!(n&&n!=e.namespaceId||i&&i!=e.triggerName)}))),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var i,r=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,l=_createForOfIteratorHelper(t.timelines);try{var u=function(){var e=i.value.element,l=e!==a,u=ud(n,e,[]);r._getPreviousPlayers(e,l,o,s,t.toState).forEach((function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),u.push(e)}))};for(l.s();!(i=l.n()).done;)u()}catch(c){l.e(c)}finally{l.f()}Od(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,i,r,a){var o=this,s=t.triggerName,l=t.element,u=[],c=new Set,h=new Set,d=t.timelines.map((function(t){var d=t.element;c.add(d);var f=d.__ng_removed;if(f&&f.removedBeforeQueried)return new td(t.duration,t.delay);var p,m,v=d!==l,g=(p=(n.get(d)||Tf).map((function(e){return e.getRealPlayer()})),m=[],function e(t,n){for(var i=0;i<t.length;i++){var r=t[i];r instanceof nd?e(r.players,n):n.push(r)}}(p,m),m).filter((function(e){return!!e.element&&e.element===d})),y=r.get(d),_=a.get(d),x=ad(0,o._normalizer,0,t.keyframes,y,_),b=o._buildPlayer(t,x,g);if(t.subTimeline&&i&&h.add(d),v){var w=new Of(e,s,d);w.setRealPlayer(b),u.push(w)}return b}));u.forEach((function(e){ud(o.playersByQueriedElement,e.element,[]).push(e),e.onDone((function(){return function(e,t,n){var i;if(e instanceof Map){if(i=e.get(t)){if(i.length){var r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}}else if(i=e[t]){if(i.length){var a=i.indexOf(n);i.splice(a,1)}0==i.length&&delete e[t]}return i}(o.playersByQueriedElement,e.element,e)}))})),c.forEach((function(e){return Bf(e,"ng-animating")}));var f=rd(d);return f.onDestroy((function(){c.forEach((function(e){return Ff(e,"ng-animating")})),Rd(l,t.toStyles)})),h.forEach((function(e){ud(i,e,[]).push(f)})),f}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new td(e.duration,e.delay)}}]),e}(),Of=function(){function e(t,n,i){_classCallCheck(this,e),this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new td,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return _createClass(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach((function(n){t._queuedCallbacks[n].forEach((function(t){return od(e,n,void 0,t)}))})),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart((function(){return n.triggerCallback("start")})),e.onDone((function(){return t.finish()})),e.onDestroy((function(){return t.destroy()}))}},{key:"_queueEvent",value:function(e,t){ud(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function Nf(e){return e&&1===e.nodeType}function Df(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function zf(e,t,n,i,r){var a=[];n.forEach((function(e){return a.push(Df(e))}));var o=[];i.forEach((function(n,i){var a={};n.forEach((function(e){var n=a[e]=t.computeStyle(i,e,r);n&&0!=n.length||(i.__ng_removed=Pf,o.push(i))})),e.set(i,a)}));var s=0;return n.forEach((function(e){return Df(e,a[s++])})),o}function Lf(e,t){var n=new Map;if(e.forEach((function(e){return n.set(e,[])})),0==t.length)return n;var i=new Set(t),r=new Map;return t.forEach((function(e){var t=function e(t){if(!t)return 1;var a=r.get(t);if(a)return a;var o=t.parentNode;return a=n.has(o)?o:i.has(o)?1:e(o),r.set(t,a),a}(e);1!==t&&n.get(t).push(e)})),n}function Bf(e,t){if(e.classList)e.classList.add(t);else{var n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function Ff(e,t){if(e.classList)e.classList.remove(t);else{var n=e.$$classes;n&&delete n[t]}}function jf(e,t,n){rd(n).onDone((function(){return e.processLeaveNode(t)}))}function Hf(e,t,n){var i=n.get(e);if(!i)return!1;var r=t.get(e);return r?i.forEach((function(e){return r.add(e)})):t.set(e,i),n.delete(e),!0}var Vf=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.bodyNode=t,this._driver=n,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new Rf(t,n,i),this._timelineEngine=new Sf(t,n,i),this._transitionEngine.onRemovalComplete=function(e,t){return r.onRemovalComplete(e,t)}}return _createClass(e,[{key:"registerTrigger",value:function(e,t,n,i,r){var a=e+"-"+i,o=this._triggerCache[a];if(!o){var s=[],l=Kd(this._driver,r,s);if(s.length)throw new Error('The animation trigger "'.concat(i,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t){return new wf(e,t)}(i,l),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,i,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}},{key:"onRemove",value:function(e,t,n,i){this._transitionEngine.removeNode(e,t,i||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,i){if("@"==n.charAt(0)){var r=_slicedToArray(cd(n),2),a=r[0],o=r[1];this._timelineEngine.command(a,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}},{key:"listen",value:function(e,t,n,i,r){if("@"==n.charAt(0)){var a=_slicedToArray(cd(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,r)}return this._transitionEngine.listen(e,t,n,i,r)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function Uf(e,t){var n=null,i=null;return Array.isArray(t)&&t.length?(n=Gf(t[0]),t.length>1&&(i=Gf(t[t.length-1]))):t&&(n=Gf(t)),n||i?new qf(e,n,i):null}var qf=function(){var e=function(){function e(t,n,i){_classCallCheck(this,e),this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;var r=e.initialStylesByElement.get(t);r||e.initialStylesByElement.set(t,r={}),this._initialStyles=r}return _createClass(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&Rd(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(Rd(this._element,this._initialStyles),this._endStyles&&(Rd(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Od(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Od(this._element,this._endStyles),this._endStyles=null),Rd(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function Gf(e){for(var t=null,n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];Wf(r)&&((t=t||{})[r]=e[r])}return t}function Wf(e){return"display"===e||"position"===e}var Zf=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this._element=t,this._name=n,this._duration=i,this._delay=r,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return l._handleCallback(e)}}return _createClass(e,[{key:"apply",value:function(){var e,t,n;e=this._element,t="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(n=$f(e,"").trim()).length&&(function(e,t){for(var n=0;n<e.length;n++)e.charAt(n)}(n),t="".concat(n,", ").concat(t)),Qf(e,"",t),Jf(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){Xf(this._element,this._name,"paused")}},{key:"resume",value:function(){Xf(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=Kf(this._element,this._name);this._position=e*this._duration,Qf(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),Jf(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){var e,t,n,i;this._destroyed||(this._destroyed=!0,this.finish(),e=this._element,t=this._name,n=$f(e,"").split(","),(i=Yf(n,t))>=0&&(n.splice(i,1),Qf(e,"",n.join(","))))}}]),e}();function Xf(e,t,n){Qf(e,"PlayState",n,Kf(e,t))}function Kf(e,t){var n=$f(e,"");return n.indexOf(",")>0?Yf(n.split(","),t):Yf([n],t)}function Yf(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function Jf(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function Qf(e,t,n,i){var r="animation"+t;if(null!=i){var a=e.style[r];if(a.length){var o=a.split(",");o[i]=n,n=o.join(",")}}e.style[r]=n}function $f(e,t){return e.style["animation"+t]}var ep=function(){function e(t,n,i,r,a,o,s,l){_classCallCheck(this,e),this.element=t,this.keyframes=n,this.animationName=i,this._duration=r,this._delay=a,this._finalStyles=s,this._specialStyles=l,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+a,this._buildStyler()}return _createClass(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new Zf(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",(function(){return e.finish()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach((function(i){"offset"!=i&&(t[i]=n?e._finalStyles[i]:qd(e.element,i))}))}this.currentSnapshot=t}}]),e}(),tp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=bd(n),i}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){var e=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach((function(t){e._startingStyles[t]=e.element.style[t]})),_get(_getPrototypeOf2(t.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach((function(t){return e.element.style.setProperty(t,e._styles[t])})),_get(_getPrototypeOf2(t.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach((function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)})),this._startingStyles=null,_get(_getPrototypeOf2(t.prototype),"destroy",this).call(this))}}]),t}(td),np=function(){function e(){_classCallCheck(this,e),this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return gd(e)}},{key:"matchesElement",value:function(e,t){return yd(e,t)}},{key:"containsElement",value:function(e,t){return _d(e,t)}},{key:"query",value:function(e,t,n){return xd(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map((function(e){return bd(e)}));var i="@keyframes ".concat(t," {\n"),r="";n.forEach((function(e){r=" ";var t=parseFloat(e.offset);i+="".concat(r).concat(100*t,"% {\n"),r+=" ",Object.keys(e).forEach((function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(i+="".concat(r,"animation-timing-function: ").concat(n,";\n")));default:return void(i+="".concat(r).concat(t,": ").concat(n,";\n"))}})),i+=r+"}\n"})),i+="}\n";var a=document.createElement("style");return a.innerHTML=i,a}},{key:"animate",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;o&&this._notifyFaultyScrubber();var s=a.filter((function(e){return e instanceof ep})),l={};Hd(n,i)&&s.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return l[e]=t[e]}))}));var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach((function(e){Object.keys(e).forEach((function(n){"offset"!=n&&"easing"!=n&&(t[n]=e[n])}))})),t}(t=Vd(e,t,l));if(0==n)return new tp(e,u);var c="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,c,t);document.querySelector("head").appendChild(h);var d=Uf(e,t),f=new ep(e,t,c,n,i,r,u,d);return f.onDestroy((function(){var e;(e=h).parentNode.removeChild(e)})),f}},{key:"_notifyFaultyScrubber",value:function(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}]),e}(),ip=function(){function e(t,n,i,r){_classCallCheck(this,e),this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",(function(){return e._onFinish()}))}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach((function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:qd(e.element,n))})),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}(),rp=function(){function e(){_classCallCheck(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(ap().toString()),this._cssKeyframesDriver=new np}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return gd(e)}},{key:"matchesElement",value:function(e,t){return yd(e,t)}},{key:"containsElement",value:function(e,t){return _d(e,t)}},{key:"query",value:function(e,t,n){return xd(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,i,r,a);var s={duration:n,delay:i,fill:0==i?"both":"forwards"};r&&(s.easing=r);var l={},u=a.filter((function(e){return e instanceof ip}));Hd(n,i)&&u.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return l[e]=t[e]}))}));var c=Uf(e,t=Vd(e,t=t.map((function(e){return Md(e,!1)})),l));return new ip(e,t,s,c)}}]),e}();function ap(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var op,sp=((op=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._nextAnimationId=0,i._renderer=e.createRenderer(n.body,{id:"0",encapsulation:pt.None,styles:[],data:{animation:[]}}),i}return _inherits(t,e),_createClass(t,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?Xh(e):e;return cp(this._renderer,null,t,"register",[n]),new lp(t,this._renderer)}}]),t}(Gh)).\u0275fac=function(e){return new(e||op)($e(qs),$e(rc))},op.\u0275prov=me({token:op,factory:op.\u0275fac}),op),lp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._id=e,i._renderer=n,i}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e,t){return new up(this._id,e,t||{},this._renderer)}}]),t}(function(){return _createClass((function e(){_classCallCheck(this,e)}))}()),up=function(){function e(t,n,i,r){_classCallCheck(this,e),this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}return _createClass(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return cp(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){return 0}}]),e}();function cp(e,t,n,i,r){return e.setProperty(t,"@@".concat(n,":").concat(i),r)}var hp,dp,fp,pp=((hp=function(){function e(t,n,i){_classCallCheck(this,e),this.delegate=t,this.engine=n,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return _createClass(e,[{key:"createRenderer",value:function(e,t){var n=this,i=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var r=this._rendererCache.get(i);return r||(r=new mp("",i,this.engine),this._rendererCache.set(i,r)),r}var a=t.id,o=t.id+"-"+this._currentId;return this._currentId++,this.engine.register(o,e),t.data.animation.forEach((function t(i){Array.isArray(i)?i.forEach(t):n.engine.registerTrigger(a,o,e,i.name,i)})),new vp(this,o,i,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then((function(){e._microtaskId++}))}},{key:"scheduleListenerCallback",value:function(e,t,n){var i=this;e>=0&&e<this._microtaskId?this._zone.run((function(){return t(n)})):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then((function(){i._zone.run((function(){i._animationCallbacksBuffer.forEach((function(e){var t=_slicedToArray(e,2);(0,t[0])(t[1])})),i._animationCallbacksBuffer=[]}))})),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular((function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)})),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}()).\u0275fac=function(e){return new(e||hp)($e(qs),$e(Vf),$e(Su))},hp.\u0275prov=me({token:hp,factory:hp.\u0275fac}),hp),mp=function(){function e(t,n,i){_classCallCheck(this,e),this.namespaceId=t,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return _createClass(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,!0)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,i){this.delegate.setStyle(e,t,n,i)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),vp=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[n,i,r])).factory=e,a.namespaceId=n,a}return _inherits(t,e),_createClass(t,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var i,r,a=this;if("@"==t.charAt(0)){var o,s=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),l=t.substr(1),u="";return"@"!=l.charAt(0)&&(r=(i=l).indexOf("."),l=(o=_slicedToArray([i.substring(0,r),i.substr(r+1)],2))[0],u=o[1]),this.engine.listen(this.namespaceId,s,l,u,(function(e){a.factory.scheduleListenerCallback(e._data||-1,n,e)}))}return this.delegate.listen(e,t,n)}}]),t}(mp),gp=((dp=function(e){function t(e,n,i){return _classCallCheck(this,t),_callSuper(this,t,[e.body,n,i])}return _inherits(t,e),_createClass(t)}(Vf)).\u0275fac=function(e){return new(e||dp)($e(rc),$e(Cd),$e(mf))},dp.\u0275prov=me({token:dp,factory:dp.\u0275fac}),dp),yp=new qe("AnimationModuleType"),_p=[{provide:Cd,useFactory:function(){return"function"==typeof ap()?new rp:new np}},{provide:yp,useValue:"BrowserAnimations"},{provide:Gh,useClass:sp},{provide:mf,useFactory:function(){return new vf}},{provide:Vf,useClass:gp},{provide:qs,useFactory:function(e,t,n){return new pp(e,t,n)},deps:[Ih,Vf,Su]}],xp=((fp=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:fp}),fp.\u0275inj=ve({factory:function(e){return new(e||fp)},providers:_p,imports:[qh]}),fp);function bp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return R(i)?(t.pop(),q(t,i)):Y(t)}var wp=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._value=e,n}return _inherits(t,e),_createClass(t,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var n=_get(_getPrototypeOf2(t.prototype),"_subscribe",this).call(this,e);return n&&!n.closed&&e.next(this._value),n}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new E;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf2(t.prototype),"next",this).call(this,this._value=e)}}]),t}(I),kp=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Cp={};function Sp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=null,r=null;return R(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(i=t.pop()),1===t.length&&c(t[0])&&(t=t[0]),Y(t,r).lift(new Tp(i))}var Tp=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ep(e,this.resultSelector))}}]),e}(),Ep=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).resultSelector=n,i.active=0,i.values=[],i.observables=[],i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.values.push(Cp),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var i=e[n];this.add(F(this,i,i,n))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n,i,r){var a=this.values,o=this.toRespond?a[n]===Cp?--this.toRespond:this.toRespond:0;a[n]=t,0===o&&(this.resultSelector?this._tryResultSelector(a):this.destination.next(a.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(j),Pp=new C((function(e){return e.complete()}));function Mp(e){return e?function(e){return new C((function(t){return e.schedule((function(){return t.complete()}))}))}(e):Pp}function Ip(e){return new C((function(t){var n;try{n=e()}catch(i){return void t.error(i)}return(n?G(n):Mp()).subscribe(t)}))}function Ap(){return K(1)}function Rp(e,t){return function(n){return n.lift(new Op(e,t))}}var Op=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Np(e,this.predicate,this.thisArg))}}]),e}(),Np=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).predicate=n,r.thisArg=i,r.count=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),t}(g),Dp=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function zp(e){return function(t){return 0===e?Mp():t.lift(new Lp(e))}}var Lp=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Dp}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Bp(e,this.total))}}]),e}(),Bp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).total=n,i.ring=new Array,i.count=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t=this.ring,n=this.total,i=this.count++;t.length<n?t.push(e):t[i%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,i=this.ring,r=0;r<n;r++){var a=t++%n;e.next(i[a])}e.complete()}}]),t}(g);function Fp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vp;return function(t){return t.lift(new jp(e))}}var jp=function(){function e(t){_classCallCheck(this,e),this.errorFactory=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Hp(e,this.errorFactory))}}]),e}(),Hp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).errorFactory=n,i.hasValue=!1,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.hasValue=!0,this.destination.next(e)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}]),t}(g);function Vp(){return new kp}function Up(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new qp(e))}}var qp=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Gp(e,this.defaultValue))}}]),e}(),Gp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).defaultValue=n,i.isEmpty=!0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),t}(g);function Wp(e,t){var n=arguments.length>=2;return function(i){return i.pipe(e?Rp((function(t,n){return e(t,n,i)})):x,zp(1),n?Up(t):Fp((function(){return new kp})))}}function Zp(e){return function(t){var n=new Xp(e),i=t.lift(n);return n.caught=i}}var Xp=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Kp(e,this.selector,this.caught))}}]),e}(),Kp=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).selector=n,r.caught=i,r}return _inherits(t,e),_createClass(t,[{key:"error",value:function(e){if(!this.isStopped){var n;try{n=this.selector(e,this.caught)}catch(a){return void _get(_getPrototypeOf2(t.prototype),"error",this).call(this,a)}this._unsubscribeAndRecycle();var i=new O(this,void 0,void 0);this.add(i);var r=F(this,n,void 0,void 0,i);r!==i&&this.add(r)}}}]),t}(j);function Yp(e){return function(t){return 0===e?Mp():t.lift(new Jp(e))}}var Jp=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Dp}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Qp(e,this.total))}}]),e}(),Qp=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).total=n,i.count=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),t}(g);function $p(e,t){var n=arguments.length>=2;return function(i){return i.pipe(e?Rp((function(t,n){return e(t,n,i)})):x,Yp(1),n?Up(t):Fp((function(){return new kp})))}}var em=function(){function e(t,n,i){_classCallCheck(this,e),this.predicate=t,this.thisArg=n,this.source=i}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new tm(e,this.predicate,this.thisArg,this.source))}}]),e}(),tm=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e])).predicate=n,a.thisArg=i,a.source=r,a.index=0,a.thisArg=i||_assertThisInitialized2(a),a}return _inherits(t,e),_createClass(t,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(n){return void this.destination.error(n)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),t}(g);function nm(e,t){return"function"==typeof t?function(n){return n.pipe(nm((function(n,i){return G(e(n,i)).pipe(H((function(e,r){return t(n,e,i,r)})))})))}:function(t){return t.lift(new im(e))}}var im=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new rm(e,this.project))}}]),e}(),rm=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).project=n,i.index=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var i=this.innerSubscription;i&&i.unsubscribe();var r=new O(this,t,n),a=this.destination;a.add(r),this.innerSubscription=F(this,e,void 0,void 0,r),this.innerSubscription!==r&&a.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf2(t.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf2(t.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,n,i,r){this.destination.next(t)}}]),t}(j);function am(){return Ap()(bp.apply(void 0,arguments))}function om(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return R(i)?(t.pop(),function(e){return am(t,e,i)}):function(e){return am(t,e)}}function sm(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new lm(e,t,n))}}var lm=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=i}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new um(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),um=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e])).accumulator=n,a._seed=i,a.hasSeed=r,a.index=0,a}return _inherits(t,e),_createClass(t,[{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}},{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(i){this.destination.error(i)}this.seed=t,this.destination.next(t)}}]),t}(g);function cm(e,t){return W(e,t,1)}function hm(){}function dm(e,t,n){return function(i){return i.lift(new fm(e,t,n))}}var fm=function(){function e(t,n,i){_classCallCheck(this,e),this.nextOrObserver=t,this.error=n,this.complete=i}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new pm(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),pm=function(e){function t(e,n,i,r){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e]))._tapNext=hm,o._tapError=hm,o._tapComplete=hm,o._tapError=i||hm,o._tapComplete=r||hm,a(n)?(o._context=_assertThisInitialized2(o),o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||hm,o._tapError=n.error||hm,o._tapComplete=n.complete||hm),o}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),t}(g);function mm(e){return function(t){return t.lift(new gm(e))}}var vm,gm=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ym(e,this.callback))}}]),e}(),ym=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).add(new p(n)),i}return _inherits(t,e),_createClass(t)}(g),_m=_createClass((function e(t,n){_classCallCheck(this,e),this.id=t,this.url=n})),xm=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).navigationTrigger=r,i.restoredState=a,i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(_m),bm=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).urlAfterRedirects=i,r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),t}(_m),wm=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).reason=i,r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(_m),km=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).error=i,r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),t}(_m),Cm=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n])).urlAfterRedirects=i,a.state=r,a}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(_m),Sm=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n])).urlAfterRedirects=i,a.state=r,a}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(_m),Tm=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e,n])).urlAfterRedirects=i,o.state=r,o.shouldActivate=a,o}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),t}(_m),Em=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n])).urlAfterRedirects=i,a.state=r,a}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(_m),Pm=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n])).urlAfterRedirects=i,a.state=r,a}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(_m),Mm=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),Im=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),Am=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Rm=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Om=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Nm=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Dm=function(){function e(t,n,i){_classCallCheck(this,e),this.routerEvent=t,this.position=n,this.anchor=i}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),zm=((vm=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||vm)},vm.\u0275cmp=yt({type:vm,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Oo(0,"router-outlet")},directives:function(){return[Zg]},encapsulation:2}),vm),Lm=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function Bm(e){return new Lm(e)}function Fm(e){var t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function jm(e,t,n){var i=n.path.split("/");if(i.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;for(var r={},a=0;a<i.length;a++){var o=i[a],s=e[a];if(o.startsWith(":"))r[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}var Hm=_createClass((function e(t,n){_classCallCheck(this,e),this.routes=t,this.module=n}));function Vm(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var i=e[n];Um(i,qm(t,i))}}function Um(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&"primary"!==e.outlet)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&Vm(e.children,t)}function qm(e,t){return t?e||t.path?e&&!t.path?e+"/":!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function Gm(e){var t=e.children&&e.children.map(Gm),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=zm),n}function Wm(e,t){var n,i=Object.keys(e),r=Object.keys(t);if(!i||!r||i.length!=r.length)return!1;for(var a=0;a<i.length;a++)if(!Zm(e[n=i[a]],t[n]))return!1;return!0}function Zm(e,t){return Array.isArray(e)&&Array.isArray(t)?e.length==t.length&&e.every((function(e){return t.indexOf(e)>-1})):e===t}function Xm(e){return Array.prototype.concat.apply([],e)}function Km(e){return e.length>0?e[e.length-1]:null}function Ym(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Jm(e){return Bo(e)?e:Lo(e)?G(Promise.resolve(e)):bp(e)}function Qm(e,t,n){return n?function(e,t){return Wm(e,t)}(e.queryParams,t.queryParams)&&function e(t,n){if(!nv(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children){if(!t.children[i])return!1;if(!e(t.children[i],n.children[i]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every((function(n){return Zm(e[n],t[n])}))}(e.queryParams,t.queryParams)&&function e(t,n){return function t(n,i,r){if(n.segments.length>r.length)return!!nv(n.segments.slice(0,r.length),r)&&!i.hasChildren();if(n.segments.length===r.length){if(!nv(n.segments,r))return!1;for(var a in i.children){if(!n.children[a])return!1;if(!e(n.children[a],i.children[a]))return!1}return!0}var o=r.slice(0,n.segments.length),s=r.slice(n.segments.length);return!!nv(n.segments,o)&&!!n.children.primary&&t(n.children.primary,i,s)}(t,n,n.segments)}(e.root,t.root)}var $m=function(){function e(t,n,i){_classCallCheck(this,e),this.root=t,this.queryParams=n,this.fragment=i}return _createClass(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Bm(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return ov.serialize(this)}}]),e}(),ev=function(){function e(t,n){var i=this;_classCallCheck(this,e),this.segments=t,this.children=n,this.parent=null,Ym(n,(function(e,t){return e.parent=i}))}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return sv(this)}}]),e}(),tv=function(){function e(t,n){_classCallCheck(this,e),this.path=t,this.parameters=n}return _createClass(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=Bm(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return fv(this)}}]),e}();function nv(e,t){return e.length===t.length&&e.every((function(e,n){return e.path===t[n].path}))}function iv(e,t){var n=[];return Ym(e.children,(function(e,i){"primary"===i&&(n=n.concat(t(e,i)))})),Ym(e.children,(function(e,i){"primary"!==i&&(n=n.concat(t(e,i)))})),n}var rv=_createClass((function e(){_classCallCheck(this,e)})),av=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new yv(e);return new $m(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){return"".concat("/"+function e(t,n){if(!t.hasChildren())return sv(t);if(n){var i=t.children.primary?e(t.children.primary,!1):"",r=[];return Ym(t.children,(function(t,n){"primary"!==n&&r.push("".concat(n,":").concat(e(t,!1)))})),r.length>0?"".concat(i,"(").concat(r.join("//"),")"):i}var a=iv(t,(function(n,i){return"primary"===i?[e(t.children.primary,!1)]:["".concat(i,":").concat(e(n,!1))]}));return"".concat(sv(t),"/(").concat(a.join("//"),")")}(e.root,!0)).concat((t=e.queryParams,n=Object.keys(t).map((function(e){var n=t[e];return Array.isArray(n)?n.map((function(t){return"".concat(uv(e),"=").concat(uv(t))})).join("&"):"".concat(uv(e),"=").concat(uv(n))})),n.length?"?"+n.join("&"):"")).concat("string"==typeof e.fragment?"#"+encodeURI(e.fragment):"");var t,n}}]),e}(),ov=new av;function sv(e){return e.segments.map((function(e){return fv(e)})).join("/")}function lv(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function uv(e){return lv(e).replace(/%3B/gi,";")}function cv(e){return lv(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hv(e){return decodeURIComponent(e)}function dv(e){return hv(e.replace(/\+/g,"%20"))}function fv(e){return"".concat(cv(e.path)).concat((t=e.parameters,Object.keys(t).map((function(e){return";".concat(cv(e),"=").concat(cv(t[e]))})).join("")));var t}var pv=/^[^\/()?;=#]+/;function mv(e){var t=e.match(pv);return t?t[0]:""}var vv=/^[^=?&#]+/,gv=/^[^?&#]+/,yv=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ev([],{}):new ev([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n.primary=new ev(e,t)),n}},{key:"parseSegment",value:function(){var e=mv(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new tv(hv(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=mv(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var i=mv(this.remaining);i&&(n=i,this.capture(n))}e[hv(t)]=hv(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(vv);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var i=function(e){var t=e.match(gv);return t?t[0]:""}(this.remaining);i&&(n=i,this.capture(n))}var r=dv(t),a=dv(n);if(e.hasOwnProperty(r)){var o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(a)}else e[r]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=mv(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error("Cannot parse url '".concat(this.url,"'"));var r=void 0;n.indexOf(":")>-1?(r=n.substr(0,n.indexOf(":")),this.capture(r),this.capture(":")):e&&(r="primary");var a=this.parseChildren();t[r]=1===Object.keys(a).length?a.primary:new ev([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),_v=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=xv(e,this._root);return t?t.children.map((function(e){return e.value})):[]}},{key:"firstChild",value:function(e){var t=xv(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=bv(e,this._root);return t.length<2?[]:t[t.length-2].children.map((function(e){return e.value})).filter((function(t){return t!==e}))}},{key:"pathFromRoot",value:function(e){return bv(e,this._root).map((function(e){return e.value}))}}]),e}();function xv(e,t){if(e===t.value)return t;var n,i=_createForOfIteratorHelper(t.children);try{for(i.s();!(n=i.n()).done;){var r=xv(e,n.value);if(r)return r}}catch(a){i.e(a)}finally{i.f()}return null}function bv(e,t){if(e===t.value)return[t];var n,i=_createForOfIteratorHelper(t.children);try{for(i.s();!(n=i.n()).done;){var r=bv(e,n.value);if(r.length)return r.unshift(t),r}}catch(a){i.e(a)}finally{i.f()}return[]}var wv=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.children=n}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function kv(e){var t={};return e&&e.children.forEach((function(e){return t[e.value.outlet]=e})),t}var Cv=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).snapshot=n,Iv(_assertThisInitialized2(i),e),i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return this.snapshot.toString()}}]),t}(_v);function Sv(e,t){var n=function(e,t){var n=new Pv([],{},{},"",{},"primary",t,null,e.root,-1,{});return new Mv("",new wv(n,[]))}(e,t),i=new wp([new tv("",{})]),r=new wp({}),a=new wp({}),o=new wp({}),s=new wp(""),l=new Tv(i,r,o,s,a,"primary",t,n.root);return l.snapshot=n.root,new Cv(new wv(l,[]),n)}var Tv=function(){function e(t,n,i,r,a,o,s,l){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=l}return _createClass(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(H((function(e){return Bm(e)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(H((function(e){return Bm(e)})))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function Ev(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,i=0;if("always"!==t)for(i=n.length-1;i>=1;){var r=n[i],a=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(a.component)break;i--}}return function(e){return e.reduce((function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(i))}var Pv=function(){function e(t,n,i,r,a,o,s,l,u,c,h){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=o,this.component=s,this.routeConfig=l,this._urlSegment=u,this._lastPathIndex=c,this._resolve=h}return _createClass(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=Bm(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Bm(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(e){return e.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),Mv=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[n])).url=e,Iv(_assertThisInitialized2(i),n),i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return Av(this._root)}}]),t}(_v);function Iv(e,t){t.value._routerState=e,t.children.forEach((function(t){return Iv(e,t)}))}function Av(e){var t=e.children.length>0?" { ".concat(e.children.map(Av).join(", ")," } "):"";return"".concat(e.value).concat(t)}function Rv(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Wm(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),Wm(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!Wm(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),Wm(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Ov(e,t){var n,i;return Wm(e.params,t.params)&&nv(n=e.url,i=t.url)&&n.every((function(e,t){return Wm(e.parameters,i[t].parameters)}))&&!(!e.parent!=!t.parent)&&(!e.parent||Ov(e.parent,t.parent))}function Nv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Dv(e,t,n,i,r){var a={};return i&&Ym(i,(function(e,t){a[t]=Array.isArray(e)?e.map((function(e){return""+e})):""+e})),new $m(n.root===e?t:function e(t,n,i){var r={};return Ym(t.children,(function(t,a){r[a]=t===n?i:e(t,n,i)})),new ev(t.segments,r)}(n.root,e,t),a,r)}var zv=function(){function e(t,n,i){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&Nv(i[0]))throw new Error("Root segment cannot have matrix parameters");var r=i.find((function(e){return"object"==typeof e&&null!=e&&e.outlets}));if(r&&r!==Km(i))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),Lv=_createClass((function e(t,n,i){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=n,this.index=i}));function Bv(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets.primary:""+e}function Fv(e,t,n){if(e||(e=new ev([],{})),0===e.segments.length&&e.hasChildren())return jv(e,t,n);var i=function(e,t,n){for(var i=0,r=t,a={match:!1,pathIndex:0,commandIndex:0};r<e.segments.length;){if(i>=n.length)return a;var o=e.segments[r],s=Bv(n[i]),l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===s)break;if(s&&l&&"object"==typeof l&&void 0===l.outlets){if(!qv(s,l,o))return a;i+=2}else{if(!qv(s,{},o))return a;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){var a=new ev(e.segments.slice(0,i.pathIndex),{});return a.children.primary=new ev(e.segments.slice(i.pathIndex),e.children),jv(a,0,r)}return i.match&&0===r.length?new ev(e.segments,{}):i.match&&!e.hasChildren()?Hv(e,t,n):i.match?jv(e,0,r):Hv(e,t,n)}function jv(e,t,n){if(0===n.length)return new ev(e.segments,{});var i=function(e){return"object"!=typeof e[0]||void 0===e[0].outlets?{primary:e}:e[0].outlets}(n),r={};return Ym(i,(function(n,i){null!==n&&(r[i]=Fv(e.children[i],t,n))})),Ym(e.children,(function(e,t){void 0===i[t]&&(r[t]=e)})),new ev(e.segments,r)}function Hv(e,t,n){for(var i=e.segments.slice(0,t),r=0;r<n.length;){if("object"==typeof n[r]&&void 0!==n[r].outlets){var a=Vv(n[r].outlets);return new ev(i,a)}if(0===r&&Nv(n[0]))i.push(new tv(e.segments[t].path,n[0])),r++;else{var o=Bv(n[r]),s=r<n.length-1?n[r+1]:null;o&&s&&Nv(s)?(i.push(new tv(o,Uv(s))),r+=2):(i.push(new tv(o,{})),r++)}}return new ev(i,{})}function Vv(e){var t={};return Ym(e,(function(e,n){null!==e&&(t[n]=Hv(new ev([],{}),0,e))})),t}function Uv(e){var t={};return Ym(e,(function(e,n){return t[n]=""+e})),t}function qv(e,t,n){return e==n.path&&Wm(t,n.parameters)}var Gv=function(){function e(t,n,i,r){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Rv(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var i=this,r=kv(t);e.children.forEach((function(e){var t=e.value.outlet;i.deactivateRoutes(e,r[t],n),delete r[t]})),Ym(r,(function(e,t){i.deactivateRouteAndItsChildren(e,n)}))}},{key:"deactivateRoutes",value:function(e,t,n){var i=e.value,r=t?t.value:null;if(i===r)if(i.component){var a=n.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else r&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var i=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:i,route:e,contexts:r})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var n=this,i=t.getContext(e.value.outlet);if(i){var r=kv(e),a=e.value.component?i.children:t;Ym(r,(function(e,t){return n.deactivateRouteAndItsChildren(e,a)})),i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,n){var i=this,r=kv(t);e.children.forEach((function(e){i.activateRoutes(e,r[e.value.outlet],n),i.forwardEvent(new Nm(e.value.snapshot))})),e.children.length&&this.forwardEvent(new Rm(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var i=e.value,r=t?t.value:null;if(Rv(i),i===r)if(i.component){var a=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(i.component){var o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){var s=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),Wv(s.route)}else{var l=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(i.snapshot),u=l?l.module.componentFactoryResolver:null;o.attachRef=null,o.route=i,o.resolver=u,o.outlet&&o.outlet.activateWith(i,u),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function Wv(e){Rv(e.value),e.children.forEach(Wv)}function Zv(e){return"function"==typeof e}function Xv(e){return e instanceof $m}var Kv=_createClass((function e(t){_classCallCheck(this,e),this.segmentGroup=t||null})),Yv=_createClass((function e(t){_classCallCheck(this,e),this.urlTree=t}));function Jv(e){return new C((function(t){return t.error(new Kv(e))}))}function Qv(e){return new C((function(t){return t.error(new Yv(e))}))}function $v(e){return new C((function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))}))}var eg=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(rt)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(H((function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)}))).pipe(Zp((function(t){if(t instanceof Yv)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof Kv)throw e.noMatchError(t);throw t})))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(H((function(n){return t.createUrlTree(n,e.queryParams,e.fragment)}))).pipe(Zp((function(e){if(e instanceof Kv)throw t.noMatchError(e);throw e})))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var i=e.segments.length>0?new ev([],{primary:e}):e;return new $m(i,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(H((function(e){return new ev([],e)}))):this.expandSegment(e,n,t,n.segments,i,!0)}},{key:"expandChildren",value:function(e,t,n){var i=this;return function(n,r){if(0===Object.keys(n).length)return bp({});var a=[],o=[],s={};return Ym(n,(function(n,r){var l,u,c=(l=r,u=n,i.expandSegmentGroup(e,t,u,l)).pipe(H((function(e){return s[r]=e})));"primary"===r?a.push(c):o.push(c)})),bp.apply(null,a.concat(o)).pipe(Ap(),Wp(),H((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(e,t,n,i,r,a){var o=this;return bp.apply(void 0,_toConsumableArray(n)).pipe(H((function(s){return o.expandSegmentAgainstRoute(e,t,n,s,i,r,a).pipe(Zp((function(e){if(e instanceof Kv)return bp(null);throw e})))})),Ap(),$p((function(e){return!!e})),Zp((function(e,n){if(e instanceof kp||"EmptyError"===e.name){if(o.noLeftoversInUrl(t,i,r))return bp(new ev([],{}));throw new Kv(t)}throw e})))}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,i,r,a,o){return rg(i)!==a?Jv(t):void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,r):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,i,r,a):Jv(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,i,r,a){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,r,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,i){var r=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Qv(a):this.lineralizeSegments(n,a).pipe(W((function(n){var a=new ev(n,{});return r.expandSegment(e,a,t,n,i,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,i,r,a){var o=this,s=tg(t,i,r),l=s.matched,u=s.consumedSegments,c=s.lastChild,h=s.positionalParamSegments;if(!l)return Jv(t);var d=this.applyRedirectCommands(u,i.redirectTo,h);return i.redirectTo.startsWith("/")?Qv(d):this.lineralizeSegments(i,d).pipe(W((function(i){return o.expandSegment(e,t,n,i.concat(r.slice(c)),a,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,i){var r=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(e.injector,n).pipe(H((function(e){return n._loadedConfig=e,new ev(i,{})}))):bp(new ev(i,{}));var a=tg(t,n,i),o=a.matched,s=a.consumedSegments,l=a.lastChild;if(!o)return Jv(t);var u=i.slice(l);return this.getChildConfig(e,n,i).pipe(W((function(e){var n=e.module,i=e.routes,a=function(e,t,n,i){return n.length>0&&function(e,t,n){return n.some((function(n){return ig(e,t,n)&&"primary"!==rg(n)}))}(e,n,i)?{segmentGroup:ng(new ev(t,function(e,t){var n={};n.primary=t;var i,r=_createForOfIteratorHelper(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;""===a.path&&"primary"!==rg(a)&&(n[rg(a)]=new ev([],{}))}}catch(o){r.e(o)}finally{r.f()}return n}(i,new ev(n,e.children)))),slicedSegments:[]}:0===n.length&&function(e,t,n){return n.some((function(n){return ig(e,t,n)}))}(e,n,i)?{segmentGroup:ng(new ev(e.segments,function(e,t,n,i){var r,a={},o=_createForOfIteratorHelper(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;ig(e,t,s)&&!i[rg(s)]&&(a[rg(s)]=new ev([],{}))}}catch(l){o.e(l)}finally{o.f()}return Object.assign(Object.assign({},i),a)}(e,n,i,e.children))),slicedSegments:n}:{segmentGroup:e,slicedSegments:n}}(t,s,u,i),o=a.segmentGroup,l=a.slicedSegments;return 0===l.length&&o.hasChildren()?r.expandChildren(n,i,o).pipe(H((function(e){return new ev(s,e)}))):0===i.length&&0===l.length?bp(new ev(s,{})):r.expandSegment(n,o,i,l,"primary",!0).pipe(H((function(e){return new ev(s.concat(e.segments),e.children)})))})))}},{key:"getChildConfig",value:function(e,t,n){var i=this;return t.children?bp(new Hm(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?bp(t._loadedConfig):function(e,t,n){var i,r=t.canLoad;return r&&0!==r.length?G(r).pipe(H((function(i){var r,a=e.get(i);if(function(e){return e&&Zv(e.canLoad)}(a))r=a.canLoad(t,n);else{if(!Zv(a))throw new Error("Invalid CanLoad guard");r=a(t,n)}return Jm(r)}))).pipe(Ap(),(i=function(e){return!0===e},function(e){return e.lift(new em(i,void 0,e))})):bp(!0)}(e.injector,t,n).pipe(W((function(n){return n?i.configLoader.load(e.injector,t).pipe(H((function(e){return t._loadedConfig=e,e}))):function(e){return new C((function(t){return t.error(Fm("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))}))}(t)}))):bp(new Hm([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],i=t.root;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return bp(n);if(i.numberOfChildren>1||!i.children.primary)return $v(e.redirectTo);i=i.children.primary}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,i){var r=this.createSegmentGroup(e,t.root,n,i);return new $m(r,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return Ym(e,(function(e,i){if("string"==typeof e&&e.startsWith(":")){var r=e.substring(1);n[i]=t[r]}else n[i]=e})),n}},{key:"createSegmentGroup",value:function(e,t,n,i){var r=this,a=this.createSegments(e,t.segments,n,i),o={};return Ym(t.children,(function(t,a){o[a]=r.createSegmentGroup(e,t,n,i)})),new ev(a,o)}},{key:"createSegments",value:function(e,t,n,i){var r=this;return t.map((function(t){return t.path.startsWith(":")?r.findPosParam(e,t,i):r.findOrReturn(t,n)}))}},{key:"findPosParam",value:function(e,t,n){var i=n[t.path.substring(1)];if(!i)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return i}},{key:"findOrReturn",value:function(e,t){var n,i=0,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(i),a;i++}}catch(o){r.e(o)}finally{r.f()}return e}}]),e}();function tg(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var i=(t.matcher||jm)(n,e,t);return i?{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,positionalParamSegments:i.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function ng(e){if(1===e.numberOfChildren&&e.children.primary){var t=e.children.primary;return new ev(e.segments.concat(t.segments),t.children)}return e}function ig(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function rg(e){return e.outlet||"primary"}var ag=_createClass((function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]})),og=_createClass((function e(t,n){_classCallCheck(this,e),this.component=t,this.route=n}));function sg(e,t,n){var i=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(i?i.module.injector:n).get(e)}function lg(e,t,n){var i=kv(e),r=e.value;Ym(i,(function(e,i){lg(e,r.component?t?t.children.getContext(i):null:t,n)})),n.canDeactivateChecks.push(new og(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}var ug=Symbol("INITIAL_VALUE");function cg(){return nm((function(e){return Sp.apply(void 0,_toConsumableArray(e.map((function(e){return e.pipe(Yp(1),om(ug))})))).pipe(sm((function(e,t){var n=!1;return t.reduce((function(e,i,r){if(e!==ug)return e;if(i===ug&&(n=!0),!n){if(!1===i)return i;if(r===t.length-1||Xv(i))return i}return e}),e)}),ug),Rp((function(e){return e!==ug})),H((function(e){return Xv(e)?e:!0===e})),Yp(1))}))}function hg(e,t){return null!==e&&t&&t(new Om(e)),bp(!0)}function dg(e,t){return null!==e&&t&&t(new Am(e)),bp(!0)}function fg(e,t,n){var i=t.routeConfig?t.routeConfig.canActivate:null;return i&&0!==i.length?bp(i.map((function(i){return Ip((function(){var r,a=sg(i,t,n);if(function(e){return e&&Zv(e.canActivate)}(a))r=Jm(a.canActivate(t,e));else{if(!Zv(a))throw new Error("Invalid CanActivate guard");r=Jm(a(t,e))}return r.pipe($p())}))}))).pipe(cg()):bp(!0)}function pg(e,t,n){var i=t[t.length-1],r=t.slice(0,t.length-1).reverse().map((function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)})).filter((function(e){return null!==e})).map((function(t){return Ip((function(){return bp(t.guards.map((function(r){var a,o=sg(r,t.node,n);if(function(e){return e&&Zv(e.canActivateChild)}(o))a=Jm(o.canActivateChild(i,e));else{if(!Zv(o))throw new Error("Invalid CanActivateChild guard");a=Jm(o(i,e))}return a.pipe($p())}))).pipe(cg())}))}));return bp(r).pipe(cg())}var mg=_createClass((function e(){_classCallCheck(this,e)})),vg=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this.rootComponentType=t,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return _createClass(e,[{key:"recognize",value:function(){try{var e=_g(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary"),n=new Pv([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),i=new wv(n,t),r=new Mv(this.url,i);return this.inheritParamsAndData(r._root),bp(r)}catch(a){return new C((function(e){return e.error(a)}))}}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,i=Ev(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach((function(e){return t.inheritParamsAndData(e)}))}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){var n,i=this,r=iv(t,(function(t,n){return i.processSegmentGroup(e,t,n)}));return n={},r.forEach((function(e){var t=n[e.value.outlet];if(t){var i=t.url.map((function(e){return e.toString()})).join("/"),r=e.value.url.map((function(e){return e.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(i,"' and '").concat(r,"'."))}n[e.value.outlet]=e.value})),r.sort((function(e,t){return"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)})),r}},{key:"processSegment",value:function(e,t,n,i){var r,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;try{return this.processSegmentAgainstRoute(o,t,n,i)}catch(s){if(!(s instanceof mg))throw s}}}catch(l){a.e(l)}finally{a.f()}if(this.noLeftoversInUrl(t,n,i))return[];throw new mg}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"processSegmentAgainstRoute",value:function(e,t,n,i){if(e.redirectTo)throw new mg;if((e.outlet||"primary")!==i)throw new mg;var r,a=[],o=[];if("**"===e.path){var s=n.length>0?Km(n).parameters:{};r=new Pv(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,wg(e),i,e.component,e,gg(t),yg(t)+n.length,kg(e))}else{var l=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new mg;return{consumedSegments:[],lastChild:0,parameters:{}}}var i=(t.matcher||jm)(n,e,t);if(!i)throw new mg;var r={};Ym(i.posParams,(function(e,t){r[t]=e.path}));var a=i.consumed.length>0?Object.assign(Object.assign({},r),i.consumed[i.consumed.length-1].parameters):r;return{consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:a}}(t,e,n);a=l.consumedSegments,o=n.slice(l.lastChild),r=new Pv(a,l.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,wg(e),i,e.component,e,gg(t),yg(t)+a.length,kg(e))}var u=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),c=_g(t,a,o,u,this.relativeLinkResolution),h=c.segmentGroup,d=c.slicedSegments;if(0===d.length&&h.hasChildren()){var f=this.processChildren(u,h);return[new wv(r,f)]}if(0===u.length&&0===d.length)return[new wv(r,[])];var p=this.processSegment(u,h,d,"primary");return[new wv(r,p)]}}]),e}();function gg(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function yg(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function _g(e,t,n,i,r){if(n.length>0&&function(e,t,n){return n.some((function(n){return xg(e,t,n)&&"primary"!==bg(n)}))}(e,n,i)){var a=new ev(t,function(e,t,n,i){var r={};r.primary=i,i._sourceSegment=e,i._segmentIndexShift=t.length;var a,o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&"primary"!==bg(s)){var l=new ev([],{});l._sourceSegment=e,l._segmentIndexShift=t.length,r[bg(s)]=l}}}catch(u){o.e(u)}finally{o.f()}return r}(e,t,i,new ev(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some((function(n){return xg(e,t,n)}))}(e,n,i)){var o=new ev(e.segments,function(e,t,n,i,r,a){var o,s={},l=_createForOfIteratorHelper(i);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(xg(e,n,u)&&!r[bg(u)]){var c=new ev([],{});c._sourceSegment=e,c._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[bg(u)]=c}}}catch(h){l.e(h)}finally{l.f()}return Object.assign(Object.assign({},r),s)}(e,t,n,i,e.children,r));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new ev(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function xg(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function bg(e){return e.outlet||"primary"}function wg(e){return e.data||{}}function kg(e){return e.resolve||{}}function Cg(e,t,n,i){var r=sg(e,t,i);return Jm(r.resolve?r.resolve(t,n):r(t,n))}function Sg(e){return function(t){return t.pipe(nm((function(t){var n=e(t);return n?G(n).pipe(H((function(){return t}))):G([t])})))}}var Tg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),Eg=new qe("ROUTES"),Pg=function(){function e(t,n,i,r){_classCallCheck(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}return _createClass(e,[{key:"load",value:function(e,t){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(H((function(i){n.onLoadEndListener&&n.onLoadEndListener(t);var r=i.create(e);return new Hm(Xm(r.injector.get(Eg)).map(Gm),r)})))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?G(this.loader.load(e)):Jm(e()).pipe(W((function(e){return e instanceof at?bp(e):G(t.compiler.compileModuleAsync(e))})))}}]),e}(),Mg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function Ig(e){throw e}function Ag(e,t,n){return t.parse("/")}function Rg(e,t){return bp(null)}var Og,Ng,Dg,zg=((Dg=function(){function e(t,n,i,r,a,o,s,l){var u=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=i,this.location=r,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new I,this.errorHandler=Ig,this.malformedUriErrorHandler=Ag,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Rg,afterPreactivation:Rg},this.urlHandlingStrategy=new Mg,this.routeReuseStrategy=new Tg,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=a.get(rt),this.console=a.get(hu);var c=a.get(Su);this.isNgZoneEnabled=c instanceof Su,this.resetConfig(l),this.currentUrlTree=new $m(new ev([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Pg(o,s,(function(e){return u.triggerEvent(new Mm(e))}),(function(e){return u.triggerEvent(new Im(e))})),this.routerState=Sv(this.currentUrlTree,this.rootComponentType),this.transitions=new wp({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(Rp((function(e){return 0!==e.id})),H((function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})})),nm((function(e){var i,r,a,o=!1,s=!1;return bp(e).pipe(dm((function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}})),nm((function(e){var i,r,a,o,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return bp(e).pipe(nm((function(e){var i=t.transitions.getValue();return n.next(new xm(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),i!==t.transitions.getValue()?Pp:[e]})),nm((function(e){return Promise.resolve(e)})),(i=t.ngModule.injector,r=t.configLoader,a=t.urlSerializer,o=t.config,function(e){return e.pipe(nm((function(e){return function(e,t,n,i,r){return new eg(e,t,n,i,r).apply()}(i,r,a,e.extractedUrl,o).pipe(H((function(t){return Object.assign(Object.assign({},e),{urlAfterRedirects:t})})))})))}),dm((function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})})),function(e,n,i,r,a){return function(i){return i.pipe(W((function(i){return function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new vg(e,t,n,i,r,a).recognize()}(e,n,i.urlAfterRedirects,(o=i.urlAfterRedirects,t.serializeUrl(o)),r,a).pipe(H((function(e){return Object.assign(Object.assign({},i),{targetSnapshot:e})})));var o})))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),dm((function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),dm((function(e){var i=new Cm(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(i)})));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var l=e.id,u=e.extractedUrl,c=e.source,h=e.restoredState,d=e.extras,f=new xm(l,t.serializeUrl(u),c,h);n.next(f);var p=Sv(u,t.rootComponentType).snapshot;return bp(Object.assign(Object.assign({},e),{targetSnapshot:p,urlAfterRedirects:u,extras:Object.assign(Object.assign({},d),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Pp})),Sg((function(e){var n=e.targetSnapshot,i=e.id,r=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,l=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:i,appliedUrlTree:r,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!l})})),dm((function(e){var n=new Sm(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),H((function(e){return Object.assign(Object.assign({},e),{guards:(n=e.targetSnapshot,i=e.currentSnapshot,r=t.rootContexts,a=n._root,function e(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=kv(n);return t.children.forEach((function(t){!function(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=t.value,s=n?n.value:null,l=i?i.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!nv(e.url,t.url);case"pathParamsOrQueryParamsChange":return!nv(e.url,t.url)||!Wm(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ov(e,t)||!Wm(e.queryParams,t.queryParams);case"paramsChange":default:return!Ov(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);u?a.canActivateChecks.push(new ag(r)):(o.data=s.data,o._resolvedData=s._resolvedData),e(t,n,o.component?l?l.children:null:i,r,a),u&&a.canDeactivateChecks.push(new og(l&&l.outlet&&l.outlet.component||null,s))}else s&&lg(n,l,a),a.canActivateChecks.push(new ag(r)),e(t,null,o.component?l?l.children:null:i,r,a)}(t,o[t.value.outlet],i,r.concat([t.value]),a),delete o[t.value.outlet]})),Ym(o,(function(e,t){return lg(e,i.getContext(t),a)})),a}(a,i?i._root:null,r,[a.value]))});var n,i,r,a})),function(e,t){return function(n){return n.pipe(W((function(n){var i=n.targetSnapshot,r=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?bp(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,i){return G(e).pipe(W((function(e){return function(e,t,n,i,r){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?bp(a.map((function(a){var o,s=sg(a,t,r);if(function(e){return e&&Zv(e.canDeactivate)}(s))o=Jm(s.canDeactivate(e,t,n,i));else{if(!Zv(s))throw new Error("Invalid CanDeactivate guard");o=Jm(s(e,t,n,i))}return o.pipe($p())}))).pipe(cg()):bp(!0)}(e.component,e.route,n,t,i)})),$p((function(e){return!0!==e}),!0))}(s,i,r,e).pipe(W((function(n){return n&&"boolean"==typeof n?function(e,t,n,i){return G(t).pipe(cm((function(t){return G([dg(t.route.parent,i),hg(t.route,i),pg(e,t.path,n),fg(e,t.route,n)]).pipe(Ap(),$p((function(e){return!0!==e}),!0))})),$p((function(e){return!0!==e}),!0))}(i,o,e,t):bp(n)})),H((function(e){return Object.assign(Object.assign({},n),{guardsResult:e})})))})))}}(t.ngModule.injector,(function(e){return t.triggerEvent(e)})),dm((function(e){if(Xv(e.guardsResult)){var n=Fm('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}})),dm((function(e){var n=new Tm(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)})),Rp((function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var i=new wm(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(i),e.resolve(!1),!1}return!0})),Sg((function(e){if(e.guards.canActivateChecks.length)return bp(e).pipe(dm((function(e){var n=new Em(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),(n=t.paramsInheritanceStrategy,i=t.ngModule.injector,function(e){return e.pipe(W((function(e){var t=e.targetSnapshot,r=e.guards.canActivateChecks;return r.length?G(r).pipe(cm((function(e){return function(e,t,n,i){return function(e,t,n,i){var r=Object.keys(e);if(0===r.length)return bp({});if(1===r.length){var a=r[0];return Cg(e[a],t,n,i).pipe(H((function(e){return _defineProperty({},a,e)})))}var o={};return G(r).pipe(W((function(r){return Cg(e[r],t,n,i).pipe(H((function(e){return o[r]=e,e})))}))).pipe(Wp(),H((function(){return o})))}(e._resolve,e,t,i).pipe(H((function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Ev(e,n).resolve),null})))}(e.route,t,n,i)})),function(e,t){return arguments.length>=2?function(n){return b(sm(e,t),zp(1),Up(t))(n)}:function(t){return b(sm((function(t,n,i){return e(t,n,i+1)})),zp(1))(t)}}((function(e,t){return e})),H((function(t){return e}))):bp(e)})))}),dm((function(e){var n=new Pm(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})));var n,i})),Sg((function(e){var n=e.targetSnapshot,i=e.id,r=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,l=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:i,appliedUrlTree:r,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!l})})),H((function(e){var n=function(e,t,n){var i=function e(t,n,i){if(i&&t.shouldReuseRoute(n.value,i.value.snapshot)){var r=i.value;r._futureSnapshot=n.value;var a=function(t,n,i){return n.children.map((function(n){var r,a=_createForOfIteratorHelper(i.children);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(t.shouldReuseRoute(o.value.snapshot,n.value))return e(t,n,o)}}catch(s){a.e(s)}finally{a.f()}return e(t,n)}))}(t,n,i);return new wv(r,a)}var o=t.retrieve(n.value);if(o){var s=o.route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var i=0;i<t.children.length;++i)e(t.children[i],n.children[i])}(n,s),s}var l,u=new Tv(new wp((l=n.value).url),new wp(l.params),new wp(l.queryParams),new wp(l.fragment),new wp(l.data),l.outlet,l.component,l),c=n.children.map((function(n){return e(t,n)}));return new wv(u,c)}(e,t._root,n?n._root:void 0);return new Cv(i,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})})),dm((function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),(i=t.rootContexts,r=t.routeReuseStrategy,a=function(e){return t.triggerEvent(e)},H((function(e){return new Gv(r,e.targetRouterState,e.currentRouterState,a).activate(i),e}))),dm({next:function(){o=!0},complete:function(){o=!0}}),mm((function(){if(!o&&!s){t.resetUrlToCurrentUrlTree();var i=new wm(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(i),e.resolve(!1)}t.currentNavigation=null})),Zp((function(i){if(s=!0,(l=i)&&l.ngNavigationCancelingError){var r=Xv(i.url);r||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var a=new wm(e.id,t.serializeUrl(e.extractedUrl),i.message);n.next(a),r?setTimeout((function(){var n=t.urlHandlingStrategy.merge(i.url,t.rawUrlTree);return t.scheduleNavigation(n,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})}),0):e.resolve(!1)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var o=new km(e.id,t.serializeUrl(e.extractedUrl),i);n.next(o);try{e.resolve(t.errorHandler(i))}catch(u){e.reject(u)}}var l;return Pp})))})))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(t){var n=e.parseUrl(t.url),i="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout((function(){e.scheduleNavigation(n,i,r,{replaceUrl:!0})}),0)})))}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){Vm(e),this.config=e.map(Gm),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,i=t.queryParams,r=t.fragment,a=t.preserveQueryParams,o=t.queryParamsHandling,s=t.preserveFragment;Ei()&&a&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var l=n||this.routerState.root,u=s?this.currentUrlTree.fragment:r,c=null;if(o)switch(o){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),i);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=i||null}else c=a?this.currentUrlTree.queryParams:i||null;return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,i,r){if(0===n.length)return Dv(t.root,t.root,t,i,r);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new zv(!0,0,e);var t=0,n=!1,i=e.reduce((function(e,i,r){if("object"==typeof i&&null!=i){if(i.outlets){var a={};return Ym(i.outlets,(function(e,t){a[t]="string"==typeof e?e.split("/"):e})),[].concat(_toConsumableArray(e),[{outlets:a}])}if(i.segmentPath)return[].concat(_toConsumableArray(e),[i.segmentPath])}return"string"!=typeof i?[].concat(_toConsumableArray(e),[i]):0===r?(i.split("/").forEach((function(i,r){0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?t++:""!=i&&e.push(i))})),e):[].concat(_toConsumableArray(e),[i])}),[]);return new zv(n,t,i)}(n);if(a.toRoot())return Dv(t.root,new ev([],{}),t,i,r);var o=function(e,t,n){if(e.isAbsolute)return new Lv(t.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new Lv(n.snapshot._urlSegment,!0,0);var i=Nv(e.commands[0])?0:1;return function(e,t,n){for(var i=e,r=t,a=n;a>r;){if(a-=r,!(i=i.parent))throw new Error("Invalid number of '../'");r=i.segments.length}return new Lv(i,!1,r-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?jv(o.segmentGroup,o.index,a.commands):Fv(o.segmentGroup,o.index,a.commands);return Dv(o.segmentGroup,s,t,i,r)}(l,this.currentUrlTree,e,c,u)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};Ei()&&this.isNgZoneEnabled&&!Su.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=Xv(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(Xv(e))return Qm(this.currentUrlTree,e,t);var n=this.parseUrl(e);return Qm(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce((function(t,n){var i=e[n];return null!=i&&(t[n]=i),t}),{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe((function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new bm(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)}),(function(t){e.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(e,t,n,i,r){var a,o,s,l=this.getTransition();if(l&&"imperative"!==t&&"imperative"===l.source&&l.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(l&&"hashchange"==t&&"popstate"===l.source&&l.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(l&&"popstate"==t&&"hashchange"===l.source&&l.rawUrl.toString()===e.toString())return Promise.resolve(!0);r?(a=r.resolve,o=r.reject,s=r.promise):s=new Promise((function(e,t){a=e,o=t}));var u=++this.navigationId;return this.setTransition({id:u,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:a,reject:o,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(e){return Promise.reject(e)}))}},{key:"setBrowserUrl",value:function(e,t,n,i){var r=this.urlSerializer.serialize(e);i=i||{},this.location.isCurrentPathEqualTo(r)||t?this.location.replaceState(r,"",Object.assign(Object.assign({},i),{navigationId:n})):this.location.go(r,"",Object.assign(Object.assign({},i),{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}]),e}()).\u0275fac=function(e){Po()},Dg.\u0275dir=Ct({type:Dg}),Dg),Lg=((Ng=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.router=t,this.route=n,this.commands=[],null==i&&r.setAttribute(a.nativeElement,"tabindex","0")}return _createClass(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){Ei()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated!, use queryParamsHandling instead."),this.preserve=e}},{key:"onClick",value:function(){var e={skipLocationChange:Fg(this.skipLocationChange),replaceUrl:Fg(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Fg(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Fg(this.preserveFragment)})}}]),e}()).\u0275fac=function(e){return new(e||Ng)(To(zg),To(Tv),Eo("tabindex"),To(Ws),To(Vs))},Ng.\u0275dir=Ct({type:Ng,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Fo("click",(function(){return t.onClick()}))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"}}),Ng),Bg=((Og=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.router=t,this.route=n,this.locationStrategy=i,this.commands=[],this.subscription=t.events.subscribe((function(e){e instanceof bm&&r.updateTargetUrlAndHref()}))}return _createClass(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){Ei()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,i){if(0!==e||t||n||i)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var r={skipLocationChange:Fg(this.skipLocationChange),replaceUrl:Fg(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,r),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Fg(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Fg(this.preserveFragment)})}}]),e}()).\u0275fac=function(e){return new(e||Og)(To(zg),To(Tv),To(vc))},Og.\u0275dir=Ct({type:Og,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Fo("click",(function(e){return t.onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)})),2&e&&(ys("href",t.href,Qi),wo("target",t.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[Es]}),Og);function Fg(e){return""===e||!!e}var jg,Hg,Vg,Ug,qg=((jg=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this.router=t,this.element=n,this.renderer=i,this.link=r,this.linkWithHref=a,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.subscription=t.events.subscribe((function(e){e instanceof bm&&o.update()}))}return _createClass(e,[{key:"ngAfterContentInit",value:function(){var e=this;this.links.changes.subscribe((function(t){return e.update()})),this.linksWithHrefs.changes.subscribe((function(t){return e.update()})),this.update()}},{key:"routerLinkActive",set:function(e){var t=Array.isArray(e)?e:e.split(" ");this.classes=t.filter((function(e){return!!e}))}},{key:"ngOnChanges",value:function(e){this.update()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"update",value:function(){var e=this;this.links&&this.linksWithHrefs&&this.router.navigated&&Promise.resolve().then((function(){var t=e.hasActiveLinks();e.isActive!==t&&(e.isActive=t,e.classes.forEach((function(n){t?e.renderer.addClass(e.element.nativeElement,n):e.renderer.removeClass(e.element.nativeElement,n)})))}))}},{key:"isLinkActive",value:function(e){var t=this;return function(n){return e.isActive(n.urlTree,t.routerLinkActiveOptions.exact)}}},{key:"hasActiveLinks",value:function(){var e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}]),e}()).\u0275fac=function(e){return new(e||jg)(To(zg),To(Vs),To(Ws),To(Lg,8),To(Bg,8))},jg.\u0275dir=Ct({type:jg,selectors:[["","routerLinkActive",""]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,Lg,!0),Yl(n,Bg,!0)),2&e&&(Wl(i=$l())&&(t.links=i),Wl(i=$l())&&(t.linksWithHrefs=i))},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[Es]}),jg),Gg=_createClass((function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new Wg,this.attachRef=null})),Wg=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new Gg,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),Zg=((Hg=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.parentContexts=t,this.location=n,this.resolver=i,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new Dl,this.deactivateEvents=new Dl,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),i=this.parentContexts.getOrCreateContext(this.name).children,r=new Xg(e,i,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}()).\u0275fac=function(e){return new(e||Hg)(To(Wg),To(pl),To(Hs),Eo("name"),To(Ga))},Hg.\u0275dir=Ct({type:Hg,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),Hg),Xg=function(){function e(t,n,i){_classCallCheck(this,e),this.route=t,this.childContexts=n,this.parent=i}return _createClass(e,[{key:"get",value:function(e,t){return e===Tv?this.route:e===Wg?this.childContexts:this.parent.get(e,t)}}]),e}(),Kg=_createClass((function e(){_classCallCheck(this,e)})),Yg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return bp(null)}}]),e}(),Jg=((Ug=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this.router=t,this.injector=r,this.preloadingStrategy=a,this.loader=new Pg(n,i,(function(e){return t.triggerEvent(new Mm(e))}),(function(e){return t.triggerEvent(new Im(e))}))}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Rp((function(e){return e instanceof bm})),cm((function(){return e.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var e=this.injector.get(rt);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,i=[],r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;i.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?i.push(this.preloadConfig(e,a)):a.children&&i.push(this.processRoutes(e,a.children))}}catch(s){r.e(s)}finally{r.f()}return G(i).pipe(K(),H((function(e){})))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,(function(){return n.loader.load(e.injector,t).pipe(W((function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)})))}))}}]),e}()).\u0275fac=function(e){return new(e||Ug)($e(zg),$e(Zu),$e(bu),$e(so),$e(Kg))},Ug.\u0275prov=me({token:Ug,factory:Ug.\u0275fac}),Ug),Qg=((Vg=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=n,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof xm?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof bm&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof Dm&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new Dm(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){Po()},Vg.\u0275dir=Ct({type:Vg}),Vg),$g=new qe("ROUTER_CONFIGURATION"),ey=new qe("ROUTER_FORROOT_GUARD"),ty=[Cc,{provide:rv,useClass:av},{provide:zg,useFactory:function(e,t,n,i,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,c=new zg(null,e,t,n,i,r,a,Xm(o));if(l&&(c.urlHandlingStrategy=l),u&&(c.routeReuseStrategy=u),s.errorHandler&&(c.errorHandler=s.errorHandler),s.malformedUriErrorHandler&&(c.malformedUriErrorHandler=s.malformedUriErrorHandler),s.enableTracing){var h=nc();c.events.subscribe((function(e){h.logGroup("Router Event: "+e.constructor.name),h.log(e.toString()),h.log(e),h.logGroupEnd()}))}return s.onSameUrlNavigation&&(c.onSameUrlNavigation=s.onSameUrlNavigation),s.paramsInheritanceStrategy&&(c.paramsInheritanceStrategy=s.paramsInheritanceStrategy),s.urlUpdateStrategy&&(c.urlUpdateStrategy=s.urlUpdateStrategy),s.relativeLinkResolution&&(c.relativeLinkResolution=s.relativeLinkResolution),c},deps:[rv,Wg,Cc,so,Zu,bu,Eg,$g,[function(){return _createClass((function e(){_classCallCheck(this,e)}))}(),new ue],[function(){return _createClass((function e(){_classCallCheck(this,e)}))}(),new ue]]},Wg,{provide:Tv,useFactory:function(e){return e.routerState.root},deps:[zg]},{provide:Zu,useClass:Yu},Jg,Yg,function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe(Zp((function(){return bp(null)})))}}]),e}(),{provide:$g,useValue:{enableTracing:!1}}];function ny(){return new Fu("Router",zg)}var iy,ry=((iy=function(){function e(t,n){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[ty,ly(t),{provide:ey,useFactory:sy,deps:[[zg,new ue,new he]]},{provide:$g,useValue:n||{}},{provide:vc,useFactory:oy,deps:[ac,[new le(bc),new ue],$g]},{provide:Qg,useFactory:ay,deps:[zg,lh,$g]},{provide:Kg,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Yg},{provide:Fu,multi:!0,useFactory:ny},[cy,{provide:iu,multi:!0,useFactory:hy,deps:[cy]},{provide:py,useFactory:dy,deps:[cy]},{provide:cu,multi:!0,useExisting:py}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[ly(t)]}}}]),e}()).\u0275mod=wt({type:iy}),iy.\u0275inj=ve({factory:function(e){return new(e||iy)($e(ey,8),$e(zg,8))}}),iy);function ay(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new Qg(e,t,n)}function oy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new kc(e,t):new wc(e,t)}function sy(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function ly(e){return[{provide:lo,multi:!0,useValue:e},{provide:Eg,multi:!0,useValue:e}]}var uy,cy=((uy=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new I}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(lc,Promise.resolve(null)).then((function(){var t=null,n=new Promise((function(e){return t=e})),i=e.injector.get(zg),r=e.injector.get($g);if(e.isLegacyDisabled(r)||e.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)i.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(r.initialNavigation,"'"));i.hooks.afterPreactivation=function(){return e.initNavigation?bp(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},i.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(e){var t=this.injector.get($g),n=this.injector.get(Jg),i=this.injector.get(Qg),r=this.injector.get(zg),a=this.injector.get(Gu);e===a.components[0]&&(this.isLegacyEnabled(t)?r.initialNavigation():this.isLegacyDisabled(t)&&r.setUpLocationChangeListener(),n.setUpPreloading(),i.init(),r.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}()).\u0275fac=function(e){return new(e||uy)($e(so))},uy.\u0275prov=me({token:uy,factory:uy.\u0275fac}),uy);function hy(e){return e.appInitializer.bind(e)}function dy(e){return e.bootstrapListener.bind(e)}var fy,py=new qe("Router Initializer");try{fy="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(V5){fy=!1}var my,vy,gy,yy,_y,xy,by=((gy=_createClass((function e(t){_classCallCheck(this,e),this._platformId=t,this.isBrowser=this._platformId?"browser"===this._platformId:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!fy)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}))).\u0275fac=function(e){return new(e||gy)($e(uu,8))},gy.\u0275prov=me({factory:function(){return new gy($e(uu,8))},token:gy,providedIn:"root"}),gy),wy=((vy=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:vy}),vy.\u0275inj=ve({factory:function(e){return new(e||vy)}}),vy),ky=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Cy(){if(my)return my;if("object"!=typeof document||!document)return my=new Set(ky);var e=document.createElement("input");return my=new Set(ky.filter((function(t){return e.setAttribute("type",t),e.type===t})))}function Sy(e){return function(){if(null==yy&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return yy=!0}}))}finally{yy=yy||!1}return yy}()?e:!!e.capture}function Ty(){if("object"!=typeof document||!document)return 0;if(null==_y){var e=document.createElement("div"),t=e.style;e.dir="rtl",t.height="1px",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";var n=document.createElement("div"),i=n.style;i.width="2px",i.height="1px",e.appendChild(n),document.body.appendChild(e),_y=0,0===e.scrollLeft&&(e.scrollLeft=1,_y=0===e.scrollLeft?1:2),e.parentNode.removeChild(e)}return _y}function Ey(e){if(function(){if(null==xy){var e="undefined"!=typeof document?document.head:null;xy=!(!e||!e.createShadowRoot&&!e.attachShadow)}return xy}()){var t=e.getRootNode?e.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Py(e){return null!=e&&""+e!="false"}function My(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function Iy(e){return Array.isArray(e)?e:[e]}function Ay(e){return null==e?"":"string"==typeof e?e:e+"px"}function Ry(e){return e instanceof Vs?e.nativeElement:e}function Oy(e,t,n,i){return a(n)&&(i=n,n=void 0),i?Oy(e,t,n).pipe(H((function(e){return c(e)?i.apply(void 0,_toConsumableArray(e)):i(e)}))):new C((function(i){!function e(t,n,i,r,a){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){var s=t;t.addEventListener(n,i,a),o=function(){return s.removeEventListener(n,i,a)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){var l=t;t.on(n,i),o=function(){return l.off(n,i)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){var u=t;t.addListener(n,i),o=function(){return u.removeListener(n,i)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var c=0,h=t.length;c<h;c++)e(t[c],n,i,r,a)}r.add(o)}(e,t,(function(e){i.next(arguments.length>1?Array.prototype.slice.call(arguments):e)}),i,n)}))}var Ny=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).scheduler=e,i.work=n,i.pending=!1,i}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,i=void 0;try{this.work(e)}catch(r){n=!0,i=!!r&&r||new Error(r)}if(n)return this.unsubscribe(),i}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),t}(function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t)}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),t}(p)),Dy=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).scheduler=e,i.work=n,i}return _inherits(t,e),_createClass(t,[{key:"requestAsyncId",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==i&&i>0?_get(_getPrototypeOf2(t.prototype),"requestAsyncId",this).call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))}},{key:"recycleAsyncId",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==i&&i>0||null===i&&this.delay>0)return _get(_getPrototypeOf2(t.prototype),"recycleAsyncId",this).call(this,e,n,i);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)}}]),t}(Ny),zy=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Ly=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zy.now;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,function(){return t.delegate&&t.delegate!==_assertThisInitialized2(n)?t.delegate.now():i()}])).actions=[],n.active=!1,n.scheduled=void 0,n}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;return t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,i):_get(_getPrototypeOf2(t.prototype),"schedule",this).call(this,e,n,i)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),t}(zy),By=new(function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,i=-1,r=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<r&&(e=n.shift()));if(this.active=!1,t){for(;++i<r&&(e=n.shift());)e.unsubscribe();throw t}}}]),t}(Ly))(Dy);function Fy(e,t){return function(n){return n.lift(new jy(e,t))}}var jy=function(){function e(t,n){_classCallCheck(this,e),this.compare=t,this.keySelector=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Hy(e,this.compare,this.keySelector))}}]),e}(),Hy=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).keySelector=i,r.hasKey=!1,"function"==typeof n&&(r.compare=n),r}return _inherits(t,e),_createClass(t,[{key:"compare",value:function(e,t){return e===t}},{key:"_next",value:function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(r){return this.destination.error(r)}var i=!1;if(this.hasKey)try{i=(0,this.compare)(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}]),t}(g),Vy=new Ly(Ny),Uy=function(){function e(t){_classCallCheck(this,e),this.durationSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new qy(e,this.durationSelector))}}]),e}(),qy=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).durationSelector=n,i.hasValue=!1,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t;try{t=(0,this.durationSelector)(e)}catch(i){return this.destination.error(i)}var n=F(this,t);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}},{key:"clearThrottle",value:function(){var e=this.value,t=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),t&&(this.value=null,this.hasValue=!1,this.destination.next(e))}},{key:"notifyNext",value:function(e,t,n,i){this.clearThrottle()}},{key:"notifyComplete",value:function(){this.clearThrottle()}}]),t}(j);function Gy(e){return!c(e)&&e-parseFloat(e)+1>=0}function Wy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=-1;return Gy(t)?i=Number(t)<1?1:Number(t):R(t)&&(n=t),R(n)||(n=Vy),new C((function(t){var r=Gy(e)?e:+e-n.now();return n.schedule(Zy,r,{index:0,period:i,subscriber:t})}))}function Zy(e){var t=e.index,n=e.period,i=e.subscriber;if(i.next(t),!i.closed){if(-1===n)return i.complete();e.index=t+1,this.schedule(e,n)}}function Xy(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vy;return t=function(){return Wy(e,n)},function(e){return e.lift(new Uy(t))}}function Ky(e){return function(t){return t.lift(new r_(e))}}var Yy,Jy,Qy,$y,e_,t_,n_,i_,r_=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){var n=new a_(e),i=F(n,this.notifier);return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n}}]),e}(),a_=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).seenValue=!1,n}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,i,r){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),t}(j),o_=new qe("cdk-dir-doc",{providedIn:"root",factory:function(){return et(rc)}}),s_=((Jy=function(){function e(t){if(_classCallCheck(this,e),this.value="ltr",this.change=new Dl,t){var n=t.documentElement?t.documentElement.dir:null,i=(t.body?t.body.dir:null)||n;this.value="ltr"===i||"rtl"===i?i:"ltr"}}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.change.complete()}}]),e}()).\u0275fac=function(e){return new(e||Jy)($e(o_,8))},Jy.\u0275prov=me({factory:function(){return new Jy($e(o_,8))},token:Jy,providedIn:"root"}),Jy),l_=((Yy=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Yy}),Yy.\u0275inj=ve({factory:function(e){return new(e||Yy)}}),Yy),u_=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,e),this._multiple=n,this._emitChanges=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new I,i&&i.length&&(n?i.forEach((function(e){return t._markSelected(e)})):this._markSelected(i[0]),this._selectedToEmit.length=0)}return _createClass(e,[{key:"selected",get:function(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}},{key:"select",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this._verifyValueAssignment(n),n.forEach((function(t){return e._markSelected(t)})),this._emitChangeEvent()}},{key:"deselect",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this._verifyValueAssignment(n),n.forEach((function(t){return e._unmarkSelected(t)})),this._emitChangeEvent()}},{key:"toggle",value:function(e){this.isSelected(e)?this.deselect(e):this.select(e)}},{key:"clear",value:function(){this._unmarkAll(),this._emitChangeEvent()}},{key:"isSelected",value:function(e){return this._selection.has(e)}},{key:"isEmpty",value:function(){return 0===this._selection.size}},{key:"hasValue",value:function(){return!this.isEmpty()}},{key:"sort",value:function(e){this._multiple&&this.selected&&this._selected.sort(e)}},{key:"isMultipleSelection",value:function(){return this._multiple}},{key:"_emitChangeEvent",value:function(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}},{key:"_markSelected",value:function(e){this.isSelected(e)||(this._multiple||this._unmarkAll(),this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}},{key:"_unmarkSelected",value:function(e){this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}},{key:"_unmarkAll",value:function(){var e=this;this.isEmpty()||this._selection.forEach((function(t){return e._unmarkSelected(t)}))}},{key:"_verifyValueAssignment",value:function(e){if(e.length>1&&!this._multiple)throw Error("Cannot pass multiple values into SelectionModel with single-value mode.")}}]),e}(),c_=((i_=function(){function e(){_classCallCheck(this,e),this._listeners=[]}return _createClass(e,[{key:"notify",value:function(e,t){var n,i=_createForOfIteratorHelper(this._listeners);try{for(i.s();!(n=i.n()).done;)(0,n.value)(e,t)}catch(r){i.e(r)}finally{i.f()}}},{key:"listen",value:function(e){var t=this;return this._listeners.push(e),function(){t._listeners=t._listeners.filter((function(t){return e!==t}))}}},{key:"ngOnDestroy",value:function(){this._listeners=[]}}]),e}()).\u0275fac=function(e){return new(e||i_)},i_.\u0275prov=me({factory:function(){return new i_},token:i_,providedIn:"root"}),i_),h_=((n_=function(){function e(t,n,i){_classCallCheck(this,e),this._ngZone=t,this._platform=n,this._scrolled=new I,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}return _createClass(e,[{key:"register",value:function(e){var t=this;this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe((function(){return t._scrolled.next(e)})))}},{key:"deregister",value:function(e){var t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}},{key:"scrolled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._platform.isBrowser?new C((function(n){e._globalSubscription||e._addGlobalListener();var i=t>0?e._scrolled.pipe(Xy(t)).subscribe(n):e._scrolled.subscribe(n);return e._scrolledCount++,function(){i.unsubscribe(),e._scrolledCount--,e._scrolledCount||e._removeGlobalListener()}})):bp()}},{key:"ngOnDestroy",value:function(){var e=this;this._removeGlobalListener(),this.scrollContainers.forEach((function(t,n){return e.deregister(n)})),this._scrolled.complete()}},{key:"ancestorScrolled",value:function(e,t){var n=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(Rp((function(e){return!e||n.indexOf(e)>-1})))}},{key:"getAncestorScrollContainers",value:function(e){var t=this,n=[];return this.scrollContainers.forEach((function(i,r){t._scrollableContainsElement(r,e)&&n.push(r)})),n}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_scrollableContainsElement",value:function(e,t){var n=t.nativeElement,i=e.getElementRef().nativeElement;do{if(n==i)return!0}while(n=n.parentElement);return!1}},{key:"_addGlobalListener",value:function(){var e=this;this._globalSubscription=this._ngZone.runOutsideAngular((function(){return Oy(e._getWindow().document,"scroll").subscribe((function(){return e._scrolled.next()}))}))}},{key:"_removeGlobalListener",value:function(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}]),e}()).\u0275fac=function(e){return new(e||n_)($e(Su),$e(by),$e(rc,8))},n_.\u0275prov=me({factory:function(){return new n_($e(Su),$e(by),$e(rc,8))},token:n_,providedIn:"root"}),n_),d_=((t_=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.elementRef=t,this.scrollDispatcher=n,this.ngZone=i,this.dir=r,this._destroyed=new I,this._elementScrolled=new C((function(e){return a.ngZone.runOutsideAngular((function(){return Oy(a.elementRef.nativeElement,"scroll").pipe(Ky(a._destroyed)).subscribe(e)}))}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.scrollDispatcher.register(this)}},{key:"ngOnDestroy",value:function(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}},{key:"elementScrolled",value:function(){return this._elementScrolled}},{key:"getElementRef",value:function(){return this.elementRef}},{key:"scrollTo",value:function(e){var t=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=n?e.end:e.start),null==e.right&&(e.right=n?e.start:e.end),null!=e.bottom&&(e.top=t.scrollHeight-t.clientHeight-e.bottom),n&&0!=Ty()?(null!=e.left&&(e.right=t.scrollWidth-t.clientWidth-e.left),2==Ty()?e.left=e.right:1==Ty()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=t.scrollWidth-t.clientWidth-e.right),this._applyScrollToOptions(e)}},{key:"_applyScrollToOptions",value:function(e){var t=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?t.scrollTo(e):(null!=e.top&&(t.scrollTop=e.top),null!=e.left&&(t.scrollLeft=e.left))}},{key:"measureScrollOffset",value:function(e){var t=this.elementRef.nativeElement;if("top"==e)return t.scrollTop;if("bottom"==e)return t.scrollHeight-t.clientHeight-t.scrollTop;var n=this.dir&&"rtl"==this.dir.value;return"start"==e?e=n?"right":"left":"end"==e&&(e=n?"left":"right"),n&&2==Ty()?"left"==e?t.scrollWidth-t.clientWidth-t.scrollLeft:t.scrollLeft:n&&1==Ty()?"left"==e?t.scrollLeft+t.scrollWidth-t.clientWidth:-t.scrollLeft:"left"==e?t.scrollLeft:t.scrollWidth-t.clientWidth-t.scrollLeft}}]),e}()).\u0275fac=function(e){return new(e||t_)(To(Vs),To(h_),To(Su),To(s_,8))},t_.\u0275dir=Ct({type:t_,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t_),f_=((e_=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this._platform=t,this._document=i,n.runOutsideAngular((function(){var e=r._getWindow();r._change=t.isBrowser?J(Oy(e,"resize"),Oy(e,"orientationchange")):bp(),r._invalidateCache=r.change().subscribe((function(){return r._updateViewportSize()}))}))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._invalidateCache.unsubscribe()}},{key:"getViewportSize",value:function(){this._viewportSize||this._updateViewportSize();var e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}},{key:"getViewportRect",value:function(){var e=this.getViewportScrollPosition(),t=this.getViewportSize(),n=t.width,i=t.height;return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+n,height:i,width:n}}},{key:"getViewportScrollPosition",value:function(){if(!this._platform.isBrowser)return{top:0,left:0};var e=this._getDocument(),t=this._getWindow(),n=e.documentElement,i=n.getBoundingClientRect();return{top:-i.top||e.body.scrollTop||t.scrollY||n.scrollTop||0,left:-i.left||e.body.scrollLeft||t.scrollX||n.scrollLeft||0}}},{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return e>0?this._change.pipe(Xy(e)):this._change}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_updateViewportSize",value:function(){var e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}]),e}()).\u0275fac=function(e){return new(e||e_)($e(by),$e(Su),$e(rc,8))},e_.\u0275prov=me({factory:function(){return new e_($e(by),$e(Su),$e(rc,8))},token:e_,providedIn:"root"}),e_),p_=(($y=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:$y}),$y.\u0275inj=ve({factory:function(e){return new(e||$y)}}),$y),m_=((Qy=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Qy}),Qy.\u0275inj=ve({factory:function(e){return new(e||Qy)},imports:[[l_,wy,p_],l_,p_]}),Qy);function v_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.length?n.some((function(t){return e[t]})):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function g_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vy;return function(n){return n.lift(new y_(e,t))}}var y_=function(){function e(t,n){_classCallCheck(this,e),this.dueTime=t,this.scheduler=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new __(e,this.dueTime,this.scheduler))}}]),e}(),__=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).dueTime=n,r.scheduler=i,r.debouncedSubscription=null,r.lastValue=null,r.hasValue=!1,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(x_,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}},{key:"clearDebounce",value:function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}]),t}(g);function x_(e){e.debouncedNext()}var b_,w_,k_,C_,S_=((C_=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}]),e}()).\u0275fac=function(e){return new(e||C_)},C_.\u0275prov=me({factory:function(){return new C_},token:C_,providedIn:"root"}),C_),T_=((k_=function(){function e(t){_classCallCheck(this,e),this._mutationObserverFactory=t,this._observedElements=new Map}return _createClass(e,[{key:"ngOnDestroy",value:function(){var e=this;this._observedElements.forEach((function(t,n){return e._cleanupObserver(n)}))}},{key:"observe",value:function(e){var t=this,n=Ry(e);return new C((function(e){var i=t._observeElement(n).subscribe(e);return function(){i.unsubscribe(),t._unobserveElement(n)}}))}},{key:"_observeElement",value:function(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{var t=new I,n=this._mutationObserverFactory.create((function(e){return t.next(e)}));n&&n.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:n,stream:t,count:1})}return this._observedElements.get(e).stream}},{key:"_unobserveElement",value:function(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}},{key:"_cleanupObserver",value:function(e){if(this._observedElements.has(e)){var t=this._observedElements.get(e),n=t.observer,i=t.stream;n&&n.disconnect(),i.complete(),this._observedElements.delete(e)}}}]),e}()).\u0275fac=function(e){return new(e||k_)($e(S_))},k_.\u0275prov=me({factory:function(){return new k_($e(S_))},token:k_,providedIn:"root"}),k_),E_=((w_=function(){function e(t,n,i){_classCallCheck(this,e),this._contentObserver=t,this._elementRef=n,this._ngZone=i,this.event=new Dl,this._disabled=!1,this._currentSubscription=null}return _createClass(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e),this._disabled?this._unsubscribe():this._subscribe()}},{key:"debounce",get:function(){return this._debounce},set:function(e){this._debounce=My(e),this._subscribe()}},{key:"ngAfterContentInit",value:function(){this._currentSubscription||this.disabled||this._subscribe()}},{key:"ngOnDestroy",value:function(){this._unsubscribe()}},{key:"_subscribe",value:function(){var e=this;this._unsubscribe();var t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular((function(){e._currentSubscription=(e.debounce?t.pipe(g_(e.debounce)):t).subscribe(e.event)}))}},{key:"_unsubscribe",value:function(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||w_)(To(T_),To(Vs),To(Su))},w_.\u0275dir=Ct({type:w_,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),w_),P_=((b_=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:b_}),b_.\u0275inj=ve({factory:function(e){return new(e||b_)},providers:[S_]}),b_);function M_(e,t){return(e.getAttribute(t)||"").match(/\S+/g)||[]}var I_,A_,R_=0,O_=new Map,N_=null,D_=((I_=function(){function e(t){_classCallCheck(this,e),this._document=t}return _createClass(e,[{key:"describe",value:function(e,t){this._canBeDescribed(e,t)&&("string"!=typeof t?(this._setMessageId(t),O_.set(t,{messageElement:t,referenceCount:0})):O_.has(t)||this._createMessageElement(t),this._isElementDescribedByMessage(e,t)||this._addMessageReference(e,t))}},{key:"removeDescription",value:function(e,t){if(this._isElementNode(e)){if(this._isElementDescribedByMessage(e,t)&&this._removeMessageReference(e,t),"string"==typeof t){var n=O_.get(t);n&&0===n.referenceCount&&this._deleteMessageElement(t)}N_&&0===N_.childNodes.length&&this._deleteMessagesContainer()}}},{key:"ngOnDestroy",value:function(){for(var e=this._document.querySelectorAll("[cdk-describedby-host]"),t=0;t<e.length;t++)this._removeCdkDescribedByReferenceIds(e[t]),e[t].removeAttribute("cdk-describedby-host");N_&&this._deleteMessagesContainer(),O_.clear()}},{key:"_createMessageElement",value:function(e){var t=this._document.createElement("div");this._setMessageId(t),t.textContent=e,this._createMessagesContainer(),N_.appendChild(t),O_.set(e,{messageElement:t,referenceCount:0})}},{key:"_setMessageId",value:function(e){e.id||(e.id="cdk-describedby-message-"+R_++)}},{key:"_deleteMessageElement",value:function(e){var t=O_.get(e),n=t&&t.messageElement;N_&&n&&N_.removeChild(n),O_.delete(e)}},{key:"_createMessagesContainer",value:function(){if(!N_){var e=this._document.getElementById("cdk-describedby-message-container");e&&e.parentNode.removeChild(e),(N_=this._document.createElement("div")).id="cdk-describedby-message-container",N_.setAttribute("aria-hidden","true"),N_.style.display="none",this._document.body.appendChild(N_)}}},{key:"_deleteMessagesContainer",value:function(){N_&&N_.parentNode&&(N_.parentNode.removeChild(N_),N_=null)}},{key:"_removeCdkDescribedByReferenceIds",value:function(e){var t=M_(e,"aria-describedby").filter((function(e){return 0!=e.indexOf("cdk-describedby-message")}));e.setAttribute("aria-describedby",t.join(" "))}},{key:"_addMessageReference",value:function(e,t){var n,i,r,a,o=O_.get(t);n=e,i="aria-describedby",r=o.messageElement.id,(a=M_(n,i)).some((function(e){return e.trim()==r.trim()}))||(a.push(r.trim()),n.setAttribute(i,a.join(" "))),e.setAttribute("cdk-describedby-host",""),o.referenceCount++}},{key:"_removeMessageReference",value:function(e,t){var n,i,r,a,o=O_.get(t);o.referenceCount--,n=e,i="aria-describedby",r=o.messageElement.id,(a=M_(n,i).filter((function(e){return e!=r.trim()}))).length?n.setAttribute(i,a.join(" ")):n.removeAttribute(i),e.removeAttribute("cdk-describedby-host")}},{key:"_isElementDescribedByMessage",value:function(e,t){var n=M_(e,"aria-describedby"),i=O_.get(t),r=i&&i.messageElement.id;return!!r&&-1!=n.indexOf(r)}},{key:"_canBeDescribed",value:function(e,t){if(!this._isElementNode(e))return!1;if(t&&"object"==typeof t)return!0;var n=null==t?"":(""+t).trim(),i=e.getAttribute("aria-label");return!(!n||i&&i.trim()===n)}},{key:"_isElementNode",value:function(e){return e.nodeType===this._document.ELEMENT_NODE}}]),e}()).\u0275fac=function(e){return new(e||I_)($e(rc))},I_.\u0275prov=me({factory:function(){return new I_($e(rc))},token:I_,providedIn:"root"}),I_),z_=function(){function e(t){var n=this;_classCallCheck(this,e),this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new I,this._typeaheadSubscription=p.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._skipPredicateFn=function(e){return e.disabled},this._pressedLetters=[],this.tabOut=new I,this.change=new I,t instanceof Ll&&t.changes.subscribe((function(e){if(n._activeItem){var t=e.toArray().indexOf(n._activeItem);t>-1&&t!==n._activeItemIndex&&(n._activeItemIndex=t)}}))}return _createClass(e,[{key:"skipPredicate",value:function(e){return this._skipPredicateFn=e,this}},{key:"withWrap",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._wrap=e,this}},{key:"withVerticalOrientation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._vertical=e,this}},{key:"withHorizontalOrientation",value:function(e){return this._horizontal=e,this}},{key:"withAllowedModifierKeys",value:function(e){return this._allowedModifierKeys=e,this}},{key:"withTypeAhead",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;if(this._items.length&&this._items.some((function(e){return"function"!=typeof e.getLabel})))throw Error("ListKeyManager items in typeahead mode must implement the `getLabel` method.");return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(dm((function(t){return e._pressedLetters.push(t)})),g_(t),Rp((function(){return e._pressedLetters.length>0})),H((function(){return e._pressedLetters.join("")}))).subscribe((function(t){for(var n=e._getItemsArray(),i=1;i<n.length+1;i++){var r=(e._activeItemIndex+i)%n.length,a=n[r];if(!e._skipPredicateFn(a)&&0===a.getLabel().toUpperCase().trim().indexOf(t)){e.setActiveItem(r);break}}e._pressedLetters=[]})),this}},{key:"setActiveItem",value:function(e){var t=this._activeItemIndex;this.updateActiveItem(e),this._activeItemIndex!==t&&this.change.next(this._activeItemIndex)}},{key:"onKeydown",value:function(e){var t=this,n=e.keyCode,i=["altKey","ctrlKey","metaKey","shiftKey"].every((function(n){return!e[n]||t._allowedModifierKeys.indexOf(n)>-1}));switch(n){case 9:return void this.tabOut.next();case 40:if(this._vertical&&i){this.setNextItemActive();break}return;case 38:if(this._vertical&&i){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&i){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&i){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;default:return void((i||v_(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(n>=65&&n<=90||n>=48&&n<=57)&&this._letterKeyStream.next(String.fromCharCode(n))))}this._pressedLetters=[],e.preventDefault()}},{key:"activeItemIndex",get:function(){return this._activeItemIndex}},{key:"activeItem",get:function(){return this._activeItem}},{key:"isTyping",value:function(){return this._pressedLetters.length>0}},{key:"setFirstItemActive",value:function(){this._setActiveItemByIndex(0,1)}},{key:"setLastItemActive",value:function(){this._setActiveItemByIndex(this._items.length-1,-1)}},{key:"setNextItemActive",value:function(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}},{key:"setPreviousItemActive",value:function(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}},{key:"updateActiveItem",value:function(e){var t=this._getItemsArray(),n="number"==typeof e?e:t.indexOf(e),i=t[n];this._activeItem=null==i?null:i,this._activeItemIndex=n}},{key:"_setActiveItemByDelta",value:function(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}},{key:"_setActiveInWrapMode",value:function(e){for(var t=this._getItemsArray(),n=1;n<=t.length;n++){var i=(this._activeItemIndex+e*n+t.length)%t.length;if(!this._skipPredicateFn(t[i]))return void this.setActiveItem(i)}}},{key:"_setActiveInDefaultMode",value:function(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}},{key:"_setActiveItemByIndex",value:function(e,t){var n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=t])return;this.setActiveItem(e)}}},{key:"_getItemsArray",value:function(){return this._items instanceof Ll?this._items.toArray():this._items}}]),e}(),L_=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"setActiveItem",value:function(e){this.activeItem&&this.activeItem.setInactiveStyles(),_get(_getPrototypeOf2(t.prototype),"setActiveItem",this).call(this,e),this.activeItem&&this.activeItem.setActiveStyles()}}]),t}(z_),B_=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._origin="program",e}return _inherits(t,e),_createClass(t,[{key:"setFocusOrigin",value:function(e){return this._origin=e,this}},{key:"setActiveItem",value:function(e){_get(_getPrototypeOf2(t.prototype),"setActiveItem",this).call(this,e),this.activeItem&&this.activeItem.focus(this._origin)}}]),t}(z_),F_=((A_=function(){function e(t){_classCallCheck(this,e),this._platform=t}return _createClass(e,[{key:"isDisabled",value:function(e){return e.hasAttribute("disabled")}},{key:"isVisible",value:function(e){return function(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}},{key:"isTabbable",value:function(e){if(!this._platform.isBrowser)return!1;var t,n=function(e){try{return e.frameElement}catch(V5){return null}}((t=e).ownerDocument&&t.ownerDocument.defaultView||window);if(n){var i=n&&n.nodeName.toLowerCase();if(-1===H_(n))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===i)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(n))return!1}var r=e.nodeName.toLowerCase(),a=H_(e);if(e.hasAttribute("contenteditable"))return-1!==a;if("iframe"===r)return!1;if("audio"===r){if(!e.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===r){if(!e.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==r||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(e){var t=e.nodeName.toLowerCase(),n="input"===t&&e.type;return"text"===n||"password"===n||"select"===t||"textarea"===t}(e))&&e.tabIndex>=0}},{key:"isFocusable",value:function(e){return function(e){return!function(e){return function(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function(e){var t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(e)||function(e){return function(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||j_(e))}(e)&&!this.isDisabled(e)&&this.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||A_)($e(by))},A_.\u0275prov=me({factory:function(){return new A_($e(by))},token:A_,providedIn:"root"}),A_);function j_(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;var t=e.getAttribute("tabindex");return"-32768"!=t&&!(!t||isNaN(parseInt(t,10)))}function H_(e){if(!j_(e))return null;var t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}var V_,U_=function(){function e(t,n,i,r){var a=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,e),this._element=t,this._checker=n,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=function(){return a.focusLastTabbableElement()},this.endAnchorListener=function(){return a.focusFirstTabbableElement()},this._enabled=!0,o||this.attachAnchors()}return _createClass(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}},{key:"destroy",value:function(){var e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null}},{key:"attachAnchors",value:function(){var e=this;return!!this._hasAttached||(this._ngZone.runOutsideAngular((function(){e._startAnchor||(e._startAnchor=e._createAnchor(),e._startAnchor.addEventListener("focus",e.startAnchorListener)),e._endAnchor||(e._endAnchor=e._createAnchor(),e._endAnchor.addEventListener("focus",e.endAnchorListener))})),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}},{key:"focusInitialElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusInitialElement())}))}))}},{key:"focusFirstTabbableElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusFirstTabbableElement())}))}))}},{key:"focusLastTabbableElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusLastTabbableElement())}))}))}},{key:"_getRegionBoundary",value:function(e){for(var t=this._element.querySelectorAll("[cdk-focus-region-".concat(e,"], [cdkFocusRegion").concat(e,"], [cdk-focus-").concat(e,"]")),n=0;n<t.length;n++)t[n].hasAttribute("cdk-focus-"+e)?console.warn("Found use of deprecated attribute 'cdk-focus-".concat(e,"', use 'cdkFocusRegion").concat(e,"' instead. The deprecated attribute will be removed in 8.0.0."),t[n]):t[n].hasAttribute("cdk-focus-region-"+e)&&console.warn("Found use of deprecated attribute 'cdk-focus-region-".concat(e,"', use 'cdkFocusRegion").concat(e,"' instead. The deprecated attribute will be removed in 8.0.0."),t[n]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}},{key:"focusInitialElement",value:function(){var e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return e?(e.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",e),Ei()&&!this._checker.isFocusable(e)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",e),e.focus(),!0):this.focusFirstTabbableElement()}},{key:"focusFirstTabbableElement",value:function(){var e=this._getRegionBoundary("start");return e&&e.focus(),!!e}},{key:"focusLastTabbableElement",value:function(){var e=this._getRegionBoundary("end");return e&&e.focus(),!!e}},{key:"hasAttached",value:function(){return this._hasAttached}},{key:"_getFirstTabbableElement",value:function(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;for(var t=e.children||e.childNodes,n=0;n<t.length;n++){var i=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(i)return i}return null}},{key:"_getLastTabbableElement",value:function(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;for(var t=e.children||e.childNodes,n=t.length-1;n>=0;n--){var i=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(i)return i}return null}},{key:"_createAnchor",value:function(){var e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}},{key:"_toggleAnchorTabIndex",value:function(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}},{key:"toggleAnchors",value:function(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}},{key:"_executeOnStable",value:function(e){this._ngZone.isStable?e():this._ngZone.onStable.asObservable().pipe(Yp(1)).subscribe(e)}}]),e}(),q_=((V_=function(){function e(t,n,i){_classCallCheck(this,e),this._checker=t,this._ngZone=n,this._document=i}return _createClass(e,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new U_(e,this._checker,this._ngZone,this._document,t)}}]),e}()).\u0275fac=function(e){return new(e||V_)($e(F_),$e(Su),$e(rc))},V_.\u0275prov=me({factory:function(){return new V_($e(F_),$e(Su),$e(rc))},token:V_,providedIn:"root"}),V_);"undefined"!=typeof Element&&Element;var G_,W_=new qe("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),Z_=new qe("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),X_=((G_=function(){function e(t,n,i,r){_classCallCheck(this,e),this._ngZone=n,this._defaultOptions=r,this._document=i,this._liveElement=t||this._createLiveElement()}return _createClass(e,[{key:"announce",value:function(e){for(var t,n,i,r=this,a=this._defaultOptions,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];return 1===s.length&&"number"==typeof s[0]?i=s[0]:(n=(t=_slicedToArray(s,2))[0],i=t[1]),this.clear(),clearTimeout(this._previousTimeout),n||(n=a&&a.politeness?a.politeness:"polite"),null==i&&a&&(i=a.duration),this._liveElement.setAttribute("aria-live",n),this._ngZone.runOutsideAngular((function(){return new Promise((function(t){clearTimeout(r._previousTimeout),r._previousTimeout=setTimeout((function(){r._liveElement.textContent=e,t(),"number"==typeof i&&(r._previousTimeout=setTimeout((function(){return r.clear()}),i))}),100)}))}))}},{key:"clear",value:function(){this._liveElement&&(this._liveElement.textContent="")}},{key:"ngOnDestroy",value:function(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}},{key:"_createLiveElement",value:function(){for(var e=this._document.getElementsByClassName("cdk-live-announcer-element"),t=this._document.createElement("div"),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n]);return t.classList.add("cdk-live-announcer-element"),t.classList.add("cdk-visually-hidden"),t.setAttribute("aria-atomic","true"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),t}}]),e}()).\u0275fac=function(e){return new(e||G_)($e(W_,8),$e(Su),$e(rc),$e(Z_,8))},G_.\u0275prov=me({factory:function(){return new G_($e(W_,8),$e(Su),$e(rc),$e(Z_,8))},token:G_,providedIn:"root"}),G_);function K_(e){return 0===e.buttons}var Y_,J_=new qe("cdk-focus-monitor-default-options"),Q_=Sy({passive:!0,capture:!0}),$_=((Y_=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this._ngZone=t,this._platform=n,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=function(){a._lastTouchTarget=null,a._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=function(e){if(!a._lastTouchTarget){var t=K_(e)?"keyboard":"mouse";a._setOriginForCurrentEventQueue(t)}},this._documentTouchstartListener=function(e){null!=a._touchTimeoutId&&clearTimeout(a._touchTimeoutId),a._lastTouchTarget=ex(e),a._touchTimeoutId=setTimeout((function(){return a._lastTouchTarget=null}),650)},this._windowFocusListener=function(){a._windowFocused=!0,a._windowFocusTimeoutId=setTimeout((function(){return a._windowFocused=!1}))},this._rootNodeFocusAndBlurListener=function(e){for(var t=ex(e),n="focus"===e.type?a._onFocus:a._onBlur,i=t;i;i=i.parentElement)n.call(a,e,i)},this._document=i,this._detectionMode=(null==r?void 0:r.detectionMode)||0}return _createClass(e,[{key:"monitor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._platform.isBrowser)return bp(null);var n=Ry(e),i=Ey(n)||this._getDocument(),r=this._elementInfo.get(n);if(r)return t&&(r.checkChildren=!0),r.subject.asObservable();var a={checkChildren:t,subject:new I,rootNode:i};return this._elementInfo.set(n,a),this._registerGlobalListeners(a),a.subject.asObservable()}},{key:"stopMonitoring",value:function(e){var t=Ry(e),n=this._elementInfo.get(t);n&&(n.subject.complete(),this._setClasses(t),this._elementInfo.delete(t),this._removeGlobalListeners(n))}},{key:"focusVia",value:function(e,t,n){var i=Ry(e);this._setOriginForCurrentEventQueue(t),"function"==typeof i.focus&&i.focus(n)}},{key:"ngOnDestroy",value:function(){var e=this;this._elementInfo.forEach((function(t,n){return e.stopMonitoring(n)}))}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_toggleClass",value:function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}},{key:"_getFocusOrigin",value:function(e){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(e)?"touch":"program"}},{key:"_setClasses",value:function(e,t){this._toggleClass(e,"cdk-focused",!!t),this._toggleClass(e,"cdk-touch-focused","touch"===t),this._toggleClass(e,"cdk-keyboard-focused","keyboard"===t),this._toggleClass(e,"cdk-mouse-focused","mouse"===t),this._toggleClass(e,"cdk-program-focused","program"===t)}},{key:"_setOriginForCurrentEventQueue",value:function(e){var t=this;this._ngZone.runOutsideAngular((function(){t._origin=e,0===t._detectionMode&&(t._originTimeoutId=setTimeout((function(){return t._origin=null}),1))}))}},{key:"_wasCausedByTouch",value:function(e){var t=ex(e);return this._lastTouchTarget instanceof Node&&t instanceof Node&&(t===this._lastTouchTarget||t.contains(this._lastTouchTarget))}},{key:"_onFocus",value:function(e,t){var n=this._elementInfo.get(t);if(n&&(n.checkChildren||t===ex(e))){var i=this._getFocusOrigin(e);this._setClasses(t,i),this._emitOrigin(n.subject,i),this._lastFocusOrigin=i}}},{key:"_onBlur",value:function(e,t){var n=this._elementInfo.get(t);!n||n.checkChildren&&e.relatedTarget instanceof Node&&t.contains(e.relatedTarget)||(this._setClasses(t),this._emitOrigin(n.subject,null))}},{key:"_emitOrigin",value:function(e,t){this._ngZone.run((function(){return e.next(t)}))}},{key:"_registerGlobalListeners",value:function(e){var t=this;if(this._platform.isBrowser){var n=e.rootNode,i=this._rootNodeFocusListenerCount.get(n)||0;i||this._ngZone.runOutsideAngular((function(){n.addEventListener("focus",t._rootNodeFocusAndBlurListener,Q_),n.addEventListener("blur",t._rootNodeFocusAndBlurListener,Q_)})),this._rootNodeFocusListenerCount.set(n,i+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular((function(){var e=t._getDocument(),n=t._getWindow();e.addEventListener("keydown",t._documentKeydownListener,Q_),e.addEventListener("mousedown",t._documentMousedownListener,Q_),e.addEventListener("touchstart",t._documentTouchstartListener,Q_),n.addEventListener("focus",t._windowFocusListener)}))}}},{key:"_removeGlobalListeners",value:function(e){var t=e.rootNode;if(this._rootNodeFocusListenerCount.has(t)){var n=this._rootNodeFocusListenerCount.get(t);n>1?this._rootNodeFocusListenerCount.set(t,n-1):(t.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Q_),t.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Q_),this._rootNodeFocusListenerCount.delete(t))}if(!--this._monitoredElementCount){var i=this._getDocument(),r=this._getWindow();i.removeEventListener("keydown",this._documentKeydownListener,Q_),i.removeEventListener("mousedown",this._documentMousedownListener,Q_),i.removeEventListener("touchstart",this._documentTouchstartListener,Q_),r.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}]),e}()).\u0275fac=function(e){return new(e||Y_)($e(Su),$e(by),$e(rc,8),$e(J_,8))},Y_.\u0275prov=me({factory:function(){return new Y_($e(Su),$e(by),$e(rc,8),$e(J_,8))},token:Y_,providedIn:"root"}),Y_);function ex(e){return e.composedPath?e.composedPath()[0]:e.target}var tx,nx,ix,rx=((ix=function(){function e(t,n){var i=this;_classCallCheck(this,e),this._elementRef=t,this._focusMonitor=n,this.cdkFocusChange=new Dl,this._monitorSubscription=this._focusMonitor.monitor(this._elementRef,this._elementRef.nativeElement.hasAttribute("cdkMonitorSubtreeFocus")).subscribe((function(e){return i.cdkFocusChange.emit(e)}))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||ix)(To(Vs),To($_))},ix.\u0275dir=Ct({type:ix,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),ix),ax=((nx=function(){function e(t,n){_classCallCheck(this,e),this._platform=t,this._document=n}return _createClass(e,[{key:"getHighContrastMode",value:function(){if(!this._platform.isBrowser)return 0;var e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);var t=this._document.defaultView||window,n=t&&t.getComputedStyle?t.getComputedStyle(e):null,i=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(e),i){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}},{key:"_applyBodyHighContrastModeCssClasses",value:function(){if(this._platform.isBrowser&&this._document.body){var e=this._document.body.classList;e.remove("cdk-high-contrast-active"),e.remove("cdk-high-contrast-black-on-white"),e.remove("cdk-high-contrast-white-on-black");var t=this.getHighContrastMode();1===t?(e.add("cdk-high-contrast-active"),e.add("cdk-high-contrast-black-on-white")):2===t&&(e.add("cdk-high-contrast-active"),e.add("cdk-high-contrast-white-on-black"))}}}]),e}()).\u0275fac=function(e){return new(e||nx)($e(by),$e(rc))},nx.\u0275prov=me({factory:function(){return new nx($e(by),$e(rc))},token:nx,providedIn:"root"}),nx),ox=((tx=_createClass((function e(t){_classCallCheck(this,e),t._applyBodyHighContrastModeCssClasses()}))).\u0275mod=wt({type:tx}),tx.\u0275inj=ve({factory:function(e){return new(e||tx)($e(ax))},imports:[[wy,P_]]}),tx),sx=new Ks("9.2.4"),lx=["*",[["mat-option"],["ng-container"]]],ux=["*","mat-option, ng-container"];function cx(e,t){if(1&e&&Oo(0,"mat-pseudo-checkbox",3),2&e){var n=qo();Mo("state",n.selected?"checked":"unchecked")("disabled",n.disabled)}}var hx,dx=["*"],fx=new Ks("9.2.4"),px=new qe("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}}),mx=((hx=function(){function e(t,n,i){_classCallCheck(this,e),this._hasDoneGlobalChecks=!1,this._document=i,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=n,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}return _createClass(e,[{key:"_getDocument",value:function(){var e=this._document||document;return"object"==typeof e&&e?e:null}},{key:"_getWindow",value:function(){var e=this._getDocument(),t=(null==e?void 0:e.defaultView)||window;return"object"==typeof t&&t?t:null}},{key:"_checksAreEnabled",value:function(){return Ei()&&!this._isTestEnv()}},{key:"_isTestEnv",value:function(){var e=this._getWindow();return e&&(e.__karma__||e.jasmine)}},{key:"_checkDoctypeIsDefined",value:function(){var e=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),t=this._getDocument();e&&t&&!t.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}},{key:"_checkThemeIsPresent",value:function(){var e=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,t=this._getDocument();if(!e&&t&&t.body&&"function"==typeof getComputedStyle){var n=t.createElement("div");n.classList.add("mat-theme-loaded-marker"),t.body.appendChild(n);var i=getComputedStyle(n);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),t.body.removeChild(n)}}},{key:"_checkCdkVersionMatch",value:function(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&fx.full!==sx.full&&console.warn("The Angular Material version ("+fx.full+") does not match the Angular CDK version ("+sx.full+").\nPlease ensure the versions of these two packages exactly match.")}}]),e}()).\u0275mod=wt({type:hx}),hx.\u0275inj=ve({factory:function(e){return new(e||hx)($e(ax),$e(px,8),$e(rc,8))},imports:[[l_],l_]}),hx);function vx(e){return function(e){function t(){var e;_classCallCheck(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=_callSuper(this,t,[].concat(i)))._disabled=!1,e}return _inherits(t,e),_createClass(t,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e)}}]),t}(e)}function gx(e,t){return function(e){function n(){var e;_classCallCheck(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=_callSuper(this,n,[].concat(r))).color=t,e}return _inherits(n,e),_createClass(n,[{key:"color",get:function(){return this._color},set:function(e){var n=e||t;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-"+this._color),n&&this._elementRef.nativeElement.classList.add("mat-"+n),this._color=n)}}]),n}(e)}function yx(e){return function(e){function t(){var e;_classCallCheck(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=_callSuper(this,t,[].concat(i)))._disableRipple=!1,e}return _inherits(t,e),_createClass(t,[{key:"disableRipple",get:function(){return this._disableRipple},set:function(e){this._disableRipple=Py(e)}}]),t}(e)}function _x(e){return function(e){function t(){var e;_classCallCheck(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=_callSuper(this,t,[].concat(i))).errorState=!1,e.stateChanges=new I,e}return _inherits(t,e),_createClass(t,[{key:"updateErrorState",value:function(){var e=this.errorState,t=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);t!==e&&(this.errorState=t,this.stateChanges.next())}}]),t}(e)}var xx,bx=new qe("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return et(du)}}),wx=function(){function e(){_classCallCheck(this,e),this._localeChanges=new I}return _createClass(e,[{key:"localeChanges",get:function(){return this._localeChanges}},{key:"deserialize",value:function(e){return null==e||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}},{key:"setLocale",value:function(e){this.locale=e,this._localeChanges.next()}},{key:"compareDate",value:function(e,t){return this.getYear(e)-this.getYear(t)||this.getMonth(e)-this.getMonth(t)||this.getDate(e)-this.getDate(t)}},{key:"sameDate",value:function(e,t){if(e&&t){var n=this.isValid(e),i=this.isValid(t);return n&&i?!this.compareDate(e,t):n==i}return e==t}},{key:"clampDate",value:function(e,t,n){return t&&this.compareDate(e,t)<0?t:n&&this.compareDate(e,n)>0?n:e}}]),e}(),kx=new qe("mat-date-formats");try{xx="undefined"!=typeof Intl}catch(V5){xx=!1}var Cx={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},Sx=Px(31,(function(e){return String(e+1)})),Tx={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},Ex=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Px(e,t){for(var n=Array(e),i=0;i<e;i++)n[i]=t(i);return n}var Mx,Ix,Ax,Rx,Ox,Nx=((Ix=function(e){function t(e,n){var i,r;return _classCallCheck(this,t),(r=_callSuper(this,t)).useUtcForDisplay=!0,_get((i=_assertThisInitialized2(r),_getPrototypeOf2(t.prototype)),"setLocale",i).call(i,e),r.useUtcForDisplay=!n.TRIDENT,r._clampDate=n.TRIDENT||n.EDGE,r}return _inherits(t,e),_createClass(t,[{key:"getYear",value:function(e){return e.getFullYear()}},{key:"getMonth",value:function(e){return e.getMonth()}},{key:"getDate",value:function(e){return e.getDate()}},{key:"getDayOfWeek",value:function(e){return e.getDay()}},{key:"getMonthNames",value:function(e){var t=this;if(xx){var n=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return Px(12,(function(e){return t._stripDirectionalityCharacters(t._format(n,new Date(2017,e,1)))}))}return Cx[e]}},{key:"getDateNames",value:function(){var e=this;if(xx){var t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Px(31,(function(n){return e._stripDirectionalityCharacters(e._format(t,new Date(2017,0,n+1)))}))}return Sx}},{key:"getDayOfWeekNames",value:function(e){var t=this;if(xx){var n=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return Px(7,(function(e){return t._stripDirectionalityCharacters(t._format(n,new Date(2017,0,e+1)))}))}return Tx[e]}},{key:"getYearName",value:function(e){if(xx){var t=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(t,e))}return String(this.getYear(e))}},{key:"getFirstDayOfWeek",value:function(){return 0}},{key:"getNumDaysInMonth",value:function(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}},{key:"clone",value:function(e){return new Date(e.getTime())}},{key:"createDate",value:function(e,t,n){if(t<0||t>11)throw Error('Invalid month index "'.concat(t,'". Month index has to be between 0 and 11.'));if(n<1)throw Error('Invalid date "'.concat(n,'". Date has to be greater than 0.'));var i=this._createDateWithOverflow(e,t,n);if(i.getMonth()!=t)throw Error('Invalid date "'.concat(n,'" for month with index "').concat(t,'".'));return i}},{key:"today",value:function(){return new Date}},{key:"parse",value:function(e){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}},{key:"format",value:function(e,t){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");if(xx){this._clampDate&&(e.getFullYear()<1||e.getFullYear()>9999)&&(e=this.clone(e)).setFullYear(Math.max(1,Math.min(9999,e.getFullYear()))),t=Object.assign(Object.assign({},t),{timeZone:"utc"});var n=new Intl.DateTimeFormat(this.locale,t);return this._stripDirectionalityCharacters(this._format(n,e))}return this._stripDirectionalityCharacters(e.toDateString())}},{key:"addCalendarYears",value:function(e,t){return this.addCalendarMonths(e,12*t)}},{key:"addCalendarMonths",value:function(e,t){var n=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+t,this.getDate(e));return this.getMonth(n)!=((this.getMonth(e)+t)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}},{key:"addCalendarDays",value:function(e,t){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+t)}},{key:"toIso8601",value:function(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}},{key:"deserialize",value:function(e){if("string"==typeof e){if(!e)return null;if(Ex.test(e)){var n=new Date(e);if(this.isValid(n))return n}}return _get(_getPrototypeOf2(t.prototype),"deserialize",this).call(this,e)}},{key:"isDateInstance",value:function(e){return e instanceof Date}},{key:"isValid",value:function(e){return!isNaN(e.getTime())}},{key:"invalid",value:function(){return new Date(NaN)}},{key:"_createDateWithOverflow",value:function(e,t,n){var i=new Date(e,t,n);return e>=0&&e<100&&i.setFullYear(this.getYear(i)-1900),i}},{key:"_2digit",value:function(e){return("00"+e).slice(-2)}},{key:"_stripDirectionalityCharacters",value:function(e){return e.replace(/[\u200e\u200f]/g,"")}},{key:"_format",value:function(e,t){var n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.format(n)}}]),t}(wx)).\u0275fac=function(e){return new(e||Ix)($e(bx,8),$e(by))},Ix.\u0275prov=me({token:Ix,factory:Ix.\u0275fac}),Ix),Dx=((Mx=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Mx}),Mx.\u0275inj=ve({factory:function(e){return new(e||Mx)},providers:[{provide:wx,useClass:Nx}],imports:[[wy]]}),Mx),zx={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}},Lx=((Ox=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Ox}),Ox.\u0275inj=ve({factory:function(e){return new(e||Ox)},providers:[{provide:kx,useValue:zx}],imports:[[Dx]]}),Ox),Bx=((Rx=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isErrorState",value:function(e,t){return!!(e&&e.invalid&&(e.touched||t&&t.submitted))}}]),e}()).\u0275fac=function(e){return new(e||Rx)},Rx.\u0275prov=me({factory:function(){return new Rx},token:Rx,providedIn:"root"}),Rx),Fx=((Ax=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||Ax)},Ax.\u0275dir=Ct({type:Ax,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),Ax);function jx(e,t,n){var i=e.nativeElement.classList;n?i.add(t):i.remove(t)}var Hx,Vx,Ux,qx,Gx,Wx,Zx,Xx=((Hx=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Hx}),Hx.\u0275inj=ve({factory:function(e){return new(e||Hx)},imports:[[mx],mx]}),Hx),Kx=function(){function e(t,n,i){_classCallCheck(this,e),this._renderer=t,this.element=n,this.config=i,this.state=3}return _createClass(e,[{key:"fadeOut",value:function(){this._renderer.fadeOutRipple(this)}}]),e}(),Yx={enterDuration:450,exitDuration:400},Jx=Sy({passive:!0}),Qx=["mousedown","touchstart"],$x=["mouseup","mouseleave","touchend","touchcancel"],eb=function(){function e(t,n,i,r){_classCallCheck(this,e),this._target=t,this._ngZone=n,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Ry(i))}return _createClass(e,[{key:"fadeInRipple",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),a=Object.assign(Object.assign({},Yx),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);var o=i.radius||function(e,t,n){var i=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),r=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),s=e-r.left,l=t-r.top,u=a.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=s-o+"px",c.style.top=l-o+"px",c.style.height=2*o+"px",c.style.width=2*o+"px",null!=i.color&&(c.style.backgroundColor=i.color),c.style.transitionDuration=u+"ms",this._containerElement.appendChild(c),window.getComputedStyle(c).getPropertyValue("opacity"),c.style.transform="scale(1)";var h=new Kx(this,c,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone((function(){var e=h===n._mostRecentTransientRipple;h.state=1,i.persistent||e&&n._isPointerDown||h.fadeOut()}),u),h}},{key:"fadeOutRipple",value:function(e){var t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),t){var n=e.element,i=Object.assign(Object.assign({},Yx),e.config.animation);n.style.transitionDuration=i.exitDuration+"ms",n.style.opacity="0",e.state=2,this._runTimeoutOutsideZone((function(){e.state=3,n.parentNode.removeChild(n)}),i.exitDuration)}}},{key:"fadeOutAll",value:function(){this._activeRipples.forEach((function(e){return e.fadeOut()}))}},{key:"setupTriggerEvents",value:function(e){var t=Ry(e);t&&t!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(Qx))}},{key:"handleEvent",value:function(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents($x),this._pointerUpEventsRegistered=!0)}},{key:"_onMousedown",value:function(e){var t=K_(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||t||n||(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}},{key:"_onTouchStart",value:function(e){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;for(var t=e.changedTouches,n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}},{key:"_onPointerUp",value:function(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach((function(e){!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()})))}},{key:"_runTimeoutOutsideZone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._ngZone.runOutsideAngular((function(){return setTimeout(e,t)}))}},{key:"_registerEvents",value:function(e){var t=this;this._ngZone.runOutsideAngular((function(){e.forEach((function(e){t._triggerElement.addEventListener(e,t,Jx)}))}))}},{key:"_removeTriggerEvents",value:function(){var e=this;this._triggerElement&&(Qx.forEach((function(t){e._triggerElement.removeEventListener(t,e,Jx)})),this._pointerUpEventsRegistered&&$x.forEach((function(t){e._triggerElement.removeEventListener(t,e,Jx)})))}}]),e}(),tb=new qe("mat-ripple-global-options"),nb=((Gx=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this._elementRef=t,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new eb(this,n,t,i)}return _createClass(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this._setupTriggerEventsIfEnabled()}},{key:"trigger",get:function(){return this._trigger||this._elementRef.nativeElement},set:function(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}},{key:"ngOnInit",value:function(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}},{key:"ngOnDestroy",value:function(){this._rippleRenderer._removeTriggerEvents()}},{key:"fadeOutAll",value:function(){this._rippleRenderer.fadeOutAll()}},{key:"rippleConfig",get:function(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}},{key:"rippleDisabled",get:function(){return this.disabled||!!this._globalOptions.disabled}},{key:"_setupTriggerEventsIfEnabled",value:function(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}},{key:"launch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,t,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),e))}}]),e}()).\u0275fac=function(e){return new(e||Gx)(To(Vs),To(Su),To(by),To(tb,8),To(yp,8))},Gx.\u0275dir=Ct({type:Gx,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,t){2&e&&rs("mat-ripple-unbounded",t.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),Gx),ib=((qx=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:qx}),qx.\u0275inj=ve({factory:function(e){return new(e||qx)},imports:[[mx,wy],mx]}),qx),rb=((Ux=_createClass((function e(t){_classCallCheck(this,e),this._animationMode=t,this.state="unchecked",this.disabled=!1}))).\u0275fac=function(e){return new(e||Ux)(To(yp,8))},Ux.\u0275cmp=yt({type:Ux,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,t){2&e&&rs("mat-pseudo-checkbox-indeterminate","indeterminate"===t.state)("mat-pseudo-checkbox-checked","checked"===t.state)("mat-pseudo-checkbox-disabled",t.disabled)("_mat-animation-noopable","NoopAnimations"===t._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),Ux),ab=((Vx=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Vx}),Vx.\u0275inj=ve({factory:function(e){return new(e||Vx)}}),Vx),ob=vx(_createClass((function e(){_classCallCheck(this,e)}))),sb=0,lb=((Wx=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._labelId="mat-optgroup-label-"+sb++,e}return _inherits(t,e),_createClass(t)}(ob)).\u0275fac=function(e){return ub(e||Wx)},Wx.\u0275cmp=yt({type:Wx,selectors:[["mat-optgroup"]],hostAttrs:["role","group",1,"mat-optgroup"],hostVars:4,hostBindings:function(e,t){2&e&&(wo("aria-disabled",t.disabled.toString())("aria-labelledby",t._labelId),rs("mat-optgroup-disabled",t.disabled))},inputs:{disabled:"disabled",label:"label"},exportAs:["matOptgroup"],features:[bs],ngContentSelectors:ux,decls:4,vars:2,consts:[[1,"mat-optgroup-label",3,"id"]],template:function(e,t){1&e&&(Wo(lx),Ao(0,"label",0),ms(1),Zo(2),Ro(),Zo(3,1)),2&e&&(Mo("id",t._labelId),yr(1),gs("",t.label," "))},styles:[".mat-optgroup-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup-label[disabled]{cursor:default}[dir=rtl] .mat-optgroup-label{text-align:right}.mat-optgroup-label .mat-icon{margin-right:16px;vertical-align:middle}.mat-optgroup-label .mat-icon svg{vertical-align:top}[dir=rtl] .mat-optgroup-label .mat-icon{margin-left:16px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),Wx),ub=hi(lb),cb=0,hb=_createClass((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,e),this.source=t,this.isUserInput=n})),db=new qe("MAT_OPTION_PARENT_COMPONENT"),fb=((Zx=function(){function e(t,n,i,r){_classCallCheck(this,e),this._element=t,this._changeDetectorRef=n,this._parent=i,this.group=r,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+cb++,this.onSelectionChange=new Dl,this._stateChanges=new I}return _createClass(e,[{key:"multiple",get:function(){return this._parent&&this._parent.multiple}},{key:"selected",get:function(){return this._selected}},{key:"disabled",get:function(){return this.group&&this.group.disabled||this._disabled},set:function(e){this._disabled=Py(e)}},{key:"disableRipple",get:function(){return this._parent&&this._parent.disableRipple}},{key:"active",get:function(){return this._active}},{key:"viewValue",get:function(){return(this._getHostElement().textContent||"").trim()}},{key:"select",value:function(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}},{key:"deselect",value:function(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}},{key:"focus",value:function(e,t){var n=this._getHostElement();"function"==typeof n.focus&&n.focus(t)}},{key:"setActiveStyles",value:function(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}},{key:"setInactiveStyles",value:function(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}},{key:"getLabel",value:function(){return this.viewValue}},{key:"_handleKeydown",value:function(e){13!==e.keyCode&&32!==e.keyCode||v_(e)||(this._selectViaInteraction(),e.preventDefault())}},{key:"_selectViaInteraction",value:function(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}},{key:"_getAriaSelected",value:function(){return this.selected||!this.multiple&&null}},{key:"_getTabIndex",value:function(){return this.disabled?"-1":"0"}},{key:"_getHostElement",value:function(){return this._element.nativeElement}},{key:"ngAfterViewChecked",value:function(){if(this._selected){var e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"_emitSelectionChangeEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onSelectionChange.emit(new hb(this,e))}}]),e}()).\u0275fac=function(e){return new(e||Zx)(To(Vs),To(Ga),To(db,8),To(lb,8))},Zx.\u0275cmp=yt({type:Zx,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,t){1&e&&Fo("click",(function(){return t._selectViaInteraction()}))("keydown",(function(e){return t._handleKeydown(e)})),2&e&&(ys("id",t.id),wo("tabindex",t._getTabIndex())("aria-selected",t._getAriaSelected())("aria-disabled",t.disabled.toString()),rs("mat-selected",t.selected)("mat-option-multiple",t.multiple)("mat-active",t.active)("mat-option-disabled",t.disabled))},inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:dx,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(e,t){1&e&&(Wo(),Co(0,cx,1,2,"mat-pseudo-checkbox",0),Ao(1,"span",1),Zo(2),Ro(),Oo(3,"div",2)),2&e&&(Mo("ngIf",t.multiple),yr(3),Mo("matRippleTrigger",t._getHostElement())("matRippleDisabled",t.disabled||t.disableRipple))},directives:[Fc,nb,rb],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),Zx);function pb(e,t,n){if(n.length){for(var i=t.toArray(),r=n.toArray(),a=0,o=0;o<e+1;o++)i[o].group&&i[o].group===r[a]&&a++;return a}return 0}var mb,vb=((mb=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:mb}),mb.\u0275inj=ve({factory:function(e){return new(e||mb)},imports:[[ib,sh,ab]]}),mb),gb=new qe("mat-label-global-options"),yb=["*"];function _b(e,t){if(1&e){var n=zo();Ao(0,"div",2),Fo("click",(function(){return en(n),qo()._onBackdropClicked()})),Ro()}2&e&&rs("mat-drawer-shown",qo()._isShowingBackdrop())}function xb(e,t){1&e&&(Ao(0,"mat-drawer-content"),Zo(1,2),Ro())}var bb=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],wb=["mat-drawer","mat-drawer-content","*"];function kb(e,t){if(1&e){var n=zo();Ao(0,"div",2),Fo("click",(function(){return en(n),qo()._onBackdropClicked()})),Ro()}2&e&&rs("mat-drawer-shown",qo()._isShowingBackdrop())}function Cb(e,t){1&e&&(Ao(0,"mat-sidenav-content",3),Zo(1,2),Ro())}var Sb=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Tb=["mat-sidenav","mat-sidenav-content","*"],Eb={transformDrawer:Wh("transform",[Yh("open, open-instant",Kh({transform:"none",visibility:"visible"})),Yh("void",Kh({"box-shadow":"none",visibility:"hidden"})),Jh("void => open-instant",Zh("0ms")),Jh("void <=> open, open-instant => void",Zh("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};function Pb(e){throw Error("A drawer was already declared for 'position=\"".concat(e,"\"'"))}var Mb,Ib,Ab,Rb,Ob,Nb,Db,zb=new qe("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),Lb=new qe("MAT_DRAWER_CONTAINER"),Bb=((Ob=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[i,r,a]))._changeDetectorRef=e,o._container=n,o}return _inherits(t,e),_createClass(t,[{key:"ngAfterContentInit",value:function(){var e=this;this._container._contentMarginChanges.subscribe((function(){e._changeDetectorRef.markForCheck()}))}}]),t}(d_)).\u0275fac=function(e){return new(e||Ob)(To(Ga),To(Pe((function(){return jb}))),To(Vs),To(h_),To(Su))},Ob.\u0275cmp=yt({type:Ob,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,t){2&e&&is("margin-left",t._container._contentMargins.left,"px")("margin-right",t._container._contentMargins.right,"px")},features:[bs],ngContentSelectors:yb,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Zo(0))},encapsulation:2,changeDetection:0}),Ob),Fb=((Rb=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=i,this._platform=r,this._ngZone=a,this._doc=o,this._container=s,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new I,this._animationEnd=new I,this._animationState="void",this.openedChange=new Dl(!0),this._destroyed=new I,this.onPositionChanged=new Dl,this._modeChanged=new I,this.openedChange.subscribe((function(e){e?(l._doc&&(l._elementFocusedBeforeDrawerWasOpened=l._doc.activeElement),l._takeFocus()):l._restoreFocus()})),this._ngZone.runOutsideAngular((function(){Oy(l._elementRef.nativeElement,"keydown").pipe(Rp((function(e){return 27===e.keyCode&&!l.disableClose&&!v_(e)})),Ky(l._destroyed)).subscribe((function(e){return l._ngZone.run((function(){l.close(),e.stopPropagation(),e.preventDefault()}))}))})),this._animationEnd.pipe(Fy((function(e,t){return e.fromState===t.fromState&&e.toState===t.toState}))).subscribe((function(e){var t=e.fromState,n=e.toState;(0===n.indexOf("open")&&"void"===t||"void"===n&&0===t.indexOf("open"))&&l.openedChange.emit(l._opened)}))}return _createClass(e,[{key:"position",get:function(){return this._position},set:function(e){(e="end"===e?"end":"start")!=this._position&&(this._position=e,this.onPositionChanged.emit())}},{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}},{key:"disableClose",get:function(){return this._disableClose},set:function(e){this._disableClose=Py(e)}},{key:"autoFocus",get:function(){var e=this._autoFocus;return null==e?"side"!==this.mode:e},set:function(e){this._autoFocus=Py(e)}},{key:"opened",get:function(){return this._opened},set:function(e){this.toggle(Py(e))}},{key:"_openedStream",get:function(){return this.openedChange.pipe(Rp((function(e){return e})),H((function(){})))}},{key:"openedStart",get:function(){return this._animationStarted.pipe(Rp((function(e){return e.fromState!==e.toState&&0===e.toState.indexOf("open")})),H((function(){})))}},{key:"_closedStream",get:function(){return this.openedChange.pipe(Rp((function(e){return!e})),H((function(){})))}},{key:"closedStart",get:function(){return this._animationStarted.pipe(Rp((function(e){return e.fromState!==e.toState&&"void"===e.toState})),H((function(){})))}},{key:"_takeFocus",value:function(){var e=this;this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then((function(t){t||"function"!=typeof e._elementRef.nativeElement.focus||e._elementRef.nativeElement.focus()}))}},{key:"_restoreFocus",value:function(){if(this.autoFocus){var e=this._doc&&this._doc.activeElement;e&&this._elementRef.nativeElement.contains(e)&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}}},{key:"ngAfterContentInit",value:function(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}},{key:"ngAfterContentChecked",value:function(){this._platform.isBrowser&&(this._enableAnimations=!0)}},{key:"ngOnDestroy",value:function(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(e){return this.toggle(!0,e)}},{key:"close",value:function(){return this.toggle(!1)}},{key:"toggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.opened,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"program";return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=n):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise((function(t){e.openedChange.pipe(Yp(1)).subscribe((function(e){return t(e?"open":"close")}))}))}},{key:"_width",get:function(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}},{key:"_updateFocusTrapState",value:function(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}},{key:"_animationStartListener",value:function(e){this._animationStarted.next(e)}},{key:"_animationDoneListener",value:function(e){this._animationEnd.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Rb)(To(Vs),To(q_),To($_),To(by),To(Su),To(rc,8),To(Lb,8))},Rb.\u0275cmp=yt({type:Rb,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,t){1&e&&jo("@transform.start",(function(e){return t._animationStartListener(e)}))("@transform.done",(function(e){return t._animationDoneListener(e)})),2&e&&(wo("align",null),_s("@transform",t._animationState),rs("mat-drawer-end","end"===t.position)("mat-drawer-over","over"===t.mode)("mat-drawer-push","push"===t.mode)("mat-drawer-side","side"===t.mode)("mat-drawer-opened",t.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",onPositionChanged:"positionChanged",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart"},exportAs:["matDrawer"],ngContentSelectors:yb,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(e,t){1&e&&(Wo(),Ao(0,"div",0),Zo(1),Ro())},encapsulation:2,data:{animation:[Eb.transformDrawer]},changeDetection:0}),Rb),jb=((Ab=function(){function e(t,n,i,r,a){var o=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,e),this._dir=t,this._element=n,this._ngZone=i,this._changeDetectorRef=r,this._animationMode=l,this._drawers=new Ll,this.backdropClick=new Dl,this._destroyed=new I,this._doCheckSubject=new I,this._contentMargins={left:null,right:null},this._contentMarginChanges=new I,t&&t.change.pipe(Ky(this._destroyed)).subscribe((function(){o._validateDrawers(),o.updateContentMargins()})),a.change().pipe(Ky(this._destroyed)).subscribe((function(){return o.updateContentMargins()})),this._autosize=s}return _createClass(e,[{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}},{key:"autosize",get:function(){return this._autosize},set:function(e){this._autosize=Py(e)}},{key:"hasBackdrop",get:function(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride},set:function(e){this._backdropOverride=null==e?null:Py(e)}},{key:"scrollable",get:function(){return this._userContent||this._content}},{key:"ngAfterContentInit",value:function(){var e=this;this._allDrawers.changes.pipe(om(this._allDrawers),Ky(this._destroyed)).subscribe((function(t){e._drawers.reset(t.filter((function(t){return!t._container||t._container===e}))),e._drawers.notifyOnChanges()})),this._drawers.changes.pipe(om(null)).subscribe((function(){e._validateDrawers(),e._drawers.forEach((function(t){e._watchDrawerToggle(t),e._watchDrawerPosition(t),e._watchDrawerMode(t)})),(!e._drawers.length||e._isDrawerOpen(e._start)||e._isDrawerOpen(e._end))&&e.updateContentMargins(),e._changeDetectorRef.markForCheck()})),this._doCheckSubject.pipe(g_(10),Ky(this._destroyed)).subscribe((function(){return e.updateContentMargins()}))}},{key:"ngOnDestroy",value:function(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(){this._drawers.forEach((function(e){return e.open()}))}},{key:"close",value:function(){this._drawers.forEach((function(e){return e.close()}))}},{key:"updateContentMargins",value:function(){var e=this,t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._width;else if("push"==this._left.mode){var i=this._left._width;t+=i,n-=i}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._width;else if("push"==this._right.mode){var r=this._right._width;n+=r,t-=r}n=n||null,(t=t||null)===this._contentMargins.left&&n===this._contentMargins.right||(this._contentMargins={left:t,right:n},this._ngZone.run((function(){return e._contentMarginChanges.next(e._contentMargins)})))}},{key:"ngDoCheck",value:function(){var e=this;this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular((function(){return e._doCheckSubject.next()}))}},{key:"_watchDrawerToggle",value:function(e){var t=this;e._animationStarted.pipe(Rp((function(e){return e.fromState!==e.toState})),Ky(this._drawers.changes)).subscribe((function(e){"open-instant"!==e.toState&&"NoopAnimations"!==t._animationMode&&t._element.nativeElement.classList.add("mat-drawer-transition"),t.updateContentMargins(),t._changeDetectorRef.markForCheck()})),"side"!==e.mode&&e.openedChange.pipe(Ky(this._drawers.changes)).subscribe((function(){return t._setContainerClass(e.opened)}))}},{key:"_watchDrawerPosition",value:function(e){var t=this;e&&e.onPositionChanged.pipe(Ky(this._drawers.changes)).subscribe((function(){t._ngZone.onMicrotaskEmpty.asObservable().pipe(Yp(1)).subscribe((function(){t._validateDrawers()}))}))}},{key:"_watchDrawerMode",value:function(e){var t=this;e&&e._modeChanged.pipe(Ky(J(this._drawers.changes,this._destroyed))).subscribe((function(){t.updateContentMargins(),t._changeDetectorRef.markForCheck()}))}},{key:"_setContainerClass",value:function(e){var t=this._element.nativeElement.classList,n="mat-drawer-container-has-open";e?t.add(n):t.remove(n)}},{key:"_validateDrawers",value:function(){var e=this;this._start=this._end=null,this._drawers.forEach((function(t){"end"==t.position?(null!=e._end&&Pb("end"),e._end=t):(null!=e._start&&Pb("start"),e._start=t)})),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}},{key:"_isPushed",value:function(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}},{key:"_onBackdropClicked",value:function(){this.backdropClick.emit(),this._closeModalDrawer()}},{key:"_closeModalDrawer",value:function(){var e=this;[this._start,this._end].filter((function(t){return t&&!t.disableClose&&e._canHaveBackdrop(t)})).forEach((function(e){return e.close()}))}},{key:"_isShowingBackdrop",value:function(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}},{key:"_canHaveBackdrop",value:function(e){return"side"!==e.mode||!!this._backdropOverride}},{key:"_isDrawerOpen",value:function(e){return null!=e&&e.opened}}]),e}()).\u0275fac=function(e){return new(e||Ab)(To(s_,8),To(Vs),To(Su),To(Ga),To(f_),To(zb),To(yp,8))},Ab.\u0275cmp=yt({type:Ab,selectors:[["mat-drawer-container"]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,Bb,!0),Yl(n,Fb,!0)),2&e&&(Wl(i=$l())&&(t._content=i.first),Wl(i=$l())&&(t._allDrawers=i))},viewQuery:function(e,t){var n;1&e&&Xl(Bb,!0),2&e&&Wl(n=$l())&&(t._userContent=n.first)},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,t){2&e&&rs("mat-drawer-container-explicit-backdrop",t._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Ls([{provide:Lb,useExisting:Ab}])],ngContentSelectors:wb,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,t){1&e&&(Wo(bb),Co(0,_b,1,2,"div",0),Zo(1),Zo(2,1),Co(3,xb,2,0,"mat-drawer-content",1)),2&e&&(Mo("ngIf",t.hasBackdrop),yr(3),Mo("ngIf",!t._content))},directives:[Fc,Bb],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),Ab),Hb=((Ib=function(e){function t(e,n,i,r,a){return _classCallCheck(this,t),_callSuper(this,t,[e,n,i,r,a])}return _inherits(t,e),_createClass(t)}(Bb)).\u0275fac=function(e){return new(e||Ib)(To(Ga),To(Pe((function(){return qb}))),To(Vs),To(h_),To(Su))},Ib.\u0275cmp=yt({type:Ib,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,t){2&e&&is("margin-left",t._container._contentMargins.left,"px")("margin-right",t._container._contentMargins.right,"px")},features:[bs],ngContentSelectors:yb,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Zo(0))},encapsulation:2,changeDetection:0}),Ib),Vb=((Mb=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._fixedInViewport=!1,e._fixedTopGap=0,e._fixedBottomGap=0,e}return _inherits(t,e),_createClass(t,[{key:"fixedInViewport",get:function(){return this._fixedInViewport},set:function(e){this._fixedInViewport=Py(e)}},{key:"fixedTopGap",get:function(){return this._fixedTopGap},set:function(e){this._fixedTopGap=My(e)}},{key:"fixedBottomGap",get:function(){return this._fixedBottomGap},set:function(e){this._fixedBottomGap=My(e)}}]),t}(Fb)).\u0275fac=function(e){return Ub(e||Mb)},Mb.\u0275cmp=yt({type:Mb,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,t){2&e&&(wo("align",null),is("top",t.fixedInViewport?t.fixedTopGap:null,"px")("bottom",t.fixedInViewport?t.fixedBottomGap:null,"px"),rs("mat-drawer-end","end"===t.position)("mat-drawer-over","over"===t.mode)("mat-drawer-push","push"===t.mode)("mat-drawer-side","side"===t.mode)("mat-drawer-opened",t.opened)("mat-sidenav-fixed",t.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[bs],ngContentSelectors:yb,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(e,t){1&e&&(Wo(),Ao(0,"div",0),Zo(1),Ro())},encapsulation:2,data:{animation:[Eb.transformDrawer]},changeDetection:0}),Mb),Ub=hi(Vb),qb=((Nb=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(jb)).\u0275fac=function(e){return Gb(e||Nb)},Nb.\u0275cmp=yt({type:Nb,selectors:[["mat-sidenav-container"]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,Hb,!0),Yl(n,Vb,!0)),2&e&&(Wl(i=$l())&&(t._content=i.first),Wl(i=$l())&&(t._allDrawers=i))},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,t){2&e&&rs("mat-drawer-container-explicit-backdrop",t._backdropOverride)},exportAs:["matSidenavContainer"],features:[Ls([{provide:Lb,useExisting:Nb}]),bs],ngContentSelectors:Tb,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(e,t){1&e&&(Wo(Sb),Co(0,kb,1,2,"div",0),Zo(1),Zo(2,1),Co(3,Cb,2,0,"mat-sidenav-content",1)),2&e&&(Mo("ngIf",t.hasBackdrop),yr(3),Mo("ngIf",!t._content))},directives:[Fc,Hb,d_],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),Nb),Gb=hi(qb),Wb=((Db=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Db}),Db.\u0275inj=ve({factory:function(e){return new(e||Db)},imports:[[sh,mx,wy,p_],p_,mx]}),Db);function Zb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var i=t[0];if(c(i))return Xb(i,null);if(h(i)&&Object.getPrototypeOf(i)===Object.prototype){var r=Object.keys(i);return Xb(r.map((function(e){return i[e]})),r)}}if("function"==typeof t[t.length-1]){var a=t.pop();return Xb(t=1===t.length&&c(t[0])?t[0]:t,null).pipe(H((function(e){return a.apply(void 0,_toConsumableArray(e))})))}return Xb(t,null)}function Xb(e,t){return new C((function(n){var i=e.length;if(0!==i)for(var r=new Array(i),a=0,o=0,s=function(s){var l=G(e[s]),u=!1;n.add(l.subscribe({next:function(e){u||(u=!0,o++),r[s]=e},error:function(e){return n.error(e)},complete:function(){++a!==i&&u||(o===i&&n.next(t?t.reduce((function(e,t,n){return e[t]=r[n],e}),{}):r),n.complete())}}))},l=0;l<i;l++)s(l);else n.complete()}))}var Kb=_createClass((function e(){_classCallCheck(this,e)})),Yb=_createClass((function e(){_classCallCheck(this,e)})),Jb=function(){function e(t){var n=this;_classCallCheck(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach((function(e){var t=e.indexOf(":");if(t>0){var i=e.slice(0,t),r=i.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(i,r),n.headers.has(r)?n.headers.get(r).push(a):n.headers.set(r,[a])}}))}:function(){n.headers=new Map,Object.keys(t).forEach((function(e){var i=t[e],r=e.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(n.headers.set(r,i),n.maybeSetNormalizedName(e,r))}))}:this.headers=new Map}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(e){return t.applyUpdate(e)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach((function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))}))}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var i=("a"===e.op?this.headers.get(t):void 0)||[];i.push.apply(i,_toConsumableArray(n)),this.headers.set(t,i);break;case"d":var r=e.value;if(r){var a=this.headers.get(t);if(!a)return;0===(a=a.filter((function(e){return-1===r.indexOf(e)}))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return e(t.normalizedNames.get(n),t.headers.get(n))}))}}]),e}(),Qb=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return $b(e)}},{key:"encodeValue",value:function(e){return $b(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function $b(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var ew=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new Qb,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.split("&").forEach((function(e){var i=e.indexOf("="),r=_slicedToArray(-1==i?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,i)),t.decodeValue(e.slice(i+1))],2),a=r[0],o=r[1],s=n.get(a)||[];s.push(o),n.set(a,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(e){var i=n.fromObject[e];t.map.set(e,Array.isArray(i)?i:[i])}))):this.map=null}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map((function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map((function(t){return n+"="+e.encoder.encodeValue(t)})).join("&")})).filter((function(e){return""!==e})).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([t]),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(t){return e.map.set(t,e.cloneFrom.map.get(t))})),this.updates.forEach((function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var i=e.map.get(t.param)||[],r=i.indexOf(t.value);-1!==r&&i.splice(r,1),i.length>0?e.map.set(t.param,i):e.map.delete(t.param)}})),this.cloneFrom=this.updates=null)}}]),e}();function tw(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function nw(e){return"undefined"!=typeof Blob&&e instanceof Blob}function iw(e){return"undefined"!=typeof FormData&&e instanceof FormData}var rw=function(){function e(t,n,i,r){var a;if(_classCallCheck(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,a=r):a=i,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.params&&(this.params=a.params)),this.headers||(this.headers=new Jb),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new ew,this.urlWithParams=n}return _createClass(e,[{key:"serializeBody",value:function(){return null===this.body?null:tw(this.body)||nw(this.body)||iw(this.body)||"string"==typeof this.body?this.body:this.body instanceof ew?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||iw(this.body)?null:nw(this.body)?this.body.type||null:tw(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ew?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,a=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,l=t.headers||this.headers,u=t.params||this.params;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((function(e,n){return e.set(n,t.setHeaders[n])}),l)),t.setParams&&(u=Object.keys(t.setParams).reduce((function(e,n){return e.set(n,t.setParams[n])}),u)),new e(n,i,a,{params:u,headers:l,reportProgress:s,responseType:r,withCredentials:o})}}]),e}(),aw=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),ow=_createClass((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,e),this.headers=t.headers||new Jb,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300})),sw=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_callSuper(this,t,[n])).type=aw.ResponseHeader,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(ow),lw=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_callSuper(this,t,[n])).type=aw.Response,e.body=void 0!==n.body?n.body:null,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(ow),uw=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e,0,"Unknown Error"])).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for "+(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return _inherits(t,e),_createClass(t)}(ow);function cw(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var hw,dw,fw,pw,mw,vw,gw,yw,_w,xw=((hw=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"request",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof rw)n=e;else{var a=void 0;a=r.headers instanceof Jb?r.headers:new Jb(r.headers);var o=void 0;r.params&&(o=r.params instanceof ew?r.params:new ew({fromObject:r.params})),n=new rw(e,t,void 0!==r.body?r.body:null,{headers:a,params:o,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}var s=bp(n).pipe(cm((function(e){return i.handler.handle(e)})));if(e instanceof rw||"events"===r.observe)return s;var l=s.pipe(Rp((function(e){return e instanceof lw})));switch(r.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return l.pipe(H((function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body})));case"blob":return l.pipe(H((function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body})));case"text":return l.pipe(H((function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body})));case"json":default:return l.pipe(H((function(e){return e.body})))}case"response":return l;default:throw new Error("Unreachable: unhandled observe type ".concat(r.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new ew).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,cw(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,cw(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,cw(n,t))}}]),e}()).\u0275fac=function(e){return new(e||hw)($e(Kb))},hw.\u0275prov=me({token:hw,factory:hw.\u0275fac}),hw),bw=function(){function e(t,n){_classCallCheck(this,e),this.next=t,this.interceptor=n}return _createClass(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),ww=new qe("HTTP_INTERCEPTORS"),kw=((dw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||dw)},dw.\u0275prov=me({token:dw,factory:dw.\u0275fac}),dw),Cw=/^\)\]\}',?\n/,Sw=_createClass((function e(){_classCallCheck(this,e)})),Tw=((pw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}()).\u0275fac=function(e){return new(e||pw)},pw.\u0275prov=me({token:pw,factory:pw.\u0275fac}),pw),Ew=((fw=function(){function e(t){_classCallCheck(this,e),this.xhrFactory=t}return _createClass(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new C((function(n){var i=t.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((function(e,t){return i.setRequestHeader(e,t.join(","))})),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var r=e.detectContentTypeHeader();null!==r&&i.setRequestHeader("Content-Type",r)}if(e.responseType){var a=e.responseType.toLowerCase();i.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,l=function(){if(null!==s)return s;var t=1223===i.status?204:i.status,n=i.statusText||"OK",r=new Jb(i.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(i)||e.url;return s=new sw({headers:r,status:t,statusText:n,url:a})},u=function(){var t=l(),r=t.headers,a=t.status,o=t.statusText,s=t.url,u=null;204!==a&&(u=void 0===i.response?i.responseText:i.response),0===a&&(a=u?200:0);var c=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof u){var h=u;u=u.replace(Cw,"");try{u=""!==u?JSON.parse(u):null}catch(d){u=h,c&&(c=!1,u={error:d,text:u})}}c?(n.next(new lw({body:u,headers:r,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new uw({error:u,headers:r,status:a,statusText:o,url:s||void 0}))},c=function(e){var t=l().url,r=new uw({error:e,status:i.status||0,statusText:i.statusText||"Unknown Error",url:t||void 0});n.error(r)},h=!1,d=function(t){h||(n.next(l()),h=!0);var r={type:aw.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(r.total=t.total),"text"===e.responseType&&i.responseText&&(r.partialText=i.responseText),n.next(r)},f=function(e){var t={type:aw.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return i.addEventListener("load",u),i.addEventListener("error",c),e.reportProgress&&(i.addEventListener("progress",d),null!==o&&i.upload&&i.upload.addEventListener("progress",f)),i.send(o),n.next({type:aw.Sent}),function(){i.removeEventListener("error",c),i.removeEventListener("load",u),e.reportProgress&&(i.removeEventListener("progress",d),null!==o&&i.upload&&i.upload.removeEventListener("progress",f)),i.abort()}}))}}]),e}()).\u0275fac=function(e){return new(e||fw)($e(Sw))},fw.\u0275prov=me({token:fw,factory:fw.\u0275fac}),fw),Pw=new qe("XSRF_COOKIE_NAME"),Mw=new qe("XSRF_HEADER_NAME"),Iw=_createClass((function e(){_classCallCheck(this,e)})),Aw=((_w=function(){function e(t,n,i){_classCallCheck(this,e),this.doc=t,this.platform=n,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ac(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}()).\u0275fac=function(e){return new(e||_w)($e(rc),$e(uu),$e(Pw))},_w.\u0275prov=me({token:_w,factory:_w.\u0275fac}),_w),Rw=((yw=function(){function e(t,n){_classCallCheck(this,e),this.tokenService=t,this.headerName=n}return _createClass(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var i=this.tokenService.getToken();return null===i||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,i)})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||yw)($e(Iw),$e(Mw))},yw.\u0275prov=me({token:yw,factory:yw.\u0275fac}),yw),Ow=((gw=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.injector=n,this.chain=null}return _createClass(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(ww,[]);this.chain=t.reduceRight((function(e,t){return new bw(e,t)}),this.backend)}return this.chain.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||gw)($e(Yb),$e(so))},gw.\u0275prov=me({token:gw,factory:gw.\u0275fac}),gw),Nw=((vw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:Rw,useClass:kw}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:Pw,useValue:t.cookieName}:[],t.headerName?{provide:Mw,useValue:t.headerName}:[]]}}}]),e}()).\u0275mod=wt({type:vw}),vw.\u0275inj=ve({factory:function(e){return new(e||vw)},providers:[Rw,{provide:ww,useExisting:Rw,multi:!0},{provide:Iw,useClass:Aw},{provide:Pw,useValue:"XSRF-TOKEN"},{provide:Mw,useValue:"X-XSRF-TOKEN"}]}),vw),Dw=((mw=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:mw}),mw.\u0275inj=ve({factory:function(e){return new(e||mw)},providers:[xw,{provide:Kb,useClass:Ow},Ew,{provide:Yb,useExisting:Ew},Tw,{provide:Sw,useExisting:Tw}],imports:[[Nw.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),mw),zw=["*"];function Lw(e){return Error('Unable to find icon with the name "'.concat(e,'"'))}function Bw(e){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was \"".concat(e,'".'))}function Fw(e){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was \"".concat(e,'".'))}var jw,Hw=_createClass((function e(t,n){_classCallCheck(this,e),this.options=n,t.nodeName?this.svgElement=t:this.url=t})),Vw=((jw=function(){function e(t,n,i,r){_classCallCheck(this,e),this._httpClient=t,this._sanitizer=n,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=i}return _createClass(e,[{key:"addSvgIcon",value:function(e,t,n){return this.addSvgIconInNamespace("",e,t,n)}},{key:"addSvgIconLiteral",value:function(e,t,n){return this.addSvgIconLiteralInNamespace("",e,t,n)}},{key:"addSvgIconInNamespace",value:function(e,t,n,i){return this._addSvgIconConfig(e,t,new Hw(n,i))}},{key:"addSvgIconLiteralInNamespace",value:function(e,t,n,i){var r=this._sanitizer.sanitize(Ki.HTML,n);if(!r)throw Fw(n);var a=this._createSvgElementForSingleIcon(r,i);return this._addSvgIconConfig(e,t,new Hw(a,i))}},{key:"addSvgIconSet",value:function(e,t){return this.addSvgIconSetInNamespace("",e,t)}},{key:"addSvgIconSetLiteral",value:function(e,t){return this.addSvgIconSetLiteralInNamespace("",e,t)}},{key:"addSvgIconSetInNamespace",value:function(e,t,n){return this._addSvgIconSetConfig(e,new Hw(t,n))}},{key:"addSvgIconSetLiteralInNamespace",value:function(e,t,n){var i=this._sanitizer.sanitize(Ki.HTML,t);if(!i)throw Fw(t);var r=this._svgElementFromString(i);return this._addSvgIconSetConfig(e,new Hw(r,n))}},{key:"registerFontClassAlias",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this._fontCssClassesByAlias.set(e,t),this}},{key:"classNameForFontAlias",value:function(e){return this._fontCssClassesByAlias.get(e)||e}},{key:"setDefaultFontSetClass",value:function(e){return this._defaultFontSetClass=e,this}},{key:"getDefaultFontSetClass",value:function(){return this._defaultFontSetClass}},{key:"getSvgIconFromUrl",value:function(e){var t=this,n=this._sanitizer.sanitize(Ki.RESOURCE_URL,e);if(!n)throw Bw(e);var i=this._cachedIconsByUrl.get(n);return i?bp(Uw(i)):this._loadSvgIconFromConfig(new Hw(e)).pipe(dm((function(e){return t._cachedIconsByUrl.set(n,e)})),H((function(e){return Uw(e)})))}},{key:"getNamedSvgIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=qw(t,e),i=this._svgIconConfigs.get(n);if(i)return this._getSvgFromConfig(i);var r,a=this._iconSetConfigs.get(t);return a?this._getSvgFromIconSetConfigs(e,a):(r=Lw(n),new C((function(e){return e.error(r)})))}},{key:"ngOnDestroy",value:function(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}},{key:"_getSvgFromConfig",value:function(e){return e.svgElement?bp(Uw(e.svgElement)):this._loadSvgIconFromConfig(e).pipe(dm((function(t){return e.svgElement=t})),H((function(e){return Uw(e)})))}},{key:"_getSvgFromIconSetConfigs",value:function(e,t){var n=this,i=this._extractIconWithNameFromAnySet(e,t);return i?bp(i):Zb(t.filter((function(e){return!e.svgElement})).map((function(e){return n._loadSvgIconSetFromConfig(e).pipe(Zp((function(t){var i="Loading icon set URL: ".concat(n._sanitizer.sanitize(Ki.RESOURCE_URL,e.url)," failed: ").concat(t.message);return n._errorHandler?n._errorHandler.handleError(new Error(i)):console.error(i),bp(null)})))}))).pipe(H((function(){var i=n._extractIconWithNameFromAnySet(e,t);if(!i)throw Lw(e);return i})))}},{key:"_extractIconWithNameFromAnySet",value:function(e,t){for(var n=t.length-1;n>=0;n--){var i=t[n];if(i.svgElement){var r=this._extractSvgIconFromSet(i.svgElement,e,i.options);if(r)return r}}return null}},{key:"_loadSvgIconFromConfig",value:function(e){var t=this;return this._fetchUrl(e.url).pipe(H((function(n){return t._createSvgElementForSingleIcon(n,e.options)})))}},{key:"_loadSvgIconSetFromConfig",value:function(e){var t=this;return e.svgElement?bp(e.svgElement):this._fetchUrl(e.url).pipe(H((function(n){return e.svgElement||(e.svgElement=t._svgElementFromString(n)),e.svgElement})))}},{key:"_createSvgElementForSingleIcon",value:function(e,t){var n=this._svgElementFromString(e);return this._setSvgAttributes(n,t),n}},{key:"_extractSvgIconFromSet",value:function(e,t,n){var i=e.querySelector('[id="'.concat(t,'"]'));if(!i)return null;var r=i.cloneNode(!0);if(r.removeAttribute("id"),"svg"===r.nodeName.toLowerCase())return this._setSvgAttributes(r,n);if("symbol"===r.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(r),n);var a=this._svgElementFromString("<svg></svg>");return a.appendChild(r),this._setSvgAttributes(a,n)}},{key:"_svgElementFromString",value:function(e){var t=this._document.createElement("DIV");t.innerHTML=e;var n=t.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}},{key:"_toSvgElement",value:function(e){for(var t=this._svgElementFromString("<svg></svg>"),n=e.attributes,i=0;i<n.length;i++){var r=n[i],a=r.name,o=r.value;"id"!==a&&t.setAttribute(a,o)}for(var s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&t.appendChild(e.childNodes[s].cloneNode(!0));return t}},{key:"_setSvgAttributes",value:function(e,t){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),t&&t.viewBox&&e.setAttribute("viewBox",t.viewBox),e}},{key:"_fetchUrl",value:function(e){var t=this;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==e)throw Error('Cannot fetch icon from URL "'.concat(e,'".'));var n=this._sanitizer.sanitize(Ki.RESOURCE_URL,e);if(!n)throw Bw(e);var i=this._inProgressUrlFetches.get(n);if(i)return i;var r=this._httpClient.get(n,{responseType:"text"}).pipe(mm((function(){return t._inProgressUrlFetches.delete(n)})),ae());return this._inProgressUrlFetches.set(n,r),r}},{key:"_addSvgIconConfig",value:function(e,t,n){return this._svgIconConfigs.set(qw(e,t),n),this}},{key:"_addSvgIconSetConfig",value:function(e,t){var n=this._iconSetConfigs.get(e);return n?n.push(t):this._iconSetConfigs.set(e,[t]),this}}]),e}()).\u0275fac=function(e){return new(e||jw)($e(xw,8),$e(jh),$e(rc,8),$e(mi,8))},jw.\u0275prov=me({factory:function(){return new jw($e(xw,8),$e(jh),$e(rc,8),$e(mi,8))},token:jw,providedIn:"root"}),jw);function Uw(e){return e.cloneNode(!0)}function qw(e,t){return e+":"+t}var Gw,Ww,Zw,Xw,Kw,Yw,Jw=gx(_createClass((function e(t){_classCallCheck(this,e),this._elementRef=t}))),Qw=new qe("mat-icon-location",{providedIn:"root",factory:function(){var e=et(rc),t=e?e.location:null;return{getPathname:function(){return t?t.pathname+t.search:""}}}}),$w=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],ek=$w.map((function(e){return"[".concat(e,"]")})).join(", "),tk=/^url\(['"]?#(.*?)['"]?\)$/,nk=((Ww=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e]))._iconRegistry=n,o._location=r,o._errorHandler=a,o._inline=!1,o._currentIconFetch=p.EMPTY,i||e.nativeElement.setAttribute("aria-hidden","true"),o}return _inherits(t,e),_createClass(t,[{key:"inline",get:function(){return this._inline},set:function(e){this._inline=Py(e)}},{key:"fontSet",get:function(){return this._fontSet},set:function(e){this._fontSet=this._cleanupFontValue(e)}},{key:"fontIcon",get:function(){return this._fontIcon},set:function(e){this._fontIcon=this._cleanupFontValue(e)}},{key:"_splitIconName",value:function(e){if(!e)return["",""];var t=e.split(":");switch(t.length){case 1:return["",t[0]];case 2:return t;default:throw Error('Invalid icon name: "'.concat(e,'"'))}}},{key:"ngOnChanges",value:function(e){var t=this,n=e.svgIcon;if(n)if(this._currentIconFetch.unsubscribe(),this.svgIcon){var i=_slicedToArray(this._splitIconName(this.svgIcon),2),r=i[0],a=i[1];this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(a,r).pipe(Yp(1)).subscribe((function(e){return t._setSvgElement(e)}),(function(e){var n="Error retrieving icon ".concat(r,":").concat(a,"! ").concat(e.message);t._errorHandler?t._errorHandler.handleError(new Error(n)):console.error(n)}))}else n.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}},{key:"ngOnInit",value:function(){this._usingFontIcon()&&this._updateFontIconClasses()}},{key:"ngAfterViewChecked",value:function(){var e=this._elementsWithExternalReferences;if(e&&this._location&&e.size){var t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}},{key:"ngOnDestroy",value:function(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}},{key:"_usingFontIcon",value:function(){return!this.svgIcon}},{key:"_setSvgElement",value:function(e){this._clearSvgElement();for(var t=e.querySelectorAll("style"),n=0;n<t.length;n++)t[n].textContent+=" ";if(this._location){var i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(i)}this._elementRef.nativeElement.appendChild(e)}},{key:"_clearSvgElement",value:function(){var e=this._elementRef.nativeElement,t=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();t--;){var n=e.childNodes[t];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||e.removeChild(n)}}},{key:"_updateFontIconClasses",value:function(){if(this._usingFontIcon()){var e=this._elementRef.nativeElement,t=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();t!=this._previousFontSetClass&&(this._previousFontSetClass&&e.classList.remove(this._previousFontSetClass),t&&e.classList.add(t),this._previousFontSetClass=t),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}}},{key:"_cleanupFontValue",value:function(e){return"string"==typeof e?e.trim().split(" ")[0]:e}},{key:"_prependPathToReferences",value:function(e){var t=this._elementsWithExternalReferences;t&&t.forEach((function(t,n){t.forEach((function(t){n.setAttribute(t.name,"url('".concat(e,"#").concat(t.value,"')"))}))}))}},{key:"_cacheChildrenWithExternalReferences",value:function(e){for(var t=e.querySelectorAll(ek),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map,i=function(e){$w.forEach((function(i){var r=t[e],a=r.getAttribute(i),o=a?a.match(tk):null;if(o){var s=n.get(r);s||(s=[],n.set(r,s)),s.push({name:i,value:o[1]})}}))},r=0;r<t.length;r++)i(r)}}]),t}(Jw)).\u0275fac=function(e){return new(e||Ww)(To(Vs),To(Vw),Eo("aria-hidden"),To(Qw,8),To(mi,8))},Ww.\u0275cmp=yt({type:Ww,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(e,t){2&e&&rs("mat-icon-inline",t.inline)("mat-icon-no-color","primary"!==t.color&&"accent"!==t.color&&"warn"!==t.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[bs,Es],ngContentSelectors:zw,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Zo(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),Ww),ik=((Gw=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Gw}),Gw.\u0275inj=ve({factory:function(e){return new(e||Gw)},imports:[[mx],mx]}),Gw),rk=new qe("NgValueAccessor"),ak={provide:rk,useExisting:Pe((function(){return ok})),multi:!0},ok=((Zw=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Zw)(To(Ws),To(Vs))},Zw.\u0275dir=Ct({type:Zw,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(e){return t.onChange(e.target.checked)}))("blur",(function(){return t.onTouched()}))},features:[Ls([ak])]}),Zw),sk={provide:rk,useExisting:Pe((function(){return uk})),multi:!0},lk=new qe("CompositionEventMode"),uk=((Yw=function(){function e(t,n,i){var r;_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=i,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(r=nc()?nc().getUserAgent():"",!/android (\d+)/.test(r.toLowerCase())))}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}()).\u0275fac=function(e){return new(e||Yw)(To(Ws),To(Vs),To(lk,8))},Yw.\u0275dir=Ct({type:Yw,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Fo("input",(function(e){return t._handleInput(e.target.value)}))("blur",(function(){return t.onTouched()}))("compositionstart",(function(){return t._compositionStart()}))("compositionend",(function(e){return t._compositionEnd(e.target.value)}))},features:[Ls([sk])]}),Yw),ck=((Kw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}()).\u0275fac=function(e){return new(e||Kw)},Kw.\u0275dir=Ct({type:Kw}),Kw),hk=((Xw=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),t}(ck)).\u0275fac=function(e){return dk(e||Xw)},Xw.\u0275dir=Ct({type:Xw,features:[bs]}),Xw),dk=hi(hk);function fk(){throw new Error("unimplemented")}var pk,mk,vk=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return _inherits(t,e),_createClass(t,[{key:"validator",get:function(){return fk()}},{key:"asyncValidator",get:function(){return fk()}}]),t}(ck),gk=function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}(),yk=((mk=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t)}(gk)).\u0275fac=function(e){return new(e||mk)(To(vk,2))},mk.\u0275dir=Ct({type:mk,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&rs("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[bs]}),mk),_k=((pk=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,e),_createClass(t)}(gk)).\u0275fac=function(e){return new(e||pk)(To(hk,2))},pk.\u0275dir=Ct({type:pk,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&rs("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[bs]}),pk);function xk(e){return null==e||0===e.length}var bk=new qe("NgValidators"),wk=new qe("NgAsyncValidators"),kk=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ck=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(xk(t.value)||xk(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(xk(t.value)||xk(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return xk(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return xk(e.value)||kk.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(xk(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}},{key:"maxLength",value:function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(i="","^"!==t.charAt(0)&&(i+="^"),i+=t,"$"!==t.charAt(t.length-1)&&(i+="$"),n=new RegExp(i)):(i=t.toString(),n=t),function(e){if(xk(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:i,actualValue:t}}}):e.nullValidator;var n,i}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(Sk);return 0==t.length?null:function(e){return Ek(function(e,t){return t.map((function(t){return t(e)}))}(e,t))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(Sk);return 0==t.length?null:function(e){return Zb(function(e,t){return t.map((function(t){return t(e)}))}(e,t).map(Tk)).pipe(H(Ek))}}}]),e}();function Sk(e){return null!=e}function Tk(e){var t=Lo(e)?G(e):e;if(!Bo(t))throw new Error("Expected validator to return Promise or Observable.");return t}function Ek(e){var t={};return e.forEach((function(e){t=null!=e?Object.assign(Object.assign({},t),e):t})),0===Object.keys(t).length?null:t}function Pk(e){return e.validate?function(t){return e.validate(t)}:e}function Mk(e){return e.validate?function(t){return e.validate(t)}:e}var Ik,Ak,Rk,Ok,Nk,Dk,zk={provide:rk,useExisting:Pe((function(){return Lk})),multi:!0},Lk=((Ik=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Ik)(To(Ws),To(Vs))},Ik.\u0275dir=Ct({type:Ik,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[Ls([zk])]}),Ik),Bk={provide:rk,useExisting:Pe((function(){return jk})),multi:!0},Fk=((Rk=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach((function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)}))}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}()).\u0275fac=function(e){return new(e||Rk)},Rk.\u0275prov=me({token:Rk,factory:Rk.\u0275fac}),Rk),jk=((Ak=function(){function e(t,n,i,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._registry=i,this._injector=r,this.onChange=function(){},this.onTouched=function(){}}return _createClass(e,[{key:"ngOnInit",value:function(){this._control=this._injector.get(vk),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),e}()).\u0275fac=function(e){return new(e||Ak)(To(Ws),To(Vs),To(Fk),To(so))},Ak.\u0275dir=Ct({type:Ak,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(){return t.onChange()}))("blur",(function(){return t.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ls([Bk])]}),Ak),Hk={provide:rk,useExisting:Pe((function(){return Vk})),multi:!0},Vk=((Ok=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Ok)(To(Ws),To(Vs))},Ok.\u0275dir=Ct({type:Ok,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[Ls([Hk])]}),Ok),Uk='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',qk='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',Gk='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',Wk={provide:rk,useExisting:Pe((function(){return Zk})),multi:!0},Zk=((Nk=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=vo}return _createClass(e,[{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=function(e,t){return null==e?""+t:(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var i=n[t];if(this._compareWith(this._optionMap.get(i),e))return i}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),e}()).\u0275fac=function(e){return new(e||Nk)(To(Ws),To(Vs))},Nk.\u0275dir=Ct({type:Nk,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Ls([Wk])]}),Nk),Xk={provide:rk,useExisting:Pe((function(){return Kk})),multi:!0},Kk=((Dk=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=vo}return _createClass(e,[{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var i=e.map((function(e){return n._getOptionId(e)}));t=function(e,t){e._setSelected(i.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var i=[];if(n.hasOwnProperty("selectedOptions"))for(var r=n.selectedOptions,a=0;a<r.length;a++){var o=r.item(a),s=t._getOptionValue(o.value);i.push(s)}else for(var l=n.options,u=0;u<l.length;u++){var c=l.item(u);if(c.selected){var h=t._getOptionValue(c.value);i.push(h)}}t.value=i,e(i)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var i=n[t];if(this._compareWith(this._optionMap.get(i)._value,e))return i}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),e}()).\u0275fac=function(e){return new(e||Dk)(To(Ws),To(Vs))},Dk.\u0275dir=Ct({type:Dk,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Fo("change",(function(e){return t.onChange(e.target)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Ls([Xk])]}),Dk);function Yk(e,t){return[].concat(_toConsumableArray(t.path),[e])}function Jk(e,t){e||tC(t,"Cannot find control with"),t.valueAccessor||tC(t,"No value accessor for form control with"),e.validator=Ck.compose([e.validator,t.validator]),e.asyncValidator=Ck.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange((function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Qk(e,t)}))}(e,t),function(e,t){e.registerOnChange((function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)}))}(e,t),function(e,t){t.valueAccessor.registerOnTouched((function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Qk(e,t),"submit"!==e.updateOn&&e.markAsTouched()}))}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange((function(e){t.valueAccessor.setDisabledState(e)})),t._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))})),t._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))}))}function Qk(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function $k(e,t){null==e&&tC(t,"Cannot find control with"),e.validator=Ck.compose([e.validator,t.validator]),e.asyncValidator=Ck.composeAsync([e.asyncValidator,t.asyncValidator])}function eC(e){return tC(e,"There is no FormControl instance attached to form control element with")}function tC(e,t){var n;throw n=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(n))}function nC(e){return null!=e?Ck.compose(e.map(Pk)):null}function iC(e){return null!=e?Ck.composeAsync(e.map(Mk)):null}var rC=[ok,Vk,Lk,Zk,Kk,jk];function aC(e,t){e._syncPendingControls(),t.forEach((function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}))}function oC(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function sC(e){var t=uC(e)?e.validators:e;return Array.isArray(t)?nC(t):t||null}function lC(e,t){var n=uC(t)?t.asyncValidators:e;return Array.isArray(n)?iC(n):n||null}function uC(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var cC,hC,dC,fC,pC,mC,vC,gC,yC,_C,xC,bC,wC,kC,CC,SC,TC=function(){function e(t,n){_classCallCheck(this,e),this.validator=t,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this.validator=sC(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=lC(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(e){return e.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(e){e.markAsUntouched({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(e){e.markAsPristine({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!0)}))}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild((function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!1)}))}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(t){return t._updateTreeValidity(e)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var n=Tk(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return t.setErrors(n,{emitEvent:e})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;var i=e;return t.forEach((function(e){i=i instanceof PC?i.controls.hasOwnProperty(e)?i.controls[e]:null:i instanceof MC&&i.at(e)||null})),i}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new Dl,this.statusChanges=new Dl}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls((function(t){return t.status===e}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(e){return e.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(e){return e.touched}))}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){uC(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}]),e}(),EC=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,t),(e=_callSuper(this,t,[sC(i),lC(r,i)]))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(i),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _inherits(t,e),_createClass(t,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(e){return e(t.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),t}(TC),PC=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[sC(n),lC(i,n)])).controls=e,r._initObservables(),r._setUpdateStrategy(n),r._setUpControls(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),r}return _inherits(t,e),_createClass(t,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach((function(i){t._throwIfControlMissing(i),t.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(i){t.controls[i]&&t.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,i){n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(e,t,n){return e[n]=t instanceof EC?t.value:t.getRawValue(),e}))}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,(function(e,t){return!!t._syncPendingControls()||e}));return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,n=!1;return this._forEachChild((function(i,r){n=n||t.contains(r)&&e(i)})),n}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},(function(t,n,i){return(n.enabled||e.disabled)&&(t[i]=n.value),t}))}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild((function(e,i){n=t(n,e,i)})),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),t}(TC),MC=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[sC(n),lC(i,n)])).controls=e,r._initObservables(),r._setUpdateStrategy(n),r._setUpControls(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),r}return _inherits(t,e),_createClass(t,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach((function(e,i){t._throwIfControlMissing(i),t.at(i).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e,i){t.at(i)&&t.at(i).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,i){n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map((function(e){return e instanceof EC?e.value:e.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(e){return e._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce((function(e,t){return!!t._syncPendingControls()||e}),!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index "+e)}},{key:"_forEachChild",value:function(e){this.controls.forEach((function(t,n){e(t,n)}))}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter((function(t){return t.enabled||e.disabled})).map((function(e){return e.value}))}},{key:"_anyControls",value:function(e){return this.controls.some((function(t){return t.enabled&&e(t)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){return e._registerControl(t)}))}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var e,t=_createForOfIteratorHelper(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),t}(TC),IC={provide:hk,useExisting:Pe((function(){return RC}))},AC=Promise.resolve(null),RC=((hC=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).submitted=!1,i._directives=[],i.ngSubmit=new Dl,i.form=new PC({},nC(e),iC(n)),i}return _inherits(t,e),_createClass(t,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;AC.then((function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),Jk(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)}))}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;AC.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),oC(t._directives,e)}))}},{key:"addFormGroup",value:function(e){var t=this;AC.then((function(){var n=t._findContainer(e.path),i=new PC({});$k(i,e),n.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(e){var t=this;AC.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)}))}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;AC.then((function(){n.form.get(e.path).setValue(t)}))}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,aC(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),t}(hk)).\u0275fac=function(e){return new(e||hC)(To(bk,10),To(wk,10))},hC.\u0275dir=Ct({type:hC,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Fo("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ls([IC]),bs]}),hC),OC=((cC=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return Yk(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return nC(this._validators)}},{key:"asyncValidator",get:function(){return iC(this._asyncValidators)}},{key:"_checkParentType",value:function(){}}]),t}(hk)).\u0275fac=function(e){return NC(e||cC)},cC.\u0275dir=Ct({type:cC,features:[bs]}),cC),NC=hi(OC),DC=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"modelParentException",value:function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      '.concat(Uk,'\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  '))}},{key:"formGroupNameException",value:function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ".concat(qk,"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ").concat(Gk))}},{key:"missingNameException",value:function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}},{key:"modelGroupParentException",value:function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ".concat(qk,"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ").concat(Gk))}}]),e}(),zC={provide:hk,useExisting:Pe((function(){return LC}))},LC=((dC=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t))._parent=e,r._validators=n,r._asyncValidators=i,r}return _inherits(t,e),_createClass(t,[{key:"_checkParentType",value:function(){this._parent instanceof t||this._parent instanceof RC||DC.modelGroupParentException()}}]),t}(OC)).\u0275fac=function(e){return new(e||dC)(To(hk,5),To(bk,10),To(wk,10))},dC.\u0275dir=Ct({type:dC,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[Ls([zC]),bs]}),dC),BC={provide:vk,useExisting:Pe((function(){return jC}))},FC=Promise.resolve(null),jC=((pC=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t)).control=new EC,a._registered=!1,a.update=new Dl,a._parent=e,a._rawValidators=n||[],a._rawAsyncValidators=i||[],a.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||tC(e,"Value accessor was not provided as an array for form control with");var n=void 0,i=void 0,r=void 0;return t.forEach((function(t){var a;t.constructor===uk?n=t:(a=t,rC.some((function(e){return a.constructor===e}))?(i&&tC(e,"More than one built-in value accessor matches form control with"),i=t):(r&&tC(e,"More than one custom value accessor matches form control with"),r=t))})),r||i||n||(tC(e,"No valid value accessor for form control with"),null)}(_assertThisInitialized2(a),r),a}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!vo(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?Yk(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return nC(this._rawValidators)}},{key:"asyncValidator",get:function(){return iC(this._rawAsyncValidators)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){Jk(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){!(this._parent instanceof LC)&&this._parent instanceof OC?DC.formGroupNameException():this._parent instanceof LC||this._parent instanceof RC||DC.modelParentException()}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||DC.missingNameException()}},{key:"_updateValue",value:function(e){var t=this;FC.then((function(){t.control.setValue(e,{emitViewToModelChange:!1})}))}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,i=""===n||n&&"false"!==n;FC.then((function(){i&&!t.control.disabled?t.control.disable():!i&&t.control.disabled&&t.control.enable()}))}}]),t}(vk)).\u0275fac=function(e){return new(e||pC)(To(hk,9),To(bk,10),To(wk,10),To(rk,10))},pC.\u0275dir=Ct({type:pC,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ls([BC]),bs,Es]}),pC),HC=((fC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||fC)},fC.\u0275dir=Ct({type:fC,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),fC),VC={provide:hk,useExisting:Pe((function(){return UC}))},UC=((mC=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._validators=e,i._asyncValidators=n,i.submitted=!1,i.directives=[],i.form=null,i.ngSubmit=new Dl,i}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return Jk(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){oC(this.directives,e)}},{key:"addFormGroup",value:function(e){var t=this.form.get(e.path);$k(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormGroup",value:function(e){}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){var t=this.form.get(e.path);$k(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormArray",value:function(e){}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,aC(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach((function(t){var n=e.form.get(t.path);t.control!==n&&(function(e,t){t.valueAccessor.registerOnChange((function(){return eC(t)})),t.valueAccessor.registerOnTouched((function(){return eC(t)})),t._rawValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),t._rawAsyncValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),e&&e._clearChangeFns()}(t.control,t),n&&Jk(n,t),t.control=n)})),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_updateRegistrations",value:function(){var e=this;this.form._registerOnCollectionChange((function(){return e._updateDomValue()})),this._oldForm&&this._oldForm._registerOnCollectionChange((function(){})),this._oldForm=this.form}},{key:"_updateValidators",value:function(){var e=nC(this._validators);this.form.validator=Ck.compose([this.form.validator,e]);var t=iC(this._asyncValidators);this.form.asyncValidator=Ck.composeAsync([this.form.asyncValidator,t])}},{key:"_checkFormPresent",value:function(){this.form}}]),t}(hk)).\u0275fac=function(e){return new(e||mC)(To(bk,10),To(wk,10))},mC.\u0275dir=Ct({type:mC,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&Fo("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ls([VC]),bs,Es]}),mC),qC={provide:bk,useExisting:Pe((function(){return GC})),multi:!0},GC=((_C=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&""+e!="false",this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?Ck.required(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}()).\u0275fac=function(e){return new(e||_C)},_C.\u0275dir=Ct({type:_C,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&wo("required",t.required?"":null)},inputs:{required:"required"},features:[Ls([qC])]}),_C),WC=((yC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:yC}),yC.\u0275inj=ve({factory:function(e){return new(e||yC)}}),yC),ZC=((gC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:gC}),gC.\u0275inj=ve({factory:function(e){return new(e||gC)},providers:[Fk],imports:[WC]}),gC),XC=((vC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:vC}),vC.\u0275inj=ve({factory:function(e){return new(e||vC)},imports:[[mx],mx]}),vC),KC=["*"],YC=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],JC=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],QC=vx(yx(_createClass((function e(){_classCallCheck(this,e)})))),$C=yx(_createClass((function e(){_classCallCheck(this,e)}))),eS=((xC=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._stateChanges=new I,e}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(){this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}}]),t}(QC)).\u0275fac=function(e){return tS(e||xC)},xC.\u0275cmp=yt({type:xC,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[bs,Es],ngContentSelectors:KC,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Zo(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),xC),tS=hi(eS),nS=((SC=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t))._elementRef=e,n._stateChanges=new I,"action-list"===n._getListType()&&e.nativeElement.classList.add("mat-action-list"),n}return _inherits(t,e),_createClass(t,[{key:"_getListType",value:function(){var e=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===e?"list":"mat-action-list"===e?"action-list":null}},{key:"ngOnChanges",value:function(){this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}}]),t}(QC)).\u0275fac=function(e){return new(e||SC)(To(Vs))},SC.\u0275cmp=yt({type:SC,selectors:[["mat-list"],["mat-action-list"]],hostAttrs:[1,"mat-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matList"],features:[bs,Es],ngContentSelectors:KC,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Zo(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),SC),iS=((CC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||CC)},CC.\u0275dir=Ct({type:CC,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),CC),rS=((kC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||kC)},kC.\u0275dir=Ct({type:kC,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),kC),aS=((wC=function(e){function t(e,n,i,r){var a;_classCallCheck(this,t),(a=_callSuper(this,t))._element=e,a._isInteractiveList=!1,a._destroyed=new I,a._disabled=!1,a._isInteractiveList=!!(i||r&&"action-list"===r._getListType()),a._list=i||r;var o=a._getHostElement();return"button"!==o.nodeName.toLowerCase()||o.hasAttribute("type")||o.setAttribute("type","button"),a._list&&a._list._stateChanges.pipe(Ky(a._destroyed)).subscribe((function(){n.markForCheck()})),a}return _inherits(t,e),_createClass(t,[{key:"disabled",get:function(){return this._disabled||!(!this._list||!this._list.disabled)},set:function(e){this._disabled=Py(e)}},{key:"ngAfterContentInit",value:function(){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mat";e.changes.pipe(om(e)).subscribe((function(e){var i=e.length;jx(t,n+"-2-line",!1),jx(t,n+"-3-line",!1),jx(t,n+"-multi-line",!1),2===i||3===i?jx(t,"".concat(n,"-").concat(i,"-line"),!0):i>3&&jx(t,n+"-multi-line",!0)}))}(this._lines,this._element)}},{key:"ngOnDestroy",value:function(){this._destroyed.next(),this._destroyed.complete()}},{key:"_isRippleDisabled",value:function(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}},{key:"_getHostElement",value:function(){return this._element.nativeElement}}]),t}($C)).\u0275fac=function(e){return new(e||wC)(To(Vs),To(Ga),To(eS,8),To(nS,8))},wC.\u0275cmp=yt({type:wC,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,iS,!0),Yl(n,rS,!0),Yl(n,Fx,!0)),2&e&&(Wl(i=$l())&&(t._avatar=i.first),Wl(i=$l())&&(t._icon=i.first),Wl(i=$l())&&(t._lines=i))},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(e,t){2&e&&rs("mat-list-item-disabled",t.disabled)("mat-list-item-avatar",t._avatar||t._icon)("mat-list-item-with-avatar",t._avatar||t._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[bs],ngContentSelectors:JC,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(e,t){1&e&&(Wo(YC),Ao(0,"div",0),Oo(1,"div",1),Zo(2),Ao(3,"div",2),Zo(4,1),Ro(),Zo(5,2),Ro()),2&e&&(yr(1),Mo("matRippleTrigger",t._getHostElement())("matRippleDisabled",t._isRippleDisabled()))},directives:[nb],encapsulation:2,changeDetection:0}),wC),oS=((bC=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:bC}),bC.\u0275inj=ve({factory:function(e){return new(e||bC)},imports:[[Xx,ib,mx,ab,sh],Xx,mx,ab,XC]}),bC);function sS(){throw Error("Host already has a portal attached")}var lS,uS,cS,hS,dS=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"attach",value:function(e){return null==e&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),e.hasAttached()&&sS(),this._attachedHost=e,e.attach(this)}},{key:"detach",value:function(){var e=this._attachedHost;null==e?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,e.detach())}},{key:"isAttached",get:function(){return null!=this._attachedHost}},{key:"setAttachedHost",value:function(e){this._attachedHost=e}}]),e}(),fS=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t)).component=e,a.viewContainerRef=n,a.injector=i,a.componentFactoryResolver=r,a}return _inherits(t,e),_createClass(t)}(dS),pS=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).templateRef=e,r.viewContainerRef=n,r.context=i,r}return _inherits(t,e),_createClass(t,[{key:"origin",get:function(){return this.templateRef.elementRef}},{key:"attach",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context;return this.context=n,_get(_getPrototypeOf2(t.prototype),"attach",this).call(this,e)}},{key:"detach",value:function(){return this.context=void 0,_get(_getPrototypeOf2(t.prototype),"detach",this).call(this)}}]),t}(dS),mS=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).element=e instanceof Vs?e.nativeElement:e,n}return _inherits(t,e),_createClass(t)}(dS),vS=function(){function e(){_classCallCheck(this,e),this._isDisposed=!1,this.attachDomPortal=null}return _createClass(e,[{key:"hasAttached",value:function(){return!!this._attachedPortal}},{key:"attach",value:function(e){return e||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&sS(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),e instanceof fS?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof pS?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof mS?(this._attachedPortal=e,this.attachDomPortal(e)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}},{key:"detach",value:function(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}},{key:"dispose",value:function(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}},{key:"setDisposeFn",value:function(e){this._disposeFn=e}},{key:"_invokeDisposeFn",value:function(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}]),e}(),gS=function(e){function t(e,n,i,r,a){var o,s;return _classCallCheck(this,t),(s=_callSuper(this,t)).outletElement=e,s._componentFactoryResolver=n,s._appRef=i,s._defaultInjector=r,s.attachDomPortal=function(e){if(!s._document)throw Error("Cannot attach DOM portal without _document constructor parameter");var n=e.element;if(!n.parentNode)throw Error("DOM portal content must be attached to a parent node.");var i=s._document.createComment("dom-portal");n.parentNode.insertBefore(i,n),s.outletElement.appendChild(n),_get((o=_assertThisInitialized2(s),_getPrototypeOf2(t.prototype)),"setDisposeFn",o).call(o,(function(){i.parentNode&&i.parentNode.replaceChild(n,i)}))},s._document=a,s}return _inherits(t,e),_createClass(t,[{key:"attachComponentPortal",value:function(e){var t,n=this,i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);return e.viewContainerRef?(t=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn((function(){return t.destroy()}))):(t=i.create(e.injector||this._defaultInjector),this._appRef.attachView(t.hostView),this.setDisposeFn((function(){n._appRef.detachView(t.hostView),t.destroy()}))),this.outletElement.appendChild(this._getComponentRootNode(t)),t}},{key:"attachTemplatePortal",value:function(e){var t=this,n=e.viewContainerRef,i=n.createEmbeddedView(e.templateRef,e.context);return i.detectChanges(),i.rootNodes.forEach((function(e){return t.outletElement.appendChild(e)})),this.setDisposeFn((function(){var e=n.indexOf(i);-1!==e&&n.remove(e)})),i}},{key:"dispose",value:function(){_get(_getPrototypeOf2(t.prototype),"dispose",this).call(this),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}},{key:"_getComponentRootNode",value:function(e){return e.hostView.rootNodes[0]}}]),t}(vS),yS=((cS=function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t,[e,n])}return _inherits(t,e),_createClass(t)}(pS)).\u0275fac=function(e){return new(e||cS)(To(dl),To(pl))},cS.\u0275dir=Ct({type:cS,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[bs]}),cS),_S=((uS=function(e){function t(e,n,i){var r,a;return _classCallCheck(this,t),(a=_callSuper(this,t))._componentFactoryResolver=e,a._viewContainerRef=n,a._isInitialized=!1,a.attached=new Dl,a.attachDomPortal=function(e){if(!a._document)throw Error("Cannot attach DOM portal without _document constructor parameter");var n=e.element;if(!n.parentNode)throw Error("DOM portal content must be attached to a parent node.");var i=a._document.createComment("dom-portal");e.setAttachedHost(_assertThisInitialized2(a)),n.parentNode.insertBefore(i,n),a._getRootNode().appendChild(n),_get((r=_assertThisInitialized2(a),_getPrototypeOf2(t.prototype)),"setDisposeFn",r).call(r,(function(){i.parentNode&&i.parentNode.replaceChild(n,i)}))},a._document=i,a}return _inherits(t,e),_createClass(t,[{key:"portal",get:function(){return this._attachedPortal},set:function(e){(!this.hasAttached()||e||this._isInitialized)&&(this.hasAttached()&&_get(_getPrototypeOf2(t.prototype),"detach",this).call(this),e&&_get(_getPrototypeOf2(t.prototype),"attach",this).call(this,e),this._attachedPortal=e)}},{key:"attachedRef",get:function(){return this._attachedRef}},{key:"ngOnInit",value:function(){this._isInitialized=!0}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf2(t.prototype),"dispose",this).call(this),this._attachedPortal=null,this._attachedRef=null}},{key:"attachComponentPortal",value:function(e){e.setAttachedHost(this);var n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),r=n.createComponent(i,n.length,e.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),_get(_getPrototypeOf2(t.prototype),"setDisposeFn",this).call(this,(function(){return r.destroy()})),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}},{key:"attachTemplatePortal",value:function(e){var n=this;e.setAttachedHost(this);var i=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return _get(_getPrototypeOf2(t.prototype),"setDisposeFn",this).call(this,(function(){return n._viewContainerRef.clear()})),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}},{key:"_getRootNode",value:function(){var e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}]),t}(vS)).\u0275fac=function(e){return new(e||uS)(To(Hs),To(pl),To(rc))},uS.\u0275dir=Ct({type:uS,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[bs]}),uS),xS=((lS=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(_S)).\u0275fac=function(e){return bS(e||lS)},lS.\u0275dir=Ct({type:lS,selectors:[["","cdkPortalHost",""],["","portalHost",""]],inputs:{portal:["cdkPortalHost","portal"]},exportAs:["cdkPortalHost"],features:[Ls([{provide:_S,useExisting:lS}]),bs]}),lS),bS=hi(xS),wS=((hS=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:hS}),hS.\u0275inj=ve({factory:function(e){return new(e||hS)}}),hS),kS=function(){function e(t,n){_classCallCheck(this,e),this._parentInjector=t,this._customTokens=n}return _createClass(e,[{key:"get",value:function(e,t){var n=this._customTokens.get(e);return void 0!==n?n:this._parentInjector.get(e,t)}}]),e}(),CS=function(){function e(t,n){_classCallCheck(this,e),this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}return _createClass(e,[{key:"attach",value:function(){}},{key:"enable",value:function(){if(this._canBeEnabled()){var e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Ay(-this._previousScrollPosition.left),e.style.top=Ay(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}},{key:"disable",value:function(){if(this._isEnabled){var e=this._document.documentElement,t=e.style,n=this._document.body.style,i=t.scrollBehavior||"",r=n.scrollBehavior||"";this._isEnabled=!1,t.left=this._previousHTMLStyles.left,t.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),t.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),t.scrollBehavior=i,n.scrollBehavior=r}}},{key:"_canBeEnabled",value:function(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;var e=this._document.body,t=this._viewportRuler.getViewportSize();return e.scrollHeight>t.height||e.scrollWidth>t.width}}]),e}();function SS(){return Error("Scroll strategy has already been attached.")}var TS=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this._scrollDispatcher=t,this._ngZone=n,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=function(){a.disable(),a._overlayRef.hasAttached()&&a._ngZone.run((function(){return a._overlayRef.detach()}))}}return _createClass(e,[{key:"attach",value:function(e){if(this._overlayRef)throw SS();this._overlayRef=e}},{key:"enable",value:function(){var e=this;if(!this._scrollSubscription){var t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe((function(){var t=e._viewportRuler.getViewportScrollPosition().top;Math.abs(t-e._initialScrollPosition)>e._config.threshold?e._detach():e._overlayRef.updatePosition()}))):this._scrollSubscription=t.subscribe(this._detach)}}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),e}(),ES=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"attach",value:function(){}}]),e}();function PS(e,t){return t.some((function(t){return e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right}))}function MS(e,t){return t.some((function(t){return e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right}))}var IS,AS=function(){function e(t,n,i,r){_classCallCheck(this,e),this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=i,this._config=r,this._scrollSubscription=null}return _createClass(e,[{key:"attach",value:function(e){if(this._overlayRef)throw SS();this._overlayRef=e}},{key:"enable",value:function(){var e=this;this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe((function(){if(e._overlayRef.updatePosition(),e._config&&e._config.autoClose){var t=e._overlayRef.overlayElement.getBoundingClientRect(),n=e._viewportRuler.getViewportSize(),i=n.width,r=n.height;PS(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(e.disable(),e._ngZone.run((function(){return e._overlayRef.detach()})))}})))}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),e}(),RS=((IS=_createClass((function e(t,n,i,r){var a=this;_classCallCheck(this,e),this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=i,this.noop=function(){return new ES},this.close=function(e){return new TS(a._scrollDispatcher,a._ngZone,a._viewportRuler,e)},this.block=function(){return new CS(a._viewportRuler,a._document)},this.reposition=function(e){return new AS(a._scrollDispatcher,a._viewportRuler,a._ngZone,e)},this._document=r}))).\u0275fac=function(e){return new(e||IS)($e(h_),$e(f_),$e(Su),$e(rc))},IS.\u0275prov=me({factory:function(){return new IS($e(h_),$e(f_),$e(Su),$e(rc))},token:IS,providedIn:"root"}),IS),OS=_createClass((function e(t){if(_classCallCheck(this,e),this.scrollStrategy=new ES,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t)for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];void 0!==t[r]&&(this[r]=t[r])}})),NS=_createClass((function e(t,n,i,r,a){_classCallCheck(this,e),this.offsetX=i,this.offsetY=r,this.panelClass=a,this.originX=t.originX,this.originY=t.originY,this.overlayX=n.overlayX,this.overlayY=n.overlayY})),DS=_createClass((function e(t,n){_classCallCheck(this,e),this.connectionPair=t,this.scrollableViewProperties=n}));function zS(e,t){if("top"!==t&&"bottom"!==t&&"center"!==t)throw Error("ConnectedPosition: Invalid ".concat(e,' "').concat(t,'". Expected "top", "bottom" or "center".'))}function LS(e,t){if("start"!==t&&"end"!==t&&"center"!==t)throw Error("ConnectedPosition: Invalid ".concat(e,' "').concat(t,'". Expected "start", "end" or "center".'))}var BS,FS,jS=((BS=function(){function e(t){var n=this;_classCallCheck(this,e),this._attachedOverlays=[],this._keydownListener=function(e){for(var t=n._attachedOverlays,i=t.length-1;i>-1;i--)if(t[i]._keydownEvents.observers.length>0){t[i]._keydownEvents.next(e);break}},this._document=t}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._detach()}},{key:"add",value:function(e){this.remove(e),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(e)}},{key:"remove",value:function(e){var t=this._attachedOverlays.indexOf(e);t>-1&&this._attachedOverlays.splice(t,1),0===this._attachedOverlays.length&&this._detach()}},{key:"_detach",value:function(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}]),e}()).\u0275fac=function(e){return new(e||BS)($e(rc))},BS.\u0275prov=me({factory:function(){return new BS($e(rc))},token:BS,providedIn:"root"}),BS),HS=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine),VS=((FS=function(){function e(t,n){_classCallCheck(this,e),this._platform=n,this._document=t}return _createClass(e,[{key:"ngOnDestroy",value:function(){var e=this._containerElement;e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"getContainerElement",value:function(){return this._containerElement||this._createContainer(),this._containerElement}},{key:"_createContainer",value:function(){var e=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(e||HS)for(var t=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]'),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);var i=this._document.createElement("div");i.classList.add("cdk-overlay-container"),HS?i.setAttribute("platform","test"):e||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}]),e}()).\u0275fac=function(e){return new(e||FS)($e(rc),$e(by))},FS.\u0275prov=me({factory:function(){return new FS($e(rc),$e(by))},token:FS,providedIn:"root"}),FS),US=function(){function e(t,n,i,r,a,o,s,l){var u=this;_classCallCheck(this,e),this._portalOutlet=t,this._host=n,this._pane=i,this._config=r,this._ngZone=a,this._keyboardDispatcher=o,this._document=s,this._location=l,this._backdropElement=null,this._backdropClick=new I,this._attachments=new I,this._detachments=new I,this._locationChanges=p.EMPTY,this._backdropClickHandler=function(e){return u._backdropClick.next(e)},this._keydownEvents=new I,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}return _createClass(e,[{key:"overlayElement",get:function(){return this._pane}},{key:"backdropElement",get:function(){return this._backdropElement}},{key:"hostElement",get:function(){return this._host}},{key:"attach",value:function(e){var t=this,n=this._portalOutlet.attach(e);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(Yp(1)).subscribe((function(){t.hasAttached()&&t.updatePosition()})),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe((function(){return t.dispose()}))),n}},{key:"detach",value:function(){if(this.hasAttached()){this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();var e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),e}}},{key:"dispose",value:function(){var e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}},{key:"hasAttached",value:function(){return this._portalOutlet.hasAttached()}},{key:"backdropClick",value:function(){return this._backdropClick.asObservable()}},{key:"attachments",value:function(){return this._attachments.asObservable()}},{key:"detachments",value:function(){return this._detachments.asObservable()}},{key:"keydownEvents",value:function(){return this._keydownEvents.asObservable()}},{key:"getConfig",value:function(){return this._config}},{key:"updatePosition",value:function(){this._positionStrategy&&this._positionStrategy.apply()}},{key:"updatePositionStrategy",value:function(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}},{key:"updateSize",value:function(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}},{key:"setDirection",value:function(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}},{key:"addPanelClass",value:function(e){this._pane&&this._toggleClasses(this._pane,e,!0)}},{key:"removePanelClass",value:function(e){this._pane&&this._toggleClasses(this._pane,e,!1)}},{key:"getDirection",value:function(){var e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}},{key:"updateScrollStrategy",value:function(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}},{key:"_updateElementDirection",value:function(){this._host.setAttribute("dir",this.getDirection())}},{key:"_updateElementSize",value:function(){if(this._pane){var e=this._pane.style;e.width=Ay(this._config.width),e.height=Ay(this._config.height),e.minWidth=Ay(this._config.minWidth),e.minHeight=Ay(this._config.minHeight),e.maxWidth=Ay(this._config.maxWidth),e.maxHeight=Ay(this._config.maxHeight)}}},{key:"_togglePointerEvents",value:function(e){this._pane.style.pointerEvents=e?"auto":"none"}},{key:"_attachBackdrop",value:function(){var e=this;this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){e._backdropElement&&e._backdropElement.classList.add("cdk-overlay-backdrop-showing")}))})):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}},{key:"_updateStackingOrder",value:function(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}},{key:"detachBackdrop",value:function(){var e,t=this,n=this._backdropElement;if(n){var i=function i(){n&&(n.removeEventListener("click",t._backdropClickHandler),n.removeEventListener("transitionend",i),n.parentNode&&n.parentNode.removeChild(n)),t._backdropElement==n&&(t._backdropElement=null),t._config.backdropClass&&t._toggleClasses(n,t._config.backdropClass,!1),clearTimeout(e)};n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular((function(){n.addEventListener("transitionend",i)})),n.style.pointerEvents="none",e=this._ngZone.runOutsideAngular((function(){return setTimeout(i,500)}))}}},{key:"_toggleClasses",value:function(e,t,n){var i=e.classList;Iy(t).forEach((function(e){e&&(n?i.add(e):i.remove(e))}))}},{key:"_detachContentWhenStable",value:function(){var e=this;this._ngZone.runOutsideAngular((function(){var t=e._ngZone.onStable.asObservable().pipe(Ky(J(e._attachments,e._detachments))).subscribe((function(){e._pane&&e._host&&0!==e._pane.children.length||(e._pane&&e._config.panelClass&&e._toggleClasses(e._pane,e._config.panelClass,!1),e._host&&e._host.parentElement&&(e._previousHostParent=e._host.parentElement,e._previousHostParent.removeChild(e._host)),t.unsubscribe())}))}))}},{key:"_disposeScrollStrategy",value:function(){var e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}]),e}(),qS=/([A-Za-z%]+)$/,GS=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this._viewportRuler=n,this._document=i,this._platform=r,this._overlayContainer=a,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new I,this._resizeSubscription=p.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}return _createClass(e,[{key:"positions",get:function(){return this._preferredPositions}},{key:"attach",value:function(e){var t=this;if(this._overlayRef&&e!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),e.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe((function(){t._isInitialRender=!0,t.apply()}))}},{key:"apply",value:function(){if(!this._isDisposed&&this._platform.isBrowser)if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)this.reapplyLastPosition();else{this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();var e,t,n=this._originRect,i=this._overlayRect,r=this._viewportRect,a=[],o=_createForOfIteratorHelper(this._preferredPositions);try{for(o.s();!(t=o.n()).done;){var s=t.value,l=this._getOriginPoint(n,s),u=this._getOverlayPoint(l,i,s),c=this._getOverlayFit(u,i,r,s);if(c.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(s,l);this._canFitWithFlexibleDimensions(c,u,r)?a.push({position:s,origin:l,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(l,s)}):(!e||e.overlayFit.visibleArea<c.visibleArea)&&(e={overlayFit:c,overlayPoint:u,originPoint:l,position:s,overlayRect:i})}}catch(g){o.e(g)}finally{o.f()}if(a.length){var h,d=null,f=-1,p=_createForOfIteratorHelper(a);try{for(p.s();!(h=p.n()).done;){var m=h.value,v=m.boundingBoxRect.width*m.boundingBoxRect.height*(m.position.weight||1);v>f&&(f=v,d=m)}}catch(g){p.e(g)}finally{p.f()}return this._isPushed=!1,void this._applyPosition(d.position,d.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(e.position,e.originPoint);this._applyPosition(e.position,e.originPoint)}}},{key:"detach",value:function(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}},{key:"dispose",value:function(){this._isDisposed||(this._boundingBox&&WS(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}},{key:"reapplyLastPosition",value:function(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();var e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}},{key:"withScrollableContainers",value:function(e){return this._scrollables=e,this}},{key:"withPositions",value:function(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}},{key:"withViewportMargin",value:function(e){return this._viewportMargin=e,this}},{key:"withFlexibleDimensions",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._hasFlexibleDimensions=e,this}},{key:"withGrowAfterOpen",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._growAfterOpen=e,this}},{key:"withPush",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._canPush=e,this}},{key:"withLockedPosition",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._positionLocked=e,this}},{key:"setOrigin",value:function(e){return this._origin=e,this}},{key:"withDefaultOffsetX",value:function(e){return this._offsetX=e,this}},{key:"withDefaultOffsetY",value:function(e){return this._offsetY=e,this}},{key:"withTransformOriginOn",value:function(e){return this._transformOriginSelector=e,this}},{key:"_getOriginPoint",value:function(e,t){var n;if("center"==t.originX)n=e.left+e.width/2;else{var i=this._isRtl()?e.right:e.left,r=this._isRtl()?e.left:e.right;n="start"==t.originX?i:r}return{x:n,y:"center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom}}},{key:"_getOverlayPoint",value:function(e,t,n){var i,r;return i="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,r="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+i,y:e.y+r}}},{key:"_getOverlayFit",value:function(e,t,n,i){var r=e.x,a=e.y,o=this._getOffset(i,"x"),s=this._getOffset(i,"y");o&&(r+=o),s&&(a+=s);var l=0-a,u=a+t.height-n.height,c=this._subtractOverflows(t.width,0-r,r+t.width-n.width),h=this._subtractOverflows(t.height,l,u),d=c*h;return{visibleArea:d,isCompletelyWithinViewport:t.width*t.height===d,fitsInViewportVertically:h===t.height,fitsInViewportHorizontally:c==t.width}}},{key:"_canFitWithFlexibleDimensions",value:function(e,t,n){if(this._hasFlexibleDimensions){var i=n.bottom-t.y,r=n.right-t.x,a=ZS(this._overlayRef.getConfig().minHeight),o=ZS(this._overlayRef.getConfig().minWidth),s=e.fitsInViewportHorizontally||null!=o&&o<=r;return(e.fitsInViewportVertically||null!=a&&a<=i)&&s}return!1}},{key:"_pushOverlayOnScreen",value:function(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};var i,r,a=this._viewportRect,o=Math.max(e.x+t.width-a.right,0),s=Math.max(e.y+t.height-a.bottom,0),l=Math.max(a.top-n.top-e.y,0),u=Math.max(a.left-n.left-e.x,0);return i=t.width<=a.width?u||-o:e.x<this._viewportMargin?a.left-n.left-e.x:0,r=t.height<=a.height?l||-s:e.y<this._viewportMargin?a.top-n.top-e.y:0,this._previousPushAmount={x:i,y:r},{x:e.x+i,y:e.y+r}}},{key:"_applyPosition",value:function(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){var n=this._getScrollVisibility(),i=new DS(e,n);this._positionChanges.next(i)}this._isInitialRender=!1}},{key:"_setTransformOrigin",value:function(e){if(this._transformOriginSelector){var t,n=this._boundingBox.querySelectorAll(this._transformOriginSelector),i=e.overlayY;t="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(var r=0;r<n.length;r++)n[r].style.transformOrigin="".concat(t," ").concat(i)}}},{key:"_calculateBoundingBoxRect",value:function(e,t){var n,i,r,a,o,s,l=this._viewportRect,u=this._isRtl();if("top"===t.overlayY)i=e.y,n=l.height-i+this._viewportMargin;else if("bottom"===t.overlayY)r=l.height-e.y+2*this._viewportMargin,n=l.height-r+this._viewportMargin;else{var c=Math.min(l.bottom-e.y+l.top,e.y),h=this._lastBoundingBoxSize.height;n=2*c,i=e.y-c,n>h&&!this._isInitialRender&&!this._growAfterOpen&&(i=e.y-h/2)}if("end"===t.overlayX&&!u||"start"===t.overlayX&&u)s=l.width-e.x+this._viewportMargin,a=e.x-this._viewportMargin;else if("start"===t.overlayX&&!u||"end"===t.overlayX&&u)o=e.x,a=l.right-e.x;else{var d=Math.min(l.right-e.x+l.left,e.x),f=this._lastBoundingBoxSize.width;a=2*d,o=e.x-d,a>f&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.x-f/2)}return{top:i,left:o,bottom:r,right:s,width:a,height:n}}},{key:"_setBoundingBoxStyles",value:function(e,t){var n=this._calculateBoundingBoxRect(e,t);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));var i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{var r=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;i.height=Ay(n.height),i.top=Ay(n.top),i.bottom=Ay(n.bottom),i.width=Ay(n.width),i.left=Ay(n.left),i.right=Ay(n.right),i.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",i.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",r&&(i.maxHeight=Ay(r)),a&&(i.maxWidth=Ay(a))}this._lastBoundingBoxSize=n,WS(this._boundingBox.style,i)}},{key:"_resetBoundingBoxStyles",value:function(){WS(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}},{key:"_resetOverlayElementStyles",value:function(){WS(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}},{key:"_setOverlayElementStyles",value:function(e,t){var n={},i=this._hasExactPosition(),r=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(i){var o=this._viewportRuler.getViewportScrollPosition();WS(n,this._getExactOverlayY(t,e,o)),WS(n,this._getExactOverlayX(t,e,o))}else n.position="static";var s="",l=this._getOffset(t,"x"),u=this._getOffset(t,"y");l&&(s+="translateX(".concat(l,"px) ")),u&&(s+="translateY(".concat(u,"px)")),n.transform=s.trim(),a.maxHeight&&(i?n.maxHeight=Ay(a.maxHeight):r&&(n.maxHeight="")),a.maxWidth&&(i?n.maxWidth=Ay(a.maxWidth):r&&(n.maxWidth="")),WS(this._pane.style,n)}},{key:"_getExactOverlayY",value:function(e,t,n){var i={top:"",bottom:""},r=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n));var a=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return r.y-=a,"bottom"===e.overlayY?i.bottom=this._document.documentElement.clientHeight-(r.y+this._overlayRect.height)+"px":i.top=Ay(r.y),i}},{key:"_getExactOverlayX",value:function(e,t,n){var i={left:"",right:""},r=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,n)),"right"===(this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left")?i.right=this._document.documentElement.clientWidth-(r.x+this._overlayRect.width)+"px":i.left=Ay(r.x),i}},{key:"_getScrollVisibility",value:function(){var e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map((function(e){return e.getElementRef().nativeElement.getBoundingClientRect()}));return{isOriginClipped:MS(e,n),isOriginOutsideView:PS(e,n),isOverlayClipped:MS(t,n),isOverlayOutsideView:PS(t,n)}}},{key:"_subtractOverflows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((function(e,t){return e-Math.max(t,0)}),e)}},{key:"_getNarrowedViewportRect",value:function(){var e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}},{key:"_isRtl",value:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"_hasExactPosition",value:function(){return!this._hasFlexibleDimensions||this._isPushed}},{key:"_getOffset",value:function(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}},{key:"_validatePositions",value:function(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach((function(e){LS("originX",e.originX),zS("originY",e.originY),LS("overlayX",e.overlayX),zS("overlayY",e.overlayY)}))}},{key:"_addPanelClasses",value:function(e){var t=this;this._pane&&Iy(e).forEach((function(e){""!==e&&-1===t._appliedPanelClasses.indexOf(e)&&(t._appliedPanelClasses.push(e),t._pane.classList.add(e))}))}},{key:"_clearPanelClasses",value:function(){var e=this;this._pane&&(this._appliedPanelClasses.forEach((function(t){e._pane.classList.remove(t)})),this._appliedPanelClasses=[])}},{key:"_getOriginRect",value:function(){var e=this._origin;if(e instanceof Vs)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();var t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}]),e}();function WS(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function ZS(e){if("number"!=typeof e&&null!=e){var t=_slicedToArray(e.split(qS),2),n=t[0],i=t[1];return i&&"px"!==i?null:parseFloat(n)}return e||null}var XS,KS,YS,JS,QS,$S,eT,tT=function(){function e(t,n,i,r,a,o,s){_classCallCheck(this,e),this._preferredPositions=[],this._positionStrategy=new GS(i,r,a,o,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,n)}return _createClass(e,[{key:"_isRtl",get:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"onPositionChange",get:function(){return this._positionStrategy.positionChanges}},{key:"positions",get:function(){return this._preferredPositions}},{key:"attach",value:function(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}},{key:"dispose",value:function(){this._positionStrategy.dispose()}},{key:"detach",value:function(){this._positionStrategy.detach()}},{key:"apply",value:function(){this._positionStrategy.apply()}},{key:"recalculateLastPosition",value:function(){this._positionStrategy.reapplyLastPosition()}},{key:"withScrollableContainers",value:function(e){this._positionStrategy.withScrollableContainers(e)}},{key:"withFallbackPosition",value:function(e,t,n,i){var r=new NS(e,t,n,i);return this._preferredPositions.push(r),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"withDirection",value:function(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}},{key:"withOffsetX",value:function(e){return this._positionStrategy.withDefaultOffsetX(e),this}},{key:"withOffsetY",value:function(e){return this._positionStrategy.withDefaultOffsetY(e),this}},{key:"withLockedPosition",value:function(e){return this._positionStrategy.withLockedPosition(e),this}},{key:"withPositions",value:function(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"setOrigin",value:function(e){return this._positionStrategy.setOrigin(e),this}}]),e}(),nT=function(){function e(){_classCallCheck(this,e),this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}return _createClass(e,[{key:"attach",value:function(e){var t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}},{key:"top",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}},{key:"left",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}},{key:"bottom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}},{key:"right",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}},{key:"width",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}},{key:"height",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}},{key:"centerHorizontally",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.left(e),this._justifyContent="center",this}},{key:"centerVertically",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.top(e),this._alignItems="center",this}},{key:"apply",value:function(){if(this._overlayRef&&this._overlayRef.hasAttached()){var e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),i=n.width,r=n.height,a=n.maxWidth,o=n.maxHeight,s=!("100%"!==i&&"100vw"!==i||a&&"100%"!==a&&"100vw"!==a),l=!("100%"!==r&&"100vh"!==r||o&&"100%"!==o&&"100vh"!==o);e.position=this._cssPosition,e.marginLeft=s?"0":this._leftOffset,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,s?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=l?"flex-start":this._alignItems}}},{key:"dispose",value:function(){if(!this._isDisposed&&this._overlayRef){var e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}}]),e}(),iT=((KS=function(){function e(t,n,i,r){_classCallCheck(this,e),this._viewportRuler=t,this._document=n,this._platform=i,this._overlayContainer=r}return _createClass(e,[{key:"global",value:function(){return new nT}},{key:"connectedTo",value:function(e,t,n){return new tT(t,n,e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}},{key:"flexibleConnectedTo",value:function(e){return new GS(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}]),e}()).\u0275fac=function(e){return new(e||KS)($e(f_),$e(rc),$e(by),$e(VS))},KS.\u0275prov=me({factory:function(){return new KS($e(f_),$e(rc),$e(by),$e(VS))},token:KS,providedIn:"root"}),KS),rT=0,aT=((XS=function(){function e(t,n,i,r,a,o,s,l,u,c){_classCallCheck(this,e),this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=i,this._positionBuilder=r,this._keyboardDispatcher=a,this._injector=o,this._ngZone=s,this._document=l,this._directionality=u,this._location=c}return _createClass(e,[{key:"create",value:function(e){var t=this._createHostElement(),n=this._createPaneElement(t),i=this._createPortalOutlet(n),r=new OS(e);return r.direction=r.direction||this._directionality.value,new US(i,t,n,r,this._ngZone,this._keyboardDispatcher,this._document,this._location)}},{key:"position",value:function(){return this._positionBuilder}},{key:"_createPaneElement",value:function(e){var t=this._document.createElement("div");return t.id="cdk-overlay-"+rT++,t.classList.add("cdk-overlay-pane"),e.appendChild(t),t}},{key:"_createHostElement",value:function(){var e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}},{key:"_createPortalOutlet",value:function(e){return this._appRef||(this._appRef=this._injector.get(Gu)),new gS(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}]),e}()).\u0275fac=function(e){return new(e||XS)($e(RS),$e(VS),$e(Hs),$e(iT),$e(jS),$e(so),$e(Su),$e(rc),$e(s_),$e(Cc,8))},XS.\u0275prov=me({token:XS,factory:XS.\u0275fac}),XS),oT=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],sT=new qe("cdk-connected-overlay-scroll-strategy"),lT=((JS=_createClass((function e(t){_classCallCheck(this,e),this.elementRef=t}))).\u0275fac=function(e){return new(e||JS)(To(Vs))},JS.\u0275dir=Ct({type:JS,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),JS),uT=((YS=function(){function e(t,n,i,r,a){_classCallCheck(this,e),this._overlay=t,this._dir=a,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=p.EMPTY,this.viewportMargin=0,this.open=!1,this.backdropClick=new Dl,this.positionChange=new Dl,this.attach=new Dl,this.detach=new Dl,this.overlayKeydown=new Dl,this._templatePortal=new pS(n,i),this._scrollStrategyFactory=r,this.scrollStrategy=this._scrollStrategyFactory()}return _createClass(e,[{key:"offsetX",get:function(){return this._offsetX},set:function(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}},{key:"offsetY",get:function(){return this._offsetY},set:function(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}},{key:"hasBackdrop",get:function(){return this._hasBackdrop},set:function(e){this._hasBackdrop=Py(e)}},{key:"lockPosition",get:function(){return this._lockPosition},set:function(e){this._lockPosition=Py(e)}},{key:"flexibleDimensions",get:function(){return this._flexibleDimensions},set:function(e){this._flexibleDimensions=Py(e)}},{key:"growAfterOpen",get:function(){return this._growAfterOpen},set:function(e){this._growAfterOpen=Py(e)}},{key:"push",get:function(){return this._push},set:function(e){this._push=Py(e)}},{key:"overlayRef",get:function(){return this._overlayRef}},{key:"dir",get:function(){return this._dir?this._dir.value:"ltr"}},{key:"ngOnDestroy",value:function(){this._overlayRef&&this._overlayRef.dispose(),this._backdropSubscription.unsubscribe()}},{key:"ngOnChanges",value:function(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}},{key:"_createOverlay",value:function(){var e=this;this.positions&&this.positions.length||(this.positions=oT),this._overlayRef=this._overlay.create(this._buildConfig()),this._overlayRef.keydownEvents().subscribe((function(t){e.overlayKeydown.next(t),27!==t.keyCode||v_(t)||(t.preventDefault(),e._detachOverlay())}))}},{key:"_buildConfig",value:function(){var e=this._position=this.positionStrategy||this._createPositionStrategy(),t=new OS({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(t.width=this.width),(this.height||0===this.height)&&(t.height=this.height),(this.minWidth||0===this.minWidth)&&(t.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(t.minHeight=this.minHeight),this.backdropClass&&(t.backdropClass=this.backdropClass),this.panelClass&&(t.panelClass=this.panelClass),t}},{key:"_updatePositionStrategy",value:function(e){var t=this,n=this.positions.map((function(e){return{originX:e.originX,originY:e.originY,overlayX:e.overlayX,overlayY:e.overlayY,offsetX:e.offsetX||t.offsetX,offsetY:e.offsetY||t.offsetY,panelClass:e.panelClass||void 0}}));return e.setOrigin(this.origin.elementRef).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}},{key:"_createPositionStrategy",value:function(){var e=this,t=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(t),t.positionChanges.subscribe((function(t){return e.positionChange.emit(t)})),t}},{key:"_attachOverlay",value:function(){var e=this;this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||(this._overlayRef.attach(this._templatePortal),this.attach.emit()),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe((function(t){e.backdropClick.emit(t)})):this._backdropSubscription.unsubscribe()}},{key:"_detachOverlay",value:function(){this._overlayRef&&(this._overlayRef.detach(),this.detach.emit()),this._backdropSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||YS)(To(aT),To(dl),To(pl),To(sT),To(s_,8))},YS.\u0275dir=Ct({type:YS,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown"},exportAs:["cdkConnectedOverlay"],features:[Es]}),YS),cT={provide:sT,deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition()}}},hT=((QS=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:QS}),QS.\u0275inj=ve({factory:function(e){return new(e||QS)},providers:[aT,cT],imports:[[l_,wS,m_],m_]}),QS),dT=function(){function e(t){_classCallCheck(this,e),this.total=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new fT(e,this.total))}}]),e}(),fT=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).total=n,i.count=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){++this.count>this.total&&this.destination.next(e)}}]),t}(g),pT=new Set,mT=((eT=function(){function e(t){_classCallCheck(this,e),this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):vT}return _createClass(e,[{key:"matchMedia",value:function(e){return this._platform.WEBKIT&&function(e){if(!pT.has(e))try{$S||(($S=document.createElement("style")).setAttribute("type","text/css"),document.head.appendChild($S)),$S.sheet&&($S.sheet.insertRule("@media ".concat(e," {.fx-query-test{ }}"),0),pT.add(e))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}]),e}()).\u0275fac=function(e){return new(e||eT)($e(by))},eT.\u0275prov=me({factory:function(){return new eT($e(by))},token:eT,providedIn:"root"}),eT);function vT(e){return{matches:"all"===e||""===e,media:e,addListener:function(){},removeListener:function(){}}}var gT,yT=((gT=function(){function e(t,n){_classCallCheck(this,e),this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new I}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._destroySubject.next(),this._destroySubject.complete()}},{key:"isMatched",value:function(e){var t=this;return _T(Iy(e)).some((function(e){return t._registerQuery(e).mql.matches}))}},{key:"observe",value:function(e){var t=this,n=Sp(_T(Iy(e)).map((function(e){return t._registerQuery(e).observable})));return(n=am(n.pipe(Yp(1)),n.pipe((function(e){return e.lift(new dT(1))}),g_(0)))).pipe(H((function(e){var t={matches:!1,breakpoints:{}};return e.forEach((function(e){t.matches=t.matches||e.matches,t.breakpoints[e.query]=e.matches})),t})))}},{key:"_registerQuery",value:function(e){var t=this;if(this._queries.has(e))return this._queries.get(e);var n=this._mediaMatcher.matchMedia(e),i={observable:new C((function(e){var i=function(n){return t._zone.run((function(){return e.next(n)}))};return n.addListener(i),function(){n.removeListener(i)}})).pipe(om(n),H((function(t){return{query:e,matches:t.matches}})),Ky(this._destroySubject)),mql:n};return this._queries.set(e,i),i}}]),e}()).\u0275fac=function(e){return new(e||gT)($e(mT),$e(Su))},gT.\u0275prov=me({factory:function(){return new gT($e(mT),$e(Su))},token:gT,providedIn:"root"}),gT);function _T(e){return e.map((function(e){return e.split(",")})).reduce((function(e,t){return e.concat(t)})).map((function(e){return e.trim()}))}var xT,bT={tooltipState:Wh("state",[Yh("initial, void, hidden",Kh({opacity:0,transform:"scale(0)"})),Yh("visible",Kh({transform:"scale(1)"})),Jh("* => visible",Zh("200ms cubic-bezier(0, 0, 0.2, 1)",(xT=[Kh({opacity:0,transform:"scale(0)",offset:0}),Kh({opacity:.5,transform:"scale(0.99)",offset:.5}),Kh({opacity:1,transform:"scale(1)",offset:1})],{type:5,steps:xT}))),Jh("* => hidden",Zh("100ms cubic-bezier(0, 0, 0.2, 1)",Kh({opacity:0})))])},wT=Sy({passive:!0});function kT(e){return Error('Tooltip position "'.concat(e,'" is invalid.'))}var CT,ST,TT,ET,PT,MT=new qe("mat-tooltip-scroll-strategy"),IT={provide:MT,deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition({scrollThrottle:20})}}},AT=new qe("mat-tooltip-default-options",{providedIn:"root",factory:function(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),RT=((TT=function(){function e(t,n,i,r,a,o,s,l,u,c,h,d){var f=this;_classCallCheck(this,e),this._overlay=t,this._elementRef=n,this._scrollDispatcher=i,this._viewContainerRef=r,this._ngZone=a,this._platform=o,this._ariaDescriber=s,this._focusMonitor=l,this._dir=c,this._defaultOptions=h,this._position="below",this._disabled=!1,this.showDelay=this._defaultOptions.showDelay,this.hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=new Map,this._destroyed=new I,this._handleKeydown=function(e){f._isTooltipVisible()&&27===e.keyCode&&!v_(e)&&(e.preventDefault(),e.stopPropagation(),f._ngZone.run((function(){return f.hide(0)})))},this._scrollStrategy=u,h&&(h.position&&(this.position=h.position),h.touchGestures&&(this.touchGestures=h.touchGestures)),l.monitor(n).pipe(Ky(this._destroyed)).subscribe((function(e){e?"keyboard"===e&&a.run((function(){return f.show()})):a.run((function(){return f.hide(0)}))})),a.runOutsideAngular((function(){n.nativeElement.addEventListener("keydown",f._handleKeydown)}))}return _createClass(e,[{key:"position",get:function(){return this._position},set:function(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(),this._tooltipInstance&&this._tooltipInstance.show(0),this._overlayRef.updatePosition()))}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e),this._disabled&&this.hide(0)}},{key:"message",get:function(){return this._message},set:function(e){var t=this;this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message),this._message=null!=e?(""+e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._updateTooltipMessage(),this._ngZone.runOutsideAngular((function(){Promise.resolve().then((function(){t._ariaDescriber.describe(t._elementRef.nativeElement,t.message)}))})))}},{key:"tooltipClass",get:function(){return this._tooltipClass},set:function(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}},{key:"ngOnInit",value:function(){this._setupPointerEvents()}},{key:"ngOnDestroy",value:function(){var e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),e.removeEventListener("keydown",this._handleKeydown),this._passiveListeners.forEach((function(t,n){e.removeEventListener(n,t,wT)})),this._passiveListeners.clear(),this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message),this._focusMonitor.stopMonitoring(e)}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.showDelay;if(!this.disabled&&this.message&&(!this._isTooltipVisible()||this._tooltipInstance._showTimeoutId||this._tooltipInstance._hideTimeoutId)){var n=this._createOverlay();this._detach(),this._portal=this._portal||new fS(OT,this._viewContainerRef),this._tooltipInstance=n.attach(this._portal).instance,this._tooltipInstance.afterHidden().pipe(Ky(this._destroyed)).subscribe((function(){return e._detach()})),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),this._tooltipInstance.show(t)}}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hideDelay;this._tooltipInstance&&this._tooltipInstance.hide(e)}},{key:"toggle",value:function(){this._isTooltipVisible()?this.hide():this.show()}},{key:"_isTooltipVisible",value:function(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}},{key:"_createOverlay",value:function(){var e=this;if(this._overlayRef)return this._overlayRef;var t=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),n=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(".mat-tooltip").withFlexibleDimensions(!1).withViewportMargin(8).withScrollableContainers(t);return n.positionChanges.pipe(Ky(this._destroyed)).subscribe((function(t){e._tooltipInstance&&t.scrollableViewProperties.isOverlayClipped&&e._tooltipInstance.isVisible()&&e._ngZone.run((function(){return e.hide(0)}))})),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:n,panelClass:"mat-tooltip-panel",scrollStrategy:this._scrollStrategy()}),this._updatePosition(),this._overlayRef.detachments().pipe(Ky(this._destroyed)).subscribe((function(){return e._detach()})),this._overlayRef}},{key:"_detach",value:function(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}},{key:"_updatePosition",value:function(){var e=this._overlayRef.getConfig().positionStrategy,t=this._getOrigin(),n=this._getOverlayPosition();e.withPositions([Object.assign(Object.assign({},t.main),n.main),Object.assign(Object.assign({},t.fallback),n.fallback)])}},{key:"_getOrigin",value:function(){var e,t=!this._dir||"ltr"==this._dir.value,n=this.position;if("above"==n||"below"==n)e={originX:"center",originY:"above"==n?"top":"bottom"};else if("before"==n||"left"==n&&t||"right"==n&&!t)e={originX:"start",originY:"center"};else{if(!("after"==n||"right"==n&&t||"left"==n&&!t))throw kT(n);e={originX:"end",originY:"center"}}var i=this._invertPosition(e.originX,e.originY);return{main:e,fallback:{originX:i.x,originY:i.y}}}},{key:"_getOverlayPosition",value:function(){var e,t=!this._dir||"ltr"==this._dir.value,n=this.position;if("above"==n)e={overlayX:"center",overlayY:"bottom"};else if("below"==n)e={overlayX:"center",overlayY:"top"};else if("before"==n||"left"==n&&t||"right"==n&&!t)e={overlayX:"end",overlayY:"center"};else{if(!("after"==n||"right"==n&&t||"left"==n&&!t))throw kT(n);e={overlayX:"start",overlayY:"center"}}var i=this._invertPosition(e.overlayX,e.overlayY);return{main:e,fallback:{overlayX:i.x,overlayY:i.y}}}},{key:"_updateTooltipMessage",value:function(){var e=this;this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.asObservable().pipe(Yp(1),Ky(this._destroyed)).subscribe((function(){e._tooltipInstance&&e._overlayRef.updatePosition()})))}},{key:"_setTooltipClass",value:function(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}},{key:"_invertPosition",value:function(e,t){return"above"===this.position||"below"===this.position?"top"===t?t="bottom":"bottom"===t&&(t="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:t}}},{key:"_setupPointerEvents",value:function(){var e=this;if(this._platform.IOS||this._platform.ANDROID){if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();var t=function(){clearTimeout(e._touchstartTimeout),e.hide(e._defaultOptions.touchendHideDelay)};this._passiveListeners.set("touchend",t).set("touchcancel",t).set("touchstart",(function(){clearTimeout(e._touchstartTimeout),e._touchstartTimeout=setTimeout((function(){return e.show()}),500)}))}}else this._passiveListeners.set("mouseenter",(function(){return e.show()})).set("mouseleave",(function(){return e.hide()}));this._passiveListeners.forEach((function(t,n){e._elementRef.nativeElement.addEventListener(n,t,wT)}))}},{key:"_disableNativeGesturesIfNecessary",value:function(){var e=this._elementRef.nativeElement,t=e.style,n=this.touchGestures;"off"!==n&&(("on"===n||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName)&&(t.userSelect=t.msUserSelect=t.webkitUserSelect=t.MozUserSelect="none"),"on"!==n&&e.draggable||(t.webkitUserDrag="none"),t.touchAction="none",t.webkitTapHighlightColor="transparent")}}]),e}()).\u0275fac=function(e){return new(e||TT)(To(aT),To(Vs),To(h_),To(pl),To(Su),To(by),To(D_),To($_),To(MT),To(s_,8),To(AT,8),To(Vs))},TT.\u0275dir=Ct({type:TT,selectors:[["","matTooltip",""]],inputs:{showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]}),TT),OT=((ST=function(){function e(t,n){_classCallCheck(this,e),this._changeDetectorRef=t,this._breakpointObserver=n,this._visibility="initial",this._closeOnInteraction=!1,this._onHide=new I,this._isHandset=this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)")}return _createClass(e,[{key:"show",value:function(e){var t=this;this._hideTimeoutId&&(clearTimeout(this._hideTimeoutId),this._hideTimeoutId=null),this._closeOnInteraction=!0,this._showTimeoutId=setTimeout((function(){t._visibility="visible",t._showTimeoutId=null,t._markForCheck()}),e)}},{key:"hide",value:function(e){var t=this;this._showTimeoutId&&(clearTimeout(this._showTimeoutId),this._showTimeoutId=null),this._hideTimeoutId=setTimeout((function(){t._visibility="hidden",t._hideTimeoutId=null,t._markForCheck()}),e)}},{key:"afterHidden",value:function(){return this._onHide.asObservable()}},{key:"isVisible",value:function(){return"visible"===this._visibility}},{key:"ngOnDestroy",value:function(){this._onHide.complete()}},{key:"_animationStart",value:function(){this._closeOnInteraction=!1}},{key:"_animationDone",value:function(e){var t=e.toState;"hidden"!==t||this.isVisible()||this._onHide.next(),"visible"!==t&&"hidden"!==t||(this._closeOnInteraction=!0)}},{key:"_handleBodyInteraction",value:function(){this._closeOnInteraction&&this.hide(0)}},{key:"_markForCheck",value:function(){this._changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||ST)(To(Ga),To(yT))},ST.\u0275cmp=yt({type:ST,selectors:[["mat-tooltip-component"]],hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,t){1&e&&Fo("click",(function(){return t._handleBodyInteraction()}),!1,Wn),2&e&&is("zoom","visible"===t._visibility?1:null)},decls:3,vars:7,consts:[[1,"mat-tooltip",3,"ngClass"]],template:function(e,t){var n,i,r,a;1&e&&(Ao(0,"div",0),Fo("@state.start",(function(){return t._animationStart()}))("@state.done",(function(e){return t._animationDone(e)})),function(e,t){var n,i=$t();i.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var i=t[n];if("async"===i.name)return i}throw new Error("The pipe 'async' could not be found!")}(0,i.pipeRegistry),i.data[21]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(21,n.onDestroy)):n=i.data[21];var r=n.factory||(n.factory=Tt(n.type)),a=Je(To),o=Kn(!1),s=r();Kn(o),Je(a),function(e,t,n,i){21>=e.data.length&&(e.data[21]=null,e.blueprint[21]=null),t[21]=i}(i,Qt(),0,s)}(),ms(2),Ro()),2&e&&(rs("mat-tooltip-handset",null==(i=t._isHandset,r=Qt(),a=Vt(r,1),n=function(e,t){return go.isWrapped(t)&&(t=go.unwrap(t),e[Yt.lFrame.bindingIndex]=fr),t}(r,function(e,t){return e[1].data[21].pure}(r)?Nl(r,ln(),5,a.transform,i,a):a.transform(i)))?null:n.matches),Mo("ngClass",t.tooltipClass)("@state",t._visibility),yr(2),vs(t.message))},directives:[Dc],pipes:[oh],styles:[".mat-tooltip-panel{pointer-events:none !important}.mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}\n"],encapsulation:2,data:{animation:[bT.tooltipState]},changeDetection:0}),ST),NT=((CT=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:CT}),CT.\u0275inj=ve({factory:function(e){return new(e||CT)},providers:[IT],imports:[[ox,sh,hT,mx],mx,p_]}),CT),DT=["mat-button",""],zT=["*"],LT=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],BT=gx(vx(yx(_createClass((function e(t){_classCallCheck(this,e),this._elementRef=t}))))),FT=((PT=function(e){function t(e,n,i){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e]))._focusMonitor=n,r._animationMode=i,r.isRoundButton=r._hasHostAttributes("mat-fab","mat-mini-fab"),r.isIconButton=r._hasHostAttributes("mat-icon-button");var a,o=_createForOfIteratorHelper(LT);try{for(o.s();!(a=o.n()).done;){var s=a.value;r._hasHostAttributes(s)&&r._getHostElement().classList.add(s)}}catch(l){o.e(l)}finally{o.f()}return e.nativeElement.classList.add("mat-button-base"),r._focusMonitor.monitor(r._elementRef,!0),r.isRoundButton&&(r.color="accent"),r}return _inherits(t,e),_createClass(t,[{key:"ngOnDestroy",value:function(){this._focusMonitor.stopMonitoring(this._elementRef)}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"program",t=arguments.length>1?arguments[1]:void 0;this._focusMonitor.focusVia(this._getHostElement(),e,t)}},{key:"_getHostElement",value:function(){return this._elementRef.nativeElement}},{key:"_isRippleDisabled",value:function(){return this.disableRipple||this.disabled}},{key:"_hasHostAttributes",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.some((function(t){return e._getHostElement().hasAttribute(t)}))}}]),t}(BT)).\u0275fac=function(e){return new(e||PT)(To(Vs),To($_),To(yp,8))},PT.\u0275cmp=yt({type:PT,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,t){var n;1&e&&Xl(nb,!0),2&e&&Wl(n=$l())&&(t.ripple=n.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:3,hostBindings:function(e,t){2&e&&(wo("disabled",t.disabled||null),rs("_mat-animation-noopable","NoopAnimations"===t._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[bs],attrs:DT,ngContentSelectors:zT,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,t){1&e&&(Wo(),Ao(0,"span",0),Zo(1),Ro(),Oo(2,"div",1),Oo(3,"div",2)),2&e&&(yr(2),rs("mat-button-ripple-round",t.isRoundButton||t.isIconButton),Mo("matRippleDisabled",t._isRippleDisabled())("matRippleCentered",t.isIconButton)("matRippleTrigger",t._getHostElement()))},directives:[nb],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),PT),jT=((ET=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:ET}),ET.\u0275inj=ve({factory:function(e){return new(e||ET)},imports:[[ib,mx],mx]}),ET);function HT(e,t){1&e&&Zo(0)}var VT=["*"];function UT(e,t){}var qT=function(e){return{animationDuration:e}},GT=function(e,t){return{value:e,params:t}},WT=["tabBodyWrapper"],ZT=["tabHeader"];function XT(e,t){}function KT(e,t){1&e&&Co(0,XT,0,0,"ng-template",9),2&e&&Mo("cdkPortalOutlet",qo().$implicit.templateLabel)}function YT(e,t){1&e&&ms(0),2&e&&vs(qo().$implicit.textLabel)}function JT(e,t){if(1&e){var n=zo();Ao(0,"div",6),Fo("click",(function(){en(n);var e=t.$implicit,i=t.index,r=qo(),a=So(1);return r._handleClick(e,a,i)})),Ao(1,"div",7),Co(2,KT,1,1,"ng-template",8),Co(3,YT,1,1,"ng-template",8),Ro(),Ro()}if(2&e){var i=t.$implicit,r=t.index,a=qo();rs("mat-tab-label-active",a.selectedIndex==r),Mo("id",a._getTabLabelId(r))("disabled",i.disabled)("matRippleDisabled",i.disabled||a.disableRipple),wo("tabIndex",a._getTabIndex(i,r))("aria-posinset",r+1)("aria-setsize",a._tabs.length)("aria-controls",a._getTabContentId(r))("aria-selected",a.selectedIndex==r)("aria-label",i.ariaLabel||null)("aria-labelledby",!i.ariaLabel&&i.ariaLabelledby?i.ariaLabelledby:null),yr(2),Mo("ngIf",i.templateLabel),yr(1),Mo("ngIf",!i.templateLabel)}}function QT(e,t){if(1&e){var n=zo();Ao(0,"mat-tab-body",10),Fo("_onCentered",(function(){return en(n),qo()._removeTabBodyWrapperHeight()}))("_onCentering",(function(e){return en(n),qo()._setTabBodyWrapperHeight(e)})),Ro()}if(2&e){var i=t.$implicit,r=t.index,a=qo();rs("mat-tab-body-active",a.selectedIndex==r),Mo("id",a._getTabContentId(r))("content",i.content)("position",i.position)("origin",i.origin)("animationDuration",a.animationDuration),wo("aria-labelledby",a._getTabLabelId(r))}}var $T,eE,tE,nE,iE,rE,aE,oE,sE,lE,uE,cE,hE,dE,fE,pE,mE=["tabListContainer"],vE=["tabList"],gE=["nextPaginator"],yE=["previousPaginator"],_E=new qe("MatInkBarPositioner",{providedIn:"root",factory:function(){return function(e){return{left:e?(e.offsetLeft||0)+"px":"0",width:e?(e.offsetWidth||0)+"px":"0"}}}}),xE=((tE=function(){function e(t,n,i,r){_classCallCheck(this,e),this._elementRef=t,this._ngZone=n,this._inkBarPositioner=i,this._animationMode=r}return _createClass(e,[{key:"alignToElement",value:function(e){var t=this;this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){return t._setStyles(e)}))})):this._setStyles(e)}},{key:"show",value:function(){this._elementRef.nativeElement.style.visibility="visible"}},{key:"hide",value:function(){this._elementRef.nativeElement.style.visibility="hidden"}},{key:"_setStyles",value:function(e){var t=this._inkBarPositioner(e),n=this._elementRef.nativeElement;n.style.left=t.left,n.style.width=t.width}}]),e}()).\u0275fac=function(e){return new(e||tE)(To(Vs),To(Su),To(_E),To(yp,8))},tE.\u0275dir=Ct({type:tE,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(e,t){2&e&&rs("_mat-animation-noopable","NoopAnimations"===t._animationMode)}}),tE),bE=((eE=_createClass((function e(t){_classCallCheck(this,e),this.template=t}))).\u0275fac=function(e){return new(e||eE)(To(dl))},eE.\u0275dir=Ct({type:eE,selectors:[["","matTabContent",""]]}),eE),wE=(($T=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t)}(yS)).\u0275fac=function(e){return kE(e||$T)},$T.\u0275dir=Ct({type:$T,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[bs]}),$T),kE=hi(wE),CE=vx(_createClass((function e(){_classCallCheck(this,e)}))),SE=new qe("MAT_TAB_GROUP"),TE=((nE=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._viewContainerRef=e,i._closestTabGroup=n,i.textLabel="",i._contentPortal=null,i._stateChanges=new I,i.position=null,i.origin=null,i.isActive=!1,i}return _inherits(t,e),_createClass(t,[{key:"templateLabel",get:function(){return this._templateLabel},set:function(e){e&&(this._templateLabel=e)}},{key:"content",get:function(){return this._contentPortal}},{key:"ngOnChanges",value:function(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"ngOnInit",value:function(){this._contentPortal=new pS(this._explicitContent||this._implicitContent,this._viewContainerRef)}}]),t}(CE)).\u0275fac=function(e){return new(e||nE)(To(pl),To(SE,8))},nE.\u0275cmp=yt({type:nE,selectors:[["mat-tab"]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,wE,!0),Jl(n,bE,!0,dl)),2&e&&(Wl(i=$l())&&(t.templateLabel=i.first),Wl(i=$l())&&(t._explicitContent=i.first))},viewQuery:function(e,t){var n;1&e&&Zl(dl,!0),2&e&&Wl(n=$l())&&(t._implicitContent=n.first)},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[bs,Es],ngContentSelectors:VT,decls:1,vars:0,template:function(e,t){1&e&&(Wo(),Co(0,HT,1,0,"ng-template"))},encapsulation:2}),nE),EE={translateTab:Wh("translateTab",[Yh("center, void, left-origin-center, right-origin-center",Kh({transform:"none"})),Yh("left",Kh({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),Yh("right",Kh({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),Jh("* => left, * => right, left => center, right => center",Zh("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Jh("void => left-origin-center",[Kh({transform:"translate3d(-100%, 0, 0)"}),Zh("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Jh("void => right-origin-center",[Kh({transform:"translate3d(100%, 0, 0)"}),Zh("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])},PE=((aE=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n,r]))._host=i,a._centeringSub=p.EMPTY,a._leavingSub=p.EMPTY,a}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf2(t.prototype),"ngOnInit",this).call(this),this._centeringSub=this._host._beforeCentering.pipe(om(this._host._isCenterPosition(this._host._position))).subscribe((function(t){t&&!e.hasAttached()&&e.attach(e._host._content)})),this._leavingSub=this._host._afterLeavingCenter.subscribe((function(){e.detach()}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf2(t.prototype),"ngOnDestroy",this).call(this),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}]),t}(_S)).\u0275fac=function(e){return new(e||aE)(To(Hs),To(pl),To(Pe((function(){return IE}))),To(rc))},aE.\u0275dir=Ct({type:aE,selectors:[["","matTabBodyHost",""]],features:[bs]}),aE),ME=((rE=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this._elementRef=t,this._dir=n,this._dirChangeSubscription=p.EMPTY,this._translateTabComplete=new I,this._onCentering=new Dl,this._beforeCentering=new Dl,this._afterLeavingCenter=new Dl,this._onCentered=new Dl(!0),this.animationDuration="500ms",n&&(this._dirChangeSubscription=n.change.subscribe((function(e){r._computePositionAnimationState(e),i.markForCheck()}))),this._translateTabComplete.pipe(Fy((function(e,t){return e.fromState===t.fromState&&e.toState===t.toState}))).subscribe((function(e){r._isCenterPosition(e.toState)&&r._isCenterPosition(r._position)&&r._onCentered.emit(),r._isCenterPosition(e.fromState)&&!r._isCenterPosition(r._position)&&r._afterLeavingCenter.emit()}))}return _createClass(e,[{key:"position",set:function(e){this._positionIndex=e,this._computePositionAnimationState()}},{key:"ngOnInit",value:function(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}},{key:"ngOnDestroy",value:function(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}},{key:"_onTranslateTabStarted",value:function(e){var t=this._isCenterPosition(e.toState);this._beforeCentering.emit(t),t&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}},{key:"_getLayoutDirection",value:function(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}},{key:"_isCenterPosition",value:function(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}},{key:"_computePositionAnimationState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._getLayoutDirection();this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}},{key:"_computePositionFromOrigin",value:function(e){var t=this._getLayoutDirection();return"ltr"==t&&e<=0||"rtl"==t&&e>0?"left-origin-center":"right-origin-center"}}]),e}()).\u0275fac=function(e){return new(e||rE)(To(Vs),To(s_,8),To(Ga))},rE.\u0275dir=Ct({type:rE,inputs:{animationDuration:"animationDuration",position:"position",_content:["content","_content"],origin:"origin"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),rE),IE=((iE=function(e){function t(e,n,i){return _classCallCheck(this,t),_callSuper(this,t,[e,n,i])}return _inherits(t,e),_createClass(t)}(ME)).\u0275fac=function(e){return new(e||iE)(To(Vs),To(s_,8),To(Ga))},iE.\u0275cmp=yt({type:iE,selectors:[["mat-tab-body"]],viewQuery:function(e,t){var n;1&e&&Xl(xS,!0),2&e&&Wl(n=$l())&&(t._portalHost=n.first)},hostAttrs:[1,"mat-tab-body"],features:[bs],decls:3,vars:6,consts:[[1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(e,t){1&e&&(Ao(0,"div",0,1),Fo("@translateTab.start",(function(e){return t._onTranslateTabStarted(e)}))("@translateTab.done",(function(e){return t._translateTabComplete.next(e)})),Co(2,UT,0,0,"ng-template",2),Ro()),2&e&&Mo("@translateTab",Rl(3,GT,t._position,Al(1,qT,t.animationDuration)))},directives:[PE],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[EE.translateTab]}}),iE),AE=new qe("MAT_TABS_CONFIG"),RE=0,OE=_createClass((function e(){_classCallCheck(this,e)})),NE=gx(yx(_createClass((function e(t){_classCallCheck(this,e),this._elementRef=t}))),"primary"),DE=((sE=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e]))._changeDetectorRef=n,a._animationMode=r,a._tabs=new Ll,a._indexToSelect=0,a._tabBodyWrapperHeight=0,a._tabsSubscription=p.EMPTY,a._tabLabelSubscription=p.EMPTY,a._dynamicHeight=!1,a._selectedIndex=null,a.headerPosition="above",a.selectedIndexChange=new Dl,a.focusChange=new Dl,a.animationDone=new Dl,a.selectedTabChange=new Dl(!0),a._groupId=RE++,a.animationDuration=i&&i.animationDuration?i.animationDuration:"500ms",a.disablePagination=!(!i||null==i.disablePagination)&&i.disablePagination,a}return _inherits(t,e),_createClass(t,[{key:"dynamicHeight",get:function(){return this._dynamicHeight},set:function(e){this._dynamicHeight=Py(e)}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){this._indexToSelect=My(e,null)}},{key:"animationDuration",get:function(){return this._animationDuration},set:function(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){var t=this._elementRef.nativeElement;t.classList.remove("mat-background-"+this.backgroundColor),e&&t.classList.add("mat-background-"+e),this._backgroundColor=e}},{key:"ngAfterContentChecked",value:function(){var e=this,t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){var n=null==this._selectedIndex;n||this.selectedTabChange.emit(this._createChangeEvent(t)),Promise.resolve().then((function(){e._tabs.forEach((function(e,n){return e.isActive=n===t})),n||e.selectedIndexChange.emit(t)}))}this._tabs.forEach((function(n,i){n.position=i-t,null==e._selectedIndex||0!=n.position||n.origin||(n.origin=t-e._selectedIndex)})),this._selectedIndex!==t&&(this._selectedIndex=t,this._changeDetectorRef.markForCheck())}},{key:"ngAfterContentInit",value:function(){var e=this;this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe((function(){if(e._clampTabIndex(e._indexToSelect)===e._selectedIndex)for(var t=e._tabs.toArray(),n=0;n<t.length;n++)if(t[n].isActive){e._indexToSelect=e._selectedIndex=n;break}e._changeDetectorRef.markForCheck()}))}},{key:"_subscribeToAllTabChanges",value:function(){var e=this;this._allTabs.changes.pipe(om(this._allTabs)).subscribe((function(t){e._tabs.reset(t.filter((function(t){return!t._closestTabGroup||t._closestTabGroup===e}))),e._tabs.notifyOnChanges()}))}},{key:"ngOnDestroy",value:function(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}},{key:"realignInkBar",value:function(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}},{key:"_focusChanged",value:function(e){this.focusChange.emit(this._createChangeEvent(e))}},{key:"_createChangeEvent",value:function(e){var t=new OE;return t.index=e,this._tabs&&this._tabs.length&&(t.tab=this._tabs.toArray()[e]),t}},{key:"_subscribeToTabLabels",value:function(){var e=this;this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=J.apply(void 0,_toConsumableArray(this._tabs.map((function(e){return e._stateChanges})))).subscribe((function(){return e._changeDetectorRef.markForCheck()}))}},{key:"_clampTabIndex",value:function(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}},{key:"_getTabLabelId",value:function(e){return"mat-tab-label-".concat(this._groupId,"-").concat(e)}},{key:"_getTabContentId",value:function(e){return"mat-tab-content-".concat(this._groupId,"-").concat(e)}},{key:"_setTabBodyWrapperHeight",value:function(e){if(this._dynamicHeight&&this._tabBodyWrapperHeight){var t=this._tabBodyWrapper.nativeElement;t.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(t.style.height=e+"px")}}},{key:"_removeTabBodyWrapperHeight",value:function(){var e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}},{key:"_handleClick",value:function(e,t,n){e.disabled||(this.selectedIndex=t.focusIndex=n)}},{key:"_getTabIndex",value:function(e,t){return e.disabled?null:this.selectedIndex===t?0:-1}}]),t}(NE)).\u0275fac=function(e){return new(e||sE)(To(Vs),To(Ga),To(AE,8),To(yp,8))},sE.\u0275dir=Ct({type:sE,inputs:{headerPosition:"headerPosition",animationDuration:"animationDuration",disablePagination:"disablePagination",dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[bs]}),sE),zE=((oE=function(e){function t(e,n,i,r){return _classCallCheck(this,t),_callSuper(this,t,[e,n,i,r])}return _inherits(t,e),_createClass(t)}(DE)).\u0275fac=function(e){return new(e||oE)(To(Vs),To(Ga),To(AE,8),To(yp,8))},oE.\u0275cmp=yt({type:oE,selectors:[["mat-tab-group"]],contentQueries:function(e,t,n){var i;1&e&&Yl(n,TE,!0),2&e&&Wl(i=$l())&&(t._allTabs=i)},viewQuery:function(e,t){var n;1&e&&(Xl(WT,!0),Xl(ZT,!0)),2&e&&(Wl(n=$l())&&(t._tabBodyWrapper=n.first),Wl(n=$l())&&(t._tabHeader=n.first))},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(e,t){2&e&&rs("mat-tab-group-dynamic-height",t.dynamicHeight)("mat-tab-group-inverted-header","below"===t.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[Ls([{provide:SE,useExisting:oE}]),bs],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(e,t){1&e&&(Ao(0,"mat-tab-header",0,1),Fo("indexFocused",(function(e){return t._focusChanged(e)}))("selectFocusedIndex",(function(e){return t.selectedIndex=e})),Co(2,JT,4,14,"div",2),Ro(),Ao(3,"div",3,4),Co(5,QT,1,8,"mat-tab-body",5),Ro()),2&e&&(Mo("selectedIndex",t.selectedIndex||0)("disableRipple",t.disableRipple)("disablePagination",t.disablePagination),yr(2),Mo("ngForOf",t._tabs),yr(1),rs("_mat-animation-noopable","NoopAnimations"===t._animationMode),yr(2),Mo("ngForOf",t._tabs))},directives:function(){return[VE,Lc,BE,nb,rx,Fc,_S,IE]},styles:[".mat-tab-group{display:flex;flex-direction:column}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),oE),LE=vx(_createClass((function e(){_classCallCheck(this,e)}))),BE=((lE=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).elementRef=e,n}return _inherits(t,e),_createClass(t,[{key:"focus",value:function(){this.elementRef.nativeElement.focus()}},{key:"getOffsetLeft",value:function(){return this.elementRef.nativeElement.offsetLeft}},{key:"getOffsetWidth",value:function(){return this.elementRef.nativeElement.offsetWidth}}]),t}(LE)).\u0275fac=function(e){return new(e||lE)(To(Vs))},lE.\u0275dir=Ct({type:lE,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(e,t){2&e&&(wo("aria-disabled",!!t.disabled),rs("mat-tab-disabled",t.disabled))},inputs:{disabled:"disabled"},features:[bs]}),lE),FE=Sy({passive:!0}),jE=((dE=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this._elementRef=t,this._changeDetectorRef=n,this._viewportRuler=i,this._dir=r,this._ngZone=a,this._platform=o,this._animationMode=s,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new I,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new I,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Dl,this.indexFocused=new Dl,a.runOutsideAngular((function(){Oy(t.nativeElement,"mouseleave").pipe(Ky(l._destroyed)).subscribe((function(){l._stopInterval()}))}))}return _createClass(e,[{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){e=My(e),this._selectedIndex!=e&&(this._selectedIndexChanged=!0,this._selectedIndex=e,this._keyManager&&this._keyManager.updateActiveItem(e))}},{key:"ngAfterViewInit",value:function(){var e=this;Oy(this._previousPaginator.nativeElement,"touchstart",FE).pipe(Ky(this._destroyed)).subscribe((function(){e._handlePaginatorPress("before")})),Oy(this._nextPaginator.nativeElement,"touchstart",FE).pipe(Ky(this._destroyed)).subscribe((function(){e._handlePaginatorPress("after")}))}},{key:"ngAfterContentInit",value:function(){var e=this,t=this._dir?this._dir.change:bp(null),n=this._viewportRuler.change(150),i=function(){e.updatePagination(),e._alignInkBarToSelectedTab()};this._keyManager=new B_(this._items).withHorizontalOrientation(this._getLayoutDirection()).withWrap(),this._keyManager.updateActiveItem(0),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(i):i(),J(t,n,this._items.changes).pipe(Ky(this._destroyed)).subscribe((function(){Promise.resolve().then(i),e._keyManager.withHorizontalOrientation(e._getLayoutDirection())})),this._keyManager.change.pipe(Ky(this._destroyed)).subscribe((function(t){e.indexFocused.emit(t),e._setTabFocus(t)}))}},{key:"ngAfterContentChecked",value:function(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}},{key:"ngOnDestroy",value:function(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}},{key:"_handleKeydown",value:function(e){if(!v_(e))switch(e.keyCode){case 36:this._keyManager.setFirstItemActive(),e.preventDefault();break;case 35:this._keyManager.setLastItemActive(),e.preventDefault();break;case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e));break;default:this._keyManager.onKeydown(e)}}},{key:"_onContentChanges",value:function(){var e=this,t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run((function(){e.updatePagination(),e._alignInkBarToSelectedTab(),e._changeDetectorRef.markForCheck()})))}},{key:"updatePagination",value:function(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}},{key:"focusIndex",get:function(){return this._keyManager?this._keyManager.activeItemIndex:0},set:function(e){this._isValidIndex(e)&&this.focusIndex!==e&&this._keyManager&&this._keyManager.setActiveItem(e)}},{key:"_isValidIndex",value:function(e){if(!this._items)return!0;var t=this._items?this._items.toArray()[e]:null;return!!t&&!t.disabled}},{key:"_setTabFocus",value:function(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();var t=this._tabListContainer.nativeElement,n=this._getLayoutDirection();t.scrollLeft="ltr"==n?0:t.scrollWidth-t.offsetWidth}}},{key:"_getLayoutDirection",value:function(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}},{key:"_updateTabScrollPosition",value:function(){if(!this.disablePagination){var e=this.scrollDistance,t=this._platform,n="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform="translateX(".concat(Math.round(n),"px)"),t&&(t.TRIDENT||t.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}}},{key:"scrollDistance",get:function(){return this._scrollDistance},set:function(e){this._scrollTo(e)}},{key:"_scrollHeader",value:function(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}},{key:"_handlePaginatorClick",value:function(e){this._stopInterval(),this._scrollHeader(e)}},{key:"_scrollToLabel",value:function(e){if(!this.disablePagination){var t=this._items?this._items.toArray()[e]:null;if(t){var n,i,r=this._tabListContainer.nativeElement.offsetWidth,a=t.elementRef.nativeElement,o=a.offsetLeft,s=a.offsetWidth;"ltr"==this._getLayoutDirection()?i=(n=o)+s:n=(i=this._tabList.nativeElement.offsetWidth-o)-s;var l=this.scrollDistance,u=this.scrollDistance+r;n<l?this.scrollDistance-=l-n+60:i>u&&(this.scrollDistance+=i-u+60)}}}},{key:"_checkPaginationEnabled",value:function(){if(this.disablePagination)this._showPaginationControls=!1;else{var e=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;e||(this.scrollDistance=0),e!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=e}}},{key:"_checkScrollingControls",value:function(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}},{key:"_getMaxScrollDistance",value:function(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}},{key:"_alignInkBarToSelectedTab",value:function(){var e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,t=e?e.elementRef.nativeElement:null;t?this._inkBar.alignToElement(t):this._inkBar.hide()}},{key:"_stopInterval",value:function(){this._stopScrolling.next()}},{key:"_handlePaginatorPress",value:function(e,t){var n=this;t&&null!=t.button&&0!==t.button||(this._stopInterval(),Wy(650,100).pipe(Ky(J(this._stopScrolling,this._destroyed))).subscribe((function(){var t=n._scrollHeader(e),i=t.maxScrollDistance,r=t.distance;(0===r||r>=i)&&n._stopInterval()})))}},{key:"_scrollTo",value:function(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};var t=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(t,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:t,distance:this._scrollDistance}}}]),e}()).\u0275fac=function(e){return new(e||dE)(To(Vs),To(Ga),To(f_),To(s_,8),To(Su),To(by),To(yp,8))},dE.\u0275dir=Ct({type:dE,inputs:{disablePagination:"disablePagination"}}),dE),HE=((hE=function(e){function t(e,n,i,r,a,o,s){var l;return _classCallCheck(this,t),(l=_callSuper(this,t,[e,n,i,r,a,o,s]))._disableRipple=!1,l}return _inherits(t,e),_createClass(t,[{key:"disableRipple",get:function(){return this._disableRipple},set:function(e){this._disableRipple=Py(e)}},{key:"_itemSelected",value:function(e){e.preventDefault()}}]),t}(jE)).\u0275fac=function(e){return new(e||hE)(To(Vs),To(Ga),To(f_),To(s_,8),To(Su),To(by),To(yp,8))},hE.\u0275dir=Ct({type:hE,inputs:{disableRipple:"disableRipple"},features:[bs]}),hE),VE=((cE=function(e){function t(e,n,i,r,a,o,s){return _classCallCheck(this,t),_callSuper(this,t,[e,n,i,r,a,o,s])}return _inherits(t,e),_createClass(t)}(HE)).\u0275fac=function(e){return new(e||cE)(To(Vs),To(Ga),To(f_),To(s_,8),To(Su),To(by),To(yp,8))},cE.\u0275cmp=yt({type:cE,selectors:[["mat-tab-header"]],contentQueries:function(e,t,n){var i;1&e&&Yl(n,BE,!1),2&e&&Wl(i=$l())&&(t._items=i)},viewQuery:function(e,t){var n;1&e&&(Zl(xE,!0),Zl(mE,!0),Zl(vE,!0),Xl(gE,!0),Xl(yE,!0)),2&e&&(Wl(n=$l())&&(t._inkBar=n.first),Wl(n=$l())&&(t._tabListContainer=n.first),Wl(n=$l())&&(t._tabList=n.first),Wl(n=$l())&&(t._nextPaginator=n.first),Wl(n=$l())&&(t._previousPaginator=n.first))},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(e,t){2&e&&rs("mat-tab-header-pagination-controls-enabled",t._showPaginationControls)("mat-tab-header-rtl","rtl"==t._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[bs],ngContentSelectors:VT,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(e,t){1&e&&(Wo(),Ao(0,"div",0,1),Fo("click",(function(){return t._handlePaginatorClick("before")}))("mousedown",(function(e){return t._handlePaginatorPress("before",e)}))("touchend",(function(){return t._stopInterval()})),Oo(2,"div",2),Ro(),Ao(3,"div",3,4),Fo("keydown",(function(e){return t._handleKeydown(e)})),Ao(5,"div",5,6),Fo("cdkObserveContent",(function(){return t._onContentChanges()})),Ao(7,"div",7),Zo(8),Ro(),Oo(9,"mat-ink-bar"),Ro(),Ro(),Ao(10,"div",8,9),Fo("mousedown",(function(e){return t._handlePaginatorPress("after",e)}))("click",(function(){return t._handlePaginatorClick("after")}))("touchend",(function(){return t._stopInterval()})),Oo(12,"div",2),Ro()),2&e&&(rs("mat-tab-header-pagination-disabled",t._disableScrollBefore),Mo("matRippleDisabled",t._disableScrollBefore||t.disableRipple),yr(5),rs("_mat-animation-noopable","NoopAnimations"===t._animationMode),yr(5),rs("mat-tab-header-pagination-disabled",t._disableScrollAfter),Mo("matRippleDisabled",t._disableScrollAfter||t.disableRipple))},directives:[nb,E_,xE],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),cE),UE=((uE=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:uE}),uE.\u0275inj=ve({factory:function(e){return new(e||uE)},imports:[[sh,mx,wS,ib,P_,ox],mx]}),uE),qE=Sy({passive:!0}),GE=((pE=function(){function e(t,n){_classCallCheck(this,e),this._platform=t,this._ngZone=n,this._monitoredElements=new Map}return _createClass(e,[{key:"monitor",value:function(e){var t=this;if(!this._platform.isBrowser)return Pp;var n=Ry(e),i=this._monitoredElements.get(n);if(i)return i.subject.asObservable();var r=new I,a="cdk-text-field-autofilled",o=function(e){"cdk-text-field-autofill-start"!==e.animationName||n.classList.contains(a)?"cdk-text-field-autofill-end"===e.animationName&&n.classList.contains(a)&&(n.classList.remove(a),t._ngZone.run((function(){return r.next({target:e.target,isAutofilled:!1})}))):(n.classList.add(a),t._ngZone.run((function(){return r.next({target:e.target,isAutofilled:!0})})))};return this._ngZone.runOutsideAngular((function(){n.addEventListener("animationstart",o,qE),n.classList.add("cdk-text-field-autofill-monitored")})),this._monitoredElements.set(n,{subject:r,unlisten:function(){n.removeEventListener("animationstart",o,qE)}}),r.asObservable()}},{key:"stopMonitoring",value:function(e){var t=Ry(e),n=this._monitoredElements.get(t);n&&(n.unlisten(),n.subject.complete(),t.classList.remove("cdk-text-field-autofill-monitored"),t.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(t))}},{key:"ngOnDestroy",value:function(){var e=this;this._monitoredElements.forEach((function(t,n){return e.stopMonitoring(n)}))}}]),e}()).\u0275fac=function(e){return new(e||pE)($e(by),$e(Su))},pE.\u0275prov=me({factory:function(){return new pE($e(by),$e(Su))},token:pE,providedIn:"root"}),pE),WE=((fE=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:fE}),fE.\u0275inj=ve({factory:function(e){return new(e||fE)},imports:[[wy]]}),fE),ZE=["underline"],XE=["connectionContainer"],KE=["inputContainer"],YE=["label"];function JE(e,t){1&e&&(No(0),Ao(1,"div",14),Oo(2,"div",15),Oo(3,"div",16),Oo(4,"div",17),Ro(),Ao(5,"div",18),Oo(6,"div",15),Oo(7,"div",16),Oo(8,"div",17),Ro(),Do())}function QE(e,t){1&e&&(Ao(0,"div",19),Zo(1,1),Ro())}function $E(e,t){if(1&e&&(No(0),Zo(1,2),Ao(2,"span"),ms(3),Ro(),Do()),2&e){var n=qo(2);yr(3),vs(n._control.placeholder)}}function eP(e,t){1&e&&Zo(0,3,["*ngSwitchCase","true"])}function tP(e,t){1&e&&(Ao(0,"span",23),ms(1," *"),Ro())}function nP(e,t){if(1&e){var n=zo();Ao(0,"label",20,21),Fo("cdkObserveContent",(function(){return en(n),qo().updateOutlineGap()})),Co(2,$E,4,1,"ng-container",12),Co(3,eP,1,0,void 0,12),Co(4,tP,2,0,"span",22),Ro()}if(2&e){var i=qo();rs("mat-empty",i._control.empty&&!i._shouldAlwaysFloat)("mat-form-field-empty",i._control.empty&&!i._shouldAlwaysFloat)("mat-accent","accent"==i.color)("mat-warn","warn"==i.color),Mo("cdkObserveContentDisabled","outline"!=i.appearance)("id",i._labelId)("ngSwitch",i._hasLabel()),wo("for",i._control.id)("aria-owns",i._control.id),yr(2),Mo("ngSwitchCase",!1),yr(1),Mo("ngSwitchCase",!0),yr(1),Mo("ngIf",!i.hideRequiredMarker&&i._control.required&&!i._control.disabled)}}function iP(e,t){1&e&&(Ao(0,"div",24),Zo(1,4),Ro())}function rP(e,t){if(1&e&&(Ao(0,"div",25,26),Oo(2,"span",27),Ro()),2&e){var n=qo();yr(2),rs("mat-accent","accent"==n.color)("mat-warn","warn"==n.color)}}function aP(e,t){1&e&&(Ao(0,"div"),Zo(1,5),Ro()),2&e&&Mo("@transitionMessages",qo()._subscriptAnimationState)}function oP(e,t){if(1&e&&(Ao(0,"div",31),ms(1),Ro()),2&e){var n=qo(2);Mo("id",n._hintLabelId),yr(1),vs(n.hintLabel)}}function sP(e,t){if(1&e&&(Ao(0,"div",28),Co(1,oP,2,2,"div",29),Zo(2,6),Oo(3,"div",30),Zo(4,7),Ro()),2&e){var n=qo();Mo("@transitionMessages",n._subscriptAnimationState),yr(1),Mo("ngIf",n.hintLabel)}}var lP,uP,cP=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],hP=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],dP=0,fP=((lP=_createClass((function e(){_classCallCheck(this,e),this.id="mat-error-"+dP++}))).\u0275fac=function(e){return new(e||lP)},lP.\u0275dir=Ct({type:lP,selectors:[["mat-error"]],hostAttrs:["role","alert",1,"mat-error"],hostVars:1,hostBindings:function(e,t){2&e&&wo("id",t.id)},inputs:{id:"id"}}),lP),pP={transitionMessages:Wh("transitionMessages",[Yh("enter",Kh({opacity:1,transform:"translateY(0%)"})),Jh("void => enter",[Kh({opacity:0,transform:"translateY(-100%)"}),Zh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},mP=((uP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||uP)},uP.\u0275dir=Ct({type:uP}),uP);function vP(e){return Error("A hint was already declared for 'align=\"".concat(e,"\"'."))}var gP,yP,_P,xP,bP,wP,kP,CP,SP,TP,EP=0,PP=((bP=_createClass((function e(){_classCallCheck(this,e),this.align="start",this.id="mat-hint-"+EP++}))).\u0275fac=function(e){return new(e||bP)},bP.\u0275dir=Ct({type:bP,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(e,t){2&e&&(wo("id",t.id)("align",null),rs("mat-right","end"==t.align))},inputs:{align:"align",id:"id"}}),bP),MP=((xP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||xP)},xP.\u0275dir=Ct({type:xP,selectors:[["mat-label"]]}),xP),IP=((_P=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||_P)},_P.\u0275dir=Ct({type:_P,selectors:[["mat-placeholder"]]}),_P),AP=((yP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||yP)},yP.\u0275dir=Ct({type:yP,selectors:[["","matPrefix",""]]}),yP),RP=((gP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||gP)},gP.\u0275dir=Ct({type:gP,selectors:[["","matSuffix",""]]}),gP),OP=0,NP=gx(_createClass((function e(t){_classCallCheck(this,e),this._elementRef=t})),"primary"),DP=new qe("MAT_FORM_FIELD_DEFAULT_OPTIONS"),zP=new qe("MatFormField"),LP=((kP=function(e){function t(e,n,i,r,a,o,s,l){var u;return _classCallCheck(this,t),(u=_callSuper(this,t,[e]))._elementRef=e,u._changeDetectorRef=n,u._dir=r,u._defaults=a,u._platform=o,u._ngZone=s,u._outlineGapCalculationNeededImmediately=!1,u._outlineGapCalculationNeededOnStable=!1,u._destroyed=new I,u._showAlwaysAnimate=!1,u._subscriptAnimationState="",u._hintLabel="",u._hintLabelId="mat-hint-"+OP++,u._labelId="mat-form-field-label-"+OP++,u._labelOptions=i||{},u.floatLabel=u._getDefaultFloatLabelState(),u._animationsEnabled="NoopAnimations"!==l,u.appearance=a&&a.appearance?a.appearance:"legacy",u._hideRequiredMarker=!(!a||null==a.hideRequiredMarker)&&a.hideRequiredMarker,u}return _inherits(t,e),_createClass(t,[{key:"appearance",get:function(){return this._appearance},set:function(e){var t=this._appearance;this._appearance=e||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&t!==e&&(this._outlineGapCalculationNeededOnStable=!0)}},{key:"hideRequiredMarker",get:function(){return this._hideRequiredMarker},set:function(e){this._hideRequiredMarker=Py(e)}},{key:"_shouldAlwaysFloat",get:function(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}},{key:"_canLabelFloat",get:function(){return"never"!==this.floatLabel}},{key:"hintLabel",get:function(){return this._hintLabel},set:function(e){this._hintLabel=e,this._processHints()}},{key:"floatLabel",get:function(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel},set:function(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}},{key:"_control",get:function(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic},set:function(e){this._explicitFormFieldControl=e}},{key:"_labelChild",get:function(){return this._labelChildNonStatic||this._labelChildStatic}},{key:"getConnectedOverlayOrigin",value:function(){return this._connectionContainerRef||this._elementRef}},{key:"ngAfterContentInit",value:function(){var e=this;this._validateControlChild();var t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add("mat-form-field-type-"+t.controlType),t.stateChanges.pipe(om(null)).subscribe((function(){e._validatePlaceholders(),e._syncDescribedByIds(),e._changeDetectorRef.markForCheck()})),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(Ky(this._destroyed)).subscribe((function(){return e._changeDetectorRef.markForCheck()})),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.asObservable().pipe(Ky(e._destroyed)).subscribe((function(){e._outlineGapCalculationNeededOnStable&&e.updateOutlineGap()}))})),J(this._prefixChildren.changes,this._suffixChildren.changes).subscribe((function(){e._outlineGapCalculationNeededOnStable=!0,e._changeDetectorRef.markForCheck()})),this._hintChildren.changes.pipe(om(null)).subscribe((function(){e._processHints(),e._changeDetectorRef.markForCheck()})),this._errorChildren.changes.pipe(om(null)).subscribe((function(){e._syncDescribedByIds(),e._changeDetectorRef.markForCheck()})),this._dir&&this._dir.change.pipe(Ky(this._destroyed)).subscribe((function(){"function"==typeof requestAnimationFrame?e._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){return e.updateOutlineGap()}))})):e.updateOutlineGap()}))}},{key:"ngAfterContentChecked",value:function(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}},{key:"ngAfterViewInit",value:function(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}},{key:"ngOnDestroy",value:function(){this._destroyed.next(),this._destroyed.complete()}},{key:"_shouldForward",value:function(e){var t=this._control?this._control.ngControl:null;return t&&t[e]}},{key:"_hasPlaceholder",value:function(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}},{key:"_hasLabel",value:function(){return!!this._labelChild}},{key:"_shouldLabelFloat",value:function(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}},{key:"_hideControlPlaceholder",value:function(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}},{key:"_hasFloatingLabel",value:function(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}},{key:"_getDisplayedMessages",value:function(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}},{key:"_animateAndLockLabel",value:function(){var e=this;this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,Oy(this._label.nativeElement,"transitionend").pipe(Yp(1)).subscribe((function(){e._showAlwaysAnimate=!1}))),this.floatLabel="always",this._changeDetectorRef.markForCheck())}},{key:"_validatePlaceholders",value:function(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}},{key:"_processHints",value:function(){this._validateHints(),this._syncDescribedByIds()}},{key:"_validateHints",value:function(){var e,t,n=this;this._hintChildren&&this._hintChildren.forEach((function(i){if("start"===i.align){if(e||n.hintLabel)throw vP("start");e=i}else if("end"===i.align){if(t)throw vP("end");t=i}}))}},{key:"_getDefaultFloatLabelState",value:function(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}},{key:"_syncDescribedByIds",value:function(){if(this._control){var e=[];if("hint"===this._getDisplayedMessages()){var t=this._hintChildren?this._hintChildren.find((function(e){return"start"===e.align})):null,n=this._hintChildren?this._hintChildren.find((function(e){return"end"===e.align})):null;t?e.push(t.id):this._hintLabel&&e.push(this._hintLabelId),n&&e.push(n.id)}else this._errorChildren&&(e=this._errorChildren.map((function(e){return e.id})));this._control.setDescribedByIds(e)}}},{key:"_validateControlChild",value:function(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}},{key:"updateOutlineGap",value:function(){var e=this._label?this._label.nativeElement:null;if("outline"===this.appearance&&e&&e.children.length&&e.textContent.trim()&&this._platform.isBrowser)if(this._isAttachedToDOM()){var t=0,n=0,i=this._connectionContainerRef.nativeElement,r=i.querySelectorAll(".mat-form-field-outline-start"),a=i.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){var o=i.getBoundingClientRect();if(0===o.width&&0===o.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);var s,l=this._getStartEnd(o),u=this._getStartEnd(e.children[0].getBoundingClientRect()),c=0,h=_createForOfIteratorHelper(e.children);try{for(h.s();!(s=h.n()).done;)c+=s.value.offsetWidth}catch(p){h.e(p)}finally{h.f()}t=Math.abs(u-l)-5,n=c>0?.75*c+10:0}for(var d=0;d<r.length;d++)r[d].style.width=t+"px";for(var f=0;f<a.length;f++)a[f].style.width=n+"px";this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}else this._outlineGapCalculationNeededImmediately=!0}},{key:"_getStartEnd",value:function(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}},{key:"_isAttachedToDOM",value:function(){var e=this._elementRef.nativeElement;if(e.getRootNode){var t=e.getRootNode();return t&&t!==e}return document.documentElement.contains(e)}}]),t}(NP)).\u0275fac=function(e){return new(e||kP)(To(Vs),To(Ga),To(gb,8),To(s_,8),To(DP,8),To(by),To(Su),To(yp,8))},kP.\u0275cmp=yt({type:kP,selectors:[["mat-form-field"]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,mP,!0),Jl(n,mP,!0),Yl(n,MP,!0),Jl(n,MP,!0),Yl(n,IP,!0),Yl(n,fP,!0),Yl(n,PP,!0),Yl(n,AP,!0),Yl(n,RP,!0)),2&e&&(Wl(i=$l())&&(t._controlNonStatic=i.first),Wl(i=$l())&&(t._controlStatic=i.first),Wl(i=$l())&&(t._labelChildNonStatic=i.first),Wl(i=$l())&&(t._labelChildStatic=i.first),Wl(i=$l())&&(t._placeholderChild=i.first),Wl(i=$l())&&(t._errorChildren=i),Wl(i=$l())&&(t._hintChildren=i),Wl(i=$l())&&(t._prefixChildren=i),Wl(i=$l())&&(t._suffixChildren=i))},viewQuery:function(e,t){var n;1&e&&(Xl(ZE,!0),Zl(XE,!0),Xl(KE,!0),Xl(YE,!0)),2&e&&(Wl(n=$l())&&(t.underlineRef=n.first),Wl(n=$l())&&(t._connectionContainerRef=n.first),Wl(n=$l())&&(t._inputContainerRef=n.first),Wl(n=$l())&&(t._label=n.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(e,t){2&e&&rs("mat-form-field-appearance-standard","standard"==t.appearance)("mat-form-field-appearance-fill","fill"==t.appearance)("mat-form-field-appearance-outline","outline"==t.appearance)("mat-form-field-appearance-legacy","legacy"==t.appearance)("mat-form-field-invalid",t._control.errorState)("mat-form-field-can-float",t._canLabelFloat)("mat-form-field-should-float",t._shouldLabelFloat())("mat-form-field-has-label",t._hasFloatingLabel())("mat-form-field-hide-placeholder",t._hideControlPlaceholder())("mat-form-field-disabled",t._control.disabled)("mat-form-field-autofilled",t._control.autofilled)("mat-focused",t._control.focused)("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)("ng-untouched",t._shouldForward("untouched"))("ng-touched",t._shouldForward("touched"))("ng-pristine",t._shouldForward("pristine"))("ng-dirty",t._shouldForward("dirty"))("ng-valid",t._shouldForward("valid"))("ng-invalid",t._shouldForward("invalid"))("ng-pending",t._shouldForward("pending"))("_mat-animation-noopable",!t._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Ls([{provide:zP,useExisting:kP}]),bs],ngContentSelectors:hP,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,t){1&e&&(Wo(cP),Ao(0,"div",0),Ao(1,"div",1,2),Fo("click",(function(e){return t._control.onContainerClick&&t._control.onContainerClick(e)})),Co(3,JE,9,0,"ng-container",3),Co(4,QE,2,0,"div",4),Ao(5,"div",5,6),Zo(7),Ao(8,"span",7),Co(9,nP,5,16,"label",8),Ro(),Ro(),Co(10,iP,2,0,"div",9),Ro(),Co(11,rP,3,4,"div",10),Ao(12,"div",11),Co(13,aP,2,1,"div",12),Co(14,sP,5,2,"div",13),Ro(),Ro()),2&e&&(yr(3),Mo("ngIf","outline"==t.appearance),yr(1),Mo("ngIf",t._prefixChildren.length),yr(5),Mo("ngIf",t._hasFloatingLabel()),yr(1),Mo("ngIf",t._suffixChildren.length),yr(1),Mo("ngIf","outline"!=t.appearance),yr(1),Mo("ngSwitch",t._getDisplayedMessages()),yr(1),Mo("ngSwitchCase","error"),yr(1),Mo("ngSwitchCase","hint"))},directives:[Fc,eh,th,E_],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[pP.transitionMessages]},changeDetection:0}),kP),BP=((wP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:wP}),wP.\u0275inj=ve({factory:function(e){return new(e||wP)},imports:[[sh,mx,P_],mx]}),wP),FP=new qe("MAT_INPUT_VALUE_ACCESSOR"),jP=["button","checkbox","file","hidden","image","radio","range","reset","submit"],HP=0,VP=_x(_createClass((function e(t,n,i,r){_classCallCheck(this,e),this._defaultErrorStateMatcher=t,this._parentForm=n,this._parentFormGroup=i,this.ngControl=r}))),UP=((TP=function(e){function t(e,n,i,r,a,o,s,l,u){var c;_classCallCheck(this,t),(c=_callSuper(this,t,[o,r,a,i]))._elementRef=e,c._platform=n,c.ngControl=i,c._autofillMonitor=l,c._uid="mat-input-"+HP++,c.focused=!1,c.stateChanges=new I,c.controlType="mat-input",c.autofilled=!1,c._disabled=!1,c._required=!1,c._type="text",c._readonly=!1,c._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter((function(e){return Cy().has(e)}));var h=c._elementRef.nativeElement,d=h.nodeName.toLowerCase();return c._inputValueAccessor=s||h,c._previousNativeValue=c.value,c.id=c.id,n.IOS&&u.runOutsideAngular((function(){e.nativeElement.addEventListener("keyup",(function(e){var t=e.target;t.value||t.selectionStart||t.selectionEnd||(t.setSelectionRange(1,1),t.setSelectionRange(0,0))}))})),c._isServer=!c._platform.isBrowser,c._isNativeSelect="select"===d,c._isTextarea="textarea"===d,c._isNativeSelect&&(c.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select"),c}return _inherits(t,e),_createClass(t,[{key:"disabled",get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(e){this._disabled=Py(e),this.focused&&(this.focused=!1,this.stateChanges.next())}},{key:"id",get:function(){return this._id},set:function(e){this._id=e||this._uid}},{key:"required",get:function(){return this._required},set:function(e){this._required=Py(e)}},{key:"type",get:function(){return this._type},set:function(e){this._type=e||"text",this._validateType(),!this._isTextarea&&Cy().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}},{key:"value",get:function(){return this._inputValueAccessor.value},set:function(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}},{key:"readonly",get:function(){return this._readonly},set:function(e){this._readonly=Py(e)}},{key:"ngOnInit",value:function(){var e=this;this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe((function(t){e.autofilled=t.isAutofilled,e.stateChanges.next()}))}},{key:"ngOnChanges",value:function(){this.stateChanges.next()}},{key:"ngOnDestroy",value:function(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}},{key:"ngDoCheck",value:function(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}},{key:"focus",value:function(e){this._elementRef.nativeElement.focus(e)}},{key:"_focusChanged",value:function(e){e===this.focused||this.readonly&&e||(this.focused=e,this.stateChanges.next())}},{key:"_onInput",value:function(){}},{key:"_dirtyCheckNativeValue",value:function(){var e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}},{key:"_validateType",value:function(){if(jP.indexOf(this._type)>-1)throw Error('Input type "'.concat(this._type,"\" isn't supported by matInput."))}},{key:"_isNeverEmpty",value:function(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}},{key:"_isBadInput",value:function(){var e=this._elementRef.nativeElement.validity;return e&&e.badInput}},{key:"empty",get:function(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}},{key:"shouldLabelFloat",get:function(){if(this._isNativeSelect){var e=this._elementRef.nativeElement,t=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&t&&t.label)}return this.focused||!this.empty}},{key:"setDescribedByIds",value:function(e){this._ariaDescribedby=e.join(" ")}},{key:"onContainerClick",value:function(){this.focused||this.focus()}}]),t}(VP)).\u0275fac=function(e){return new(e||TP)(To(Vs),To(by),To(vk,10),To(RC,8),To(UC,8),To(Bx),To(FP,10),To(GE),To(Su))},TP.\u0275dir=Ct({type:TP,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(e,t){1&e&&Fo("focus",(function(){return t._focusChanged(!0)}))("blur",(function(){return t._focusChanged(!1)}))("input",(function(){return t._onInput()})),2&e&&(ys("disabled",t.disabled)("required",t.required),wo("id",t.id)("placeholder",t.placeholder)("readonly",t.readonly&&!t._isNativeSelect||null)("aria-describedby",t._ariaDescribedby||null)("aria-invalid",t.errorState)("aria-required",t.required.toString()),rs("mat-input-server",t._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[Ls([{provide:mP,useExisting:TP}]),bs,Es]}),TP),qP=((SP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:SP}),SP.\u0275inj=ve({factory:function(e){return new(e||SP)},providers:[Bx],imports:[[WE,BP],WE,BP]}),SP),GP=((CP=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:CP}),CP.\u0275inj=ve({factory:function(e){return new(e||CP)},imports:[[mx],mx]}),CP),WP=["trigger"],ZP=["panel"];function XP(e,t){if(1&e&&(Ao(0,"span",8),ms(1),Ro()),2&e){var n=qo();yr(1),vs(n.placeholder||"\xa0")}}function KP(e,t){if(1&e&&(Ao(0,"span"),ms(1),Ro()),2&e){var n=qo(2);yr(1),vs(n.triggerValue||"\xa0")}}function YP(e,t){1&e&&Zo(0,0,["*ngSwitchCase","true"])}function JP(e,t){1&e&&(Ao(0,"span",9),Co(1,KP,2,1,"span",10),Co(2,YP,1,0,void 0,11),Ro()),2&e&&(Mo("ngSwitch",!!qo().customTrigger),yr(2),Mo("ngSwitchCase",!0))}function QP(e,t){if(1&e){var n=zo();Ao(0,"div",12),Ao(1,"div",13,14),Fo("@transformPanel.done",(function(e){return en(n),qo()._panelDoneAnimatingStream.next(e.toState)}))("keydown",(function(e){return en(n),qo()._handleKeydown(e)})),Zo(3,1),Ro(),Ro()}if(2&e){var i=qo();Mo("@transformPanelWrap",void 0),yr(1),"mat-select-panel ",r=i._getPanelTheme(),"",function(e,t,n,i){var r=$t(),a=cn(2);r.firstUpdatePass&&ls(r,null,a,!0);var o=Qt();if(n!==fr&&bo(o,a,n)){var s=r.data[kn()+20];if(ps(s,!0)&&!ss(r,a)){var l=s.classesWithoutHost;null!==l&&(n=Te(l,n||"")),Io(r,s,o,n,!0)}else!function(e,t,n,i,r,a,o,s){r===fr&&(r=Yo);for(var l=0,u=0,c=0<r.length?r[0]:null,h=0<a.length?a[0]:null;null!==c||null!==h;){var d=l<r.length?r[l+1]:void 0,f=u<a.length?a[u+1]:void 0,p=null,m=void 0;c===h?(l+=2,u+=2,d!==f&&(p=h,m=f)):null===h||null!==c&&c<h?(l+=2,p=c):(u+=2,p=h,m=f),null!==p&&hs(e,t,n,i,p,m,!0,s),c=l<r.length?r[l]:null,h=u<a.length?a[u]:null}}(r,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return Yo;var i=[],r=wi(n);if(Array.isArray(r))for(var a=0;a<r.length;a++)e(i,r[a],!0);else if("object"==typeof r)for(var o in r)r.hasOwnProperty(o)&&e(i,o,r[o]);else"string"==typeof r&&t(i,r);return i}(e,t,n),0,a)}}(ct,as,ko(Qt(),"mat-select-panel ",r,"")),is("transform-origin",i._transformOrigin)("font-size",i._triggerFontSize,"px"),Mo("ngClass",i.panelClass)("@transformPanel",i.multiple?"showing-multiple":"showing"),wo("id",i.id+"-panel")}var r}var $P,eM,tM,nM,iM=[[["mat-select-trigger"]],"*"],rM=["mat-select-trigger","*"],aM={transformPanelWrap:Wh("transformPanelWrap",[Jh("* => void",$h("@transformPanel",[Qh()],{optional:!0}))]),transformPanel:Wh("transformPanel",[Yh("void",Kh({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Yh("showing",Kh({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Yh("showing-multiple",Kh({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Jh("void => *",Zh("120ms cubic-bezier(0, 0, 0.2, 1)")),Jh("* => void",Zh("100ms 25ms linear",Kh({opacity:0})))])},oM=0,sM=new qe("mat-select-scroll-strategy"),lM=new qe("MAT_SELECT_CONFIG"),uM={provide:sM,deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition()}}},cM=_createClass((function e(t,n){_classCallCheck(this,e),this.source=t,this.value=n})),hM=yx(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e){function n(){var e;_classCallCheck(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=_callSuper(this,n,[].concat(r)))._tabIndex=t,e}return _inherits(n,e),_createClass(n,[{key:"tabIndex",get:function(){return this.disabled?-1:this._tabIndex},set:function(e){this._tabIndex=null!=e?e:t}}]),n}(e)}(vx(_x(_createClass((function e(t,n,i,r,a){_classCallCheck(this,e),this._elementRef=t,this._defaultErrorStateMatcher=n,this._parentForm=i,this._parentFormGroup=r,this.ngControl=a})))))),dM=((tM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||tM)},tM.\u0275dir=Ct({type:tM,selectors:[["mat-select-trigger"]]}),tM),fM=((eM=function(e){function t(e,n,i,r,a,o,s,l,u,c,h,d,f,p){var m;return _classCallCheck(this,t),(m=_callSuper(this,t,[a,r,s,l,c]))._viewportRuler=e,m._changeDetectorRef=n,m._ngZone=i,m._dir=o,m._parentFormField=u,m.ngControl=c,m._liveAnnouncer=f,m._panelOpen=!1,m._required=!1,m._scrollTop=0,m._multiple=!1,m._compareWith=function(e,t){return e===t},m._uid="mat-select-"+oM++,m._destroy=new I,m._triggerFontSize=0,m._onChange=function(){},m._onTouched=function(){},m._optionIds="",m._transformOrigin="top",m._panelDoneAnimatingStream=new I,m._offsetY=0,m._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],m._disableOptionCentering=!1,m._focused=!1,m.controlType="mat-select",m.ariaLabel="",m.optionSelectionChanges=Ip((function(){var e=m.options;return e?e.changes.pipe(om(e),nm((function(){return J.apply(void 0,_toConsumableArray(e.map((function(e){return e.onSelectionChange}))))}))):m._ngZone.onStable.asObservable().pipe(Yp(1),nm((function(){return m.optionSelectionChanges})))})),m.openedChange=new Dl,m._openedStream=m.openedChange.pipe(Rp((function(e){return e})),H((function(){}))),m._closedStream=m.openedChange.pipe(Rp((function(e){return!e})),H((function(){}))),m.selectionChange=new Dl,m.valueChange=new Dl,m.ngControl&&(m.ngControl.valueAccessor=_assertThisInitialized2(m)),m._scrollStrategyFactory=d,m._scrollStrategy=m._scrollStrategyFactory(),m.tabIndex=parseInt(h)||0,m.id=m.id,p&&(null!=p.disableOptionCentering&&(m.disableOptionCentering=p.disableOptionCentering),null!=p.typeaheadDebounceInterval&&(m.typeaheadDebounceInterval=p.typeaheadDebounceInterval)),m}return _inherits(t,e),_createClass(t,[{key:"focused",get:function(){return this._focused||this._panelOpen}},{key:"placeholder",get:function(){return this._placeholder},set:function(e){this._placeholder=e,this.stateChanges.next()}},{key:"required",get:function(){return this._required},set:function(e){this._required=Py(e),this.stateChanges.next()}},{key:"multiple",get:function(){return this._multiple},set:function(e){if(this._selectionModel)throw Error("Cannot change `multiple` mode of select after initialization.");this._multiple=Py(e)}},{key:"disableOptionCentering",get:function(){return this._disableOptionCentering},set:function(e){this._disableOptionCentering=Py(e)}},{key:"compareWith",get:function(){return this._compareWith},set:function(e){if("function"!=typeof e)throw Error("`compareWith` must be a function.");this._compareWith=e,this._selectionModel&&this._initializeSelection()}},{key:"value",get:function(){return this._value},set:function(e){e!==this._value&&(this.writeValue(e),this._value=e)}},{key:"typeaheadDebounceInterval",get:function(){return this._typeaheadDebounceInterval},set:function(e){this._typeaheadDebounceInterval=My(e)}},{key:"id",get:function(){return this._id},set:function(e){this._id=e||this._uid,this.stateChanges.next()}},{key:"ngOnInit",value:function(){var e=this;this._selectionModel=new u_(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Fy(),Ky(this._destroy)).subscribe((function(){e.panelOpen?(e._scrollTop=0,e.openedChange.emit(!0)):(e.openedChange.emit(!1),e.overlayDir.offsetX=0,e._changeDetectorRef.markForCheck())})),this._viewportRuler.change().pipe(Ky(this._destroy)).subscribe((function(){e._panelOpen&&(e._triggerRect=e.trigger.nativeElement.getBoundingClientRect(),e._changeDetectorRef.markForCheck())}))}},{key:"ngAfterContentInit",value:function(){var e=this;this._initKeyManager(),this._selectionModel.changed.pipe(Ky(this._destroy)).subscribe((function(e){e.added.forEach((function(e){return e.select()})),e.removed.forEach((function(e){return e.deselect()}))})),this.options.changes.pipe(om(null),Ky(this._destroy)).subscribe((function(){e._resetOptions(),e._initializeSelection()}))}},{key:"ngDoCheck",value:function(){this.ngControl&&this.updateErrorState()}},{key:"ngOnChanges",value:function(e){e.disabled&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}},{key:"ngOnDestroy",value:function(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}},{key:"toggle",value:function(){this.panelOpen?this.close():this.open()}},{key:"open",value:function(){var e=this;!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.asObservable().pipe(Yp(1)).subscribe((function(){e._triggerFontSize&&e.overlayDir.overlayRef&&e.overlayDir.overlayRef.overlayElement&&(e.overlayDir.overlayRef.overlayElement.style.fontSize=e._triggerFontSize+"px")})))}},{key:"close",value:function(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}},{key:"writeValue",value:function(e){this.options&&this._setSelectionByValue(e)}},{key:"registerOnChange",value:function(e){this._onChange=e}},{key:"registerOnTouched",value:function(e){this._onTouched=e}},{key:"setDisabledState",value:function(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}},{key:"panelOpen",get:function(){return this._panelOpen}},{key:"selected",get:function(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}},{key:"triggerValue",get:function(){if(this.empty)return"";if(this._multiple){var e=this._selectionModel.selected.map((function(e){return e.viewValue}));return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}},{key:"_isRtl",value:function(){return!!this._dir&&"rtl"===this._dir.value}},{key:"_handleKeydown",value:function(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}},{key:"_handleClosedKeydown",value:function(e){var t=e.keyCode,n=40===t||38===t||37===t||39===t,i=13===t||32===t,r=this._keyManager;if(!r.isTyping()&&i&&!v_(e)||(this.multiple||e.altKey)&&n)e.preventDefault(),this.open();else if(!this.multiple){var a=this.selected;36===t||35===t?(36===t?r.setFirstItemActive():r.setLastItemActive(),e.preventDefault()):r.onKeydown(e);var o=this.selected;o&&a!==o&&this._liveAnnouncer.announce(o.viewValue,1e4)}}},{key:"_handleOpenKeydown",value:function(e){var t=this._keyManager,n=e.keyCode,i=40===n||38===n,r=t.isTyping();if(36===n||35===n)e.preventDefault(),36===n?t.setFirstItemActive():t.setLastItemActive();else if(i&&e.altKey)e.preventDefault(),this.close();else if(r||13!==n&&32!==n||!t.activeItem||v_(e))if(!r&&this._multiple&&65===n&&e.ctrlKey){e.preventDefault();var a=this.options.some((function(e){return!e.disabled&&!e.selected}));this.options.forEach((function(e){e.disabled||(a?e.select():e.deselect())}))}else{var o=t.activeItemIndex;t.onKeydown(e),this._multiple&&i&&e.shiftKey&&t.activeItem&&t.activeItemIndex!==o&&t.activeItem._selectViaInteraction()}else e.preventDefault(),t.activeItem._selectViaInteraction()}},{key:"_onFocus",value:function(){this.disabled||(this._focused=!0,this.stateChanges.next())}},{key:"_onBlur",value:function(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}},{key:"_onAttached",value:function(){var e=this;this.overlayDir.positionChange.pipe(Yp(1)).subscribe((function(){e._changeDetectorRef.detectChanges(),e._calculateOverlayOffsetX(),e.panel.nativeElement.scrollTop=e._scrollTop}))}},{key:"_getPanelTheme",value:function(){return this._parentFormField?"mat-"+this._parentFormField.color:""}},{key:"empty",get:function(){return!this._selectionModel||this._selectionModel.isEmpty()}},{key:"_initializeSelection",value:function(){var e=this;Promise.resolve().then((function(){e._setSelectionByValue(e.ngControl?e.ngControl.value:e._value),e.stateChanges.next()}))}},{key:"_setSelectionByValue",value:function(e){var t=this;if(this.multiple&&e){if(!Array.isArray(e))throw Error("Value must be an array in multiple-selection mode.");this._selectionModel.clear(),e.forEach((function(e){return t._selectValue(e)})),this._sortValues()}else{this._selectionModel.clear();var n=this._selectValue(e);n?this._keyManager.setActiveItem(n):this.panelOpen||this._keyManager.setActiveItem(-1)}this._changeDetectorRef.markForCheck()}},{key:"_selectValue",value:function(e){var t=this,n=this.options.find((function(n){try{return null!=n.value&&t._compareWith(n.value,e)}catch(i){return Ei()&&console.warn(i),!1}}));return n&&this._selectionModel.select(n),n}},{key:"_initKeyManager",value:function(){var e=this;this._keyManager=new L_(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(Ky(this._destroy)).subscribe((function(){e.panelOpen&&(!e.multiple&&e._keyManager.activeItem&&e._keyManager.activeItem._selectViaInteraction(),e.focus(),e.close())})),this._keyManager.change.pipe(Ky(this._destroy)).subscribe((function(){e._panelOpen&&e.panel?e._scrollActiveOptionIntoView():e._panelOpen||e.multiple||!e._keyManager.activeItem||e._keyManager.activeItem._selectViaInteraction()}))}},{key:"_resetOptions",value:function(){var e=this,t=J(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Ky(t)).subscribe((function(t){e._onSelect(t.source,t.isUserInput),t.isUserInput&&!e.multiple&&e._panelOpen&&(e.close(),e.focus())})),J.apply(void 0,_toConsumableArray(this.options.map((function(e){return e._stateChanges})))).pipe(Ky(t)).subscribe((function(){e._changeDetectorRef.markForCheck(),e.stateChanges.next()})),this._setOptionIds()}},{key:"_onSelect",value:function(e,t){var n=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(n!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),t&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),t&&this.focus())):(e.deselect(),this._selectionModel.clear(),this._propagateChanges(e.value)),n!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}},{key:"_sortValues",value:function(){var e=this;if(this.multiple){var t=this.options.toArray();this._selectionModel.sort((function(n,i){return e.sortComparator?e.sortComparator(n,i,t):t.indexOf(n)-t.indexOf(i)})),this.stateChanges.next()}}},{key:"_propagateChanges",value:function(e){var t;t=this.multiple?this.selected.map((function(e){return e.value})):this.selected?this.selected.value:e,this._value=t,this.valueChange.emit(t),this._onChange(t),this.selectionChange.emit(new cM(this,t)),this._changeDetectorRef.markForCheck()}},{key:"_setOptionIds",value:function(){this._optionIds=this.options.map((function(e){return e.id})).join(" ")}},{key:"_highlightCorrectOption",value:function(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}},{key:"_scrollActiveOptionIntoView",value:function(){var e,t,n,i,r=this._keyManager.activeItemIndex||0,a=pb(r,this.options,this.optionGroups);this.panel.nativeElement.scrollTop=(e=r+a,t=this._getItemHeight(),n=this.panel.nativeElement.scrollTop,(i=e*t)<n?i:i+t>n+256?Math.max(0,i-256+t):n)}},{key:"focus",value:function(e){this._elementRef.nativeElement.focus(e)}},{key:"_getOptionIndex",value:function(e){return this.options.reduce((function(t,n,i){return void 0!==t?t:e===n?i:void 0}),void 0)}},{key:"_calculateOverlayPosition",value:function(){var e=this._getItemHeight(),t=this._getItemCount(),n=Math.min(t*e,256),i=t*e-n,r=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);r+=pb(r,this.options,this.optionGroups);var a=n/2;this._scrollTop=this._calculateOverlayScroll(r,a,i),this._offsetY=this._calculateOverlayOffsetY(r,a,i),this._checkOverlayWithinViewport(i)}},{key:"_calculateOverlayScroll",value:function(e,t,n){var i=this._getItemHeight();return Math.min(Math.max(0,i*e-t+i/2),n)}},{key:"_getAriaLabel",value:function(){return this.ariaLabelledby?null:this.ariaLabel||this.placeholder}},{key:"_getAriaLabelledby",value:function(){return this.ariaLabelledby?this.ariaLabelledby:this._parentFormField&&this._parentFormField._hasFloatingLabel()&&!this._getAriaLabel()&&this._parentFormField._labelId||null}},{key:"_getAriaActiveDescendant",value:function(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}},{key:"_calculateOverlayOffsetX",value:function(){var e,t=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),n=this._viewportRuler.getViewportSize(),i=this._isRtl(),r=this.multiple?56:32;if(this.multiple)e=40;else{var a=this._selectionModel.selected[0]||this.options.first;e=a&&a.group?32:16}i||(e*=-1);var o=0-(t.left+e-(i?r:0)),s=t.right+e-n.width+(i?0:r);o>0?e+=o+8:s>0&&(e-=s+8),this.overlayDir.offsetX=Math.round(e),this.overlayDir.overlayRef.updatePosition()}},{key:"_calculateOverlayOffsetY",value:function(e,t,n){var i,r=this._getItemHeight(),a=(r-this._triggerRect.height)/2,o=Math.floor(256/r);return this._disableOptionCentering?0:(i=0===this._scrollTop?e*r:this._scrollTop===n?(e-(this._getItemCount()-o))*r+(r-(this._getItemCount()*r-256)%r):t-r/2,Math.round(-1*i-a))}},{key:"_checkOverlayWithinViewport",value:function(e){var t=this._getItemHeight(),n=this._viewportRuler.getViewportSize(),i=this._triggerRect.top-8,r=n.height-this._triggerRect.bottom-8,a=Math.abs(this._offsetY),o=Math.min(this._getItemCount()*t,256)-a-this._triggerRect.height;o>r?this._adjustPanelUp(o,r):a>i?this._adjustPanelDown(a,i,e):this._transformOrigin=this._getOriginBasedOnOption()}},{key:"_adjustPanelUp",value:function(e,t){var n=Math.round(e-t);this._scrollTop-=n,this._offsetY-=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}},{key:"_adjustPanelDown",value:function(e,t,n){var i=Math.round(e-t);if(this._scrollTop+=i,this._offsetY+=i,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=n)return this._scrollTop=n,this._offsetY=0,void(this._transformOrigin="50% top 0px")}},{key:"_getOriginBasedOnOption",value:function(){var e=this._getItemHeight(),t=(e-this._triggerRect.height)/2;return"50% ".concat(Math.abs(this._offsetY)-t+e/2,"px 0px")}},{key:"_getItemCount",value:function(){return this.options.length+this.optionGroups.length}},{key:"_getItemHeight",value:function(){return 3*this._triggerFontSize}},{key:"setDescribedByIds",value:function(e){this._ariaDescribedby=e.join(" ")}},{key:"onContainerClick",value:function(){this.focus(),this.open()}},{key:"shouldLabelFloat",get:function(){return this._panelOpen||!this.empty}}]),t}(hM)).\u0275fac=function(e){return new(e||eM)(To(f_),To(Ga),To(Su),To(Bx),To(Vs),To(s_,8),To(RC,8),To(UC,8),To(zP,8),To(vk,10),Eo("tabindex"),To(sM),To(X_),To(lM,8))},eM.\u0275cmp=yt({type:eM,selectors:[["mat-select"]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,dM,!0),Yl(n,fb,!0),Yl(n,lb,!0)),2&e&&(Wl(i=$l())&&(t.customTrigger=i.first),Wl(i=$l())&&(t.options=i),Wl(i=$l())&&(t.optionGroups=i))},viewQuery:function(e,t){var n;1&e&&(Xl(WP,!0),Xl(ZP,!0),Xl(uT,!0)),2&e&&(Wl(n=$l())&&(t.trigger=n.first),Wl(n=$l())&&(t.panel=n.first),Wl(n=$l())&&(t.overlayDir=n.first))},hostAttrs:["role","listbox",1,"mat-select"],hostVars:19,hostBindings:function(e,t){1&e&&Fo("keydown",(function(e){return t._handleKeydown(e)}))("focus",(function(){return t._onFocus()}))("blur",(function(){return t._onBlur()})),2&e&&(wo("id",t.id)("tabindex",t.tabIndex)("aria-label",t._getAriaLabel())("aria-labelledby",t._getAriaLabelledby())("aria-required",t.required.toString())("aria-disabled",t.disabled.toString())("aria-invalid",t.errorState)("aria-owns",t.panelOpen?t._optionIds:null)("aria-multiselectable",t.multiple)("aria-describedby",t._ariaDescribedby||null)("aria-activedescendant",t._getAriaActiveDescendant()),rs("mat-select-disabled",t.disabled)("mat-select-invalid",t.errorState)("mat-select-required",t.required)("mat-select-empty",t.empty))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Ls([{provide:mP,useExisting:eM},{provide:db,useExisting:eM}]),bs,Es],ngContentSelectors:rM,decls:9,vars:9,consts:[["cdk-overlay-origin","","aria-hidden","true",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],[3,"ngClass","keydown"],["panel",""]],template:function(e,t){if(1&e&&(Wo(iM),Ao(0,"div",0,1),Fo("click",(function(){return t.toggle()})),Ao(3,"div",2),Co(4,XP,2,1,"span",3),Co(5,JP,3,2,"span",4),Ro(),Ao(6,"div",5),Oo(7,"div",6),Ro(),Ro(),Co(8,QP,4,11,"ng-template",7),Fo("backdropClick",(function(){return t.close()}))("attach",(function(){return t._onAttached()}))("detach",(function(){return t.close()}))),2&e){var n=So(1);yr(3),Mo("ngSwitch",t.empty),yr(1),Mo("ngSwitchCase",!0),yr(1),Mo("ngSwitchCase",!1),yr(3),Mo("cdkConnectedOverlayScrollStrategy",t._scrollStrategy)("cdkConnectedOverlayOrigin",n)("cdkConnectedOverlayOpen",t.panelOpen)("cdkConnectedOverlayPositions",t._positions)("cdkConnectedOverlayMinWidth",null==t._triggerRect?null:t._triggerRect.width)("cdkConnectedOverlayOffsetY",t._offsetY)}},directives:[lT,eh,th,uT,nh,Dc],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[aM.transformPanelWrap,aM.transformPanel]},changeDetection:0}),eM),pM=(($P=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:$P}),$P.\u0275inj=ve({factory:function(e){return new(e||$P)},providers:[uM],imports:[[sh,hT,vb,mx],p_,BP,vb,mx]}),$P),mM={provide:new qe("mat-autocomplete-scroll-strategy"),deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition()}}},vM=((nM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:nM}),nM.\u0275inj=ve({factory:function(e){return new(e||nM)},providers:[mM],imports:[[vb,hT,mx,sh],p_,vb,mx]}),nM);function gM(e,t){}var yM=_createClass((function e(){_classCallCheck(this,e),this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0})),_M={dialogContainer:Wh("dialogContainer",[Yh("void, exit",Kh({opacity:0,transform:"scale(0.7)"})),Yh("enter",Kh({transform:"none"})),Jh("* => enter",Zh("150ms cubic-bezier(0, 0, 0.2, 1)",Kh({transform:"none",opacity:1}))),Jh("* => void, * => exit",Zh("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",Kh({opacity:0})))])};function xM(){throw Error("Attempting to attach dialog content after content is already attached")}var bM,wM,kM,CM,SM,TM,EM,PM,MM=((bM=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t))._elementRef=e,o._focusTrapFactory=n,o._changeDetectorRef=i,o._config=a,o._elementFocusedBeforeDialogWasOpened=null,o._state="enter",o._animationStateChanged=new Dl,o.attachDomPortal=function(e){return o._portalOutlet.hasAttached()&&xM(),o._setupFocusTrap(),o._portalOutlet.attachDomPortal(e)},o._ariaLabelledBy=a.ariaLabelledBy||null,o._document=r,o}return _inherits(t,e),_createClass(t,[{key:"attachComponentPortal",value:function(e){return this._portalOutlet.hasAttached()&&xM(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(e)}},{key:"attachTemplatePortal",value:function(e){return this._portalOutlet.hasAttached()&&xM(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(e)}},{key:"_recaptureFocus",value:function(){this._containsFocus()||this._focusTrap.focusInitialElement()||this._elementRef.nativeElement.focus()}},{key:"_trapFocus",value:function(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}},{key:"_restoreFocus",value:function(){var e=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&e&&"function"==typeof e.focus){var t=this._document.activeElement,n=this._elementRef.nativeElement;t&&t!==this._document.body&&t!==n&&!n.contains(t)||e.focus()}this._focusTrap&&this._focusTrap.destroy()}},{key:"_setupFocusTrap",value:function(){var e=this;this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then((function(){return e._elementRef.nativeElement.focus()})))}},{key:"_containsFocus",value:function(){var e=this._elementRef.nativeElement,t=this._document.activeElement;return e===t||e.contains(t)}},{key:"_onAnimationDone",value:function(e){"enter"===e.toState?this._trapFocus():"exit"===e.toState&&this._restoreFocus(),this._animationStateChanged.emit(e)}},{key:"_onAnimationStart",value:function(e){this._animationStateChanged.emit(e)}},{key:"_startExitAnimation",value:function(){this._state="exit",this._changeDetectorRef.markForCheck()}}]),t}(vS)).\u0275fac=function(e){return new(e||bM)(To(Vs),To(q_),To(Ga),To(rc,8),To(yM))},bM.\u0275cmp=yt({type:bM,selectors:[["mat-dialog-container"]],viewQuery:function(e,t){var n;1&e&&Zl(_S,!0),2&e&&Wl(n=$l())&&(t._portalOutlet=n.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(e,t){1&e&&jo("@dialogContainer.start",(function(e){return t._onAnimationStart(e)}))("@dialogContainer.done",(function(e){return t._onAnimationDone(e)})),2&e&&(wo("id",t._id)("role",t._config.role)("aria-labelledby",t._config.ariaLabel?null:t._ariaLabelledBy)("aria-label",t._config.ariaLabel)("aria-describedby",t._config.ariaDescribedBy||null),_s("@dialogContainer",t._state))},features:[bs],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,t){1&e&&Co(0,gM,0,0,"ng-template",0)},directives:[_S],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[_M.dialogContainer]}}),bM),IM=0,AM=function(){function e(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mat-dialog-"+IM++;_classCallCheck(this,e),this._overlayRef=t,this._containerInstance=n,this.id=r,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new I,this._afterClosed=new I,this._beforeClosed=new I,this._state=0,n._id=r,n._animationStateChanged.pipe(Rp((function(e){return"done"===e.phaseName&&"enter"===e.toState})),Yp(1)).subscribe((function(){i._afterOpened.next(),i._afterOpened.complete()})),n._animationStateChanged.pipe(Rp((function(e){return"done"===e.phaseName&&"exit"===e.toState})),Yp(1)).subscribe((function(){clearTimeout(i._closeFallbackTimeout),i._finishDialogClose()})),t.detachments().subscribe((function(){i._beforeClosed.next(i._result),i._beforeClosed.complete(),i._afterClosed.next(i._result),i._afterClosed.complete(),i.componentInstance=null,i._overlayRef.dispose()})),t.keydownEvents().pipe(Rp((function(e){return 27===e.keyCode&&!i.disableClose&&!v_(e)}))).subscribe((function(e){e.preventDefault(),i.close()})),t.backdropClick().subscribe((function(){i.disableClose?i._containerInstance._recaptureFocus():i.close()}))}return _createClass(e,[{key:"close",value:function(e){var t=this;this._result=e,this._containerInstance._animationStateChanged.pipe(Rp((function(e){return"start"===e.phaseName})),Yp(1)).subscribe((function(n){t._beforeClosed.next(e),t._beforeClosed.complete(),t._overlayRef.detachBackdrop(),t._closeFallbackTimeout=setTimeout((function(){return t._finishDialogClose()}),n.totalTime+100)})),this._containerInstance._startExitAnimation(),this._state=1}},{key:"afterOpened",value:function(){return this._afterOpened.asObservable()}},{key:"afterClosed",value:function(){return this._afterClosed.asObservable()}},{key:"beforeClosed",value:function(){return this._beforeClosed.asObservable()}},{key:"backdropClick",value:function(){return this._overlayRef.backdropClick()}},{key:"keydownEvents",value:function(){return this._overlayRef.keydownEvents()}},{key:"updatePosition",value:function(e){var t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this._getPositionStrategy().width(e).height(t),this._overlayRef.updatePosition(),this}},{key:"addPanelClass",value:function(e){return this._overlayRef.addPanelClass(e),this}},{key:"removePanelClass",value:function(e){return this._overlayRef.removePanelClass(e),this}},{key:"getState",value:function(){return this._state}},{key:"_finishDialogClose",value:function(){this._state=2,this._overlayRef.dispose()}},{key:"_getPositionStrategy",value:function(){return this._overlayRef.getConfig().positionStrategy}}]),e}(),RM=new qe("MatDialogData"),OM=new qe("mat-dialog-default-options"),NM=new qe("mat-dialog-scroll-strategy"),DM={provide:NM,deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.block()}}},zM=((CM=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this._overlay=t,this._injector=n,this._defaultOptions=r,this._parentDialog=o,this._overlayContainer=s,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new I,this._afterOpenedAtThisLevel=new I,this._ariaHiddenElements=new Map,this.afterAllClosed=Ip((function(){return l.openDialogs.length?l._afterAllClosed:l._afterAllClosed.pipe(om(void 0))})),this._scrollStrategy=a}return _createClass(e,[{key:"openDialogs",get:function(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}},{key:"afterOpened",get:function(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}},{key:"_afterAllClosed",get:function(){var e=this._parentDialog;return e?e._afterAllClosed:this._afterAllClosedAtThisLevel}},{key:"open",value:function(e,t){var n=this;if((t=function(e,t){return Object.assign(Object.assign({},t),e)}(t,this._defaultOptions||new yM)).id&&this.getDialogById(t.id))throw Error('Dialog with id "'.concat(t.id,'" exists already. The dialog id must be unique.'));var i=this._createOverlay(t),r=this._attachDialogContainer(i,t),a=this._attachDialogContent(e,r,i,t);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.afterClosed().subscribe((function(){return n._removeOpenDialog(a)})),this.afterOpened.next(a),a}},{key:"closeAll",value:function(){this._closeDialogs(this.openDialogs)}},{key:"getDialogById",value:function(e){return this.openDialogs.find((function(t){return t.id===e}))}},{key:"ngOnDestroy",value:function(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}},{key:"_createOverlay",value:function(e){var t=this._getOverlayConfig(e);return this._overlay.create(t)}},{key:"_getOverlayConfig",value:function(e){var t=new OS({positionStrategy:this._overlay.position().global(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(t.backdropClass=e.backdropClass),t}},{key:"_attachDialogContainer",value:function(e,t){var n=so.create({parent:t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,providers:[{provide:yM,useValue:t}]}),i=new fS(MM,t.viewContainerRef,n,t.componentFactoryResolver);return e.attach(i).instance}},{key:"_attachDialogContent",value:function(e,t,n,i){var r=new AM(n,t,i.id);if(e instanceof dl)t.attachTemplatePortal(new pS(e,null,{$implicit:i.data,dialogRef:r}));else{var a=this._createInjector(i,r,t),o=t.attachComponentPortal(new fS(e,i.viewContainerRef,a));r.componentInstance=o.instance}return r.updateSize(i.width,i.height).updatePosition(i.position),r}},{key:"_createInjector",value:function(e,t,n){var i=e&&e.viewContainerRef&&e.viewContainerRef.injector,r=[{provide:MM,useValue:n},{provide:RM,useValue:e.data},{provide:AM,useValue:t}];return!e.direction||i&&i.get(s_,null)||r.push({provide:s_,useValue:{value:e.direction,change:bp()}}),so.create({parent:i||this._injector,providers:r})}},{key:"_removeOpenDialog",value:function(e){var t=this.openDialogs.indexOf(e);t>-1&&(this.openDialogs.splice(t,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((function(e,t){e?t.setAttribute("aria-hidden",e):t.removeAttribute("aria-hidden")})),this._ariaHiddenElements.clear(),this._afterAllClosed.next()))}},{key:"_hideNonDialogContentFromAssistiveTechnology",value:function(){var e=this._overlayContainer.getContainerElement();if(e.parentElement)for(var t=e.parentElement.children,n=t.length-1;n>-1;n--){var i=t[n];i===e||"SCRIPT"===i.nodeName||"STYLE"===i.nodeName||i.hasAttribute("aria-live")||(this._ariaHiddenElements.set(i,i.getAttribute("aria-hidden")),i.setAttribute("aria-hidden","true"))}}},{key:"_closeDialogs",value:function(e){for(var t=e.length;t--;)e[t].close()}}]),e}()).\u0275fac=function(e){return new(e||CM)($e(aT),$e(so),$e(Cc,8),$e(OM,8),$e(NM),$e(CM,12),$e(VS))},CM.\u0275prov=me({token:CM,factory:CM.\u0275fac}),CM),LM=((kM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:kM}),kM.\u0275inj=ve({factory:function(e){return new(e||kM)},providers:[zM,DM],imports:[[hT,wS,mx],mx]}),kM),BM=((wM=function(){function e(){_classCallCheck(this,e),this.changes=new I,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}return _createClass(e,[{key:"formatYearRange",value:function(e,t){return"".concat(e," \u2013 ").concat(t)}}]),e}()).\u0275fac=function(e){return new(e||wM)},wM.\u0275prov=me({factory:function(){return new wM},token:wM,providedIn:"root"}),wM),FM={provide:new qe("mat-datepicker-scroll-strategy"),deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition()}}},jM=((PM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:PM}),PM.\u0275inj=ve({factory:function(e){return new(e||PM)},providers:[BM,FM],imports:[[sh,jT,LM,hT,ox,wS],p_]}),PM),HM=((EM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:EM}),EM.\u0275inj=ve({factory:function(e){return new(e||EM)},imports:[[ib,mx],mx]}),EM),VM=((TM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:TM}),TM.\u0275inj=ve({factory:function(e){return new(e||TM)}}),TM),UM=((SM=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:SM}),SM.\u0275inj=ve({factory:function(e){return new(e||SM)},imports:[[ib,mx,P_,VM],mx,VM]}),SM);function qM(e,t){1&e&&(Ao(0,"div"),Oo(1,"img",7),Ro())}function GM(e,t){1&e&&(Ao(0,"div"),ms(1," :"),Ao(2,"mat-icon"),ms(3,"keyboard_backspace"),Ro(),Ro())}function WM(e,t){if(1&e&&(Ao(0,"p",12),ms(1),Ro()),2&e){var n=qo().$implicit;yr(1),vs(n.name)}}function ZM(e,t){if(1&e&&(Ao(0,"mat-list",8),Ao(1,"a",9),Ao(2,"mat-icon",10),ms(3),Ro(),Co(4,WM,2,1,"p",11),Ro(),Ro()),2&e){var n=t.$implicit,i=qo();yr(1),Xo("routerLink",n.link),yr(1),Mo("matTooltip",i.isExpanded?null:n.name),yr(1),gs(" ",n.icon,""),yr(1),Mo("ngIf",i.isExpanded)}}function XM(e,t){if(1&e&&(Ao(0,"mat-list",8),Ao(1,"a",9),Ao(2,"mat-icon",10),ms(3),Ro(),Ro(),Ro()),2&e){var n=t.$implicit,i=qo();yr(1),Xo("routerLink",n.link),yr(1),Mo("matTooltip",i.isExpanded?null:n.name),yr(1),gs(" ",n.icon," ")}}for(var KM,YM,JM=((YM=_createClass((function e(){_classCallCheck(this,e),this.toggleMenu=new Dl,this.routeLinks=[{link:"map",name:"Map",icon:"language icon"},{link:"Occupancy",name:"Occupancy",icon:"dashboard"},{link:"IAQ",name:"IAQ",icon:"opacity icon"},{link:"PM",name:"Premetive Maintenance",icon:" extension icon"}],this.tools=[{link:"Settings",name:"Settings",icon:"settings"},{link:"Users",name:"User Management",icon:"supervised_user_circle"}]}))).\u0275fac=function(e){return new(e||YM)},YM.\u0275cmp=yt({type:YM,selectors:[["side-nav"]],inputs:{isExpanded:"isExpanded"},outputs:{toggleMenu:"toggleMenu"},decls:12,vars:6,consts:[[1,"toggle"],[1,"icon-button"],[4,"ngIf"],[1,"menuBreak"],[1,"middle"],["class","nav",4,"ngFor","ngForOf"],[1,"bottom"],["src","/assets/blue user.png","alt","",1,"icon"],[1,"nav"],["mat-list-item","","routerLinkActive","active-link",1,"hover",3,"routerLink"],["mat-list-icon","","matTooltipPosition","right",3,"matTooltip"],["matLine","",4,"ngIf"],["matLine",""]],template:function(e,t){1&e&&(Ao(0,"section"),Ao(1,"div",0),Ao(2,"div"),Ao(3,"button",1),Co(4,qM,2,0,"div",2),Co(5,GM,4,0,"div",2),Ro(),Ro(),Ro(),Ao(6,"div",3),Oo(7,"hr"),Ro(),Ao(8,"div",4),Co(9,ZM,5,4,"mat-list",5),Ro(),Ao(10,"div",6),Co(11,XM,4,3,"mat-list",5),Ro(),Ro()),2&e&&(rs("sidenav",t.isExpanded),yr(4),Mo("ngIf",!t.isExpanded),yr(1),Mo("ngIf",t.isExpanded),yr(4),Mo("ngForOf",t.routeLinks),yr(2),Mo("ngForOf",t.tools))},directives:[Fc,Lc,nk,nS,aS,Bg,qg,rS,RT,Fx],styles:[".row[_ngcontent-%COMP%]{display:grid;align-content:space-between;height:100%}.middle[_ngcontent-%COMP%]{margin-top:50%;margin-bottom:0}.bottom[_ngcontent-%COMP%]{margin-top:200%;margin-bottom:0}.icon-button[_ngcontent-%COMP%]{background:none;padding:0;border:0;cursor:pointer}.icon-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:50px}.menuBreak[_ngcontent-%COMP%]{width:100%;height:10px;display:flex;align-items:center;justify-content:center}.menuBreak[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{width:50%;height:3px;background-color:#353535;border:none;border-radius:5px}.sidenav[_ngcontent-%COMP%]{width:auto;display:grid}.toggle[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;padding:25px 0}.toggle[_ngcontent-%COMP%]:hover{cursor:pointer}.nav[_ngcontent-%COMP%]   .active-link[_ngcontent-%COMP%]{background-color:#fafafa;border-left:3px solid #1976d2}.nav[_ngcontent-%COMP%]   .hover[_ngcontent-%COMP%]{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:transform,border,background-color}.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{border:none;box-sizing:border-box;text-decoration:none}.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#fafafa;border-left:3px solid #1976d2}.nav[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}"]}),YM),QM=((KM=function(){function e(t){_classCallCheck(this,e),this.router=t,this.isExpanded=!1,this.router.navigate(["/map"])}return _createClass(e,[{key:"toggleMenu",value:function(){this.isExpanded=!this.isExpanded}}]),e}()).\u0275fac=function(e){return new(e||KM)(To(zg))},KM.\u0275cmp=yt({type:KM,selectors:[["app-root"]],decls:7,vars:4,consts:[["autosize",""],["fixedInViewport","true","mode","side",3,"opened"],["sidenav",""],[3,"isExpanded","toggleMenu"],[1,"content-container"]],template:function(e,t){1&e&&(Ao(0,"mat-sidenav-container",0),Ao(1,"mat-sidenav",1,2),Ao(3,"side-nav",3),Fo("toggleMenu",(function(){return t.toggleMenu()})),Ro(),Ro(),Ao(4,"mat-sidenav-content"),Ao(5,"div",4),Oo(6,"router-outlet"),Ro(),Ro(),Ro()),2&e&&(yr(1),Xo("opened",t.isExpanded),yr(2),Mo("isExpanded",t.isExpanded),yr(1),is("margin-left",t.isExpanded?250:60,"px"))},directives:[qb,Vb,JM,Hb,Zg],styles:[".content-container[_ngcontent-%COMP%] {\n        min-height: 100vh;\n        box-sizing: border-box;\n        padding: 25px;\n      }"]}),KM),$M=n("/t/I"),eI=n.n($M),tI=n("A1R+"),nI=n.n(tI),iI=n("Vfn7"),rI=n.n(iI),aI=[],oI=0;oI<6;oI++)aI[oI]=[];var sI=[];function lI(e,t,n){var i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_;a=(i=e)[1],o=i[2],u=i[5],c=i[6],f=i[9],p=i[10],g=i[13],y=i[14],uI(aI[0],(s=i[3])-(r=i[0]),(h=i[7])-(l=i[4]),(m=i[11])-(d=i[8]),(_=i[15])-(v=i[12])),uI(aI[1],s+r,h+l,m+d,_+v),uI(aI[2],s+a,h+u,m+f,_+g),uI(aI[3],s-a,h-u,m-f,_-g),uI(aI[4],s-o,h-c,m-p,_-y),uI(aI[5],s+o,h+c,m+p,_+y);for(var x=0;x<6;x++)if(!n||"0"!==n.charAt(x)){var b=aI[x];if(sI[0]=b[0]>0?t[1][0]:t[0][0],sI[1]=b[1]>0?t[1][1]:t[0][1],sI[2]=b[2]>0?t[1][2]:t[0][2],cI(b,sI)<0)return!1}return!0}function uI(e,t,n,i,r){return e[0]=t*(1/6),e[1]=n*(1/6),e[2]=i*(1/6),e[3]=r*(1/6),e}function cI(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]}var hI={idleLog:!1,idleTimeRemaining:8,idleForceTimeThreshold:100,idleTimeout:1e3,workerCount:window.MAPTALKS_WORKER_COUNT||0,taskCountPerWorkerMessage:5},dI=["MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"],fI=["FeatureCollection","Feature","Point","LineString","Polygon"].concat(dI),pI=["markerFile","polygonPatternFile","linePatternFile","markerFillPatternFile","markerLinePatternFile"],mI=[["markerWidth","markerHeight"],[],[null,"lineWidth"],[],[null,"markerLineWidth"]],vI={lineWidth:1,lineOpacity:1,lineDx:1,lineDy:1,polygonOpacity:1,markerWidth:1,markerHeight:1,markerDx:1,markerDy:1,markerOpacity:1,markerFillOpacity:1,markerLineWidth:1,markerLineOpacity:1,textSize:1,textOpacity:1,textHaloRadius:1,textWrapWidth:1,textLineSpacing:1,textDx:1,textDy:1},gI=["lineColor","polygonFill","markerFill","markerLineColor","textFill"];function yI(){return Date.now()}function _I(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function xI(e){return null==e}function bI(e){return"number"==typeof e&&!isNaN(e)}function wI(e){return(0|e)===e}function kI(e){return"object"==typeof e&&!!e}function CI(e){return!xI(e)&&("string"==typeof e||null!==e.constructor&&e.constructor===String)}function SI(e){return!xI(e)&&("function"==typeof e||null!==e.constructor&&e.constructor===Function)}var TI=Object.prototype.hasOwnProperty;function EI(e,t){return TI.call(e,t)}var PI=Math.PI/180;function MI(e){return e*PI}function II(e){return e/PI}var AI="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&!process.versions.electron&&!process.versions.nw&&!process.versions["node-webkit"],RI={};function OI(){return window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI}if(!AI){var NI=navigator.userAgent.toLowerCase(),DI=document.documentElement||{style:{}},zI="ActiveXObject"in window,LI=-1!==NI.indexOf("webkit"),BI=-1!==NI.indexOf("phantom"),FI=-1!==NI.search("android [23]"),jI=-1!==NI.indexOf("chrome"),HI=-1!==NI.indexOf("gecko")&&!LI&&!window.opera&&!zI,VI=/iphone/i.test(NI)&&/micromessenger/i.test(NI),UI="undefined"!=typeof orientation||-1!==NI.indexOf("mobile"),qI=!window.PointerEvent&&window.MSPointerEvent,GI=window.PointerEvent&&navigator.pointerEnabled||qI,WI=zI&&"transition"in DI.style,ZI="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!FI,XI="MozPerspective"in DI.style,KI="OTransition"in DI.style,YI=(WI||ZI||XI)&&!KI&&!BI,JI="undefined"!=typeof window&&SI(window.createImageBitmap),QI="undefined"!=typeof window&&SI(window.ResizeObserver),$I="undefined"!=typeof window&&SI(window.btoa),eA="undefined"!=typeof window&&SI(window.Proxy),tA="undefined"!=typeof window&&SI(window.requestIdleCallback),nA=0;jI&&(nA=NI.match(/chrome\/([\d.]+)/)[1]);var iA=!BI&&(GI||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),rA="undefined"!=typeof window&&"WebGLRenderingContext"in window,aA=OI(),oA=!1;try{new OffscreenCanvas(2,2).getContext("2d"),oA=!0}catch(U5){oA=!1}var sA=!1;try{window.addEventListener("testPassive",(function(){}),{get passive(){sA=!0}})}catch(q5){}RI={isTest:!1,ie:zI,ielt9:zI&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:LI,gecko:HI,android:-1!==NI.indexOf("android"),android23:FI,chrome:jI,chromeVersion:nA,safari:!jI&&-1!==NI.indexOf("safari"),phantomjs:BI,ie3d:WI,webkit3d:ZI,gecko3d:XI,opera12:KI,any3d:YI,iosWeixin:VI,mobile:UI,mobileWebkit:UI&&LI,mobileWebkit3d:UI&&ZI,mobileOpera:UI&&window.opera,mobileGecko:UI&&HI,touch:!!iA,msPointer:!!qI,pointer:!!GI,retina:aA>1,devicePixelRatio:aA,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:zI&&9===document.documentMode,ie10:zI&&10===document.documentMode,webgl:rA,imageBitMap:JI,resizeObserver:QI,btoa:$I,decodeImageInWorker:oA,monitorDPRChange:!0,supportsPassive:sA,proxy:eA,requestIdleCallback:tA,checkDevicePixelRatio:function(){if("undefined"!=typeof window&&RI.monitorDPRChange){var e=OI(),t=e!==RI.devicePixelRatio;return t&&(RI.devicePixelRatio=e),t}return!1}}}var lA=RI;function uA(){return(uA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function cA(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,dA(e,t)}function hA(e){return(hA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dA(e,t){return(dA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function fA(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(q5){return!1}}function pA(e,t,n){return(pA=fA()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&dA(r,n.prototype),r}).apply(null,arguments)}function mA(e){var t="function"==typeof Map?new Map:void 0;return(mA=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return pA(e,arguments,hA(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),dA(n,e)})(e)}function vA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gA,yA,_A=function(){function e(e,t,n){if(xI(e)||xI(t)?xI(e.x)||xI(e.y)?Array.isArray(e)&&(this.x=+e[0],this.y=+e[1],this.z=e[2]):(this.x=+e.x,this.y=+e.y,this.z=e.z):(this.x=+e,this.y=+t,this.z=n),this._isNaN())throw new Error("Position is NaN")}var t=e.prototype;return t.set=function(e,t,n){return this.x=e,this.y=t,this.z=n||0,this},t.abs=function(){return new this.constructor(Math.abs(this.x),Math.abs(this.y))},t._abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.round=function(){return new this.constructor(Math.round(this.x),Math.round(this.y))},t._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.ceil=function(){return new this.constructor(Math.ceil(this.x),Math.ceil(this.y))},t.distanceTo=function(e){var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},t.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.floor=function(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))},t.copy=function(){return new this.constructor(this.x,this.y,this.z)},t._add=function(e,t){return xI(e.x)?xI(e[0])?(this.x+=e,this.y+=t):(this.x+=e[0],this.y+=e[1]):(this.x+=e.x,this.y+=e.y),this},t.add=function(e,t){var n,i;return xI(e.x)?xI(e[0])?(n=this.x+e,i=this.y+t):(n=this.x+e[0],i=this.y+e[1]):(n=this.x+e.x,i=this.y+e.y),new this.constructor(n,i)},t._sub=function(e,t){return xI(e.x)?xI(e[0])?(this.x-=e,this.y-=t):(this.x-=e[0],this.y-=e[1]):(this.x-=e.x,this.y-=e.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(e,t){var n,i;return xI(e.x)?xI(e[0])?(n=this.x-e,i=this.y-t):(n=this.x-e[0],i=this.y-e[1]):(n=this.x-e.x,i=this.y-e.y),new this.constructor(n,i)},t.substract=function(){return this.sub.apply(this,arguments)},t.multi=function(e){return new this.constructor(this.x*e,this.y*e)},t._multi=function(e){return this.x*=e,this.y*=e,this},t.div=function(e){return this.multi(1/e)},t._div=function(e){return this._multi(1/e)},t.equals=function(e){return e instanceof this.constructor&&this.x===e.x&&this.y===e.y&&this.z===e.z},t._isNaN=function(){return isNaN(this.x)||isNaN(this.y)||bI(this.z)&&isNaN(this.z)},t.isZero=function(){return 0===this.x&&0===this.y},t.toArray=function(){return bI(this.z)?[this.x,this.y,this.z]:[this.x,this.y]},t.toFixed=function(e){return new this.constructor(this.x.toFixed(e),this.y.toFixed(e),bI(this.z)?this.z.toFixed:void 0)},t.toJSON=function(){var e={x:this.x,y:this.y};return bI(this.z)&&(e.z=this.z),e},e}(),xA=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.closeTo=function(e,t){return t||(t=0),this.x>=e.x-t&&this.x<=e.x+t&&this.y>=e.y-t&&this.y<=e.y+t},n.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.unit=function(){return this.copy()._unit()},n._unit=function(){return this._div(this.mag()),this},n.perp=function(){return this.copy()._perp()},n._perp=function(){var e=this.y;return this.y=this.x,this.x=-e,this},n.angleWith=function(e){return this.angleWithSep(e.x,e.y)},n.angleWithSep=function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},n._rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=i,this},n.rotate=function(e){return this.copy()._rotate(e)},t}(_A);function bA(e){return e.length>4&&".svg"===e.slice(-4)?1:"data:image/svg+xml"===e.slice(0,"data:image/svg+xml".length)?2:0}function wA(e,t){AI&&wA.node?wA.node(e,t):e.src=t[0]}!function(){if(AI)return gA=function(e){return setTimeout(e,16)},void(yA=clearTimeout);var e,t;function n(e){return setTimeout(e,1e3/30)}function i(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}"undefined"!=typeof window?(e=window.requestAnimationFrame||i("RequestAnimationFrame")||n,t=window.cancelAnimationFrame||i("CancelAnimationFrame")||i("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)}):(e=n,t=clearTimeout),gA=function(t){return e(t)},yA=function(e){e&&t(e)}}();var kA=0;function CA(){return kA++}function SA(e){return e&&CI(e)?JSON.parse(e):e}function TA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n&&n.length)for(var i=0,r=n.length;i<r;i++)e.push(n[i])}return e.length}function EA(e,t){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function PA(e,t,n){if(!Array.isArray(e))return n?t.call(n,e):t(e);for(var i,r,a=[],o=0,s=e.length;o<s;o++)xI(i=e[o])?a.push(null):Array.isArray(i)?a.push(PA(i,t,n)):(r=n?t.call(n,i):t(i),a.push(r));return a}function MA(e,t){return void 0===e?t:e}function IA(e){return Math.sign?Math.sign(e):0==(e=+e)||isNaN(e)?Number(e):e>0?1:-1}function AA(e,t,n){return e*(1-n)+t*n}function RA(e,t,n){if(e===n||e===t)return e;var i=n-t;return((e-t)%i+i)%i+t}function OA(e,t,n){return Math.min(n,Math.max(t,e))}function NA(e){return Array.isArray(e)&&e.length>0}var DA=/^url\((['"])(.+)\1\)$/i,zA=/^url\(([^'"].*[^'"])\)$/i;function LA(e){var t=function(e){return CI(e)?zA.test(e)?1:DA.test(e)?2:3:0}(e);return 3===t?e:1===t?zA.exec(e)[1]:2===t?DA.exec(e)[2]:e}function BA(e,t,n,i){return Math.atan2(i-t,n-e)}var FA="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function jA(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;for(var n in e)if("center"===n){if(!t[n]||!HA(e[n][0],t[n][0])||!HA(e[n][1],t[n][1]))return!1}else if(e[n]!==t[n])return!1;return!0}function HA(e,t,n){return null==n&&(n=1e-6),e>=t-n&&e<=t+n}function VA(e,t,n,i){e||(e=100),t||(t=4);var r=this,a=this.isVisible();return t*=2,this._flashTimeout&&clearTimeout(this._flashTimeout),this._flashTimeout=setTimeout((function o(){if(0===t)return a?r.show():r.hide(),void(n&&(i?n.call(i):n()));t%2==0?r.hide():r.show(),t--,r._flashTimeout=setTimeout(o,e)}),e),this}function UA(e,t){void 0===e&&(e=[]),void 0===t&&(t="_pt");for(var n=[],i=0,r=e.length;i<r;i++){var a=e[i];if(a){a[t]||(a[t]=new xA(0,0));var o=a[t];o.x=0,o.y=0,n.push(o)}else n.push(null)}return n}function qA(e,t){t(e.data)}function GA(e){if(e&&0===e.indexOf("http://")||0===e.indexOf("https://"))return e;var t=document.createElement("a");return t.href=e,e=t.href,t=null,e}var WA,ZA={cssWidth:"1px",cssHeight:"1px",width:1,height:1};function XA(e,t){void 0===t&&(t=1);var n=e.width,i=e.height;return ZA.cssWidth=n+"px",ZA.cssHeight=i+"px",ZA.width=Math.round(n*t),ZA.height=Math.round(i*t),ZA}var KA={width:100,height:10};function YA(){if(!WA){var e=KA.width,t=KA.height;OffscreenCanvas?WA=new OffscreenCanvas(e,t):((WA=document.createElement("canvas")).width=e,WA.height=t)}return WA}var JA,QA=function(){function e(e,t){if(void 0===t&&(t={}),Array.isArray(e))if(e.length<2)console.error("colors.length should >1");else{this.colors=e;for(var n=1/0,i=-1/0,r=0,a=e.length;r<a;r++){var o=e[r][0];n=Math.min(o,n),i=Math.max(o,i)}this.min=n,this.max=i,this.valueOffset=this.max-this.min,this.options=Object.assign({},KA,t),this._initImgData()}else console.error("colors is not array")}var t=e.prototype;return t.getImageData=function(){return this.imgData},t._initImgData=function(){var e=YA(),t=this.options,n=t.height;e.width=t.width,e.height=n;var i=e.getContext("2d");i.clearRect(0,0,e.width,e.height);for(var r=i.createLinearGradient(0,0,e.width,0),a=this.colors,o=this.valueOffset,s=0,l=a.length;s<l;s++){var u=a[s];r.addColorStop((u[0]-this.min)/o,u[1])}i.fillStyle=r,i.fillRect(0,0,e.width,e.height),this.imgData=i.getImageData(0,0,e.width,e.height)},t.getColor=function(e){e=Math.max(this.min,e),e=Math.min(e,this.max);var t=Math.round((e-this.min)/this.valueOffset*this.imgData.width),n=4*(t=Math.min(t,this.imgData.width-1));return[this.imgData.data[n],this.imgData.data[n+1],this.imgData.data[n+2],this.imgData.data[n+3]]},e}();function $A(e,t){for(var n=0;n<e.stops.length;n++)if(t===e.stops[n][0])return e.stops[n][1];return e.default}function eR(e,t){for(var n=0;n<e.stops.length&&!(t<e.stops[n][0]);n++);return e.stops[Math.max(n-1,0)][1]}function tR(e,t){for(var n=void 0!==e.base?e.base:1,i=0;!(i>=e.stops.length||t<=e.stops[i][0]);)i++;return 0===i?e.stops[i][1]:i===e.stops.length?e.stops[i-1][1]:function e(t,n,i,r,a,o){return"function"==typeof a?function(){var s=a.apply(void 0,arguments),l=o.apply(void 0,arguments);return e(t,n,i,r,s,l)}:a.length?function(e,t,n,i,r,a){for(var o=[],s=0;s<r.length;s++)o[s]=aR(e,t,n,i,r[s],a[s]);return o}(t,n,i,r,a,o):aR(t,n,i,r,a,o)}(t,n,e.stops[i-1][0],e.stops[i][0],e.stops[i-1][1],e.stops[i][1])}"function"==typeof Map&&(JA=new Map);var nR={width:100,height:1};function iR(e,t){var n=e.stops;if(n&&n.length>1){var i;if(JA){var r=JSON.stringify(n);if(!JA.has(r)){var a=new QA(n,nR);JA.set(r,a)}i=JA.get(r)}else i=new QA(n,nR);var o=i.getColor(t);return[o[0]/255,o[1]/255,o[2]/255,o[3]/255]}return n&&1===n.length?n[0][1]:null}function rR(e,t){return i=e.default,void 0!==(n=t)?n:void 0!==i?i:null;var n,i}function aR(e,t,n,i,r,a){var o,s=i-n,l=e-n;return r*(1-(o=1===t?l/s:(Math.pow(t,l)-1)/(Math.pow(t,s)-1)))+a*o}function oR(e){return e&&"object"==typeof e&&(e.stops||e.property&&"identity"===e.type)}function sR(e){for(var t in e)if(oR(e[t]))return!0;return!1}function lR(e){return function e(t,n){if(!oR(t))return function(){return t};var i=!0,r=!0,a=(t=JSON.parse(JSON.stringify(t))).stops;if(a)for(var o=0;o<a.length;o++)if(oR(a[o][1])){var s=e(a[o][1],n);i=i&&s.isZoomConstant,r=r&&s.isFeatureConstant,a[o]=[a[o][0],s]}var l=function e(t,n){var i,r,a;if(oR(t)){var o,s=t.stops&&"object"==typeof t.stops[0][0],l=s||!(s||void 0!==t.property),u=t.type||n||"exponential";if("exponential"===u)o=tR;else if("interval"===u)o=eR;else if("categorical"===u)o=$A;else if("identity"===u)o=rR;else{if("color-interpolate"!==u)throw new Error('Unknown function type "'+u+'"');o=iR}if(s){for(var c={},h=[],d=0;d<t.stops.length;d++){var f=t.stops[d];void 0===c[f[0].zoom]&&(c[f[0].zoom]={zoom:f[0].zoom,type:t.type,property:t.property,default:t.default,stops:[]}),c[f[0].zoom].stops.push([f[0].value,f[1]])}for(var p in c)h.push([c[p].zoom,e(c[p])]);i=function(e,n){var i=tR({stops:h,base:t.base},e)(e,n);return"function"==typeof i?i(e,n):i},r=!1,a=!1}else l?(i=function(e){var n=o(t,e);return"function"==typeof n?n(e):n},r=!0,a=!1):(i=function(e,n){var i=o(t,n?n[t.property]:null);return"function"==typeof i?i(e,n):i},r=!1,a=!0)}else i=function(){return t},r=!0,a=!0;return i.isZoomConstant=a,i.isFeatureConstant=r,i}(t,n);return l.isZoomConstant=i&&l.isZoomConstant,l.isFeatureConstant=r&&l.isFeatureConstant,l}(e,"exponential")}function uR(e,t){if(!e)return null;var n=!1;if(Array.isArray(e)){for(var i,r=[],a=0;a<e.length;a++)(i=uR(e[a],t))?(r.push(i),n=!0):r.push(e[a]);return n?r:e}var o,s={__fn_types_loaded:!0},l=[];for(o in e)e.hasOwnProperty(o)&&l.push(o);for(var u=function(e){Object.defineProperty(s,e,{get:function(){return this["__fn_"+e]||(this["__fn_"+e]=lR(this["_"+e])),this["__fn_"+e].apply(this,t())},set:function(t){this["_"+e]=t},configurable:!0,enumerable:!0})},c=0,h=l.length;c<h;c++)oR(e[o=l[c]])?(n=!0,s["_"+o]=e[o],u(o)):s[o]=e[o];return n?s:e}function cR(e){if(!e||!e.stops)return[];for(var t=[],n=0,i=e.stops.length;n<i;n++)t.push(e.stops[n][1]);return t}var hR=["Unknown","Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"];function dR(e){return new Function("f","var p = (f && f.properties || {}); return "+fR(e))}function fR(e){if(!e)return"true";var t,n,i,r=e[0];return e.length<=1?"any"===r?"false":"true":"("+("=="===r?mR(e[1],e[2],"===",!1):"!="===r?mR(e[1],e[2],"!==",!1):"<"===r||">"===r||"<="===r||">="===r?mR(e[1],e[2],r,!0):"any"===r?gR(e.slice(1),"||"):"all"===r?gR(e.slice(1),"&&"):"none"===r?xR(gR(e.slice(1),"||")):"in"===r?yR(e[1],e.slice(2)):"!in"===r?xR(yR(e[1],e.slice(2))):"has"===r?_R(e[1]):"!has"===r?xR(_R(e[1])):"contains"===r?(t=e[2],n=e[3],i=pR(e[1]),void 0!==n?"("+i+" + '').indexOf(\""+t+'") === '+n:"("+i+" + '').indexOf(\""+t+'") >= 0'):"true")+")"}function pR(e){return"$"===e[0]?"f."+e.substring(1):"p["+JSON.stringify(e)+"]"}function mR(e,t,n,i){return"object"==typeof(r=e)&&r&&e.op?function(e,t,n,i){var r=e.property,a=e.op,o=pR(r);return"length"!==a?(console.error("not support "+a+" op"),"false"):vR(o="(("+o+"+='').length)",r,t,n,i)}(e,t,n,i):vR(pR(e),e,t,n,i);var r}function vR(e,t,n,i,r){var a="$type"===t?hR.indexOf(n):JSON.stringify(n);return(r?"typeof "+e+"=== typeof "+a+"&&":"")+e+i+a}function gR(e,t){return e.map(fR).join(t)}function yR(e,t){"$type"===e&&(t=t.map((function(e){return hR.indexOf(e)})));var n=JSON.stringify(t.sort(bR)),i=pR(e);return t.length<=200?n+".indexOf("+i+") !== -1":"function(v, a, i, j) {\n        while (i <= j) { var m = (i + j) >> 1;\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\n        }\n    return false; }("+i+", "+n+",0,"+(t.length-1)+")"}function _R(e){return"$id"===e?'"id" in f':JSON.stringify(e)+" in p"}function xR(e){return"!("+e+")"}function bR(e,t){return e<t?-1:e>t?1:0}function wR(e){var t=e._toJSON(),n=t.feature;return n.type=hR.indexOf(n.geometry.type),n.subType=t.subType,n}function kR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}var CR=[],SR={};function TR(e,t){return uR(e,(function(){var e,n,i,r,a,o,s,l=t.getMap();return e=CR,n=l?l.getZoom():12,i=_I({},t.getProperties(),(r=SR,a=l&&l.getBearing()||0,o=l&&l.getPitch()||0,s=l?l.getZoom():10,r["{bearing}"]=a,r["{pitch}"]=o,r["{zoom}"]=s,r)),e[0]=n,e[1]=i,e}))}function ER(e,t,n){if(!e.markerPath)return null;var i,r,a=1,o=(0===(r={stroke:{stroke:(i=e).markerLineColor,"stroke-width":i.markerLineWidth,"stroke-opacity":i.markerLineOpacity,"stroke-dasharray":null,"stroke-linecap":"butt","stroke-linejoin":"round"},fill:{fill:i.markerFill,"fill-opacity":i.markerFillOpacity}}).stroke["stroke-width"]&&(r.stroke["stroke-opacity"]=0),r);bI(e.markerOpacity)&&(a=e.markerOpacity),bI(e.opacity)&&(a*=e.opacity);var s={};if(o){for(var l in o.stroke)o.stroke.hasOwnProperty(l)&&(xI(o.stroke[l])||(s[l]=o.stroke[l]));for(var u in o.fill)o.fill.hasOwnProperty(u)&&(xI(o.fill[u])||(s[u]=o.fill[u]))}for(var c,h=Array.isArray(e.markerPath)?e.markerPath:[e.markerPath],d=[],f=0;f<h.length;f++)(c=_I({},c=CI(h[f])?{path:h[f]}:h[f],s)).d=c.path,delete c.path,d.push(c);var p=['<svg version="1.1"','xmlns="http://www.w3.org/2000/svg"'];a<1&&p.push('opacity="'+a+'"'),e.markerPathWidth&&e.markerPathHeight&&p.push('viewBox="0 0 '+e.markerPathWidth+" "+e.markerPathHeight+'"'),p.push('preserveAspectRatio="none"'),t&&p.push('width="'+t+'"'),n&&p.push('height="'+n+'"'),p.push("><defs></defs>");for(var m=0;m<d.length;m++){var v="<path ";for(var g in d[m])d[m].hasOwnProperty(g)&&(v+=" "+g+'="'+d[m][g]+'"');p.push(v+="></path>")}return p.push("</svg>"),"data:image/svg+xml;base64,"+function(e){if(lA.btoa)return window.btoa(e);for(var t,n,i=String(e),r="",a=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.charAt(0|a)||(o="=",a%1);r+=o.charAt(63&t>>8-a%1*8)){if((n=i.charCodeAt(a+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|n}return r}(p.join(" "))}function PR(e,t){if(!e)return[];var n=e;Array.isArray(e)||(n=[e]);for(var i,r,a,o,s=[],l=pI,u=n.length-1;u>=0;u--)if(e=n[u]){t&&(e=MR(e));for(var c=0;c<l.length;c++)if(oR(i=e[l[c]])&&(i=cR(i)),i){Array.isArray(i)||(i=[i]);for(var h=0;h<i.length;h++)"url("===i[h].slice(0,4)&&(i[h]=LA(i[h])),s.push([i[h],e[(r=mI[c])[0]],e[r[1]]])}if("path"===e.markerType&&e.markerPath)if(a=oR(e.markerWidth)?200:e.markerWidth,o=oR(e.markerHeight)?200:e.markerHeight,oR(e.markerPath)){i=cR(e.markerPath);for(var d=e.markerPath,f=0;f<i.length;f++)e.markerPath=i[f],s.push([ER(e),a,o]);e.markerPath=d}else s.push([ER(e),a,o])}return s}function MR(e){if(!e)return null;var t=e;if(AI)return t;for(var n,i=pI,r=0,a=i.length;r<a;r++)(n=t[i[r]])&&(t[i[r]]=IR(n));return t}function IR(e){if(oR(e)&&e.stops){for(var t=e.stops,n=0;n<t.length;n++)t[n][1]=IR(t[n][1]);return e}return"url("===e.slice(0,4)&&(e=LA(e)),e}var AR=function(){function e(e,t){bI(e)&&bI(t)?(this.width=e,this.height=t):bI(e.width)?(this.width=e.width,this.height=e.height):Array.isArray(e)&&(this.width=e[0],this.height=e[1])}var t=e.prototype;return t.copy=function(){return new e(this.width,this.height)},t.add=function(t,n){var i,r;return t instanceof e?(i=this.width+t.width,r=this.height+t.height):(i=this.width+t,r=this.height+n),new e(i,r)},t.equals=function(e){return this.width===e.width&&this.height===e.height},t.multi=function(t){return new e(this.width*t,this.height*t)},t._multi=function(e){return this.width*=e,this.height*=e,this},t._round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.toPoint=function(){return new xA(this.width,this.height)},t.toArray=function(){return[this.width,this.height]},t.toJSON=function(){return{width:this.width,height:this.height}},e}();function RR(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}var OR=/[\b\t\r\v\f]/gim;function NR(e){return CI(e)?e.replace(OR,""):e}var DR="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):null;function zR(e,t){return zR.node?zR.node(e,t):(DR.font=t,DR.measureText(e).width)}function LR(e,t,n){var i=zR(e,t);return new AR(i,n||14)}function BR(e,t,n,i){if(!e||0===e.length)return[{text:"",width:0}];var r=xI(i)?zR(e,t):i,a=r/e.length,o=Math.floor(n/a/2);if(a>=n||o<=0)return[{text:"",width:n}];if(r<=n)return[{text:e,width:r}];for(var s=[],l=e.substring(0,o),u=a*o,c=o,h=e.length;c<h;c++){var d=e[c],f=zR(l+d);f>=n?(s.push({text:l,width:u}),l=e.substring(c,o+c),c+=o-1,u=a*o):(l+=d,u=f),c>=h-1&&(u=zR(l),s.push({text:l,width:u}))}return s}var FR=/\{([\w_]+)\}/g;function jR(e,t){return CI(e)?e.replace(FR,(function(e,n){if(!t)return"";var i=t[n];return xI(i)?"":Array.isArray(i)?i.join():i})):e}function HR(e,t){bI(e)&&(e+="");var n=t.textMaxHeight||0,i=qR(e=e||"",t);return n&&n<i.size.height&&(i.size.height=n),i}function VR(e,t,n){var i=e.width,r=e.height;return new xA("left"===t?-i:"right"===t?0:-i/2,"top"===n?-r:"bottom"===n?0:-r/2)}function UR(e){if(e.textFont)return e.textFont;var t=e.textSize;return xI(t)&&(t=14),(e.textStyle&&"normal"!==e.textStyle?e.textStyle+" ":"")+(e.textWeight&&"normal"!==e.textWeight?e.textWeight+" ":"")+t+"px "+(e.textFaceName?e.textFaceName:"monospace")}function qR(e,t){var n=UR(t),i=t.textLineSpacing||0,r=LR(e,n,t.textSize),a=r.width,o=r.height,s=t.textWrapCharacter||"\n",l=[],u=t.textWrapWidth;(!u||u>a)&&(u=a),CI(e)||(e+="");var c=0;if(s&&e.indexOf(s)>=0)for(var h=e.split(s),d=0,f=h.length;d<f;d++){var p=h[d],m=zR(p,n);if(m>u)for(var v=BR(p,n,u,m),g=0,y=v.length;g<y;g++){var _=v[g].width;_>c&&(c=_),l.push({text:v[g].text,size:new AR(_,o)})}else m>c&&(c=m),l.push({text:p,size:new AR(m,o)})}else if(a>u)for(var x=BR(e,n,u,a),b=0;b<x.length;b++){var w=x[b].width;w>c&&(c=w),l.push({text:x[b].text,size:new AR(w,o)})}else a>c&&(c=a),l.push({text:e,size:r});var k=l.length;return{total:k,size:new AR(c,o*k+i*(k-1)),rows:l,rawSize:r}}function GR(e){var t=0,n=e&&e.length||0;if(!n)return t;for(var i=0;i<n;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t}function WR(e){return e&&e.colorStops}function ZR(e){var t=[e.type];if(e.places&&t.push(e.places.join()),e.colorStops){for(var n=[],i=e.colorStops.length-1;i>=0;i--)n.push(e.colorStops[i].join());t.push(n.join(","))}return t.join("_")}function XR(e,t){if(!e)return 1;var n=[];if(Array.isArray(e)){for(var i=0;i<e.length;i++)n.push(XR(e[i],t));return n.sort().join(",")}var r=Object.keys(e).sort().reduce((function(n,i){return t&&0!==i.indexOf(t)||(n[i]=e[i]),n}),{});return GR(JSON.stringify(r))}function KR(e,t){function n(e,t){xI(e.opacity)?e.opacity=t:e.opacity*=t}var i;if(Array.isArray(e)){i=[];for(var r=0;r<e.length;r++){var a=_I({},e[r]);n(a,t),i.push(a)}}else n(i=_I({},e),t);return i}function YR(e){var t=Array.prototype.slice.call(arguments,1);if(t&&t.length||(t=[{}]),Array.isArray(e)){for(var n,i,r=[],a=0,o=e.length;a<o;a++){n=e[a],i={};for(var s=0,l=t.length;s<l;s++)Array.isArray(t[s])?xI(t[s][a])?_I(i,n||{}):_I(i,n,t[s][a]):_I(i,n,t[s]?t[s]:{});r.push(i)}return r}var u=[{},e];return u.push.apply(u,t),_I.apply(this,u)}var JR=/(\{\$root\}|\{\$iconset\})/g;function QR(e,t){for(var n in e)e.hasOwnProperty(n)&&"textName"!==n&&(CI(e[n])&&e[n].length>2?e[n]=e[n].replace(JR,t):oR(e[n])?e[n]=$R(e[n],t):kI(e[n])&&QR(e[n],t))}function $R(e,t){var n=e.default;CI(n)&&(e.default=n.replace(JR,t));var i=e.stops;if(!i)return e;for(var r=0;r<i.length;r++)Array.isArray(i[r])&&(CI(i[r][1])?i[r][1]=i[r][1].replace(JR,t):oR(i[r][1])&&(i[r][1]=$R(i[r][1],t)));return e}var eO=AI?function(e){return e[0]}:function(e){for(var t=document.documentElement&&document.documentElement.style||{},n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1},tO=eO(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),nO=eO(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),iO=eO(["transition","WebkitTransition","OTransition","MozTransition","msTransition"]);function rO(e,t){var n=document.createElement(e);return t&&yO(n,t),n}function aO(e,t,n){var i=rO(e);return t&&mO(i,t),n&&n.appendChild(i),i}function oO(e){if(!e)return this;if(lA.ielt9||lA.ie9){var t=rO("div");t.appendChild(e),t.innerHTML="",t=null}else e.parentNode&&e.parentNode.removeChild(e);return this}function sO(e,t,n,i){if(!(e&&e.addEventListener&&t&&n))return this;for(var r=function(t){t||(t=window.event),n.call(i||e,t)},a=t.split(" "),o=a.length-1;o>=0;o--){var s=a[o];s&&(e["Z__"+s]||(e["Z__"+s]=[]),uO(e,s,n)>=0&&(console.warn(e,"find '"+s+"' handler:",n," The old listener function will be removed"),lO(e,s,n)),e["Z__"+s].push({callback:r,src:n}),e.addEventListener(s,r,!!lA.supportsPassive&&{capture:!1,passive:!1}))}return this}function lO(e,t,n){function i(t,n){"mousewheel"===t&&lA.gecko&&(t="DOMMouseScroll"),e.removeEventListener(t,n,!1)}if(!e||!e.removeEventListener||!t)return this;for(var r=t.split(" "),a=r.length-1;a>=0;a--){var o=r[a];if(o){if(!n&&e["Z__"+o]){for(var s=e["Z__"+o],l=0,u=s.length;l<u;l++)i(s[l].callback);return delete e["Z__"+o],this}var c=uO(e,o,n);if(c<0)return this;i(o,e["Z__"+o][c].callback),e["Z__"+o].splice(c,1)}}return this}function uO(e,t,n){if(!e||!e["Z__"+t]||!n)return-1;for(var i=e["Z__"+t],r=0,a=i.length;r<a;r++)if(i[r].src===n)return r;return-1}function cO(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function hO(e){return e._cancelBubble=!0,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this}function dO(e,t){return e?(lA.any3d?function(e,t){var n=t||new xA(0,0);e.style[tO]=lA.any3d?"translate3d("+n.x+"px,"+n.y+"px,0px)":"translate("+n.x+"px,"+n.y+"px)"}(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px"),t):null}function fO(e){var t=window.getComputedStyle(e),n=[parseInt(t["padding-left"]),parseInt(t["padding-top"])],i=e.getBoundingClientRect(),r=e.offsetWidth,a=e.offsetHeight;return e.__position=[i.left+n[0],i.top+n[1],r?i.width/r:1,a?i.height/a:1],e.__position}function pO(e,t){e||(e=window.event);var n=t.__position;return n||(n=fO(t)),new xA((e.clientX-n[0]-t.clientLeft)/n[2],(e.clientY-n[1]-t.clientTop)/n[3])}function mO(e,t){var n,i,r=e.style.cssText;return(i=(n=r).length-";".length)>=0&&n.indexOf(";",i)===i||(r+=";"),e.style.cssText=r+t,this}function vO(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=_O(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function gO(e,t){if(void 0===e.classList||vO(e,t)){var n=_O(e);yO(e,(n?n+" ":"")+t)}else for(var i=RR(t).split(/\s+/),r=0,a=i.length;r<a;r++)e.classList.add(i[r]);return this}function yO(e,t){return xI(e.className.baseVal)?e.className=t:e.className.baseVal=t,this}function _O(e){return xI(e.className.baseVal)?e.className:e.className.baseVal}function xO(e,t){var n,i=((n=document.createElement(e)).style.cssText="position:absolute;left:-10000px;top:-10000px;",document.body.appendChild(n),n);CI(t)?i.innerHTML=t:i.appendChild(t);var r=new AR(i.clientWidth,i.clientHeight);return oO(i),r}eO(["filter","WebkitFilter","OFilter","MozFilter","msFilter"]);var bO=sO,wO=lO;function kO(e){return e&&("mousemove"===e||"touchmove"===e)}function CO(e,t){var n=yI();return!!(e._mousemoveTime&&n-e._mousemoveTime<(t||48))||(e._mousemoveTime=n,!1)}var SO,TO="undefined"!=typeof Promise?Promise:eI.a,EO=!1,PO=[];function MO(e){return PO.indexOf(e)>-1}function IO(e){MO(e)||PO.push(e)}var AO,RO,OO={},NO="undefined"!=typeof window?window.navigator.hardwareConcurrency||4:0,DO=Math.max(Math.floor(NO/2),1),zO=function(){function e(e){void 0===e&&(e=50),this._limit=e,this._messages=[],this.buffers=[]}var t=e.prototype;return t.addMessage=function(e,t){if(this._messages.push(e),Array.isArray(t))for(var n=0;n<t.length;n++)this.buffers.indexOf(t[n])<0&&this.buffers.push(t[n])},t.isFull=function(){return this._messages.length>=this._limit},t.getMessage=function(){return{messageType:"batch",messages:this._messages}},e}(),LO=function(){function e(){this.active={},this.workerCount="undefined"!=typeof window?hI.workerCount||DO:0,this._messages=[],this._messageBuffers=[]}var t=e.prototype;return t.acquire=function(e){if(!this.workers){this.workers=[];for(var t=function(){if("undefined"==typeof window)return null;if(!AO){var e=function(){var e="\n    var adapters = {};\n    // Dynamic Create Adapter\n    function createAdapter(key,code){\n        if(adapters[key]||!code){\n            return;\n        }\n        var func=new Function('exports',code+'(exports)');\n        var workerExports={};\n        func(workerExports,self);\n        adapters[key]=workerExports;\n        workerExports.initialize && workerExports.initialize(self);\n        \n    }\n    onmessage = function (msg) {\n        msg = msg.data;\n        //createAdapter\n        if (msg.messageType === 'createAdapter') {\n           var key=msg.key;\n           var code=msg.code;\n           createAdapter(key,code);\n           postMessage({adapterName:key});\n           return;\n        }\n        // postMessage when main thread idle\n        if(msg.messageType==='idle'){\n            var messageCount = msg.messageCount||5;\n            handleMessageQueue(messageCount);\n            return;\n        }\n        if (msg.messageType === 'batch') {\n            const messages = msg.messages;\n            if (messages) {\n                for (let i = 0; i < messages.length; i++) {\n                    dispatch(messages[i]);\n                }\n            }\n        } else {\n            dispatch(msg);\n        }\n    };\n\n    function dispatch(msg) {\n        var workerKey = msg.workerKey;\n        var adapter = adapters[workerKey];\n        if (!adapter) {\n            post(msg.callback, 'Unregistered worker adapters for ' + workerKey);\n            return;\n        }\n        try {\n            adapter.onmessage(msg, wrap(msg.callback));\n        } catch (err) {\n            post(msg.callback, workerKey + ':' + err.message);\n            console.error(err);\n            throw err;\n        }\n    }\n\n    var messageResultQueue = [];\n    \n    function handleMessageQueue(messageCount){\n       if(messageResultQueue.length===0){\n          return;\n       }\n       var queues = messageResultQueue.slice(0,messageCount);\n       queues.forEach(function(queue){\n          post(queue.callback,queue.err,queue.data,queue.buffers);\n       });\n       messageResultQueue=messageResultQueue.slice(messageCount,Infinity);\n    }\n\n    function post(callback, err, data, buffers) {\n        var msg = {\n            callback : callback\n        };\n        if (err) {\n            msg.error = err;\n        } else {\n            msg.data = data;\n        }\n        if (buffers && buffers.length > 0) {\n            postMessage(msg, buffers);\n        } else {\n            postMessage(msg);\n        }\n    }\n\n    function joinQueue(callback,err,data,buffers){\n        messageResultQueue.push({\n            callback:callback,\n            err:err,\n            data:data,\n            buffers:buffers\n        });\n    }\n\n    function wrap(callback) {\n        return function (err, data, buffers) {\n            joinQueue(callback, err, data, buffers);\n        };\n    }\n    var workerExports;\n";for(var t in OO){var n=OO[t];IO(t),SI(n)&&0===n.length&&(n=n()),e+="\n    workerExports = {};\n    ("+n+")(workerExports, self);\n    adapters['"+t+"'] = workerExports",e+="\n    workerExports.initialize && workerExports.initialize(self);\n        "}return e+"\n    workerExports = null;\n"}();AO=window.URL.createObjectURL(new Blob([e],{type:"text/javascript"})),OO={}}return AO}(),n=0;n<this.workerCount;n++){var i=new Worker(t);i.id=n,this.workers.push(i)}URL.revokeObjectURL(t),EO=!0}return this.active[e]=!0,this.workers.slice()},t.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)},t.addMessage=function(e,t,n){var i=this._messages[e];i&&i.length||(i=this._messages[e]=[new zO]);var r=i[i.length-1];r.isFull()&&(r=new zO,this._messages[e].push(r)),r.addMessage(t,n)},t.commit=function(){if(this.workers&&this._messages.length)for(var e=0;e<this._messages.length;e++)if(this._messages[e]&&this._messages[e].length){var t=this._messages[e].shift();this.workers[e].postMessage(t.getMessage(),t.buffers)}},t.getWorkers=function(){return this.workers||[]},t.broadcastIdleMessage=function(){return this.getWorkers().forEach((function(e){e.postMessage({messageType:"idle",messageCount:hI.taskCountPerWorkerMessage})})),this},e}();function BO(){return RO||(RO=new LO,SO=RO),RO}var FO=[],jO=!0;function HO(){jO?BO().broadcastIdleMessage():BO().commit(),function(){if(0!==FO.length){for(var e=[],t=[],n=FO.length,i=0;i<n;i++){var r=FO[i];if(r.count--,-1===r.count)t.push(r);else{e.push(r);var a=r.run();r.results.push(a)}}FO=e,n=t.length;for(var o=0;o<n;o++){var s=t[o];s.resolve&&s.resolve(s.results)}}}(),jO=!jO}var VO=yI();function UO(e){var t=hI.idleTimeRemaining,n=hI.idleLog,i=hI.idleTimeout,r=hI.idleForceTimeThreshold;if(lA.requestIdleCallback){if(e&&e.timeRemaining){var a=e.timeRemaining();a>t||e.didTimeout?(e.didTimeout&&n&&console.error("idle timeout in",i),HO(),VO=yI()):(yI()-VO>r&&(HO(),VO=yI()),a<=t&&n&&console.warn("currrent page is busy,the timeRemaining is",a))}requestIdleCallback(UO,{timeout:i})}else HO(),gA(UO),n&&console.warn("current env not support requestIdleCallback. Fallback to requestAnimFrame")}var qO=!1;function GO(){qO||(qO=!0,lA.requestIdleCallback?requestIdleCallback(UO,{timeout:hI.idleTimeout}):gA(UO))}var WO,ZO="function"==typeof Map,XO=function(){},KO=function(){function e(e,t){this.max=e,this.onRemove=t||XO,this.reset()}var t=e.prototype;return t.reset=function(){for(var e in this.data)this.onRemove(this.data[e]);return this.data={},this.order=[],this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(e,t){if(this.has(e))this.order.splice(this.order.indexOf(e),1),this.data[e]=t,this.order.push(e);else if(this.data[e]=t,this.order.push(e),this.order.length>this.max){var n=this.getAndRemove(this.order[0]);n&&this.onRemove(n)}return this},t.has=function(e){return e in this.data},t.keys=function(){return this.order},t.getAndRemove=function(e){if(!this.has(e))return null;var t=this.data[e];return delete this.data[e],this.order.splice(this.order.indexOf(e),1),t},t.get=function(e){return this.has(e)?this.data[e]:null},t.remove=function(e){if(!this.has(e))return this;var t=this.data[e];return delete this.data[e],this.onRemove(t),this.order.splice(this.order.indexOf(e),1),this},t.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this.getAndRemove(this.order[0]);t&&this.onRemove(t)}return this},e}();ZO&&(WO=function(){function e(e,t){this.max=e,this.onRemove=t||XO,this.reset()}var t=e.prototype;return t.reset=function(){if(this.data){var e=this.data.values(),t=Array.isArray(e),n=0;for(e=t?e:e[Symbol.iterator]();;){var i;if(t){if(n>=e.length)break;i=e[n++]}else{if((n=e.next()).done)break;i=n.value}this.onRemove(i)}}return this.data=new Map,this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(e,t){return t?(this.has(e)?(this.data.delete(e),this.data.set(e,t)):this.data.set(e,t),this):this},t.keys=function(){var e=new Array(this.data.size),t=0,n=this.data.keys(),i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var a;if(i){if(r>=n.length)break;a=n[r++]}else{if((r=n.next()).done)break;a=r.value}e[t++]=a}return e},t.shrink=function(){for(var e=this.data.keys(),t=e.next();this.data.size>this.max;){var n=this.getAndRemove(t.value);n&&this.onRemove(n),t=e.next()}},t.has=function(e){return this.data.has(e)},t.getAndRemove=function(e){if(!this.has(e))return null;var t=this.data.get(e);return this.data.delete(e),t},t.get=function(e){return this.has(e)?this.data.get(e):null},t.remove=function(e){if(!this.has(e))return this;var t=this.data.get(e);return this.data.delete(e),this.onRemove(t),this},t.setMaxSize=function(e){return this.max=e,this.data.size>this.max&&this.shrink(),this},e}());var YO=ZO?WO:KO,JO={jsonp:function(e,t){var n="_maptalks_jsonp_"+CA();e.match(/\?/)?e+="&callback="+n:e+="?callback="+n;var i=document.createElement("script");return i.type="text/javascript",i.src=e,window[n]=function(e){t(null,e),document.getElementsByTagName("head")[0].removeChild(i),i=null,delete window[n]},document.getElementsByTagName("head")[0].appendChild(i),this},get:function(e,t,n){if(SI(t)){var i=n;n=t,t=i}if(AI&&JO.get.node)return JO.get.node(e,n,t);var r=JO._getClient(n);if(r.open("GET",e,!0),t){for(var a in t.headers)r.setRequestHeader(a,t.headers[a]);r.withCredentials="include"===t.credentials,t.responseType&&(r.responseType=t.responseType)}return r.send(null),r},post:function(e,t,n){var i;if(CI(e)){if(SI(t)){var r=n;n=t,t=r}i=(t=t||{}).postData}else i=t,e=(t=e).url,n=n;if(AI&&JO.post.node)return t.url=e,JO.post.node(t,i,n);var a=JO._getClient(n);if(a.open("POST",t.url,!0),t.headers||(t.headers={}),t.headers["Content-Type"]||(t.headers["Content-Type"]="application/x-www-form-urlencoded"),"setRequestHeader"in a)for(var o in t.headers)t.headers.hasOwnProperty(o)&&a.setRequestHeader(o,t.headers[o]);return CI(i)||(i=JSON.stringify(i)),a.send(i),a},_wrapCallback:function(e,t){return function(){4===e.readyState&&(200===e.status?"arraybuffer"===e.responseType?0===e.response.byteLength?t(new Error("http status 200 returned without content.")):t(null,{data:e.response,cacheControl:e.getResponseHeader("Cache-Control"),expires:e.getResponseHeader("Expires"),contentType:e.getResponseHeader("Content-Type")}):t(null,e.responseText):t(new Error(e.statusText+","+e.status)))}},_getClient:function(e){var t;try{t=new XMLHttpRequest}catch(q5){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(q5){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(q5){}}}return t.onreadystatechange=JO._wrapCallback(t,e),t},getArrayBuffer:function(e,t,n){if(SI(t)){var i=n;n=t,t=i}return t||(t={}),t.responseType="arraybuffer",JO.get(e,t,n)},getImage:function(e,t,n){return JO.getArrayBuffer(t,n,(function(t,n){if(t)e.onerror&&e.onerror(t);else if(n){var i=window.URL||window.webkitURL,r=e.onload;e.onload=function(){r&&r(),i.revokeObjectURL(e.src)};var a=new Blob([new Uint8Array(n.data)],{type:n.contentType});e.cacheControl=n.cacheControl,e.expires=n.expires,e.src=n.data.byteLength?i.createObjectURL(a):FA}}))},getJSON:function(e,t,n){if(SI(t)){var i=n;n=t,t=i}var r=function(e,t){var i=t?SA(t):null;n(e,i)};return t&&t.jsonp?JO.jsonp(e,r):JO.get(e,t,r)}},QO=[1/0,1/0,-1/0,-1/0];function $O(e){e[0]=1/0,e[1]=1/0,e[2]=-1/0,e[3]=-1/0}function eN(e,t){if(e)if(Array.isArray(e[0]))for(var n=0,i=e.length;n<i;n++)eN(e[n],t);else if(Array.isArray(e))for(var r=0,a=e.length;r<a;r++){var o=e[r],s=o.x,l=o.y;t[0]=Math.min(s,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(s,t[2]),t[3]=Math.max(l,t[3])}else s=e.x,l=e.y,t[0]=Math.min(s,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(s,t[2]),t[3]=Math.max(l,t[3])}function tN(e,t,n,i,r){(0===t||t)&&(Array.isArray(t)&&(n=t[1],i=t[2],r=t[3],t=t[0]),e[0]=Math.min(t,e[0]),e[1]=Math.min(n,e[1]),e[2]=Math.max(i,e[2]),e[3]=Math.max(r,e[3]))}function nN(e){return e&&e[0]!==1/0&&void 0!==e[0]}var iN=!1,rN=null,aN=Math.PI/180,oN={getCanvas2DContext:function(e){return e.getContext("2d",{willReadFrequently:!0})},setHitTesting:function(e){iN=e},createCanvas:function(e,t,n){var i;return AI?i=new n(e,t):((i=rO("canvas")).width=e,i.height=t),i},prepareCanvasFont:function(e,t){e.textBaseline="top",e.font=UR(t);var n=t.textFill;n||(n="#000"),e.fillStyle=oN.getRgba(n,t.textOpacity)},prepareCanvas:function(e,t,n,i){if(t){var r=t.lineWidth;xI(r)||e.lineWidth===r||(e.lineWidth=r);var a=t.linePatternFile,o=t.lineColor||"#000";if(i)e.strokeStyle="#000";else if(a&&n){var s;(t.linePatternDx||t.linePatternDy)&&(s=[t.linePatternDx,t.linePatternDy]),oN._setStrokePattern(e,a,r,s,n),t.lineDasharray=[]}else WR(o)?e.strokeStyle=t.lineGradientExtent?oN._createGradient(e,o,t.lineGradientExtent):"#000":(Array.isArray(o)&&(o=oN.normalizeColorToRGBA(o)),e.strokeStyle=o);t.lineJoin&&(e.lineJoin=t.lineJoin),t.lineCap&&(e.lineCap=t.lineCap),e.setLineDash&&NA(t.lineDasharray)&&e.setLineDash(t.lineDasharray);var l=t.polygonPatternFile,u=t.polygonFill||"rgba(255,255,255,0)";if(i)e.fillStyle="#000";else if(l&&n){var c=lN(l),h=n.getImage([c,null,null]);if(h||(h=n.getImage([c+"-texture",null,r])),bA(c)&&h instanceof Image&&(lA.edge||lA.ie)){var d=h.width||20,f=h.height||20,p=oN.createCanvas(d,f);oN.image(p.getContext("2d"),h,0,0,d,f),h=p}h?(e.fillStyle=e.createPattern(h,"repeat"),(t.polygonPatternDx||t.polygonPatternDy)&&(e.fillStyle.polygonPatternOffset=[t.polygonPatternDx,t.polygonPatternDy])):"undefined"!=typeof console&&console.warn("img not found for",c)}else WR(u)?e.fillStyle=t.polygonGradientExtent?oN._createGradient(e,u,t.polygonGradientExtent):"rgba(255,255,255,0)":(Array.isArray(u)&&(u=oN.normalizeColorToRGBA(u)),e.fillStyle=u)}},_createGradient:function(e,t,n){var i=null,r=t.places,a=n.getMin(),o=n.getMax(),s=n.getWidth(),l=n.getHeight();if(t.type&&"linear"!==t.type){if("radial"===t.type){if(r){if(6!==r.length)throw new Error("A radial gradient's places should have 6 numbers.");r=[a.x+r[0]*s,a.y+r[1]*l,s*r[2],a.x+r[3]*s,a.y+r[4]*l,s*r[5]]}else{var u=n.getCenter()._round();r=[u.x,u.y,Math.abs(u.x-a.x),u.x,u.y,0]}i=e.createRadialGradient.apply(e,r)}}else{if(r){if(4!==r.length)throw new Error("A linear gradient's places should have 4 numbers.");r=[a.x+r[0]*s,a.y+r[1]*l,a.x+r[2]*s,a.y+r[3]*l]}else r=[a.x,a.y,o.x,a.y];i=e.createLinearGradient.apply(e,r)}return t.colorStops.forEach((function(e){i.addColorStop.apply(i,e)})),i},_setStrokePattern:function(e,t,n,i,r){var a,o=lN(t);if(AI)a=r.getImage([o,null,n]);else{var s=o+"-texture-"+n;if(!(a=r.getImage(s))){var l=r.getImage([o,null,null]);if(l){var u;u=l.width&&l.height?Math.round(l.width*n/l.height):n;var c=oN.createCanvas(u,n,e.canvas.constructor);oN.image(c.getContext("2d"),l,0,0,u,n),r.addResource([s,null,n],c),a=c}}}a?(e.strokeStyle=e.createPattern(a,"repeat"),e.strokeStyle.linePatternOffset=i):"undefined"!=typeof console&&console.warn("img not found for",o)},clearRect:function(e,t,n,i,r){e.canvas._drawn=!1,e.clearRect(t,n,i,r)},fillCanvas:function(e,t,n,i){if(iN&&(t=1),e.canvas._drawn=!0,0!==t){var r,a=oN._isPattern(e.fillStyle),o=e.fillStyle&&e.fillStyle.polygonPatternOffset,s=o?o[0]:0,l=o?o[1]:0;xI(t)&&(t=1),t<1&&(r=e.globalAlpha,e.globalAlpha*=t),a&&e.translate((n=n||0)+s,(i=i||0)+l),e.fill(),a&&e.translate(-n-s,-i-l),t<1&&(e.globalAlpha=r)}},getRgba:function(e,t){return xI(t)&&(t=1),"#"!==e[0]?(Array.isArray(e)&&(e=oN.normalizeColorToRGBA(e,t)),e):(7===e.length?(n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16)):(n=17*parseInt(e.substring(1,2),16),i=17*parseInt(e.substring(2,3),16),r=17*parseInt(e.substring(3,4),16)),"rgba("+n+","+i+","+r+","+t+")");var n,i,r},normalizeColorToRGBA:function(e,t){return void 0===t&&(t=1),"rgba("+255*e[0]+","+255*e[1]+","+255*e[2]+","+(4===e.length?e[3]:1)*t+")"},image:function(e,t,n,i,r,a){e.canvas._drawn=!0;try{bI(r)&&bI(a)?e.drawImage(t,n,i,r,a):e.drawImage(t,n,i)}catch(o){console&&(console.warn("error when drawing image on canvas:",o),console.warn(t))}},text:function(e,t,n,i,r){return oN._textOnMultiRow(e,r.rows,i,n,r.size,r.rawSize)},_textOnMultiRow:function(e,t,n,i,r,a){var o,s,l=VR(r,n.textHorizontalAlignment,n.textVerticalAlignment),u=a.height+n.textLineSpacing,c=i.add(0,l.y),h=n.textMaxHeight,d=0;$O(QO);for(var f=0,p=t.length;f<p;f++){o=t[f].text,s=VR(t[f].size,n.textHorizontalAlignment,n.textVerticalAlignment);var m=c.add(s.x,f*u);oN._textOnLine(e,o,m,n.textHaloRadius,n.textHaloFill,n.textHaloOpacity);var v=t[f].size,g=m.x,y=m.y;if(tN(QO,g,y,g+v.width,y+v.height),h>0&&(d+=u)+v.height>=h)break}return QO},_textOnLine:function(e,t,n,i,r,a){iN&&(a=1);var o,s,l=0!==a&&0!==i;e.textBaseline="top";var u=e.shadowBlur,c=e.shadowOffsetX,h=e.shadowOffsetY;if(l){var d=e.globalAlpha;e.globalAlpha*=a,e.miterLimit=2,e.lineJoin="round",e.lineCap="round",e.lineWidth=2*i,Array.isArray(r)&&(r=oN.normalizeColorToRGBA(r)),e.strokeStyle=r,e.strokeText(t,n.x,n.y+1),e.miterLimit=10,e.globalAlpha=d,o=e.globalCompositeOperation,e.globalCompositeOperation="destination-out",s=e.fillStyle,e.fillStyle="#000"}u&&l&&(e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0),oN.fillText(e,t,n),o&&(e.globalCompositeOperation=o,oN.fillText(e,t,n,s),u&&(e.shadowBlur=u,e.shadowOffsetX=c,e.shadowOffsetY=h))},fillText:function(e,t,n,i){e.canvas._drawn=!0,i&&(e.fillStyle=i),e.fillText(t,n.x,n.y+1)},_stroke:function(e,t,n,i){if(iN&&(t=1),e.canvas._drawn=!0,0!==t){var r,a=e.strokeStyle&&e.strokeStyle.linePatternOffset,o=a?a[0]:0,s=a?a[1]:0,l=oN._isPattern(e.strokeStyle)&&(!xI(n)&&!xI(i)||!xI(o)&&!xI(s));xI(t)&&(t=1),t<1&&(r=e.globalAlpha,e.globalAlpha*=t),l&&e.translate((n=n||0)+o,(i=i||0)+s),e.stroke(),l&&e.translate(-n-o,-i-s),t<1&&(e.globalAlpha=r)}},_path:function(e,t,n,i,r){if(NA(t))for(var a,o=NA(n),s=!0!==r&&oN._isPattern(e.strokeStyle),l=0,u=t.length;l<u;l++)if(a=t[l],!o||e.setLineDash)e.lineTo(a.x,a.y),s&&l>0&&(c(t[l-1],a),e.beginPath(),e.moveTo(a.x,a.y));else if(o){if(l===u-1)break;sN(e,a,t[l+1],n)}function c(t,n){var r=BA(t.x,t.y,n.x,n.y);e.save();var a=Math.cos(r);Math.abs(a)<1e-7?e.translate(t.x-e.lineWidth/2,t.y):e.translate(t.x,t.y-e.lineWidth/2/a),e.rotate(r),oN._stroke(e,i),e.restore()}},path:function(e,t,n,i,r){NA(t)&&(e.beginPath(),e.moveTo(t[0].x,t[0].y),oN._path(e,t,r,n),oN._stroke(e,n))},_multiClip:function(e,t){if(t&&0!==t.length)for(var n=0,i=(t=t[0]).length;n<i;n++){var r=t[n],a=r.x,o=r.y;0===n?e.moveTo(a,o):e.lineTo(a,o),n===i-1&&e.lineTo(a=t[0].x,o=t[0].y)}},polygon:function(e,t,n,i,r,a){if(e.isMultiClip)oN._multiClip(e,t);else if(e.isClip)oN._multiClip(e,Array.isArray(t[0])?t:[t]);else if(NA(t)){var o=oN._isPattern(e.strokeStyle),s=NA(r)&&!e.setLineDash||o&&!a;NA(t[0])||(t=[t]);var l,u,c,h=e;if(t.length>1&&!AI&&(rN||(rN=oN.createCanvas(1,1)),e.canvas._drawn=!1,rN.width=e.canvas.width,rN.height=e.canvas.height,cN(e=rN.getContext("2d"),[]),cN(e,r),uN(e,h)),s){for(e.save(),u=0,c=t.length;u<c;u++)NA(t[u])&&(oN._ring(e,t[u],null,0,!0),l=i,u>0&&(e.globalCompositeOperation="destination-out",l=1),oN.fillCanvas(e,l,t[u][0].x,t[u][0].y),u>0?e.globalCompositeOperation="source-over":c>1&&(e.fillStyle="#fff"),oN._stroke(e,0));e.restore()}var d=e.fillStyle;for(u=0,c=t.length;u<c;u++)NA(t[u])&&(a?(oN.paintSmoothLine(e,t[u],n,a,!0),e.closePath()):oN._ring(e,t[u],r,n),s||(l=i,u>0&&(e.globalCompositeOperation="destination-out",l=1),oN.fillCanvas(e,l,t[u][0].x,t[u][0].y),u>0?e.globalCompositeOperation="source-over":c>1&&(e.fillStyle="#fff")),oN._stroke(e,n));e.fillStyle!==d&&(e.fillStyle=d),t.length>1&&!AI&&(h.drawImage(rN,0,0),h.canvas._drawn=e.canvas._drawn,uN(h,e))}},_ring:function(e,t,n,i,r){var a=oN._isPattern(e.strokeStyle);r||!a||t[0].equals(t[t.length-1])||(t=t.concat([t[0]])),e.beginPath(),e.moveTo(t[0].x,t[0].y),oN._path(e,t,n,i,r),a||e.closePath()},paintSmoothLine:function(e,t,n,i,r,a,o){if(t)if(t.length<=2||!i)oN.path(e,t,n);else{var s,l=t.length,u=r?l:l-1;e.beginPath(),e.moveTo(t[0].x,t[0].y),void 0!==o&&(u-=Math.max(u-a-1,0));for(var c=0;c<u;c++){var h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,v=void 0;c-1<0?r?(h=t[u-1].x,d=t[u-1].y):(h=t[c+1].x,d=t[c+1].y):(h=t[c-1].x,d=t[c-1].y),c+1<l?(f=t[c+1].x,p=t[c+1].y):(f=t[c+1-l].x,p=t[c+1-l].y),c+2<l?(m=t[c+2].x,v=t[c+2].y):r?(m=t[c+2-l].x,v=t[c+2-l].y):(m=t[c].x,v=t[c].y);var g=_(h,d,t[c].x,t[c].y,f,p,m,v,i,c===u-1?o:1);if(c===u-1&&o>=0&&o<1){e.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]),t.splice(u-1,l-(u-1)-1);var y=new xA(g[4],g[5]);y.prevCtrlPoint=new xA(g[2],g[3]),t.push(y),l=t.length}else e.bezierCurveTo(g[0],g[1],g[2],g[3],f,p);t[c].nextCtrlPoint=g.slice(0,2),t[c].prevCtrlPoint=s?s.slice(2):null,s=g}!r&&t[1].prevCtrlPoint&&(t[0].nextCtrlPoint=t[1].prevCtrlPoint,delete t[0].prevCtrlPoint),t[l-1].prevCtrlPoint||(t[l-1].prevCtrlPoint=t[l-2].nextCtrlPoint),oN._stroke(e,n)}function _(e,t,n,i,r,a,o,s,l,u){var c=(e+n)/2,h=(t+i)/2,d=(n+r)/2,f=(i+a)/2,p=(r+o)/2,m=(a+s)/2,v=Math.sqrt((n-e)*(n-e)+(i-t)*(i-t)),g=Math.sqrt((r-n)*(r-n)+(a-i)*(a-i)),y=v/(v+g),_=g/(g+Math.sqrt((o-r)*(o-r)+(s-a)*(s-a))),x=c+(d-c)*y,b=h+(f-h)*y,w=d+(p-d)*_,k=f+(m-f)*_,C=x+(d-x)*l+n-x,S=b+(f-b)*l+i-b,T=w+(d-w)*l+r-w,E=k+(f-k)*l+a-k,P=[C,S,T,E];return u<1?function(e,t,n,i,r,a,o,s,l,u){var c=1-t,h=n*c*c+2*r*t*c+o*t*t,d=r*c*c+2*o*t*c+l*t*t,f=i*c*c+2*a*t*c+s*t*t,p=a*c*c+2*s*t*c+u*t*t;return[(1*n*1+2*r*0*1+0*o*0)*c+(1*r*1+2*o*0*1+0*l*0)*t,(1*i*1+2*a*0*1+0*s*0)*c+(1*a*1+2*s*0*1+0*u*0)*t,1*h+0*d,1*f+0*p,h*c+d*t,f*c+p*t]}(0,u,n,i,C,S,T,E,r,a):P}},_arcBetween:function(e,t,n,i){var r=i,a=t.distanceTo(n),o=a/2/Math.sin(r/2),s=Math.asin((n.y-t.y)/a);t.x>n.x&&(s=Math.PI-s);var l=s-(90*aN-r/2),u=Math.cos(l)*o,c=Math.sin(l)*o,h=t.x+u,d=t.y+c,f=Math.asin((n.y-d)/o);h>n.x&&(f=Math.PI-f);var p=f+r;return e.beginPath(),e.arc(h,d,o,f,p),[h,d]},_lineTo:function(e,t){e.lineTo(t.x,t.y)},bezierCurveAndFill:function(e,t,n,i){e.beginPath();var r=t[0];e.moveTo(r.x,r.y);var a=[e];a.push.apply(a,t.splice(1)),oN._bezierCurveTo.apply(oN,a),oN.fillCanvas(e,i),oN._stroke(e,n)},_bezierCurveTo:function(e,t,n,i){e.bezierCurveTo(t.x,t.y,n.x,n.y,i.x,i.y)},ellipse:function(e,t,n,i,r,a,o){var s,l,u,c,h,d,f,p,m;e.beginPath(),n===i&&n===r?e.arc(t.x,t.y,n,0,2*Math.PI):e.ellipse?i!==r?(e.ellipse(t.x,t.y,n,i,0,180*aN,360*aN,!1),e.ellipse(t.x,t.y,n,r,0,0,180*aN,!1)):e.ellipse(t.x,t.y,n,i,0,0,360*aN,!1):(f=(u=n)*(d=.5522848),p=(c=i)*d,m=(h=r)*d,e.moveTo((s=t.x)-u,l=t.y),e.bezierCurveTo(s-u,l-p,s-f,l-c,s,l-c),e.bezierCurveTo(s+f,l-c,s+u,l-p,s+u,l),e.bezierCurveTo(s+u,l+m,s+f,l+h,s,l+h),e.bezierCurveTo(s-f,l+h,s-u,l+m,s-u,l),e.closePath()),oN.fillCanvas(e,o,t.x-n,t.y-i),oN._stroke(e,a,t.x-n,t.y-i)},rectangle:function(e,t,n,i,r){var a=t.x,o=t.y;e.beginPath(),e.rect(a,o,n.width,n.height),oN.fillCanvas(e,r,a,o),oN._stroke(e,i,a,o)},sector:function(e,t,n,i,r,a){var o=aN;!function(e,t,n,i,s,l){var u=o*-l,c=o*-s;e.beginPath(),e.moveTo(t,n),e.arc(t,n,i,u,c),e.lineTo(t,n),oN.fillCanvas(e,a,t-i,n-i),oN._stroke(e,r,t-i,n-i)}(e,t.x,t.y,n,i[0],i[1])},_isPattern:function(e){return!CI(e)&&!("addColorStop"in e)},drawCross:function(e,t,n,i,r){e.canvas._drawn=!0,e.strokeStyle=r,e.lineWidth=i,e.beginPath(),e.moveTo(t-5,n),e.lineTo(t+5,n),e.moveTo(t,n-5),e.lineTo(t,n+5),e.stroke()},copy:function(e,t){var n=t||rO("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0),n},pixelRect:function(e,t,n,i){var r=e.globalAlpha,a=!1;if(e.lineWidth>0&&n>0)a=!0,n<1&&(e.globalAlpha*=n);else{if(!(i>0))return;i<1&&(e.globalAlpha*=i)}e.canvas._drawn=!0,a?e.strokeRect(t[0],t[1],1,1):e.fillRect(t[0],t[1],1,1),e.globalAlpha!==r&&(e.globalAlpha=r)}};function sN(e,t,n,i){var r=t.x,a=t.y,o=n.x,s=n.y,l=i,u=function(e,t){return e<=t},c=function(e,t){return e>=t},h=function(e,t){return Math.min(e,t)},d=function(e,t){return Math.max(e,t)},f={thereYet:c,cap:h},p={thereYet:c,cap:h};a-s>0&&(p.thereYet=u,p.cap=d),r-o>0&&(f.thereYet=u,f.cap=d),e.moveTo(r,a);for(var m,v,g=r,y=a,_=0,x=!0;!f.thereYet(g,o)||!p.thereYet(y,s);)m=Math.atan2(s-a,o-r),v=l[_],g=f.cap(o,g+Math.cos(m)*v),y=p.cap(s,y+Math.sin(m)*v),x?e.lineTo(g,y):e.moveTo(g,y),_=(_+1)%l.length,x=!x}function lN(e){return"data:image/"===e.substring(0,"data:image/".length)?e:LA(e)}function uN(e,t){e.filter=t.filter,e.fillStyle=t.fillStyle,e.globalAlpha=t.globalAlpha,e.lineCap=t.lineCap,e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle}function cN(e,t){t&&e.setLineDash&&Array.isArray(t)&&e.setLineDash(t)}function hN(e){return"Z__"+e}var dN=function(e){return function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.on=function(e,t,n){if(!e)return this;if(!CI(e))return this._switch("on",e,t);if(!t)return this;this._eventMap||(this._eventMap={});var i,r=e.toLowerCase().split(" ");n||(n=this);var a,o=bI(t._id);t._id=CA();for(var s=0,l=r.length;s<l;s++){var u=hN(i=r[s]);if(t[u]&&(t[u]._id=t._id),(a=this._eventMap[i])||(this._eventMap[i]=a=[]),o){var c=a.length;if(c>0)for(var h=0;h<c;h++)if(t===a[h].handler&&a[h].context===n)return lA.isTest||console.warn(this,"find '"+e+"' handler:",t," The old listener function will be removed"),this;a.push({handler:t,context:n})}else a.push({handler:t,context:n})}return this},n.addEventListener=function(){return this.on.apply(this,arguments)},n.once=function(e,t,n){if(!CI(e)){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=this._wrapOnceHandler(r,e[r],n));return this._switch("on",i)}for(var a=e.split(" "),o=0,s=a.length;o<s;o++)this.on(a[o],this._wrapOnceHandler(a[o],t,n));return this},n.off=function(e,t,n){if(!this._eventMap||!e)return this;if(!CI(e))return this._switch("off",e,t);if(!t)return this;if(!bI(t._id))return this;var i,r,a,o=e.split(" ");n||(n=this);for(var s=0,l=o.length;s<l;s++)if(a=hN(i=o[s].toLowerCase()),r=this._eventMap[i]){for(var u=r.length-1;u>=0;u--){var c=r[u];t!==c.handler&&t!==c.handler[a]||c.context!==n||(delete c.handler[a],r.splice(u,1))}r.length||delete this._eventMap[i]}return this},n.removeEventListener=function(){return this.off.apply(this,arguments)},n.listens=function(e,t,n){if(!this._eventMap||!CI(e))return 0;var i=this._eventMap[e.toLowerCase()];if(!i||!i.length)return 0;if(!t)return i.length;for(var r=0,a=i.length;r<a;r++)if(t===i[r].handler&&(xI(n)||i[r].context===n))return 1;return 0},n.getListeningEvents=function(){return this._eventMap?Object.keys(this._eventMap):[]},n.copyEventListeners=function(e){var t,n=e._eventMap;if(!n)return this;for(var i in n)for(var r=0,a=(t=n[i]).length;r<a;r++)this.on(i,t[r].handler,t[r].context);return this},n.fire=function(){return this._eventParent?this._eventParent.fire.apply(this._eventParent,arguments):this._fire.apply(this,arguments)},n._wrapOnceHandler=function(e,t,n){var i=hN(e),r=!1,a=function e(){r||(delete a[i],r=!0,t.apply(n||this,arguments),e._called=!0)};return a[i]=t,a},n._switch=function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&this[e](i,t[i],n);return this},n._clearListeners=function(e){this._eventMap&&CI(e)&&this._eventMap[e.toLowerCase()]&&(this._eventMap[e]=null)},n._clearAllListeners=function(){this._eventMap=null},n._setEventParent=function(e){return this._eventParent=e,this},n._setEventTarget=function(e){return this._eventTarget=e,this},n._fire=function(e,t){if(!this._eventMap)return this;e=e.toLowerCase();var n=this._eventMap[e];if(!n)return this;t||(t={}),t.type=e,t.target=this._eventTarget||this;for(var i,r,a=n.slice(0),o=0,s=a.length;o<s;o++)a[o]&&(a[o].handler._called||(i=a[o].context,r=_I({},t),!1===(i?a[o].handler.call(i,r):a[o].handler(r))&&t.domEvent&&hO(t.domEvent)));var l=this._eventMap[e];if(l){for(var u=[],c=0,h=l.length;c<h;c++)l[c].handler._called||u.push(l[c]);this._eventMap[e]=u}return this},t}(e)},fN=dN(function(){function e(e){this.target=e}var t=e.prototype;return t.enable=function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},t.disable=function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},t.enabled=function(){return!!this._enabled},t.remove=function(){this.disable(),delete this.target,delete this.dom},e}()),pN=function(){function e(e){if(!this||!this.setOptions)throw new Error('Class instance is being created without "new" operator.');this.setOptions(e),this.callInitHooks(),this._isUpdatingOptions=!1}var t=e.prototype;return t.proxyOptions=function(){var e=this;return lA.proxy?(this.options.isExtensible||(this.options=new Proxy(this.options,{set:function(t,n,i){if(t[n]===i)return!0;if(t[n]=i,e._isUpdatingOptions)return!0;var r={};return r[n]=i,e.config(r),!0}})),this):this},t.callInitHooks=function(){var e=Object.getPrototypeOf(this);return this._visitInitHooks(e),this},t.setOptions=function(e){if(this.hasOwnProperty("options")||(this.options=this.options?Object.create(this.options):{}),!e)return this;for(var t in e)this.options[t]=e[t];return this},t.config=function(e){if(this._isUpdatingOptions=!0,!e){var t={};for(var n in this.options)this.options.hasOwnProperty(n)&&(t[n]=this.options[n]);return this._isUpdatingOptions=!1,t}if(2===arguments.length){var i={};i[e]=arguments[1],e=i}for(var r in e)this.options[r]=e[r],this[r]&&this[r]instanceof fN&&(e[r]?this[r].enable():this[r].disable());return this.onConfig(e),this._isUpdatingOptions=!1,this},t.onConfig=function(){},t._visitInitHooks=function(e){if(!this._initHooksCalled){var t=Object.getPrototypeOf(e);t._visitInitHooks&&t._visitInitHooks.call(this,t),this._initHooksCalled=!0;var n=e._initHooks;if(n&&n!==t._initHooks)for(var i=0;i<n.length;i++)n[i].call(this)}},e.addInitHook=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r="function"==typeof e?e:function(){this[e].apply(this,n)},a=this.prototype,o=Object.getPrototypeOf(a);return a._initHooks&&a._initHooks!==o._initHooks||(a._initHooks=[]),a._initHooks.push(r),this},e.include=function(){for(var e=0;e<arguments.length;e++)_I(this.prototype,e<0||arguments.length<=e?void 0:arguments[e]);return this},e.mergeOptions=function(e){var t=this.prototype,n=Object.getPrototypeOf(t);return t.options&&t.options!==n.options||(t.options=t.options?Object.create(t.options):{}),_I(t.options,e),this},e}(),mN=new(function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t}(dN((function(){}))));if("undefined"!=typeof window&&window.matchMedia)for(var vN=1;vN<500;vN++){var gN=(.01*vN).toFixed(2),yN=window.matchMedia("screen and (resolution: "+gN+"dppx)");yN&&(yN.addEventListener?yN.addEventListener("change",lA.checkDevicePixelRatio):yN.addListener&&yN.addListener(lA.checkDevicePixelRatio))}if(lA.devicePixelRatio){var _N=lA.devicePixelRatio;Object.defineProperty(lA,"devicePixelRatio",{get:function(){return _N},set:function(e){e!==_N&&(_N=e,lA.monitorDPRChange&&mN.fire("dprchange",{devicePixelRatio:e}))}})}lA.webgl&&"undefined"!=typeof document&&(sO(document,"visibilitychange",(function(){mN.fire("docvisibilitychange",{visibilityState:document.visibilityState})})),sO(document,"dragstart",(function(){mN.fire("dragstart")})),sO(document,"dragend",(function(){mN.fire("dragend")})));var xN={},bN=function(e){return function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.registerJSONType=function(e){return e?xN[e]?(console.error(e+" has register. please use Different name for:",this),this):(xN[e]=this,this):this},t.getJSONClass=function(e){return e?xN[e]:null},t.prototype.getJSONType=function(){if(void 0===this._jsonType){var e=Object.getPrototypeOf(this).constructor;for(var t in xN)if(xN[t]===e){this._jsonType=t;break}}if(!this._jsonType)throw new Error("Found an unregistered Layer/Geometry class!");return this._jsonType},t}(e)},wN={},kN=function(){function e(){this._tree=nI()(9,["[0]","[1]","[2]","[3]"])}var t=e.prototype;return t.collides=function(e){return wN.minX=e[0],wN.minY=e[1],wN.maxX=e[2],wN.maxY=e[3],this._tree.collides(wN)},t.insertBox=function(e){return this._tree.insert(e),this},t.bulkInsertBox=function(e){return this._tree.load(e),this},t.clear=function(){return this._tree.clear(),this},e}();function CN(e){return function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHandler=function(e,t){if(!t)return this;if(this._handlers||(this._handlers=[]),this[e])return this[e].enable(),this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},n.removeHandler=function(e){if(!e)return this;var t=this[e];if(t){var n=this._handlers.indexOf(t);n>=0&&this._handlers.splice(n,1),this[e].remove(),delete this[e]}return this},n._clearHandlers=function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].remove();this._handlers=[]},t}(e)}var SN={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},TN={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},EN=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,null)||this).dom=t,i.options=n,i}cA(t,e);var n=t.prototype;return n.enable=function(){return this.dom?(this._onMouseDown=function(e){return this.onMouseDown(e)},bO(this.dom,"touchstart mousedown",this._onMouseDown,this),this):this},n.disable=function(){return this.dom?(this._offEvents(),wO(this.dom,"touchstart mousedown",this._onMouseDown),delete this._onMouseDown,this):this},n.onMouseDown=function(e){if((this.options.rightclick||2!==e.button)&&!(e.touches&&e.touches.length>1||this.options.cancelOn&&!0===this.options.cancelOn(e))){var t=this.dom;t.setCapture?t.setCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP),t.ondragstart=function(){return!1},delete this.moved;var n=e.touches?e.touches[0]:e;this.startPos=new xA(n.clientX,n.clientY),wO(document,SN[e.type],this.onMouseMove,this),wO(document,TN[e.type],this.onMouseUp,this),bO(document,SN[e.type],this.onMouseMove,this),bO(document,TN[e.type],this.onMouseUp,this),this.options.ignoreMouseleave||(wO(this.dom,"mouseleave",this.onMouseUp,this),bO(this.dom,"mouseleave",this.onMouseUp,this)),this.fire("mousedown",{domEvent:e,mousePos:new xA(n.clientX,n.clientY)})}},n.onMouseMove=function(e){if(e.touches&&e.touches.length>1)this.moved&&(this.interupted=!0,this.onMouseUp(e));else{var t=e.touches?e.touches[0]:e,n=new xA(t.clientX,t.clientY).sub(this.startPos);(n.x||n.y)&&(this.moved?this.fire("dragging",{domEvent:e,mousePos:new xA(t.clientX,t.clientY)}):(this.fire("dragstart",{domEvent:e,mousePos:this.startPos.copy()}),this.moved=!0))}},n.onMouseUp=function(e){var t=e.changedTouches?e.changedTouches[0]:e;this._offEvents();var n={domEvent:e};bI(t.clientX)&&(n.mousePos=new xA(parseInt(t.clientX,0),parseInt(t.clientY,0))),this.moved&&(n.interupted=this.interupted,this.fire("dragend",n),delete this.interupted,delete this.moved),this.fire("mouseup",n)},n._offEvents=function(){var e=this.dom;if(wO(e,"mouseleave",this.onMouseUp,this),"undefined"!=typeof document&&"undefined"!=typeof window){for(var t in SN)wO(document,SN[t],this.onMouseMove,this),wO(document,TN[t],this.onMouseUp,this);e.releaseCapture?e.releaseCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP)}},t}(fN),PN=function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.toNumberArrays=function(e){return Array.isArray(e)?PA(e,(function(e){return[e.x,e.y]})):[e.x,e.y]},t.toCoordinates=function(e){if(bI(e[0])&&bI(e[1]))return new t(e);if(e instanceof t)return e;for(var n=[],i=0,r=e.length;i<r;i++){var a=e[i];Array.isArray(a)?bI(a[0])?n.push(new t(a)):n.push(t.toCoordinates(a)):n.push(a instanceof t?a:new t(a))}return n},t}(_A),MN=function(){function e(e,t){this.type=e,this.properties=t}return e.createProj4=function(t){return new e("proj4",{proj:t})},e.fromProjectionCode=function(t){return t&&e[t=t.toUpperCase().replace(":","")]||null},e}();MN.WGS84=MN.createProj4("+proj=longlat +datum=WGS84 +no_defs"),MN.EPSG4326=MN.WGS84,MN.EPSG3857=MN.createProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),MN.IDENTITY=MN.createProj4("+proj=identity +no_defs"),MN.CGCS2000=MN.createProj4("+proj=longlat +datum=CGCS2000"),MN.EPSG4490=MN.CGCS2000,MN.BD09LL=MN.createProj4("+proj=longlat +datum=BD09"),MN.GCJ02=MN.createProj4("+proj=longlat +datum=GCJ02");var IN,AN=new xA(0,0),RN=new PN(0,0),ON=new PN(0,0),NN=new PN(0,0),DN=new PN(0,0),zN=new PN(0,0),LN=new PN(0,0),BN=new PN(0,0),FN=new PN(0,0),jN=[],HN=[],VN=function(){function e(e,t,n,i){this._clazz=PN;var r=arguments.length,a=r>0?arguments[r-1]:null;a&&a.unproject&&(this.projection=arguments[r-1]),this._dirty=!0,this._initialize(e,t,n,i)}var t=e.prototype;return t._initialize=function(e,t,n,i){if(this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,!xI(e)){var r=this.projection;bI(e)&&bI(t)&&bI(n)&&bI(i)?r?this.set(e,t,n,i):this.set(Math.min(e,n),Math.min(t,i),Math.max(e,n),Math.max(t,i)):Array.isArray(e)?r?this.set(e[0],e[1],e[2],e[3]):this.set(Math.min(e[0],e[2]),Math.min(e[1],e[3]),Math.max(e[0],e[2]),Math.max(e[1],e[3])):bI(e.x)&&bI(t.x)&&bI(e.y)&&bI(t.y)?r?this.set(e.x,e.y,t.x,t.y):(e.x>t.x?(this.xmin=t.x,this.xmax=e.x):(this.xmin=e.x,this.xmax=t.x),e.y>t.y?(this.ymin=t.y,this.ymax=e.y):(this.ymin=e.y,this.ymax=t.y)):bI(e.xmin)&&bI(e.xmax)&&bI(e.ymin)&&bI(e.ymax)&&this.set(e.xmin,e.ymin,e.xmax,e.ymax)}},t._add=function(e){return this._dirty=!0,xI(e.x)?xI(e.xmin)?xI(e[0])||(this.xmin+=e[0],this.ymin+=e[1],this.xmax+=e[0],this.ymax+=e[1]):(this.xmin+=e.xmin,this.ymin+=e.ymin,this.xmax+=e.xmax,this.ymax+=e.ymax):(this.xmin+=e.x,this.ymin+=e.y,this.xmax+=e.x,this.ymax+=e.y),this},t.add=function(){var e=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return e._add.apply(e,arguments)},t._scale=function(e){return this._dirty=!0,this.xmin*=e,this.ymin*=e,this.xmax*=e,this.ymax*=e,this},t._sub=function(e){return this._dirty=!0,xI(e.x)?xI(e.xmin)?xI(e[0])||(this.xmin-=e[0],this.ymin-=e[1],this.xmax-=e[0],this.ymax-=e[1]):(this.xmin-=e.xmin,this.ymin-=e.ymin,this.xmax-=e.xmax,this.ymax-=e.ymax):(this.xmin-=e.x,this.ymin-=e.y,this.xmax-=e.x,this.ymax-=e.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(){var e=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return e._sub.apply(e,arguments)},t.substract=function(){return this.sub.apply(this,arguments)},t.round=function(){return new this.constructor(Math.round(this.xmin),Math.round(this.ymin),Math.round(this.xmax),Math.round(this.ymax),this.projection)},t._round=function(){return this._dirty=!0,this.xmin=Math.round(this.xmin),this.ymin=Math.round(this.ymin),this.xmax=Math.round(this.xmax),this.ymax=Math.round(this.ymax),this},t.getMin=function(e){return e?(e.set(this.xmin,this.ymin),e):new this._clazz(this.xmin,this.ymin)},t.getMax=function(e){return e?(e.set(this.xmax,this.ymax),e):new this._clazz(this.xmax,this.ymax)},t.getCenter=function(e){var t=(this.xmin+this.xmax)/2,n=(this.ymin+this.ymax)/2;return e?(e.set(t,n),e):new this._clazz(t,n)},t.isValid=function(){return!(xI(this.xmin)||xI(this.ymin)||xI(this.xmax)||xI(this.ymax))},t.equals=function(e){return this.xmin===e.xmin&&this.xmax===e.xmax&&this.ymin===e.ymin&&this.ymax===e.ymax},t.intersects=function(e){this._project(this),this._project(e);var t=Math.max(this.pxmin,e.pxmin),n=Math.max(this.pymin,e.pymin),i=Math.min(this.pxmax,e.pxmax),r=Math.min(this.pymax,e.pymax);return!(t>i||n>r)},t.within=function(e){return this._project(this),this._project(e),this.pxmin>=e.pxmin&&this.pxmax<=e.pxmax&&this.pymin>=e.pymin&&this.pymax<=e.pymax},t.contains=function(e){if(!e)return!1;this._project(this);var t=this.projection;if(t)if(void 0!==e.x){var n=RN;Array.isArray(e)?(n.x=e[0],n.y=e[1]):(n.x=e.x,n.y=e.y),e=t.project(n,n)}else void 0!==e.xmin&&this._project(e);return(e.x||e.pxmin||0)>=this.pxmin&&(e.x||e.pxmax||0)<=this.pxmax&&(e.y||e.pymin||0)>=this.pymin&&(e.y||e.pymax||0)<=this.pymax},t.getWidth=function(){return Math.abs(this.xmax-this.xmin)},t.getHeight=function(){return Math.abs(this.ymax-this.ymin)},t.getSize=function(){return new AR(this.getWidth(),this.getHeight())},t.set=function(e,t,n,i){return this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=i,this._dirty=!0,this},t.__combine=function(e){var t,n,i,r;void 0!==e.x&&(IN.xmin=IN.xmax=e.x,IN.ymin=IN.ymax=e.y,e=IN),this._project(e),this._project(this),bI(this.pxmin)?(t=Math.min(this.pxmin,e.pxmin),n=Math.min(this.pymin,e.pymin),i=Math.max(this.pxmax,e.pxmax),r=Math.max(this.pymax,e.pymax)):(t=e.pxmin,n=e.pymin,i=e.pxmax,r=e.pymax);var a=this.projection;if(a){ON.set(t,n),NN.set(i,r);var o=a.unproject(ON,ON),s=a.unproject(NN,NN);t=o.x,n=o.y,i=s.x,r=s.y}return HN[0]=t,HN[1]=n,HN[2]=i,HN[3]=r,HN},t._combine=function(e){if(!e||e.isValid&&!e.isValid())return this;var t=this.__combine(e);return this.set(t[0],t[1],t[2],t[3]),this._dirty=!0,this},t.combine=function(e){if(!e||e.isValid&&!e.isValid())return this;var t=this.__combine(e);return new this.constructor(t[0],t[1],t[2],t[3],this.projection)},t.intersection=function(e){if(!this.intersects(e))return null;DN.x=Math.max(this.pxmin,e.pxmin),DN.y=Math.max(this.pymin,e.pymin),zN.x=Math.min(this.pxmax,e.pxmax),zN.y=Math.min(this.pymax,e.pymax);var t=DN,n=zN,i=this.projection;return i&&(t=i.unproject(t,t),n=i.unproject(n,n)),new this.constructor(t,n,i)},t.expand=function(e){var t,n;return bI(e)?t=n=e:(t=e.width||e.x||e[0]||0,n=e.height||e.y||e[1]||0),new this.constructor(this.xmin-t,this.ymin-n,this.xmax+t,this.ymax+n,this.projection)},t._expand=function(e){var t,n;return bI(e)?t=n=e:(t=e.width||e.x||e[0]||0,n=e.height||e.y||e[1]||0),this.xmin-=t,this.ymin-=n,this.xmax+=t,this.ymax+=n,this._dirty=!0,this},t.toJSON=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},t.toArray=function(e){var t=this.xmin,n=this.ymin,i=this.xmax,r=this.ymax;return e?(e[0].x=t,e[0].y=r,e[1].x=i,e[1].y=r,e[2].x=i,e[2].y=n,e[3].x=t,e[3].y=n,e[4].x=t,e[4].y=r,e):[new this._clazz([t,r]),new this._clazz([i,r]),new this._clazz([i,n]),new this._clazz([t,n]),new this._clazz([t,r])]},t.toString=function(){return this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},t.copy=function(){return new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection)},t.convertTo=function(e,t){if(!this.isValid())return null;var n,i=t||new this.constructor;return t&&i.set(null,null,null,null),this._clazz===PN?n=LN:this._clazz===xA&&(n=AN),n.x=this.xmin,n.y=this.ymax,i._combine(e(n)),n.x=this.xmax,i._combine(e(n)),n.y=this.ymin,i._combine(e(n)),n.x=this.xmin,i._combine(e(n)),i},t._project=function(e){if(e&&e.isValid()){var t=this.projection;if(t){if(e._dirty){BN.set(e.xmax,e.ymin),FN.set(e.xmin,e.ymax),jN[0]=BN,jN[1]=FN;var n=t.projectCoords(jN),i=n[0],r=n[1];e.pxmin=Math.min(i.x,r.x),e.pymin=Math.min(i.y,r.y),e.pxmax=Math.max(i.x,r.x),e.pymax=Math.max(i.y,r.y)}delete e._dirty}else e.pxmin=e.xmin,e.pxmax=e.xmax,e.pymin=e.ymin,e.pymax=e.ymax}else e&&(e.pxmin=e.pxmax=e.pymin=e.pymax=null)},e}();IN=new VN(0,0,0,0);var UN,qN=function(e){function t(t,n,i,r){var a;return(a=e.call(this,t,n,i,r)||this)._clazz=xA,a}return cA(t,e),t}(VN),GN=function(){function e(e){this.matrix=e}var t=e.prototype;return t.transform=function(e,t,n){var i=this.matrix[0]*(e.x-this.matrix[2])/t,r=-this.matrix[1]*(e.y-this.matrix[3])/t;return n?(n.x=i,n.y=r,n):new xA(i,r)},t.untransform=function(e,t,n){var i=e.x*t/this.matrix[0]+this.matrix[2],r=e.y*t/-this.matrix[1]+this.matrix[3];return n?(n.x=i,n.y=r,n):new PN(i,r)},e}(),WN={is:function(e){if(this.code===e)return!0;if(!this.aliases)return!1;for(var t=0;t<this.aliases.length;t++)if(this.aliases[t]===e)return!0;return!1},project:function(){},unproject:function(){},projectCoords:function(e,t){var n=this;if(!e)return[];if(!Array.isArray(e))return this.project(e);if(0===e.length)return[];if(!this.isSphere())return PA(e,this.project,this);if(Array.isArray(e[0]))return e.map((function(e){return n.projectCoords(e,t)}));for(var i,r,a,o,s,l,u=!1!==t,c=this.getCircum(),h=this.getSphereExtent(),d=h.sx,f=h.sy,p=e[0],m=[this.project(p)],v=1,g=e.length;v<g;v++)o=(a=e[v]).x-p.x,s=a.y-p.y,l=this.project(a),Math.abs(o)>180&&u&&(void 0===i&&(i=a.x>p.x),i&&(l._add(-c.x*IA(o)*d,0),a._add(-360*IA(o),0))),Math.abs(s)>90&&u&&(void 0===r&&(r=a.y<p.y),r&&(l._add(0,-c.y*IA(s)*f),a._add(0,-180*IA(s)))),p=a,m.push(l);return m},unprojectCoords:function(e){return e?Array.isArray(e)?PA(e,this.unproject,this):this.unproject(e):[]},isSphere:function(){return!!this.sphere},isOutSphere:function(e){return!!this.isSphere()&&!this.getSphereExtent().contains(e)},wrapCoord:function(e){if(!this.isSphere())return e;var t=this.getSphereExtent(),n=new PN(e);return t.contains(n)||(n.x=RA(e.x,t.xmin,t.xmax),n.y=RA(e.y,t.ymin,t.ymax)),n},getCircum:function(){if(!this.circum&&this.isSphere()){var e=this.getSphereExtent();this.circum={x:e.getWidth(),y:e.getHeight()}}return this.circum},getSphereExtent:function(){if(!this.extent&&this.isSphere()){var e=this.project(new PN(180,90)),t=this.project(new PN(-180,-90));this.extent=new VN(t,e,this),this.extent.sx=e.x>t.x?1:-1,this.extent.sy=e.y>t.y?1:-1}return this.extent}},ZN={measureLength:function(e,t){if(!Array.isArray(e))return this.measureLenBetween(e,t);for(var n=0,i=0,r=e.length;i<r-1;i++)n+=this.measureLenBetween(e[i],e[i+1]);return n}},XN=_I({measure:"IDENTITY",measureLenBetween:function(e,t){if(!e||!t)return 0;try{return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}catch(U5){return 0}},measureArea:function(e){if(!Array.isArray(e))return 0;for(var t=0,n=0,i=e.length;n<i;n++){var r,a=e[n];t+=a.x*(r=n===i-1?e[0]:e[n+1]).y-a.y*r.x}return Math.abs(t/2)},locate:function(e,t,n,i){return(i=i||new PN(0,0)).set(e.x,e.y),this._locate(i,t,n)},_locate:function(e,t,n){return e?(t||(t=0),n||(n=0),t||n?(e.x=e.x+t,e.y=e.y+n,e):e):null},rotate:function(e,t,n){return e=new PN(e.x,e.y),this._rotate(e,t,n)},_rotate:(UN=new xA(0,0),function(e,t,n){return UN.x=e.x-t.x,UN.y=e.y-t.y,UN._rotate(n*Math.PI/180),e.x=t.x+UN.x,e.y=t.y+UN.y,e})},ZN),KN=function(){function e(e){this.radius=e}var t=e.prototype;return t.measureLenBetween=function(e,t){if(!e||!t)return 0;var n=MI(e.y),i=MI(t.y),r=n-i,a=MI(e.x)-MI(t.x);return(n=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(n)*Math.cos(i)*Math.pow(Math.sin(a/2),2))))*this.radius},t.measureArea=function(e){var t,n=MI(this.radius),i=0,r=e,a=r.length;if(a<3)return 0;for(t=0;t<a-1;t++){var o=r[t],s=r[t+1];i+=o.x*n*Math.cos(MI(o.y))*s.y*n-s.x*n*Math.cos(MI(s.y))*o.y*n}return a=r[t],r=r[0],i+=a.x*n*Math.cos(MI(a.y))*r.y*n-r.x*n*Math.cos(MI(r.y))*a.y*n,.5*Math.abs(i)},t.locate=function(e,t,n,i){return(i=i||new PN(0,0)).set(e.x,e.y),this._locate(i,t,n)},t._locate=function(e,t,n){if(!e)return null;if(t||(t=0),n||(n=0),!t&&!n)return e;var i,r,a=MI(e.y);if(0!==n){var o=Math.abs(n);r=RA(180*(a+=2*Math.sin(o/(2*this.radius))*(n>0?1:-1))/Math.PI,-90,90)}else r=e.y;if(0!==t){var s=Math.abs(t),l=MI(e.x);i=RA(180*(l+=2*Math.sqrt(Math.pow(Math.sin(s/(2*this.radius)),2)/Math.pow(Math.cos(a),2))*(t>0?1:-1))/Math.PI,-180,180)}else i=e.x;return e.x=i,e.y=r,e},t.rotate=function(e,t,n){return e=new PN(e),this._rotate(e,t,n)},t._rotate=function(e,t,n){var i,r,a,o,s=(i=t,r=e,void 0===a&&(a={}),((o=a.final?YN(r,i):YN(i,r))>180?-(360-o):o)-n),l=this.measureLenBetween(t,e);return e.x=t.x,e.y=t.y,function(e,t,n,i){var r=t/i,a=e.x*Math.PI/180,o=MI(e.y),s=MI(n),l=r*Math.cos(s),u=o+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),h=Math.abs(c)>1e-11?l/c:Math.cos(o),d=r*Math.sin(s)/h;return e.x=(180*(a+d)/Math.PI+540)%360-180,e.y=180*u/Math.PI,e}(e,l,s,this.radius)},e}();function YN(e,t){var n=MI(e.y),i=MI(t.y),r=MI(t.x-e.x);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var a=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(II(Math.atan2(r,a))+360)%360}var JN=_I({measure:"EPSG:4326",sphere:new KN(6378137),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},ZN),QN=_I({measure:"BAIDU",sphere:new KN(6370996.81),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},ZN),$N=JN,eD={};function tD(e){eD[e.measure]=e}tD(XN),tD(JN),tD(QN);var nD={getInstance:function(e){if(!e)return $N;for(var t in eD)if(EI(eD,t)){var n=eD[t].measure;if(!n)continue;if(e.toLowerCase()===n.toLowerCase())return eD[t]}return null}},iD=_I({},WN,{code:"EPSG:3857",rad:Math.PI/180,metersPerDegree:6378137*Math.PI/180,maxLatitude:85.0511287798,project:function(e,t){var n=this.rad,i=this.metersPerDegree,r=this.maxLatitude,a=e.x,o=Math.max(Math.min(r,e.y),-r),s=a*i,l=(0===o?0:Math.log(Math.tan((90+o)*n/2))/n)*i;return t?(t.x=s,t.y=l,t):new PN(s,l)},unproject:function(e,t){var n,i=this.rad,r=this.metersPerDegree,a=e.x/r,o=e.y;0===o?n=0:(n=o/r,n=(2*Math.atan(Math.exp(n*i))-Math.PI/2)/i),Math.abs(Math.abs(a)-180)<1e-7&&(a=180*IA(a)),Math.abs(Math.abs(n)-this.maxLatitude)<1e-7&&(n=IA(n)*this.maxLatitude);var s=RA(a,-180,180),l=RA(n,-this.maxLatitude,this.maxLatitude);return t?(t.x=s,t.y=l,t):new PN(s,l)}},JN),rD=_I({},WN,{code:"EPSG:4326",aliases:["EPSG:4490"],project:function(e,t){return t?(t.x=e.x,t.y=e.y,t):new PN(e)},unproject:function(e,t){return t?(t.x=e.x,t.y=e.y,t):new PN(e)}},JN),aD=Math.abs,oD=Math.sin,sD=Math.cos,lD=Math.tan,uD=Math.atan,cD=Math.atan2,hD=Math.sqrt,dD=Math.log,fD=Math.hypot,pD=Math.sinh,mD=Math.cosh;Math;var vD=.017453292519943295,gD=["Traverse_Mercator"],yD=_I({},WN,{code:"EPSG:9807",aliases:gD,create:function(e){var t={a:6378137,es:.0066943799901413165,x0:xI(e.falseEasting)?5e5:e.falseEasting,y0:xI(e.falseNorthing)?0:e.falseNorthing,k0:e.scaleFactor||.9996,lam0:(e.centralMeridian||0)*vD,phi0:(e.latitudeOfOrigin||0)*vD,originLam0:e.startLongtitude||0,originPhi0:e.startLatitude||0};!function(e){var t,n,i,r,a,o,s=[],l=[],u=[],c=[];function h(e,t){for(var n,i=2*sD(2*t),r=e.length-1,a=e[r],o=0;--r>=0;)n=i*a-o+e[r],o=a,a=n;return t+n*oD(2*t)}function d(e,t,n){for(var i,r,a=oD(t),o=sD(t),s=pD(n),l=mD(n),u=2*o*l,c=-2*a*s,h=e.length-1,d=e[h],f=0,p=0,m=0;--h>=0;)i=p,r=f,d=u*(p=d)-i-c*(f=m)+e[h],m=c*p-r+u*f;return[(u=a*l)*d-(c=o*s)*m,u*m+c*d]}a=r=(i=e.es/(1+hD(1-e.es)))/(2-i),s[0]=r*(2+r*(-2/3+r*(r*(116/45+r*(26/45+r*(-2854/675)))-2))),l[0]=r*(r*(2/3+r*(4/3+r*(-82/45+r*(32/45+r*(4642/4725)))))-2),s[1]=(a*=r)*(7/3+r*(r*(-227/45+r*(2704/315+r*(2323/945)))-1.6)),l[1]=a*(5/3+r*(-16/15+r*(-13/9+r*(904/315+r*(-1522/945))))),s[2]=(a*=r)*(56/15+r*(-136/35+r*(-1262/105+r*(73814/2835)))),l[2]=a*(-26/15+r*(34/21+r*(1.6+r*(-12686/2835)))),s[3]=(a*=r)*(4279/630+r*(-332/35+r*(-399572/14175))),l[3]=a*(1237/630+r*(r*(-24832/14175)-2.4)),s[4]=(a*=r)*(4174/315+r*(-144838/6237)),l[4]=a*(-734/315+r*(109598/31185)),s[5]=(a*=r)*(601676/22275),l[5]=a*(444337/155925),t=e.k0/(1+r)*(1+(a=r*r)*(1/4+a*(1/64+a/256))),u[0]=r*(r*(2/3+r*(-37/96+r*(1/360+r*(81/512+r*(-96199/604800)))))-.5),c[0]=r*(.5+r*(-2/3+r*(5/16+r*(41/180+r*(-127/288+r*(7891/37800)))))),u[1]=a*(-1/48+r*(-1/15+r*(437/1440+r*(-46/105+r*(1118711/3870720))))),c[1]=a*(13/48+r*(r*(557/1440+r*(281/630+r*(-1983433/1935360)))-.6)),u[2]=(a*=r)*(-17/480+r*(37/840+r*(209/4480+r*(-5569/90720)))),c[2]=a*(61/240+r*(-103/140+r*(15061/26880+r*(167603/181440)))),u[3]=(a*=r)*(-4397/161280+r*(11/504+r*(830251/7257600))),c[3]=a*(49561/161280+r*(-179/168+r*(6601661/7257600))),u[4]=(a*=r)*(-4583/161280+r*(108847/3991680)),c[4]=a*(34729/80640+r*(-3418889/1995840)),u[5]=(a*=r)*(-20648693/638668800),c[5]=.6650675310896665*a,o=h(l,e.phi0),n=-t*(o+function(e,t){for(var n,i=2*sD(t),r=e.length-1,a=e[r],o=0;--r>=0;)n=i*a-o+e[r],o=a,a=n;return oD(t)*n}(c,2*o)),e.fwd=function(e,i){var r,a,o,s,u,f,p,m=e.phi,v=e.lam;m=h(l,m),r=oD(m),a=sD(m),s=oD(v),o=sD(v),m=cD(r,o*a),v=cD(s*a,fD(r,a*o)),f=lD(v),p=function(e){var t=1+e,n=t-1;return 0===n?e:e*dD(t)/n}((p=aD(f))*(1+p/(fD(1,p)+1))),m+=(u=d(c,2*m,2*(v=f<0?-p:p)))[0],aD(v+=u[1])<=2.623395162778?(i.y=t*m+n,i.x=t*v):i.x=i.y=1/0},e.inv=function(e,i){var r,a,o,l,c,f=e.y,p=e.x;f=(f-n)/t,aD(p/=t)<=2.623395162778?(f+=(c=d(u,2*f,2*p))[0],p=uD(pD(p+=c[1])),r=oD(f),a=sD(f),l=oD(p),o=sD(p),p=cD(l,o*a),f=cD(r*o,fD(l,o*a)),i.phi=h(s,f),i.lam=p):i.phi=i.lam=1/0}}(t);var n={lam:0,phi:0},i={},r=0,a=0;return(t.originLam0||t.originPhi0)&&(n.lam=t.originLam0*vD-t.lam0,n.phi=t.originPhi0*vD,t.fwd(n,i),r=t.a*i.x+t.x0,a=t.a*i.y+t.y0),_I({},WN,{code:"EPSG:9807",aliases:gD,centralMeridian:e.centralMeridian,project:function(e,o){n.lam=e.x*vD-t.lam0,n.phi=e.y*vD,t.fwd(n,i);var s=t.a*i.x+t.x0-r,l=t.a*i.y+t.y0-a;return o?(o.x=s,o.y=l,o):new PN(s,l)},unproject:function(e,o){i.x=(e.x-t.x0+r)/t.a,i.y=(e.y-t.y0+a)/t.a,t.inv(i,n);var s=57.29577951308232*(n.lam+t.lam0),l=57.29577951308232*n.phi;return o?(o.x=s,o.y=l,o):new PN(s,l)}},JN)}}),_D=_I({},yD,{code:"utm",aliases:[],create:function(e){var t={},n=parseInt(e.zone);if(t.falseNorthing=e.south?1e7:0,t.falseEasting=5e5,!(n>0&&n<=60))throw new Error("zone must be > 0 and <= 60.");return n--,t.centralMeridian=6*(n+.5)-180,t.scaleFactor=.9996,yD.create(t)}}),xD=_I({},WN,{code:"BAIDU",project:function(e,t){return this.convertLL2MC(e,t)},unproject:function(e,t){return this.convertMC2LL(e,t)}},QN,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],convertMC2LL:function(e,t){for(var n,i=0,r=this.MCBAND.length;i<r;i++)if(Math.abs(e.y)>=this.MCBAND[i]){n=this.MC2LL[i];break}return this.convertor(e,n,t)},convertLL2MC:function(e,t){var n,i,r;e.x=this.getLoop(e.x,-180,180),e.y=this.getRange(e.y,-74,74);var a=new PN(e.x,e.y);for(i=0,r=this.LLBAND.length;i<r;i++)if(a.y>=this.LLBAND[i]){n=this.LL2MC[i];break}if(!n)for(i=this.LLBAND.length-1;i>=0;i--)if(a.y<=-this.LLBAND[i]){n=this.LL2MC[i];break}return this.convertor(e,n,t)},convertor:function(e,t,n){if(!e||!t)return null;var i=t[0]+t[1]*Math.abs(e.x),r=Math.abs(e.y)/t[9],a=t[2]+t[3]*r+t[4]*r*r+t[5]*r*r*r+t[6]*r*r*r*r+t[7]*r*r*r*r*r+t[8]*r*r*r*r*r*r;return i*=e.x<0?-1:1,a*=e.y<0?-1:1,n?(n.x=i,n.y=a,n):new PN(i,a)},toRadians:function(e){return Math.PI*e/180},toDegrees:function(e){return 180*e/Math.PI},getRange:function(e,t,n){return null!=t&&(e=Math.max(e,t)),null!=n&&(e=Math.min(e,n)),e},getLoop:function(e,t,n){if(e===1/0)return n;if(e===-1/0)return t;for(;e>n;)e-=n-t;for(;e<t;)e+=n-t;return e}}),bD=_I({},WN,{code:"IDENTITY",project:function(e,t){return t?(t.x=e.x,t.y=e.y,t):e.copy()},unproject:function(e,t){return t?(t.x=e.x,t.y=e.y,t):e.copy()}},XN),wD=iD,kD=Object.freeze({EPSG3857:iD,DEFAULT:wD,EPSG4326:rD,EPSG9807:yD,UTM:_D,BAIDU:xD,IDENTITY:bD,Common:WN}),CD=function(e){return function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.registerRenderer=function(e,t){var n=this.prototype,i=Object.getPrototypeOf(n);return n._rendererClasses&&n._rendererClasses!==i._rendererClasses||(n._rendererClasses=n._rendererClasses?Object.create(n._rendererClasses):{}),n._rendererClasses[e.toLowerCase()]=t,this},t.getRendererClass=function(e){var t=this.prototype;return t._rendererClasses?t._rendererClasses[e.toLowerCase()]:null},t}(e)},SD=0,TD=[],ED=function(){function e(e){var t=this;GO(),this._delayMessages=[],this.initializing=!1;var n=MO(e);EO&&!n&&(this.initializing=!0,console.log("Injecting codes in worker with worker key: :"+e),function(e,n){if(OO[e]){var i=OO[e];if(SI(i)&&0===i.length&&(i=i()),i="("+i+")",SO){var r=SO.workers||[];0===r.length&&console.error("workerpool workers count is 0");var a=0,o=function n(i){(i=i.data||{}).adapterName===e&&++a===r.length&&(r.forEach((function(e){e.removeEventListener("message",n)})),delete OO[e],t.initializing=!1,t.created())};r.forEach((function(t){t.addEventListener("message",o),t.postMessage({key:e,code:i,messageType:"createAdapter"})}))}}else console.error("not find "+e+" adapter")}(e)),this.workerKey=e,this.workerPool=BO(),this.currentActor=0,this.actorId=CA(),this.workers=this.workerPool.acquire(this.actorId),this.callbacks={},this.callbackID=0,this.receiveFn=this.receive.bind(this),this.workers.forEach((function(e){e.addEventListener("message",t.receiveFn,!1)})),IO(e)}var t=e.prototype;return t.created=function(){var e=this;this._delayMessages.forEach((function(t){e[t.command](t.data,t.buffers,t.cb,t.workerId)})),this._delayMessages=[]},t.isActive=function(){return!!this.workers},t.broadcast=function(e,t,n){var i=this;return this.initializing?(this._delayMessages.push({command:"broadcast",data:e,buffers:t,cb:n}),this):(function(n,r,a){n.length||a(null,[]);var o=n.length,s=new Array(n.length),l=null;n.forEach((function(n,r){i.send(e,t,(function(e,t){e&&(l=e),s[r]=t,0==--o&&a(l,s)}),n.id)}))}(this.workers,0,n=n||function(){}),this)},t.send=function(e,t,n,i){if(this.initializing)return this._delayMessages.push({command:"send",data:e,buffers:t,cb:n,workerId:i}),this;var r=n?this.actorId+":"+this.callbackID++:null;return n&&(this.callbacks[r]=n),this.post({data:e,callback:String(r)},t,i),this},t.receive=function(e){var t=this,n=e.data,i=n.callback,r=this.callbacks[i];delete this.callbacks[i],"<request>"===n.type?this.actorId===n.actorId&&this[n.command](n.params,(function(e,i,r){var a={type:"<response>",callback:n.callback};e?a.error=e.message:a.data=i,t.post(a,r||TD,n.workerId)})):r&&n.error?r(n.error):r&&r(null,n.data)},t.remove=function(){var e=this;this.workers.forEach((function(t){t.removeEventListener("message",e.receiveFn,!1)})),delete this.receiveFn,delete this.workers,delete this.callbacks,delete this.workerPool},t.post=function(e,t,n){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.workerPool.workerCount),e.workerId=n,e.workerKey=this.workerKey,e.actorId=this.actorId,this.workerPool.addMessage(n,e,t||TD),n},t.getDedicatedWorker=function(){return SD=(SD+1)%this.workerPool.workerCount},e}(),PD=[],MD=function(e){function t(){return e.call(this,"core-fetch-image")||this}return cA(t,e),t.prototype.fetchImage=function(e,t){this.send({url:e},PD,t)},t}(ED),ID=function(e){function t(t){var n;return(n=e.call(this)||this).layer=t,n._painted=!1,n._drawTime=0,!lA.decodeImageInWorker||lA.safari||lA.iosWeixin||(n._resWorkerConn=new MD),n.setToRedraw(),n}cA(t,e);var n=t.prototype;return n.render=function(e){this.prepareRender(),this.getMap()&&this.layer.isVisible()&&(this.resources||(this.resources=new AD),this.checkAndDraw(this._tryToDraw,e),this._frameTime=e)},n.getFrameTimestamp=function(){return this._frameTime||0},n.checkAndDraw=function(e){var t=this;this._toRedraw=!1;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(this.checkResources){var a=this.checkResources();a.length>0?(this._loadingResource=!0,this.loadResources(a).then((function(){if(t._loadingResource=!1,t.layer){t.layer.fire("resourceload");var e=t.layer.getMap();t.setToRedraw(),e.getRenderer().callInNextFrame((function(){t.setToRedraw()}))}}))):e.call.apply(e,[this].concat(i))}else e.call.apply(e,[this].concat(i))},n.testIfNeedRedraw=function(){var e=this.getMap();return!(this._loadingResource||!this._toRedraw&&(e.isInteracting()&&!this.drawOnInteracting||!this.needToRedraw()))},n.needToRedraw=function(){var e=this.getMap();return!(!e.isInteracting()&&!e.getRenderer().isViewChanged()||!e.getPitch()&&e.isMoving()&&!e.isZooming()&&!e.isRotating()&&!this.layer.options.forceRenderOnMoving)},n.onSkipDrawOnInteracting=function(){},n.isLoadingResource=function(){return this._loadingResource},n.isRenderComplete=function(){return!!this._renderComplete},n.mustRenderOnInteracting=function(){return!this._painted},n.setToRedraw=function(){return this._toRedraw=!0,this},n.setCanvasUpdated=function(){return this._canvasUpdated=!0,this},n.isCanvasUpdated=function(){return!!this._canvasUpdated},n.remove=function(){this.onRemove(),delete this._loadingResource,delete this.southWest,delete this.canvas,delete this.context,delete this.canvasExtent2D,delete this._extent2D,this.resources&&this.resources.remove(),delete this.resources,this._resWorkerConn&&(this._resWorkerConn.remove(),delete this._resWorkerConn),delete this.layer},n.onRemove=function(){},n.onAdd=function(){},n.getMap=function(){return this.layer?this.layer.getMap():null},n.getCanvasImage=function(){var e=this.getMap();if(this._canvasUpdated=!1,this._renderZoom!==e.getZoom()||!this.canvas||!this._extent2D)return null;if(this.isBlank())return null;if(this.layer.isEmpty&&this.layer.isEmpty())return null;var t=e._pointToContainerPoint(this.southWest)._add(0,-e.height);return{image:this.canvas,layer:this.layer,point:t}},n.clear=function(){this.clearCanvas()},n.isBlank=function(){return!this._painted},n.show=function(){this.setToRedraw()},n.hide=function(){this.clear(),this.setToRedraw()},n.setZIndex=function(){this.setToRedraw()},n.hitDetect=function(e){if(!this.context||this.layer.isEmpty&&this.layer.isEmpty()||this.isBlank()||this._errorThrown||this.layer.isVisible&&!this.layer.isVisible())return!1;var t=this.getMap(),n=t.getDevicePixelRatio(),i=t.getSize();if(e.x<0||e.x>i.width*n||e.y<0||e.y>i.height*n)return!1;var r=this.getImageData&&this.getImageData();if(r){var a=Math.round(n*e.x),o=Math.round(n*e.y);return r.data[o*r.width*4+4*a+3]>0}try{if(this.context.getImageData(n*e.x,n*e.y,1,1).data[3]>0)return!0}catch(s){return this._errorThrown||(console&&console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",s),this._errorThrown=!0),!1}return!1},n.loadResources=function(e){this.resources||(this.resources=new AD);var t=this.resources,n=[];if(NA(e))for(var i={},r=e.length-1;r>=0;r--){var a=e[r];a&&a.length&&!i[a.join("-")]&&(i[a.join("-")]=1,t.isResourceLoaded(a,!0)||n.push(new TO(this._promiseResource(a))))}return TO.all(n)},n.prepareRender=function(){delete this._renderComplete;var e=this.getMap();this._renderZoom=e.getZoom(),this.canvasExtent2D=this._extent2D=e._get2DExtent(),this.southWest=e._containerPointToPoint(new xA(0,e.height))},n.createCanvas=function(){if(!this.canvas){var e=this.getMap(),t=e.getSize(),n=e.getDevicePixelRatio(),i=Math.round(n*t.width),r=Math.round(n*t.height);if(this.layer._canvas){var a=this.layer._canvas;a.width=i,a.height=r,a.style&&(a.style.width=t.width+"px",a.style.height=t.height+"px"),this.canvas=this.layer._canvas}else this.canvas=oN.createCanvas(i,r,e.CanvasClass);this.onCanvasCreate()}},n.onCanvasCreate=function(){},n.createContext=function(){if(!(this.gl&&this.gl.canvas===this.canvas||this.context)&&(this.context=oN.getCanvas2DContext(this.canvas),this.context)){this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation);var e=this.getMap().getDevicePixelRatio();1!==e&&this.context.scale(e,e)}},n.resetCanvasTransform=function(){if(this.context){var e=this.getMap().getDevicePixelRatio();this.context.setTransform(e,0,0,e,0,0)}},n.resizeCanvas=function(e){var t=this.canvas;if(t){var n=e||this.getMap().getSize(),i=this.getMap().getDevicePixelRatio(),r=XA(n,i),a=r.width,o=r.height,s=r.cssWidth,l=r.cssHeight;!this.layer._canvas||t.style.width===s&&t.style.height===l||(t.style.width=s,t.style.height=l),t.width===a&&t.height===o||(t.height=o,t.width=a,1!==i&&this.context&&this.context.scale(i,i))}},n.clearCanvas=function(){if(this.context&&this.getMap()){var e=1/this.getMap().getDevicePixelRatio(),t=this.canvas.height*e;oN.clearRect(this.context,0,0,Math.max(this.canvas.width*e,this.canvas.width),Math.max(t,this.canvas.height))}},n.prepareCanvas=function(){this.canvas?(this.resetCanvasTransform(),this.clearCanvas(),this.resizeCanvas()):(this.createCanvas(),this.createContext(),this.layer.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})),delete this._maskExtent;var e=this.layer.getMask();if(!e)return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),null;var t=this._maskExtent=e._getMaskPainter().get2DExtent();return t.intersects(this._extent2D),this.layer.fire("renderstart",{context:this.context,gl:this.gl}),t},n.clipCanvas=function(e){var t=this.layer.getMask();if(!t)return!1;var n=this.southWest,i=this.getMap();this.southWest=i._containerPointToPoint(new xA(0,i.height)),e.save();var r=i.getDevicePixelRatio();if(1!==r&&(e.save(),e.scale(r,r)),t.getGeometries){e.isMultiClip=!0;var a=t.getGeometries()||[];e.beginPath(),a.forEach((function(t){t._getMaskPainter().paint(null,e)})),e.stroke(),e.isMultiClip=!1}else e.isClip=!0,e.beginPath(),t._getMaskPainter().paint(null,e),e.isClip=!1;return 1!==r&&e.restore(),e.clip(),this.southWest=n,!0},n.getViewExtent=function(){return{extent:this._extent2D,maskExtent:this._maskExtent,zoom:this._renderZoom,southWest:this.southWest}},n.completeRender=function(){this.getMap()&&(this._renderComplete=!0,this.layer.fire("renderend",{context:this.context,gl:this.gl}),this.setCanvasUpdated())},n.getEvents=function(){return{_zoomstart:this.onZoomStart,_zooming:this.onZooming,_zoomend:this.onZoomEnd,_resize:this.onResize,_movestart:this.onMoveStart,_moving:this.onMoving,_moveend:this.onMoveEnd,_dragrotatestart:this.onDragRotateStart,_dragrotating:this.onDragRotating,_dragrotateend:this.onDragRotateEnd,_spatialreferencechange:this.onSpatialReferenceChange}},n.onZoomStart=function(){},n.onZoomEnd=function(){this.setToRedraw()},n.onZooming=function(){},n.onMoveStart=function(){},n.onMoving=function(){},n.onMoveEnd=function(){this.setToRedraw()},n.onResize=function(){delete this._extent2D,this.resizeCanvas(),this.setToRedraw()},n.onDragRotateStart=function(){},n.onDragRotating=function(){},n.onDragRotateEnd=function(){this.setToRedraw()},n.onSpatialReferenceChange=function(){},n.getDrawTime=function(){return this._drawTime},n._tryToDraw=function(e){this._toRedraw=!1,!this.canvas&&this.layer.isEmpty&&this.layer.isEmpty()?this._renderComplete=!0:this._drawAndRecord(e)},n._drawAndRecord=function(e){if(this.getMap()){var t=this._painted;this._painted=!0;var n=yI();this.draw(e),n=yI()-n,this._drawTime=t?n:n/2,t&&this.layer&&this.layer.options.logDrawTime&&console.log(this.layer.getId(),"frameTimeStamp:",e,"drawTime:",this._drawTime)}},n._promiseResource=function(e){var t=this.layer,n=this,i=this.resources,r=t.options.crossOrigin,a=t.options.renderer||"";return function(o){if(i.isResourceLoaded(e,!0))o(e);else if(bA(e[0])||!n._resWorkerConn||"canvas"===t.options.renderer&&!t.options.decodeImageInWorker){var s=new Image;xI(r)?"canvas"!==a&&(s.crossOrigin=""):s.crossOrigin=r,bA(e[0])&&!AI&&(e[1]&&(e[1]*=2),e[2]&&(e[2]*=2)),s.onload=function(){n._cacheResource(e,s),o(e)},s.onabort=function(t){console&&console.warn("image loading aborted: "+e[0]),t&&console&&console.warn(t),o(e)},s.onerror=function(t){t&&"undefined"!=typeof console&&console.warn(t),i.markErrorResource(e),o(e)},wA(s,e)}else{var l=GA(e[0]);n._resWorkerConn.fetchImage(l,(function(t,i){if(t)return t&&"undefined"!=typeof console&&console.warn(t),void o(e);qA(i,(function(t){n._cacheResource(e,t),o(e)}))}))}}},n._cacheResource=function(e,t){if(this.layer&&this.resources){var n=e[1],i=e[2];if(this.layer.options.cacheSvgOnCanvas&&1===bA(e[0])&&(lA.edge||lA.ie)){xI(n)&&(n=t.width||this.layer.options.defaultIconSize[0]),xI(i)&&(i=t.height||this.layer.options.defaultIconSize[1]);var r=oN.createCanvas(n,i);oN.image(r.getContext("2d"),t,0,0,n,i),t=r}this.resources.addResource(e,t)}},t}(pN),AD=function(){function e(){this.resources={},this._errors={}}var t=e.prototype;return t.addResource=function(e,t){var n=this;if(this.resources[e[0]]={image:t,width:+e[1],height:+e[2],refCnt:0},t&&t.width&&t.height&&!t.close&&lA.imageBitMap&&!lA.safari&&!lA.iosWeixin){if(t.src&&bA(t.src))return;createImageBitmap(t).then((function(t){n.resources[e[0]]&&(n.resources[e[0]].image=t)}))}},t.isResourceLoaded=function(e,t){if(!e)return!1;var n=this._getImgUrl(e);if(this._errors[n])return!0;var i=this.resources[n];return!(!i||t&&bA(e[0])&&(+e[1]>i.width||+e[2]>i.height))},t.login=function(e){var t=this.resources[e];t&&t.refCnt++},t.logout=function(e){var t=this.resources[e];t&&t.refCnt--<=0&&(t.image&&t.image.close&&t.image.close(),delete this.resources[e])},t.getImage=function(e){var t=this._getImgUrl(e);return!this.isResourceLoaded(e)||this._errors[t]?null:this.resources[t].image},t.markErrorResource=function(e){this._errors[this._getImgUrl(e)]=1},t.merge=function(e){if(!e)return this;for(var t in e.resources){var n=e.resources[t];this.addResource([t,n.width,n.height],n.image)}return this},t.forEach=function(e){if(!this.resources)return this;for(var t in this.resources)EI(this.resources,t)&&e(t,this.resources[t]);return this},t._getImgUrl=function(e){return Array.isArray(e)?e[0]:e},t.remove=function(){for(var e in this.resources){var t=this.resources[e];t&&t.image&&t.image.close&&t.image.close()}this.resources={}},e}();lA.decodeImageInWorker&&(OO["core-fetch-image"]=function(){return"\nfunction (exports) {\n    exports.onmessage = function (msg, postResponse) {\n        var url = msg.data.url;\n        var fetchOptions = msg.data.fetchOptions;\n        requestImageOffscreen(url, function (err, data) {\n            var buffers = [];\n            if (data && data.data) {\n                buffers.push(data.data);\n            }\n            postResponse(err, data, buffers);\n        }, fetchOptions);\n    };\n\n    function requestImageOffscreen(url, cb, fetchOptions) {\n        fetch(url, fetchOptions ? fetchOptions : {})\n            .then(response => response.arrayBuffer())\n            .then(arrayBuffer => {\n                const blob=new Blob([arrayBuffer]);\n                return createImageBitmap(blob);\n            })\n            .then(bitmap => {\n                cb(null, {data:bitmap});\n            }).catch(err => {\n                console.warn('error when loading tile:', url);\n                console.warn(err);\n                cb(err);\n            });\n    }\n}"});var RD=new xA(0,0);function OD(e,t,n,i,r,a){var o=r.x+a.x,s=r.y+a.y;RD.x=o,RD.y=s;var l=function(e){if(!e)return 0;var t=e.x,n=e.y;if(0===t&&0===n)return 0;if(0===t||!t){if(n<0)return-Math.PI/2;if(n>0)return Math.PI/2}var i=n/t;return n<0&&t<0?Math.atan(i)-Math.PI:n>0&&t<0?Math.atan(i)+Math.PI:Math.atan(i)}(RD),u=Math.sqrt(o*o+s*s),c=0,h=0;c+=Math.cos(t+l)*u,h+=Math.sin(t+l)*u;var d=function(e,t,n){var i=Math.PI/2+n,r=Math.PI/4+n,a=n,o=t,s=Math.sqrt(e*e+t*t),l=e,u=Math.cos(i)*o,c=Math.sin(i)*o,h=Math.cos(r)*s,d=Math.sin(r)*s,f=Math.cos(a)*l,p=Math.sin(a)*l,m=Math.min(u,h,f,0),v=Math.min(c,d,p,0);return[m,v,Math.max(u,h,f,0)-m,Math.max(c,d,p,0)-v]}(n,i,t),f=d[3];h+=d[1];var p=(c+=d[0])+Math.max(n,d[2]),m=h+Math.max(i,f);return e.set(c,h,p,m),e}var ND=new xA(0,0);function DD(e,t,n,i,r,a,o){var s=ND.set(t,n);if(i)return OD(e,i,a,o,s,r);var l,u,c=e.set(s.x,s.y,s.x+a,s.y+o);return c._add(r),i&&(u=i,UD.set((l=c).xmin,l.ymin,l.xmax,l.ymax),UD.convertTo((function(e){return e._rotate(u)}),l)),c}var zD=[];function LD(e,t,n){if((n=n||VD(zD,t))&&(0===n[0]||0===n[1]))return nz(e),e;var i=HD(t,n[0],n[1]);return DD(e,t.markerDx||0,t.markerDy||0,qD(t),i,n[0],n[1])}function BD(e){return"rectangle"===e?"right":"middle"}function FD(e){return"bar"===e||"pie"===e||"pin"===e?"top":"rectangle"===e?"bottom":"middle"}var jD=new AR(0,0);function HD(e,t,n){var i=2*(e.shadowBlur||0)+.5;jD.width=t,jD.height=n;var r=e.markerType,a=VR(jD,e.markerHorizontalAlignment||BD(r),e.markerVerticalAlignment||FD(r));return a.x!==-t/2&&(a.x-=IA(a.x+t/2)*i),a.y!==-n/2&&(a.y-=IA(a.y+n/2)*i),a}function VD(e,t){var n=MA(t.markerWidth,10),i=MA(t.markerHeight,10);if(0===n||0===i)return e[0]=0,e[1]=0,e;var r=MA(t.markerLineWidth,1),a=2*((t.shadowBlur||0)+Math.max(Math.abs(t.shadowOffsetX||0)+Math.abs(t.shadowOffsetY||0))),o=Math.round(n+r+a+1),s=Math.round(i+r+a+1);return e[0]=o,e[1]=s,e}var UD=new qN;function qD(e,t){void 0===t&&(t="markerRotation");var n=e[t];return bI(n)?-n*Math.PI/180:0}function GD(e,t,n){var i=n?n.getImage(t.markerFile):null,r=t.markerWidth||(i?i.width:0),a=t.markerHeight||(i?i.height:0);if(jD.width=r,jD.height=a,0===t.markerWidth||0===t.markerHeight)return nz(e),e;var o=VR(jD,t.markerHorizontalAlignment||"middle",t.markerVerticalAlignment||"top");return DD(e,t.markerDx||0,t.markerDy||0,qD(t),o,r,a)}function WD(e,t,n){var i=n.size;if(i&&(0===i.width||0===i.height))return nz(e),e;var r=VR(i,t.textHorizontalAlignment,t.textVerticalAlignment),a=t.textHaloRadius||0,o=DD(e,t.textDx||0,t.textDy||0,qD(t,"textRotation"),r,i.width,i.height);return o.xmin-=a,o.xmax+=a,o.ymin-=a,o.ymax+=a,o}var ZD=new qN;function XD(e,t,n,i){var r=e||new qN;if(Array.isArray(t)){for(var a=t,o=0;o<a.length;o++)XD(r,a[o],n,i[o]);return r}return KD(t)&&r._combine(WD(ZD,t,i)),YD(t)&&r._combine(GD(ZD,t,n)),JD(t)&&r._combine(LD(ZD,t)),QD(t)&&r._combine(GD(ZD,t)),r}function KD(e){return!!e&&!xI(e.textName)}function YD(e){return!!e&&!xI(e.markerFile)}function JD(e){return!!e&&!(!xI(e.markerFile)||xI(e.markerType)||"path"===e.markerType)}function QD(e){return!!e&&!(!xI(e.markerFile)||"path"!==e.markerType)}var $D,ez=["markerWidth","markerHeight","markerHorizontalAlignment","markerVerticalAlignment","markerDx","markerDy","markerRotation","textName","textSize","textDx","textDy","textVerticalAlignment","textHorizontalAlignment","textRotation","textWrapWidth"],tz=["textName","markerType","markerFile","textHaloRadius","shadowBlur","shadowOffsetX","shadowOffsetY","textWrapWidth"];function nz(e){e&&(e.xmin=1/0,e.ymin=1/0,e.xmax=-1/0,e.ymax=-1/0)}function iz(e,t,n,i){for(var r,a=[],o=0,s=0,l=e.length;s<l-1;s++)(r=rz(e[s],e[s+1],t,s,n,i))&&(a[o]=a[o]||[],a[o].push({point:r[0],index:s}),r[1]===e[s+1]&&s!==l-2||(a[o].push({point:r[1],index:s+1}),o++));return a}function rz(e,t,n,i,r,a){var o,s,l,u=i?$D:sz(e,n),c=sz(t,n);for($D=c;;){if(!(u|c))return[e,t];if(u&c)return!1;if(a)return[e,t];l=sz(s=oz(e,t,o=u||c,n,r),n),o===u?(e=s,u=l):(t=s,c=l)}}function az(e,t,n){var i,r,a,o,s,l,u,c,h,d=[1,4,2,8];for(r=0,u=e.length;r<u;r++)e[r]._code=sz(e[r],t);for(o=0;o<4;o++){for(c=d[o],i=[],r=0,a=(u=e.length)-1;r<u;a=r++)l=e[a],(s=e[r])._code&c?l._code&c||((h=oz(l,s,c,t,n))._code=sz(h,t),i.push(h)):(l._code&c&&((h=oz(l,s,c,t,n))._code=sz(h,t),i.push(h)),i.push(s));e=i}return e}function oz(e,t,n,i,r){var a,o,s=t.x-e.x,l=t.y-e.y,u=i.getMin(),c=i.getMax();8&n?(a=e.x+s*(c.y-e.y)/l,o=c.y):4&n?(a=e.x+s*(u.y-e.y)/l,o=u.y):2&n?(a=c.x,o=e.y+l*(c.x-e.x)/s):1&n&&(a=u.x,o=e.y+l*(u.x-e.x)/s);var h=new xA(a,o);return r&&h._round(),h}function sz(e,t){var n=0;return e.x<t.getMin().x?n|=1:e.x>t.getMax().x&&(n|=2),e.y<t.getMin().y?n|=4:e.y>t.getMax().y&&(n|=8),n}function lz(e,t,n,i){e=new xA(e);var r,a,o,s=Math.abs(n.x-t.x),l=Math.abs(n.y-t.y),u=Math.sqrt(Math.abs(s*s-l*l));return s>=l?(r=new xA(t.x-u,t.y),a=new xA(t.x+u,t.y),o=2*s):(r=new xA(t.x,t.y-u),a=new xA(t.x,t.y+u),o=2*l),e.distanceTo(r)+e.distanceTo(a)<=o+2*i}var uz=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n._prepareContext=function(e){if(oR(this.symbol.opacity)?this._opacityFn||(this._opacityFn=lR(this.symbol.opacity)):delete this._opacityFn,bI(this.symbol.opacity))e.globalAlpha!==this.symbol.opacity&&(e.globalAlpha=this.symbol.opacity);else if(this._opacityFn){var t=this.getMap();e.globalAlpha=this._opacityFn(t.getZoom())}else 1!==e.globalAlpha&&(e.globalAlpha=1)},n.prepareCanvas=function(e,t,n){e.setLineDash&&NA(t.lineDasharray)&&e.setLineDash(t.lineDasharray);var i=this.getPainter().isHitTesting();oN.prepareCanvas(e,t,n,i)},n.remove=function(){},n.setZIndex=function(){},n.show=function(){},n.hide=function(){},n._defineStyle=function(e){return TR(e,this.geometry)},t}(function(){function e(){this.bbox=[1/0,1/0,-1/0,-1/0]}var t=e.prototype;return t._setBBOX=function(e,t,n,i,r){return e.isHitTesting||tN(this.bbox,t,n,i,r),this},t._bufferBBOX=function(e,t){return void 0===t&&(t=0),e.isHitTesting||function(e,t){void 0===t&&(t=0),e[0]-=t,e[1]-=t,e[2]+=t,e[3]+=t}(this.bbox,t),this},t.getMap=function(){return this.geometry.getMap()},t.getPainter=function(){return this.painter},t.isDynamicSize=function(){return!1},e.testColor=function(e){return!(!e||!CI(e))&&gI.indexOf(e)>=0},e}());function cz(e,t,n,i){var r,a=hz(n),o=n,s=o.markerType.toLowerCase(),l=dz(s,o.markerWidth,o.markerHeight),u=a.lineOpacity,c=a.polygonOpacity;WR(a.polygonFill)&&WR(a.polygonFill)&&(r||(r=function(e,t,n){var i=new qN;return i._combine(e),i.xmin+=-t/2,i.ymin+=-n/2,i.xmax+=t/2,i.ymax+=n/2,i}(t,o.markerWidth,o.markerHeight)),a.polygonGradientExtent=r),oN.prepareCanvas(e,a,i);var h=o.markerWidth,d=o.markerHeight,f=o.markerLineWidth/2;if("ellipse"===s)oN.ellipse(e,t,h/2,d/2,d/2,u,c);else if("cross"===s||"x"===s){for(var p=l.length-1;p>=0;p--)l[p]._add(t);oN.path(e,l.slice(0,2),u),oN.path(e,l.slice(2,4),u)}else if("diamond"===s||"bar"===s||"square"===s||"rectangle"===s||"triangle"===s){"bar"===s?t=t.add(0,-f):"rectangle"===s&&(t=t.add(f,f));for(var m=l.length-1;m>=0;m--)l[m]._add(t);oN.polygon(e,l,u,c)}else if("pin"===s){t=t.add(0,-f);for(var v=l.length-1;v>=0;v--)l[v]._add(t);var g=e.lineCap;e.lineCap="round",oN.bezierCurveAndFill(e,l,u,c),e.lineCap=g}else{if("pie"!==s)throw new Error("unsupported markerType: "+s);t=t.add(0,-f);var y=180*Math.atan(h/2/d)/Math.PI,_=e.lineCap;e.lineCap="round",oN.sector(e,t,d,[90-y,90+y],u,c),e.lineCap=_}return e.canvas}function hz(e){var t={lineColor:e.markerLineColor,linePatternFile:e.markerLinePatternFile,lineWidth:e.markerLineWidth,lineOpacity:e.markerLineOpacity,lineDasharray:e.markerLineDasharray,lineCap:"butt",lineJoin:"round",polygonFill:e.markerFill,polygonPatternFile:e.markerFillPatternFile,polygonOpacity:e.markerFillOpacity};return 0===t.lineWidth&&(t.lineOpacity=0),t}function dz(e,t,n){var i,r,a,o,s=n/2,l=t/2;if("triangle"===e)return[i=new xA(0,0-s),r=new xA(0-l,0+s),a=new xA(0+l,0+s)];if("cross"===e)return[i=new xA(0-l,0),r=new xA(0+l,0),a=new xA(0,0-s),o=new xA(0,0+s)];if("diamond"===e)return[i=new xA(0-l,0),r=new xA(0,0-s),a=new xA(0+l,0),o=new xA(0,0+s)];if("square"===e)return[i=new xA(0-l,0+s),r=new xA(0+l,0+s),a=new xA(0+l,0-s),o=new xA(0-l,0-s)];if("rectangle"===e)return r=(i=new xA(0,0)).add(t,0),a=i.add(t,n),o=i.add(0,n),[i,r,a,o];if("x"===e)return[i=new xA(0-l,0+s),r=new xA(0+l,0-s),a=new xA(0+l,0+s),o=new xA(0-l,0-s)];if("bar"===e)return[i=new xA(0-l,0-n),r=new xA(0+l,0-n),a=new xA(0+l,0),o=new xA(0-l,0)];if("pin"===e||"pie"===e){var u=n*Math.atan(l/s);return[i=new xA(0,0),r=new xA(0-u,0-n),a=new xA(0+u,0-n),o=new xA(0,0)]}return[]}var fz,pz=new xA(0,0),mz=new xA(0,0),vz=new xA(0,0),gz=new xA(0,0),yz=function(e){function t(t,n,i){var r;return(r=e.call(this)||this).symbol=t,r.geometry=n,r.painter=i,r}cA(t,e);var n=t.prototype;return n.get2DExtent=function(){for(var e=this.getMap(),t=e.getGLRes(),n=new qN,i=this._getRenderPoints()[0],r=i.length-1;r>=0;r--)i[r]&&n._combine(e._pointAtResToPoint(i[r],t));return n},n.isDynamicSize=function(){var e=this.symbol;return oR(e.markerWidth)||oR(e.markerHeight)||oR(e.textSize)},n._rotateExtent=function(e,t){return e.convertTo((function(e){return e._rotate(t)}))},n._getRenderPoints=function(){var e=this.getPainter().isSpriting()?"center":this.getPlacement();return this.getPainter().getRenderPoints(e)},n._getRenderContainerPoints=function(e){var t=this.getPainter();if(t.isSpriting())return this._getRenderPoints()[0];var n,i=this.geometry,r=this.getDxDy();if(i._cPoint&&!e){var a=e?vz:gz;a.set(i._cPoint.x,i._cPoint.y),a._sub(t.containerOffset);var o=r.x,s=r.y;(o||s)&&a._add(o||0,s||0),n=[a]}else{var l=this._getRenderPoints()[0];n=this.painter._pointContainerPoints(l,r.x,r.y,e,!0,this.getPlacement())}if(!n||!Array.isArray(n[0]))return n;for(var u=[],c=0,h=n.length;c<h;c++)for(var d=0,f=n[c].length;d<f;d++)u.push(n[c][d]);return u},n.getPlacement=function(){return this.symbol.markerPlacement},n.getRotation=function(){return qD(this.style)},n.getDxDy=function(){var e=this.style;return new xA(e.markerDx,e.markerDy)},n._getRotationAt=function(e){var t=this.getRotation();t||(t=0);var n=this._getRenderPoints()[1];if(!n||!n[e])return t;var i=this.getMap(),r=n[e][0],a=n[e][1];if(i.isTransforming()){var o=i.getGLRes();return r=i._pointAtResToContainerPoint(n[e][0],o,0,pz),a=i._pointAtResToContainerPoint(n[e][1],o,0,mz),t+BA(r.x,r.y,a.x,a.y)}return t+-BA(r.x,r.y,a.x,a.y)},n._rotate=function(e,t,n){if(n){var i=this.getDxDy(),r=t.sub(i);return e.save(),e.translate(r.x,r.y),e.rotate(n),i}return null},t}(uz),_z=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.getPlacement=function(){return"point"},n.getDxDy=function(){return new xA(0,0)},n.symbolize=function(e){var t=this.geometry,n=t.getLayer();if(t.options.debug||!n||n.options.debug){var i=this.getMap();if(i&&!i.isZooming()){var r=n.options.debugOutline;e.strokeStyle=r,e.fillStyle=r,e.lineWidth=1,e.font="18px  serif";var a=t.getContainerExtent().toArray();oN.polygon(e,[a],1,0);for(var o=this._getRenderContainerPoints(),s=this.geometry.getId(),l=dz("cross",10,10),u=0;u<o.length;u++){var c=o[u];xI(s)||oN.fillText(e,s,c.add(8,-4),r);for(var h=[],d=0;d<l.length;d++)h.push(l[d].add(c));oN.path(e,h.slice(0,2),1),oN.path(e,h.slice(2,4),1)}}}},t}(yz),xz=new AR(1,1),bz=new qN,wz=function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).style=r._defineStyle(r.translate()),r}cA(t,e),t.test=function(e){return YD(e)};var n=t.prototype;return n.symbolize=function(e,t){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&0!==n.markerOpacity){var i=this._getRenderContainerPoints();if(NA(i)){var r=this._getImage(t);if(r){this._prepareContext(e);var a,o=n.markerWidth,s=n.markerHeight;if(!bI(o)||!bI(s)){s=r.height,n.markerWidth=o=r.width,n.markerHeight=s;var l=n.markerFile;t.isResourceLoaded(l)||t.addResource(l,r);var u=this.getPainter();u.isSpriting()||u.removeCache()}"path"!==this.symbol.markerType&&bI(n.markerOpacity)&&n.markerOpacity<1&&(a=e.globalAlpha,e.globalAlpha*=n.markerOpacity),xz.width=o,xz.height=s;for(var c=VR(xz,n.markerHorizontalAlignment,n.markerVerticalAlignment),h=0,d=i.length;h<d;h++){var f=i[h],p=this.getRotation()?this._rotate(e,f,this._getRotationAt(h)):null,m=void 0;if(p){var v=f.sub(p);f=p;var g=this._getRotationAt(h);(m=OD(bz,g,o,s,f,c))._add(v)}var y=f.x+c.x,_=f.y+c.y;oN.image(e,r,y,_,o,s),p&&e.restore(),p?this._setBBOX(e,m.xmin,m.ymin,m.xmax,m.ymax):this._setBBOX(e,y,_,y+o,_+s)}void 0!==a&&(e.globalAlpha=a)}else"undefined"!=typeof console&&console.warn("no img found for "+(this.style.markerFile||this._url[0]))}}},n._getImage=function(e){return function(e,t){return e&&e.getImage(t)||null}(e,this.style.markerFile)},n.getFixedExtent=function(e){return this._fixedExtent=this._fixedExtent||new qN,GD(this._fixedExtent,this.style,e)},n.translate=function(){var e=this.symbol;return{markerFile:e.markerFile,markerOpacity:MA(e.markerOpacity,1),markerWidth:MA(e.markerWidth,null),markerHeight:MA(e.markerHeight,null),markerRotation:MA(e.markerRotation,0),markerDx:MA(e.markerDx,0),markerDy:MA(e.markerDy,0),markerHorizontalAlignment:MA(e.markerHorizontalAlignment,"middle"),markerVerticalAlignment:MA(e.markerVerticalAlignment,"top")}},t}(yz),kz=new PN(0,0),Cz=new PN(0,0),Sz=function(e){function t(t,n,i){var r;return(r=e.call(this)||this).symbol=t,r.geometry=n,r.painter=i,n.isPoint?vA(r):(r.style=r._defineStyle(r.translate()),r)}cA(t,e),t.test=function(e,t){if(!e)return!1;if(t&&t.isPoint)return!1;for(var n in e){var i=n.slice(0,4);if("line"===i||"poly"===i)return!0}return!1};var n=t.prototype;return n.symbolize=function(e,t){var n=this.style;if(0!==n.polygonOpacity||0!==n.lineOpacity||this.painter.isHitTesting()){var i=this._getPaintParams();if(i){this._prepareContext(e);var r=WR(n.lineColor),a="Polygon"===this.geometry.getJSONType()||"LineString"===this.geometry.type;!r||!n.lineColor.places&&a||(n.lineGradientExtent=this.geometry.getContainerExtent()._expand(n.lineWidth)),WR(n.polygonFill)&&(n.polygonGradientExtent=this.geometry.getContainerExtent());var o=this.geometry.getLayer().options.geometryEventTolerance||0,s=this.geometry._hitTestTolerance()+o,l=i[0];if("Polygon"===this.geometry.getJSONType()&&l.length>0&&Array.isArray(l[0][0])||"LineString"===this.geometry.type&&l.length>0&&Array.isArray(l[0]))for(var u=0;u<l.length;u++){this.prepareCanvas(e,n,t),r&&a&&!n.lineColor.places&&this._createGradient(e,l[u],n.lineColor);var c=[e,l[u]];i.length>1&&c.push.apply(c,i.slice(1)),c.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray);var h=this.geometry._paintOn.apply(this.geometry,c);this._setBBOX(e,h),this._bufferBBOX(e,s)}else{this.prepareCanvas(e,n,t),r&&a&&!n.lineColor.places&&this._createGradient(e,l,n.lineColor);var d=[e];d.push.apply(d,i),d.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray);var f=this.geometry._paintOn.apply(this.geometry,d);this._setBBOX(e,f),this._bufferBBOX(e,s)}e.setLineDash&&Array.isArray(n.lineDasharray)&&e.setLineDash([])}}},n.get2DExtent=function(){var e=this.getMap(),t=this.geometry._getPrjExtent();if(!t)return null;this._extMin&&this._extMax||(this._extMin=new PN(0,0),this._extMax=new PN(0,0)),this._extMin.x=t.xmin,this._extMin.y=t.ymin,this._extMax.x=t.xmax,this._extMax.y=t.ymax;var n=e._prjToPoint(this._extMin,void 0,kz),i=e._prjToPoint(this._extMax,void 0,Cz);return this._pxExtent?this._pxExtent.set(Math.min(n.x,i.x),Math.min(n.y,i.y),Math.max(n.x,i.x),Math.max(n.y,i.y)):this._pxExtent=new qN(n,i),this._pxExtent},n.getFixedExtent=function(){var e=this.style.lineWidth/2;return new qN(-e,-e,e,e)},n._getPaintParams=function(){return this.getPainter().getPaintParams(this.style.lineDx,this.style.lineDy)},n.translate=function(){var e=this.symbol,t={lineColor:MA(e.lineColor,"#000"),lineWidth:MA(e.lineWidth,2),lineOpacity:MA(e.lineOpacity,1),lineDasharray:MA(e.lineDasharray,[]),lineCap:MA(e.lineCap,"butt"),lineJoin:MA(e.lineJoin,"miter"),linePatternFile:MA(e.linePatternFile,null),lineDx:MA(e.lineDx,0),lineDy:MA(e.lineDy,0),polygonFill:MA(e.polygonFill,null),polygonOpacity:MA(e.polygonOpacity,1),polygonPatternFile:MA(e.polygonPatternFile,null),polygonPatternDx:MA(e.polygonPatternDx,0),polygonPatternDy:MA(e.polygonPatternDy,0),linePatternDx:MA(e.linePatternDx,0),linePatternDy:MA(e.linePatternDy,0)};return 0===t.lineWidth&&(t.lineOpacity=0),"LineString"!==this.geometry.type||t.polygonFill||(t.polygonFill=t.lineColor),t},n._createGradient=function(e,t,n){if(Array.isArray(t)&&t.length){var i=function(e){var t,n=!0;Array.isArray(e[0])?(t=e[0],n=!1):t=e;var i=t.length;if(n)return[t[0],t[i-1]];for(var r,a=t[0],o=0,s=1;s<i;s++){var l=t[s],u=a.distanceTo(l);u>o&&(o=u,r=l)}return[a,r]}(t),r=i[0],a=i[1];if(r&&a){var o=e.createLinearGradient(r.x,r.y,a.x,a.y);n.colorStops.forEach((function(e){o.addColorStop.apply(o,e)})),e.strokeStyle=o}else console.error("unable create canvas LinearGradient,error data:",t)}},t}(uz),Tz=new qN,Ez=function(e){function t(t,n,i){var r,a=(r=e.call(this,t,n,i)||this).translate();return r._dynamic=sR(a),r.style=r._defineStyle(a),0===r.style.textWrapWidth?vA(r):(r.strokeAndFill=r._defineStyle(r.translateLineAndFill(r.style)),r)}cA(t,e),t.test=function(e){return KD(e)};var n=t.prototype;return n.symbolize=function(e,t){if(this.painter.isHitTesting()||0!==this.style.textSize&&(this.style.textOpacity||this.style.textHaloRadius&&this.style.textHaloOpacity)&&0!==this.style.textWrapWidth){var n=this._getRenderContainerPoints();if(NA(n)){var i=this.style,r=this.strokeAndFill,a=jR(this.style.textName,this.geometry.getProperties());this._dynamic&&delete this._textDesc;var o=this._textDesc=this._textDesc||HR(a,this.style);this._prepareContext(e),this.prepareCanvas(e,r,t),oN.prepareCanvasFont(e,i);for(var s=i.textHaloRadius||0,l=0,u=n.length;l<u;l++){var c=n[l],h=this.getRotation()?this._rotate(e,c,this._getRotationAt(l)):null,d=void 0;if(h){var f=c.sub(h);c=h;var p=this._getRotationAt(l),m=o.size||{width:0,height:0},v=m.width,g=m.height,y=VR(o.size,i.textHorizontalAlignment,i.textVerticalAlignment);(d=OD(Tz,p,v,g,c,y))._add(f)}var _=oN.text(e,a,c,i,o);h?(this._setBBOX(e,d.xmin,d.ymin,d.xmax,d.ymax),e.restore()):this._setBBOX(e,_),this._bufferBBOX(e,s)}}}},n.getPlacement=function(){return this.symbol.textPlacement},n.getRotation=function(){var e=this.style.textRotation;return bI(e)?-e*Math.PI/180:null},n.getDxDy=function(){var e=this.style;return new xA(e.textDx,e.textDy)},n.getFixedExtent=function(){var e=this.geometry.getTextDesc();return Array.isArray(e)&&(e=e[this._index]),this._fixedExtent=this._fixedExtent||new qN,e?WD(this._fixedExtent,this.style,e):this._fixedExtent},n.translate=function(){var e=this.symbol,t={textName:e.textName,textFaceName:MA(e.textFaceName,"monospace"),textWeight:MA(e.textWeight,"normal"),textStyle:MA(e.textStyle,"normal"),textSize:MA(e.textSize,14),textFont:MA(e.textFont,null),textFill:MA(e.textFill,"#000"),textOpacity:MA(e.textOpacity,1),textHaloFill:MA(e.textHaloFill,"#ffffff"),textHaloRadius:MA(e.textHaloRadius,0),textHaloOpacity:MA(e.textHaloOpacity,1),textWrapWidth:MA(e.textWrapWidth,null),textWrapCharacter:MA(e.textWrapCharacter,"\n"),textLineSpacing:MA(e.textLineSpacing,0),textDx:MA(e.textDx,0),textDy:MA(e.textDy,0),textHorizontalAlignment:MA(e.textHorizontalAlignment,"middle"),textVerticalAlignment:MA(e.textVerticalAlignment,"middle"),textAlign:MA(e.textAlign,"center"),textRotation:MA(e.textRotation,0),textMaxWidth:MA(e.textMaxWidth,0),textMaxHeight:MA(e.textMaxHeight,0)};return t.textMaxWidth>0&&(!t.textWrapWidth||t.textWrapWidth>t.textMaxWidth)&&(t.textWrapWidth||(t.textMaxHeight=1),t.textWrapWidth=t.textMaxWidth),t},n.translateLineAndFill=function(e){return{lineColor:e.textHaloRadius?e.textHaloFill:e.textFill,lineWidth:e.textHaloRadius,lineOpacity:e.textOpacity,lineDasharray:null,lineCap:"butt",lineJoin:"round",polygonFill:e.textFill,polygonOpacity:e.textOpacity}},t}(yz),Pz=[],Mz=new qN,Iz=new xA(0,0),Az=function(e){function t(t,n,i){var r,a=(r=e.call(this,t,n,i)||this).translate();return r._dynamic=sR(a),r.style=r._defineStyle(a),r.strokeAndFill=r._defineStyle(hz(r.style)),r.padding=0,r}cA(t,e),t.test=function(e){return JD(e)};var n=t.prototype;return n.symbolize=function(e,t){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&(0!==n.polygonOpacity||0!==n.lineOpacity)){var i=this._getRenderContainerPoints();NA(i)&&(this._prepareContext(e),this.getPainter().isSpriting()||this.geometry.getLayer().getMask()===this.geometry||this._dynamic||!1===this.geometry.getLayer().options.cacheVectorOnCanvas?this._drawMarkers(e,i,t):this._drawMarkersWithCache(e,i,t))}},n._drawMarkers=function(e,t,n){for(var i=t.length-1;i>=0;i--){var r=t[i],a=VD(Pz,this.style),o=a[0],s=a[1],l=void 0,u=this.getRotation()?this._rotate(e,r,this._getRotationAt(i)):null;if(u){var c=r.sub(u);r=u;var h=this._getRotationAt(i);(l=OD(Mz,h,o,s,r,Iz))._add(c)}if(this._drawVectorMarker(e,r,n),u)e.restore(),this._setBBOX(e,l.xmin,l.ymin,l.xmax,l.ymax);else{var d=r.x,f=r.y;this._setBBOX(e,d,f,d+o,f+s)}}},n._drawMarkersWithCache=function(e,t,n){var i=this._stampSymbol(),r=n.getImage(i);r||(r=this._createMarkerImage(e,n),n.addResource([i,r.width,r.height],r));for(var a=HD(this.style,r.width,r.height),o=t.length-1;o>=0;o--){var s=t[o],l=this.getRotation()?this._rotate(e,s,this._getRotationAt(o)):null,u=void 0;if(l){var c=s.sub(l);s=l;var h=this._getRotationAt(o);(u=OD(Mz,h,r.width,r.height,s,a))._add(c)}var d=s.x+a.x,f=s.y+a.y;oN.image(e,r,d,f),l?(e.restore(),this._setBBOX(e,u.xmin,u.ymin,u.xmax,u.ymax)):this._setBBOX(e,d,f,d+r.width,f+r.height)}},n._createMarkerImage=function(e,t){var n=e.canvas.constructor,i=VD(Pz,this.style),r=oN.createCanvas(i[0],i[1],n),a=this._getCacheImageAnchor(i[0],i[1]),o=r.getContext("2d");return this._drawVectorMarker(o,a,t),r},n._stampSymbol=function(){return this._stamp||(this._stamp=GR([this.style.markerType,WR(this.style.markerFill)?ZR(this.style.markerFill):this.style.markerFill,this.style.markerFillOpacity,this.style.markerFillPatternFile,WR(this.style.markerLineColor)?ZR(this.style.markerLineColor):this.style.markerLineColor,this.style.markerLineWidth,this.style.markerLineOpacity,this.style.markerLineDasharray?this.style.markerLineDasharray.join(","):"",this.style.markerLinePatternFile,this.style.markerWidth,this.style.markerHeight,this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment].join("_"))),this._stamp},n._getCacheImageAnchor=function(e,t){var n=2*(this.symbol.shadowBlur||0)+this.padding,i=this.style.markerType;return"bar"===i||"pie"===i||"pin"===i?new xA(e/2,t-n):"rectangle"===i?new xA(n,n):new xA(e/2,t/2)},n._getGraidentExtent=function(e){var t=new qN,n=this.getDxDy(),i=this.getFixedExtent();if(Array.isArray(e))for(var r=e.length-1;r>=0;r--)t._combine(e[r]);else t._combine(e);return t.xmin+=i.xmin-n.x,t.ymin+=i.ymin-n.y,t.xmax+=i.xmax-n.x,t.ymax+=i.ymax-n.y,t},n._drawVectorMarker=function(e,t,n){cz(e,t,this.style,n)},n.getFixedExtent=function(){var e=this.isDynamicSize(),t=this.style.markerWidth,n=this.style.markerHeight;return this._fixedExtent=this._fixedExtent||new qN,LD(this._fixedExtent,this.style,e?[128,128*(0===t?1:n/t)]:null)},n.translate=function(){var e=this.symbol,t={markerType:MA(e.markerType,"ellipse"),markerFill:MA(e.markerFill,"#00f"),markerFillOpacity:MA(e.markerFillOpacity,1),markerFillPatternFile:MA(e.markerFillPatternFile,null),markerLineColor:MA(e.markerLineColor,"#000"),markerLineWidth:MA(e.markerLineWidth,1),markerLineOpacity:MA(e.markerLineOpacity,1),markerLineDasharray:MA(e.markerLineDasharray,[]),markerLinePatternFile:MA(e.markerLinePatternFile,null),markerDx:MA(e.markerDx,0),markerDy:MA(e.markerDy,0),markerWidth:MA(e.markerWidth,10),markerHeight:MA(e.markerHeight,10),markerRotation:MA(e.markerRotation,0),shadowBlur:MA(e.shadowBlur,0),shadowOffsetX:MA(e.shadowOffsetX,0),shadowOffsetY:MA(e.shadowOffsetY,0)},n=t.markerType,i=BD(n),r=FD(n);return t.markerHorizontalAlignment=MA(e.markerHorizontalAlignment,i),t.markerVerticalAlignment=MA(e.markerVerticalAlignment,r),bI(e.markerOpacity)&&(bI(e.markerFillOpacity)&&(t.markerFillOpacity*=e.markerOpacity),bI(e.markerLineOpacity)&&(t.markerLineOpacity*=e.markerOpacity)),t},t}(yz),Rz=function(e){function t(t,n,i){var r;xI(t.markerWidth)&&(t.markerWidth=80),xI(t.markerHeight)&&(t.markerHeight=80),t=_I(t,(r=e.call(this,t,n,i)||this).translate());var a=r.style=r._defineStyle(t);return r._url=lA.gecko?[ER(a,a.markerWidth,a.markerHeight),a.markerWidth,a.markerHeight]:[ER(a),a.markerWidth,a.markerHeight],r}cA(t,e),t.test=function(e){return QD(e)};var n=t.prototype;return n._prepareContext=function(){},n._getImage=function(e){var t=this;if(e&&e.isResourceLoaded(this._url))return e.getImage(this._url);var n=this.painter,i=new Image;return i.onload=function(){var e=n.getLayer()&&n.getLayer().getRenderer();e&&e.setToRedraw()},i.onerror=function(n){n&&"undefined"!=typeof console&&console.warn(n),e.markErrorResource(t._url)},i.src=this._url[0],e&&e.addResource(this._url,i),i},t}(wz),Oz={lineWidth:1,polygonFill:"#fff",polygonOpacity:.5},Nz=[function(e){function t(t,n,i){var r;return(r=e.call(this,t,n,i)||this).style=n.getLayer().options.drawAltitude,r.style&&kI(r.style)||(r.style={lineWidth:2}),r.style.lineWidth||(r.style.lineWidth=0),r.dxdy=r._defineStyle({dx:t.textDx||t.markerDx,dy:t.textDy||t.markerDy}),r}cA(t,e),t.test=function(e,t){if(!t.getLayer())return!1;var n=t.getJSONType();return"Marker"===n||"LineString"===n};var n=t.prototype;return n.symbolize=function(e){if(this.geometry.getLayer().options.drawAltitude&&this.geometry.hasAltitude()){var t=this._getStyle();if(this._prepareContext(e),"LineString"===this.geometry.type){var n=this._getPaintParams(t.lineDx,t.lineDy,!1,!0);if(!n)return;var i=this.getPainter().getPaintParams(t.lineDx,t.lineDy,!0,!0,"_groundpt")[0];this._drawLineAltitude(e,n[0],i)}else{var r=this._getRenderContainerPoints(),a=this._getRenderContainerPoints(!0);if(!r||0===r.length)return;this._drawMarkerAltitude(e,r[0],a[0])}}},n.getDxDy=function(){var e=this.dxdy;return new xA(e.dx||0,e.dy||0)},n.get2DExtent=function(){return"LineString"===this.geometry.type?Sz.prototype.get2DExtent.apply(this):e.prototype.get2DExtent.call(this)},n.getPlacement=function(){return"point"},n._getPaintParams=function(e,t){return this.getPainter().getPaintParams(e||0,t||0,null,!0,"_altpt")},n._drawMarkerAltitude=function(e,t,n){var i=this._getStyle();this.prepareCanvas(e,i),oN.path(e,[t,n],i.lineOpacity,null,i.lineDasharray)},n._drawLineAltitude=function(e,t,n){var i=this._getStyle();if(t.length>0&&Array.isArray(t[0]))for(var r=0;r<t.length;r++)this._drawLine(e,t[r],n[r]);else this._drawLine(e,t,n);e.setLineDash&&Array.isArray(i.lineDasharray)&&e.setLineDash([])},n._drawLine=function(e,t,n){var i=this._getStyle();this.prepareCanvas(e,i);for(var r=0,a=t.length-1;r<a;r++)oN.polygon(e,[t[r],t[r+1],n[r+1],n[r]],i.lineOpacity,i.polygonOpacity,i.lineDasharray)},n._getStyle=function(){var e=this.geometry.getLayer().options.drawAltitude;return kI(e)||(e=Oz),e.lineWidth||(e.lineWidth=0,e.lineOpacity=0),e},t}(yz),Sz,wz,Rz,Az,Ez],Dz=new xA(0,0),zz=new qN,Lz=new qN,Bz=new qN,Fz=new qN,jz=new qN,Hz={},Vz={minx:1/0,miny:1/0,maxx:-1/0,maxy:-1/0},Uz=function(e){function t(t){var n;return(n=e.call(this)||this).geometry=t,n.symbolizers=n._createSymbolizers(),n._altAtGL=n._getGeometryAltitude(),n.bbox=[1/0,1/0,-1/0,-1/0],n._drawTime=0,n}cA(t,e);var n=t.prototype;return n._setDrawTime=function(e){return this._drawTime=e,this},n.getRenderBBOX=function(){var e=this.getLayer();if(e&&e._drawTime!==this._drawTime)return null;$O(this.bbox);for(var t=this.symbolizers.length-1;t>=0;t--){var n=this.symbolizers[t].bbox;nN(n)&&tN(this.bbox,n)}return nN(this.bbox)?this.bbox:null},n.getMap=function(){return this.geometry.getMap()},n.getLayer=function(){return this.geometry&&this.geometry.getLayer()},n._createSymbolizers=function(){var e=this.getSymbol(),t=[],n=Nz,i=e;Array.isArray(e)||(i=[e]);for(var r=i.length-1;r>=0;r--)for(var a=i[r],o=n.length-1;o>=0;o--)if(n[o].test(a,this.geometry)){var s=new n[o](a,this.geometry,this);s._index=r,t.push(s),s instanceof yz&&(this._hasPoint=!0)}if(!t.length&&console){var l=this.geometry.getId();console.warn("invalid symbol for geometry("+(this.geometry?this.geometry.getType()+(l?":"+l:""):"")+") to draw : "+JSON.stringify(e))}return this._debugSymbolizer=new _z(e,this.geometry,this),t},n.hasPoint=function(){return!!this._hasPoint},n.getRenderPoints=function(e){return this._verifyProjection(),this._renderPoints||(this._renderPoints={}),e||(e="center"),this._renderPoints[e]||(this._renderPoints[e]=this.geometry._getRenderPoints(e)),this._renderPoints[e]},n.getPaintParams=function(e,t,n,i,r){void 0===r&&(r="_pt");var a,o,s,l,u,c=this.getLayer()._getRenderer().mapStateCache,h=this.getMap();c&&!this._hitPoint?(a=c.resolution,o=c.pitch,s=c.bearing,l=c.glScale,u=c.containerExtent):(a=h.getResolution(),o=h.getPitch(),s=h.getBearing(),l=h.getGLScale(),u=h.getContainerExtent());var d=this.geometry,f=a,p=0!==o,m=0!==s,v=this._cachedParams,g=d._paintAsPath&&d._paintAsPath();if(g&&this._unsimpledParams&&f<=this._unsimpledParams._res)v=this._unsimpledParams;else if(!v||v._res!==a||this._pitched!==p&&d._redrawWhenPitch()||this._rotated!==m&&d._redrawWhenRotate()){if(!(v=d._getPaintParams()))return null;v._res=f,!d._simplified&&g&&(this._unsimpledParams||(this._unsimpledParams=v),f>this._unsimpledParams._res&&(this._unsimpledParams._res=f)),this._cachedParams=v}if(!v)return null;this._pitched=p,this._rotated=m;var y=l,_=[],x=this._pointContainerPoints(v[0],e,t,n,i||this._hitPoint&&!u.contains(this._hitPoint),null,r);if(!x)return null;_.push(x);for(var b=1,w=v.length;b<w;b++)bI(v[b])||v[b]instanceof AR?bI(v[b])?_.push(v[b]/y):_.push(v[b].multi(1/y)):_.push(v[b]);return _},n._pointContainerPoints=function(e,t,n,i,r,a,o){if(void 0===o&&(o="_pt"),this._aboveCamera())return null;var s,l,u,c=this.getLayer()._getRenderer(),h=c.mapStateCache,d=this.getMap(),f=this.geometry,p=this.containerOffset;h?(s=h.glRes,l=h.containerExtent):(s=d.getGLRes(),l=d.getContainerExtent());var m=this.getLayer().options.roundPoint,v=1/0,g=1/0,y=-1/0,_=-1/0,x=!r,b=c.layer.options.clipBBoxBufferSize||3,w=this.symbolizers;function k(e,i){void 0===e&&(e=[]),void 0===i&&(i=[]);for(var r=UA(e,o),a=0,u=(r=d._pointsAtResToContainerPoints(e,s,i,r)).length;a<u;a++){var c=r[a];c._sub(p),(t||n)&&c._add(t||0,n||0),m&&(c.x=Math.ceil(c.x),c.y=Math.ceil(c.y)),v=Math.min(c.x,v),g=Math.min(c.y,g),y=Math.max(c.x,y),_=Math.max(c.y,_)}if(x&&function(e){void 0===e&&(e=[]),Array.isArray(e)||(e=[e]);for(var t=e.length,n=0;n<t;n++){var i=e[n];if(i.style){var r=i.style,a=r.lineDasharray,o=r.lineWidth;if(o&&bI(o)&&o>0&&a&&Array.isArray(a)&&a.length)return!0}}return!1}(w)){if(jz.ymin=l.ymin,jz.ymin<b&&(jz.ymin=l.ymin-b),jz.xmin=l.xmin-b,jz.xmax=l.xmax+b,jz.ymax=l.ymax+b,f.getShell&&f.getHoles)return az(r,jz);var h=iz(r,jz,!1);if(h.length){var k=[];return h.forEach((function(e){for(var t=0,n=e.length;t<n;t++)k.push(e[t].point)})),k}}return r}var C=this.getAltitude();if(Array.isArray(e)){var S;!r&&this.geometry.options.enableClip?(S=this._clip(e,C)).inView&&(x=!1):S={points:e,altitude:C};var T=S.points;C=S.altitude,i&&(C=0);var E=C;u=[];for(var P=[],M=bI(C),I=0,A=T.length;I<A;I++){var R=T[I];if(Array.isArray(R)){if(M){var O=k(R,C);u.push(O);continue}for(var N=[],D=0,z=R.length;D<z;D++)Array.isArray(C)&&(E=C[I]?C[I][D]:0),N.push(E);var L=k(R,N);u.push(L)}else Array.isArray(C)&&(E="vertex-last"===a?C[C.length-1-I]:"line"===a?(C[I]+C[I+1])/2:C[I]),P.push(E)}P.length&&(u=k(T,P))}else e instanceof xA&&(i&&(C=0),u=d._pointAtResToContainerPoint(e,s,C)._sub(p),(t||n)&&u._add(t,n));return Vz.minx=v,Vz.miny=g,Vz.maxx=y,Vz.maxy=_,this._containerBbox=Vz,u},n._clip=function(e,t){if(bI(t)&&0!==t)return{points:e,altitude:t};if(Array.isArray(t)){for(var n=!1,i=0,r=t.length;i<r;i++)if(0!==t[i]){n=!0;break}if(n)return{points:e,altitude:t}}var a=this.getMap(),o=this.geometry,s=this.getSymbol().lineWidth;bI(s)||(s=4);var l,u,c,h=this.getLayer()._getRenderer().mapStateCache;h?(l=h._2DExtent,u=h.glExtent,c=h.pitch):(l=a._get2DExtent(),u=a._get2DExtentAtRes(a.getGLRes()),c=a.getPitch());var d=l._expand(s);if(c>0&&t){var f=a.cameraLookAt,p=a.cameraPosition;Dz.set(p.x,p.y),d=d._combine(Dz._add(IA(f[0]-p[0]),IA(f[1]-p[1])))}var m=e;if(this.get2DExtent(null,Fz).within(d))return{points:m,altitude:t,inView:!0};var v=u._expand(s*a._glScale);Bz.xmin=v.xmin,Bz.xmax=v.xmax,Bz.ymin=v.ymin,Bz.ymax=v.ymax;var g=o.options.smoothness;if(o.getShell&&this.geometry.getHoles&&!g){var y=v.ymin,_=v.ymax,x=Math.abs(v.xmax-v.xmin),b=Math.abs(_-y),w=Math.sqrt(x*x+b*b),k=(w-x)/2,C=(w-b)/2;if(Bz.xmin=v.xmin-k,Bz.xmax=v.xmax+k,Bz.ymin=v.ymin-C,Bz.ymax=v.ymax+C,Array.isArray(e[0])){m=[];for(var S=0;S<e.length;S++){var T=az(e[S],Bz);T.length&&m.push(T)}}else m=az(e,Bz)}else if("LineString"===o.getJSONType()&&!g){if(Array.isArray(e[0])){m=[];for(var E=0;E<e.length;E++)TA(m,iz(e[E],Bz,!1,!!g))}else m=iz(e,Bz,!1,!!g);return this._interpolateSegAlt(m,e,t)}return{points:m,altitude:t}},n._interpolateSegAlt=function(e,t,n){if(!Array.isArray(n)){var i=function(e){return e.point};return{points:e.map((function(e){return Array.isArray(e)?e.map(i):e.point})),altitude:n}}var r=function e(t,n,i){if(!Array.isArray(i))return t;for(var r=[],a=0,o=t.length;a<o;a++)if(Array.isArray(t[a]))r.push(e(t[a],n,i));else{var s=t[a];if(s.point.equals(n[s.index]))s.altitude=i[s.index],r.push(s);else{var l=void 0,u=void 0;0===s.index?(l=s.index,u=s.index+1):(l=s.index-1,u=s.index);var c=s.point.distanceTo(n[u]),h=c/(c+n[l].distanceTo(s.point)),d=AA(i[l],i[u],1-h);s.altitude=d,r.push(s)}}return r}(e,t,n);return n=[],{points:r.map((function(e){if(Array.isArray(e)){var t=[],i=e.map((function(e){return t.push(e.altitude),e.point}));return n.push(t),i}return n.push(e.altitude),e.point})),altitude:n}},n.getSymbol=function(){return this.geometry._getInternalSymbol()},n._resetSymbolizersBBOX=function(){for(var e=this.symbolizers.length-1;e>=0;e--)$O(this.symbolizers[e].bbox);return this},n.paint=function(e,t,n){if(this.symbolizers){var i=this.getLayer(),r=i._getRenderer();if(r&&(r.context||t)){var a=r.mapStateCache||{};if(this.geometry._isCheck||!e||e.intersects(this.get2DExtent(r.resources,zz))){var o=this.getMap();if(!this._aboveCamera()){this.containerOffset=n||a.offset||o._pointToContainerPoint(r.southWest)._add(0,-o.height),this._beforePaint();var s=t||r.context;s.isHitTesting||this._resetSymbolizersBBOX();for(var l=[s,r.resources],u=this.symbolizers.length-1;u>=0;u--)(s.shadowBlur||this.symbolizers[u].symbol.shadowBlur)&&this._prepareShadow(s,this.symbolizers[u].symbol),this.symbolizers[u].symbolize.apply(this.symbolizers[u],l);this._afterPaint(),this._painted=!0,(this.geometry.options.debug||i.options.debug)&&this._debugSymbolizer.symbolize.apply(this._debugSymbolizer,l)}}}}},n.getSprite=function(e,t){if(!this.geometry.isPoint)return null;if(this._spriting=!0,!this._sprite&&this.symbolizers.length>0){var n=new qN;this.symbolizers.forEach((function(t){var i=t.getFixedExtent(e);n._combine(i)}));var i,r=n.getMin().multi(-1),a=t||(this.getMap()?this.getMap().CanvasClass:null),o=oN.createCanvas(n.getWidth(),n.getHeight(),a);this._renderPoints&&(i=this._renderPoints);for(var s=o.getContext("2d"),l=[s,e],u=this.symbolizers.length-1;u>=0;u--){var c=this.symbolizers[u].getDxDy();this._renderPoints={center:[[r.add(c)]]},this._prepareShadow(s,this.symbolizers[u].symbol),this.symbolizers[u].symbolize.apply(this.symbolizers[u],l)}i&&(this._renderPoints=i),this._sprite={canvas:o,offset:n.getCenter()}}return this._spriting=!1,this._sprite},n.isSpriting=function(){return!!this._spriting},n.hitTest=function(e,t){if((!t||t<.5)&&(t=.5),this._hitPoint=e.sub(t,t),!fz){var n=this.getMap()?this.getMap().CanvasClass:null;fz=oN.createCanvas(1,1,n)}oN.setHitTesting(!0),fz.width=fz.height=2*t;var i=oN.getCanvas2DContext(fz);i.isHitTesting=!0;try{this.paint(null,i,this._hitPoint)}catch(q5){throw q5}finally{oN.setHitTesting(!1)}delete this._hitPoint;for(var r=i.getImageData(0,0,fz.width,fz.height).data,a=3,o=r.length;a<o;a+=4)if(r[a]>0)return!0;return!1},n.isHitTesting=function(){return!!this._hitPoint},n._prepareShadow=function(e,t){t.shadowBlur?(e.shadowBlur=this.isHitTesting()?0:t.shadowBlur,e.shadowColor=t.shadowColor||"#000",e.shadowOffsetX=t.shadowOffsetX||0,e.shadowOffsetY=t.shadowOffsetY||0):e.shadowBlur&&(e.shadowBlur=null,e.shadowColor=null,e.shadowOffsetX=null,e.shadowOffsetY=null)},n._eachSymbolizer=function(e,t){if(this.symbolizers){t||(t=this);for(var n=this.symbolizers.length-1;n>=0;n--)e.apply(t,[this.symbolizers[n]])}},n.get2DExtent=function(e,t){this._verifyProjection();var n=this.getMap();e=e||this.getLayer()._getRenderer().resources;var i=n.getZoom(),r=this._isDynamicSize();if(this._extent2D&&this._extent2D._zoom===i&&this._fixedExtent||(this._extent2D&&this._extent2D._zoom!==i&&delete this._extent2D,this.symbolizers&&(this._extent2D||(this._extent2D=this._computeExtent2D(new qN),this._extent2D._zoom=i),this._fixedExtent||(this._fixedExtent=this._computeFixedExtent(e,new qN)))),!this._extent2D)return r&&delete this._fixedExtent,null;var a=this._fixedExtent,o=a.xmin,s=a.ymin,l=a.xmax,u=a.ymax;return r&&delete this._fixedExtent,Lz.set(o,-u,l,-s),t?(t.set(this._extent2D.xmin,this._extent2D.ymin,this._extent2D.xmax,this._extent2D.ymax),t._add(Lz),t):this._extent2D.add(Lz)},n._computeExtent2D=function(e){for(var t=this.symbolizers.length-1;t>=0;t--)e._combine(this.symbolizers[t].get2DExtent());return e},n._computeFixedExtent=function(e,t){for(var n=this.symbolizers.length-1;n>=0;n--){var i=this.symbolizers[n];i.getFixedExtent&&t._combine(i.getFixedExtent(e))}return t},n._isDynamicSize=function(){for(var e=this.symbolizers.length-1;e>=0;e--)if(this.symbolizers[e].isDynamicSize())return!0;return!1},n._aboveCamera=function(){var e=this.getMinAltitude(),t=this.getMap(),n=t.getGLRes();e=t.altitudeToPoint(e,n)*IA(e);var i=t.getFrustumAltitude();return e&&i&&i<e},n.getFixedExtent=function(){var e=this.getMap().getZoom();return this._isDynamicSize()?this._computeFixedExtent(null,new qN):(this._extent2D&&this._extent2D._zoom===e||this.get2DExtent(null,Lz),this._fixedExtent)},n.setZIndex=function(e){this._eachSymbolizer((function(t){t.setZIndex(e)}))},n.show=function(){this._painted?(this.removeCache(),this._eachSymbolizer((function(e){e.show()}))):this.getLayer().isCanvasRender()||this.paint()},n.hide=function(){this._eachSymbolizer((function(e){e.hide()}))},n.repaint=function(){this._altAtGL=this._getGeometryAltitude(),this.removeCache();var e=this.getLayer();if(e){var t=e.getRenderer();t&&t.setToRedraw()&&t.setToRedraw()}},n.refreshSymbol=function(){this.removeCache(),this._removeSymbolizers(),this.symbolizers=this._createSymbolizers()},n.remove=function(){this.removeCache(),this._removeSymbolizers()},n._removeSymbolizers=function(){this._eachSymbolizer((function(e){delete e.painter,e.remove()})),delete this.symbolizers},n.removeCache=function(){delete this._renderPoints,delete this._paintParams,delete this._sprite,delete this._extent2D,delete this._fixedExtent,delete this._cachedParams,delete this._unsimpledParams},n.getAltitude=function(){return this.geometry._getAltitude()!==this._propAlt&&(this._altAtGL=this._getGeometryAltitude()),this._altAtGL?this._altAtGL:0},n.getMinAltitude=function(){return this.minAltitude?this.minAltitude:0},n.getMaxAltitude=function(){return this.maxAltitude?this.maxAltitude:0},n._getGeometryAltitude=function(){var e=this;if(!this.getMap())return 0;var t=this.geometry._getAltitude();return this._propAlt=t,t?this.geometry.getCenter()?Array.isArray(t)?(this.minAltitude=Number.MAX_VALUE,this.maxAltitude=Number.MIN_VALUE,t.map((function(t){var n=t;return n<e.minAltitude&&(e.minAltitude=n),n>e.maxAltitude&&(e.maxAltitude=n),n}))):(this.minAltitude=this.maxAltitude=t,this.minAltitude):0:(this.minAltitude=this.maxAltitude=0,0)},n._verifyProjection=function(){var e=this.geometry._getProjection()||Hz;this._projCode&&this._projCode!==e.code&&this.removeCache(),this._projCode=e.code},n._beforePaint=function(){},n._afterPaint=function(){},t}(pN),qz=new qN,Gz=function(e){function t(t,n){var i;return(i=e.call(this)||this).geometry=t,i.isMask=n,i.bbox=[1/0,1/0,-1/0,-1/0],i._drawTime=0,i}cA(t,e);var n=t.prototype;return n._setDrawTime=function(e){return this._drawTime=e,this._eachPainter((function(t){t._setDrawTime(e)})),this},n.getRenderBBOX=function(){var e=this,t=this.getLayer();return t&&t._drawTime!==this._drawTime?null:($O(this.bbox),this._eachPainter((function(t){var n=t.getRenderBBOX();nN(n)&&tN(e.bbox,n)})),nN(this.bbox)?this.bbox:null)},n._eachPainter=function(e){for(var t,n=this.geometry.getGeometries(),i=0,r=n.length;i<r&&(!(t=this.isMask?n[i]._getMaskPainter():n[i]._getPainter())||!t||!1!==e.call(this,t));i++);},n.getLayer=function(){return this.geometry&&this.geometry.getLayer()},n.paint=function(e){this.geometry&&this._eachPainter((function(t){t.paint(e)}))},n.get2DExtent=function(e,t){t&&t.set(null,null,null,null);var n=t||new qN;return this._eachPainter((function(t){n=n._combine(t.get2DExtent(e,qz))})),n},n.remove=function(){var e=arguments;this._eachPainter((function(t){t.remove.apply(t,e)}))},n.setZIndex=function(){var e=arguments;this._eachPainter((function(t){t.setZIndex.apply(t,e)}))},n.show=function(){var e=arguments;this._eachPainter((function(t){t.show.apply(t,e)}))},n.hide=function(){var e=arguments;this._eachPainter((function(t){t.hide.apply(t,e)}))},n.repaint=function(){var e=arguments;this._eachPainter((function(t){t.repaint.apply(t,e)}))},n.refreshSymbol=function(){var e=arguments;this._eachPainter((function(t){t.refreshSymbol.apply(t,e)}))},n.hasPoint=function(){var e=!1;return this._eachPainter((function(t){return!t.hasPoint()||(e=!0,!1)})),e},n.getMinAltitude=function(){var e=!0,t=0;return this._eachPainter((function(n){var i=n.getMinAltitude();(e||i<t)&&(e=!1,t=i)})),t},n.getMaxAltitude=function(){var e=0;return this._eachPainter((function(t){var n=t.getMaxAltitude();n>e&&(e=n)})),e},t}(pN),Wz={"EPSG:3857":{projection:"EPSG:3857",resolutions:function(){for(var e=[],t=12756274*Math.PI,n=0;n<23;n++)e[n]=t/(256*Math.pow(2,n));return e}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"EPSG:4326":{projection:"EPSG:4326",fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var e=[],t=0;t<23;t++)e[t]=180/(128*Math.pow(2,t));return e}()},BAIDU:{projection:"baidu",resolutions:function(){for(var e=Math.pow(2,18),t=[],n=0;n<23;n++)t[n]=e,e*=.5;return t}(),fullExtent:{top:33554432,left:-33554432,bottom:-33554432,right:33554432}},IDENTITY:{projection:"identity",resolutions:function(){for(var e=Math.pow(2,8),t=[],n=0;n<23;n++)t[n]=e,e*=.5;return t}(),fullExtent:{top:2e5,left:-2e5,bottom:-2e5,right:2e5}},"PRESET-VT-3857":{projection:"EPSG:3857",resolutions:function(){for(var e=[],t=6378137*Math.PI,n=0;n<23;n++)e[n]=t/(256*Math.pow(2,n));return e}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"PRESET-VT-4326":{projection:"EPSG:4326",fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var e=[],t=0;t<23;t++)e[t]=45/(128*Math.pow(2,t));return e}()}};Wz["EPSG:4490"]=Wz["EPSG:4326"],Wz["PRESET-3857-512"]=Wz["PRESET-VT-3857"],Wz["PRESET-4326-512"]=Wz["PRESET-VT-4326"];var Zz=function(){function e(e){void 0===e&&(e={}),this.options=e,this._initSpatialRef()}e.registerPreset=function(e,t){e=e&&e.toUpperCase(),Wz[e]&&console.warn("Spatial reference "+e+" already registered."),Wz[e]=t},e.getPreset=function(e){return Wz[e.toUpperCase()]},e.getAllPresets=function(){return Object.keys(Wz)},e.getProjectionInstance=function(e){if(!e)return null;if(CI(e)&&(e={code:e}),e.project)return e.locate||(e=_I({},e),_I(e,nD.getInstance("identity"===e.measure?"IDENTITY":"EPSG:4326"))),e;var t=(e.code+"").toLowerCase();for(var n in kD)if(EI(kD,n)){var i=kD[n].aliases||[];i.push(kD[n].code);for(var r=0;r<i.length;r++)if(i[r].toLowerCase()===t){if(kD[n].create){var a=kD[n].create(e);return a.code=i[r],a}if(kD[n].code===i[r])return kD[n];var o=_I({},kD[n]);return o.code=i[r],o}}return null},e.equals=function(e,t){if(CI(e)||CI(t))return e===t;if(!e&&!t)return!0;if(!e||!t)return!1;if(e.projection!==t.projection)return!1;var n=e.fullExtent,i=t.fullExtent;if(n&&!i||!n&&i)return!1;if(n&&i&&(n.top!==i.top||n.bottom!==i.bottom||n.left!==i.left||n.right!==i.right))return!1;var r=e.resolutions,a=t.resolutions;if(r&&a){if(r.length!==a.length)return!1;for(var o=0;o<r.length;o++)if(r[o]!==a[o])return!1}else if(r||a)return!1;return!0};var t=e.prototype;return t._initSpatialRef=function(){var t=this.options.projection;if(!(t=t?e.getProjectionInstance(t):wD))throw new Error("must provide a valid projection in map's spatial reference.");(t=_I({},WN,t)).measureLength||_I(t,nD.DEFAULT),this._projection=t;var n,i=this.options.resolutions;if(!i&&(t.code&&(n=Wz[t.code.toUpperCase()])&&(i=n.resolutions,this.isEPSG="IDENTITY"!==t.code),!i))throw new Error("must provide valid resolutions in map's spatial reference.");if(this._resolutions=i,this._pyramid=!0,this._pyramid)for(var r=0;r<i.length;r++)if(i[r]&&i[r-1]&&i[r-1]/i[r]!=2){this._pyramid=!1;break}var a=this.options.fullExtent;if(!a&&(t.code&&(n=Wz[t.code.toUpperCase()])&&(a=n.fullExtent),!a))throw new Error("must provide a valid fullExtent in map's spatial reference.");if(xI(a.left)?(this._fullExtent=new VN(a),a.left=a.xmin,a.right=a.xmax,a.top=a.ymax,a.bottom=a.ymin):this._fullExtent=new VN(new PN(a.left,a.top),new PN(a.right,a.bottom)),xI(a.top)||xI(a.bottom)||xI(a.left)||xI(a.right))throw new Error("must provide valid top/bottom/left/right in fullExtent.");_I(this._fullExtent,a),this._projection.fullExtent=a,this._transformation=new GN([a.right>=a.left?1:-1,a.top>=a.bottom?-1:1,0,0])},t.getResolutions=function(){return this._resolutions||[]},t.getResolution=function(e){var t=0|e;t<0?t=0:t>this._resolutions.length-1&&(t=this._resolutions.length-1);var n=this._resolutions[t];return t!==e&&e>0&&t<this._resolutions.length-1?n+(this._resolutions[t+1]-n)*(e-t):n},t.getProjection=function(){return this._projection},t.getFullExtent=function(){return this._fullExtent},t.getTransformation=function(){return this._transformation},t.getMinZoom=function(){for(var e=0;e<this._resolutions.length;e++)if(!xI(this._resolutions[e]))return e;return 0},t.getMaxZoom=function(){for(var e=this._resolutions.length-1;e>=0;e--)if(!xI(this._resolutions[e]))return e;return this._resolutions.length-1},t.getZoomDirection=function(){return IA(this._resolutions[this.getMinZoom()]-this._resolutions[this.getMaxZoom()])},t.toJSON=function(){return this.json||(this.json={resolutions:this._resolutions,fullExtent:{top:this._fullExtent.top,left:this._fullExtent.left,bottom:this._fullExtent.bottom,right:this._fullExtent.right},projection:this._projection.code}),this.json},t.isPyramid=function(){return this._pyramid},e}(),Xz=new xA(0,0),Kz=new qN,Yz={},Jz=function(e){function t(t){var n,i=_I({},t),r=i.symbol,a=i.properties,o=i.id;return delete i.symbol,delete i.id,delete i.properties,n=e.call(this,i)||this,r?n.setSymbol(r):n._genSizeSymbol(),a&&n.setProperties(a),xI(o)||n.setId(o),n}cA(t,e);var n=t.prototype;return n.getFirstCoordinate=function(){if("GeometryCollection"===this.type){var e=this.getGeometries();return e.length?e[0].getFirstCoordinate():null}var t=this.getCoordinates();if(!Array.isArray(t))return t;do{t=t[0]}while(Array.isArray(t)&&t.length>0);return t},n.getLastCoordinate=function(){if("GeometryCollection"===this.type){var e=this.getGeometries();return e.length?e[e.length-1].getLastCoordinate():null}var t=this.getCoordinates();if(!Array.isArray(t))return t;do{t=t[t.length-1]}while(Array.isArray(t)&&t.length>0);return t},n.addTo=function(e,t){return e.addGeometry(this,t),this},n.getLayer=function(){return this._layer?this._layer:null},n.getMap=function(){return this._layer?this._layer.getMap():null},n.getId=function(){return this._id},n.setId=function(e){var t=this.getId();return this._id=e,this._fireEvent("idchange",{old:t,new:e}),this},n.getProperties=function(){return this.properties?this.properties:this._getParent()?this._getParent().getProperties():null},n.setProperties=function(e){var t=this.properties;return this.properties=kI(e)?_I({},e):e,this._clearAltitudeCache(),this._repaint(),this._fireEvent("propertieschange",{old:t,new:e}),this},n.getType=function(){return this.type},n.getSymbol=function(){var e=this._symbol;return e?Array.isArray(e)?YR(e):_I({},e):null},n.setSymbol=function(e){return this._symbolUpdated=e,this._symbol=this._prepareSymbol(e),this.onSymbolChanged(),delete this._compiledSymbol,delete this._symbolHash,this},n.getSymbolHash=function(){return this._symbolHash||(this._symbolHash=XR(this._symbolUpdated)),this._symbolHash},n.updateSymbol=function(e){if(!e)return this;var t=this._getSymbol();if(Array.isArray(t)){if(!Array.isArray(e))throw new Error("Parameter of updateSymbol is not an array.");for(var n=0;n<e.length;n++)KD(e[n])&&delete this._textDesc,t[n]&&e[n]&&(t[n]=YR(t[n],e[n]))}else{if(Array.isArray(e))throw new Error("Geometry's symbol is not an array to update.");KD(t)&&delete this._textDesc,t=YR(t||this._getInternalSymbol(),e)}return this._eventSymbolProperties=e,delete this._compiledSymbol,this.setSymbol(t)},n.getTextContent=function(){var e=this._getInternalSymbol();if(Array.isArray(e)){for(var t=[],n=!1,i=0;i<e.length;i++)t[i]=jR(e[i]&&e[i].textName,this.getProperties()),xI(t[i])||(n=!0);return n?t:null}return jR(e&&e.textName,this.getProperties())},n.getTextDesc=function(){if(!this._textDesc){var e=this.getTextContent(),t=this._sizeSymbol,n=Array.isArray(e);this._textDesc=Array.isArray(t)?t.map((function(t,i){return HR(n?e[i]:"",t)})):HR(e,t)}return this._textDesc},n.getCenter=function(){return this._computeCenter(this._getMeasurer())},n.getExtent=function(){var e=this._getPrjExtent(),t=this._getProjection();if(e&&t){var n=t.unproject(new PN(e.xmin,e.ymin)),i=t.unproject(new PN(e.xmax,e.ymax));return new VN(n,i,t)}return this._computeExtent(this._getMeasurer())},n.getContainerExtent=function(e){var t=this.get2DExtent();if(!t||!t.isValid())return null;var n=this.getMap(),i=n.getGLRes(),r=this.getMinAltitude(),a=t.convertTo((function(e){return n._pointAtResToContainerPoint(e,i,r,Xz)}),e),o=this.getMaxAltitude();if(o!==r){var s=t.convertTo((function(e){return n._pointAtResToContainerPoint(e,i,o,Xz)}),Kz);a._combine(s)}var l=this.getLayer();if(l&&"LineString"===this.type&&o&&l.options.drawAltitude){var u=t.convertTo((function(e){return n._pointAtResToContainerPoint(e,i,0,Xz)}),Kz);a._combine(u)}if(a){var c=this._getFixedExtent();(function(e){return!!e&&e.xmax-e.xmin>0&&e.ymax-e.ymin>0})(c)&&a._add(c)}return this.options.smoothness&&a._expand(.15*a.getWidth()),a},n._getFixedExtent=function(){this._fixedExtent||(this._fixedExtent=new qN);var e=this._sizeSymbol,t=(e&&e.lineWidth||1)/2;return this._fixedExtent.set(-t,-t,t,t),this._fixedExtent._add([e&&e.lineDx||0,0]),this._fixedExtent._add([0,e&&e.lineDy||0]),this._fixedExtent},n.get2DExtent=function(){var e=this.getMap();if(!e)return null;if(this._extent2d)return this._extent2d;var t=this._getPrjExtent();if(!t||!t.isValid())return null;var n=t.getMin(),i=t.getMax(),r=e.getGLRes();return e._prjToPointAtRes(n,r,n),e._prjToPointAtRes(i,r,i),this._extent2d=new qN(n,i),this._extent2d.z=e.getZoom(),this._extent2d},n.getSize=function(){var e=this.getContainerExtent();return e?e.getSize():null},n.containsPoint=function(e,t){if(!this.getMap())throw new Error('The geometry is required to be added on a map to perform "containsPoint".');return e instanceof PN&&(e=this.getMap().coordToContainerPoint(e)),this._containsPoint(e,t)},n._containsPoint=function(e,t){var n=this._getPainter();return!!n&&(t=t||0,this._hitTestTolerance&&(t+=this._hitTestTolerance()),n.hitTest(e,t))},n.show=function(){if(this.options.visible=!0,this.getMap()){var e=this._getPainter();e&&e.show(),this._fireEvent("show")}return this},n.hide=function(){if(this.options.visible=!1,this.getMap()){this.onHide();var e=this._getPainter();e&&e.hide(),this._fireEvent("hide")}return this},n.isVisible=function(){if(!this.options.visible)return!1;var e=this._getInternalSymbol();if(!e)return!0;if(Array.isArray(e)){if(!e.length)return!0;for(var t=0,n=e.length;t<n;t++)if(xI(e[t].opacity)||e[t].opacity>0)return!0;return!1}return xI(e.opacity)||kI(e.opacity)||bI(e.opacity)&&e.opacity>0},n.getZIndex=function(){return this.options.zIndex||0},n.setZIndex=function(e){var t=this.options.zIndex;return this.options.zIndex=e,this._fireEvent("zindexchange",{old:t,new:e}),this},n.setZIndexSilently=function(e){return this.options.zIndex=e,this},n.bringToFront=function(){var e=this.getLayer();if(!e||!e.getGeoMaxZIndex)return this;var t=e.getGeoMaxZIndex();return this.setZIndex(t+1),this},n.bringToBack=function(){var e=this.getLayer();if(!e||!e.getGeoMinZIndex)return this;var t=e.getGeoMinZIndex();return this.setZIndex(t-1),this},n.translate=function(e,t){if(xI(e))return this;var n=new PN(e,t);if(0===n.x&&0===n.y)return this;var i=this.getCoordinates();if(this._silence=!0,i)if(Array.isArray(i)){var r=PA(i,(function(e){return e.add(n)}));this.setCoordinates(r)}else this.setCoordinates(i.add(n));return this._silence=!1,this._fireEvent("positionchange"),this},n.flash=function(e,t,n,i){return VA.call(this,e,t,n,i)},n.copy=function(){var e=this.toJSON(),n=t.fromJSON(e);return n.options.visible=!0,n},n.remove=function(){return this.getLayer()?(this._fireEvent("removestart"),this._unbind(),this._fireEvent("removeend"),this._fireEvent("remove"),this):this},n.toGeoJSONGeometry=function(){return this._exportGeoJSONGeometry()},n.toGeoJSON=function(e){e||(e={});var t={type:"Feature",geometry:null};if(xI(e.geometry)||e.geometry){var n=this._exportGeoJSONGeometry();t.geometry=n}var i,r=this.getId();return xI(r)||(t.id=r),(xI(e.properties)||e.properties)&&(i=this._exportProperties()),t.properties=i,t},n.toJSON=function(e){e||(e={});var t=this._toJSON(e);return _I(t,this._exportGraphicOptions(e)),t},n.getLength=function(){return this._computeGeodesicLength(this._getMeasurer())},n.getArea=function(){return this._computeGeodesicArea(this._getMeasurer())},n.rotate=function(e,t){if(!bI(e))return console.error("angle:"+e+" is not number"),this;if("GeometryCollection"===this.type)return this.getGeometries().forEach((function(n){return n.rotate(e,t)})),this;t=t?new PN(t):this.getCenter(),this._angle=e,this._pivot=t;var n=this._getMeasurer(),i=this.getCoordinates();if(!Array.isArray(i)){if(t.x===i.x&&t.y===i.y||this.getShell)this.onPositionChanged();else{var r=n._rotate(i,t,e);this.setCoordinates(r)}return this}return PA(i,(function(i){return n._rotate(i,t,e)})),this.setCoordinates(i),this},n._rotatePrjCoordinates=function(e){if(!e||0===this._angle||!this._pivot)return e;var t=this._getProjection();if(!t)return e;var n,i,r=0,a=Array.isArray(e),o=a?e:[e],s=[];if(this.getRotateOffsetAngle){r=this.getRotateOffsetAngle();var l=o[o.length-1];n=l.x,i=l.y}else{var u=[1/0,1/0,-1/0,-1/0];eN(o,u),n=(u[0]+u[2])/2,i=(u[1]+u[3])/2}for(var c=0,h=o.length;c<h;c++){var d=o[c],f=d.x,p=d.y,m=f-n,v=p-i,g=Math.sqrt(m*m+v*v),y=(eL(n,i,f,p)-this._angle+r)/180*Math.PI,_=Math.cos(y)*g,x=Math.sin(y)*g,b=new PN(n+_,i+x);s.push(b)}for(var w=t.project(this._pivot),k=n-w.x,C=i-w.y,S=0,T=s.length;S<T;S++){var E=s[S];E.x-=k,E.y-=C}return a?s:s[0]},n.isRotated=function(){return bI(this._angle)&&this._pivot},n._getConnectPoints=function(){return[this.getCenter()]},n._initOptions=function(e){var t=_I({},e),n=t.symbol,i=t.properties,r=t.id;delete t.symbol,delete t.id,delete t.properties,this.setOptions(t),n&&this.setSymbol(n),i&&this.setProperties(i),xI(r)||this.setId(r)},n._bindLayer=function(e){if(e!==this.getLayer()){if(this.getLayer())throw new Error("Geometry cannot be added to two or more layers at the same time.");this._layer=e,this._clearCache(),this._bindInfoWindow(),this._bindMenu()}},n._prepareSymbol=function(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(MR(this._checkAndCopySymbol(e[n])));return t}return e?MR(e=this._checkAndCopySymbol(e)):null},n._checkAndCopySymbol=function(e){var t={};for(var n in e)t[n]=vI[n]&&CI(e[n])?+e[n]:e[n];return t},n._getSymbol=function(){return this._symbol},n._setExternSymbol=function(e){return this._eventSymbolProperties=e,this._symbol||delete this._textDesc,this._externSymbol=this._prepareSymbol(e),this.onSymbolChanged(),this},n._getInternalSymbol=function(){return this._symbol?this._symbol:this._externSymbol?this._externSymbol:this.options.symbol?this.options.symbol:null},n._getPrjExtent=function(){var e=this._getProjection();return this._verifyProjection(),!this._extent&&e&&(this._extent=this._computePrjExtent(e)),this._extent},n._unbind=function(){var e=this.getLayer();e&&(this._animPlayer&&this._animPlayer.finish(),this._unbindMenu(),this._unbindInfoWindow(),this.isEditing()&&this.endEdit(),this._removePainter(),this.onRemove&&this.onRemove(),e.onRemoveGeometry&&e.onRemoveGeometry(this),delete this._layer,delete this._internalId,delete this._extent)},n._getInternalId=function(){return this._internalId},n._setInternalId=function(e){this._internalId=e},n._getMeasurer=function(){return this._getProjection()?this._getProjection():Zz.getProjectionInstance(this.options.defaultProjection)},n._getProjection=function(){var e=this.getMap();return e?e.getProjection():null},n._verifyProjection=function(){var e=this._getProjection();this._projCode&&e&&this._projCode!==e.code&&this._clearProjection(),this._projCode=e?e.code:this._projCode},n._getExternalResources=function(){return PR(this._getInternalSymbol())},n._getPainter=function(){if(this._painter)return this._painter;var e=this.getLayer();if(!this._painter&&e)if(-1!==dI.indexOf(this.type)){if(e.constructor.getCollectionPainterClass){var t=e.constructor.getCollectionPainterClass();t&&(this._painter=new t(this))}}else if(e.constructor.getPainterClass){var n=e.constructor.getPainterClass();n&&(this._painter=new n(this))}return this._painter},n._getMaskPainter=function(){return this._maskPainter||(this._maskPainter=this.getGeometries&&this.getGeometries()?new Gz(this,!0):new Uz(this)),this._maskPainter},n._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter},n._paint=function(e){if(this._painter){if(this._dirtyCoords){delete this._dirtyCoords;var t=this._getProjection();t&&(this._pcenter=t.project(this._coordinates),this._clearCache())}this._painter.paint(e)}},n._clearCache=function(){delete this._extent,delete this._extent2d,this._clearAltitudeCache()},n._clearProjection=function(){delete this._extent,delete this._extent2d},n._repaint=function(){this._painter&&this._painter.repaint()},n.onHide=function(){this.closeMenu(),this.closeInfoWindow()},n.onShapeChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("shapechange")},n.onPositionChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("positionchange")},n.onSymbolChanged=function(){this._painter&&this._painter.refreshSymbol();var e={};this._eventSymbolProperties?(e.properties=JSON.parse(JSON.stringify(this._eventSymbolProperties)),delete this._eventSymbolProperties):delete this._textDesc,this._genSizeSymbol(),this._fireEvent("symbolchange",e)},n._genSizeSymbol=function(){var e=this._getInternalSymbol();if(e)if(Array.isArray(e)){this._sizeSymbol=[];for(var t=!1,n=0;n<e.length;n++){var i=this._sizeSymbol[n]=this._getSizeSymbol(e[n]);!t&&i&&i._dynamic&&(t=!0)}this._sizeSymbol._dynamic=t}else this._sizeSymbol=this._getSizeSymbol(e);else delete this._sizeSymbol},n._getSizeSymbol=function(e){var t=TR({lineWidth:e.lineWidth,lineDx:e.lineDx,lineDy:e.lineDy},this);return(oR(e.lineWidth)||oR(e.lineDx)||oR(e.lineDy))&&(t._dynamic=!0),t},n._getCompiledSymbol=function(){return this._compiledSymbol||(this._compiledSymbol=TR(this._getInternalSymbol(),this)),this._compiledSymbol},n.onConfig=function(e){var t;e.properties&&(t=e.properties,delete e.properties);var n=!1;for(var i in e)if(e.hasOwnProperty(i)){var r=i.slice(0,5);if("arrow"===r||"smoot"===r){n=!0;break}}t?(this.setProperties(t),this._repaint()):n&&this._repaint()},n._setParent=function(e){e&&(this._parent=e)},n._getParent=function(){return this._parent},n._fireEvent=function(e,t){this._silence||(this.getLayer()&&this.getLayer()._onGeometryEvent&&(t||(t={}),t.type=e,t.target=this,this.getLayer()._onGeometryEvent(t)),this.fire(e,t))},n._toJSON=function(e){return{feature:this.toGeoJSON(e)}},n._exportGraphicOptions=function(e){var t={};return(xI(e.options)||e.options)&&(t.options=this.config()),(xI(e.symbol)||e.symbol)&&(t.symbol=this.getSymbol()),(xI(e.infoWindow)||e.infoWindow)&&this._infoWinOptions&&(t.infoWindow=this._infoWinOptions),t},n._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),t=PN.toNumberArrays(e);return{type:this.getType(),coordinates:t}},n._exportProperties=function(){var e=null,t=this.getProperties();return xI(t)||(e=kI(t)?_I({},t):t),e},n._hitTestTolerance=function(){return 0},n._getAltitude=function(){var e=this.getLayer();if(!e)return 0;var t=e.options,n=e.getAltitude?e.getAltitude():0,i=t.enableAltitude;if(!i)return n;var r=Qz(e),a=(this.properties||Yz)[r];if(xI(a)){var o=$z(this,n,i);return xI(o)?n:o}return Array.isArray(a)?a.map((function(e){return e+n})):a+n},n.getAltitude=function(){var e=Qz(this.getLayer()),t=(this.properties||Yz)[e];if(!xI(t))return t;var n=$z(this,0,!1);return xI(n)?0:n},n.hasAltitude=function(){return!!this._getAltitude()},n.setAltitude=function(e){if(!bI(e))return this;var t=this.getLayer(),n=Qz(t),i=this.properties||Yz,r=i[n];if(!xI(r))if(Array.isArray(r))for(var a=0,o=r.length;a<o;a++)r[a]=e;else i[n]=e;var s=this.getCoordinates?this.getCoordinates():null;if(!s)return this;if(function e(t,n){if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)e(t[i],n);else t.z=n}(s,e),t){var l=t.getRenderer();l&&l.gl?this.setCoordinates(s):l&&this._repaint()}return this._clearAltitudeCache(),this},n._genMinMaxAlt=function(){var e=this,t=this._getAltitude();Array.isArray(t)?(this._minAlt=Number.MAX_VALUE,this._maxAlt=Number.MIN_VALUE,t.forEach((function(t){var n=t;n<e._minAlt&&(e._minAlt=n),n>e._maxAlt&&(e._maxAlt=n)}))):this._minAlt=this._maxAlt=t},n.getMinAltitude=function(){return void 0===this._minAlt&&this._genMinMaxAlt(),this._minAlt?this._minAlt:0},n.getMaxAltitude=function(){return void 0===this._maxAlt&&this._genMinMaxAlt(),this._maxAlt?this._maxAlt:0},n._clearAltitudeCache=function(){return this._minAlt=void 0,this._maxAlt=void 0,this},t}(bN(dN(CN(pN))));function Qz(e){var t="altitude";return e&&(t=e.options.altitudeProperty),t}function $z(e,t,n){var i=e.getCoordinates?e.getCoordinates():null;if(i){var r=[];if(function e(t,n){if(!n.length)if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)e(t[i],n);else bI(t.z)&&n.push(t.z)}(i,r),r.length){var a=function e(t,n,i){if(Array.isArray(t)){for(var r=[],a=0,o=t.length;a<o;a++)r.push(e(t[a],n,i));return r}return bI(t.z)?i?n+t.z:t.z:i?n:0}(i,t,n);return e.getShell&&Array.isArray(a[0])?a[0][0]:a}}return null}function eL(e,t,n,i){return e===n?i>t?-90:90:(n-=e,i=-(i-=t),Math.atan2(i,n)/Math.PI*180)}Jz.mergeOptions({id:null,visible:!0,interactive:!0,editable:!0,cursor:null,antiMeridian:!1,defaultProjection:"EPSG:4326"});var tL={attribution:null,minZoom:null,maxZoom:null,visible:!0,opacity:1,globalCompositeOperation:null,renderer:"canvas",debugOutline:"#0f0",cssFilter:null,forceRenderOnMoving:!1,forceRenderOnZooming:!1,forceRenderOnRotating:!1,collision:!1,collisionScope:"layer",hitDetect:!lA.mobile},nL=function(e){function t(t,n){var i,r;return n&&(r=n.canvas,delete n.canvas),(i=e.call(this,n)||this)._canvas=r,i.setId(t),n&&(i.setZIndex(n.zIndex),n.mask&&i.setMask(Jz.fromJSON(n.mask))),i.proxyOptions(),i}cA(t,e);var n=t.prototype;return n.load=function(){if(!this.getMap())return this;if(this.onLoad()){this._initRenderer();var e=this.getZIndex();xI(e)||(this._renderer.setZIndex(e),this.isCanvasRender()||this._renderer.render()),this.onLoadEnd()}return this},n.getId=function(){return this._id},n.setId=function(e){var t=this._id;return xI(e)||(e+=""),this._id=e,this.fire("idchange",{old:t,new:e}),this},n.addTo=function(e){return e.addLayer(this),this},n.setZIndex=function(e){return this._zIndex=e,xI(e)?delete this.options.zIndex:this.options.zIndex=e,this.map&&this.map._sortLayersByZIndex(),this._renderer&&this._renderer.setZIndex(e),this.fire("setzindex",{zIndex:e}),this},n.getZIndex=function(){return this._zIndex||0},n.getMinZoom=function(){var e=this.getMap(),t=this.options.minZoom;return e?Math.max(e.getMinZoom(),t||0):t},n.getMaxZoom=function(){var e=this.getMap(),t=this.options.maxZoom;return e?Math.min(e.getMaxZoom(),xI(t)?1/0:t):t},n.getOpacity=function(){return this.options.opacity},n.setOpacity=function(e){return this.config("opacity",e),this.fire("setopacity",{opacity:e}),this},n.isCanvasRender=function(){var e=this._getRenderer();return e&&e instanceof ID},n.getMap=function(){return this.map?this.map:null},n.getProjection=function(){var e=this.getMap();return e?e.getProjection():null},n.bringToFront=function(){var e=this._getLayerList();if(!e.length)return this;var t=e[e.length-1];if(1===e.length||t===this)return this;var n=t.getZIndex();return this.setZIndex(n+1),this},n.bringToBack=function(){var e=this._getLayerList();if(!e.length)return this;var t=e[0];if(1===e.length||t===this)return this;var n=t.getZIndex();return this.setZIndex(n-1),this},n.show=function(){var e=this;if(!this.options.visible){this.options.visible=!0;var t=this.getRenderer();t&&t.show();var n=this.getMap();t&&n?n.once("renderend",(function(){e.fire("show")})):this.fire("show")}return this},n.hide=function(){var e=this;if(this.options.visible){this.options.visible=!1;var t=this.getRenderer();t&&t.hide();var n=this.getMap();t&&n?n.once("renderend",(function(){e.fire("hide")})):this.fire("hide")}return this},n.isVisible=function(){if(bI(this.options.opacity)&&this.options.opacity<=0)return!1;var e=this.getMap();if(e){var t=e.getZoom();if(!xI(this.options.maxZoom)&&this.options.maxZoom<t||!xI(this.options.minZoom)&&this.options.minZoom>t)return!1}return xI(this.options.visible)&&(this.options.visible=!0),this.options.visible},n.remove=function(){if(this.map){var e=this.map.getRenderer();this.map.removeLayer(this),e&&e.setToRedraw()}else this.fire("remove");return this},n.getMask=function(){return this._mask},n.setMask=function(e){if(!("Point"===e.type&&e._isVectorMarker()||"Polygon"===e.type||"MultiPolygon"===e.type))throw new Error("Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).");if(e._bindLayer(this),"Point"===e.type?e.updateSymbol({markerLineColor:"rgba(0, 0, 0, 0)",markerFillOpacity:0}):e.setSymbol({lineColor:"rgba(0, 0, 0, 0)",polygonOpacity:0}),this._mask=e,this.options.mask=e.toJSON(),!this.getMap()||this.getMap().isZooming())return this;var t=this._getRenderer();return t&&t.setToRedraw&&this._getRenderer().setToRedraw(),this},n.removeMask=function(){if(delete this._mask,delete this.options.mask,!this.getMap()||this.getMap().isZooming())return this;var e=this._getRenderer();return e&&e.setToRedraw&&this._getRenderer().setToRedraw(),this},n.onLoad=function(){return!0},n.onLoadEnd=function(){},n.isLoaded=function(){return!!this._loaded},n.getCollisionIndex=function(){if("layer"===this.options.collisionScope)return this._collisionIndex||(this._collisionIndex=new kN),this._collisionIndex;var e=this.getMap();return e?e.getCollisionIndex():null},n.clearCollisionIndex=function(){return"layer"===this.options.collisionScope&&this._collisionIndex&&this._collisionIndex.clear(),this},n.getRenderer=function(){return this._getRenderer()},n.onConfig=function(e){if(e&&Object.keys&&Object.keys(e).length>0&&xI(e.animation)){if(this._optionsHook&&SI(this._optionsHook)&&this._optionsHook(e),this._silentConfig)return;var t=this.getRenderer();t&&t.setToRedraw&&t.setToRedraw()}},n.onAdd=function(){},n.onRendererCreate=function(){},n.onCanvasCreate=function(){},n.onRemove=function(){},n._bindMap=function(e,t){e&&(this.map=e,xI(t)||this.setZIndex(t),this._switchEvents("on",this),this.onAdd(),this.fire("add"))},n._initRenderer=function(){var e=this.options.renderer;if(this.constructor.getRendererClass){var t=this.constructor.getRendererClass(e);if(!t)throw new Error("Invalid renderer for Layer("+this.getId()+"):"+e);this._renderer=new t(this),this._renderer.layer=this,this._renderer.setZIndex(this.getZIndex()),this._switchEvents("on",this._renderer),this._renderer.onAdd&&this._renderer.onAdd(),this.onRendererCreate(),this.fire("renderercreate",{renderer:this._renderer})}},n._doRemove=function(){this._loaded=!1,this._switchEvents("off",this),this.onRemove(),this._renderer&&(this._switchEvents("off",this._renderer),this._renderer.remove(),delete this._renderer),delete this.map,delete this._collisionIndex},n._switchEvents=function(e,t){t&&t.getEvents&&this.getMap()&&this.getMap()[e](t.getEvents(),t)},n._getRenderer=function(){return this._renderer},n._getLayerList=function(){return this.map?this.map._layers:[]},n._getMask2DExtent=function(){if(!this._mask||!this.getMap())return null;var e=this._mask._getMaskPainter();return e?e.get2DExtent():null},t}(bN(dN(CD(pN))));nL.mergeOptions(tL);var iL=nL.prototype.fire;nL.prototype.fire=function(e,t){return"layerload"===e&&(this._loaded=!0),this.map&&(t||(t={}),t.type=e,t.target=this,this.map._onLayerEvent(t)),iL.apply(this,arguments),["show","hide"].indexOf(e)>-1&&this.fire("visiblechange",Object.assign({},t,{visible:this.options.visible})),this};var rL,aL,oL,sL,lL,uL,cL,hL,dL,fL=new PN(0,0),pL=new xA(0,0),mL=["centerCross","fog","fogColor","debugSky"],vL={maxVisualPitch:70,maxPitch:80,centerCross:!1,zoomInCenter:!1,zoomOrigin:null,zoomAnimation:!AI,zoomAnimationDuration:330,panAnimation:!AI,panAnimationDuration:600,rotateAnimation:!AI,zoomable:!0,enableInfoWindow:!0,hitDetect:!lA.mobile,hitDetectLimit:5,fpsOnInteracting:25,layerCanvasLimitOnInteracting:-1,maxZoom:null,minZoom:null,maxExtent:null,fixCenterOnResize:!0,checkSize:!0,checkSizeInterval:1e3,renderer:"canvas",cascadePitches:[10,60],renderable:!0,clickTimeThreshold:280,stopRenderOnOffscreen:!0,preventWheelScroll:!0,preventTouch:!0,supportPluginEvent:!0,switchDragButton:!1,mousemoveThrottleTime:48},gL=function(e){function t(n,i){var r;if(!i)throw new Error("Invalid options when creating map.");if(!i.center)throw new Error("Invalid center when creating map.");var a=_I({},i),o=a.zoom;delete a.zoom;var s=new PN(a.center);delete a.center;var l=a.baseLayer;delete a.baseLayer;var u=a.layers;return delete a.layers,(r=e.call(this,a)||this).VERSION=t.VERSION,Object.defineProperty(vA(vA(r)),"id",{value:CA(),writable:!1}),r._loaded=!1,r._initContainer(n),r._panels={},r._baseLayer=null,r._layers=[],r._zoomLevel=o,r._center=s,r.setSpatialReference(a.spatialReference||a.view),r._mapViewPoint=new xA(0,0),r._initRenderer(),r._updateMapSize(r._getContainerDomSize()),l&&r.setBaseLayer(l),u&&r.addLayer(u),r.setMaxExtent(a.maxExtent),r._Load(),r.proxyOptions(),r.isMap=!0,r}cA(t,e),t.addOnLoadHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"==typeof e?e:function(){this[e].apply(this,t)};return this.prototype._onLoadHooks=this.prototype._onLoadHooks||[],this.prototype._onLoadHooks.push(n),this};var n=t.prototype;return n.isLoaded=function(){return!!this._loaded},n.getContainer=function(){return this._containerDOM},n.getSpatialReference=function(){return this._spatialReference},n.setSpatialReference=function(e){var t=this.options.spatialReference;return this._loaded&&Zz.equals(t,e)||this._updateSpatialReference(e,t),this},n._updateSpatialReference=function(e,t){CI(e)&&(e=Zz.getPreset(e)),e=_I({},e),this._center=this.getCenter(),this.options.spatialReference=e,this._spatialReference=new Zz(e);var n=this._spatialReference.getProjection();return this.options.spatialReference&&SI(this.options.spatialReference.projection)&&(this.options.spatialReference.projection=n.code),this._resetMapStatus(),yD.is(n.code)&&(this._originLng=n.centralMeridian,this._altitudeOriginDirty=!0),this._fireEvent("spatialreferencechange",{old:t,new:_I({},this.options.spatialReference)}),this},n.onConfig=function(e){var t=e.spatialReference||e.view;xI(t)||this._updateSpatialReference(t,null);for(var n=!1,i=0,r=mL.length;i<r;i++)if(!xI(e[mL[i]])){n=!0;break}if(!n)return this;var a=this.getRenderer();return a&&a.setToRedraw(),this},n.getProjection=function(){return this._spatialReference?this._spatialReference.getProjection():null},n.getFullExtent=function(){return this._spatialReference?this._spatialReference.getFullExtent():null},n.setCursor=function(e){return delete this._cursor,this._trySetCursor(e),this._cursor=e,this},n.resetCursor=function(){return this.setCursor(null)},n.getCenter=function(){if(!this._loaded||!this._prjCenter)return this._center;var e=this.getProjection().unproject(this._prjCenter);return e.x=Math.round(1e8*e.x)/1e8,e.y=Math.round(1e8*e.y)/1e8,this.centerAltitude&&(e.z=this.centerAltitude),e},n.setCenter=function(e,t){if(!e)return this;e=new PN(e),t&&(e=this._getCenterByPadding(e,this.getZoom(),t));var n=this.getProjection().project(e);return this._verifyExtent(n)?this._loaded?(this.onMoveStart(),this._setPrjCenter(n),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this):(this._center=e,this):this},n.getSize=function(){return xI(this.width)||xI(this.height)?this._getContainerDomSize():new AR(this.width,this.height)},n.getContainerExtent=function(){var e=this.height,t=this.getPitch(),n=this.options.maxVisualPitch;return n&&t>n&&(e=this._getVisualHeight(n)),new qN(0,this.height-e,this.width,this.height)},n._getVisualHeight=function(e){e=e||.01;var t=(90-this.getPitch())*Math.PI/180,n=this.getFov()*Math.PI/180;e*=Math.PI/180;var i=this.cameraCenterDistance/this.getGLScale(),r=Math.tan(n/2),a=i*r/(1/Math.tan(e)-r)/Math.sin(e),o=i*(Math.sin(t)*a/(i+Math.cos(t)*a));return this.height/2+o},n.getExtent=function(){return this._pointToExtent(this._get2DExtent())},n.getProjExtent=function(){var e=this._get2DExtent();return new VN(this._pointToPrj(e.getMin()),this._pointToPrj(e.getMax()))},n.getPrjExtent=function(){return this.getProjExtent()},n.getMaxExtent=function(){return this.options.maxExtent?new VN(this.options.maxExtent,this.getProjection()):null},n.setMaxExtent=function(e){if(e){var t=new VN(e,this.getProjection());this.options.maxExtent=t;var n=this.getProjection();this._prjMaxExtent=t.convertTo((function(e){return n.project(e)})),this._verifyExtent(this._getPrjCenter())||(this._loaded?this._panTo(this._prjMaxExtent.getCenter()):this._center=n.unproject(this._prjMaxExtent.getCenter()))}else delete this.options.maxExtent,delete this._prjMaxExtent;return this},n.getZoom=function(){return this._zoomLevel},n.getZoomForScale=function(e,t,n){var i=this.getZoom();if(xI(t)&&(t=i),1===e&&t===i)return i;var r=this._getResolution(t),a=this.getZoomFromRes(r/e);return n?a:this.getSpatialReference().getZoomDirection()<0?Math.ceil(a-1e-6):Math.floor(a+1e-6)},n.getZoomFromRes=function(e){var t=this._getResolutions(),n=this._getResolution(this.getMinZoom()),i=this._getResolution(this.getMaxZoom());if(n<=i){if(e<=n)return this.getMinZoom();if(e>=i)return this.getMaxZoom()}else{if(e>=n)return this.getMinZoom();if(e<=i)return this.getMaxZoom()}for(var r=t.length,a=0;a<r-1;a++)if(t[a]){var o=t[a+1]-t[a],s=e-t[a];if(IA(o)===IA(s)&&Math.abs(o)>=Math.abs(s))return a+s/o}return r-1},n.setZoom=function(e,t){return void 0===t&&(t={animation:!0}),isNaN(e)||xI(e)||(e=+e,this._loaded&&this.options.zoomAnimation&&t.animation?this._zoomAnimation(e):this._zoom(e)),this},n.getMaxZoom=function(){return xI(this.options.maxZoom)?this.getMaxNativeZoom():this.options.maxZoom},n.setMaxZoom=function(e){var t=this.getMaxNativeZoom();return e>t&&(e=t),null!==e&&e<this._zoomLevel&&(this.setZoom(e),e=+e),this.options.maxZoom=e,this},n.getMinZoom=function(){return xI(this.options.minZoom)?this._spatialReference.getMinZoom():this.options.minZoom},n.setMinZoom=function(e){if(null!==e){e=+e;var t=this._spatialReference.getMinZoom();e<t&&(e=t),e>this._zoomLevel&&this.setZoom(e)}return this.options.minZoom=e,this},n.getMaxNativeZoom=function(){var e=this.getSpatialReference();return e?e.getMaxZoom():null},n.getGLRes=function(){if(this._glRes)return this._glRes;var e=this.getSpatialReference().getFullExtent();return this._glRes=(e.right-e.left)/Math.pow(2,19),this._glRes},n.getGLScale=function(e){return xI(e)&&(e=this.getZoom()),this._getResolution(e)/this.getGLRes()},n.zoomIn=function(){return this.setZoom(this.getZoom()+1)},n.zoomOut=function(){return this.setZoom(this.getZoom()-1)},n.isZooming=function(){return!!this._zooming},n.isInteracting=function(){return this.isZooming()||this.isMoving()||this.isRotating()},n.setCenterAndZoom=function(e,t){return xI(t)||this._zoomLevel===t?this.setCenter(e):(this.setCenter(e),this.setZoom(t,{animation:!1})),this},n._getPaddingSize=function(e){return void 0===e&&(e={}),e.paddingLeft||e.paddingTop||e.paddingRight||e.paddingBottom?{width:(e.paddingLeft||0)+(e.paddingRight||0),height:(e.paddingTop||0)+(e.paddingBottom||0)}:null},n.getFitZoom=function(e,t,n){var i=this;if(!(e&&e instanceof VN))return this._zoomLevel;if(e.xmin===e.xmax&&e.ymin===e.ymax)return this.getMaxZoom();var r=this.getSize(),a=this._getPaddingSize(n);a&&(r={width:r.width-(a.width||0),height:r.height-(a.height||0)});var o=e.convertTo((function(e){return i.coordToPoint(e)})),s=o.getWidth(),l=o.getHeight(),u=r.width/s,c=r.height/l,h=this.getSpatialReference().getZoomDirection()<0?Math.max(u,c):Math.min(u,c);return this.getZoomForScale(h,null,t)},n.getView=function(){return{center:this.getCenter().toArray(),zoom:this.getZoom(),pitch:this.getPitch(),bearing:this.getBearing()}},n.setView=function(e){return e?(e.center&&this.setCenter(e.center),null===e.zoom||isNaN(+e.zoom)||this.setZoom(+e.zoom,{animation:!1}),null===e.pitch||isNaN(+e.pitch)||this.setPitch(+e.pitch),null===e.pitch||isNaN(+e.bearing)||this.setBearing(+e.bearing),this):this},n.getResolution=function(e){return this._getResolution(e)},n.getScale=function(e){var t=xI(e)?this.getZoom():e,n=this._getResolution(this.getMaxNativeZoom());return this._getResolution(t)/n},n._getCenterByPadding=function(e,t,n){void 0===n&&(n={});var i=this.coordinateToPoint(e,t),r=n.paddingLeft,a=void 0===r?0:r,o=n.paddingRight,s=void 0===o?0:o,l=n.paddingTop,u=void 0===l?0:l,c=n.paddingBottom,h=void 0===c?0:c,d=0,f=0;(a||s)&&(d=(s-a)/2),(u||h)&&(f=(u-h)/2);var p=new xA({x:i.x+d,y:i.y+f});return this.pointToCoordinate(p,t)},n.fitExtent=function(e,t,n,i){if(void 0===n&&(n={}),!e)return this;e=new VN(e,this.getProjection());var r=this.getFitZoom(e,n.isFraction||!1,n)+(t||0),a=e.getCenter();return this._getPaddingSize(n)&&(a=this._getCenterByPadding(a,r,n)),void 0===n.animation||n.animation?this._animateTo({center:a,zoom:r},{duration:n.duration||this.options.zoomAnimationDuration,easing:n.easing||"out"},i):this.setCenterAndZoom(a,r)},n.getBaseLayer=function(){return this._baseLayer},n.setBaseLayer=function(e){var t=!1;return this._baseLayer&&(t=!0,this._fireEvent("baselayerchangestart"),this._baseLayer.remove()),e?(this._baseLayer=e,e._bindMap(this,-1),this._baseLayer.on("layerload",(function(){this._fireEvent("baselayerload"),t&&(t=!1,this._fireEvent("baselayerchangeend"))}),this),this._loaded&&this._baseLayer.load(),this._fireEvent("setbaselayer"),this):(delete this._baseLayer,this._fireEvent("baselayerchangeend"),this._fireEvent("setbaselayer"),this)},n.removeBaseLayer=function(){return this._baseLayer&&(this._baseLayer.remove(),delete this._baseLayer,this._fireEvent("baselayerremove")),this},n.getLayers=function(e){return this._getLayers((function(t){return!(t===this._baseLayer||t.getId().indexOf("_maptalks__internal_layer_")>=0)&&(!e||e(t))}))},n.getLayer=function(e){if(!e)return null;var t=this._layerCache?this._layerCache[e]:null;if(t)return t;var n=this.getBaseLayer();return n&&n.getId()===e?n:null},n.addLayer=function(e){if(!e)return this;if(!Array.isArray(e))return e=Array.prototype.slice.call(arguments,0),this.addLayer(e);this._layerCache||(this._layerCache={});for(var t=this._layers,n=0,i=e.length;n<i;n++){var r=e[n],a=r.getId();if(xI(a))throw new Error("Invalid id for the layer: "+a);if(r.getMap()!==this){if(this._layerCache[a])throw new Error("Duplicate layer id in the map: "+a);this._layerCache[a]=r,r._bindMap(this),t.push(r),this._loaded&&r.load()}}return this._sortLayersByZIndex(),this._fireEvent("addlayer",{layers:e}),this},n.removeLayer=function(e){if(!e)return this;if(!Array.isArray(e))return this.removeLayer([e]);for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];if(r instanceof nL||(r=this.getLayer(r)),r){var a=r.getMap();if(a&&a===this){t.push(r),this._removeLayer(r,this._layers),this._loaded&&r._doRemove();var o=r.getId();this._layerCache&&delete this._layerCache[o]}}}if(t.length>0){var s=this.getRenderer();s&&s.setLayerCanvasUpdated(),this.once("frameend",(function(){t.forEach((function(e){e.fire("remove")}))}))}return this._fireEvent("removelayer",{layers:e}),this},n.sortLayers=function(e){if(!e||!Array.isArray(e))return this;for(var t=[],n=Number.MAX_VALUE,i=0,r=e.length;i<r;i++){var a=e[i];if(CI(e[i])&&(a=this.getLayer(a)),!(a instanceof nL&&a.getMap()&&a.getMap()===this))throw new Error("It must be a layer added to this map to order.");a.getZIndex()<n&&(n=a.getZIndex()),t.push(a)}for(var o=0,s=t.length;o<s;o++)t[o].setZIndex(n+o);return this},n.toDataURL=function(e){e||(e={});var t=e.mimeType;t||(t="image/png");var n=e.save,i=this._getRenderer();if(i&&i.toDataURL){var r=e.fileName;r||(r="export");var a=i.toDataURL(t,e.quality||.92);if(n&&a){var o;if("undefined"!=typeof Blob&&"undefined"!=typeof atob){var s=function(e,t){for(var n=atob(e),i=new ArrayBuffer(n.length),r=new Uint8Array(i),a=0;a<n.length;a++)r[a]=255&n.charCodeAt(a);return new Blob([i],{type:t})}(a.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,""),t);o=URL.createObjectURL(s)}else o=a;var l=document.createElement("a");l.download=r,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l)}return a}return null},n.coordToPoint=function(e,t,n){return this.coordinateToPoint(e,t,n)},n.coordToPointAtRes=function(e,t,n){return this.coordinateToPointAtRes(e,t,n)},n.pointToCoord=function(e,t,n){return this.pointToCoordinate(e,t,n)},n.pointAtResToCoord=function(e,t,n){return this.pointAtResToCoordinate(e,t,n)},n.coordToViewPoint=function(e,t,n){return this.coordinateToViewPoint(e,t,n)},n.viewPointToCoord=function(e,t){return this.viewPointToCoordinate(e,t)},n.coordToContainerPoint=function(e,t,n){return this.coordinateToContainerPoint(e,t,n)},n.containerPointToCoord=function(e,t){return this.containerPointToCoordinate(e,t)},n.containerPointToViewPoint=function(e,t){return t?t.set(e.x,e.y):t=e.copy(),t._sub(this.getViewPoint())},n.viewPointToContainerPoint=function(e,t){return t?t.set(e.x,e.y):t=e.copy(),t._add(this.getViewPoint())},n.checkSize=function(e){var t=yI()-this._initTime<1500&&0===this.width||0===this.height,n=this._getContainerDomSize(),i=this.height,r=this.width;if(!e&&n.width===r&&n.height===i)return this;fO(this._containerDOM);var a=this.getCenter();if(this.options.fixCenterOnResize)this._updateMapSize(n);else{var o=this._getVisualHeight(this.getPitch()),s=new xA(0,this.height-o),l=this._containerPointToPrj(s);this._updateMapSize(n);var u=this._getVisualHeight(this.getPitch()),c=new xA(0,this.height-u);this._setPrjCoordAtContainerPoint(l,c),this._mapViewCoord=this._getPrjCenter()}return(t||0===n.width||0===n.height||0===r||0===i)&&(this._eventSilence=!0,this.setCenter(a),delete this._eventSilence),this._fireEvent("resize"),this},n.locate=function(e,t,n){return this.getProjection()._locate(new PN(e),t,n)},n.getMainPanel=function(){return this._getRenderer().getMainPanel()},n.getPanels=function(){return this._panels},n.remove=function(){var e=this;if(this.isRemoved())return this;this._fireEvent("removestart"),this._removeDomEvents(),this._clearHandlers(),this.removeBaseLayer();for(var t=this.getLayers(),n=0;n<t.length;n++)t[n].remove();return this._getRenderer()&&this._getRenderer().remove(),this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&Array.prototype.slice.call(this._containerDOM.childNodes,0).filter((function(e){return"maptalks-wrapper"===e.className})).forEach((function(t){return e._containerDOM.removeChild(t)})),delete this._panels,delete this._containerDOM,delete this.renderer,this._fireEvent("removeend"),this._clearAllListeners(),this},n.isRemoved=function(){return!this._containerDOM},n.isMoving=function(){return!!this._moving},n.onMoveStart=function(e){this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer);var t=this._getPrjCenter();this._originCenter&&!this._verifyExtent(t)||(this._originCenter=t),this._moving=!0,this._trySetCursor("move"),this._fireEvent("movestart",this._parseEvent(e?e.domEvent:null,"movestart"))},n.onMoving=function(e){this._fireEvent("moving",this._parseEvent(e?e.domEvent:null,"moving"))},n.onMoveEnd=function(e){this._moving=!1,this._suppressRecenter||this._recenterOnTerrain(),this._trySetCursor("default"),this._fireEvent("moveend",e&&e.domEvent?this._parseEvent(e.domEvent,"moveend"):e),!this._verifyExtent(this._getPrjCenter())&&this._originCenter&&this._panTo(this._originCenter)},n.onDragRotateStart=function(e){this._dragRotating=!0,this._fireEvent("dragrotatestart",this._parseEvent(e?e.domEvent:null,"dragrotatestart"))},n.onDragRotating=function(e){this._fireEvent("dragrotating",this._parseEvent(e?e.domEvent:null,"dragrotating"))},n.onDragRotateEnd=function(e){this._dragRotating=!1,this._fireEvent("dragrotateend",this._parseEvent(e?e.domEvent:null,"dragrotateend"))},n.isDragRotating=function(){return!!this._dragRotating},n.isOffscreen=function(e,t){void 0===t&&(t=0);var n=this.width+t,i=this.height+t,r=e.xmin,a=e.ymin,o=e.xmax,s=e.ymax;return Array.isArray(e)&&(r=e[0],a=e[1],o=e[2],s=e[3]),o<t||r>=n||s<t||a>i},n.getRenderer=function(){return this._getRenderer()},n.getDevicePixelRatio=function(){return this.options.devicePixelRatio||lA.devicePixelRatio||1},n.setDevicePixelRatio=function(e){return bI(e)&&e>0&&e!==this.options.devicePixelRatio&&(this.options.devicePixelRatio=e,this.checkSize(!0)),this},n._initContainer=function(e){if(CI(e)){if(this._containerDOM=document.getElementById(e),!this._containerDOM)throw new Error("Invalid container when creating map: '"+e+"'")}else this._containerDOM=e,AI&&(this.CanvasClass=this._containerDOM.constructor);if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&"maptalks-wrapper"===this._containerDOM.childNodes[0].className)throw new Error("Container is already loaded with another map instance, use map.remove() to clear it.")},n._trySetCursor=function(e){return this._cursor||this._priorityCursor||(e||(e="default"),this._setCursorToPanel(e)),this},n._setPriorityCursor=function(e){if(e)this._priorityCursor=e,this._setCursorToPanel(e);else{var t=!1;this._priorityCursor&&(t=!0),delete this._priorityCursor,t&&this.setCursor(this._cursor)}return this},n._setCursorToPanel=function(e){var t=this.getMainPanel();t&&t.style&&t.style.cursor!==e&&(t.style.cursor=e)},n._removeLayer=function(e,t){if(e&&t){var n=t.indexOf(e);n>-1&&t.splice(n,1)}},n._sortLayersByZIndex=function(){if(this._layers){for(var e=0,t=this._layers.length;e<t;e++)this._layers[e]._order=e,this._layers[e].sortLayersByZIndex&&this._layers[e].sortLayersByZIndex();this._layers.sort((function(e,t){var n=e.getZIndex()-t.getZIndex();return 0===n?e._order-t._order:n}))}},n._fireEvent=function(e,t){this._eventSilence||("_"!==e[0]&&this.fire("_"+e,t),this.fire(e,t))},n._Load=function(){this._resetMapStatus(),this.options.pitch&&(this.setPitch(this.options.pitch),delete this.options.pitch),this.options.bearing&&(this.setBearing(this.options.bearing),delete this.options.bearing),delete this._glRes,this._loadAllLayers(),this._getRenderer().onLoad(),this._loaded=!0,this._callOnLoadHooks(),this._initTime=yI()},n._initRenderer=function(){var e=t.getRendererClass(this.options.renderer);this._renderer=new e(this),this._renderer.load()},n._getRenderer=function(){return this._renderer},n._loadAllLayers=function(){this._baseLayer&&this._baseLayer.load(),this._eachLayer((function(e){e&&e.load()}),this.getLayers())},n._getLayers=function(e){for(var t=this._baseLayer?[this._baseLayer].concat(this._layers):this._layers,n=[],i=0;i<t.length;i++)e&&!e.call(this,t[i])||n.push(t[i]);return n},n._eachLayer=function(e){if(!(arguments.length<2)){var t=Array.prototype.slice.call(arguments,1);t&&!Array.isArray(t)&&(t=[t]);for(var n=[],i=0,r=t.length;i<r;i++)n=n.concat(t[i]);for(var a=0,o=n.length;a<o;a++)e.call(e,n[a])}},n._onLayerEvent=function(e){e&&"idchange"===e.type&&(delete this._layerCache[e.old],this._layerCache[e.new]=e.target)},n._resetMapStatus=function(){var e=this.getMaxZoom(),t=this.getMinZoom(),n=this._spatialReference.getMaxZoom(),i=this._spatialReference.getMinZoom();(xI(e)||-1===e||e>n)&&this.setMaxZoom(n),(xI(t)||-1===t||t<i)&&this.setMinZoom(i),(e=this.getMaxZoom())<(t=this.getMinZoom())&&this.setMaxZoom(t),(xI(this._zoomLevel)||this._zoomLevel>e)&&(this._zoomLevel=e),this._zoomLevel<t&&(this._zoomLevel=t),delete this._prjCenter,delete this._glRes;var r=this.getProjection();this._prjCenter=r.project(this._center),this._calcMatrices();var a=this._getRenderer();a&&a.resetContainer()},n._getContainerDomSize=function(){if(!this._containerDOM)return null;var e,t,n=this._containerDOM;if(this._containerDomContentRect)return new AR(e=this._containerDomContentRect.width,t=this._containerDomContentRect.height);if(xI(n.width)||xI(n.height)){if(xI(n.clientWidth)||xI(n.clientHeight))throw new Error("can not get size of container");e=parseInt(n.clientWidth,0),t=parseInt(n.clientHeight,0)}else{e=n.width,t=n.height;var i=this.getDevicePixelRatio();1!==i&&n.layer&&(e/=i,t/=i)}return new AR(e,t)},n._updateMapSize=function(e){return this.width=e.width,this.height=e.height,this._getRenderer().updateMapSize(e),this._calcMatrices(),this},n._getPrjCenter=function(){return this._prjCenter},n._setPrjCenter=function(e){this._prjCenter=e,this.isInteracting()&&!this.isMoving()&&(this._mapViewCoord=e),this._calcMatrices()},n._setPrjCoordAtContainerPoint=function(e,t){if(!this.centerAltitude&&t.x===this.width/2&&t.y===this.height/2)return this;var n=this._containerPointToPoint(t)._sub(this._prjToPoint(this._getPrjCenter())),i=this._pointToPrj(this._prjToPoint(e).sub(n));return this._setPrjCenter(i),this},n._verifyExtent=function(e){if(!e)return!1;var t=this._prjMaxExtent;return!t||t.contains(e)},n._offsetCenterByPixel=function(e){var t=pL.set(this.width/2-e.x,this.height/2-e.y),n=this._containerPointToPrj(t,fL),i=pL.set(this.width/2,this.height/2);this._setPrjCoordAtContainerPoint(n,i)},n.offsetPlatform=function(e){return e?(this._getRenderer().offsetPlatform(e),this._mapViewCoord=this._getPrjCenter(),this._mapViewPoint=this._mapViewPoint.add(e),this):this._mapViewPoint},n.getViewPoint=function(){var e=this._getViewPointFrameOffset(),t=this.offsetPlatform();return e&&(t=t.add(e)),t},n._resetMapViewPoint=function(){this._mapViewPoint=new xA(0,0),this._mapViewCoord=this._getPrjCenter()},n._getResolution=function(e){return void 0!==e&&e!==this._zoomLevel||void 0===this._mapRes?(xI(e)&&(e=this._zoomLevel),this._spatialReference.getResolution(e)):this._mapRes},n._getResolutions=function(){return this._spatialReference.getResolutions()},n._prjToPoint=function(e,t,n){t=xI(t)?this.getZoom():t;var i=this._getResolution(t);return this._prjToPointAtRes(e,i,n)},n._prjToPointAtRes=function(e,t,n){return this._spatialReference.getTransformation().transform(e,t,n)},n._prjsToPointsAtRes=function(e,t,n){void 0===n&&(n=[]);for(var i=this._spatialReference.getTransformation(),r=[],a=0,o=e.length;a<o;a++){var s=i.transform(e[a],t,n[a]);r.push(s)}return r},n._pointToPrj=function(e,t,n){t=xI(t)?this.getZoom():t;var i=this._getResolution(t);return this._pointToPrjAtRes(e,i,n)},n._pointToPrjAtRes=function(e,t,n){return this._spatialReference.getTransformation().untransform(e,t,n)},n._pointToPoint=function(e,t,n){return xI(t)?(n?(n.x=e.x,n.y=e.y):n=e.copy(),n):this._pointAtResToPoint(e,this._getResolution(t),n)},n._pointAtResToPoint=function(e,t,n){return n?(n.x=e.x,n.y=e.y):n=e.copy(),n._multi(t/this._getResolution())},n._pointToPointAtRes=function(e,t,n){return n?(n.x=e.x,n.y=e.y):n=e.copy(),n._multi(this._getResolution()/t)},n._containerPointToPrj=function(e,t){return this._pointToPrj(this._containerPointToPoint(e,void 0,t),void 0,t)},n._callOnLoadHooks=function(){var e=t.prototype;if(e._onLoadHooks)for(var n=0,i=e._onLoadHooks.length;n<i;n++)e._onLoadHooks[n].call(this)},n._fixPrjOnWorldWide=function(e){var t=this.getProjection();if(t&&t.fullExtent&&e){var n=t.fullExtent||{},i=n.left,r=n.bottom,a=n.top,o=n.right;bI(i)&&(e.x=Math.max(i,e.x)),bI(o)&&(e.x=Math.min(o,e.x)),bI(r)&&(e.y=Math.max(r,e.y)),bI(a)&&(e.y=Math.min(a,e.y))}return this},t}(CN(dN(CD(pN))));gL.include({coordinateToPoint:function(e,t,n){var i=this._getResolution(t);return this.coordinateToPointAtRes(e,i,n)},coordinateToPointAtRes:(dL=new PN(0,0),function(e,t,n){var i=this.getProjection().project(e,dL);return this._prjToPointAtRes(i,t,n)}),pointToCoordinate:function(){var e=new PN(0,0);return function(t,n,i){var r=this._pointToPrj(t,n,e);return this.getProjection().unproject(r,i)}}(),pointAtResToCoordinate:function(){var e=new PN(0,0);return function(t,n,i){var r=this._pointToPrjAtRes(t,n,e);return this.getProjection().unproject(r,i)}}(),coordinateToViewPoint:function(){var e=new PN(0,0);return function(t,n,i){return this._prjToViewPoint(this.getProjection().project(t,e),n,i)}}(),viewPointToCoordinate:function(){var e=new PN(0,0);return function(t,n){return this.getProjection().unproject(this._viewPointToPrj(t,e),n)}}(),coordinateToContainerPoint:function(e,t,n){var i=this._getResolution(t);return this.coordinateToContainerPointAtRes(e,i,n)},coordinateToContainerPointAtRes:function(){var e=new PN(0,0);return function(t,n,i){var r=this.getProjection().project(t,e);return this._prjToContainerPointAtRes(r,n,i)}}(),coordinatesToContainerPoints:function(e,t){var n=this._getResolution(t);return this.coordinatesToContainerPointsAtRes(e,n)},coordinatesToContainerPointsAtRes:function(e,t){for(var n=[],i=this._spatialReference.getTransformation(),r=t/this._getResolution(),a=this.getProjection(),o=new PN(0,0),s=this.isTransforming(),l=this._prjToPoint(this._getPrjCenter(),void 0,fL),u=0,c=e.length;u<c;u++){var h=a.project(e[u],o),d=i.transform(h,t);d=d._multi(r),this._toContainerPoint(d,s,e[u].z,l),n.push(d)}return n},containerPointToCoordinate:function(){var e=new PN(0,0);return function(t,n){var i=this._containerPointToPrj(t,e);return this.getProjection().unproject(i,n)}}(),containerToExtent:(cL=new xA(0,0),hL=new xA(0,0),function(e){var t=new qN(this._containerPointToPoint(e.getMin(cL),void 0,cL),this._containerPointToPoint(e.getMax(hL),void 0,hL));return this._pointToExtent(t)}),distanceToPixel:function(){var e=new xA(0,0),t=new xA(0,0);return function(n,i,r){var a=this.getProjection();if(!a)return null;var o=this.getScale()/this.getScale(r),s=this.getCenter(),l=a.locate(s,n,i),u=this.coordToContainerPoint(s,void 0,e),c=this.coordToContainerPoint(l,void 0,t);return c._sub(u)._multi(o)._abs(),new AR(c.x,c.y)}}(),distanceToPoint:function(e,t,n,i){var r=this._getResolution(n);return this.distanceToPointAtRes(e,t,r,i)},distanceToPointAtRes:function(){var e=new xA(0,0),t=new PN(0,0);return function(n,i,r,a,o){var s=this.getProjection();if(!s)return null;var l=a||this.getCenter(),u=s.locate(l,n,i,t),c=this.coordToPointAtRes(l,r,e),h=this.coordToPointAtRes(u,r,o);return h._sub(c)._abs(),h}}(),altitudeToPoint:(lL=new PN(0,40),uL=new xA(0,0),function(e,t,n){void 0===e&&(e=0),this._altitudeOriginDirty&&(lL.x=this._originLng,this._altitudeOriginDirty=!1);var i=this.distanceToPointAtRes(e,e,t,n||lL,uL);e<0&&i.x>0&&(i.x=-i.x);var r=this.options.heightFactor;return r&&1!==r&&(i.x*=r,i.y*=r),i.x}),pointAtResToAltitude:function(){var e=new PN(0,40);return function(t,n,i){return void 0===t&&(t=0),this.pointAtResToDistance(t,0,n,i||e)}}(),pixelToDistance:(rL=new PN(0,0),aL=new PN(0,0),oL=new PN(0,0),sL=new PN(0,0),function(e,t){var n=this.getProjection();if(!n)return null;var i=this.getFullExtent(),r=i.top>i.bottom?-1:1,a=rL.set(this.width/2,this.height/2),o=aL.set(this.width/2+e,this.height/2+r*t),s=this.containerPointToCoord(a,oL),l=this.containerPointToCoord(o,sL);return n.measureLength(s,l)}),pointToDistance:function(e,t,n){var i=this.getResolution(n);return this.pointAtResToDistance(e,t,i)},pointAtResToDistance:function(){var e=new xA(0,0),t=new PN(0,0),n=new PN(0,0),i=new PN(0,0);return function(r,a,o,s){var l=this.getProjection();if(!l)return null;var u=s?l.project(s,t):this._getPrjCenter(),c=this._prjToPointAtRes(u,o,e);c._add(r,a);var h=this.pointAtResToCoord(c,o,n),d=s||l.unproject(u,i);return l.measureLength(d,h)}}(),locateByPoint:function(){var e=new xA(0,0);return function(t,n,i){var r=this.coordToContainerPoint(t,void 0,e);return this.containerPointToCoord(r._add(n,i))}}(),_get2DExtent:function(e,t){var n;if(void 0!==e&&e!==this._zoomLevel||!this._mapExtent2D||(n=this._mapExtent2D),n)return t?(t.set(n.xmin,n.ymin,n.xmax,n.ymax),t):n.copy();var i=this._getResolution(e);return this._get2DExtentAtRes(i,t)},_get2DExtentAtRes:function(){var e=new xA(0,0);return function(t,n){var i=this;return t===this._mapGlRes&&this._mapGlExtent2D?this._mapGlExtent2D:this.getContainerExtent().convertTo((function(n){return i._containerPointToPointAtRes(n,t,e)}),n)}}(),_pointToExtent:function(){var e=new PN(0,0),t=new PN(0,0);return function(n){var i=n.getMin(),r=n.getMax(),a=this.getFullExtent(),o=!a||a.left<=a.right?[i.x,r.x]:[r.x,i.x],s=o[1],l=!a||a.top>a.bottom?[r.y,i.y]:[i.y,r.y],u=l[0],c=i.set(o[0],l[1]),h=r.set(s,u);return new VN(this.pointToCoord(c,void 0,e),this.pointToCoord(h,void 0,t),this.getProjection())}}(),_getViewPointFrameOffset:function(){var e=new xA(0,0);return function(){if(this.isZooming())return null;var t=this._getPrjCenter();return this._mapViewCoord&&!this._mapViewCoord.equals(t)?this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(t,void 0,e)):null}}(),_viewPointToPrj:function(){var e=new xA(0,0);return function(t,n){return this._containerPointToPrj(this.viewPointToContainerPoint(t,e),n)}}(),_prjToContainerPoint:function(e,t,n,i){var r=this._getResolution(t);return this._prjToContainerPointAtRes(e,r,n,i)},_prjToContainerPointAtRes:function(){var e=new xA(0,0);return function(t,n,i,r){return this._pointAtResToContainerPoint(this._prjToPointAtRes(t,n,e),n,r||0,i)}}(),_prjToViewPoint:function(){var e=new xA(0,0);return function(t,n,i){var r=this._prjToContainerPoint(t,void 0,e,i);return this.containerPointToViewPoint(r,n)}}(),_viewPointToPoint:function(){var e=new xA(0,0);return function(t,n,i){return this._containerPointToPoint(this.viewPointToContainerPoint(t,e),n,i)}}(),_pointToViewPoint:function(){var e=new PN(0,0);return function(t,n,i){return this._prjToViewPoint(this._pointToPrj(t,n,e),i)}}()}),gL.mergeOptions(vL);var yL=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){this.target&&this.target.on("_dblclick",this._onDoubleClick,this)},n.removeHooks=function(){this.target&&this.target.off("_dblclick",this._onDoubleClick,this)},n._onDoubleClick=function(e){var t=this.target;if(t.options.doubleClickZoom){var n=t.getZoom(),i=e.domEvent.shiftKey?Math.ceil(n)-1:Math.floor(n)+1;t._zoomAnimation(i,e.containerPoint)}},t}(fN);gL.mergeOptions({doubleClickZoom:!0}),gL.addOnLoadHook("addHandler","doubleClickZoom",yL);var _L=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){var e=this.target;e&&(this._dragHandler=new EN(e._panels.mapWrapper||e._containerDOM,{cancelOn:this._cancelOn.bind(this),rightclick:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this).on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this).enable())},n.removeHooks=function(){this._dragHandler.off("mousedown",this._onMouseDown,this).off("dragstart",this._onDragStart,this).off("dragging",this._onDragging,this).off("dragend",this._onDragEnd,this),this._dragHandler.remove(),delete this._dragHandler},n._cancelOn=function(e){return!(!this.target.isZooming()&&!this._ignore(e))},n._ignore=function(e){return!!e&&(e.domEvent&&(e=e.domEvent),this.target._ignoreEvent(e)||this.target._isEventOutMap(e))},n._onMouseDown=function(e){delete this.startDragTime,delete this._mode;var t=this.target.options.switchDragButton;t&&"touchstart"===e.domEvent.type||e.domEvent.button===(t?0:2)||e.domEvent.ctrlKey?(this.target.options.dragRotate||this.target.options.dragPitch)&&(this._mode="rotatePitch"):this.target.options.dragPan&&(this._mode="move"),this.target._stopAnim(this.target._mapAnimPlayer),cO(e.domEvent)},n._onDragStart=function(e){this.startDragTime=yI(),"move"===this._mode?this._moveStart(e):"rotatePitch"===this._mode&&this._rotateStart(e)},n._onDragging=function(e){this.target._isEventOutMap(e.domEvent)||("move"===this._mode?this._moving(e):"rotatePitch"===this._mode&&this._rotating(e))},n._onDragEnd=function(e){"move"===this._mode?this._moveEnd(e):"rotatePitch"===this._mode&&this._rotateEnd(e),delete this.startDragTime,delete this.startBearing},n._start=function(e){this.preX=e.mousePos.x,this.preY=e.mousePos.y,this.startX=this.preX,this.startY=this.preY,this._startPrjCenter=this.target._getPrjCenter().copy()},n._moveStart=function(e){this._start(e);var t=this.target;t.onMoveStart(e);var n=pO(t._getActualEvent(e.domEvent),t.getContainer());this.startPrjCoord=t._containerPointToPrj(n)},n._moving=function(e){if(this.startDragTime){var t=this.target,n=pO(t._getActualEvent(e.domEvent),t.getContainer());t._setPrjCoordAtContainerPoint(this.startPrjCoord,n),t.onMoving(e)}},n._moveEnd=function(e){if(this.startDragTime){var t="touchend"===e.domEvent.type,n=this.target,i=yI()-this.startDragTime,r=e.mousePos.x-this.startX,a=e.mousePos.y-this.startY,o=n._getPrjCenter(),s=o.sub(this._startPrjCenter);if(this._clear(),n.options.panAnimation&&!e.interupted&&n._verifyExtent(n._getPrjCenter())&&i<280&&Math.abs(a)+Math.abs(r)>5){i*=5;var l=o.add(s._multi(t?5:2.8));n._panTo(l,{duration:t?3*i:2*i,easing:"outExpo"})}else n.onMoveEnd(e)}},n._rotateStart=function(e){this._start(e),delete this._rotateMode,this.startBearing=this.target.getBearing(),this.target.onDragRotateStart(e),this._db=0},n._rotating=function(e){var t=this.target,n=e.mousePos.x,i=e.mousePos.y,r=t.getPitch(),a=t.getBearing(),o=Math.abs(n-this.preX),s=Math.abs(i-this.preY);if(this._rotateMode||(this._rotateMode=t.options.dragRotatePitch?"rotate_pitch":o>s?"rotate":o<s?"pitch":"rotate"),!("pitch"===this._rotateMode&&0===r&&s<10)){if(this._rotateMode.indexOf("rotate")>=0&&t.options.dragRotate){var l;l=t.options.dragPitch||o>s?-.15*(this.preX-n):n>t.width/2?.15*(this.preY-i):-.15*(this.preY-i);var u=t.getBearing()+l;this._db=this._db||0,this._db+=l,t._setBearing(u)}this._rotateMode.indexOf("pitch")>=0&&t.options.dragPitch&&t._setPitch(t.getPitch()+.15*(this.preY-i)),this.preX=n,this.preY=i,t.getBearing()===a&&t.getPitch()===r||t.onDragRotating(e)}},n._rotateEnd=function(e){var t=this.target,n=t.getBearing();this._clear();var i=yI()-this.startDragTime;if(t.onDragRotateEnd(e),t.options.rotateAnimation&&Math.abs(n-this.startBearing)>20&&("rotate"===this._rotateMode||"rotate_pitch"===this._rotateMode)&&!e.interupted&&i<400){var r=t.getBearing();t._animateTo({bearing:r+this._db/1.5},{easing:"outQuint",duration:1600})}},n._clear=function(){delete this.startPrjCoord,delete this.preX,delete this.preY,delete this.startX,delete this.startY},t}(fN);gL.mergeOptions({draggable:!0,dragPan:!0,dragRotatePitch:!0,dragRotate:!0,dragPitch:!0}),gL.addOnLoadHook("addHandler","draggable",_L);var xL="mousedown mouseup mousemove click dblclick contextmenu touchstart touchmove touchend mouseout",bL={mousemove:["mousemove","mouseover","mouseout","mouseenter"],touchend:["touchend","click"]},wL=function(e){return e&&e.getLayer&&e.on&&e.fire},kL=function(e){return e._getInternalId?e._getInternalId():e.getId?e.getId():null},CL=function(e,t,n){if(e._onEvent)return e._onEvent(t,n);var i=e.getLayer();return i&&i.fireGeoEvent?i.fireGeoEvent(e,t,n):null},SL=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){var e=this.target;bO(e._panels.allLayers||e._containerDOM,xL,this._identifyGeometryEvents,this)},n.removeHooks=function(){var e=this.target;wO(e._panels.allLayers||e._containerDOM,xL,this._identifyGeometryEvents,this)},n._identifyGeometryEvents=function(e,t){var n=this.target;if(!n.isInteracting()&&!n._ignoreEvent(e)){var i=null,r=t||e.type;if(kO(r)&&!lA.isTest&&CO(this,n.options.mousemoveThrottleTime))hO(e);else{var a="mousedown"===r||"touchstart"===r&&e.touches&&1===e.touches.length;if(a)this._mouseDownTime=yI();else if(("click"===r||"touchend"===r)&&this._mouseDownTime){var o=this._mouseDownTime;if(delete this._mouseDownTime,yI()-o>300){if("click"===r)return}else"touchend"===r&&(i="click")}var s=e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e;if(s){var l=pO(s,n._containerDOM);"touchstart"===r&&n.options.preventTouch&&cO(e);for(var u=null,c=this.target.getRenderer().getTopElements(),h=a&&2!==e.button,d=0;d<c.length;d++)if(c[d].hitTest(l)){var f=c[d].options.cursor;if(f&&(u=f),h||c[d].events&&c[d].events.indexOf(r)>=0){var p={target:n,type:r,domEvent:e,containerPoint:l};if(h)return n._setPriorityCursor(u),void c[d].mousedown(p);c[d].onEvent(p)}}var m=n._getLayers((function(e){return!(!e.identify||!e.options.geometryEvents)}));if(m.length){var v={includeInternals:!0,filter:function(t){if(t instanceof Jz){var n=t._getEventTypeToFire(e);return"mousemove"===r?(!u&&t.options.cursor&&(u=t.options.cursor),!0):!(!t.listens(n)&&!t.listens(i))}return!!wL(t)},count:1,onlyVisible:n.options.onlyVisibleGeometryEvents,containerPoint:l,layers:m,eventTypes:bL[r]||[r],domEvent:e},g=(function(t){var a=this,o=!0,s=function(){return a._prevOverGeos&&a._prevOverGeos.geos||[]},l=function(t,n){if(void 0===t&&(t=[]),void 0===n&&(n={}),t&&t.length>0)for(var i=t.length-1;i>=0;i--){var r=t[i];wL(r)&&(n[kL(t[i])]||(o=CL(r,e,"mouseout")))}};if("mouseout"===r){var c=s();this._prevOverGeos={geos:[],geomap:{}},l(c,{})}else if("mousemove"===r){var h={};if(t.length>0)for(var d=t.length-1;d>=0;d--){var f=t[d];if(wL(f)){var p=kL(f);h[p]=f,CL(f,e),this._prevOverGeos&&this._prevOverGeos.geomap[p]||CL(f,e,"mouseenter"),o=CL(f,e,"mouseover")}}n._setPriorityCursor(u);var m=s();this._prevOverGeos={geos:t,geomap:h},l(m,h)}else{if(!t||!t.length)return;for(var v=t.length-1;v>=0;v--)if(wL(t[v])){o=CL(t[v],e),i&&CL(t[v],e,i);break}}!1===o&&hO(e)}).bind(this);kO(r)?this._queryIdentifyTimeout=n.getRenderer().callInNextFrame((function(){n.isInteracting()||n.identifyAtPoint(v,g)})):n.identifyAtPoint(v,g)}}}}},t}(fN);gL.mergeOptions({geometryEvents:!0,onlyVisibleGeometryEvents:!0}),gL.addOnLoadHook("addHandler","geometryEvents",SL);var TL=function(e){function t(t){var n;return(n=e.call(this,t)||this)._thisScrollZoom=n._scrollZoom.bind(vA(vA(n))),n._wheelZoomRate=1/450,n._defaultZoomRate=.01,n._delta=0,n}cA(t,e);var n=t.prototype;return n.addHooks=function(){sO(this.target._containerDOM,"wheel",this._onWheelScroll,this)},n.removeHooks=function(){lO(this.target._containerDOM,"wheel",this._onWheelScroll)},n._onWheelScroll=function(e){var t=this.target;if(t.options.preventWheelScroll&&(cO(e),hO(e)),t._ignoreEvent(e)||t._isEventOutMap(e)||!t.options.zoomable)return!1;var n=t._checkZoomOrigin(pO(e,t._containerDOM));return t.options.seamlessZoom?(this._zooming||(this._trackPadSuspect=0,this._ensureTrackpad=!1),this._seamless(e,n)):this._interval(e,n)},n._seamless=function(e,t){var n=e.deltaMode===window.WheelEvent.DOM_DELTA_LINE?60*e.deltaY:e.deltaY;if(n%4.000244140625!=0&&(this._ensureTrackpad||(Math.abs(n)<60?this._trackPadSuspect++:this._trackPadSuspect=0,this._trackPadSuspect>=2&&(this._ensureTrackpad=!0)),this._ensureTrackpad&&(n*=14)),e.shiftKey&&n&&(n/=4),this._lastWheelEvent=e,this._delta-=n,!this._zooming&&this._delta){var i=this.target;this._zoomOrigin=t,i.onZoomStart(null,t)}this._start()},n._start=function(){this._delta&&(this._zooming=!0,this._active||(this.target.getRenderer().callInNextFrame(this._thisScrollZoom),this._active=!0))},n._scrollZoom=function(){var e=this;if(this._active=!1,this._delta){var t=Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,n=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==n&&(n=1/n);var i=this.target,r=i.getZoom(),a=i.getZoomForScale(n,r,!0);this._delta=0,i.onZooming(a,this._zoomOrigin),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout((function(){e._zooming=!1,delete e._timeout,i.onZoomEnd(i.getZoom(),e._zoomOrigin)}),210)}},n._interval=function(e,t){var n=this,i=this.target;if(this._zooming)return this._requesting++,!1;this._requesting=0;var r=(e.deltaY?-1*e.deltaY:e.wheelDelta?e.wheelDelta:e.detail)>0?1:-1;e.detail&&(r*=-1);var a=i.getZoom(),o=a+r;return(o=i._checkZoom(r>0?Math.ceil(o):Math.floor(o)))===a||(this._zooming=!0,this._delta||(i.onZoomStart(null,t),this._origin=t,this._delta=r,this._startZoom=i.getZoom()),i._animateTo({zoom:o-1*this._delta/2,around:this._origin},{continueOnViewChanged:!0,easing:"linear",duration:90,wheelZoom:!0},(function(t){"finished"===t.state.playState?n._requesting<1||Math.abs(o-n._startZoom)>2||o===i.getMaxZoom()||o===i.getMinZoom()?(i._animateTo({zoom:o,around:n._origin},{continueOnViewChanged:!0,duration:100},(function(e){"running"!==e.state.playState&&(delete n._zooming,delete n._requesting)})),delete n._startZoom,delete n._origin,delete n._delta,n._requesting=0):xI(n._requesting)||(delete n._zooming,n._onWheelScroll(e)):"running"!==t.state.playState&&(delete n._zooming,delete n._requesting)}))),!1},t}(fN);gL.mergeOptions({scrollWheelZoom:!0,seamlessZoom:!0}),gL.addOnLoadHook("addHandler","scrollWheelZoom",TL);var EL=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){sO(this.target.getContainer(),"touchstart",this._onTouchStart,this)},n.removeHooks=function(){lO(this.target.getContainer(),"touchstart",this._onTouchStart)},n._onTouchStart=function(e){var t=this.target;if(e.touches&&!(e.touches.length<2)){var n=t.getContainer(),i=pO(e.touches[0],n),r=pO(e.touches[1],n);this.preY=i.y,this._startP1=i,this._startP2=r,this._startDist=i.distanceTo(r),this._startVector=i.sub(r),this._startZoom=t.getZoom(),this._startBearing=t.getBearing(),wO(document,"touchmove",this._onTouchMove,this),wO(document,"touchend",this._onTouchEnd,this),sO(document,"touchmove",this._onTouchMove,this),sO(document,"touchend",this._onTouchEnd,this),t.options.preventTouch&&cO(e),t._fireEvent("touchactstart")}},n._onTouchMove=function(e){var t=this.target;if(e.touches&&!(e.touches.length<2)){var n=t.getContainer(),i=pO(e.touches[0],n),r=pO(e.touches[1],n),a=i.sub(this._startP1),o=r.sub(this._startP2),s=i.sub(r),l=i.distanceTo(r)/this._startDist,u=180*s.angleWith(this._startVector)/Math.PI,c=.4*((this.preY||i.y)-i.y);this.preY=i.y;var h={domEvent:e,mousePos:[i,r]};if(this.mode||(t.options.touchRotate&&Math.abs(u)>8?this.mode=t.options.touchZoomRotate?"rotate_zoom":"rotate":t.options.touchPitch&&a.y*o.y>0&&Math.abs(a.y)>10&&Math.abs(o.y)>10?this.mode="pitch":t.options.zoomable&&t.options.touchZoom&&Math.abs(1-l)>.15&&(this.mode=t.options.touchZoomRotate&&t.options.touchRotate?"rotate_zoom":"zoom"),this._startTouching(h)),"zoom"===this.mode||"rotate_zoom"===this.mode){this._scale=l;var d=t._getResolution(this._startZoom)/l,f=t.getZoomFromRes(d);t.onZooming(f,this._Origin)}"rotate"===this.mode||"rotate_zoom"===this.mode?(t._setBearing(this._startBearing+u),t.onDragRotating(h)):"pitch"===this.mode&&(t._setPitch(t.getPitch()+c),t.onDragRotating(h)),t._fireEvent("touchactinging")}},n._startTouching=function(e){var t=this.target;if("zoom"===this.mode||"rotate_zoom"===this.mode){var n=t.getSize();this._Origin=new xA(n.width/2,n.height/2),t.onZoomStart(null,this._Origin)}"rotate"!==this.mode&&"pitch"!==this.mode&&"rotate_zoom"!==this.mode||t.onDragRotateStart(e)},n._onTouchEnd=function(e){delete this.preY;var t=this.target;if(wO(document,"touchmove",this._onTouchMove,this),wO(document,"touchend",this._onTouchEnd,this),"zoom"===this.mode||"rotate_zoom"===this.mode){var n=this._scale,i=t._getResolution(this._startZoom)/n,r=t.getZoomFromRes(i);t.onZoomEnd(r,this._Origin)}"pitch"!==this.mode&&"rotate"!==this.mode&&"rotate_zoom"!==this.mode||t.onDragRotateEnd({domEvent:e}),delete this.mode,t._fireEvent("touchactend")},t}(fN);gL.mergeOptions({touchGesture:!0,touchZoom:!0,touchPitch:!0,touchRotate:!0,touchZoomRotate:!1}),gL.addOnLoadHook("addHandler","touchGesture",EL);var PL="__anim_player",ML={outExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},outQuint:function(e){return 1-Math.pow(1-e,5)},in:function(e){return Math.pow(e,2)},out:function(e){return 1-ML.in(1-e)},inAndOut:function(e){return 3*e*e-2*e*e*e},linear:function(e){return e},upAndDown:function(e){return e<.5?ML.inAndOut(2*e):1-ML.inAndOut(2*(e-.5))}},IL=function(){function e(e,t){this.state=e,this.styles=t}var t,n;return t=e,(n=[{key:"playState",get:function(){return this.state.playState}},{key:"symbol",get:function(){return this.styles.symbol}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key))?r:String(r),i)}var r}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),AL=function(e,t,n,i){this._animation=e,this.options=t,this._onFrame=n,this.playState="idle",this.ready=!0,this.finished=!1,this.target=i},RL={speed:{slow:2e3,normal:1e3,fast:500},_resolveStyles:function(e){if(!e)return null;function t(e){if(!Array.isArray(e))return RL._resolveStyles(e);for(var t=[],n=[],i=[],r=0;r<e.length;r++){var a=RL._resolveStyles(e[r]);a&&(t.push(a[0]),n.push(a[1]),i.push(a[2]))}return t.length?[t,n,i]:null}function n(e){var t,n=e;Array.isArray(e)||(n=bI(e)?[0,e]:e instanceof xA||e instanceof PN?[new(t=e.constructor)(0,0),e]:[e,e]);var i=n[0],r=n[1];return bI(i)&&bI(r)?i===r?null:[i,r-i,r]:Array.isArray(i)&&bI(i[0])||i instanceof PN||i instanceof xA?(Array.isArray(i)?(i=new PN(i),r=new PN(r)):(i=new(t=i.constructor)(i),r=new t(r)),i.equals(r)?null:[i,r.sub(i),r]):[i,r,r]}var i,r={},a={},o={};for(var s in e)if(e.hasOwnProperty(s)){var l,u=e[s];if(!u)continue;if(Array.isArray(u)&&(xI(u[0])||xI(u[1])))continue;i=u,(l=!Array.isArray(i)&&i.constructor===Object||Array.isArray(i)&&i[0].constructor===Object?t(u):n(u))&&(a[s]=l[0],r[s]=l[1],o[s]=l[2])}return[a,r,o]},framing:function(e,t){t||(t={});var n,i,r,a=t.easing?ML[t.easing]:ML.linear;return a||(a=ML.linear),(e=RL._resolveStyles(e))&&(i=e[0],n=e[1],r=e[2]),function(e,t){var o,s;if(e<0)o={playState:"idle",delta:0},s=i;else if(e<t){var l=a(e/t);o={playState:"running",delta:l},s=function e(t,n,i){if(!n||!i)return null;var a={};for(var o in i)if(i.hasOwnProperty(o)){if(n[o]===r[o]){a[o]=n[o];continue}var s=n[o],l=i[o];if(bI(l))a[o]=s+t*l;else if(Array.isArray(l)){for(var u=[],c=0;c<l.length;c++)u.push(e(t,s[c],l[c]));a[o]=u}else a[o]=l.constructor===Object?e(t,s,l):s instanceof xA||s instanceof PN?s.add(l.multi(t)):l}return a}(l,i,n)}else o={playState:"finished",delta:1},s=r;return o.startStyles=i,o.destStyles=r,o.progress=e,o.remainingMs=t-e,new IL(o,s)}},_requestAnimFrame:function(e){this._frameQueue||(this._frameQueue=[]),this._frameQueue.push(e),this._a()},_a:function(){this._animationFrameId||(this._animationFrameId=gA(RL._frameFn))},_run:function(){if(this._frameQueue.length){var e=this._frameQueue;this._frameQueue=[];for(var t=0,n=e.length;t<n;t++)e[t]();this._frameQueue.length?this._animationFrameId=gA(RL._frameFn):delete this._animationFrameId}},animate:function(e,t,n,i){t||(t={});var r=RL.framing(e,t);return new AL(r,t,n,i)}};RL._frameFn=RL._run.bind(RL),_I(AL.prototype,{_prepare:function(){var e=this.options,t=e.speed||e.duration;CI(t)&&((t=RL.speed[t])||(t=+t)),t||(t=RL.speed.normal),this.duration=t,this._framer=e.framer||RL._requestAnimFrame.bind(RL)},play:function(){if("idle"!==this.playState&&"paused"!==this.playState||this.target&&this.target[PL])return this;this.target&&(this.target[PL]=1),"idle"===this.playState&&(this.currentTime=0,this._prepare());var e=yI();if(!this.startTime){var t=this.options;this.startTime=t.startTime?t.startTime:e}return this._playStartTime=Math.max(e,this.startTime),"paused"===this.playState&&(this._playStartTime-=this.currentTime),this.playState="running",this._run(),this},pause:function(){return"paused"===this.playState||(this.playState="paused",this._run()),this},cancel:function(){return"idle"===this.playState||(this.playState="idle",this.finished=!1,this._run()),this},finish:function(){return"finished"===this.playState||(this.playState="finished",this.finished=!0,this._run()),this},reverse:function(){},_run:function(){var e=this,t=this._onFrame,n=yI(),i=n-this._playStartTime;if(this.options.repeat&&i>=this.duration&&(this._playStartTime=n,i=0),"running"===this.playState){var r=this._animation(i,this.duration);this.playState=r.state.playState,"running"!==this.playState&&this.target&&delete this.target[PL],"idle"===this.playState?this.startTime>n&&setTimeout(this._run.bind(this),this.startTime-n):"running"===this.playState?this._framer((function(){"running"===e.playState&&(e.currentTime=i,t&&t(r),e._run())})):"finished"===this.playState&&(this.finished=!0,t&&t(r))}else if(this.target&&delete this.target[PL],t){"finished"===this.playState?i=this.duration:"idle"===this.playState&&(i=0);var a=this._animation(i,this.duration);a.state.playState=this.playState,t(a)}}});var OL=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.animateShow=function(e,t){var n=this;void 0===e&&(e={}),this._showPlayer&&this._showPlayer.finish(),SI(e)&&(t=e={});var i=this.getCoordinates();if(0===i.length)return this;this._animIdx=0,this._animLenSoFar=0,this.show();var r=this.getShell?this.getShell().concat(this.getShell()[0]):i,a=this._getProjection(),o=a.projectCoords(r,this.options.antiMeridian);this._prjAniShowCenter=this._getPrjExtent().getCenter(),this._aniShowCenter=a.unproject(this._prjAniShowCenter);var s=e.duration||1e3,l=e.easing||"out";this.setCoordinates([]);var u=0;o.length&&(o[0]._distance=0);for(var c=1;c<o.length;c++){var h=o[c].distanceTo(o[c-1]);o[c]._distance=h,u+=h}this._tempCoord=new PN(0,0),this._tempPrjCoord=new xA(0,0);var d=this._showPlayer=RL.animate({t:s},{duration:s,easing:l},(function(e){if(n.getMap()){var a=n._drawAnimShowFrame(e.styles.t,s,u,r,o);"finished"===e.state.playState&&(delete n._showPlayer,delete n._aniShowCenter,delete n._prjAniShowCenter,delete n._animIdx,delete n._animLenSoFar,delete n._animTailRatio,delete n._tempCoord,delete n._tempPrjCoord,n.setCoordinates(i)),t&&t(e,a)}else if("finished"!==d.playState&&(d.finish(),t)){var l=n.getCoordinates();t(e,l[l.length-1])}}),this);return d.play(),d},n._drawAnimShowFrame=function(e,t,n,i,r){if(0===e)return i[0];var a,o,s=e/t*n,l=0;for(a=this._animIdx+1,o=r.length;a<o&&!(this._animLenSoFar+(l=r[a]._distance)>s);a++)this._animLenSoFar+=l;if(this._animIdx=a-1,this._animIdx>=o-1)return this.setCoordinates(i),i[i.length-1];var u=this._animIdx,c=r[u],h=r[u+1],d=(s-this._animLenSoFar)/l;this._animTailRatio=d;var f=c.y+(h.y-c.y)*d;this._tempPrjCoord.x=c.x+(h.x-c.x)*d,this._tempPrjCoord.y=f;var p=this._tempPrjCoord,m=i[u],v=i[u+1],g=m.y+(v.y-m.y)*d;this._tempCoord.x=m.x+(v.x-m.x)*d,this._tempCoord.y=g;var y=this._tempCoord,_=!!this.getShell;if(!_&&this.options.smoothness>0){for(var x=[],b=[],w=0;w<=this._animIdx;w++)x.push(i[w]),b.push(r[w]);x.push(y,y),b.push(p,p),this.setCoordinates(x),this._setPrjCoordinates(b)}else{var k=i.slice(0,this._animIdx+1);k.push(y);var C=r.slice(0,this._animIdx+1);C.push(p),_?(this.setCoordinates([this._aniShowCenter].concat(k)),this._setPrjCoordinates([this._prjAniShowCenter].concat(C))):(this.setCoordinates(k),this._setPrjCoordinates(C))}return y},n._getCenterInExtent=function(e,t,n){var i=this.getExtent();if(!e.intersects(i))return null;var r=n(t,e);if(0===r.length)return null;var a=0,o=0,s=0;r.forEach((function(e){Array.isArray(e)?e.forEach((function(e){e.point&&(e=e.point),a+=e.x,o+=e.y,s++})):(e.point&&(e=e.point),a+=e.x,o+=e.y,s++)}));var l=new PN(a,o)._multi(1/s);return l.count=s,l},n._getPath2DPoints=function(e,t,n){if(!NA(e))return[];var i=this.getMap(),r=!t&&this._shouldSimplify(),a=this.options.simplifyTolerance*i._getResolution(),o=Array.isArray(e[0]);if(delete this._simplified,r&&!o){var s=e.length;e=rI()(e,a,!1),this._simplified=e.length<s}if(n||(n=i._getResolution()),Array.isArray(e)){var l=[];if(!Array.isArray(e[0]))return l=UA(e,"_glPt"),i._prjsToPointsAtRes(e,n,l);for(var u=[],c=0,h=e.length;c<h;c++){var d=e[c];l=UA(d,"_glPt");var f=i._prjsToPointsAtRes(d,n,l);u.push(f)}return u}return i._prjToPointAtRes(e,n)},n._shouldSimplify=function(){var e=this.getLayer();return e&&e.options.enableSimplify&&!e.options.enableAltitude&&this.options.enableSimplify&&!this._showPlayer},n._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},n._getPrjCoordinates=function(){return this._verifyProjection(),!this._prjCoords&&this._getProjection()&&(this._prjCoords=this._projectCoords(this._coordinates)),this._prjCoords},n._updateCache=function(){this._clearCache(),this._getProjection()&&this._prjCoords&&(this._coordinates=this._unprojectCoords(this._getPrjCoordinates()))},n._clearProjection=function(){this._prjCoords=null,e.prototype._clearProjection.call(this)},n._projectCoords=function(e){var t=this._getProjection();return t?t.projectCoords(e,this.options.antiMeridian):[]},n._unprojectCoords=function(e){var t=this._getProjection();return t?t.unprojectCoords(e):[]},n._computeCenter=function(){var e=this._coordinates;if(!NA(e))return null;for(var t=0,n=0,i=0,r=e.length,a=0;a<r;a++)e[a]&&bI(e[a].x)&&bI(e[a].y)&&(t+=e[a].x,n+=e[a].y,i++);return new PN(t/i,n/i)},n._computeExtent=function(){var e=this._coordinates;if(!NA(e))return null;var t=[e];return this.hasHoles&&this.hasHoles()&&t.push.apply(t,this.getHoles()),this._coords2Extent(t,this._getProjection())},n._computePrjExtent=function(){var e=[this._getPrjCoordinates()];return this.hasHoles&&this.hasHoles()&&e.push.apply(e,this._getPrjHoles()),this._coords2Extent(e)},n._get2DLength=function(){for(var e=this._getPath2DPoints(this._getPrjCoordinates(),!0),t=0,n=1,i=e.length;n<i;n++)t+=e[n].distanceTo(e[n-1]);return t},n._hitTestTolerance=function(){var t,n=this._getInternalSymbol();if(Array.isArray(n)){t=0;for(var i=0;i<n.length;i++)bI(n[i].lineWidth)&&n[i].lineWidth>t&&(t=n[i].lineWidth)}else t=n.lineWidth;return e.prototype._hitTestTolerance.call(this)+(bI(t)?t/2:1.5)},n._coords2Extent=function(e,t){if(!e||0===e.length||Array.isArray(e[0])&&0===e[0].length)return null;for(var n=new VN(t),i=0,r=e.length;i<r;i++)for(var a=0,o=e[i].length;a<o;a++)n._combine(e[i][a]);return n},t}(Jz);OL.mergeOptions({smoothness:0,enableClip:!0,enableSimplify:!0,simplifyTolerance:2,symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:1,opacity:1}});var NL=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).type="Polygon",t&&i.setCoordinates(t),i}cA(t,e);var n=t.prototype;return n.getOutline=function(){return this._getPainter()?new t(this.getExtent().toArray(),{symbol:{lineWidth:1,lineColor:"6b707b"}}):null},n.setCoordinates=function(e){if(!e)return this._coordinates=null,this._holes=null,this._projectRings(),this;var t=PN.toCoordinates(e),n=t.length;if(Array.isArray(t[0]))if(this._coordinates=this._trimRing(t[0]),n>1){for(var i=[],r=1;r<n;r++)t[r]&&i.push(this._trimRing(t[r]));this._holes=i}else this._holes=null;else this._coordinates=this._trimRing(t);return this._projectRings(),this},n.getCoordinates=function(){if(!this._coordinates)return[];for(var e=this.getHoles(),t=[this._copyAndCloseRing(this._coordinates)],n=0,i=e.length;n<i;n++)t.push(this._copyAndCloseRing(e[n]));return t},n.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getShell(),az)},n.getShell=function(){return this._coordinates||[]},n.getHoles=function(){return this._holes||[]},n.hasHoles=function(){return this.getHoles().length>0},n._projectRings=function(){this.getMap()?(this._prjCoords=this._projectCoords(this._coordinates),this._prjHoles=this._projectCoords(this._holes),this.onShapeChanged()):this.onShapeChanged()},n._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},n._cleanRing=function(e){for(var t=e.length-1;t>=0;t--)e[t]||e.splice(t,1)},n._checkRing=function(e){if(this._cleanRing(e),!e||!NA(e))return!1;var t=e[e.length-1],n=!0;return e[0].x===t.x&&e[0].y===t.y||(n=!1),n},n._trimRing=function(e){var t=this._checkRing(e);return NA(e)&&t&&e.splice(e.length-1,1),e},n._copyAndCloseRing=function(e){e=e.slice(0);var t=this._checkRing(e);return NA(e)&&!t?(e.push(e[0].copy()),e):e},n._getPrjShell=function(){return"Polygon"===this.getJSONType()?this._getPrjCoordinates():(this._verifyProjection(),this._getProjection()&&!this._prjShell&&(this._prjShell=this._projectCoords(this._getShell?this._getShell():this.getShell())),this._prjShell)},n._getPrjHoles=function(){var e=this._getProjection();return this._verifyProjection(),e&&!this._prjHoles&&(this._prjHoles=this._projectCoords(this.getHoles())),this._prjHoles},n._computeGeodesicLength=function(e){var t=this.getCoordinates();if(!NA(t))return 0;for(var n=0,i=0,r=t.length;i<r;i++)n+=e.measureLength(t[i]);return n},n._computeGeodesicArea=function(e){var t=this.getCoordinates();if(!NA(t))return 0;for(var n=e.measureArea(t[0]),i=1,r=t.length;i<r;i++)n-=e.measureArea(t[i]);return n},n._updateCache=function(){e.prototype._updateCache.call(this),this._prjHoles&&(this._holes=this._unprojectCoords(this._getPrjHoles()))},n._clearCache=function(){return delete this._prjShell,e.prototype._clearCache.call(this)},n._clearProjection=function(){this._prjHoles&&(this._prjHoles=null),this._prjShell&&(this._prjShell=null),e.prototype._clearProjection.call(this)},t}(OL);function DL(e){return function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.getCoordinates=function(){return this._coordinates},n.setCoordinates=function(e){var t=e instanceof PN?e:new PN(e);if(this._coordinates=t,!this.getMap())return this._dirtyCoords=!0,this.onPositionChanged(),this;var n=this._getProjection();return this._setPrjCoordinates(n.project(this._coordinates)),this},n._getCenter2DPoint=function(e){var t=this.getMap();if(!t)return null;var n=this._getPrjCoordinates();return n?(e||(e=t._getResolution()),t._prjToPointAtRes(n,e)):null},n._getPrjCoordinates=function(){var e=this._getProjection();return this._verifyProjection(),!this._pcenter&&e&&this._coordinates&&(this._pcenter=e.project(this._coordinates)),this._pcenter},n._setPrjCoordinates=function(e){this._pcenter=e,this.onPositionChanged()},n._updateCache=function(){this._clearCache();var e=this._getProjection();this._pcenter&&e&&(this._coordinates=e.unproject(this._pcenter))},n._clearProjection=function(){this._pcenter=null,e.prototype._clearProjection.call(this)},n._computeCenter=function(){return this._coordinates?this._coordinates.copy():null},t}(e)}NL.registerJSONType("Polygon");var zL=new qN,LL=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).type="Point",i.isPoint=!0,t&&i.setCoordinates(t),i}cA(t,e);var n=t.prototype;return n.getOutline=function(){var e=this.getCoordinates(),n=this.getContainerExtent(),i=this.getMap().coordToContainerPoint(e);return new t(e,{symbol:{markerType:"square",markerWidth:n.getWidth(),markerHeight:n.getHeight(),markerLineWidth:1,markerLineColor:"6b707b",markerFill:"rgba(0, 0, 0, 0)",markerDx:n.xmin-(i.x-n.getWidth()/2),markerDy:n.ymin-(i.y-n.getHeight()/2)}})},n.setSymbol=function(){var t;delete this._fixedExtent;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.prototype.setSymbol).call.apply(t,[this].concat(i))},n._getSizeSymbol=function(e){for(var t,n={},i=!1,r=!1,a=0;a<ez.length;a++){var o=e[ez[a]];xI(o)||(!i&&oR(o)&&(i=!0,r=!0),n[ez[a]]=o)}for(var s=0;s<tz.length;s++){var l=e[tz[s]];xI(l)||(!i&&oR(l)&&(i=!0),n[tz[s]]=l)}return i?(t=TR(n,this),r&&(t._dynamic=!0)):t=n,t},n._setExternSymbol=function(t){return this._symbol||delete this._fixedExtent,e.prototype._setExternSymbol.call(this,t)},n._isDynamicSize=function(){return this._sizeSymbol&&this._sizeSymbol._dynamic},n._getFixedExtent=function(){if(this._fixedExtent&&!this._isDynamicSize())return this._fixedExtent;this._fixedExtent=this._fixedExtent||new qN,this._fixedExtent.set(null,null,null,null);var e=this._sizeSymbol;if(!e)return this._fixedExtent;var t=this.getLayer()&&this.getLayer().getRenderer(),n=t&&t.resources,i=this.getTextDesc();if(Array.isArray(e)){zL.set(1/0,1/0,-1/0,-1/0);for(var r=0;r<e.length;r++)e[r]&&this._fixedExtent._combine(XD(zL,e[r],n,i&&i[r]))}else this._fixedExtent=XD(this._fixedExtent,e,n,i);return this._fixedExtent},n._isVectorMarker=function(){var e=this._getInternalSymbol();return!Array.isArray(e)&&JD(e)},n._canEdit=function(){var e=this._getInternalSymbol();return!Array.isArray(e)&&(JD(e)||QD(e)||YD(e))},n._containsPoint=function(t,n){var i=this.getContainerExtent();return n&&(i=i.expand(n)),!!i.contains(t)&&(!this.options.hitTestForEvent||e.prototype._containsPoint.call(this,t,n))},n._computeExtent=function(){return BL.call(this,"getCenter")},n._computePrjExtent=function(){return BL.call(this,"_getPrjCoordinates")},n._computeGeodesicLength=function(){return 0},n._computeGeodesicArea=function(){return 0},n._getSprite=function(e,t){return this._getPainter()?this._getPainter().getSprite(e,t):new Uz(this).getSprite(e,t)},t}(DL(Jz));function BL(e){var t=this[e]();return t?new VN(t,t,this._getProjection()):null}LL.mergeOptions({symbol:{markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},hitTestForEvent:!1,collision:!0}),LL.registerJSONType("Marker");var FL=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).type="LineString",t&&i.setCoordinates(t),i}cA(t,e);var n=t.prototype;return n.getOutline=function(){return NL.prototype.getOutline.call(this)},n.setCoordinates=function(e){return e?(this._coordinates=PN.toCoordinates(e),this.getMap()?this._setPrjCoordinates(this._projectCoords(this._coordinates)):this.onShapeChanged(),this):(this._coordinates=null,this._setPrjCoordinates(null),this)},n.getCoordinates=function(){return this._coordinates||[]},n.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getCoordinates(),iz)},n._computeGeodesicLength=function(e){return e.measureLength(this.getCoordinates())},n._computeGeodesicArea=function(){return 0},t}(OL);FL.mergeOptions({arrowStyle:null,arrowPlacement:"vertex-last"}),FL.registerJSONType("LineString");var jL=new qN,HL=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).type="GeometryCollection",i.setGeometries(t),i}cA(t,e);var n=t.prototype;return n.getContainerExtent=function(e){var t=e||new qN;return this.forEach((function(e){t._combine(e.getContainerExtent(jL))})),t},n.setGeometries=function(e){for(var t=this._checkGeometries(e||[]),n=this._getSymbol(),i=this.config(),r=this.getProperties(),a=t.length-1;a>=0;a--)t[a]._initOptions(i),t[a]._setParent(this),t[a]._setEventParent(this),n&&t[a].setSymbol(n),r&&t[a].setProperties(r);return this._geometries=t,this.getLayer()&&(this._bindGeometriesToLayer(),this.onShapeChanged()),this},n.getGeometries=function(){return this._geometries||[]},n.forEach=function(e,t){for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)n[i]&&(t?e.call(t,n[i],i):e(n[i],i));return this},n.filter=function(e,n){if(!e)return new t;var i=[],r=SI(e),a=r?e:dR(e);return this.forEach((function(e){var t=r?e:wR(e);(n?a.call(n,t):a(t))&&i.push(e)}),this),new t(i)},n.translate=function(e){if(!e)return this;if(this.isEmpty())return this;var t=arguments;return this.forEach((function(e){e&&e.translate&&e.translate.apply(e,t)})),this},n.isEmpty=function(){return!NA(this.getGeometries())},n.remove=function(){return this.forEach((function(e){e._unbind()})),Jz.prototype.remove.apply(this,arguments)},n.show=function(){return this.options.visible=!0,this.forEach((function(e){e.show()})),this},n.hide=function(){return this.options.visible=!1,this.forEach((function(e){e.hide()})),this},n.onConfig=function(e){this.forEach((function(t){t.config(e)}))},n.getSymbol=function(){var t=e.prototype.getSymbol.call(this);if(!t){var n=[],i=!1;this.forEach((function(e){e.getSymbol()&&!i&&(i=!0),n.push(e.getSymbol())})),i&&(t={children:n})}return t},n.setSymbol=function(e){var t=this;if(e&&e.children)this._symbol=null,this.forEach((function(n,i){n._eventSymbolProperties=t._eventSymbolProperties,n.setSymbol(e.children[i])}));else{var n=this._prepareSymbol(e);this._symbol=n,this.forEach((function(e){e._eventSymbolProperties=t._eventSymbolProperties,e.setSymbol(n)}))}return this.onSymbolChanged(),this},n._setExternSymbol=function(e){return e=this._prepareSymbol(e),this._externSymbol=e,this.forEach((function(t){t._setExternSymbol(e)})),this.onSymbolChanged(),this},n._bindLayer=function(){e.prototype._bindLayer.apply(this,arguments),this._bindGeometriesToLayer()},n._bindGeometriesToLayer=function(){var e=this.getLayer();this.forEach((function(t){t._bindLayer(e)}))},n._checkGeometries=function(e){for(var t=[],n=0,i=(e=Array.isArray(e)?e:[e]).length;n<i;n++){var r=e[n];r&&(this._checkGeo(r)?UL(r)?lA.isTest||console.error(r," is GeometryCollection sub class,it Cannot be placed in GeometryCollection"):t.push(r):console.error("The geometry added to collection is invalid. Index: "+n))}return t},n._checkGeo=function(e){return e instanceof Jz},n._updateCache=function(){this._clearCache(),this.isEmpty()||this.forEach((function(e){e&&e._updateCache&&e._updateCache()}))},n._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter,this.forEach((function(e){e._removePainter()}))},n._computeCenter=function(e){if(!e||this.isEmpty())return null;for(var t=0,n=0,i=0,r=this.getGeometries(),a=0,o=r.length;a<o;a++)if(r[a]){var s=r[a]._computeCenter(e);s&&(t+=s.x,n+=s.y,i++)}return 0===i?null:new PN(t/i,n/i)},n._containsPoint=function(e,t){if(this.isEmpty())return!1;delete this._pickGeometryIndex;for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)if(n[i]._containsPoint(e,t))return this._pickGeometryIndex=i,!0;return!1},n._hitTestTolerance=function(){for(var e=this.getGeometries(),t=0,n=0,i=e.length;n<i;n++){var r=e[n]._hitTestTolerance();t=Math.max(t,r)}return t},n._computeExtent=function(e){return VL.call(this,e,"_computeExtent")},n._computePrjExtent=function(e){return VL.call(this,e,"_computePrjExtent")},n._computeGeodesicLength=function(e){if(!e||this.isEmpty())return 0;for(var t=this.getGeometries(),n=0,i=0,r=t.length;i<r;i++)t[i]&&(n+=t[i]._computeGeodesicLength(e));return n},n._computeGeodesicArea=function(e){if(!e||this.isEmpty())return 0;for(var t=this.getGeometries(),n=0,i=0,r=t.length;i<r;i++)t[i]&&(n+=t[i]._computeGeodesicArea(e));return n},n._exportGeoJSONGeometry=function(){var e=[];if(!this.isEmpty())for(var t=this.getGeometries(),n=0,i=t.length;n<i;n++)t[n]&&e.push(t[n]._exportGeoJSONGeometry());return{type:"GeometryCollection",geometries:e}},n._toJSON=function(e){e=_I({},e);var t,n={type:"Feature",geometry:{type:"GeometryCollection",geometries:this.getGeometries().filter((function(e){return e&&e._toJSON})).map((function(e){var t=e._toJSON();return t.subType?t:e._exportGeoJSONGeometry()}))}},i=this.getId();return xI(i)||(n.id=i),(xI(e.properties)||e.properties)&&(t=this._exportProperties()),n.properties=t,e.feature=n,e},n._clearProjection=function(){if(!this.isEmpty())for(var e=this.getGeometries(),t=0,n=e.length;t<n;t++)e[t]&&e[t]._clearProjection()},n._getConnectPoints=function(){var e=this.getExtent();return[new PN(e.xmin,e.ymax),new PN(e.xmax,e.ymin),new PN(e.xmin,e.ymin),new PN(e.xmax,e.ymax)]},n._getExternalResources=function(){if(this.isEmpty())return[];for(var e,t,n=this.getGeometries(),i=[],r={},a=0,o=n.length;a<o;a++)if(n[a])for(var s=0,l=(e=PR(n[a]._getInternalSymbol())).length;s<l;s++)r[t=e[s].join()]||(i.push(e[s]),r[t]=1);return i},n.startEdit=function(e){var t=this;if(this.isEmpty())return this;e||(e={}),e.symbol&&(this._originalSymbol=this.getSymbol(),this.setSymbol(e.symbol)),this._draggbleBeforeEdit=this.options.draggable,this.config("draggable",!1);for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)n[i].startEdit(e);this._editing=!0;var a=this.getLayer();return a&&"canvas"===a.options.renderer&&this.hide(),setTimeout((function(){t.fire("editstart")}),1),this},n.endEdit=function(){if(this.isEmpty())return this;for(var e=this.getGeometries(),t=0,n=e.length;t<n;t++)e[t].endEdit();return this._originalSymbol&&(this.setSymbol(this._originalSymbol),delete this._originalSymbol),this._editing=!1,this.show(),this.config("draggable",this._draggbleBeforeEdit),this.fire("editend"),this},n.isEditing=function(){return!!this._editing},t}(Jz);function VL(e,t){if(this.isEmpty())return null;for(var n=new VN,i=this.getGeometries(),r=0,a=i.length;r<a;r++)if(i[r]){var o=i[r][t](e);o&&n._combine(o)}return n}function UL(e){return e instanceof HL}HL.registerJSONType("GeometryCollection");var qL=function(e){function t(t,n,i,r){var a;return(a=e.call(this,null,r)||this).GeometryType=t,a.type=n,a._initData(i),a}cA(t,e);var n=t.prototype;return n.getCoordinates=function(){for(var e=[],t=this.getGeometries(),n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.getShell&&"Polygon"!==r.getJSONType()?[r.getShell()]:r.getCoordinates())}return e},n.setCoordinates=function(e){for(var t=[],n=0,i=(e=e||[]).length;n<i;n++){var r=new this.GeometryType(e[n],this.config());t.push(r)}return this.setGeometries(t),this},n._initData=function(e){(e=e||[]).length&&(e[0]instanceof this.GeometryType?this.setGeometries(e):this.setCoordinates(e))},n._checkGeo=function(e){return e instanceof this.GeometryType},n._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),t=PN.toNumberArrays(e);return{type:this.getType(),coordinates:t}},n._toJSON=function(e){return{feature:this.toGeoJSON(e)}},t}(HL),GL=function(e){function t(t,n){return e.call(this,LL,"MultiPoint",t,n)||this}return cA(t,e),t.prototype.findClosest=function(e){if(!e)return null;var t=this.getCoordinates(),n=null,i=1/0;return t.forEach((function(t){var r,a,o,s,l=(o=(a=e).x-(r=t).x,s=a.y-r.y,Math.sqrt(o*o+s*s));l<i&&(n=t,i=l)})),n},t}(qL);GL.registerJSONType("MultiPoint");var WL=function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.prototype.getCenterInExtent=function(e){var t=this.getGeometries(),n=0,i=0,r=0;return t.forEach((function(t){var a=t.getCenterInExtent(e);a&&(n+=a.x*a.count,i+=a.y*a.count,r+=a.count)})),0===r?null:new PN(n,i)._multi(1/r)},t}(qL),ZL=function(e){function t(t,n){return e.call(this,FL,"MultiLineString",t,n)||this}return cA(t,e),t}(WL);ZL.registerJSONType("MultiLineString");var XL=function(e){function t(t,n){return e.call(this,NL,"MultiPolygon",t,n)||this}return cA(t,e),t}(WL);XL.registerJSONType("MultiPolygon");var KL={Marker:LL,LineString:FL,Polygon:NL,MultiPoint:GL,MultiLineString:ZL,MultiPolygon:XL},YL={toGeometry:function(e,t){if(CI(e)&&(e=SA(e)),Array.isArray(e)){for(var n=[],i=0,r=e.length;i<r;i++){var a=YL._convert(e[i],t);Array.isArray(a)?TA(n,a):n.push(a)}return n}return YL._convert(e,t)},toGeometryAsync:function(e,t,n){return void 0===n&&(n=2e3),CI(e)&&(e=SA(e)),new TO((function(i){var r,a=[];if(e&&(Array.isArray(e)||Array.isArray(e.features))){var o=bI(n)?Math.round(n):2e3,s=e.features||e,l=Math.ceil(s.length/o),u=1;(r={count:l,run:function(){var e=s.slice((u-1)*o,u*o),n=YL.toGeometry(e,t);return u++,n}},GO(),new TO((function(e,t){r?(SI(r)&&(r={count:1,run:r}),r.run?(xI(r.count)&&(r.count=1),r.count=Math.ceil(r.count),bI(r.count)?(r.results=[],FO.push(r),r.resolve=e):t(new Error("task.count is not number"))):t(new Error("task.run is null"))):t(new Error("task is null"))}))).then((function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];r&&(Array.isArray(r)?TA(a,r):a.push(r))}i(a)}))}else{var c=YL.toGeometry(e,t);i(c)}}))},_convert:function(e,t){if(!e||xI(e.type))return null;var n=e.type;if("Feature"===n){var i=YL._convert(e.geometry);return i?(i.setId(e.id),i.setProperties(e.properties),t&&t(i),i):null}if("FeatureCollection"===n){var r=e.features;return r?YL.toGeometry(r,t):null}if(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(n)>=0){var a=new KL["Point"===n?"Marker":n](e.coordinates);return t&&t(a),a}if("GeometryCollection"===n){var o=e.geometries;if(!NA(o)){var s=new HL;return t&&t(s),s}for(var l=[],u=o.length,c=0;c<u;c++)l.push(o[c].subType?Jz.getJSONClass(o[c].subType).fromJSON(o[c]):YL._convert(o[c]));var h=new HL(l);return t&&t(h),h}return null},_isGeoJSON:function(e){if(!e)return!1;if(e=e||{},Array.isArray(e)&&e.length)return YL.isGeoJSON(e[0]);var t=e.type;if(!t)return!1;if(-1===fI.indexOf(t))return!1;var n=e.features,i=e.geometries,r=e.geometry,a=e.coordinates;if(a&&Array.isArray(a))return!0;if(Array.isArray(i))return!0;if(Array.isArray(n))return!0;if(r){var o=r.coordinates;if(o&&Array.isArray(o))return!0}return!1}},JL=function(e){function t(t,n,i){var r;return r=e.call(this,null,i)||this,t&&r.setCoordinates(t),r._radius=n,r}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(e.coordinates,e.radius,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n.getRadius=function(){return this._radius},n.setRadius=function(e){return this._radius=e,this.onShapeChanged(),this},n.getShell=function(){for(var e,t,n,i=this._getMeasurer(),r=this.getCoordinates(),a=this.options.numberOfShellPoints,o=this.getRadius(),s=[],l=0,u=a-1;l<u;l++){e=360*l/u*Math.PI/180,t=o*Math.cos(e),n=o*Math.sin(e);var c=i.locate(r,t,n);c.z=r.z,s.push(c)}return s.push(s[0]),s},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._containsPoint=function(t,n){var i=this.getMap();if(i.getPitch())return e.prototype._containsPoint.call(this,t,n);var r=i._pointToContainerPoint(this._getCenter2DPoint()),a=this.getSize(),o=this._hitTestTolerance()+(n||0),s=r.add(a.width/2,a.height/2);return lz(t,r,s,o)},n._computePrjExtent=function(e){var t=this._getMinMax(e);if(!t)return null;var n=this._getPrjCoordinates(),i=t.map((function(t){return e.project(t)})),r=i[1].x-n.x,a=i[3].y-n.y;return new VN(n.add(i[0].x-n.x,i[2].y-n.y),n.add(r,a))},n._computeExtent=function(e){var t=this._getMinMax(e);return t?new VN(t[0].x,t[2].y,t[1].x,t[3].y,this._getProjection()):null},n._getMinMax=function(e){if(!e||!this._coordinates||xI(this._radius))return null;var t=this._radius;return[e.locate(this._coordinates,-t,0),e.locate(this._coordinates,t,0),e.locate(this._coordinates,0,t),e.locate(this._coordinates,0,-t)]},n._computeGeodesicLength=function(){return xI(this._radius)?0:2*Math.PI*this._radius},n._computeGeodesicArea=function(){return xI(this._radius)?0:Math.PI*Math.pow(this._radius,2)},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:PN.toNumberArrays([this.getShell()])}},n._toJSON=function(e){var t=this.getCenter(),n=_I({},e);n.geometry=!1;var i=this.toGeoJSON(n);return i.geometry={type:"Polygon"},{feature:i,subType:"Circle",coordinates:[t.x,t.y],radius:this.getRadius()}},t}(DL(NL));JL.mergeOptions({numberOfShellPoints:60}),JL.registerJSONType("Circle");var QL=function(e){function t(t,n,i,r){var a;return a=e.call(this,null,r)||this,t&&a.setCoordinates(t),a.width=n,a.height=i,a}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(e.coordinates,e.width,e.height,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n.getWidth=function(){return this.width},n.setWidth=function(e){return this.width=e,this.onShapeChanged(),this},n.getHeight=function(){return this.height},n.setHeight=function(e){return this.height=e,this.onShapeChanged(),this},n.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},n._getShell=function(){for(var e,t,n,i,r=this._getMeasurer(),a=this.getCoordinates(),o=this.options.numberOfShellPoints-1,s=this.getWidth(),l=this.getHeight(),u=[],c=Math.pow(s/2,2)*Math.pow(l/2,2),h=Math.pow(s/2,2),d=Math.pow(l/2,2),f=0;f<o;f++){t=(e=360*f/o)*Math.PI/180,n=Math.sqrt(c/(h*Math.pow(Math.tan(t),2)+d)),i=Math.sqrt(c/(d*Math.pow(1/Math.tan(t),2)+h)),e>90&&e<270&&(n*=-1),e>180&&e<360&&(i*=-1);var p=r.locate(a,n,i);p.z=a.z,u.push(p)}return u.push(u[0].copy()),u},n._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this);return this._rotatePrjCoordinates(t)},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._containsPoint=function(t,n){var i=this.getMap();if(i.isTransforming())return e.prototype._containsPoint.call(this,t,n);var r=i.getProjection(),a=this._hitTestTolerance()+(n||0),o=r.projectCoords([this._coordinates,i.locate(this._coordinates,this.getWidth()/2,this.getHeight()/2)],this.options.antiMeridian);return lz(t,i._prjToContainerPoint(o[0]),i._prjToContainerPoint(o[1]),a)},n._computePrjExtent=function(){return this.isRotated()?this._computeRotatedPrjExtent():JL.prototype._computePrjExtent.apply(this,arguments)},n._computeExtent=function(){return JL.prototype._computeExtent.apply(this,arguments)},n._getMinMax=function(e){if(!e||!this._coordinates||xI(this.width)||xI(this.height))return null;var t=this.getWidth(),n=this.getHeight();return[e.locate(this._coordinates,-t/2,0),e.locate(this._coordinates,t/2,0),e.locate(this._coordinates,0,-n/2),e.locate(this._coordinates,0,n/2)]},n._computeGeodesicLength=function(){return xI(this.width)||xI(this.height)?0:2*Math.PI*(this.width>this.height?this.width:this.height)/2-4*Math.abs(this.width-this.height)},n._computeGeodesicArea=function(){return xI(this.width)||xI(this.height)?0:Math.PI*this.width*this.height/4},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:PN.toNumberArrays([this.getShell()])}},n._toJSON=function(e){var t=_I({},e),n=this.getCenter();t.geometry=!1;var i=this.toGeoJSON(t);return i.geometry={type:"Polygon"},{feature:i,subType:"Ellipse",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},t}(DL(NL));QL.mergeOptions({numberOfShellPoints:81}),QL.registerJSONType("Ellipse");var $L=function(e){function t(t,n,i,r){var a;return a=e.call(this,null,r)||this,t&&a.setCoordinates(t),a._width=n,a._height=i,a}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(e.coordinates,e.width,e.height,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n.getCoordinates=function(){return this._coordinates},n.setCoordinates=function(e){if(this._coordinates=e instanceof PN?e:new PN(e),!this._coordinates||!this.getMap())return this.onPositionChanged(),this;var t=this._getProjection();return this._setPrjCoordinates(t.project(this._coordinates)),this},n.getWidth=function(){return this._width},n.setWidth=function(e){return this._width=e,this.onShapeChanged(),this},n.getHeight=function(){return this._height},n.setHeight=function(e){return this._height=e,this.onShapeChanged(),this},n.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},n._getShell=function(){var e=this._getMeasurer(),t=this._coordinates,n=this.getMap(),i=1,r=-1;if(n){var a=n.getFullExtent();a.left>a.right&&(i=-1),a.bottom>a.top&&(r=1)}var o=[];o.push(t);var s=e.locate(t,i*this._width,0);s.z=t.z,o.push(s);var l=e.locate(t,i*this._width,r*this._height);l.z=t.z,o.push(l);var u=e.locate(t,0,r*this._height);return o.push(u),u.z=t.z,o.push(t),o},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._getPrjCoordinates=function(){var e=this._getProjection();return this._verifyProjection(),!this._pnw&&e&&this._coordinates&&(this._pnw=e.project(this._coordinates)),this._pnw},n._setPrjCoordinates=function(e){this._pnw=e,this.onPositionChanged()},n._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this),n=this._getProjection();if(!n.isSphere())return this._rotatePrjCoordinates(t);for(var i=n.getSphereExtent(),r=i.sx,a=i.sy,o=this._getProjection().getCircum(),s=t[0],l=1,u=t.length;l<u;l++){var c=t[l],h=0,d=0;r*(s.x-c.x)>0&&(h=o.x*r),a*(s.y-c.y)<0&&(d=o.y*a),t[l]._add(h,d)}return this._rotatePrjCoordinates(t)},n._updateCache=function(){this._clearCache();var e=this._getProjection();this._pnw&&e&&(this._coordinates=e.unproject(this._pnw))},n._clearProjection=function(){this._pnw=null,e.prototype._clearProjection.call(this)},n._computeCenter=function(e){return e.locate(this._coordinates,this._width/2,-this._height/2)},n._containsPoint=function(t,n){var i=this.getMap();if(i.isTransforming())return e.prototype._containsPoint.call(this,t,n);var r=xI(n)?this._hitTestTolerance():n,a=i._getResolution()*r,o=this._getPrjExtent().expand(a),s=i._containerPointToPrj(t);return o.contains(s)},n._computePrjExtent=function(e){if(this.isRotated())return this._computeRotatedPrjExtent();var t=this._getSouthEast(e);if(!t)return null;var n=e.projectCoords([new PN(this._coordinates.x,t.y),new PN(t.x,this._coordinates.y)],this.options.antiMeridian);return new VN(n[0],n[1])},n._computeExtent=function(e){var t=this._getSouthEast(e);return t?new VN(this._coordinates,t,this._getProjection()):null},n._getSouthEast=function(e){if(!e||!this._coordinates||xI(this._width)||xI(this._height))return null;var t=this.getWidth(),n=-this.getHeight();if(e.fullExtent){var i=e.fullExtent;t*=i.right>i.left?1:-1,n*=i.top>i.bottom?1:-1}var r=e.locate(this._coordinates,t,0),a=e.locate(this._coordinates,0,n);return r.y=a.y,r},n._computeGeodesicLength=function(){return xI(this._width)||xI(this._height)?0:2*(this._width+this._height)},n._computeGeodesicArea=function(){return xI(this._width)||xI(this._height)?0:this._width*this._height},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:PN.toNumberArrays([this.getShell()])}},n._toJSON=function(e){var t=_I({},e),n=this.getCoordinates();t.geometry=!1;var i=this.toGeoJSON(t);return i.geometry={type:"Polygon"},{feature:i,subType:"Rectangle",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},t}(NL);$L.registerJSONType("Rectangle");var eB=function(e){function t(t,n,i,r,a){var o;return(o=e.call(this,t,n,a)||this).startAngle=i,o.endAngle=r,o}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(e.coordinates,e.radius,e.startAngle,e.endAngle,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n.getStartAngle=function(){return this.startAngle},n.setStartAngle=function(e){return this.startAngle=e,this.onShapeChanged(),this},n.getEndAngle=function(){return this.endAngle},n.setEndAngle=function(e){return this.endAngle=e,this.onShapeChanged(),this},n.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},n._getShell=function(){for(var e,t,n,i=this._getMeasurer(),r=this.getCoordinates(),a=this.options.numberOfShellPoints-2,o=this.getRadius(),s=[r.copy()],l=this.getStartAngle(),u=this.getEndAngle()-l,c=0;c<a;c++){e=(u*c/(a-1)+l)*Math.PI/180,t=o*Math.cos(e),n=o*Math.sin(e);var h=i.locate(r,t,n);h.z=r.z,s.push(h)}return s.push(r.copy()),s},n.getRotateOffsetAngle=function(){return 90},n._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this);return this._rotatePrjCoordinates(t)},n._computePrjExtent=function(){return this.isRotated()?this._computeRotatedPrjExtent():JL.prototype._computePrjExtent.apply(this,arguments)},n._containsPoint=function(t,n){var i=this.getMap();if(i.isTransforming())return e.prototype._containsPoint.call(this,t,n);var r,a=i._pointToContainerPoint(this._getCenter2DPoint()),o=this._hitTestTolerance()+(n||0),s=this.getSize(),l=a,u=t,c=Math.atan2(l.y-u.y,u.x-l.x),h=c<0?360*(c+2*Math.PI)/(2*Math.PI):360*c/(2*Math.PI),d=this.startAngle%360,f=this.endAngle%360;return r=d>f?!(h>f&&h<d):h>=d&&h<=f,u.distanceTo(l)<=s.width/2+o&&r},n._computeGeodesicLength=function(){return xI(this._radius)?0:2*Math.PI*this._radius*Math.abs(this.startAngle-this.endAngle)/360+2*this._radius},n._computeGeodesicArea=function(){return xI(this._radius)?0:Math.PI*Math.pow(this._radius,2)*Math.abs(this.startAngle-this.endAngle)/360},n._toJSON=function(e){var t=_I({},e),n=this.getCenter();t.geometry=!1;var i=this.toGeoJSON(t);return i.geometry={type:"Polygon"},{feature:i,subType:"Sector",coordinates:[n.x,n.y],radius:this.getRadius(),startAngle:this.getStartAngle(),endAngle:this.getEndAngle()}},t}(JL);eB.mergeOptions({numberOfShellPoints:60}),eB.registerJSONType("Sector");var tB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n._arc=function(e,t,n){for(var i=this.options.arcDegree*Math.PI/180,r=1,a=t.length;r<a;r++){var o=oN._arcBetween(e,t[r-1],t[r],i),s=[t[r-1].x+t[r].x-o[0],t[r-1].y+t[r].y-o[1]];t[r-1].nextCtrlPoint=s,t[r].prevCtrlPoint=s,oN._stroke(e,n)}},n._quadraticCurve=function(e,t){if(t.length<=2)oN._path(e,t);else{var n,i;for(n=2,i=t.length;n<i;n+=2)e.quadraticCurveTo(t[n-1].x,t[n-1].y,t[n].x,t[n].y);if((n-=1)<i)for(;n<i;n++)e.lineTo(t[n].x,t[n].y)}},n._bezierCurve=function(e,t){if(t.length<=3)oN._path(e,t);else{var n,i;for(n=1,i=t.length;n+2<i;n+=3)e.bezierCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y,t[n+2].x,t[n+2].y);if(n<i)for(;n<i;n++)e.lineTo(t[n].x,t[n].y)}},n._getCurveArrowPoints=function(e,t,n,i,r,a){var o,s=t.length;for(o=a;o<s;o+=a){var l=this._getArrowShape(t[o-1],t[o],n,i,r);l&&e.push(l)}if((o-=a)<s-1)for(o+=1;o<s;o++){var u=this._getArrowShape(t[o-1],t[o],n,i,r);u&&e.push(u)}},t}(FL);tB.mergeOptions({enableSimplify:!1,enableClip:!1});var nB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"ArcCurve"}},n._paintOn=function(e,t,n){e.beginPath(),this._arc(e,t,n),oN._stroke(e,n),this._paintArrow(e,t,n)},t.fromJSON=function(e){var n=e.feature,i=new t(n.geometry.coordinates,e.options);return i.setProperties(n.properties),i},t}(tB);nB.registerJSONType("ArcCurve"),nB.mergeOptions({arcDegree:90});var iB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(n.geometry.coordinates,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"CubicBezierCurve"}},n._paintOn=function(e,t,n){e.beginPath(),e.moveTo(t[0].x,t[0].y),this._bezierCurve(e,t),oN._stroke(e,n),this._paintArrow(e,t,n)},n._getArrowPoints=function(e,t,n,i,r){return this._getCurveArrowPoints(e,t,n,i,r,3)},t}(tB);iB.registerJSONType("CubicBezierCurve");var rB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e),t.fromJSON=function(e){var n=e.feature,i=new t(n.geometry.coordinates,e.options);return i.setProperties(n.properties),i};var n=t.prototype;return n._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"QuadBezierCurve"}},n._paintOn=function(e,t,n){e.beginPath(),e.moveTo(t[0].x,t[0].y),this._quadraticCurve(e,t,n),oN._stroke(e,n),this._paintArrow(e,t,n)},n._getArrowPoints=function(e,t,n,i,r){return this._getCurveArrowPoints(e,t,n,i,r,2)},t}(tB);rB.registerJSONType("QuadBezierCurve");var aB={textFaceName:"monospace",textSize:12,textLineSpacing:8,textWrapCharacter:"\n",textHorizontalAlignment:"middle",textVerticalAlignment:"middle"},oB={markerType:"square",markerLineColor:"#000",markerLineWidth:2,markerLineOpacity:1,markerFill:"#fff",markerOpacity:1},sB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.getContent=function(){return this._content},n.setContent=function(e){var t=this._content;return this._content=NR(e),this._refresh(),this._fireEvent("contentchange",{old:t,new:e}),this},n.onAdd=function(){this._refresh()},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return delete t.symbol,t},n.setSymbol=function(t){if(this._refreshing||!t)return e.prototype.setSymbol.call(this,t);var n=this._parseSymbol(t);if(this.setTextStyle){var i=this.getTextStyle()||{};i.symbol=n[0],this.setTextStyle(i)}else this.setTextSymbol&&this.setTextSymbol(n[0]);if(this.setBoxStyle){var r=this.getBoxStyle()||{};r.symbol=n[1],this.setBoxStyle(r)}else this.setBoxSymbol&&this.setBoxSymbol(n[1]);return this},n._parseSymbol=function(e){var t={},n={};for(var i in e)EI(e,i)&&(0===i.indexOf("text")?t[i]=e[i]:n[i]=e[i]);return[t,n]},n._getTextSize=function(e){return qR(this._content,e).size},n._getInternalSymbol=function(){return this._symbol},n._getDefaultTextSymbol=function(){return _I({},aB)},n._getDefaultBoxSymbol=function(){return _I({},oB)},n._getDefaultPadding=function(){return[12,8]},t}(LL),lB=function(e){function t(t,n,i,r,a){var o;return void 0===a&&(a={}),(o=e.call(this,n,a)||this)._content=NR(t),o._width=xI(i)?100:i,o._height=xI(r)?40:r,a.boxSymbol&&o.setBoxSymbol(a.boxSymbol),a.textStyle&&o.setTextStyle(a.textStyle),o._refresh(),o}cA(t,e);var n=t.prototype;return n.getWidth=function(){return this._width},n.setWidth=function(e){return this._width=e,this._refresh(),this},n.getHeight=function(){return this._height},n.setHeight=function(e){return this._height=e,this._refresh(),this},n.getBoxSymbol=function(){return _I({},this.options.boxSymbol)},n.setBoxSymbol=function(e){return this.options.boxSymbol=e?_I({},e):e,this.getSymbol()&&this._refresh(),this},n.getTextStyle=function(){return this.options.textStyle?_I({},this.options.textStyle):null},n.setTextStyle=function(e){return this.options.textStyle=e?_I({},e):e,this.getSymbol()&&this._refresh(),this},t.fromJSON=function(e){var n=e.feature,i=new t(e.content,n.geometry.coordinates,e.width,e.height,e.options);return i.setProperties(n.properties),i.setId(n.id),e.symbol&&i.setSymbol(e.symbol),i},n._toJSON=function(e){return{feature:this.toGeoJSON(e),width:this.getWidth(),height:this.getHeight(),subType:"TextBox",content:this._content}},n._refresh=function(){var e,t,n=this.getTextStyle()||{},i=n.padding||[12,8];if(oR(this._width)){var r=(e=JSON.parse(JSON.stringify(this._width))).stops;if(r)for(var a=0;a<r.length;a++)r[a][1]=r[a][1]-2*i[0]}else e=this._width-2*i[0];if(oR(this._height)){var o=(t=JSON.parse(JSON.stringify(this._height))).stops;if(o)for(var s=0;s<o.length;s++)o[s][1]=o[s][1]-2*i[1]}else t=this._height-2*i[1];var l=_I({},n.symbol||this._getDefaultTextSymbol(),this.options.boxSymbol||this._getDefaultBoxSymbol(),{textName:this._content,markerWidth:this._width,markerHeight:this._height,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textMaxWidth:e,textMaxHeight:t});n.wrap&&!l.textWrapWidth&&(l.textWrapWidth=e);var u,c=n.horizontalAlignment;if(l.textDx=l.markerDx||0,oR(this._width)){var h=(u=JSON.parse(JSON.stringify(this._width))).stops;if(h)for(var d=0;d<h.length;d++)h[d][1]=h[d][1]/2-i[0],"left"===c&&(h[d][1]*=-1)}else u=l.markerWidth/2-i[0],"left"===c&&(u*=-1);"left"===c?(l.textHorizontalAlignment="right",l.textDx=u):"right"===c&&(l.textHorizontalAlignment="left",l.textDx=u);var f,p=n.verticalAlignment;if(l.textDy=l.markerDy||0,oR(this._height)){var m=(f=JSON.parse(JSON.stringify(this._height))).stops;if(m)for(var v=0;v<m.length;v++)m[v][1]=m[v][1]/2-i[1],"top"===p&&(m[v][1]*=-1)}else f=l.markerHeight/2-i[1],"top"===p&&(f*=-1);"top"===p?(l.textVerticalAlignment="bottom",l.textDy=f):"bottom"===p&&(l.textVerticalAlignment="top",l.textDy=f),this._refreshing=!0,this.updateSymbol(l),delete this._refreshing},n.startEdit=function(t){var n=this._getCompiledSymbol();if(oR(this._width)){var i=n.markerWidth;this._oldWidth=this._width,this.setWidth(i)}if(oR(this._height)){var r=n.markerHeight;this._oldHeight=this._height,this.setHeight(r)}e.prototype.startEdit.call(this,t)},n.endEdit=function(){var t=this.getMap(),n=t&&t.getZoom();if(this._oldWidth){for(var i=this._width/lR(this._oldWidth)(n),r=this._oldWidth.stops,a=0;a<r.length;a++)r[a][1]*=i;this.setWidth(this._oldWidth),delete this._oldWidth}if(this._oldHeight){for(var o=this._height/lR(this._oldHeight)(n),s=this._oldHeight.stops,l=0;l<s.length;l++)s[l][1]*=o;this.setHeight(this._oldHeight),delete this._oldHeight}e.prototype.endEdit.call(this)},t}(sB);lB.mergeOptions({textStyle:{wrap:!0,padding:[12,8],verticalAlignment:"middle",horizontalAlignment:"middle"},boxSymbol:null}),lB.registerJSONType("TextBox");var uB=function(e){function t(t,n,i){var r;return void 0===i&&(i={}),r=e.call(this,n,i)||this,i.textSymbol&&r.setTextSymbol(i.textSymbol),i.boxStyle&&r.setBoxStyle(i.boxStyle),r._content=NR(t),r._refresh(),r}cA(t,e);var n=t.prototype;return n.getBoxStyle=function(){return this.options.boxStyle?_I({},this.options.boxStyle):null},n.setBoxStyle=function(e){return this.options.boxStyle=e?_I({},e):e,this._refresh(),this},n.getTextSymbol=function(){return _I({},this._getDefaultTextSymbol(),this.options.textSymbol)},n.setTextSymbol=function(e){return this.options.textSymbol=e?_I({},e):e,this._refresh(),this},t.fromJSON=function(e){var n=e.feature,i=new t(e.content,n.geometry.coordinates,e.options);return i.setProperties(n.properties),i.setId(n.id),e.symbol&&i.setSymbol(e.symbol),i},n._canEdit=function(){return!1},n._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"Label",content:this._content}},n._refresh=function(){var e=_I({},this.getTextSymbol(),{textName:this._content}),t=this.getBoxStyle();if(t){_I(e,t.symbol);var n=this._getBoxSize(e),i=n[1],r=t.padding||this._getDefaultPadding(),a=n[0];e.markerWidth=a.width,e.markerHeight=a.height;var o=e.textDx||0,s=e.textDy||0,l=VR(i,e.textHorizontalAlignment,e.textVerticalAlignment)._add(o,s),u=t.horizontalAlignment||"middle";e.markerDx=l.x,"left"===u?e.markerDx+=e.markerWidth/2-r[0]:"right"===u?e.markerDx-=e.markerWidth/2-i.width-r[0]:e.markerDx+=i.width/2;var c=t.verticalAlignment||"middle";e.markerDy=l.y,"top"===c?e.markerDy+=e.markerHeight/2-r[1]:"bottom"===c?e.markerDy-=e.markerHeight/2-i.height-r[1]:e.markerDy+=i.height/2}this._refreshing=!0,this.updateSymbol(e),delete this._refreshing},n._getBoxSize=function(e){e.markerType||(e.markerType="square");var t,n,i=this.getBoxStyle(),r=this._getTextSize(e),a=i.padding||this._getDefaultPadding();return t=r.width+2*a[0],n=r.height+2*a[1],i.minWidth&&(!t||t<i.minWidth)&&(t=i.minWidth),i.minHeight&&(!n||n<i.minHeight)&&(n=i.minHeight),[new AR(t,n),r]},t}(sB);uB.mergeOptions({boxStyle:null,textSymbol:null}),uB.registerJSONType("Label");var cB=function(e){return function(e){function t(){return e.apply(this,arguments)||this}cA(t,e),t._hasConnectors=function(e){return!xI(e.__connectors)&&e.__connectors.length>0},t._getConnectors=function(e){return e.__connectors};var n=t.prototype;return n.getConnectSource=function(){return this._connSource},n.setConnectSource=function(e){var t=this._connTarget;return this.onRemove(),this._connSource=e,this._connTarget=t,this.onAdd(),this},n.getConnectTarget=function(){return this._connTarget},n.setConnectTarget=function(e){var t=this._connSource;return this.onRemove(),this._connSource=t,this._connTarget=e,this._updateCoordinates(),this._registerEvents(),this},n._updateCoordinates=function(){var e=this.getMap();if(!e&&this._connSource&&(e=this._connSource.getMap()),!e&&this._connTarget&&(e=this._connTarget.getMap()),e&&this._connSource&&this._connTarget){for(var t,n,i=this._connSource._getConnectPoints(),r=this._connTarget._getConnectPoints(),a=0,o=this.getCoordinates(),s=0,l=i.length;s<l;s++)for(var u=i[s],c=0,h=r.length;c<h;c++){var d=r[c],f=e.computeLength(u,d);0===s&&0===c?(t=u,n=d,a=f):f<a&&(t=u,n=d)}NA(o)&&o[0].equals(t)&&o[1].equals(n)||this.setCoordinates([t,n])}},n.onAdd=function(){this._registerEvents(),this._updateCoordinates()},n.onRemove=function(){if(this._connSource&&(this._connSource.__connectors&&EA(this,this._connSource.__connectors),this._connSource.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connSource.off("dragstart mousedown mouseover",this._showConnect,this),this._connSource.off("dragend mouseup mouseout",this.hide,this),this._connSource.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connSource),this._connTarget&&(EA(this,this._connTarget.__connectors),this._connTarget.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connTarget.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connTarget),!(this._connSource instanceof Jz&&this._connTarget instanceof Jz)){var e=this.getMap();e&&e.off("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}},n._showConnect=function(){this._connSource&&this._connTarget&&this._connSource.isVisible()&&this._connTarget.isVisible()&&(this._updateCoordinates(),this.show())},n._registerEvents=function(){if(this._connSource&&this._connTarget){this._connSource.__connectors||(this._connSource.__connectors=[]),this._connTarget.__connectors||(this._connTarget.__connectors=[]),this._connSource.__connectors.push(this),this._connTarget.__connectors.push(this),this._connSource.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connTarget.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connSource.on("show",this._showConnect,this).on("hide",this.hide,this),this._connTarget.on("show",this._showConnect,this).on("hide",this.hide,this);var e=this.options.showOn;if(this.hide(),"moving"===e?(this._connSource.on("dragstart",this._showConnect,this).on("dragend",this.hide,this),this._connTarget.on("dragstart",this._showConnect,this).on("dragend",this.hide,this)):"click"===e?(this._connSource.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this),this._connTarget.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this)):"mouseover"===e?(this._connSource.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this),this._connTarget.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this)):this._showConnect(),!(this._connSource instanceof Jz&&this._connTarget instanceof Jz)){var t=this.getMap();t&&t.on("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}}},t}(e)},hB={showOn:"always"},dB=function(e){function t(t,n,i){var r;return r=e.call(this,null,i)||this,1===arguments.length&&(i=t,t=null,n=null),r._connSource=t,r._connTarget=n,r}return cA(t,e),t}(cB(FL));dB.mergeOptions(hB),dB.registerJSONType("ConnectorLine");var fB=function(e){function t(t,n,i){var r;return r=e.call(this,null,i)||this,1===arguments.length&&(i=t,t=null,n=null),r._connSource=t,r._connTarget=n,r}return cA(t,e),t}(cB(nB));function pB(e){return e&&e instanceof Jz}fB.mergeOptions(hB),fB.registerJSONType("ArcConnectorLine");var mB=[],vB=function(e){function t(t,n,i){var r;n&&!pB(n)&&!Array.isArray(n)&&fI.indexOf(n.type)<0&&(i=n,n=null),(r=e.call(this,t,i)||this)._maxZIndex=0,r._minZIndex=0,r._initCache(),n&&r.addGeometry(n);var a=r.options.style;return a&&r.setStyle(a),r}cA(t,e);var n=t.prototype;return n.getGeometryById=function(e){return xI(e)||""===e?null:this._geoMap[e]?this._geoMap[e]:null},n.getGeometries=function(e,t){if(!e)return this._geoList.slice(0);for(var n,i=[],r=0,a=this._geoList.length;r<a;r++)n=this._geoList[r],(t?e.call(t,n):e(n))&&i.push(n);return i},n.getFirstGeometry=function(){return this._geoList.length?this._geoList[0]:null},n.getLastGeometry=function(){var e=this._geoList.length;return 0===e?null:this._geoList[e-1]},n.getCount=function(){return this._geoList.length},n.getExtent=function(){if(0===this.getCount())return null;var e=new VN(this.getProjection());return this.forEach((function(t){e._combine(t.getExtent())})),e},n.forEach=function(e,t){for(var n=this._geoList.slice(0),i=0,r=n.length;i<r;i++)t?e.call(t,n[i],i):e(n[i],i);return this},n.filter=function(e,t){var n=[],i=SI(e),r=i?e:dR(e);return this.forEach((function(e){var a=i?e:wR(e);(t?r.call(t,a):r(a))&&n.push(e)}),this),n},n.isEmpty=function(){return!this._geoList.length},n.addGeometry=function(e,t){if(!e)return this;if("FeatureCollection"===e.type)return this.addGeometry(YL.toGeometry(e),t);if(!Array.isArray(e)){var n=arguments.length,i=arguments[n-1];return e=Array.prototype.slice.call(arguments,0,n-1),t=i,i&&kI(i)&&("type"in i||pB(i))&&(e.push(i),t=!1),this.addGeometry(e,t)}if(0===e.length)return this;var r;this._initCache(),t&&(r=new VN),this._toSort=this._maxZIndex>0;for(var a=[],o=0,s=e.length;o<s;o++){var l=e[o];if(!l||!YL._isGeoJSON(l)&&!pB(l))throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+o);if(!l.getLayer||l.getLayer()!==this){if(!pB(l)&&(l=Jz.fromJSON(l),Array.isArray(l)))for(var u=0,c=l.length;u<c;u++)this._add(l[u],r,o),a.push(l[u]);if(!l)throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+o);Array.isArray(l)||(this._add(l,r,o),a.push(l))}}var h=this.getMap();if(h&&(this._getRenderer().onGeometryAdd(a),r&&!xI(r.xmin))){var d=r.getCenter(),f=h.getFitZoom(r);if(kI(t)){var p=SI(t.step)?t.step:function(){};h.animateTo({center:d,zoom:f},_I({duration:h.options.zoomAnimationDuration,easing:"out"},t),p)}else!0===t&&h.setCenterAndZoom(d,f)}return this.fire("addgeo",{geometries:e}),this},n.getGeoMinZIndex=function(){return this._minZIndex},n.getGeoMaxZIndex=function(){return this._maxZIndex},n._add=function(e,t,n){this._toSort||(this._toSort=0!==e.getZIndex()),this._updateZIndex(e.getZIndex());var i=e.getId();if(!xI(i)){if(!xI(this._geoMap[i]))throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+i+", at index:"+n);this._geoMap[i]=e}var r=CA();e._setInternalId(r),this._geoList.push(e),this.onAddGeometry(e),e._bindLayer(this),e.onAdd&&e.onAdd(),t&&t._combine(e.getExtent()),e._fireEvent("add",{layer:this}),this._cookedStyles&&this._styleGeometry(e)},n.removeGeometry=function(e){if(!Array.isArray(e))return this.removeGeometry([e]);for(var t=e.length-1;t>=0;t--)e[t]instanceof Jz||(e[t]=this.getGeometryById(e[t])),e[t]&&this===e[t].getLayer()&&e[t].remove();return this.fire("removegeo",{geometries:e}),this},n.clear=function(){this._clearing=!0,this.forEach((function(e){e.remove()})),this._geoMap={};var e=this._geoList;this._geoList=[];var t=this._getRenderer();return t&&(t.onGeometryRemove(e),t.clearImageData&&(t.clearImageData(),delete t._lastGeosToDraw)),this._clearing=!1,this.fire("clear"),this},n.onRemoveGeometry=function(e){if(e&&!this._clearing&&this===e.getLayer()&&!xI(e._getInternalId())){var t=e.getId();xI(t)||delete this._geoMap[t];var n=this._findInList(e);n>=0&&this._geoList.splice(n,1),this._getRenderer()&&this._getRenderer().onGeometryRemove([e])}},n.getStyle=function(){return this.options.style?this.options.style:null},n.setStyle=function(e){return this.options.style=e,e=function(e){if(e.symbol&&(e=[e]),Array.isArray(e))return e;var t=e.$root,n=e.$iconset;return e=e.style,(t||n)&&(t&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),n&&"/"===n[n.length-1]&&(n=n.substring(0,n.length-1)),function(e,t){for(var n=0;n<e.length;n++){var i=e[n].symbol;i&&QR(i,t)}}(e,(function(e){return"{$root}"===e?t:"{$iconset}"===e?n:null}))),e}(e),this._cookedStyles=function e(t){if(!Array.isArray(t))return e([t]);for(var n=[],i=0;i<t.length;i++){var r;r=!0===t[i].filter?function(){return!0}:dR(t[i].filter),n.push(kR({},t[i],{filter:r}))}return n}(e),this.forEach((function(e){this._styleGeometry(e)}),this),this.fire("setstyle",{style:e}),this},n._styleGeometry=function(e){if(!this._cookedStyles)return!1;for(var t=wR(e),n=0,i=this._cookedStyles.length;n<i;n++)if(!0===this._cookedStyles[n].filter(t))return e._setExternSymbol(this._cookedStyles[n].symbol),!0;return!1},n.removeStyle=function(){return this.options.style?(delete this.options.style,delete this._cookedStyles,this.forEach((function(e){e._setExternSymbol(null)}),this),this.fire("removestyle"),this):this},n.onAddGeometry=function(e){this.getStyle()&&this._styleGeometry(e)},n.hide=function(){for(var e=0,t=this._geoList.length;e<t;e++)this._geoList[e].onHide();return nL.prototype.hide.call(this)},n._initCache=function(){this._geoList||(this._geoList=[],this._geoMap={})},n._updateZIndex=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._maxZIndex=Math.max(this._maxZIndex,Math.max.apply(Math,t)),this._minZIndex=Math.min(this._minZIndex,Math.min.apply(Math,t))},n._sortGeometries=function(){var e=this;this._toSort&&(this._maxZIndex=0,this._minZIndex=0,this._geoList.sort((function(t,n){return e._updateZIndex(t.getZIndex(),n.getZIndex()),e._compare(t,n)})),this._toSort=!1)},n._compare=function(e,t){return e.getZIndex()===t.getZIndex()?e._getInternalId()-t._getInternalId():e.getZIndex()-t.getZIndex()},n._findInList=function(e){var t=this._geoList.length;if(0===t)return-1;this._sortGeometries();for(var n,i=0,r=t-1;i<=r;){if(n=Math.floor((i+r)/2),this._geoList[n]===e)return n;this._compare(this._geoList[n],e)>0?r=n-1:i=n+1}return-1},n._onGeometryEvent=function(e){if(e&&e.target){var t=e.type;"idchange"===t?this._onGeometryIdChange(e):"zindexchange"===t?this._onGeometryZIndexChange(e):"positionchange"===t?this._onGeometryPositionChange(e):"shapechange"===t?this._onGeometryShapeChange(e):"symbolchange"===t?this._onGeometrySymbolChange(e):"show"===t?this._onGeometryShow(e):"hide"===t?this._onGeometryHide(e):"propertieschange"===t&&this._onGeometryPropertiesChange(e)}},n._onGeometryIdChange=function(e){if(e.new!==e.old||!this._geoMap[e.old]||this._geoMap[e.old]!==e.target){if(!xI(e.new)){if(this._geoMap[e.new])throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+e.new);this._geoMap[e.new]=e.target}xI(e.old)||e.new===e.old||delete this._geoMap[e.old]}},n._onGeometryZIndexChange=function(e){e.old!==e.new&&(this._updateZIndex(e.new),this._toSort=!0,this._getRenderer()&&this._getRenderer().onGeometryZIndexChange(e))},n._onGeometryPositionChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPositionChange(e)},n._onGeometryShapeChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryShapeChange(e)},n._onGeometrySymbolChange=function(e){this._getRenderer()&&this._getRenderer().onGeometrySymbolChange(e)},n._onGeometryShow=function(e){this._getRenderer()&&this._getRenderer().onGeometryShow(e)},n._onGeometryHide=function(e){this._getRenderer()&&this._getRenderer().onGeometryHide(e)},n._onGeometryPropertiesChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPropertiesChange(e)},n._hasGeoListeners=function(e){if(!e)return!1;Array.isArray(e)||(mB[0]=e,e=mB);for(var t=this.getGeometries()||[],n=0,i=t.length;n<i;n++){var r=t[n];if(r){if(r.options.cursor)return!0;for(var a=0,o=e.length;a<o;a++)if(r.listens(e[a])>0)return!0}}return!1},t}(nL);vB.mergeOptions({drawImmediate:!1,geometryEvents:!0,geometryEventTolerance:1});var gB=new qN,yB={debug:!1,enableSimplify:!0,defaultIconSize:[20,20],cacheVectorOnCanvas:!0,cacheSvgOnCanvas:lA.gecko,enableAltitude:!1,altitudeProperty:"altitude",drawAltitude:!1,sortByDistanceToCamera:!1,roundPoint:!1,altitude:0,clipBBoxBufferSize:3,collision:!1,collisionBufferSize:2,collisionDelay:250,collisionScope:"layer",progressiveRender:!1,progressiveRenderCount:1e3,progressiveRenderDebug:!1},_B=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}cA(t,e);var n=t.prototype;return n.onConfig=function(t){if(e.prototype.onConfig.call(this,t),t.enableAltitude||t.drawAltitude||t.altitudeProperty){var n=this.getRenderer();n&&n.setToRedraw&&n.setToRedraw()}},n.identify=function(e,t){void 0===t&&(t={});var n=this.getRenderer();e instanceof PN||(e=new PN(e));var i=this.getMap().coordToContainerPoint(e);return t.onlyVisible&&n&&n.identifyAtPoint?n.identifyAtPoint(i,t):this._hitGeos(this._geoList,i,t)},n.identifyAtPoint=function(e,t){void 0===t&&(t={});var n=this.getRenderer();return e instanceof xA||(e=new xA(e)),t.onlyVisible&&n&&n.identifyAtPoint?n.identifyAtPoint(e,t):this._hitGeos(this._geoList,e,t)},n._hitGeos=function(e,t,n){if(void 0===n&&(n={}),!e||!e.length)return[];var i=n.filter,r=[],a=n.tolerance,o=this.getMap(),s=this.getRenderer(),l=s&&s.getImageData&&s.getImageData();if(l){var u=0,c=s.maxTolerance;if(bI(c))u=c;else for(var h=e.length-1;h>=0;h--){var d=e[h]._hitTestTolerance()+(a||0);d>u&&(u=d)}var f=o.getDevicePixelRatio();l.r=f;for(var p=!1,m=t.x-u,v=t.y-u,g=-u;g<=u;g++){for(var y=-u;y<=u;y++){var _=Math.round((m+g)*f),x=Math.round((v+y)*f);if(l.data[x*l.width*4+4*_+3]>0){p=!0;break}}if(p)break}if(!p)return r}for(var b=n.onlyVisible,w=e.length-1;w>=0;w--){var k=e[w];if(k&&k.options.interactive&&(b||k.isVisible())){var C=k._getPainter();if(C){var S=C.getRenderBBOX&&C.getRenderBBOX();if(S){var T=t.x,E=t.y;if(T<S[0]||E<S[1]||T>S[2]||E>S[3])continue}if(!(k instanceof FL&&(k._getArrowStyle()||k instanceof tB))){var P=k.getContainerExtent(gB);if(a&&(P=P._expand(a)),!P||!P.contains(t))continue}if(k._containsPoint(t,a)&&(!i||i(k))&&(r.push(k),n.count&&r.length>=n.count))break}}}return r},n.getAltitude=function(){return this.options.altitude||0},n.toJSON=function(e){e||(e={});var t={type:this.getJSONType(),id:this.getId(),options:this.config()};if(xI(e.geometries)||e.geometries){var n;if(e.clipExtent){var i=this.getMap(),r=i?i.getProjection():null;n=new VN(e.clipExtent,r)}for(var a=[],o=this.getGeometries(),s=0,l=o.length;s<l;s++){var u=o[s],c=u.getExtent();if(c&&(!n||n.intersects(c))){var h=u.toJSON(e.geometries);a.push(h)}}t.geometries=a}return t},t.fromJSON=function(e){if(!e||"VectorLayer"!==e.type)return null;for(var n=new t(e.id,e.options),i=e.geometries,r=[],a=0;a<i.length;a++){var o=Jz.fromJSON(i[a]);o&&r.push(o)}return n.addGeometry(r),n},t.getPainterClass=function(){return Uz},t.getCollectionPainterClass=function(){return Gz},t}(vB);_B.mergeOptions(yB),_B.registerJSONType("VectorLayer");var xB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addTo=function(e){return e?(this._map=e,e._map_tool&&e._map_tool.disable(),this.onAdd&&this.onAdd(),this.enable(),e._map_tool=this,this._fireEvent("add"),this):this},n.getMap=function(){return this._map},n.enable=function(){return!this._map||this._enabled||(this._enabled=!0,this._switchEvents("off"),this._registerEvents(),this.onEnable&&this.onEnable(),this._fireEvent("enable")),this},n.disable=function(){return this._enabled&&this._map?(this._enabled=!1,this._switchEvents("off"),this.onDisable&&this.onDisable(),this._fireEvent("disable"),this):this},n.isEnabled=function(){return!!this._enabled},n.remove=function(){return this._map?(this.disable(),this._map&&(delete this._map._map_tool,delete this._map),this._fireEvent("remove"),this):this},n._registerEvents=function(){this._switchEvents("on")},n._switchEvents=function(e){var t=this.getEvents();t&&this._map[e](t,this)},n._fireEvent=function(e,t){t||(t={}),this.fire(e,t)},t}(dN(pN)),bB={symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3},doubleClickZoom:!1,mode:null,once:!1,autoPanAtEdge:!1,ignoreMouseleave:!0,blockGeometryEvents:!1,zIndex:Number.MAX_VALUE},wB={},kB=function(e){function t(t){var n;return(n=e.call(this,t)||this)._checkMode(),n._events={click:n._clickHandler,"mousemove touchmove":n._mouseMoveHandler,dblclick:n._doubleClickHandler,"mousedown touchstart":n._mouseDownHandler,"mouseup touchend":n._mouseUpHandler,mousemove:n._mouseMoveHandler,mousedown:n._mouseDownHandler,mouseup:n._mouseUpHandler},n}cA(t,e),t.registerMode=function(e,t){wB[e.toLowerCase()]=t},t.getRegisterMode=function(e){return wB[e.toLowerCase()]};var n=t.prototype;return n.getMode=function(){return this.options.mode?this.options.mode.toLowerCase():null},n.setMode=function(e){return this._geometry&&(this._geometry.remove(),delete this._geometry),this._clearStage(),this._switchEvents("off"),this.options.mode=e,this._checkMode(),this.isEnabled()&&(this._switchEvents("on"),this._restoreMapCfg(),this._saveMapCfg()),this},n.getSymbol=function(){return YR(this.options.symbol||this.options.symbol)},n.setSymbol=function(e){return e?(this.options.symbol=e,this._geometry&&this._geometry.setSymbol(e),this):this},n.getCurrentGeometry=function(){return this._geometry},n.onAdd=function(){this._checkMode()},n.onEnable=function(){this._saveMapCfg(),this._drawToolLayer=this._getDrawLayer(),this._clearStage(),this._loadResources();var e=this.getMap();return this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge=e.options.autoPanAtEdge,this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!0})),this._geometryEvents=e.options.geometryEvents,this.options.blockGeometryEvents&&e.config("geometryEvents",!1),this},n.onDisable=function(){var e=this.getMap();return this._restoreMapCfg(),this.endDraw({ignoreEndEvent:!0}),this._map&&(e.removeLayer(this._getDrawLayer()),this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!1}))),this.options.blockGeometryEvents&&e.config("geometryEvents",this._geometryEvents),this},n.undo=function(){var e=this._getRegisterMode();if(!this._shouldRecordHistory(e.action)||!this._historyPointer)return this;var t=this._clickCoords.slice(0,--this._historyPointer);return e.update(this.getMap().getProjection(),t,this._geometry),this},n.redo=function(){var e=this._getRegisterMode();if(!this._shouldRecordHistory(e.action)||xI(this._historyPointer)||this._historyPointer===this._clickCoords.length)return this;var t=this._clickCoords.slice(0,++this._historyPointer);return e.update(this.getMap().getProjection(),t,this._geometry),this},n._shouldRecordHistory=function(e){return Array.isArray(e)&&"click"===e[0]&&"mousemove"===e[1]&&"dblclick"===e[2]},n._checkMode=function(){this._getRegisterMode()},n._saveMapCfg=function(){var e=this.getMap();this._mapDoubleClickZoom=e.options.doubleClickZoom,e.config({doubleClickZoom:this.options.doubleClickZoom});for(var t=this._getRegisterMode().action,n=!1,i=0;i<t.length;i++)if(t[i].indexOf("mousedown")>=0||t[i].indexOf("touchstart")>=0){n=!0;break}if(n){var r=this.getMap();this._mapDraggable=r.options.draggable,r.config({draggable:!1})}},n._restoreMapCfg=function(){var e=this.getMap();e.config({doubleClickZoom:this._mapDoubleClickZoom}),xI(this._mapDraggable)||e.config("draggable",this._mapDraggable),delete this._mapDraggable,delete this._mapDoubleClickZoom},n._loadResources=function(){var e=PR(this.getSymbol());e.length>0&&this._drawToolLayer._getRenderer().loadResources(e)},n._getProjection=function(){return this._map.getProjection()},n._getRegisterMode=function(){var e=this.getMode(),n=t.getRegisterMode(e);if(!n)throw new Error(e+" is not a valid mode of DrawTool.");return n},n.getEvents=function(){var e=this._getRegisterMode().action,t={};if(Array.isArray(e)){for(var n=0;n<e.length;n++)t[e[n]]=this._events[e[n]];return t}return null},n._mouseDownHandler=function(e){this._createGeometry(e)},n._mouseUpHandler=function(e){this.endDraw(e)},n._clickHandler=function(e){var t=this.getMap(),n=this._getRegisterMode();if(this._clickCoords&&this._clickCoords.length){var i=this._clickCoords.length,r=t._pointToPrj(e.point2d);if(this._clickCoords[i-1].equals(r))return}if(this._geometry){var a=t._pointToPrj(e.point2d);xI(this._historyPointer)||(this._clickCoords=this._clickCoords.slice(0,this._historyPointer));var o=this._geometry.snapTo;if(o&&SI(o)){var s=this._getSnapResult(o,e.containerPoint);if(a=s.prjCoord,this._clickCoords=this._clickCoords.concat(s.effectedVertex),this._clickCoords[this._clickCoords.length-1].equals(a))return}if(this._clickCoords.push(a),this._historyPointer=this._clickCoords.length,e.drawTool=this,n.update(t.getProjection(),this._clickCoords,this._geometry,e),"point"===this.getMode())return void this.endDraw(e);this._fireEvent(this._clickCoords.length<=1?"drawstart":"drawvertex",e),n.clickLimit&&n.clickLimit===this._historyPointer&&this.endDraw(e)}else this._createGeometry(e)},n._createGeometry=function(e){var t=this.getMode(),n=this._getRegisterMode(),i=this.getMap()._pointToPrj(e.point2d),r=this.getSymbol();if(!this._geometry){this._fireEvent("drawprepare",e),this._clickCoords=[i],e.drawTool=this,this._geometry=n.create(this.getMap().getProjection(),this._clickCoords,e),r&&"point"!==t?this._geometry.setSymbol(r):this.options.hasOwnProperty("symbol")&&this._geometry.setSymbol(this.options.symbol),this._addGeometryToStage(this._geometry),this._fireEvent("drawstart",e);var a=this._geometry.snapTo;if(a&&SI(a)){var o=this._getSnapResult(a,e.containerPoint),s=this.getMap();s&&o&&(this._clickCoords=[o.prjCoord],n.update(s.getProjection(),this._clickCoords,this._geometry,e))}}"point"===t&&"mousemove"!==e.type&&this.endDraw(e)},n._mouseMoveHandler=function(e){var t=this.getMap();if(t&&!t.isInteracting())if("point"!==this.getMode()||this._geometry){if(this._geometry){var n=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(n)){var i=t._pointToPrj(e.point2d),r=[],a=this._geometry.snapTo;if(a&&SI(a)){var o=this._getSnapResult(a,n);i=o.prjCoord,r=o.effectedVertex}var s=t.getProjection();e.drawTool=this;var l=this._getRegisterMode();if(this._shouldRecordHistory(l.action)){var u=this._clickCoords.slice(0,this._historyPointer);if(u&&u.length>0&&i.equals(u[u.length-1]))return;l.update(s,u.concat(r,[i]),this._geometry,e)}else l.update(s,i,this._geometry,e);this._fireEvent("mousemove",e)}}}else this._createGeometry(e)},n._doubleClickHandler=function(e){if(this._geometry){var t=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(t)){var n=this._getRegisterMode(),i=this._clickCoords;if(!(i.length<2)){var r=this.getMode();if(!(r&&r.indexOf("polygon")>-1&&i.length<3)){for(var a=this.getMap().getProjection(),o=[i[0]],s=1,l=i.length;s<l;s++)i[s].x===i[s-1].x&&i[s].y===i[s-1].y||o.push(i[s]);o.length<2||this._geometry&&this._geometry instanceof NL&&o.length<3||(e.drawTool=this,n.update(a,o,this._geometry,e),this.endDraw(e))}}}}},n._addGeometryToStage=function(e){this._getDrawLayer().addGeometry(e)},n.endDraw=function(e){if(!this._geometry||this._ending)return this;this._ending=!0;var t=this._geometry;return this._clearStage(),e=e||{},this._geometry=t,e.ignoreEndEvent||this._fireEvent("drawend",e),delete this._geometry,this.options.once&&this.disable(),delete this._ending,delete this._historyPointer,this._vertexes&&(this._vertexes=[]),this},n._clearStage=function(){this._getDrawLayer().clear(),delete this._geometry,delete this._clickCoords},n._getMouseContainerPoint=function(e){var t=this._getRegisterMode().action;return(t[0].indexOf("mousedown")>=0||t[0].indexOf("touchstart")>=0)&&hO(e.domEvent),e.containerPoint},n._isValidContainerPoint=function(e){var t=this._map.getSize();return!(e.x<0||e.y<0||e.x>t.width||e.y>t.height)},n._getSnapResult=function(e,t){var n=this.getMap(),i=[];if(this.options.edgeAutoComplete){i.push(n._prjToContainerPoint(this._clickCoords[(this._historyPointer||1)-1]));var r=this._clickCoords[(this._historyPointer||1)-2];r&&i.push(n._prjToContainerPoint(r))}var a=e(t,i),o=n._containerPointToPrj(t=(a.effectedVertex?a.point:a)||t);return a.effectedVertex&&(a.effectedVertex=a.effectedVertex.map((function(e){return n._containerPointToPrj(e)}))),{prjCoord:o,effectedVertex:a.effectedVertex||[]}},n._getDrawLayer=function(){var e="_maptalks__internal_layer_drawtool",t=this._map.getLayer(e);return t||(t=new _B(e,{enableSimplify:!1,enableAltitude:this.options.enableAltitude,zIndex:this.options.zIndex}),this._map.addLayer(t)),this._pushLayers(t),t},n._fireEvent=function(e,t){t||(t={}),t=_I({},t),this._geometry&&(t.geometry=this._getRegisterMode().generate(this._geometry,{drawTool:this}),t.tempGeometry=this._geometry),xB.prototype._fireEvent.call(this,e,t)},n._pushLayers=function(e){var t=this;return e?(Array.isArray(e)||(e=[e]),this._layers=this._layers||[],e.forEach((function(e){-1===t._layers.indexOf(e)&&t._layers.push(e)})),this):this},n._outLayers=function(e){var t=this;return e?(Array.isArray(e)||(e=[e]),this._layers=this._layers||[],e.forEach((function(e){for(var n=0,i=t._layers.length;n<i;n++)if(e===t._layers[n]){t._layers.splice(n,1);break}})),this):this},n.setLayerZIndex=function(e){return bI(e)?(this.options.zIndex=e,this._layers=this._layers||[],this._layers.forEach((function(t){t&&t.setZIndex&&t.setZIndex(e)})),this):this},t}(xB);kB.mergeOptions(bB);var CB=function(e){function t(t){var n;return(n=e.call(this,t)||this).drawTool=new kB({mode:"boxZoom",ignoreMouseleave:!1}),n}cA(t,e);var n=t.prototype;return n.addHooks=function(){this.target.on("_mousedown",this._onMouseDown,this)},n.removeHooks=function(){this.target.off("_mousedown",this._onMouseDown,this),this.drawTool.isEnabled()&&this.drawTool.remove()},n._onMouseDown=function(e){this.target.options.boxZoom&&e.domEvent.shiftKey&&this.drawTool.setSymbol(this.target.options.boxZoomSymbol).on("drawend",this._boxZoom,this).addTo(this.target)},n._boxZoom=function(e){var t=this.target;this.drawTool.remove();var n=e.geometry,i=n.getCenter(),r=n.getSymbol(),a=new VN(i,t.locateByPoint(i,r.markerWidth,r.markerHeight),t.getProjection()),o=t.getFitZoom(a);t._animateTo({center:a.getCenter(),zoom:o})},t}(fN);gL.mergeOptions({boxZoom:!0,boxZoomSymbol:{markerType:"rectangle",markerLineWidth:3,markerLineColor:"#1bbc9b",markerLineDasharray:[10,5],markerFillOpacity:.1,markerFill:"#1bbc9b",markerWidth:1,markerHeight:1}}),gL.addOnLoadHook("addHandler","boxZoom",CB);var SB=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){this.target&&this.target.on("_mousemove",this._onMouseMove,this)},n.removeHooks=function(){this.target&&this.target.off("_mousemove",this._onMouseMove,this)},n._onMouseMove=function(e){var t=this.target;if(t.options.autoPanAtEdge){var n=e.containerPoint,i=t.getContainerExtent();if(i){var r,a=n.x,o=n.y,s=i.xmax,l=i.ymax;a<30&&(r=[Math.abs(a-30),0]),o<30&&(r=[0,Math.abs(o-30)]),a+30>s&&(r=[-Math.abs(a+30-s),0]),o+30>l&&(r=[0,-Math.abs(o+30-l)]),r&&t.panBy(r,{duration:1})}}},t}(fN);function TB(e,t,n){return e*(1-n)+t*n}function EB(e){e.stopPropagation(),e.preventDefault()}gL.mergeOptions({autoPanAtEdge:!1}),gL.addOnLoadHook("addHandler","autoPanAtEdge",SB),gL.include({animateTo:function(e,t,n){var i=this;void 0===t&&(t={}),e=_I({},this.getView(),e),SI(t)&&(n=t,t={});var r=this.getProjection(),a=this.getView(),o={},s=!0;for(var l in e)if(EI(e,l)&&!xI(e[l])&&("prjCenter"===l||!xI(a[l])))if(s=!1,"center"===l){var u=new PN(a[l]),c=new PN(e[l]);u.equals(c)||(o.center=[u,c])}else if("prjCenter"===l){var h=new PN(this._getPrjCenter()),d=new PN(e[l]);h.equals(d)||(o.prjCenter=[h,d])}else a[l]!==e[l]&&"around"!==l&&(o[l]=[a[l],e[l]]);if(s)return null;this._animPlayer&&(this._isInternalAnimation?"running"===this._animPlayer.playState&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer)));var f=e.around||new xA(this.width/2,this.height/2),p=this._getRenderer(),m=this._animPlayer=RL.animate(o,{easing:t.easing||"out",duration:t.duration||this.options.zoomAnimationDuration,framer:function(e){p.callInNextFrame(e)},repeat:t.repeat},(function(e){i.isRemoved()?m.finish():("running"===m.playState?(e.styles.center?(i._setPrjCenter(r.project(e.styles.center)),i.onMoving(i._parseEventFromCoord(i.getCenter()))):e.styles.prjCenter&&(i._setPrjCenter(e.styles.prjCenter),i.onMoving(i._parseEventFromCoord(i.getCenter()))),xI(e.styles.zoom)||i.onZooming(e.styles.zoom,f),xI(e.styles.pitch)||i._setPitch(e.styles.pitch),xI(e.styles.bearing)||i._setBearing(e.styles.bearing),i._fireEvent("animating")):"paused"===m.playState&&m!==i._mapAnimPlayer||(m._interupted||(o.center?i._setPrjCenter(r.project(o.center[1])):o.prjCenter&&i._setPrjCenter(o.prjCenter[1]),xI(o.pitch)||i._setPitch(o.pitch[1]),xI(o.bearing)||i._setBearing(o.bearing[1])),i._endAnim(m,o,f,t)),n&&n(e))}),this);return this._startAnim(o,f),m},_animateTo:function(e,t,n){return void 0===t&&(t={}),this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._isInternalAnimation=!0,this._mapAnimPlayer=this.animateTo(e,t,n),delete this._isInternalAnimation,this._mapAnimPlayer},flyTo:function(e,t,n){var i=this;void 0===t&&(t={}),e=_I({},this.getView(),e),this._animPlayer&&(this._isInternalAnimation?"running"===this._animPlayer.playState&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer))),SI(t)&&(n=t,t={}),t=_I({curve:1.42},t);var r=this;function a(e,t){return r.getResolution(t)/r.getResolution(e)}var o=e.around||new xA(this.width/2,this.height/2),s=this.getMinZoom(),l=this.getMaxZoom(),u=this.getProjection(),c=this.getView(),h=c.zoom,d=c.bearing,f=c.pitch,p="zoom"in e?OA(+e.zoom,s,l):h,m="bearing"in e?+e.bearing:d,v="pitch"in e?+e.pitch:f,g=u.project(e.center&&new PN(e.center)||this.getCenter()),y=a(p,h),_=u.project(this.getCenter()),x=g.sub(_),b=t.curve,w=Math.max(this.width,this.height),k=w/y,C=x.mag();if("minZoom"in t){var S=OA(Math.min(t.minZoom,h,p),s,l),T=w/a(S,h);b=Math.sqrt(T/C*2)}var E=b*b;function P(e){var t=(k*k-w*w+(e?-1:1)*E*E*C*C)/(2*(e?k:w)*E*C);return Math.log(Math.sqrt(t*t+1)-t)}function M(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}var A=P(0),R=function(e){return I(A)/I(A+b*e)},O=function(e){return w*((I(A)*(M(t=A+b*e)/I(t))-M(A))/E)/C;var t},N=(P(1)-A)/b;if(Math.abs(C)<1e-6||!isFinite(N)){if(Math.abs(w-k)<1e-6)return this.animateTo(e,t,n);var D=k<w?-1:1;N=Math.abs(Math.log(k/w))/b,O=function(){return 0},R=function(e){return Math.exp(D*b*e)}}var z=this._getRenderer(),L=this._animPlayer=RL.animate({k:[0,1]},{easing:t.easing||"out",duration:t.duration||8,framer:function(e){z.callInNextFrame(e)}},(function(r){if(i.isRemoved())L.finish();else{var a=r.styles.k,s=a*N,l=1/R(s),u={};if(e.center){var c=1===a?g:_.add(x.multi(O(s)));u.prjCenter=[g,c]}if(h!==p){var y=1===a?p:i.getZoomForScale(l,h,!0);u.zoom=[h,y]}if(f!==v){var b=TB(f,v,a);u.pitch=[v,b]}if(d!==m){var w=TB(d,m,a);u.bearing=[m,w]}"running"===L.playState?(u.prjCenter&&(i._setPrjCenter(u.prjCenter[1]),i.onMoving(i._parseEventFromCoord(i.getCenter()))),u.zoom&&i.onZooming(u.zoom[1],o),u.pitch&&i._setPitch(u.pitch[1]),u.bearing&&i._setBearing(u.bearing[1]),i._fireEvent("animating")):"paused"===L.playState&&L!==i._mapAnimPlayer||(L._interupted||(u.prjCenter&&i._setPrjCenter(u.prjCenter[1]),u.pitch&&i._setPitch(u.pitch[1]),u.bearing&&i._setBearing(u.bearing[1])),i._endAnim(L,u,o,t)),n&&n(r)}}));return this._startAnim({center:e.center,zoom:e.zoom!==h,pitch:v!==f,bearing:m!==d},o),this},isAnimating:function(){return!!this._animPlayer},isRotating:function(){return this.isDragRotating()||!!this._animRotating},_endAnim:function(e,t,n,i){delete this._animRotating;var r,a=e._interupted?"animateinterrupted":"animateend";if(e===this._animPlayer&&delete this._animPlayer,e===this._mapAnimPlayer&&delete this._mapAnimPlayer,t.center)r=e._interupted?this.getCenter():t.center[1],this.onMoveEnd(this._parseEventFromCoord(r));else if(t.prjCenter){var o;o=e._interupted?this._getPrjCenter():t.prjCenter[1];var s=this._parseEventFromCoord(this.getProjection().unproject(o));s.point2d=this._prjToPoint(o),this.onMoveEnd(s)}xI(t.zoom)||(e._interupted?this.onZoomEnd(this.getZoom()):i.wheelZoom?this.onZooming(t.zoom[1],n):this.onZoomEnd(t.zoom[1])),a&&this._fireEvent(a),xI(t.pitch)||this.getPitch()||this.getRenderer().setToRedraw(),i.wheelZoom||this._resumePrev(e)},_startAnim:function(e,t){this._animPlayer&&((e.center||e.prjCenter)&&this.onMoveStart(),e.zoom&&!this.isZooming()&&this.onZoomStart(e.zoom[1],t),(e.pitch||e.bearing)&&(this._animRotating=!0),this._fireEvent("animatestart"),this._animPlayer.play())},_stopAnim:function(e){e&&(delete this._animRotating,"finished"!==e.playState&&(e._interupted=!0,e.cancel()),e===this._animPlayer&&delete this._animPlayer,e===this._mapAnimPlayer&&delete this._mapAnimPlayer)},_resumePrev:function(e){if(this._prevAnimPlayer){var t=this._prevAnimPlayer;"paused"!==t.playState&&delete this._prevAnimPlayer,e!==t&&(this._animPlayer=t,t.play())}}});var PB=["dragstart","dragenter","dragend","dragleave","dragover"].join(" ").toString(),MB="mousedown mouseup mouseover mouseout mouseenter mouseleave mousemove click dblclick contextmenu keypress touchstart touchmove touchend drop ";function IB(e,t,n,i,r){var a=1/Math.tan(t/2),o=1/(i-r);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+i)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*i*o,e[15]=0,e}function AB(e,t,n){var i,r,a,o,s,l,u,c,h,d,f,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=i=t[0],e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=i*m+s*v+h*g+t[12],e[13]=r*m+l*v+d*g+t[13],e[14]=a*m+u*v+f*g+t[14],e[15]=o*m+c*v+p*g+t[15]),e}function RB(e,t,n){var i=n[0],r=n[1],a=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function OB(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],_=n[0],x=n[1],b=n[2],w=n[3];return e[0]=_*i+x*s+b*h+w*m,e[1]=_*r+x*l+b*d+w*v,e[2]=_*a+x*u+b*f+w*g,e[3]=_*o+x*c+b*p+w*y,e[4]=(_=n[4])*i+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,e[5]=_*r+x*l+b*d+w*v,e[6]=_*a+x*u+b*f+w*g,e[7]=_*o+x*c+b*p+w*y,e[8]=(_=n[8])*i+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,e[9]=_*r+x*l+b*d+w*v,e[10]=_*a+x*u+b*f+w*g,e[11]=_*o+x*c+b*p+w*y,e[12]=(_=n[12])*i+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,e[13]=_*r+x*l+b*d+w*v,e[14]=_*a+x*u+b*f+w*g,e[15]=_*o+x*c+b*p+w*y,e}function NB(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15],y=n*s-i*o,_=n*l-r*o,x=n*u-a*o,b=i*l-r*s,w=i*u-a*s,k=r*u-a*l,C=c*m-h*p,S=c*v-d*p,T=c*g-f*p,E=h*v-d*m,P=h*g-f*m,M=d*g-f*v,I=y*M-_*P+x*E+b*T-w*S+k*C;return I?(e[0]=(s*M-l*P+u*E)*(I=1/I),e[1]=(r*P-i*M-a*E)*I,e[2]=(m*k-v*w+g*b)*I,e[3]=(d*w-h*k-f*b)*I,e[4]=(l*T-o*M-u*S)*I,e[5]=(n*M-r*T+a*S)*I,e[6]=(v*x-p*k-g*_)*I,e[7]=(c*k-d*x+f*_)*I,e[8]=(o*P-s*T+u*C)*I,e[9]=(i*T-n*P-a*C)*I,e[10]=(p*w-m*x+g*y)*I,e[11]=(h*x-c*w-f*y)*I,e[12]=(s*S-o*E-l*C)*I,e[13]=(n*E-i*S+r*C)*I,e[14]=(m*_-p*b-v*y)*I,e[15]=(c*b-h*_+d*y)*I,e):null}function DB(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zB(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function LB(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e}function BB(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function FB(e){var t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)}function jB(e,t){var n=t[0],i=t[1],r=t[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function HB(e,t,n){var i=t[0],r=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=r*l-a*s,e[1]=a*o-i*l,e[2]=i*s-r*o,e}function VB(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.hypot?Math.hypot(n,i,r):function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}(n,i,r)}function UB(e,t,n){var i=t[0],r=t[1],a=t[2],o=1/(n[3]*i+n[7]*r+n[11]*a+n[15]);return e[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])*o,e[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])*o,e[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])*o,e}gL.include({_registerDomEvents:function(){var e=this._panels.mapWrapper||this._containerDOM;sO(e,MB,this._handleDOMEvent,this),sO(e,PB,EB,this)},_removeDomEvents:function(){var e=this._panels.mapWrapper||this._containerDOM;lO(e,MB,this._handleDOMEvent),lO(e,PB,EB)},_handleDOMEvent:function(e){if(e&&"drop"===e.type){e.stopPropagation(),e.preventDefault();var t=this._parseEvent(e,e.type);return t=_I({},t,{dataTransfer:e.dataTransfer}),void this._fireEvent(e.type,t)}var n=this.options.clickTimeThreshold,i=e.type;if(!kO(i)||lA.isTest||!CO(this,this.options.mousemoveThrottleTime)){var r="mousedown"===i||"touchstart"===i&&(!e.touches||1===e.touches.length);r&&(this._domMouseDownTime=yI(),this._domMouseDownView=this.getView());var a="contextmenu"===i&&function(e){if(!e._domMouseDownView)return!0;var t=e.getView(),n=e._domMouseDownView;return t.bearing!==n.bearing||t.pitch!==n.pitch}(this);if("contextmenu"===i){cO(e);var o=this._domMouseDownTime;yI()-o<=n&&!a&&this._fireDOMEvent(this,e,"dom:"+e.type)}else this._fireDOMEvent(this,e,"dom:"+e.type);if(!this._ignoreEvent(e)&&!this._isEventOutMap(e)){var s,l=!1;if(r)this._mouseDownTime=yI();else if("click"===i||"touchend"===i||"contextmenu"===i){if(!this._mouseDownTime)return;var u=this._mouseDownTime;if(delete this._mouseDownTime,yI()-u>n){if("click"===i||"contextmenu"===i)return}else if("contextmenu"===i){if(a)return}else"touchend"===i&&(l=!0)}l&&(this._clickTime&&yI()-this._clickTime<=n?(delete this._clickTime,s="dblclick",this._fireDOMEvent(this,e,"dom:dblclick")):(this._clickTime=yI(),s="click",this._fireDOMEvent(this,e,"dom:click"))),this._ignoreEvent(e)||this._isEventOutMap(e)||(this._fireDOMEvent(this,e,i),s&&this._fireDOMEvent(this,e,s))}}},_ignoreEvent:function(e){if(!e||!this._panels.control)return!1;var t,n=e.srcElement||e.target;if(n)for(;n&&n!==this._containerDOM;){if(n.className&&n.className.indexOf&&(n.className.indexOf("maptalks-control")>=0||n.className.indexOf("maptalks-ui")>=0&&t&&!t.eventsPropagation))return!0;t=n,n=n.parentNode}return!1},_isEventOutMap:function(e){if(this.getPitch()>this.options.maxVisualPitch){var t=pO(this._getActualEvent(e),this._containerDOM);if(!this.getContainerExtent().contains(t))return!0}return!1},_parseEvent:function(e,t){if(!e)return null;var n={domEvent:e};if("keypress"!==t){var i=this._getActualEvent(e);if(i&&void 0!==i.clientX){var r=pO(i,this._containerDOM);n=_I(n,{containerPoint:r,viewPoint:this.containerPointToViewPoint(r)});var a=this.options.maxVisualPitch;(this.getPitch()<=a||r.y>=this.height-this._getVisualHeight(a))&&(n=_I(n,{coordinate:this.containerPointToCoord(r),point2d:this._containerPointToPoint(r)}))}}return n},_parseEventFromCoord:function(e){var t=this.coordToContainerPoint(e);return{coordinate:e,containerPoint:t,viewPoint:this.containerPointToViewPoint(t),point2d:this.coordToPoint(e)}},_getActualEvent:function(e){return e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e},_fireDOMEvent:function(e,t,n){var i=this;if(!this.isRemoved()){var r=this._parseEvent(t,n);kO(n)?this.getRenderer().callInNextFrame((function(){i._fireEvent(r.domEvent&&r.domEvent._cancelBubble?"_"+n:n,r)})):this._fireEvent(n,r)}},_getEventParams:function(e){var t={domEvent:e},n=e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e;if(n){var i=pO(n,this._containerDOM);t.coordinate=this.containerPointToCoordinate(i),t.containerPoint=i,t.viewPoint=this.containerPointToViewPoint(i),t.pont2d=this._containerPointToPoint(i)}return t}}),gL.addOnLoadHook("_registerDomEvents"),gL.include({isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},requestFullScreen:function(e){return this._fireEvent("fullscreenstart"),this._requestFullScreen(e||this._containerDOM),this._fireEvent("fullscreenend"),this},cancelFullScreen:function(){return this._cancelFullScreen(),this._fireEvent("cancelfullscreen"),this},_requestFullScreen:function(e){if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullScreen)e.webkitRequestFullScreen();else if(e.msRequestFullScreen)e.msRequestFullScreen();else{var t="fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,width="+(screen.availWidth-8)+",height="+(screen.availHeight-45);null!==window.open(location.href,"_blank",t)&&(window.opener=null,window.close())}},_cancelFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():null!==window.open(location.href,"_blank","fullscreen=no,status=yes,resizable=yes,scrollbars=no,titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes")&&(window.opener=null,window.close())}}),gL.include({panTo:function(e,t,n){if(void 0===t&&(t={}),!e)return this;if(SI(t)&&(n=t,t={}),e=new PN(e),void 0===t.animation||t.animation){var i=this.getProjection().project(e);return this._panAnimation(i,t.duration,n)}return this.setCenter(e),this},_panTo:function(e,t){return void 0===t&&(t={}),void 0===t.animation||t.animation?this._panAnimation(e,t.duration):(this.onMoveStart(),this._setPrjCenter(e),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this)},panBy:function(e,t,n){if(void 0===t&&(t={}),!e)return this;if(SI(t)&&(n=t,t={}),e=new xA(e),this.getContainerExtent().ymin>0&&e.y>30){var i=e.y;e.y=30,e.x=30*e.x/i,console.warn("offset is limited to panBy when pitch is above maxPitch")}if(void 0===t.animation||t.animation){e=e.multi(-1);var r=this._containerPointToPrj(new xA(this.width/2+e.x,this.height/2+e.y));this._panAnimation(r,t.duration,n)}else{this.onMoveStart(),this._offsetCenterByPixel(e);var a=this.containerPointToCoord(new xA(this.width/2,this.height/2));this.onMoveEnd(this._parseEventFromCoord(a))}return this},_panAnimation:function(e,t,n){return this._animateTo({prjCenter:e},{duration:t||this.options.panAnimationDuration},n)}}),Jz.fromJSON=function(e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var r=Jz.fromJSON(e[n]);Array.isArray(e)?t=t.concat(r):t.push(r)}return t}return e&&!e.feature?YL.toGeometry(e):(e.subType?(a=Jz.getJSONClass(e.subType).fromJSON(e),xI(e.feature.id)||a.setId(e.feature.id)):(a=YL.toGeometry(e.feature),e.options&&a.config(e.options)),e.symbol&&a.setSymbol(e.symbol),e.infoWindow&&a.setInfoWindow(e.infoWindow),a);var a},nL.fromJSON=function(e){if(!e)return null;var t=e.type,n=nL.getJSONClass(t);if(!n||!n.fromJSON)throw new Error("unsupported layer type:"+t);return n.fromJSON(e)},gL.include({JSON_VERSION:"1.0",toJSON:function(e){e||(e={});var t={jsonVersion:this.JSON_VERSION,version:this.VERSION,extent:this.getExtent().toJSON()};t.options=this.config(),t.options.center=this.getCenter(),t.options.zoom=this.getZoom(),t.options.bearing=this.getBearing(),t.options.pitch=this.getPitch();var n=this.getBaseLayer();(xI(e.baseLayer)||e.baseLayer)&&n&&(t.baseLayer=n.toJSON(e.baseLayer));var i={};e.clipExtent&&(i.clipExtent=!0===e.clipExtent?this.getExtent():e.clipExtent);var r=[];if(xI(e.layers)||e.layers&&!Array.isArray(e.layers)){for(var a=this.getLayers(),o=0,s=a.length;o<s;o++)if(a[o].toJSON){var l=_I({},kI(e.layers)?e.layers:{},i);r.push(a[o].toJSON(l))}t.layers=r}else if(NA(e.layers)){for(var u=e.layers,c=0;c<u.length;c++){var h=u[c],d=this.getLayer(h.id);if(d.toJSON){var f=_I({},h.options,i);r.push(d.toJSON(f))}}t.layers=r}else t.layers=[];return t}}),gL.fromJSON=function(e,t,n){if(!e||!t)return null;n||(n={});var i=new gL(e,t.options);if(xI(n.baseLayer)||n.baseLayer){var r=nL.fromJSON(t.baseLayer);r&&i.setBaseLayer(r)}if(xI(n.layers)||n.layers){for(var a=[],o=t.layers,s=0;s<o.length;s++){var l=nL.fromJSON(o[s]);a.push(l)}i.addLayer(a)}return i},gL.include({computeLength:function(e,t){if(!this.getProjection())return null;var n=new PN(e),i=new PN(t);return n.equals(i)?0:this.getProjection().measureLength(n,i)},computeGeometryLength:function(e){return e._computeGeodesicLength(this.getProjection())},computeGeometryArea:function(e){return e._computeGeodesicArea(this.getProjection())},identify:function(e,t){var n=new PN((e=e||{}).coordinate);return this._identify(e,t,(function(t){return t.identify(n,e)}))},identifyAtPoint:function(e,t){var n=e.includeInternals,i=e.tolerance,r=new xA((e=e||{}).containerPoint),a=this.containerPointToCoord(r);return this._identify(e,t,(function(t){var r,o=e.containerPoint;return n&&!xI(t.options.geometryEventTolerance)&&(e.tolerance=e.tolerance||0,e.tolerance+=t.options.geometryEventTolerance),t._hasGeoListeners&&n&&e.eventTypes.indexOf("mousemove")>=0&&!t._hasGeoListeners(e.eventTypes)?[]:(r=t.identifyAtPoint?t.identifyAtPoint(o,e):a&&t.identify?t.identify(a,e):[],n&&(xI(i)?delete e.tolerance:e.tolerance=i),r&&r.length||(t.fire("identifyempty",e),t.getLayers&&SI(t.getLayers)&&(t.getLayers()||[]).filter((function(e){return e})).forEach((function(t){t.fire("identifyempty",e)}))),r)}))},_identify:function(e,t,n){var i=e.layers;if(!NA(i))return this;for(var r=e.eventTypes,a=[],o=0,s=i.length;o<s;o++)CI(i[o])?a.push(this.getLayer(i[o])):a.push(i[o]);r&&(a=a.filter((function(e){return!e._hasGeoListeners||e._hasGeoListeners(r)})));for(var l=[],u=a.length-1;u>=0&&!(e.count&&l.length>=e.count);u--){var c=a[u];if(c&&c.getMap()&&(e.includeInvisible||c.isVisible())&&(e.includeInternals||!(c.getId().indexOf("_maptalks__internal_layer_")>=0))){var h=n(c),d=c.getId();if(h)if(Array.isArray(h)){for(var f=0;f<h.length;f++)h[f]&&!h[f].getLayer&&xI(h[f].layer)&&(h[f].layer=d);TA(l,h)}else!h.getLayer&&xI(h.layer)&&(h.layer=d),l.push(h)}}return t.call(this,l),this}}),gL.include({_zoom:function(e,t){this.options.zoomable&&!this.isZooming()&&(t=this._checkZoomOrigin(t),e=this._checkZoom(e),this.onZoomStart(e,t),this._frameZoom=this.getZoom(),this.onZoomEnd(e,t))},_zoomAnimation:function(e,t,n){this.options.zoomable&&!this.isZooming()&&(e=this._checkZoom(e),this.getZoom()!==e&&(t=this._checkZoomOrigin(t),this._startZoomAnim(e,t,n)))},_checkZoomOrigin:function(e){return e&&!this.options.zoomInCenter||(e=new xA(this.width/2,this.height/2)),this.options.zoomOrigin&&(e=new xA(this.options.zoomOrigin)),e},_startZoomAnim:function(e,t,n){xI(n)&&(n=1);var i=this._getResolution(this._startZoomVal)/this._getResolution(e),r=this.options.zoomAnimationDuration*Math.abs(i-n)/Math.abs(i-1);this._frameZoom=this._startZoomVal,this._animateTo({zoom:e,around:t},{continueOnViewChanged:!0,duration:r})},onZoomStart:function(e,t){this.options.zoomable&&!this.isZooming()&&(this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),delete this.cameraZenithDistance,this._zooming=!0,this._startZoomVal=this.getZoom(),this._startZoomCoord=this._containerPointToPrj(t),this._fireEvent("zoomstart",{from:this._startZoomVal,to:e}))},onZooming:function(e,t,n){if(this.options.zoomable&&this._frameZoom!==e){xI(n)&&(n=1),this._zoomTo(e,t);var i=this.getResolution(e),r=this.getResolution(this._startZoomVal)/i/n,a=this._prjToContainerPoint(this._startZoomCoord,this._startZoomVal),o=this.getViewPoint();if(!this.isRotating()&&!a.equals(t)&&1!==r){var s=this.getPitch(),l=a._sub(t)._multi(1/(1-r));s&&(l.y/=Math.cos(s*Math.PI/180)),t=t.add(l)}var u={view:[r,0,0,r,(t.x-o.x)*(1-r),(t.y-o.y)*(1-r)]},c=this.getDevicePixelRatio();1!==c&&(t=t.multi(c)),u.container=[r,0,0,r,t.x*(1-r),t.y*(1-r)],this._fireEvent("zooming",{from:this._startZoomVal,to:e,origin:t,matrix:u}),this._frameZoom=e}},onZoomEnd:function(e,t){if(this.options.zoomable){var n=this._startZoomVal;this._zoomTo(e,t),this._zooming=!1,this._getRenderer().onZoomEnd(),this._suppressRecenter||this._recenterOnTerrain(),this._fireEvent("zoomend",{from:n,to:e}),this._verifyExtent(this._getPrjCenter())||this._panTo(this._prjMaxExtent.getCenter())}},_zoomTo:function(e,t){this._zoomLevel=e,this._calcMatrices(),t&&this._setPrjCoordAtContainerPoint(this._startZoomCoord,t)},_checkZoom:function(e){var t=this.getMaxZoom(),n=this.getMinZoom();return e<n&&(e=n),e>t&&(e=t),e}});var qB,GB,WB,ZB,XB,KB,YB,JB,QB,$B=Math.PI/180,eF=new PN(0,0),tF=new xA(0,0);function nF(){return DB(new Array(16))}gL.include({getFov:function(){return this._fov||(this._fov=.6435011087932844),this._fov/$B},setFov:function(e){if(this.isZooming())return this;if(e=Math.max(.01,Math.min(60,e)),this._fov===e)return this;var t=this.getFov();return this._fov=e*$B,this._calcMatrices(),this._renderLayers(),this._fireEvent("fovchange",{from:t,to:this.getFov()}),this},getBearing:function(){return this._angle?-this._angle/$B:0},setBearing:function(e){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setBearing(e)},_setBearing:function(e){if(lA.ie9)throw new Error("map can't rotate in IE9.");var t=-RA(e,-180,180)*$B;if(this._angle===t)return this;var n=this.getBearing();return this._fireEvent("rotatestart",{from:n,to:t}),this._angle=t,this._calcMatrices(),this._renderLayers(),this._fireEvent("rotate",{from:n,to:t}),this._fireEvent("rotateend",{from:n,to:t}),this},getPitch:function(){return this._pitch?this._pitch/Math.PI*180:0},setPitch:function(e){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setPitch(e)},_setPitch:function(e){if(lA.ie9)throw new Error("map can't tilt in IE9.");var t=OA(e,0,this.options.maxPitch)*$B;if(this._pitch===t)return this;var n=this.getPitch();return this._fireEvent("pitchstart",{from:n,to:t}),this._pitch=t,this._calcMatrices(),this._renderLayers(),this._fireEvent("pitch",{from:n,to:t}),this._fireEvent("pitchend",{from:n,to:t}),this},setCameraMovements:function(e,t){var n=this;if(!Array.isArray(e)||!e.length)return this;if(this.setView({center:e[0].center,zoom:e[0].zoom,pitch:e[0].pitch,bearing:e[0].bearing}),1===e.length)return this;var i=1,r=function(a){if("finished"===a.state.playState){++i==e.length-1&&(r=null);var o=e[i];o.duration=o.timestamp-e[i-1].timestamp,t&&t.autoRotate&&(o.bearing=(l=o.center,u=MI((s=e[i-1].center)[0]),c=MI(l[0]),h=MI(s[1]),d=MI(l[1]),f=Math.sin(c-u)*Math.cos(d),p=Math.cos(h)*Math.sin(d)-Math.sin(h)*Math.cos(d)*Math.cos(c-u),II(Math.atan2(f,p)))),n._setCameraMovement(o,r)}var s,l,u,c,h,d,f,p};2===e.length&&(r=null);var a=this.getBearing();return this._setCameraMovement(uA({bearing:a},e[i],{duration:e[i].timestamp-e[i-1].timestamp}),r),{play:function(){n._animPlayer.play()},pause:function(){n._animPlayer.pause()},cancel:function(){n._animPlayer.cancel()},finish:function(){n._animPlayer.finish()},reverse:function(){n._animPlayer.reverse()}}},_setCameraMovement:function(e,t){this.animateTo({zoom:e.zoom,center:e.center,pitch:e.pitch,bearing:e.bearing},{duration:e.duration,easing:"out"},t)},setCameraPosition:function(e){var t=e.position,n=e.pitch,i=e.bearing,r=(this.centerAltitude||0)*this._meterToGLPoint,a=n*$B,o=(t[2]*this._meterToGLPoint-r)/Math.cos(a),s=Math.sin(a)*o,l=this._getZoomFromCameraToCenterDistance(o+r),u=RA(i,-180,180)*$B,c=this.getGLRes(),h=new PN(t[0],t[1]),d=this.coordToPointAtRes(h,c),f=new xA(0,0);f.x=d.x+s*Math.sin(u),f.y=d.y+s*Math.cos(u);var p=this._pointToPrjAtRes(f,this.getGLRes());return this._setPrjCenter(p),this.setView({bearing:i,pitch:n,zoom:l}),this},_getZoomFromCameraToCenterDistance:function(e){for(var t=e*this._getFovRatio()*2/(this.height||1)*this.getGLRes(),n=this._getResolutions(),i=0;i<n.length-1;i++){if(n[i]===t)return i;if(n[i+1]===t)return i+1;if(t<n[i]&&t>n[i+1])return(i=(t-n[i])/(n[i+1]-n[i])+i)-1}return i},isTransforming:function(){return!(!this._pitch&&!this._angle)},getFrustumAltitude:function(){return this._frustumAltitude},_calcFrustumAltitude:function(){var e=90-this.getPitch(),t=this.getFov()/2,n=this.cameraPosition?this.cameraPosition[2]:0;if(t<=e)return n;t=Math.PI*t/180;var i=new xA(this.cameraPosition).distanceTo(new xA(this.cameraLookAt)),r=n*Math.tan(2*t);return n+Math.tan(t)*(i+r)},_pointToContainerPoint:function(e,t,n,i){void 0===n&&(n=0);var r=this._getResolution(t);return this._pointAtResToContainerPoint(e,r,n,i)},_pointAtResToContainerPoint:function(e,t,n,i){void 0===n&&(n=0),i||(i=new xA(0,0)),e=this._pointAtResToPoint(e,t,i);var r,a=this.isTransforming();return a||n||(r=this._prjToPoint(this._getPrjCenter(),void 0,eF)),this._toContainerPoint(i,a,n,r),i},_pointsAtResToContainerPoints:function(e,t,n,i){void 0===n&&(n=[]),void 0===i&&(i=[]);var r=this.getPitch(),a=this.getBearing(),o=t/this._getResolution();if(0===r&&0===a&&!function(e){if(bI(e))return 0!==e;if(Array.isArray(e)&&e.length>0)for(var t=0,n=e.length;t<n;t++)if(bI(e[t])&&0!==e[t])return!0;return!1}(n)){var s=this._get2DExtent(),l=s.xmin,u=s.ymin,c=s.xmax,h=s.ymax;if(c>l&&h>u){for(var d=this.getSize(),f=d.height,p=(c-l)/d.width,m=(h-u)/f,v=0,g=e.length;v<g;v++)if(e[v]){var y=i[v];y.x=e[v].x,y.y=e[v].y,y._multi(o),y.x=(y.x-l)*p,y.y=f-(y.y-u)*m}else i[v]=null;return i}}for(var _=Array.isArray(n),x=this.isTransforming(),b=this._prjToPoint(this._getPrjCenter(),void 0,eF),w=0,k=e.length;w<k;w++)if(e[w]){var C=i[w];C.x=e[w].x,C.y=e[w].y,C._multi(o),this._toContainerPoint(C,x,_?n[w]||0:n,b)}else i[w]=null;return i},_toContainerPoint:(QB=[0,0,0],function(e,t,n,i){var r=this.width/2,a=this.height/2;if(t||n){this._altitudeScale||(this._altitudeScale=this.altitudeToPoint(100,this.getGLRes())/100);var o=this._glScale;LB(QB,e.x*o,e.y*o,n*this._altitudeScale);var s=this._projIfBehindCamera(QB,this.cameraPosition,this.cameraForward);UB(s,s,this.projViewMatrix),e.x=s[0]*r+r,e.y=-s[1]*a+a}else e._sub(i.x,i.y),e.set(e.x,-e.y),e._add(r,a)}),_projIfBehindCamera:(KB=new Array(3),YB=new Array(3),JB=new Array(3),function(e,t,n){BB(KB,e,t);var i=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(n,KB);return i<=0&&(function(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}(YB,n,1.01*i),function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2]}(e,t,BB(JB,KB,YB))),e}),_containerPointToPoint:function(e,t,n){var i=this._getResolution(t);return this._containerPointToPointAtRes(e,i,n)},_containerPointToPointAtRes:(WB=[0,0,0],ZB=[0,0,0,1],XB=[0,0,0,1],function(e,t,n){if(this.isTransforming()){var i=this.width/2||1,r=this.height/2||1;LB(WB,(e.x-i)/i,(r-e.y)/r,0),LB(ZB,WB[0],WB[1],0),LB(XB,WB[0],WB[1],1),ZB[3]=XB[3]=1,UB(ZB,ZB,this.projViewMatrixInverse),UB(XB,XB,this.projViewMatrixInverse);var a=ZB[1],o=XB[1],s=ZB[2],l=XB[2],u=s===l?0:(0-s)/(l-s),c=AA(ZB[0],XB[0],u),h=AA(a,o,u);return n?(n.x=c,n.y=h):n=new xA(c,h),n._multi(1/this._glScale),this._getResolution()===t?n:this._pointToPointAtRes(n,t,n)}var d=this._prjToPointAtRes(this._getPrjCenter(),t,n),f=this._getResolution()/t;return d._add(f*(e.x-this.width/2),-f*(e.y-this.height/2))}),_calcMatrices:(GB=nF(),function(){delete this._mapRes,delete this._mapGlRes,delete this._mapExtent2D,delete this._mapGlExtent2D;var e=this.getSize(),t=e.width||1,n=e.height||1;this._glScale=this.getGLScale();var i=this._getCameraWorldMatrix(),r=this.getFov()*Math.PI/180,a=this._getCameraFar(r,this.getPitch());this.cameraFar=a,this.cameraNear=this.cameraCenterDistance/20;var o=this.projMatrix||nF();IB(o,r,t/n,this.cameraNear,a),this.projMatrix=o,this.viewMatrix=NB(this.viewMatrix||nF(),i),this.projViewMatrix=OB(this.projViewMatrix||nF(),o,this.viewMatrix),this._calcCascadeMatrixes(),this.projViewMatrixInverse=OB(this.projViewMatrixInverse||nF(),i,NB(GB,o)),this.domCssMatrix=this._calcDomMatrix(),this._frustumAltitude=this._calcFrustumAltitude(),this._mapRes=this._getResolution(),this._mapGlRes=this.getGLRes(),this._mapExtent2D=this._get2DExtent(),this._mapGlExtent2D=this._get2DExtentAtRes(this._mapGlRes)}),_getCameraFar:function(e,t){var n=this.cameraCenterDistance=VB(this.cameraPosition,this.cameraLookAt),i=n,r=(this.options.cameraInfiniteFar?10:4)*n;if(t>0&&(t=t*Math.PI/180,2/Math.PI-t>e/2)){var a=Math.tan(e/2),o=Math.tan(t);r=Math.max(n*a/(1/o-a),r)}return(i+=r)+1},_calcCascadeMatrixes:function(){var e=nF();function t(t,n,i){var r=this.width,a=this.height,o=this.getFov()*Math.PI/180,s=this._getCameraFar(o,n),l=this.cameraCenterDistance;return s=l+(s-l)/Math.cos((90-n)*Math.PI/180)*Math.cos((90-t)*Math.PI/180),IB(e,o,r/a,.1,s),OB(i,e,this.viewMatrix)}return function(){var e=this.getPitch(),n=this.options.cascadePitches[0],i=this.options.cascadePitches[1],r=this.cascadeFrustumMatrix0=this.cascadeFrustumMatrix0||nF(),a=this.cascadeFrustumMatrix1=this.cascadeFrustumMatrix1||nF();e>n?t.call(this,e,n,r):zB(this.cascadeFrustumMatrix0,this.projViewMatrix),e>i?t.call(this,e,i,a):zB(this.cascadeFrustumMatrix1,this.cascadeFrustumMatrix0)}}(),_calcDomMatrix:function(){var e=nF(),t=nF(),n=[1,-1,1],i=[0,0,0];return function(){var r=this.width||1,a=this.height||1,o=.5/Math.tan(this._fov/2)*a;return RB(e,this.projMatrix,n),AB(e,e,LB(i,0,0,-o)),this._pitch&&function(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+u*i,e[5]=o*r+c*i,e[6]=s*r+h*i,e[7]=l*r+d*i,e[8]=u*r-a*i,e[9]=c*r-o*i,e[10]=h*r-s*i,e[11]=d*r-l*i}(e,e,this._pitch),this._angle&&function(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],d=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+u*i,e[1]=o*r+c*i,e[2]=s*r+h*i,e[3]=l*r+d*i,e[4]=u*r-a*i,e[5]=c*r-o*i,e[6]=h*r-s*i,e[7]=d*r-l*i}(e,e,this._angle),DB(t),RB(t,t,LB(i,r/2,-a/2,1)),OB(this.domCssMatrix||nF(),t,e)}}(),_getFovZ:function(e){var t=this.getGLScale(e),n=this._getFovRatio();return t*(this.height||1)/2/n},_getCameraWorldMatrix:(qB={},function(){var e=this.getGLRes();this._meterToGLPoint||(this._meterToGLPoint=this.distanceToPointAtRes(100,0,e).x/100);var t=this._prjToPointAtRes(this._prjCenter,e,tF),n=(this.centerAltitude||0)*this._meterToGLPoint;this.cameraLookAt=LB(this.cameraLookAt||[0,0,0],t.x,t.y,n);var i=this.getPitch()*$B,r=this.getBearing()*$B,a=this._getFovZ(),o=(void 0===this.cameraZenithDistance?a:this.cameraZenithDistance)-n,s=o*Math.cos(i),l=Math.sin(i)*o,u=t.x-l*Math.sin(r),c=t.y-l*Math.cos(r);this.cameraPosition=LB(this.cameraPosition||[0,0,0],u,c,s+n),this.cameraToCenterDistance=a;var h=l||1,d=this.cameraUp=LB(this.cameraUp||[0,0,0],Math.sin(r)*h,Math.cos(r)*h,0),f=this.cameraWorldMatrix=this.cameraWorldMatrix||nF();!function(e,t,n,i){var r=[0,0,0],a=[0,0,0],o=[0,0,0];BB(o,t,n),0===FB(o)&&(o[2]=1),jB(o,o),HB(r,i,o),0===FB(o)&&(1===Math.abs(i[2])?o[0]+=1e-4:o[2]+=1e-4,jB(o,o),HB(r,i,o)),jB(r,r),HB(a,o,r),e[0]=r[0],e[4]=a[0],e[8]=o[0],e[1]=r[1],e[5]=a[1],e[9]=o[1],e[2]=r[2],e[6]=a[2],e[10]=o[2]}(f,this.cameraPosition,this.cameraLookAt,d);var p,m,v=this.cameraForward||[0,0,0];return BB(v,this.cameraLookAt,this.cameraPosition),this.cameraForward=jB(v,v),function(e,t){var n,i=t[0],r=t[4],a=t[8],o=t[1],s=t[5],l=t[9],u=t[2],c=t[6],h=t[10],d=i+s+h;d>0?(n=.5/Math.sqrt(d+1),e.w=.25/n,e.x=(c-l)*n,e.y=(a-u)*n,e.z=(o-r)*n):i>s&&i>h?(n=2*Math.sqrt(1+i-s-h),e.w=(c-l)/n,e.x=.25*n,e.y=(r+o)/n,e.z=(a+u)/n):s>h?(n=2*Math.sqrt(1+s-i-h),e.w=(a-u)/n,e.x=(r+o)/n,e.y=.25*n,e.z=(l+c)/n):(n=2*Math.sqrt(1+h-i-s),e.w=(o-r)/n,e.x=(a+u)/n,e.y=(l+c)/n,e.z=.25*n)}(qB,f),function(e,t){var n=e,i=t.x,r=t.y,a=t.z,o=t.w,s=i+i,l=r+r,u=a+a,c=i*s,h=i*l,d=i*u,f=r*l,p=r*u,m=a*u,v=o*s,g=o*l,y=o*u;n[0]=1-(f+m),n[4]=h-y,n[8]=d+g,n[1]=h+y,n[5]=1-(c+m),n[9]=p-v,n[2]=d-g,n[6]=p+v,n[10]=1-(c+f),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(f,qB),(m=f)[12]=(p=this.cameraPosition)[0],m[13]=p[1],m[14]=p[2],f}),updateCenterAltitude:function(){this.getRenderer().setToRedraw(),!this.centerAltitude&&this._hasAltitudeLayer()&&(this.centerAltitude=0),this._recenterOnTerrain()},_recenterOnTerrain:function(){if(void 0!==this.centerAltitude){var e=this._queryTerrainByProjCoord(this._prjCenter);xI(e)&&this._hasAltitudeLayer()&&(e=this.centerAltitude);var t=e||0,n=this.getPitch()*$B,i=this.getBearing()*$B,r=(t-this.centerAltitude)*this._meterToGLPoint,a=this._getFovZ(),o=(void 0===this.cameraZenithDistance?a:this.cameraZenithDistance)-this.centerAltitude*this._meterToGLPoint-r/Math.cos(n),s=this.cameraPosition,l=Math.sin(n)*o,u=tF;u.x=s[0]+l*Math.sin(i),u.y=s[1]+l*Math.cos(i);var c=t*this._meterToGLPoint;this.cameraZenithDistance=(s[2]-c)/Math.cos(n)+c,this.centerAltitude=t;var h=this.pointAtResToCoordinate(u,this.getGLRes(),eF);this._eventSilence=!0,this._suppressRecenter=!0,this.setCenter(h),delete this._suppressRecenter,delete this._eventSilence,xI(e)&&delete this.centerAltitude}},_queryTerrainByProjCoord:function(e){for(var t=this._getLayers(),n=0;n<t.length;n++)if(t[n].queryTerrainByProjCoord)return t[n].queryTerrainByProjCoord(e)[0];return 0},_hasAltitudeLayer:function(){for(var e=this._getLayers(),t=0;t<e.length;t++)if(e[t].getTerrainLayer&&e[t].getTerrainLayer())return!0;return!1},_getFovRatio:function(){var e=this.getFov();return Math.tan(e/2*$B)},_renderLayers:function(){this.isInteracting()||this._getLayers().forEach((function(e){if(e){var t=e._getRenderer();t&&t.setToRedraw&&t.setToRedraw()}}))}}),gL.include({_onViewChange:function(e){this._viewHistory||(this._viewHistory=[],this._viewHistoryPointer=0);for(var t=this._getCurrentView(),n=this._viewHistory.length-1;n>=0;n--)if(jA(e,this._viewHistory[n]))return this._viewHistoryPointer=n,void this._fireViewChange(t,e);this._viewHistoryPointer<this._viewHistory.length-1&&this._viewHistory.splice(this._viewHistoryPointer+1),this._viewHistory.push(e);var i=this.options.viewHistoryCount;i>0&&this._viewHistory.length>i&&this._viewHistory.splice(0,this._viewHistory.length-i),this._viewHistoryPointer=this._viewHistory.length-1,this._fireViewChange(t,e)},zoomToPreviousView:function(e){if(void 0===e&&(e={}),!this.hasPreviousView())return null;var t=this._viewHistory[--this._viewHistoryPointer];return this._zoomToView(t,e),t},hasPreviousView:function(){return!(!this._viewHistory||0===this._viewHistoryPointer)},zoomToNextView:function(e){if(void 0===e&&(e={}),!this.hasNextView())return null;var t=this._viewHistory[++this._viewHistoryPointer];return this._zoomToView(t,e),t},hasNextView:function(){return!(!this._viewHistory||this._viewHistoryPointer===this._viewHistory.length-1)},_zoomToView:function(e,t){var n=this,i=this.getView();t.animation?this._animateTo(e,{duration:t.duration},(function(t){"finished"===t.state.playState&&n._fireViewChange(i,e)})):(this.setView(e),this._fireViewChange(i,e))},getViewHistory:function(){return this._viewHistory},_fireViewChange:function(e,t){this._fireEvent("viewchange",{old:e,new:t}),this._insertUICollidesQueue()},_getCurrentView:function(){return this._viewHistory?this._viewHistory[this._viewHistoryPointer]:null}}),gL.mergeOptions({viewHistory:!0,viewHistoryCount:10});var iF=new kN;gL.include({getCollisionIndex:function(){return this._collisionIndex||this.createCollisionIndex(),this._collisionIndex||this.createCollisionIndex()},createCollisionIndex:function(){return this.clearCollisionIndex(),this._collisionIndex=new kN,this._collisionIndex},clearCollisionIndex:function(){return this.collisionFrameTime=0,this._collisionIndex&&this._collisionIndex.clear(),this},_insertUICollidesQueue:function(){return this._uiCollidesQueue||(this._uiCollidesQueue=[]),this._uiCollidesQueue.push(1),this},uiCollides:function(){if(!this.uiList||0===this.uiList.length||!this._uiCollidesQueue||0===this._uiCollidesQueue.length)return this;var e=iF;e.clear();for(var t=this.uiList,n=0,i=t.length;n<i;n++){var r=t[n],a=r.options,o=a.collisionBufferSize;if(a.collision){var s=r.getDOM();if(r.isVisible()&&s&&s.getBoundingClientRect){r.bbox||(r.bbox=[0,0,0,0]);var l=s.getBoundingClientRect(),u=l.x,c=l.y,h=l.width,d=l.height;if(0===h||0===d){var f=r.getSize();f&&(h=f.width,d=f.height)}var p=u+h+o,m=c-o,v=c+d+o;r.bbox[0]=u-o,r.bbox[1]=m,r.bbox[2]=p,r.bbox[3]=v,e.collides(r.bbox)?r._collidesEffect(!1):(e.insertBox(r.bbox),r._collidesEffect(!0))}}}return this._uiCollidesQueue=[],this},_addUI:function(e){return this.uiList||(this.uiList=[]),this.uiList.indexOf(e)>-1||(this.uiList.push(e),this.uiList=this.uiList.sort((function(e,t){return t.options.collisionWeight-e.options.collisionWeight}))),this},_removeUI:function(e){if(!this.uiList)return-1;var t=this.uiList.indexOf(e);return t<0||this.uiList.splice(t,1),t}});var rF={distancetool:{start:"\u8d77\u70b9",units:{mile:" \u7c73",feet:" \u516c\u91cc",kilometer:" \u82f1\u5c3a",meter:" \u82f1\u91cc"}},areatool:{units:{mile:" \u5e73\u65b9\u82f1\u91cc",feet:" \u5e73\u65b9\u82f1\u5c3a",kilometer:" \u5e73\u65b9\u516c\u91cc",meter:" \u5e73\u65b9\u7c73"}}},aF={distancetool:{start:"Inicio",units:{mile:" mi",feet:" ft",kilometer:" km",meter:" m"}},areatool:{units:{mile:" mi\xb2",feet:" ft\xb2",kilometer:" km\xb2",meter:" m\xb2"}}},oF={distancetool:{start:"Start",units:{mile:" mi",feet:" ft",kilometer:" km",meter:" m"}},areatool:{units:{mile:" mi\xb2",feet:" ft\xb2",kilometer:" km\xb2",meter:" m\xb2"}}},sF=function(e){function t(t){var n;return(n=e.call(this,"Translator: "+t)||this).name="TranslatorError",n}return cA(t,e),t}(mA(Error)),lF=function(e){function t(t){var n;return(n=e.call(this)||this).languages={"zh-CN":rF,"es-MX":aF,"en-US":oF},n.nodes={},n.setLang(t||"zh-CN"),n}cA(t,e);var n=t.prototype;return n.setLang=function(e){var t=this.languages[e];if(!t)throw new sF("Setted Lang does not exist");this.nodes=t},n._validateNestedProps=function(e){e.forEach((function(e){if(""===e)throw new sF('Any of sides of a dot "." cannot be empty')}))},n.translate=function(e){if(void 0===e&&(e=null),null==e)throw new sF("Missing parameter textNode");if("string"!=typeof e)throw new sF("Param passed has to be a String");if(!e.includes("."))return this.nodes[e];var t=e.split(".");if(t.length>3)throw new sF("Translate function can only access through 3 nested properties, trying to access -> "+t.length);this._validateNestedProps(t);try{var n=null;switch(t.length){case 2:n=this.nodes[t[0]][t[1]];break;case 3:n=this.nodes[t[0]][t[1]][t[2]]}return n}catch(U5){throw new sF("Unable to find the text translated in lang json"+U5.message)}},t}(pN),uF=function(e){function t(t){var n;return(n=e.call(this,t)||this).on("enable",n._afterEnable,vA(vA(n))).on("disable",n._afterDisable,vA(vA(n))),n._measureLayers=[],n.translator=new lF(n.options.language),n}cA(t,e);var n=t.prototype;return n.clear=function(){if(NA(this._measureLayers))for(var e=0;e<this._measureLayers.length;e++)this._measureLayers[e].remove();return delete this._lastMeasure,delete this._lastVertex,this._outLayers(this._measureLayers),this._measureLayers=[],this},n.getMeasureLayers=function(){return this._measureLayers},n.getLastMeasure=function(){return this._lastMeasure?this._lastMeasure:0},n.undo=function(){e.prototype.undo.call(this);var t=this._historyPointer;if(t!==this._vertexes.length)for(var n=t;n<this._vertexes.length;n++)this._vertexes[n].label&&this._vertexes[n].label.remove(),this._vertexes[n].marker.remove();return this},n.redo=function(){e.prototype.redo.call(this);var t=this._historyPointer-1;return this._vertexes[t]&&(this._vertexes[t].marker.getLayer()||(this._vertexes[t].label&&this._vertexes[t].label.addTo(this._measureMarkerLayer),this._vertexes[t].marker.addTo(this._measureMarkerLayer))),this},n._formatLabelContent=function(e){var t=this.options.formatLabelContent;return t&&SI(t)?t.call(this,e)+"":null},n._measure=function(e){var t,n=this.getMap();e instanceof Jz?t=n.computeGeometryLength(e):Array.isArray(e)&&(t=n.getProjection().measureLength(e)),this._lastMeasure=t;var i=this._formatLabelContent(t);if(i)return i;var r=[this.translator.translate("distancetool.units.meter"),this.translator.translate("distancetool.units.kilometer"),this.translator.translate("distancetool.units.feet"),this.translator.translate("distancetool.units.mile")],a="",o=this.options.decimalPlaces;return this.options.metric&&(a+=t<1e3?t.toFixed(o)+r[0]:(t/1e3).toFixed(o)+r[1]),this.options.imperial&&(a.length>0&&(a+="\n"),a+=(t*=3.2808399)<5280?t.toFixed(o)+r[2]:(t/5280).toFixed(o)+r[3]),a},n._registerMeasureEvents=function(){this.on("drawstart",this._msOnDrawStart,this).on("drawvertex",this._msOnDrawVertex,this).on("mousemove",this._msOnMouseMove,this).on("drawend",this._msOnDrawEnd,this)},n._afterEnable=function(){this._registerMeasureEvents()},n._afterDisable=function(){this.off("drawstart",this._msOnDrawStart,this).off("drawvertex",this._msOnDrawVertex,this).off("mousemove",this._msOnMouseMove,this).off("drawend",this._msOnDrawEnd,this)},n._msOnDrawStart=function(e){var t=this.getMap(),n=t._pointToPrj(e.point2d),i=CA(),r="distancetool_"+i,a="distancetool_markers_"+i,o=this.options.zIndex;t.getLayer(r)?(this._measureLineLayer=t.getLayer(r),this._measureMarkerLayer=t.getLayer(a)):(this._measureLineLayer=new _B(r,{zIndex:o}).addTo(t),this._measureMarkerLayer=new _B(a,{zIndex:o}).addTo(t)),this._measureLayers.push(this._measureLineLayer),this._measureLayers.push(this._measureMarkerLayer),this._pushLayers([this._measureLineLayer,this._measureMarkerLayer]);var s=new LL(e.coordinate,{symbol:this.options.vertexSymbol});s._setPrjCoordinates(n);var l=this.translator.translate("distancetool.start"),u=new uB(l,e.coordinate,this.options.labelOptions);u._setPrjCoordinates(n),this._lastVertex=u,this._addVertexMarker(s,u)},n._msOnMouseMove=function(e){var t=this._measure(this._msGetCoordsToMeasure(e));if(!this._tailMarker){var n=YR(this.options.vertexSymbol);n.markerWidth/=2,n.markerHeight/=2,this._tailMarker=new LL(e.coordinate,{symbol:n}).addTo(this._measureMarkerLayer),this._tailLabel=new uB(t,e.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer)}var i=this._geometry._getPrjCoordinates(),r=i[i.length-1];this._tailMarker.setCoordinates(e.coordinate),this._tailMarker._setPrjCoordinates(r),this._tailLabel.setContent(t),this._tailLabel.setCoordinates(e.coordinate),this._tailLabel._setPrjCoordinates(r)},n._msGetCoordsToMeasure=function(e){return e.geometry.getCoordinates().concat([e.coordinate])},n._msOnDrawVertex=function(e){var t=this._geometry._getPrjCoordinates(),n=t[t.length-1],i=e.geometry,r=new LL(e.coordinate,{symbol:this.options.vertexSymbol}),a=this._measure(i),o=new uB(a,e.coordinate,this.options.labelOptions);this._addVertexMarker(r,o),o._setPrjCoordinates(n),r._setPrjCoordinates(n),this._lastVertex=o},n._addVertexMarker=function(e,t){this._vertexes||(this._vertexes=[]),void 0!==this._historyPointer&&this._vertexes.length>this._historyPointer-1&&(this._vertexes.length=this._historyPointer-1),this._vertexes.push({label:t,marker:e}),this._measureMarkerLayer.addGeometry(e),t&&this._measureMarkerLayer.addGeometry(t)},n._msOnDrawEnd=function(e){if(this._clearTailMarker(),e.geometry._getPrjCoordinates().length<2)return this._lastMeasure=0,void this._clearMeasureLayers();var t=this._lastVertex.getSize();t||(t=new AR(10,10)),this._addClearMarker(this._lastVertex.getCoordinates(),this._lastVertex._getPrjCoordinates(),t.width);var n=e.geometry.copy();n._setPrjCoordinates(e.geometry._getPrjCoordinates()),n.addTo(this._measureLineLayer),this._lastMeasure=n.getLength()},n._addClearMarker=function(e,t,n){var i=this.options.clearButtonSymbol,r={markerDx:(i.markerDx||0)+n,textDx:(i.textDx||0)+n};Array.isArray(i)&&(r=i.map((function(e){return e?{markerDx:(e.markerDx||0)+n,textDx:(e.textDx||0)+n}:null}))),i=YR(i,r);var a=new LL(e,{symbol:i}),o=this._measureLineLayer,s=this._measureMarkerLayer;a.on("click",(function(){return o.remove(),s.remove(),!1}),this),a.addTo(this._measureMarkerLayer),a._setPrjCoordinates(t)},n._clearTailMarker=function(){this._tailMarker&&(this._tailMarker.remove(),delete this._tailMarker),this._tailLabel&&(this._tailLabel.remove(),delete this._tailLabel)},n._clearMeasureLayers=function(){this._measureLineLayer.remove(),this._measureMarkerLayer.remove()},t}(kB);uF.mergeOptions({formatLabelContent:null,decimalPlaces:2,mode:"LineString",language:"zh-CN",metric:!0,imperial:!1,symbol:{lineColor:"#000",lineWidth:3,lineOpacity:1},vertexSymbol:{markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:3,markerWidth:11,markerHeight:11},labelOptions:{textSymbol:{textFaceName:"monospace",textLineSpacing:1,textHorizontalAlignment:"right",textDx:15},boxStyle:{padding:[6,2],symbol:{markerType:"square",markerFill:"#fff",markerFillOpacity:.9,markerLineColor:"#b4b3b3"}}},clearButtonSymbol:[{markerType:"square",markerFill:"#fff",markerLineColor:"#b4b3b3",markerLineWidth:2,markerWidth:15,markerHeight:15,markerDx:20},{markerType:"x",markerWidth:10,markerHeight:10,markerDx:20}]}),function(e){function t(t){var n;return(n=e.call(this,t)||this).translator=new lF(n.options.language),n._measureLayers=[],n}cA(t,e);var n=t.prototype;return n._measure=function(e){var t,n=this.getMap();e instanceof Jz?t=n.computeGeometryArea(e):Array.isArray(e)&&(t=n.getProjection().measureArea(e)),this._lastMeasure=t;var i=this._formatLabelContent(t);if(i)return i;var r=[this.translator.translate("areatool.units.meter"),this.translator.translate("areatool.units.kilometer"),this.translator.translate("areatool.units.feet"),this.translator.translate("areatool.units.mile")],a="",o=this.options.decimalPlaces;return this.options.metric&&(a+=t<1e6?t.toFixed(o)+r[0]:(t/1e6).toFixed(o)+r[1]),this.options.imperial&&(t*=Math.pow(3.2808399,2),a.length>0&&(a+="\n"),a+=t<27878400?t.toFixed(o)+r[2]:(t/27878400).toFixed(o)+r[3]),a},n._msGetCoordsToMeasure=function(e){return e.geometry.getShell().concat([e.coordinate])},n._msOnDrawVertex=function(e){var t=this.getMap()._pointToPrj(e.point2d),n=new LL(e.coordinate,{symbol:this.options.vertexSymbol});n._setPrjCoordinates(t),this._measure(e.geometry),this._lastVertex=n,this._addVertexMarker(n)},n._msOnDrawEnd=function(e){var t;if(this._clearTailMarker(),e.point2d)t=this.getMap()._pointToPrj(e.point2d);else{var n=e.geometry._getPrjCoordinates();n=n.slice(0,n.length-1),e.geometry._setPrjCoordinates(n),t=n[n.length-1]}if(e.geometry._getPrjCoordinates().length<3)return this._lastMeasure=0,void this._clearMeasureLayers();var i=this._measure(e.geometry),r=this.getMap().getProjection().unproject(t),a=new uB(i,r,this.options.labelOptions).addTo(this._measureMarkerLayer);a._setPrjCoordinates(t);var o=a.getSize();o||(o=new AR(10,10)),this._addClearMarker(r,t,o.width);var s=e.geometry.copy();s._setPrjCoordinates(e.geometry._getPrjCoordinates()),s.addTo(this._measureLineLayer),this._lastMeasure=s.getArea()},t}(uF).mergeOptions({mode:"Polygon",symbol:{lineColor:"#000000",lineWidth:2,lineOpacity:1,lineDasharray:"",polygonFill:"#ffffff",polygonOpacity:.5},language:"zh-CN"});var cF={create:function(e,t){var n=e.unproject(t[0]),i=new JL(n,0);return i._setPrjCoordinates(t[0]),i},update:function(e,t,n){var i=n.getMap(),r=Array.isArray(t)?t[t.length-1]:t,a=e.unproject(r),o=i.computeLength(n.getCenter(),a);n.setRadius(o)},generate:function(e){return e}};kB.registerMode("circle",_I({clickLimit:2,action:["click","mousemove","click"]},cF)),kB.registerMode("freeHandCircle",_I({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},cF));var hF={create:function(e,t){var n=e.unproject(t[0]),i=new QL(n,0,0);return i._setPrjCoordinates(t[0]),i},update:function(e,t,n){var i=n.getMap(),r=n.getCenter(),a=Array.isArray(t)?t[t.length-1]:t,o=e.unproject(a),s=i.computeLength(r,new PN({x:o.x,y:r.y})),l=i.computeLength(r,new PN({x:r.x,y:o.y}));n.setWidth(2*s),n.setHeight(2*l)},generate:function(e){return e}};kB.registerMode("ellipse",_I({clickLimit:2,action:["click","mousemove","click"]},hF)),kB.registerMode("freeHandEllipse",_I({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},hF));var dF={create:function(e,t){var n=new NL([]);return n._firstClick=t[0],n},update:function(e,t,n,i){var r=n.getMap(),a=i.containerPoint,o=r._prjToContainerPoint(n._firstClick),s=[[o.x,o.y],[a.x,o.y],[a.x,a.y],[o.x,a.y]];n.setCoordinates(s.map((function(e){return r.containerPointToCoord(new xA(e))}))),n._setPrjCoordinates(s.map((function(e){return r._containerPointToPrj(new xA(e))})))},generate:function(e){return e}};kB.registerMode("rectangle",_I({clickLimit:2,action:["click","mousemove","click"]},dF)),kB.registerMode("freeHandRectangle",_I({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},dF)),kB.registerMode("point",{clickLimit:1,action:["click","mousemove"],create:function(e,t){var n=e.unproject(t[0]),i=new LL(n);return i._setPrjCoordinates(t[0]),i},generate:function(e){return e},update:function(e,t,n){if(Array.isArray(t)&&(t=t[t.length-1]),!t)return n;var i=e.unproject(t);return n.setCoordinates(i),n}});var fF={create:function(e,t){var n=t.map((function(t){return e.unproject(t)})),i=new FL(n);return i._setPrjCoordinates(t),i},update:function(e,t,n){var i,r=n.getSymbol();Array.isArray(t)?i=t:(i=n._getPrjCoordinates()).push(t);var a=i.map((function(t){return e.unproject(t)}));n.setCoordinates(a),n._setPrjCoordinates(i);var o=n.getLayer();if(o){var s=o.getGeometryById("polygon");if(!s&&i.length>=3){if(s=new NL([a],{id:"polygon"}),r){var l=YR(r,{lineOpacity:0});s.setSymbol(l)}s.addTo(o)}s&&s._setPrjCoordinates(i)}},generate:function(e){var t=new NL(e.getCoordinates(),{symbol:e.getSymbol()});return t._setPrjCoordinates(e._getPrjCoordinates()),t._projCode=e._projCode,t}};kB.registerMode("polygon",_I({action:["click","mousemove","dblclick"]},fF)),kB.registerMode("freeHandPolygon",_I({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},fF));var pF={create:function(e,t){var n=t.map((function(t){return e.unproject(t)})),i=new FL(n);return i._setPrjCoordinates(t),i},update:function(e,t,n){var i;Array.isArray(t)?i=t:(i=n._getPrjCoordinates()).push(t);var r=i.map((function(t){return e.unproject(t)}));n.setCoordinates(r),n._setPrjCoordinates(i)},generate:function(e){return e}};function mF(e){for(var t=e.tileInfo,n=[t.cols,t.rows],i=[],r=t.lods,a=0,o=r.length;a<o;a++)i.push(r[a].resolution);var s=e.fullExtent,l=t.origin,u=[1,-1,l.x,l.y];return delete s.spatialReference,{spatialReference:{resolutions:i,fullExtent:s},tileSystem:u,tileSize:n}}function vF(e,t){return void 0===t&&(t=[]),t.forEach((function(t){e=e.replace(t[0],t[1])})),e}function gF(e){var t=e.projection,n=e.isArcgis,i=e.isGeoServer,r=e.isSuperMap,a=.0002645833333333333;return(n||i||r)&&(a=28e-5),t&&t.indexOf("4326")>-1&&(a=2.3767925226029154e-9,(n||r)&&(a=2.518101729011901e-9),i&&(a=2.51528279553466e-9)),a}function yF(e,t){var n=e.getElementsByTagName(t);return n&&n.length?n:e.getElementsByTagName("wmts:"+t)}function _F(e,t){for(var n=0;n<e.length;n++){var i=e[n];if((i=i.getElementsByTagName("ows:Identifier")[0])&&i.textContent===t)return e[n]}return null}function xF(e,t){void 0===t&&(t={});var n,i,r,a=yF(e,"TileMatrix"),o=[],s=[],l=[],u=!1;if(!n){var c=e.getElementsByTagName("ows:SupportedCRS")[0];c&&(n=function(e){return vF(e.indexOf("EPSG")>-1?e:"EPSG:"+e,[["4490","4326"],["102100","3857"],["900913","3857"]])}(n=function(e){for(var t="",n=e.split(""),i=n.length-1;i>=0&&!isNaN(n[i]);i--)t=n[i]+t;return t}(n=(n=c.textContent).split("EPSG")[1])))}i||(i=e.getElementsByTagName("ows:Identifier")[0])&&(i=i.textContent),t.projection=n;for(var h=1/0,d=0;d<a.length;d++){var f=a[d],p=f.getElementsByTagName("ows:Identifier")[0].textContent;isNaN(parseInt(p))?(r=p.substr(0,p.lastIndexOf(":")),p=(p=p.split(":"))[p.length-1],p=parseInt(p),u=!0,t.isGeoServer=!0):p=parseInt(p),h=Math.min(h,p);var m=yF(f,"ScaleDenominator")[0].textContent,v=yF(f,"TopLeftCorner")[0].textContent,g=yF(f,"TileWidth")[0].textContent,y=yF(f,"TileHeight")[0].textContent;if(0===l.length&&l.push(parseInt(g),parseInt(y)),0===s.length){var _=v.split(" ").filter((function(e){return""!==e})).map((function(e){return parseFloat(e)})),x=_[0],b=_[1];x>0?s.push(1,-1,b,x):s.push(1,-1,x,b)}var w=gF(t),k=parseFloat(m)*w;o.push(k)}if(h>0)for(var C=o[0],S=h-1;S>=0;S--)o.splice(0,0,C*=2);return{resolutions:o,tileSize:l,tileSystem:s,projection:n,TileMatrixSet:i,isGeoServer:u,levelStr:r}}kB.registerMode("linestring",_I({action:["click","mousemove","dblclick"]},pF)),kB.registerMode("freeHandLinestring",_I({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},pF)),kB.registerMode("arccurve",{action:["click","mousemove","dblclick"],create:function(e,t){var n=t.map((function(t){return e.unproject(t)})),i=new nB(n);return i._setPrjCoordinates(t),i},update:pF.update,generate:function(e){return e}}),kB.registerMode("quadbeziercurve",{action:["click","mousemove","dblclick"],create:function(e,t){var n=t.map((function(t){return e.unproject(t)})),i=new rB(n);return i._setPrjCoordinates(t),i},update:pF.update,generate:function(e){return e}}),kB.registerMode("cubicbeziercurve",{action:["click","mousemove","dblclick"],create:function(e,t){var n=t.map((function(t){return e.unproject(t)})),i=new iB(n);return i._setPrjCoordinates(t),i},update:pF.update,generate:function(e){return e}}),kB.registerMode("boxZoom",{action:["mousedown","mousemove","mouseup"],create:function(e,t){var n=e.unproject(t=t[0]),i=new LL(n);return i._firstClick=t,i},update:function(e,t,n,i){var r=n.getMap(),a=r._prjToContainerPoint(n._firstClick),o=i.containerPoint;t=r._containerPointToPrj(new PN(Math.min(a.x,o.x),Math.min(a.y,o.y)));var s=e.unproject(t);n.setCoordinates(s)._setPrjCoordinates(t),n.updateSymbol({markerWidth:Math.abs(a.x-o.x),markerHeight:Math.abs(a.y-o.y)})},generate:function(e){return e}}),Zz.loadArcgis=function(e,t,n){if(void 0===n&&(n={jsonp:!0}),CI(e)&&"{"!==e.substring(0,1))JO.getJSON(e,(function(e,n){if(e)t(e);else{var i=mF(n);t(null,i)}}),n);else{CI(e)&&(e=SA(e));var i=mF(e);t(null,i)}return this},Zz.loadWMTS=function(e,t,n){return void 0===n&&(n={jsonp:!0}),CI(e)&&JO.get(e,(function(i,r){if(i)t(i);else{var a=function(e,t,n){null==n.isArcgis&&(n.isArcgis=e.indexOf("arcgis")>-1),null==n.isSuperMap&&(n.isSuperMap=e.indexOf("supermap")>-1);var i=(new DOMParser).parseFromString(e,"text/xml").querySelectorAll("Contents")[0];if(!i)return[];var r=yF(i,"Layer");if(!r.length)return[];for(var a=[],o=0,s=i.childNodes.length;o<s;o++)"TileMatrixSet"===i.childNodes[o].localName&&a.push(i.childNodes[o]);if(!a.length)return[];for(var l=[],u=0,c=r.length;u<c;u++){var h=r[u],d=h.querySelectorAll("Style")[0];d&&(d=d.getElementsByTagName("ows:Identifier")[0])&&(d=d.textContent);var f=h.getElementsByTagName("ows:Identifier")[0];f&&(f=f.textContent);var p=yF(h,"TileMatrixSetLink");if(0!==p.length)for(var m=0,v=p.length;m<v;m++){var g=p[m];(g=yF(g,"TileMatrixSet")[0])&&(g=g.textContent);var y=_F(a,g);if(y){var _=h.querySelectorAll("ResourceURL")[0],x="";_&&(x=_.attributes.template.value);var b=xF(y,n),w=b.resolutions,k=b.tileSize,C=b.tileSystem,S=b.projection,T=b.TileMatrixSet,E=b.isGeoServer,P=b.levelStr;x.length||(x=t.substr(0,t.lastIndexOf("?")),x+="?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={tiles}&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}");var M=vF(x,[["{LAYER}",f],["{Layer}",f],["{layer}",f],["{STYLE}",d],["{Style}",d],["{style}",d],["{TileMatrixSet}",T],["{TileMatrix}",E?P+":{z}":"{z}"],["{TileRow}","{y}"],["{TileCol}","{x}"],["{tiles}",E?"image/png":"tiles"]]);l.push({tileSize:k,tileSystem:C,spatialReference:{resolutions:w,projection:S},urlTemplate:M,info:{layerName:f,TileMatrixSet:T,style:d,tileSize:k,tileSystem:C,resolutions:w,projection:S,urlTemplate:M}})}}}return l}(r,e,n);t(null,a)}}),n),this};var bF=function(e){function t(t){var n;return(n=e.call(this,t)||this).proxyOptions(),n}cA(t,e);var n=t.prototype;return n.addTo=function(e){return this._owner=e,this._switchEvents("on"),this.onAdd&&this.onAdd(),this.fire("add"),this},n.getMap=function(){return this._owner?this._owner.getBaseLayer?this._owner:this._owner.getMap():null},n._collides=function(){var e=this.getMap();return e?(e._addUI(this),e._insertUICollidesQueue(),this):this},n._collidesEffect=function(e){var t=this.getDOM();if(!t)return this;if(t.style.visibility=e?"visible":"hidden",!t.classList||!t.classList.add)return this;if(!this.options.collisionFadeIn)return this;var n=t.classList.contains("mtk-ui-fadein");return e&&!n?t.classList.add("mtk-ui-fadein"):!e&&n&&t.classList.remove("mtk-ui-fadein"),this},n.show=function(e){var t=this,n=this.getMap();if(!n)return this;this.options.visible=!0,(e=e||this._coordinate||this._owner.getCenter())instanceof PN||(e=new PN(e));var i=this.isVisible();this._showBySymbolChange||this.fire("showstart");var r=this._getUIContainer();this._coordinate=e,this._removePrevDOM(),this._mapEventsOn||this._switchMapEvents("on");var a=this.__uiDOM=this.buildOn(n);a.eventsPropagation=this.options.eventsPropagation,this._observerDomSize(a);var o=this.options.zIndex;if(!a)return this._showBySymbolChange||this.fire("showend"),this._collides(),this.setZIndex(o),this;this._measureSize(a),this._singleton()&&(a._uiComponent=this,n[this._uiDomKey()]=a),this._setPosition(),a.style[iO]=null,r.appendChild(a);var s=this._getAnimation();if(i&&(s.ok=!1),s.ok&&(s.fade&&(a.style.opacity=0),s.scale)){if(this.getTransformOrigin){var l=this.getTransformOrigin();a.style[nO]=l}a.style[tO]=this._toCSSTranslate(this._pos)+" scale(0)"}this.isSupportZoomFilter()||(a.style.display=""),this.options.eventsToStop&&bO(a,this.options.eventsToStop,hO);var u=s.transition;return s.ok&&u&&(u&&(a.style[iO]=u),s.fade&&(a.style.opacity=1),s.scale&&(a.style[tO]=this._toCSSTranslate(this._pos)+" scale(1)")),this._showBySymbolChange||this.fire("showend"),this._collides(),clearTimeout(this._autoPanId),this.options.autoPan&&(this._autoPanId=setTimeout((function(){t._autoPan()}),32)),this.setZIndex(o),this},n.hide=function(){var e=this;if(!this.getDOM())return this;this._onDomMouseout&&this._onDomMouseout(),this.options.visible=!1;var t=this._getAnimation(),n=this.getDOM();return this.options.animationOnHide||(t.ok=!1),t.ok?(n.style[iO]=t.transition,setTimeout((function(){n.style.display="none",e.fire("hide")}),this.options.animationDuration)):(n.style.display="none",this.fire("hide")),t.fade&&(n.style.opacity=0),t.scale&&(n.style[tO]=this._toCSSTranslate(this._pos)+" scale(0)"),this._switchMapEvents("off"),this._collides(),this},n.isVisible=function(){if(!this.options.visible)return!1;var e=this.getDOM();return this.getMap()&&e&&e.parentNode&&"none"!==e.style.display},n.remove=function(){if(delete this._mapEventsOn,!this._owner)return this;var e=this.getMap();return e&&e._removeUI(this),this.hide(),this._switchEvents("off"),this.onRemove&&this.onRemove(),!this._singleton()&&this.__uiDOM&&this._removePrevDOM(),delete this._owner,this.fire("remove"),this._collides(),this},n.getSize=function(){return this._domContentRect&&this._size&&(this._size.width=this._domContentRect.width,this._size.height=this._domContentRect.height),this._size?this._size.copy():null},n.getOwner=function(){return this._owner},n.getDOM=function(){return this.__uiDOM},n.setZIndex=function(e){if(!bI(e))return this;var t=this.getDOM();return t?(t.style.zIndex=e,e!==this.options.zIndex&&(this.options.zIndex=e),this):this},n._roundPoint=function(e){return this.options.roundPoint&&(e=e._round()),e},n.getPosition=function(){if(!this.getMap())return null;var e=this._roundPoint(this._getViewPoint());if(this.getOffset){var t=this._roundPoint(this.getOffset());t&&e._add(t)}return e},n._getAnimation=function(){for(var e={fade:!1,scale:!1},t=this.options.animation?this.options.animation.split(","):[],n=0;n<t.length;n++){var i=RR(t[n]);"fade"===i?e.fade=!0:"scale"===i&&(e.scale=!0)}var r=null;return e.fade&&(r="opacity "+this.options.animationDuration+"ms"),e.scale&&(r=r?r+",":"",r+=tO+" "+this.options.animationDuration+"ms"),e.transition=r,e.ok=null!==r,e},n._getViewPoint=function(){var e=0,t=this._coordinate||{};bI(t.z)?e=t.z:this._owner&&this._owner.getAltitude&&(bI(e=this._owner.getAltitude()||0)||(e=0));var n=this._meterToPoint(this._coordinate,e);return this.getMap().coordToViewPoint(this._coordinate,void 0,n)._add(this.options.dx,this.options.dy)},n._meterToPoint=function(e,t){return t},n._autoPan=function(){var e=this.getMap(),t=this.getDOM();if(t&&e&&!e.isMoving()){var n=this._getViewPoint()._round(),i=e.width,r=e.height,a=e.getContainer();if(t&&a&&t.getBoundingClientRect){var o=a.getBoundingClientRect(),s=o.left,l=o.top,u=t.getBoundingClientRect(),c=0,h=0,d=u.left,f=u.right,p=u.top,m=u.bottom;if(d-=s,f-=s,p-=l,m-=l,u.width>0&&u.height>0)return d<50&&(c=50-d),0===c&&f+50>i&&(c=-(f+50-i)),p<50&&(h=50-p),0===h&&m+50>r&&(h=-(m+50-r)),void((0!==c||0!==h)&&(e.getPitch()>40&&0!==h&&this._coordinate?e.animateTo({center:this._coordinate},{duration:e.options.panAnimationDuration}):e.panBy([Math.ceil(c),Math.ceil(h)])))}var v=e.viewPointToContainerPoint(n),g=this.getOffset(),y=v.add(g),_=e._viewPointToPrj(n),x=parseInt(t.clientWidth),b=parseInt(t.clientHeight),w=0,k=0;if(y.x<0?w=50-y.x:y.x+x>i&&(w=-(y.x+x-i)-50),y.y-b<0?k=Math.abs(y.y-b)+50:y.y+b>r&&(k=r-(y.y+b)-50),x>=i&&(w=i/2-v.x),0!==k||0!==w){var C=v.add(w,k),S=e._containerPointToPoint(C)._sub(e._prjToPoint(e._getPrjCenter())),T=e._pointToPrj(e._prjToPoint(_).sub(S));e._panAnimation(T)}}},n._measureSize=function(e){var t=this._getUIContainer();e.style.position="absolute";var n=e.style.bottom?"bottom":"top";if(e.style.display="",t.appendChild(e),e.getBoundingClientRect){var i=e.getBoundingClientRect();this._size=new AR(i.width,i.height)}else this._size=new AR(e.clientWidth,e.clientHeight);return e.style.display="none",e.style.left="0px",e.style[n]="0px",this._size},n._removePrevDOM=function(){this.onDomRemove&&this.onDomRemove();var e=this.options.eventsToStop;if(this._singleton()){var t=this.getMap(),n=this._uiDomKey();if(t[n]){e&&wO(t[n],e,hO);var i=t[n]._uiComponent;i&&i!==this&&i.isVisible()&&i.fire("hide"),oO(t[n]),i&&!this.hideDom&&i._switchMapEvents("off"),delete t[n]}delete this.__uiDOM}else this.__uiDOM&&(e&&wO(this.__uiDOM,e,hO),oO(this.__uiDOM),delete this.__uiDOM);this._resizeObserver&&(this._resizeObserver.disconnect(),delete this._resizeObserver,delete this._domContentRect)},n._uiDomKey=function(){return"__ui_"+this._getClassName()},n._singleton=function(){return this.options.single},n._getUIContainer=function(){return this.getMap()._panels.ui},n._getClassName=function(){return"UIComponent"},n._switchMapEvents=function(e){var t=this.getMap();if(t){this._mapEventsOn="on"===e;var n=this._getDefaultEvents();if(this.getEvents&&_I(n,this.getEvents()),n)for(var i in n)n.hasOwnProperty(i)&&t[e](i,n[i],this)}},n._switchEvents=function(e){var t=this._getOwnerEvents();if(this._owner)for(var n in t)t.hasOwnProperty(n)&&this._owner[e](n,t[n],this)},n._getDefaultEvents=function(){return{"zooming rotate pitch":this.onEvent,zoomend:this.onZoomEnd,moving:this.onMoving,moveend:this.onMoving,resize:this.onResize}},n._getOwnerEvents=function(){var e={};return this._owner&&this._owner instanceof Jz&&(e.positionchange=this.onGeometryPositionChange,e.symbolchange=this._updatePosition),this.getOwnerEvents&&_I(e,this.getOwnerEvents()),e},n.onGeometryPositionChange=function(e){this._owner&&this.isVisible()&&(this._showBySymbolChange=!0,this.show(e.target.getCenter()),delete this._showBySymbolChange)},n.onMoving=function(){this.isVisible()&&this.getMap().isTransforming()&&this._updatePosition()},n.onEvent=function(){this.isVisible()&&this._updatePosition()},n.onZoomEnd=function(){this.isVisible()&&this._setPosition()},n.onResize=function(){this.isVisible()&&this._setPosition()},n.onDomSizeChange=function(){this.isVisible()&&(this._setPosition(),this._collides())},n._updatePosition=function(){return this.getMap()?(this.getMap()._getRenderer().callInNextFrame(this._setPosition.bind(this)),this):this},n._setPosition=function(){var e=this.getDOM();if(e){e.style[iO]=null;var t=this.getPosition();this._pos=t,e.style[tO]=this._toCSSTranslate(t)+" scale(1)"}},n._toCSSTranslate=function(e){if(!e)return"";if(lA.any3d){var t=this.getMap(),n=t?t.getBearing():0,i=t?t.getPitch():0,r="";return this.options.pitchWithMap&&i&&(r+=" rotateX("+Math.round(i)+"deg)"),this.options.rotateWithMap&&n&&(r+=" rotateZ("+Math.round(-n)+"deg)"),"translate3d("+e.x+"px,"+e.y+"px, 0px)"+r}return"translate("+e.x+"px,"+e.y+"px)"},n._observerDomSize=function(e){var t=this;return e&&lA.resizeObserver&&!this._resizeObserver?(this._resizeObserver=new ResizeObserver((function(e){if(e.length){var n=e[0].borderBoxSize;t._domContentRect=n&&n.length?{width:n[0].inlineSize,height:n[0].blockSize}:e[0].contentRect}else delete t._domContentRect;t.onDomSizeChange&&t.onDomSizeChange()})),this._resizeObserver.observe(e),this):this},n.isSupportZoomFilter=function(){return!1},n.onConfig=function(){return this._updatePosition(),this},t.isSupport=function(e){return!!(e&&SI(e.on)&&SI(e.off)&&SI(e.getCenter))},t}(dN(pN));bF.mergeOptions({eventsPropagation:!1,eventsToStop:null,dx:0,dy:0,autoPan:!1,autoPanDuration:600,single:!0,animation:"scale",animationOnHide:!1,animationDuration:500,pitchWithMap:!1,rotateWithMap:!1,visible:!0,roundPoint:!1,collision:!1,collisionBufferSize:2,collisionWeight:0,collisionFadeIn:!1,zIndex:0});var wF="mousedown mouseup mouseenter mouseover mouseout mousemove click dblclick contextmenu keypress touchstart touchmove touchend",kF=function(e){function t(t,n){var i;return(i=e.call(this,n)||this)._markerCoord=new PN(t),i}cA(t,e);var n=t.prototype;return n._getClassName=function(){return"UIMarker"},n.setCoordinates=function(e){return this._markerCoord=e,this.fire("positionchange"),this.isVisible()&&(this._coordinate=this._markerCoord,this._setPosition(),this._collides()),this},n.getCoordinates=function(){return this._markerCoord},n.getCenter=function(){return this.getCoordinates()},n.getAltitude=function(){var e=this.getCoordinates()||{};return bI(e.z)?e.z:this.options.altitude||0},n.setAltitude=function(e){return bI(e)&&this._markerCoord&&(this._markerCoord.z=e,this._updatePosition&&(this._updatePosition(),this._collides())),this},n.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(),this},n.getContent=function(){return this.options.content},n.onAdd=function(){if(this._owner&&!this._owner.isMap)throw new Error("UIMarker Can only be added to the map, but owner is:",this._owner.getJSONType());return this.show(),this},n.show=function(){return e.prototype.show.call(this,this._markerCoord)},n.flash=function(e,t,n,i){return VA.call(this,e,t,n,i)},n.buildOn=function(){var e,t=this.options.content,n=CI(t);return n||SI(t)?(e=rO("div"),n?e.innerHTML=this.options.content:t.bind(this)(e)):e=this.options.content,this.options.containerClass&&(e.className=this.options.containerClass),this._registerDOMEvents(e),e},n.getOffset=function(){var e=this.getSize(),t=-e.width/2,n=-e.height/2,i=this.options,r=i.horizontalAlignment,a=i.verticalAlignment;return"left"===r?t=-e.width:"right"===r&&(t=0),"top"===a?n=-e.height:"bottom"===a&&(n=0),new xA(t,n)},n.getTransformOrigin=function(){return"center center"},n.onDomRemove=function(){var e=this.getDOM();this._removeDOMEvents(e)},n.isDragging=function(){return!!this.draggable&&this.draggable.isDragging()},n._registerDOMEvents=function(e){bO(e,wF,this._onDomEvents,this)},n._onDomEvents=function(e){var t=this.getMap()._parseEvent(e,e.type),n=e.type;if("mousedown"===n&&(this._mousedownEvent=e),"mouseup"===n&&(this._mouseupEvent=e),("click"!==n||!this._mouseClickPositionIsChange())&&("touchstart"===n&&(this._touchstartTime=yI()),this.fire(e.type,t),"touchend"===n&&lA.touch)){var i=this.getMap().options.clickTimeThreshold||280;yI()-this._touchstartTime<i&&this._onDomEvents(_I({},e,{type:"click"}))}},n._removeDOMEvents=function(e){wO(e,wF,this._onDomEvents,this)},n._mouseClickPositionIsChange=function(){var e=this._mousedownEvent||{},t=this._mouseupEvent||{};return e.x!==t.x||e.y!==t.y},n._getConnectPoints=function(){var e=this.getMap(),t=e.coordToContainerPoint(this.getCoordinates()),n=this.getSize(),i=n.width,r=n.height;return[e.containerPointToCoordinate(t.add(-i/2,0)),e.containerPointToCoordinate(t.add(i/2,0)),e.containerPointToCoordinate(t.add(0,r/2)),e.containerPointToCoordinate(t.add(0,-r/2))]},n._getViewPoint=function(){var e=0;if(this._owner){var t=this.getAltitude();t>0&&(e=this._meterToPoint(this._coordinate,t))}return this.getMap().coordToViewPoint(this._coordinate,void 0,e)._add(this.options.dx,this.options.dy)},n._getDefaultEvents=function(){return _I({},e.prototype._getDefaultEvents.call(this),{"zooming zoomend":this.onZoomFilter})},n._setPosition=function(){this.onZoomFilter(),e.prototype._setPosition.call(this)},n.onZoomFilter=function(){var e=this.getDOM();e&&(this.isVisible()||"none"===e.style.display?this.isVisible()&&"none"===e.style.display&&(e.style.display=""):e.style.display="none")},n.isVisible=function(){var e=this.getMap();if(!e)return!1;if(!this.options.visible)return!1;var t=e.getZoom(),n=this.options,i=n.minZoom,r=n.maxZoom;return!(!xI(i)&&t<i||!xI(r)&&t>r)&&this.getDOM()&&!0},n.isSupportZoomFilter=function(){return!0},t}(CN(bF));kF.mergeOptions({containerClass:null,eventsPropagation:!0,draggable:!1,single:!1,content:null,altitude:0,minZoom:0,maxZoom:null,horizontalAlignment:"middle",verticalAlignment:"middle"});var CF=lA.touch?"touchstart mousedown":"mousedown",SF=function(e){function t(t){return e.call(this,t)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){this.target.on(CF,this._startDrag,this)},n.removeHooks=function(){this.target.off(CF,this._startDrag,this)},n._startDrag=function(e){var t=e.domEvent;t.touches&&t.touches.length>1||2===t.button||this.isDragging()||(this.target.on("click",this._endDrag,this),this._lastCoord=e.coordinate,this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),this.target.fire("dragstart",e))},n._prepareDragHandler=function(){this._dragHandler=new EN(this.target.getDOM(),{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},n._cancelOn=function(e){var t=(e.srcElement||e.target).tagName.toLowerCase();return"button"===t||"input"===t||"select"===t||"option"===t||"textarea"===t},n._onMouseDown=function(e){hO(e.domEvent)},n._dragging=function(e){var t=this.target,n=t.getMap()._parseEvent(e.domEvent),i=n.domEvent;if(!(i.touches&&i.touches.length>1))if(this._isDragging){var r=n.coordinate,a=n.containerPoint;this._lastCoord||(this._lastCoord=r),this._lastPoint||(this._lastPoint=a);var o=r.sub(this._lastCoord),s=a.sub(this._lastPoint);this._lastCoord=r,this._lastPoint=a,this.target.setCoordinates(this.target.getCoordinates().add(o)),n.coordOffset=o,n.pointOffset=s,t.fire("dragging",n)}else this._isDragging=!0},n._endDrag=function(e){var t=this.target,n=t.getMap();if(this._dragHandler&&(t.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1,n){var i=n._parseEvent(e.domEvent);t&&t._mouseClickPositionIsChange&&t._mouseClickPositionIsChange()&&t.fire("dragend",i)}},n.isDragging=function(){return!!this._isDragging},t}(fN);kF.addInitHook("addHandler","draggable",SF);var TF=/\{ *([\w_]+) *\}/g,EF={containerClass:"maptalks-msgBox",autoPan:!0,autoCloseOn:null,autoOpenOn:"click",width:"auto",minHeight:120,custom:!1,title:null,content:null,enableTemplate:!1},PF=new AR(0,0),MF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n._getClassName=function(){return"InfoWindow"},n.addTo=function(t){return t instanceof Jz&&(t.getInfoWindow()&&t.getInfoWindow()!==this&&t.removeInfoWindow(),t._infoWindow=this),e.prototype.addTo.call(this,t)},n.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(this._coordinate),this},n.getContent=function(){return this.options.content},n.setTitle=function(e){var t=e;return this.options.title=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(this._coordinate),this},n.getTitle=function(){return this.options.title},n.buildOn=function(){var e=SI(this.options.content),t=CI(this.options.content);if(this.options.custom){if(t||e){var n=rO("div");return t?(n.innerHTML=this.options.content,this._replaceTemplate(n)):this.options.content.bind(this)(n),n}return this._replaceTemplate(this.options.content),this.options.content}this._bindDomEvents(this.getDOM(),"off");var i=rO("div");this.options.containerClass&&(i.className=this.options.containerClass);var r=this._getWindowWidth();i.style.width=bI(r)?r+"px":"auto",i.style.bottom="0px";var a='<em class="maptalks-ico"></em>';this.options.title&&(a+="<h2>"+this.options.title+"</h2>"),i.innerHTML=a+='<a href="javascript:void(0);" class="maptalks-close">\xd7</a><div class="maptalks-msgContent"></div>',this._replaceTemplate(i);var o=i.querySelector(".maptalks-msgContent");return t||e?t?o.innerHTML=this.options.content:this.options.content.bind(this)(o):o.appendChild(this.options.content),this._onCloseBtnClick=this.hide.bind(this),sO(i.querySelector(".maptalks-close"),"click touchend",this._onCloseBtnClick),e||this._replaceTemplate(o),this._bindDomEvents(i,"on"),i},n._replaceTemplate=function(e){if(this.options.enableTemplate&&this._owner&&this._owner.getProperties&&e&&e.innerHTML){var t=this._owner.getProperties()||{};kI(t)&&(e.innerHTML=e.innerHTML.replace(TF,(function(e,n){return t[n]})))}return this},n.getTransformOrigin=function(){return this.getSize().width/2+"px bottom"},n.getOffset=function(){var e=this.getSize(),t=new xA(-e.width/2,0);this.options.custom?t._sub(0,e.height):t._sub(4,12);var n=this.getOwner();if(n instanceof LL||n instanceof GL){var i,r;if(n instanceof LL)i=n._getPainter(),r=n.getSize();else{var a=n.getGeometries();if(!a||!a.length)return t;i=a[0]._getPainter(),r=a[0].getSize()}if(r||(r=PF),i){var o=i.getFixedExtent();t._add(o.xmax-r.width/2,o.ymin)}else t._add(0,-r.height)}return t},n.show=function(t){return this.getMap()&&this.getMap().options.enableInfoWindow?e.prototype.show.call(this,t):this},n.getEvents=function(){if(!this.options.autoCloseOn)return null;var e={};return e[this.options.autoCloseOn]=this.hide,e},n.getOwnerEvents=function(){var e=this.getOwner();if(!this.options.autoOpenOn||!e)return null;var t={};return t[this.options.autoOpenOn]=this._onAutoOpen,t},n.onRemove=function(){this._onDomMouseout(),this.onDomRemove()},n.onDomRemove=function(){this._onCloseBtnClick&&(lO(this.getDOM().childNodes[2],"click touchend",this._onCloseBtnClick),delete this._onCloseBtnClick)},n._onAutoOpen=function(e){var t=this,n=this.getOwner();setTimeout((function(){n instanceof LL||n instanceof bF?t.show(n.getCoordinates()):n instanceof GL?t.show(n.findClosest(e.coordinate)):n instanceof FL||n instanceof ZL?(t.getMap().getScale()>=8&&(e.coordinate=t._rectifyMouseCoordinte(n,e.coordinate)),t.show(e.coordinate)):t.show(e.coordinate)}),1)},n._rectifyMouseCoordinte=function(e,t){var n=this;return e instanceof FL?this._rectifyLineStringMouseCoordinate(e,t).coordinate:e instanceof ZL?e.getGeometries().map((function(e){return n._rectifyLineStringMouseCoordinate(e,t)})).sort((function(e,t){return e.dis-t.dis}))[0].coordinate:t},n._rectifyLineStringMouseCoordinate=function(e,t){for(var n=this,i=e.getCoordinates().map((function(e){return n.getMap().coordToContainerPoint(e)})),r=this.getMap().coordToContainerPoint(t),a=1/0,o=-1,s=0,l=i.length;s<l;s++){var u=r.distanceTo(i[s]);u<a&&(a=u,o=s)}var c=[];0===o?c.push(i[0],i[1]):o===i.length-1?c.push(i[o-1],i[o]):c.push(i[o-1],i[o],i[o+1]);for(var h=[],d=this.getMap().getSize(),f=d.width,p=d.height,m=0,v=c.length-1;m<v;m++){var g=c[m],y=c[m+1];if(g.x===y.x)for(var _=Math.max(0,Math.min(g.y,y.y)),x=Math.min(p,Math.max(g.y,y.y)),b=_;b<=x;b++)h.push(new xA(g.x,b));else for(var w=(y.y-g.y)/(y.x-g.x),k=Math.max(0,Math.min(g.x,y.x)),C=Math.min(f,Math.max(g.x,y.x)),S=k;S<=C;S++)h.push(new xA(S,w*(S-g.x)+g.y))}for(var T=1/0,E=-1,P=0,M=h.length;P<M;P++){var I=r.distanceTo(h[P]);I<T&&(T=I,E=P)}return{dis:T,coordinate:E<0?t:this.getMap().containerPointToCoord(h[E])}},n._getWindowWidth=function(){var e=this.options.width;return e||(e=EF.width),e},n._bindDomEvents=function(e,t){if(e){var n=this._getDomEvents(),i="on"===t?bO:wO;for(var r in n)i(e,r,n[r],this)}},n._getDomEvents=function(){return{mouseover:this._onDomMouseover,mouseout:this._onDomMouseout}},n._onDomMouseover=function(e){var t=this.getMap();t&&(t.options.preventWheelScroll=!1)},n._onDomMouseout=function(e){var t=this.getMap();t&&(t.options.preventWheelScroll=!0)},t}(bF);MF.mergeOptions(EF);var IF="remove hide shapechange positionchange dragend animatestart",AF=function(e){cA(n,e);var t=n.prototype;function n(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,n)||this)._content=t,i}return t._getClassName=function(){return"ToolTip"},t.addTo=function(t){if(n.isSupport(t))return t.on("mousemove",this.onMouseMove,this),t.on("mouseout",this.onMouseOut,this),t.on(IF,this.hideDom,this),e.prototype.addTo.call(this,t);throw new Error("Invalid geometry or UIMarker the tooltip is added to.")},t.setStyle=function(e){return this.options.containerClass=e,this},t.getStyle=function(){return this.options.containerClass},t.getContent=function(){return this._content},t.buildOn=function(){var e=rO("div"),t=this.options||{};t.height&&(e.style.height=t.height+"px"),t.width&&(e.style.width=t.width+"px");var n=t.containerClass||t.cssName;return!n&&t.height&&(e.style.lineHeight=t.height+"px"),SI(this._content)?this._content.bind(this)(e):e.innerHTML='<div class="'+n+'">'+this._content+"</div>",e},t.onMouseOut=function(){clearTimeout(this._timeout),this.isVisible()&&this._removePrevDOM(),this._switchMapEvents("off")},t.onMouseMove=function(e){var t=this;clearTimeout(this._timeout);var n=this.getMap();if(n){var i=n.locateByPoint(e.coordinate,-5,25);0===this.options.showTimeout?this.show(i):this._timeout=setTimeout((function(){n&&t.show(i)}),this.options.showTimeout)}},t.onRemove=function(){clearTimeout(this._timeout),this._owner&&(this._owner.off("mouseover",this.onMouseOver,this),this._owner.off("mouseout",this.onMouseOut,this),this._owner.off(IF,this.hideDom,this))},t.hideDom=function(){return this.hide()},t.onEvent=function(){return e.prototype.onEvent.call(this),this.hideDom(),this},t._getViewPoint=function(){return this.getMap().coordToViewPoint(this._coordinate,void 0,0)._add(this.options.dx,this.options.dy)},n}(bF);AF.mergeOptions({width:0,height:0,animation:"fade",containerClass:"maptalks-tooltip",showTimeout:400});var RF=function(e){function t(t){return e.call(this,t)||this}cA(t,e);var n=t.prototype;return n._getClassName=function(){return"Menu"},n.addTo=function(e){return e._menu&&e._menu!==this&&e.removeMenu(),e._menu=this,this._owner=e,bF.prototype.addTo.apply(this,arguments)},n.setItems=function(e){return this.options.items=e,this},n.getItems=function(){return this.options.items||[]},n.buildOn=function(){if(this.options.custom){if(CI(this.options.items)){var e=rO("div");return e.innerHTML=this.options.items,e}return this.options.items}var t=rO("div");this.options.containerClass&&gO(t,this.options.containerClass),t.style.width=this._getMenuWidth()+"px";var n=this._createMenuItemDom();return t.appendChild(n),bO(t,"contextmenu",cO),t},n.getOffset=function(){if(!this.getMap())return null;var e=this.getMap().getSize(),t=this.getMap().viewPointToContainerPoint(this._getViewPoint()),n=this.getSize(),i=0,r=0;return t.x+n.width>e.width&&(i=-n.width),t.y+n.height>e.height&&(r=-n.height),new xA(i,r)},n.getTransformOrigin=function(){var e=this.getOffset()._multi(-1);return e.x+"px "+e.y+"px"},n.getEvents=function(){return{"_zoomstart _zoomend _movestart _dblclick _click":this._removePrevDOM}},n._createMenuItemDom=function(){var e=this,t=this.getMap(),n=rO("ul");gO(n,"maptalks-menu-items");var i,r,a=this.getItems();function o(n){return function(i){var r=t._parseEvent(i,"click");r.target=e,r.owner=e._owner,r.index=n,!1!==this._callback(r)&&(e.hide(),e._owner&&e._owner.fire("closemenu"))}}for(var s=0,l=a.length;s<l;s++){if("-"===(i=a[s])||"_"===i)gO(r=rO("li"),"maptalks-menu-splitter");else{r=rO("li");var u=i.item;SI(u)&&(u=u({owner:this._owner,index:s})),r.innerHTML=u,r._callback=i.click,bO(r,"click",o(s))}n.appendChild(r)}var c=this.options.maxHeight||0;return c>0&&mO(n,"max-height: "+c+"px; overflow-y: auto;"),n},n._getMenuWidth=function(){return this.options.width||160},t}(bF);RF.mergeOptions({containerClass:"maptalks-menu",animation:null,animationDelay:10,animationOnHide:!1,autoPan:!1,width:160,maxHeight:0,custom:!1,items:[]});var OF={setMenu:function(e){return this._menuOptions=e,this._menu?this._menu.setOptions(e):this.on("contextmenu",this._defaultOpenMenu,this),this},getMenu:function(){return this._menu},openMenu:function(e){var t=this instanceof gL?this:this.getMap();return e||(e=this.getCenter()),this._menu?this._menu.show(e):this._menuOptions&&t&&(this._bindMenu(),this._menu.show(e)),this.fire("openmenu",{coordinate:e}),this},setMenuItems:function(e){return this._menuOptions||(this._menuOptions={}),Array.isArray(e)&&(this._menuOptions.custom=!1),this._menuOptions.items=e,this.setMenu(this._menuOptions),this},getMenuItems:function(){return this._menu?this._menu.getItems():this._menuOptions&&this._menuOptions.items||[]},closeMenu:function(){return this._menu&&this._menu.hide(),this.fire("closemenu",{}),this},removeMenu:function(){return this.off("contextmenu",this._defaultOpenMenu,this),this._unbindMenu(),delete this._menuOptions,this.fire("removemenu",{}),this},_bindMenu:function(){return this._menuOptions?(this._menu=new RF(this._menuOptions),this._menu.addTo(this),this):this},_unbindMenu:function(){return this._menu&&(this.closeMenu(),this._menu.remove(),delete this._menu),this},_defaultOpenMenu:function(e){return this.openMenu(e.coordinate),!1}};gL.include(OF),Jz.include(OF);var NF=Object.freeze({UIComponent:bF,UIMarker:kF,InfoWindow:MF,ToolTip:AF,Menuable:OF,Menu:RF}),DF=function(e){function t(t){return t&&t.position&&!CI(t.position)&&(t.position=_I({},t.position)),e.call(this,t)||this}cA(t,e);var n=t.prototype;return n.addTo=function(e){if(this.remove(),!e.options.control)return this;this._map=e;var t=e._panels.control;return this.__ctrlContainer=rO("div"),mO(this.__ctrlContainer,"position:absolute;overflow:visible;"),this.update(),t.appendChild(this.__ctrlContainer),this.onAdd&&this.onAdd(),this.fire("add",{dom:t}),this},n.update=function(){return this.__ctrlContainer.innerHTML="",this._controlDom=this.buildOn(this.getMap()),this._controlDom&&(this._updatePosition(),this.__ctrlContainer.appendChild(this._controlDom)),this},n.getMap=function(){return this._map},n.getPosition=function(){return _I({},this._parse(this.options.position))},n.setPosition=function(e){return this.options.position=CI(e)?e:_I({},e),this._updatePosition(),this},n.getContainerPoint=function(){var e,t,n=this.getPosition(),i=this.getMap().getSize();return xI(n.left)?xI(n.right)||(e=i.width-parseInt(n.right)):e=parseInt(n.left),xI(n.top)?xI(n.bottom)||(t=i.height-parseInt(n.bottom)):t=parseInt(n.top),new xA(e,t)},n.getContainer=function(){return this.__ctrlContainer},n.getDOM=function(){return this._controlDom},n.show=function(){return this.__ctrlContainer.style.display="",this},n.hide=function(){return this.__ctrlContainer.style.display="none",this},n.isVisible=function(){return this.__ctrlContainer&&""===this.__ctrlContainer.style.display},n.remove=function(){return this._map?(oO(this.__ctrlContainer),this.onRemove&&this.onRemove(),delete this._map,delete this.__ctrlContainer,delete this._controlDom,this.fire("remove"),this):this},n._parse=function(e){var n=e;return CI(e)&&(n=t.positions[n]),n},n._updatePosition=function(){var e=this.getPosition();for(var t in e||(e={top:20,left:20}),e)e.hasOwnProperty(t)&&(e[t]=parseInt(e[t]),this.__ctrlContainer.style[t]=e[t]+"px");this.fire("positionchange",{position:_I({},e)})},t}(dN(pN));DF.positions={"top-left":{top:20,left:20},"top-right":{top:20,right:20},"bottom-left":{bottom:20,left:20},"bottom-right":{bottom:20,right:20}},gL.mergeOptions({control:!0}),gL.include({addControl:function(e){return this._containerDOM.getContext||e.addTo(this),this},removeControl:function(e){return e&&e.getMap()===this?(e.remove(),this):this}});var zF="addlayer removelayer setbaselayer baselayerremove",LF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(){return this._attributionContainer=rO("div"),this._attributionContainer.className="maptalks-attribution",this._update(),this._attributionContainer},n.onAdd=function(){this.getMap().on(zF,this._update,this)},n.onRemove=function(){this.getMap().off(zF,this._update,this)},n._update=function(){var e=this.getMap();if(e){var t=e._getLayers((function(e){return e.options.attribution})).reverse().map((function(e){return e.options.attribution})),n=this.options.content+(t.length>0?" - "+t.join(", "):"");this._attributionContainer.innerHTML='<span style="padding:0px 4px">'+n+"</span>"}},t}(DF);LF.mergeOptions({position:{bottom:0,left:0},content:'<a href="http://maptalks.org" target="_blank">maptalks</a>'}),gL.mergeOptions({attribution:!0}),gL.addOnLoadHook((function(){var e=this.options.attribution||this.options.attributionControl;e&&(this.attributionControl=new LF(e),this.addControl(this.attributionControl))}));var BF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(e){var t=this._getCompass();return this._compass=t,this._registerDomEvents(),e.on("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),t},n.onAdd=function(){this._rotateCompass()},n._getCompass=function(){return rO("div","maptalks-compass")},n._registerDomEvents=function(){bO(this._compass,"click",this._resetView,this)},n._rotateCompass=function(){var e=this.getMap().getBearing().toFixed(1);e<=180&&(e*=-1),e!==this._bearing&&(this._bearing=e,mO(this._compass,"transform: rotate("+this._bearing+"deg);"))},n.onRemove=function(){this.getMap().off("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),delete this._compass,delete this._bearing},n._resetView=function(){this.getMap().animateTo({bearing:0})},t}(DF);BF.mergeOptions({position:{top:120,left:20}}),gL.mergeOptions({compassControl:!1}),gL.addOnLoadHook((function(){this.options.compassControl&&(this.compassControl=new BF(this.options.compassControl),this.addControl(this.compassControl))}));var FF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(){var e=this.container=rO("div",this.options.containerClass),t=this.panel=rO("div","panel"),n=this.button=rO("button");return e.appendChild(n),e.appendChild(t),e},n.onAdd=function(){bO(this.button,"mouseover",this._show,this),bO(this.panel,"mouseleave",this._hide,this),bO(this.getMap(),"click",this._hide,this)},n.onRemove=function(){this.panel&&(wO(this.button,"mouseover",this._show,this),wO(this.panel,"mouseleave",this._hide,this),wO(this.getMap(),"click",this._hide,this),oO(this.panel),oO(this.button),delete this.panel,delete this.button,delete this.container)},n._show=function(){vO(this.container,"shown")||(gO(this.container,"shown"),this._createPanel())},n._hide=function(e){this.panel.contains(e.toElement||e.relatedTarget)||yO(this.container,this.options.containerClass)},n._createPanel=function(){this.panel.innerHTML="";var e=rO("ul");this.panel.appendChild(e),this._renderLayers(this.getMap(),e)},n._renderLayers=function(e,t){var n=this,i=e.getBaseLayer(),r=e.getLayers(),a=r.length;if(i){var o=i.layers||[i],s=rO("li","group"),l=rO("ul"),u=rO("label");u.innerHTML=this.options.baseTitle,s.appendChild(u);for(var c=0,h=o.length;c<h;c++)this._isExcluded(o[c])&&(l.appendChild(this._renderLayer(o[c],!0)),s.appendChild(l),t.appendChild(s))}if(a){var d=rO("li","group"),f=rO("ul"),p=rO("label"),m=rO("input");m.type="checkbox",m.checked=!0,p.innerHTML=this.options.overlayTitle,d.appendChild(m),d.appendChild(p);for(var v=function(e){var t=e.target.checked,n=e.target.parentNode;if(n){var i=n.getElementsByTagName("ul")[0];if(i){var r=function(e){var n=e._layer;n&&n[t?"show":"hide"]()},a=function(e){var n=e._layer,i=e.childNodes[0];i&&(i.checked=t),n&&n[t?"show":"hide"]()};r(n),i.childNodes.forEach((function(e){a(e);var t=e.getElementsByTagName("ul")[0];t&&(r(e),t.childNodes.forEach((function(e){a(e)})))}))}}},g=0;g<a;g++){var y=r[g];this._isExcluded(y)&&(y.getLayers?function(){var e=rO("li","group"),t=rO("ul"),i=rO("label"),r=rO("input");i.innerHTML=y.getId(),r.type="checkbox",r.checked=y.isVisible(),r.onchange=v,e.appendChild(r),e.appendChild(i),e.appendChild(t),e._layer=y,f.appendChild(e),(y.getLayers()||[]).forEach((function(e){t.appendChild(n._renderLayer(e,!1,r.checked))}))}():f.appendChild(this._renderLayer(y)),y&&!y.isVisible()&&(m.checked=!1))}d.appendChild(f),t.appendChild(d),m.onchange=v}},n._isExcluded=function(e){var t=e.getId(),n=this.options.excludeLayers;return!(n.length&&n.indexOf(t)>=0)},n._renderLayer=function(e,t,n){var i=this;void 0===n&&(n=!0);var r=rO("li","layer"),a=rO("label"),o=rO("input"),s=this.getMap(),l=e.options.visible;e.options.visible=!0;var u=e.isVisible();return e.options.visible=l,r.className="layer",t?(o.type="radio",o.name="base"):o.type="checkbox",o.checked=l&&u,n||(o.checked=!1),u||o.setAttribute("disabled","disabled"),o.onchange=function(t){if("radio"===t.target.type){var n=s.getBaseLayer(),r=n.layers;if(r)for(var a=0,o=r.length;a<o;a++){var l=r[a];l[l===e?"show":"hide"]()}else n.isVisible()||n.show();s._fireEvent("setbaselayer")}else e[t.target.checked?"show":"hide"]();i.fire("layerchange",{target:e})},r.appendChild(o),a.innerHTML=e.getId(),r.appendChild(a),r._layer=e,r},t}(DF);FF.mergeOptions({position:"top-right",baseTitle:"Base Layers",overlayTitle:"Layers",excludeLayers:[],containerClass:"maptalks-layer-switcher"}),gL.mergeOptions({layerSwitcherControl:!1}),gL.addOnLoadHook((function(){this.options.layerSwitcherControl&&(this.layerSwitcherControl=new FF(this.options.layerSwitcherControl),this.addControl(this.layerSwitcherControl))}));var jF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(){var e=this.options.size;this.options.maximize||(e=[0,0]);var t=rO("div"),n=this.mapContainer=rO("div");n.style.width=e[0]+"px",n.style.height=e[1]+"px",n.className=this.options.containerClass;var i=this.button=rO("div");return i.className=this.options.buttonClass,t.appendChild(n),t.appendChild(i),t},n.onAdd=function(){this.options.maximize&&this._createOverview(),this.getMap().on("resize moving zooming rotate dragrotating viewchange",this._update,this).on("setbaselayer",this._updateBaseLayer,this).on("spatialreferencechange",this._updateSpatialReference,this),bO(this.button,"click",this._onButtonClick,this),this._updateButtonText()},n.onRemove=function(){this.getMap().off("resize moving zooming rotate dragrotating viewchange",this._update,this).off("setbaselayer",this._updateBaseLayer,this).off("spatialreferencechange",this._updateSpatialReference,this),this._overview&&(this._overview.remove(),delete this._overview,delete this._perspective),wO(this.button,"click",this._onButtonClick,this)},n.maxmize=function(){var e=this.options.size,t=this.mapContainer;return t.style.width=e[0]+"px",t.style.height=e[1]+"px",this._createOverview(),this},n.minimize=function(){this._overview&&this._overview.remove(),delete this._overview,delete this._perspective;var e=this.mapContainer;return e.style.width="0px",e.style.height="0px",this},n.getOverviewMap=function(){return this._overview},n._onButtonClick=function(){this._overview?this.minimize():this.maxmize(),this._updateButtonText()},n._updateButtonText=function(){this.button.innerHTML=this._overview?"-":"+"},n._createOverview=function(){var e=this.getMap(),t=this.mapContainer,n=e.config();_I(n,{center:e.getCenter(),zoom:this._getOverviewZoom(),zoomAnimationDuration:150,pitch:0,bearing:0,scrollWheelZoom:!1,checkSize:!1,doubleClickZoom:!1,touchZoom:!1,control:!1,draggable:!1,maxExtent:null}),this._overview=new gL(t,n),this._updateBaseLayer(),this._perspective=new NL(this._getPerspectiveCoords(),{draggable:!0,cursor:"move",symbol:this.options.symbol}).on("dragend",this._onDragEnd,this),new _B("perspective_layer",this._perspective).addTo(this._overview),this.fire("load")},n._getOverviewZoom=function(){var e=this.getMap(),t=e.getZoom(),n=e.getMinZoom(),i=this.options.level;if(i>0){for(var r=i;r>0;r--)if(t-r>=n)return t-r}else for(var a=i;a<0;a++)if(t-a>=n)return t-a;return t},n._onDragEnd=function(){var e=this._perspective.getCenter();this._overview.setCenter(e),this.getMap().panTo(e)},n._getPerspectiveCoords=function(){var e=this.getMap(),t=e.getProjection();return e.getContainerExtent().toArray().map((function(n){if(t){var i=e._containerPointToPrj(n);return e._fixPrjOnWorldWide(i),t.unproject(i)}return e.containerPointToCoordinate(n)}))},n._update=function(){if(this._overview){fO(this._overview._containerDOM);var e=this._getPerspectiveCoords();this._perspective.setCoordinates(e),this._overview.setCenterAndZoom(this.getMap().getCenter(),this._getOverviewZoom())}},n._updateSpatialReference=function(){if(this._overview){var e=this.getMap();this._overview.setSpatialReference(e.options.spatialReference)}},n._updateBaseLayer=function(){if(this._overview){var e=this.getMap().getBaseLayer();if(e){var t=e.layers,n=0;if(t)for(var i=0,r=t.length;i<r;i++)if(t[i].isVisible()){n=i;break}var a=e.toJSON(),o=null;t?(o=a.layers[n].options).visible=!0:o=a.options,this._overview.setMinZoom(o.minZoom||null).setMaxZoom(o.maxZoom||null),delete o.minZoom,delete o.maxZoom,delete a.options.canvas,a.options.visible=!0,a.options.renderer="canvas";var s=nL.fromJSON(a);for(var l in e)SI(e[l])&&e.hasOwnProperty(l)&&e[l]!==e.constructor.prototype[l]&&(s[l]=e[l]);this._overview.setBaseLayer(s)}else this._overview.setBaseLayer(null)}},t}(DF);jF.mergeOptions({level:4,position:{right:1,bottom:1},size:[300,200],maximize:!0,symbol:{lineWidth:3,lineColor:"#1bbc9b",polygonFill:"#1bbc9b",polygonOpacity:.4},containerClass:"maptalks-overview",buttonClass:"maptalks-overview-button"}),gL.mergeOptions({overviewControl:!1}),gL.addOnLoadHook((function(){this.options.overviewControl&&(this.overviewControl=new jF(this.options.overviewControl),this.addControl(this.overviewControl))}));var HF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(){var e;if(this.options.custom)CI(this.options.content)?(e=rO("div")).innerHTML=this.options.content:e=this.options.content;else{if(e=rO("div","maptalks-panel"),this.options.closeButton){var t=rO("a","maptalks-close");t.innerText="\xd7",t.href="javascript:;",t.onclick=function(){e.style.display="none"},e.appendChild(t)}var n=rO("div","maptalks-panel-content");n.innerHTML=this.options.content,e.appendChild(n)}return this.draggable=new EN(e,{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this.draggable.on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this),this.options.draggable&&this.draggable.enable(),e},n.update=function(){return this.draggable&&(this.draggable.disable(),delete this.draggable),DF.prototype.update.call(this)},n.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.update(),this},n.getContent=function(){return this.options.content},n._cancelOn=function(e){var t=(e.srcElement||e.target).tagName.toLowerCase();return"button"===t||"input"===t||"select"===t||"option"===t||"textarea"===t},n._onDragStart=function(e){this._startPos=e.mousePos,this._startPosition=_I({},this.getPosition()),this.fire("dragstart",e)},n._onDragging=function(e){var t=e.mousePos.sub(this._startPos),n=this._startPosition,i=this.getPosition();xI(i.top)||(i.top=parseInt(n.top)+t.y),xI(i.bottom)||(i.bottom=parseInt(n.bottom)-t.y),xI(i.left)||(i.left=parseInt(n.left)+t.x),xI(i.right)||(i.right=parseInt(n.right)-t.x),this.setPosition(i),this.fire("dragging",e)},n._onDragEnd=function(e){delete this._startPos,delete this._startPosition,this.fire("dragend",e)},n._getConnectPoints=function(){var e=this.getMap(),t=this.getContainerPoint(),n=this.getDOM(),i=parseInt(n.clientWidth),r=parseInt(n.clientHeight);return[e.containerPointToCoordinate(t.add(i/2,0)),e.containerPointToCoordinate(t.add(i,r/2)),e.containerPointToCoordinate(t.add(i/2,r)),e.containerPointToCoordinate(t.add(0,r/2))]},t}(DF);HF.mergeOptions({position:"top-right",draggable:!0,custom:!1,content:"",closeButton:!0});var VF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(){var e=this._getReset();return this._reset=e,this._registerDomEvents(),e},n.onAdd=function(){this._view=this.options.view?this.options.view:this.getMap().getView()},n.setView=function(e){this._view=e},n._getReset=function(){return rO("div","maptalks-reset")},n._registerDomEvents=function(){bO(this._reset,"click",this._resetView,this)},n.onRemove=function(){delete this._reset,delete this._view},n._resetView=function(){this.getMap().setView(this._view)},t}(DF);VF.mergeOptions({position:{top:156,left:20},view:null}),gL.mergeOptions({resetControl:!1}),gL.addOnLoadHook((function(){this.options.resetControl&&(this.resetControl=new VF(this.options.resetControl),this.addControl(this.resetControl))}));var UF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(e){return this._map=e,this._scaleContainer=rO("div",this.options.containerClass),this._addScales(),e.on("zoomend moving moveend",this._update,this),this._map._loaded&&this._update(),this._scaleContainer},n.onRemove=function(){this.getMap().off("zoomend moving moveend",this._update,this)},n._addScales=function(){var e="border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden;-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);";this.options.metric&&(this._mScale=aO("div",this.options.containerClass?null:e,this._scaleContainer)),this.options.imperial&&(this._iScale=aO("div",this.options.containerClass?null:e,this._scaleContainer))},n._update=function(){var e=this._map.pixelToDistance(this.options.maxWidth,0);this._updateScales(e)},n._updateScales=function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},n._updateMetric=function(e){var t=this._getRoundNum(e);this._updateScale(this._mScale,t<1e3?t+" m":t/1e3+" km",t/e)},n._updateImperial=function(e){var t,n,i,r=3.2808399*e;r>5280?(n=this._getRoundNum(t=r/5280),this._updateScale(this._iScale,n+" mile",n/t)):(i=this._getRoundNum(r),this._updateScale(this._iScale,i+" feet",i/r))},n._updateScale=function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},n._getRoundNum=function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)},t}(DF);UF.mergeOptions({position:"bottom-left",maxWidth:100,metric:!0,imperial:!1,containerClass:null}),gL.mergeOptions({scaleControl:!1}),gL.addOnLoadHook((function(){this.options.scaleControl&&(this.scaleControl=new UF(this.options.scaleControl),this.addControl(this.scaleControl))}));var qF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(e){this._map=e;var t=rO("div"),n=rO("ul","maptalks-toolbar-hx");t.appendChild(n),gO(t,this.options.vertical?"maptalks-toolbar-vertical":"maptalks-toolbar-horizonal");var i=this;function r(e,t,n,r){var a=i._getItems()[t];return function(i){return hO(i),e({target:a,index:t,childIndex:n,dom:r})}}var a=this.options.items;if(NA(a))for(var o=0,s=a.length;o<s;o++){var l=a[o],u=rO("li");if(28!==this.options.height&&(u.style.lineHeight=this.options.height+"px"),u.style.height=this.options.height+"px",u.style.cursor="pointer",/<[a-z\][\s\S]*>/i.test(l.item)){u.style.textAlign="center";var c=xO("div",l.item);u.innerHTML='<div style="margin-top:'+(this.options.height-c.height)/2+'px;">'+l.item+"</div>"}else u.innerHTML=l.item;if(l.click&&bO(u,"click",r(l.click,o,null,u)),NA(l.children)){var h=this._createDropMenu(o);u.appendChild(h),u._menu=h,bO(u,"mouseover",(function(){this._menu.style.display=""})),bO(u,"mouseout",(function(){this._menu.style.display="none"}))}n.appendChild(u)}return t},n._createDropMenu=function(e){var t=this;function n(e,n,i){var r=t._getItems()[n].children[i];return function(t){return hO(t),e({target:r,index:n,childIndex:i})}}var i=rO("div","maptalks-dropMenu"),r=this._getItems(),a=r.length,o=rO("ul"),s=r[e].children;e===a-1&&s&&(i.style.cssText="right: 0px;",o.style.cssText="right: 0px;position: absolute;",this.options.reverseMenu&&(o.style.bottom=0)),i.appendChild(rO("em","maptalks-ico"));for(var l=0,u=0,c=s.length;u<c;u++){var h=LR(s[u].item,"12px");h.width>l&&(l=h.width)}for(var d=0,f=s.length;d<f;d++){var p=s[d],m=rO("li");m.innerHTML='<a href="javascript:;">'+p.item+"</a>",m.style.cursor="pointer",m.style.width=l+24+"px",bO(m.childNodes[0],"click",n(p.click,e,d)),o.appendChild(m)}if(this.options.vertical){var v=l<95?95:l;this.options.reverseMenu?i.style.right=-(v+20+2)+"px":i.style.left=-(v+20+2)+"px"}else this.options.reverseMenu?i.style.bottom="28px":i.style.top="29px";return i.appendChild(o),i.style.display="none",i},n._getItems=function(){return this.options.items||[]},t}(DF);qF.mergeOptions({height:28,vertical:!1,position:"top-right",reverseMenu:!1,items:{}});var GF=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.buildOn=function(e){var t=this.options,n=rO("div","maptalks-zoom");if(t.zoomLevel){var i=rO("span","maptalks-zoom-zoomlevel"),r=rO("span","maptalks-zoom-zoomlevel-text");i.appendChild(r),n.appendChild(i),this._levelDOM=r}var a=rO("div","maptalks-zoom-slider"),o=rO("a","maptalks-zoom-zoomin");o.href="javascript:;",a.appendChild(o),this._zoomInButton=o;var s=rO("a","maptalks-zoom-zoomout");return s.href="javascript:;",a.appendChild(s),this._zoomOutButton=s,n.appendChild(a),e.on("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this),this._update(),this._registerDomEvents(),n},n.onRemove=function(){this.getMap().off("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this)},n._update=function(){this._updateText()},n._updateText=function(){if(this._levelDOM){var e=this.getMap().getZoom();wI(e)||(e=Math.floor(10*e)/10),this._levelDOM.innerHTML=e}},n._registerDomEvents=function(){this._zoomInButton&&bO(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&bO(this._zoomOutButton,"click",this._onZoomOutClick,this)},n._onZoomInClick=function(e){cO(e),this.getMap().zoomIn()},n._onZoomOutClick=function(e){cO(e),this.getMap().zoomOut()},t}(DF);GF.mergeOptions({position:"top-left",zoomLevel:!0,seamless:!1}),gL.mergeOptions({zoomControl:!1}),gL.addOnLoadHook((function(){this.options.zoomControl&&(this.zoomControl=new GF(this.options.zoomControl),this.addControl(this.zoomControl))}));var WF=Object.freeze({Control:DF,Attribution:LF,Compass:BF,LayerSwitcher:FF,Overview:jF,Panel:HF,Reset:VF,Scale:UF,Toolbar:qF,Zoom:GF}),ZF=function(){function e(e,t,n,i){Array.isArray(e)?(this.scale={x:e[0],y:e[1]},this.origin={x:e[2],y:e[3]}):(this.scale={x:e,y:t},this.origin={x:n,y:i})}return e.getDefault=function(e){var t=e.code.toLowerCase();return"baidu"===t?"baidu":t==="EPSG:4326".toLowerCase()||t==="EPSG:4490".toLowerCase()?"tms-global-geodetic":"identity"===t?[1,-1,0,0]:"web-mercator"},e}(),XF=6378137*Math.PI;_I(ZF,{"web-mercator":new ZF([1,-1,-XF,XF]),"tms-global-mercator":new ZF([1,1,-XF,-XF]),"tms-global-geodetic":new ZF([1,1,-180,-90]),baidu:new ZF([1,1,0,0])});var KF=function(){function e(e,t,n,i){this.map=e,this.tileSize=i,this.fullExtent=n,this.prepareTileInfo(t,n),this._xScale=n.right>=n.left?1:-1,this._yScale=n.top>=n.bottom?1:-1;var r=e.getGLRes();this._pointOrigin=e._prjToPointAtRes(new xA(this.tileSystem.origin),r),this._glRes=r}var t=e.prototype;return t.prepareTileInfo=function(e,t){if(CI(e)?e=ZF[e.toLowerCase()]:Array.isArray(e)&&(e=new ZF(e)),!e)throw new Error("Invalid TileSystem");this.tileSystem=e,this.transformation=new GN([t.right>t.left?1:-1,t.top>t.bottom?-1:1,e.origin.x,e.origin.y])},t._getTileNum=function(e,t){var n=this.tileSystem,i=this.tileSize,r=Math.floor(1e-7*n.scale.x+e.x/(i.width*t)),a=Math.ceil(1e-7*n.scale.y+e.y/(i.height*t));return{x:n.scale.x*r,y:n.scale.y*a}},t.getTileIndex=function(e,t,n){var i=this.tileSystem,r=this.transformation.transform(e,1),a=this._getTileNum(r,t);return i.scale.x<0&&(a.x-=1),i.scale.y>0&&(a.y-=1),this.getNeighorTileIndex(a.x,a.y,0,0,t,n)},t.getNeighorTileIndex=function(e,t,n,i,r,a){var o=this.tileSystem,s=e+o.scale.x*n,l=t-o.scale.y*i,u=!1,c=s,h=l,d=this._getTileFullIndex(r);return a&&(!0!==a&&"x"!==a||(d.xmax===d.xmin?s=d.xmin:s<d.xmin?(s=d.xmax-(d.xmin-s)%(d.xmax-d.xmin))===d.xmax&&(s=d.xmin):s>=d.xmax&&(s=d.xmin+(s-d.xmin)%(d.xmax-d.xmin))),!0!==a&&"y"!==a||(d.ymax===d.ymin?l=d.ymin:l>=d.ymax?l=d.ymin+(l-d.ymin)%(d.ymax-d.ymin):l<d.ymin&&(l=d.ymax-(d.ymin-l)%(d.ymax-d.ymin))===d.ymax&&(l=d.ymin))),(s<d.xmin||s>d.xmax||l>d.ymax||l<d.ymin)&&(u=!0),{x:s,y:l,idx:c,idy:h,out:u}},t._getTileFullIndex=function(e){if(this._tileFullIndex||(this._tileFullIndex={}),this._tileFullIndex[e])return this._tileFullIndex[e];var t=this.fullExtent,n=this.transformation,i=this._getTileNum(n.transform(new PN(t.left,t.top),1),e),r=this._getTileNum(n.transform(new PN(t.right,t.bottom),1),e),a=this.tileSystem;return a.scale.x<0&&(i.x-=1,r.x-=1),a.scale.y>0&&(i.y-=1,r.y-=1),this._tileFullIndex[e]=new VN(i,r),this._tileFullIndex[e]},t.getTilePrjNW=function(e,t,n,i){var r=this.tileSystem,a=this.tileSize,o=r.origin.y+this._yScale*r.scale.y*(t+(1===r.scale.y?1:0))*n*a.height,s=r.origin.x+this._xScale*r.scale.x*(e+(1===r.scale.x?0:1))*n*a.width;return i?(i.set(s,o),i):new PN(s,o)},t.getTilePointNW=function(e,t,n,i){var r=this._glRes/n,a=this.tileSystem,o=this.tileSize,s=this._pointOrigin.y*r+this._yScale*a.scale.y*(t+(1===a.scale.y?1:0))*o.height,l=this._pointOrigin.x*r+this._xScale*a.scale.x*(e+(1===a.scale.x?0:1))*o.width;return i?(i.set(l,s),i):new xA(l,s)},t.getTilePrjSE=function(e,t,n,i){var r=this.tileSystem,a=this.tileSize,o=r.origin.y+this._yScale*r.scale.y*(t+(1===r.scale.y?0:1))*n*a.height,s=r.origin.x+this._xScale*r.scale.x*(e+(1===r.scale.x?1:0))*n*a.width;return i?(i.set(s,o),i):new PN(s,o)},t.getTilePointSE=function(e,t,n,i){var r=this._glRes/n,a=this.tileSystem,o=this.tileSize,s=this._pointOrigin.y*r+this._yScale*a.scale.y*(t+(1===a.scale.y?0:1))*o.height,l=this._pointOrigin.x*r+this._xScale*a.scale.x*(e+(1===a.scale.x?1:0))*o.width;return i?(i.set(l,s),i):new xA(l,s)},t.getTilePrjExtent=function(e,t,n){var i=this.getTilePrjNW(e,t,n),r=this.getTilePrjSE(e,t,n);return new VN(i,r)},e}(),YF=new xA(0,0),JF="undefined"!=typeof Set,QF=function(){function e(){this._table=JF?new Set:{}}var t=e.prototype;return t.add=function(e){JF?this._table.add(e):this._table[e]=!0},t.has=function(e){return JF?this._table.has(e):this._table[e]},t.reset=function(){JF?this._table.clear():this._table={}},e}(),$F={urlTemplate:null,subdomains:null,errorUrl:null,repeatWorld:!0,background:!0,loadingLimitOnInteracting:3,loadingLimit:0,tileRetryCount:0,placeholder:!1,crossOrigin:null,tileSize:[256,256],offset:[0,0],tileSystem:null,fadeAnimation:!AI,fadeDuration:1e3/60*10,debug:!1,spatialReference:null,maxCacheSize:256,renderer:lA.webgl?"gl":"canvas",clipByPitch:!0,maxAvailableZoom:null,cascadeTiles:!0,zoomOffset:0,pyramidMode:1,decodeImageInWorker:!1,tileLimitPerFrame:0,tileStackStartDepth:7,tileStackDepth:6,awareOfTerrain:!0,bufferPixel:.5,mipmapTexture:!0,depthMask:!0},ej=/\{ *([\w_]+) *\}/g,tj=new xA(0,0),nj=new xA(0,0),ij=new xA(0,0),rj=new xA(0,0),aj=new xA(0,0),oj=new xA(0,0),sj=[[0,0,0],[0,0,0]],lj=[0,0,0],uj=[0,0,0],cj=[],hj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e),t.fromJSON=function(e){return e&&"TileLayer"===e.type?new t(e.id,e.options):null};var n=t.prototype;return n.forceReload=function(){return this.fire("forcereloadstart"),this.clear(),this.load(),this.fire("forcereloadend"),this},n.getTileSize=function(){if(this._tileSize)return this._tileSize;var e=this.options.tileSize;return bI(e)&&(e=[e,e]),this._tileSize=new AR(e),this._tileSize},n.getTiles=function(e,t){return this._coordCache={},this._isPyramidMode()?this._getPyramidTiles(e,t):this._getCascadeTiles(e,t)},n._isPyramidMode=function(){var e=this.getSpatialReference();return!this._disablePyramid&&!this._hasOwnSR&&this.options.pyramidMode&&e&&e.isPyramid()},n._getTileFullExtent=function(){if(this._tileFullExtent)return this._tileFullExtent;var e=this.getSpatialReference(),t=e.getFullExtent(),n=e.getResolution(0),i=this.getMap();return this._tileFullExtent=t.convertTo((function(e){return i._prjToPointAtRes(e,n,YF)})),this._tileFullExtent},n._getRootNodes=function(e){var t=this.getMap();if(this._rootNodes){var n=this._rootNodes,i=n.tiles;if(t.width!==n.mapWidth||t.height!==n.mapHeight){for(var r=this._getRootError(),a=0;a<i.length;a++)i[a].error=r;this._rootNodes.mapWidth=t.width,this._rootNodes.mapHeight=t.height}for(var o=0;o<i.length;o++)i[o].offset[0]=e[0],i[o].offset[1]=e[1];return this._rootNodes}var s=this.getSpatialReference(),l=s.getResolution(0),u=this._getTileConfig(),c=s.getFullExtent(),h=u.tileSystem,d=h.origin,f=h.scale,p=u.getTilePrjExtent(0,0,l),m=p.getWidth(),v=p.getHeight(),g=Math.abs((d.x-c.left)/m);g=Math.ceil(g-1e-5);var y=Math.abs((c.right-d.x)/m);y=Math.ceil(y-1e-5);var _=Math.ceil(Math.abs(c.top-d.y)/v);_=Math.ceil(_-1e-5);var x=Math.ceil(Math.abs(c.bottom-d.y)/v);if((y+g)*((x=Math.ceil(x-1e-5))+_)>32)return{status:0,error:"Too many root nodes"};for(var b=this._getRootError(),w=[],k=-g;k<y;k++)for(var C=-_;C<x;C++){var S=f.y<0?C:-(C+1);w.push(this.createTileNode(k,S,0,k,S,l,b))}return this._rootNodes={status:1,tiles:w,mapWidth:t.width,mapHeight:t.height},this._getRootNodes(e)},n.createTileNode=function(e,t,n,i,r,a,o,s,l,u){var c=this.getMap(),h=this.options.zoomOffset;l||(l=this._getTileConfig().getTilePrjExtent(e,t,a).convertTo((function(e){return c._prjToPointAtRes(e,a,YF)})));var d=this._getTileOffset(n);return{parent:s,layer:this.getId(),x:e,y:t,z:n,idx:i,idy:r,res:a,extent2d:l,id:u||this._getTileId(e,t,n),url:this.getTileUrl(e,t,n+h),offset:d,error:o,children:[]}},n._getRootError=function(){var e=this.getMap(),t=MI(e.getFov()),n=e.width/e.height,i=e.cameraPosition[2],r=i*Math.tan(.5*t),a=r*n,o=Math.sqrt(i*i+r*r+a*a);return e._getFovZ(0)*(o/i)*this.getSpatialReference().getResolution(0)/e.getResolution(0)},n._getPyramidTiles=function(e,t){var n=this.getMap();isNaN(+e)&&(e=this._getTileZoom(n.getZoom()));var i,r=this.getSpatialReference(),a=Math.min(e,this.getMaxZoom(),this.getMaxAvailableZoom()||1/0),o=n.projViewMatrix,s=this._getTileFullExtent(),l=this._getTileOffset(0);if(this.options.repeatWorld){var u=n.getContainerExtent(),c=this._convertToExtent2d(u),h=r.getResolution(0)/n.getResolution();if(c.within(s.copy()._scale(h))){var d=this._getRootNodes(l);if(1!==d.status)return console.warn(d.error),this._disablePyramid=!0,this.getTiles(e,t);i=d.tiles.concat()}else{var f=n.getPitch(),p=n.options.cascadePitches[1],m=Math.floor(n._getVisualHeight(p)),v=f<=p?u:new qN(0,n.height-m,n.width,n.height);this._visitedTiles=new QF;var g=this._getTiles(0-this.options.zoomOffset,v,2,t&&t.getRenderer(),!0),y=this._getRootError()*Math.pow(2,this.options.zoomOffset);g.tiles.forEach((function(e){e.error=y})),i=g.tiles}}else{var _=this._getRootNodes(l);if(1!==_.status)return console.warn(_.error),this._disablePyramid=!0,this.getTiles(e,t);i=_.tiles.concat()}for(var x=n.getGLRes(),b={0:l},w=new qN,k=[],C=[];i.length>0;){var S=i.pop();S.z!==a?(b[S.z+1]||(b[S.z+1]=this._getTileOffset(S.z+1)),this._splitNode(S,o,i,k,w,a,b[S.z+1],t&&t.getRenderer(),x),this.isParentTile(e,a,S)&&C.push(S)):(w._combine(S.extent2d),k.push(S))}return C.sort(dj),{tileGrids:[{extent:w,count:k.length,tiles:k,parents:C,offset:[0,0],zoom:e}],count:k.length}},n.isParentTile=function(e,t,n){var i=Math.max(this.getMinZoom(),e-this.options.tileStackStartDepth),r=Math.min(t,i+this.options.tileStackDepth);return n.z>=i&&n.z<r},n._splitNode=function(e,t,n,i,r,a,o,s,l){for(var u=e.z+1,c=this.getSpatialReference(),h=e.idx,d=e.idy,f=s||this.getRenderer(),p=!1,m=[],v=c.getResolution(u)/l,g=0;g<4;g++){var y=g%2,_=g>>1,x=(h<<1)+y,b=(d<<1)+_;e.children||(e.children=[]);var w=e.children[g];w||(w=this._getTileId(x,b,u),e.children[g]=w);var k=f.isTileCachedOrLoading(w),C=k&&k.info;C||(this.tileInfoCache||(this.tileInfoCache=new YO(4*this.options.maxCacheSize)),(C=this.tileInfoCache.get(w))||(C=this._createChildNode(e,y,_,o,w))),C.error=e.error/2,C.offset[0]=o[0],C.offset[1]=o[1];var S=this._isTileVisible(C,t,v,a,o);if(1===S)p=!0;else{if(-1===S)continue;if(0===S&&u!==a)return i.push(e),void r._combine(e.extent2d)}m.push(C)}u===a?p?n.push.apply(n,m):(i.push(e),r._combine(e.extent2d)):n.push.apply(n,m)},n._createChildNode=function(e,t,n,i,r){var a,o=e.extent2d,s=e.z+1,l=(e.x<<1)+t,u=(e.y<<1)+n,c=(e.idx<<1)+t,h=(e.idy<<1)+n,d=o.getWidth()/2*2,f=o.getHeight()/2*2,p=2*o.xmin,m=2*o.ymax,v=2*o.ymin,g=this._getTileConfig().tileSystem.scale.y;if(r=r||this._getTileId(c,h,s),g<0){var y=p+t*d,_=m-n*f;a=new qN(y,_-f,y+d,_)}else{var x=p+t*d,b=v+n*f;a=new qN(x,b,x+d,b+f)}var w=this.createTileNode(l,u,s,c,h,e.res/2,e.error/2,e.id,a,r);return this.tileInfoCache.add(r,w),w},n._isTileVisible=function(e,t,n,i,r){if(0===e.z)return 1;if(!this._isTileInFrustum(e,t,n,r))return-1;var a=this.options.maxError;return xI(a)&&(a=1),this._getScreenSpaceError(e,n,i,r)>=a?1:0},n._isTileInFrustum=function(e,t,n,i){if(!this._zScale){var r=this.getMap(),a=r.getGLRes();this._zScale=r.altitudeToPoint(100,a)/100}var o=this.getRenderer(),s=e.extent2d,l=s.ymin,u=s.xmax,c=s.ymax;return sj[0][0]=(s.xmin-i[0])*n,sj[0][1]=(l-i[1])*n,sj[0][2]=(e.minAltitude||o&&o.avgMinAltitude||0)*this._zScale,sj[1][0]=(u-i[0])*n,sj[1][1]=(c-i[1])*n,sj[1][2]=(e.maxAltitude||o&&o.avgMaxAltitude||0)*this._zScale,lI(t,sj)},n._getScreenSpaceError=function(e,t,n,i){var r=e.error,a=this.getMap(),o=e.extent2d,s=o.ymin,l=o.xmax,u=o.ymax;lj[0]=(o.xmin-i[0])*t,lj[1]=(s-i[1])*t,uj[0]=(l-i[0])*t,uj[1]=(u-i[1])*t;var c,h,d,f,p,m,v=(c=lj,h=uj,d=a.cameraPosition,f=Math.max(c[0]-d[0],0,d[0]-h[0]),p=Math.max(c[1]-d[1],0,d[1]-h[1]),m=Math.max(c[2]-d[2],0,d[2]-h[2]),Math.sqrt(f*f+p*p+m*m)),g=Math.max(Math.abs(v),1e-7),y=Math.abs(e.z-n);return r*(a.height<1e3||y<=1?1:y<=2?.7:.605)/g},n._getCascadeTiles=function(e,t){var n=this.getMap(),i=n.getPitch(),r=t&&t.getRenderer(),a=n.getContainerExtent(),o=[],s=0,l=this.getMinZoom(),u=n.options.cascadePitches[0],c=n.options.cascadePitches[1],h=Math.floor(n._getVisualHeight(c)),d=xI(e)?this._getTileZoom(n.getZoom()):e;if(this._visitedTiles=new QF,!xI(e)||!this.options.cascadeTiles||i<=u||!xI(l)&&d<=l){var f=i<=c?a:new qN(0,n.height-h,n.width,n.height),p=this._getTiles(d,f,2,r);return p&&(s+=p.tiles.length,o.push(p)),{tileGrids:o,count:s}}var m=Math.floor(n._getVisualHeight(u)),v=new qN(0,n.height-m,n.width,n.height),g=this._getTiles(d,v,0,r);s+=g?g.tiles.length:0,o.push(g);var y,_,x=v.ymin,b=n.getSpatialReference().getZoomDirection(),w=b;if(i>c){d-w<=l&&(w=0);var k=new qN(0,n.height-h,n.width,x);s+=(y=this._getTiles(d-w,k,1,r))?y.tiles.length:0,x=k.ymin,w+=4*b,o.push(y)}if(d-w>=l){var C=new qN(0,a.ymin,n.width,x);s+=(_=this._getTiles(d-w,C,2,r))?_.tiles.length:0,o.push(_)}return y&&_&&(o[1]=_,o[2]=y),{tileGrids:o,count:s}},n.getTileUrl=function(e,t,n){var i=this.options.urlTemplate,r="";if(this.options.subdomains){var a=this.options.subdomains;if(NA(a)){var o=(e+t)%a.length;o<0&&(o=0),r=a[o]}}if(SI(i))return i(e,t,n,r);var s={x:e,y:t,z:n,s:r};return this.options.token&&(s.token=this.options.token),this.options.customTags&&_I(s,this.options.customTags),i.replace(ej,(function(e,t){var n=s[t];if(void 0===n)throw new Error("No value provided for variable "+e);return"function"==typeof n&&(n=n(s)),n}))},n.clear=function(){return this._renderer&&this._renderer.clear(),this.tileInfoCache&&this.tileInfoCache.reset(),this.fire("clear"),this},n.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),options:this.config()}},n.getSpatialReference=function(){var e=this.getMap();if(e&&(!this.options.spatialReference||Zz.equals(this.options.spatialReference,e.options.spatialReference)))return e.getSpatialReference();if(this._sr)return this._sr;var t=this.options.spatialReference;if(CI(t)&&!(t=Zz.getPreset(t)))throw new Error("Unsupported spatial reference: "+this.options.spatialReference+", possible values: "+Zz.getAllPresets().join());return this._sr=new Zz(t),this._srMinZoom=this._sr.getMinZoom(),this._srMaxZoom=this._sr.getMaxZoom(),this._hasOwnSR=this._sr.toJSON().projection!==e.getSpatialReference().toJSON().projection,this._sr},n.getMinZoom=function(){var e=this.options.minZoom||0;return this.getSpatialReference()!==this.getMap().getSpatialReference()?Math.max(e,this._srMinZoom):e},n.getMaxZoom=function(){return this.getSpatialReference()!==this.getMap().getSpatialReference()?Math.min(e.prototype.getMaxZoom.call(this),this._srMaxZoom):e.prototype.getMaxZoom.call(this)},n._getTileZoom=function(e){if(!this._hasOwnSR){var t=this.getMap().getResolution(e),n=this.getSpatialReference().getResolution(e);e+=Math.log(n/t)*Math.LOG2E}var i=this.getMaxAvailableZoom();return!xI(i)&&e>i&&(e=i),wI(e)||(e=Math.round(e)),Math.max(0,e)},n.getMaxAvailableZoom=function(){var e=this.getSpatialReference();return this.options.maxAvailableZoom||e&&e.getMaxZoom()},n._getTiles=function(e,t,n,i,r){var a=this.getMap(),o=e,s=a.projViewMatrix,l=a.getResolution(e)/a.getResolution(e-1)==.5;n<2&&(0===n&&l&&(o-=1),s=0===n?a.cascadeFrustumMatrix0:1===n?a.cascadeFrustumMatrix1:a.projViewMatrix);var u=o+this.options.zoomOffset,c=this._getTileOffset(o),h=c[0]||c[1],d={zoom:o,extent:null,offset:c,tiles:[]};if(u<0)return d;if(!(a&&this.isVisible()&&a.width&&a.height))return d;if(!r){var f=this.getMinZoom(),p=this.getMaxZoom();if(!xI(f)&&o<f||!xI(p)&&o>p)return d}var m=this._getTileConfig();if(!m)return d;var v,g={zoom:c},y=this.getSpatialReference().getResolution(o);v=this._hasOwnSR?a.getGLScale(o):y/a.getGLRes();var _=!this._hasOwnSR&&this.options.repeatWorld,x=this._convertToExtent2d(t),b=this._getMask2DExtent();if(b){var w=b.intersection(x);if(!w)return d;t=w.convertTo((function(e){return a._pointToContainerPoint(e,void 0,0,YF)}))}var k,C=a._containerPointToPrj(t.getCenter(),tj),S=a._prjToPoint(C,o,nj);k=this._project(h?a._pointToPrj(S._add(c),o,nj):C,nj);var T=a.getGLScale()/a.getGLScale(o);ij.x=x.xmin*T,ij.y=x.ymax*T,rj.x=x.xmax*T,rj.y=x.ymin*T;for(var E=this._project(a._pointToPrj(ij._add(c),o,ij),ij),P=this._project(a._pointToPrj(rj._add(c),o,rj),rj),M=m.getTileIndex(k,y,_),I=m.getTileIndex(E,y,_),A=m.getTileIndex(P,y,_),R=Math.ceil(Math.abs(M.idy-I.idy)),O=Math.ceil(Math.abs(M.idx-I.idx)),N=Math.ceil(Math.abs(M.idy-A.idy)),D=Math.ceil(Math.abs(M.idx-A.idx)),z=(R+N+1)*(O+D+1),L=this.getTileSize(),B=this.getRenderer()||i,F=this._getTileConfig().tileSystem.scale,j=[],H=new qN,V=new xA(0,0),U=-R;U<=N;U++)for(var q=-O,G=-1/0,W=!1;q>=G&&q<=D;){var Z=m.getNeighorTileIndex(M.idx,M.idy,q,U,y,_);G===-1/0?q++:q--;var X=this._getTileId(Z.idx,Z.idy,o);if(!(Z.out||this._visitedTiles&&this._visitedTiles.has(X))){var K=B&&B.isTileCachedOrLoading(X);K&&(K=K.info);var Y=void 0;if(K){var J=K.extent2d;V.set(J.xmin,J.ymax),Y=V}else if(this._hasOwnSR){var Q=m.getTilePrjNW(Z.x,Z.y,y);Y=a._prjToPoint(this._unproject(Q,rj),o)}else Y=m.getTilePointNW(Z.x,Z.y,y);var $=void 0,ee=void 0;if(this._hasOwnSR){var te=void 0;if(this._hasOwnSR){var ne=m.getTilePrjSE(Z.x,Z.y,y);te=a._prjToPoint(this._unproject(ne,rj),o,rj)}else te=m.getTilePointSE(Z.x,Z.y,y);$=Math.ceil(Math.abs(te.x-Y.x)),ee=Math.ceil(Math.abs(te.y-Y.y))}else $=L.width,ee=L.height;var ie=F.x*(Z.idx-Z.x)*$,re=F.y*(Z.idy-Z.y)*ee;K||!ie&&!re||Y._add(ie,re);var ae=K&&K.extent2d||new qN(Y.x,Y.y-ee,Y.x+$,Y.y);if(z<=4||W||this._isTileInExtent(s,ae,c,v)){var oe=this._hasOwnSR?a._getResolution(o):y;this._visitedTiles&&0===n&&this._visitedTiles.add(X),l&&0===n?(this._splitTiles(s,j,B,Z,o+1,oe,ae,ie,re,g),H._combine(ae)):(K?(K.offset[0]=c[0],K.offset[1]=c[1]):K=this.createTileNode(Z.x,Z.y,o,Z.idx,Z.idy,oe,0,null,ae,X),j.push(K),H._combine(ae)),G===-1/0?(G=q,q=D):W||(W=!0)}}}if(j.length){var se=a._containerPointToPoint(t.getCenter(),o,YF)._add(c),le=new xA(0,0),ue=new xA(0,0);j.sort((function(e,t){return le.set((e.extent2d.xmin+e.extent2d.xmax)/2,(e.extent2d.ymin+e.extent2d.ymax)/2),ue.set((t.extent2d.xmin+t.extent2d.xmax)/2,(t.extent2d.ymin+t.extent2d.ymax)/2),le.distanceTo(se)-ue.distanceTo(se)}))}return{offset:c,zoom:e,extent:H,tiles:j}},n._convertToExtent2d=function(e){var t=this,n=this.getMap();return e.convertTo((function(e){if(e.y>0&&e.y<n.height){var i=(0===e.x?0:1)+e.y;t._coordCache[i]||(t._coordCache[i]=n._containerPointToPoint(e))}return n._containerPointToPoint(e,void 0,YF)}))},n._splitTiles=function(e,t,n,i,r,a,o,s,l,u){var c=this._getTileConfig().tileSystem.scale.y,h=this.getMap().getGLScale(r),d=aj.set(2*o.xmin,c<0?2*o.ymax:2*o.ymin),f=o.getWidth(),p=o.getHeight(),m=2*i.idx,v=2*i.idy,g=2*i.x,y=2*i.y,_=this._checkAndAddTile(e,n,m,v,g,y,r,a,0,0,f,p,d,h,u);_&&t.push(_),(_=this._checkAndAddTile(e,n,m,v,g,y,r,a,0,1,f,p,d,h,u))&&t.push(_),(_=this._checkAndAddTile(e,n,m,v,g,y,r,a,1,0,f,p,d,h,u))&&t.push(_),(_=this._checkAndAddTile(e,n,m,v,g,y,r,a,1,1,f,p,d,h,u))&&t.push(_)},n._checkAndAddTile=function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p){var m=this._getTileId(n+l,i+u,o);if(this._visitedTiles&&this._visitedTiles.has(m))return null;var v=p[o];v||(v=p[o]=this._getTileOffset(o));var g=this._getTileConfig().tileSystem.scale.y,y=new qN(d.x+l*c,d.y+g*u*h,d.x+(l+1)*c,d.y+g*(u+1)*h);if(!this._isSplittedTileInExtent(e,y,v,f))return null;var _=s/2,x=t&&t.isTileCachedOrLoading(m);return x?x.info:this.createTileNode(r+l,a+u,o,n+l,n+a,_,0,null,y,m)},n._getTileOffset=function(){var e=this.options.offset;if(SI(e)){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e=(t=e).call.apply(t,[this].concat(i))}return bI(e)&&(e=[e,e]),e||[0,0]},n.getTileId=function(e,t,n,i){return this._getTileId(e,t,n,i)},n._getTileId=function(e,t,n,i){return(i||this.getId())+"_"+e+"_"+t+"_"+n},n._project=function(e,t){if(this._hasOwnSR){var n=this.getMap().getProjection();return this.getSpatialReference().getProjection().project(n.unproject(e,t),t)}return e},n._unproject=function(e,t){if(this._hasOwnSR){var n=this.getMap(),i=this.getSpatialReference(),r=n.getProjection(),a=i.getProjection();return r.project(a.unproject(e,t),t)}return e},n._initTileConfig=function(){var e=this.getMap(),t=this.getTileSize(),n=this.getSpatialReference(),i=n.getProjection(),r=n.getFullExtent();this._defaultTileConfig=new KF(e,ZF.getDefault(i),r,t),this.options.hasOwnProperty("tileSystem")&&(this._tileConfig=new KF(e,this.options.tileSystem,r,t)),delete this._rootNodes,delete this._tileFullExtent,delete this._disablePyramid},n._getTileConfig=function(){return this._defaultTileConfig||this._initTileConfig(),this._tileConfig||this._defaultTileConfig},n._bindMap=function(t){var n=t.getBaseLayer();return n===this&&(n.options.hasOwnProperty("forceRenderOnMoving")||this.config({forceRenderOnMoving:!0})),this._onSpatialReferenceChange(),e.prototype._bindMap.apply(this,arguments)},n._isTileInExtent=function(e,t,n,i){var r,a=this.getMap();if(e!==a.projViewMatrix){var o=t.getCenter(oj)._sub(n[0],n[1])._multi(i);LB(cj,o.x,o.y,0),r=function(e,t,n){var i=t[0],r=t[1],a=t[2],o=n[3]*i+n[7]*r+n[11]*a+n[15];return e[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/(o=o||1),e[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/o,e[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/o,e}(cj,cj,a.projViewMatrix)[1]<0?a.projViewMatrix:e}else r=a.projViewMatrix;return sj[0][0]=(t.xmin-n[0])*i,sj[0][1]=(t.ymin-n[1])*i,sj[1][0]=(t.xmax-n[0])*i,sj[1][1]=(t.ymax-n[1])*i,lI(r,sj)},n._isSplittedTileInExtent=function(e,t,n,i){var r=this.getMap();return sj[0][0]=(t.xmin-n[0])*i,sj[0][1]=(t.ymin-n[1])*i,sj[1][0]=(t.xmax-n[0])*i,sj[1][1]=(t.ymax-n[1])*i,lI(r.projViewMatrix,sj)},n.getEvents=function(){return{spatialreferencechange:this._onSpatialReferenceChange}},n._onSpatialReferenceChange=function(){delete this._tileConfig,delete this._defaultTileConfig,delete this._sr,delete this._srMinZoom,delete this._hasOwnSR,delete this._rootNodes,this.tileInfoCache&&this.tileInfoCache.reset();var e=this.getRenderer();e&&e.clear()},n.getPolygonOffsetCount=function(){return 2},n.getPolygonOffset=function(){return this._polygonOffset||0},n.setPolygonOffset=function(e){return this._polygonOffset=e,this},t}(nL);function dj(e,t){return e.z-t.z}hj.registerJSONType("TileLayer"),hj.mergeOptions($F);var fj=new AR(256,256),pj="show hide remove setzindex forcereloadstart";function mj(e){return Array.isArray(e)||(e=[e]),e}var vj=function(e){function t(t,n,i){var r;return(r=e.call(this,t,i)||this).layers=n||[],r._checkChildren(),r.layerMap={},r._groupChildren=[],r}cA(t,e),t.fromJSON=function(e){if(!e||"GroupTileLayer"!==e.type)return null;var n=e.layers.map((function(e){return nL.fromJSON(e)}));return new t(e.id,n,e.options)};var n=t.prototype;return n.getLayers=function(){return this.layers},n.addLayer=function(e){var t=this;void 0===e&&(e=[]),e=mj(e);var n=this.layers.length;return e.forEach((function(e){e instanceof hj&&(-1!==t.layers.indexOf(e)||t.layerMap[e.getId()]||t.layers.push(e))})),n!==this.layers.length&&(this._sortLayers(),this._refresh(),this._renderLayers()),this},n.removeLayer=function(e){var t=this;void 0===e&&(e=[]),e=mj(e);var n=this.layers.length;return e.forEach((function(e){if(e instanceof hj||(e=t.layerMap[e]),e instanceof hj){var n=t.layers.indexOf(e);n>=0&&(t.layers.splice(n,1),e._doRemove(),e.off(pj,t._onLayerShowHide,t))}})),n!==this.layers.length&&(this._refresh(),this._renderLayers()),this},n.clearLayers=function(){var e=this;return this.layers.forEach((function(t){t._doRemove(),t.off(pj,e._onLayerShowHide,e)})),this.layers=[],this._refresh(),this._renderLayers(),this},n.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),layers:this.layers.map((function(e){return e.toJSON()})),options:this.config()}},n.getTileSize=function(e){var t=this.getLayer(e);return t?t.getTileSize():fj},n.getTiles=function(e,t){for(var n=this.layers,i=[],r=0,a=0,o=n.length;a<o;a++){var s=n[a];if(s&&s.options.visible&&s.isVisible()&&s.getMap()){var l=s.getTiles(e,t||this);l&&0!==l.count&&(r+=l.count,TA(i,l.tileGrids))}}return{count:r,tileGrids:i}},n.onAdd=function(){this._sortLayers(),this._refresh(),e.prototype.onAdd.call(this)},n.onRemove=function(){var t=this;this.layers.forEach((function(e){e._doRemove(),e.off(pj,t._onLayerShowHide,t)})),this.layerMap={},this._groupChildren=[],e.prototype.onRemove.call(this)},n.getLayer=function(e){return this.getChildLayer(e)},n.getChildLayer=function(e){var t=this.layerMap[e];if(t)return t;for(var n=0;n<this._groupChildren.length;n++){var i=this._groupChildren[n].getChildLayer(e);if(i)return i}return null},n._removeChildTileCache=function(e){if(!e)return this;var t,n=this.getRenderer();if(!n)return this;var i=e.getId(),r=function(){return t&&t.info&&t.info.layer===i};n.tileCache&&n.tileCache.keys().forEach((function(e){t=n.tileCache.get(e),r()&&n.tileCache.remove(e)}));var a=n.tilesInView||{};for(var o in a)t=a[o],r()&&delete a[o];var s=n.tilesLoading||{};for(var l in s)t=s[l],r()&&n.abortTileLoading(t.image,t.info);return this},n._onLayerShowHide=function(e){var t=e||{},n=t.type,i=t.target;return"remove"===n&&i?(this.layers.splice(this.layers.indexOf(i),1),i._doRemove(),i.off(pj,this._onLayerShowHide,this),this._refresh()):"setzindex"===n?this._sortLayers():"forcereloadstart"===n&&this._removeChildTileCache(i),this._renderLayers(),this},n._renderLayers=function(){var e=this.getRenderer();return e&&e.setToRedraw(),this},n._refresh=function(){var e=this,t=this.getMap();return this._groupChildren=[],this.layerMap={},this.layers.forEach((function(n){e.layerMap[n.getId()]=n,n.getChildLayer&&e._groupChildren.push(n),n.getMap()||n._bindMap(t),n.off(pj,e._onLayerShowHide,e),n.on(pj,e._onLayerShowHide,e)})),this},n.isVisible=function(){if(!e.prototype.isVisible.call(this))return!1;for(var t=this.layers,n=0,i=t.length;n<i;n++)if(t[n].isVisible())return!0;return!1},n._checkChildren=function(){var e=this,t={};this.layers.forEach((function(n){var i=n.getId();if(t[i])throw new Error("Duplicate child layer id ("+i+") in the GroupTileLayer ("+e.getId()+")");t[i]=1}))},n._sortLayers=function(){this.layers.sort((function(e,t){return e.options.zIndex-t.options.zIndex}))},t}(hj);vj.registerJSONType("GroupTileLayer"),vj.mergeOptions({maxCacheSize:1024});var gj,yj={crs:null,uppercase:!1,detectRetina:!1},_j={service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},xj=function(e){function t(t,n){var i;return i=e.call(this,t)||this,gj||(gj=_I({},i.options)),i.wmsParams=_I({},_j),i.setOptions(n),i.setZIndex(n.zIndex),lA.proxy||i._optionsHook(n),i}cA(t,e);var n=t.prototype;return n._optionsHook=function(e){for(var t in void 0===e&&(e={}),e)"tileSize"===t&&(this._tileSize=null),t in gj||(this.wmsParams[t]=e[t]);var n=this.getTileSize();return this.wmsParams.width=n.width,this.wmsParams.height=n.height,this._wmsVersion=parseFloat(this.wmsParams.version),this},n.onAdd=function(){var t=this.getMap().getDevicePixelRatio(),n=yj.detectRetina?t:1;this.wmsParams.width*=n,this.wmsParams.height*=n;var i=this.options.crs||this.getMap().getProjection().code;this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=i,e.prototype.onAdd.call(this)},n.getTileUrl=function(t,n,i){var r=this.getSpatialReference().getResolution(i),a=this._getTileConfig().getTilePrjExtent(t,n,r),o=a.getMax(),s=a.getMin(),l=(this._wmsVersion>=1.3&&("EPSG:4326"===this.wmsParams.crs||"EPSG:4490"===this.wmsParams.crs)?[s.y,s.x,o.y,o.x]:[s.x,s.y,o.x,o.y]).join(","),u=e.prototype.getTileUrl.call(this,t,n,i);return u+function(e,t,n){var i=[];for(var r in e)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(e[r]));return(t&&-1!==t.indexOf("?")?"&":"?")+i.join("&")}(this.wmsParams,u,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+l},n.toJSON=function(){return{type:"WMSTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return e&&"WMSTileLayer"===e.type?new t(e.id,e.options):null},t}(hj);xj.registerJSONType("WMSTileLayer"),xj.mergeOptions(yj);var bj=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).options.hasOwnProperty("forceRenderOnMoving")||(i.options.forceRenderOnMoving=!1),i}cA(t,e);var n=t.prototype;return n.drawTile=function(){},n.toJSON=function(){return{type:"CanvasTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return e&&"CanvasTileLayer"===e.type?new t(e.id,e.options):null},t}(hj);function wj(e,t,n){var i=e.createShader(t);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(i);throw e.deleteShader(i),new Error("Failed to compile shader: "+r)}return i}function kj(e,t,n){var i=wj(e,e.VERTEX_SHADER,t),r=wj(e,e.FRAGMENT_SHADER,n);if(!i||!r)return null;var a=e.createProgram();return a?(e.attachShader(a,i),e.attachShader(a,r),e.linkProgram(a),{program:a,vertexShader:i,fragmentShader:r}):null}function Cj(e,t,n){if(Array.isArray(n[0])){for(var i=Float32Array.BYTES_PER_ELEMENT,r=0,a=0;a<n.length;a++)r+=n[a][1]||0;for(var o=0,s=0;s<n.length;s++){var l=e.getAttribLocation(t,n[s][0]);if(l<0)throw new Error("Failed to get the storage location of "+n[s][0]);e.vertexAttribPointer(l,n[s][1],e[n[s][2]||"FLOAT"],!1,i*r,i*o),o+=n[s][1]||0,e.enableVertexAttribArray(l)}}else{var u=e.getAttribLocation(t,n[0]);e.vertexAttribPointer(u,n[1],e[n[2]||"FLOAT"],!1,0,0),e.enableVertexAttribArray(u)}}bj.registerJSONType("CanvasTileLayer");var Sj={never:512,"<":513,"=":514,"<=":515,">":516,"!=":517,">=":518,always:519},Tj=[1,1,1,1],Ej=[0,0],Pj=[0,0,0],Mj=new Array(16),Ij=new xA(20,20),Aj=function(e){var t,n=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.drawGLImage=function(e,t,n,i,r,a,o,s,l){this.gl.program!==this.program&&this.useProgram(this.program);var u=this.gl;if(this.loadTexture(e),this.canvas.gl&&this.canvas.gl.wrap){var c=this.layer&&this.layer.options.opacity;xI(c)&&(c=1),o*=c}Pj[0]=t||0,Pj[1]=n||0,Pj[2]=0;var h=this.layer;if(h){var d=h.options.altitude,f=bI(d);if(f||(this._layerAlt=0),this._layerAltitude!==d&&f){var p=h.getMap();if(p){var m=p.altitudeToPoint(d,p.getGLRes());this._layerAltitude=d,this._layerAlt=m}}}Pj[2]=this._layerAlt||0;var v=DB(Mj);AB(v,v,Pj),RB(v,v,[a,a,1]),OB(v,this.getMap().projViewMatrix,v),u.uniformMatrix4fv(this.program.u_matrix,!1,v),u.uniform1f(this.program.u_opacity,o),u.uniform1f(this.program.u_debug_line,0),u.uniform4fv(this.program.u_base_color,l||Tj),u.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0);var g=e.glBuffer;!g||g.width===i&&g.height===r||(this.saveImageBuffer(g),delete e.glBuffer),e.glBuffer?u.bindBuffer(u.ARRAY_BUFFER,g):e.glBuffer=this.bufferTileData(0,0,i,r),Ej[0]="a_position",Ej[1]=2,Ej[2]=e.glBuffer.type,this.enableVertexAttrib(Ej),u.bindBuffer(u.ARRAY_BUFFER,this.texBuffer),Ej[0]="a_texCoord",Ej[1]=2,Ej[2]="UNSIGNED_BYTE",this.enableVertexAttrib(Ej),u.drawArrays(u.TRIANGLE_STRIP,0,4),s&&this.drawDebug(v,0,0,i,r,s)},n.drawDebug=function(e,t,n,i,r,a){var o=this.gl;o.disable(o.DEPTH_TEST),o.bindBuffer(o.ARRAY_BUFFER,this._debugBuffer),this.enableVertexAttrib(["a_position",2,"FLOAT"]),o.bufferData(o.ARRAY_BUFFER,new Float32Array([t,n,t+i,n,t+i,n-r,t,n-r,t,n]),o.DYNAMIC_DRAW),o.uniformMatrix4fv(this.program.u_matrix,!1,e),o.uniform1f(this.program.u_opacity,1),o.uniform1f(this.program.u_debug_line,1),o.uniform4fv(this.program.u_base_color,Tj),o.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0),o.drawArrays(o.LINE_STRIP,0,5);var s=this._debugInfoCanvas;if(!s){var l=this.getMap().getDevicePixelRatio()>1?2:1;(s=this._debugInfoCanvas=document.createElement("canvas")).width=256*l,s.height=32*l;var u=s.getContext("2d");u.font="20px monospace",u.scale(l,l)}var c=s.getContext("2d");c.clearRect(0,0,s.width,s.height),oN.fillText(c,a,Ij,this.layer.options.debugOutline),this.loadTexture(s),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,s);var h=t+(i=256),d=n-r+32,f=n-r;o.bufferData(o.ARRAY_BUFFER,this.set8(t,d,t,f,h,d,h,f),o.DYNAMIC_DRAW),o.uniform1f(this.program.u_debug_line,0),o.bindBuffer(o.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2,"UNSIGNED_BYTE"]),o.drawArrays(o.TRIANGLE_STRIP,0,4),o.enable(o.DEPTH_TEST)},n.bufferTileData=function(e,t,n,i,r){var a,o=e,s=e+n,l=t,u=t-i;a=wI(o)&&wI(s)&&wI(l)&&wI(u)?this.set8Int(o,l,o,u,s,l,s,u):this.set8(o,l,o,u,s,l,s,u);var c=this.loadImageBuffer(a,r);return c.width=n,c.height=i,c.type=a instanceof Int16Array?"SHORT":"FLOAT",c},n.drawTinImage=function(e,t,n,i,r){var a=this.gl;this.loadTexture(e),a.uniformMatrix4fv(this.program.u_matrix,!1,this.getMap().projViewMatrix),a.uniform1f(this.program.u_opacity,r),a.bindBuffer(a.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),a.bufferData(a.ARRAY_BUFFER,new Float32Array(n),a.DYNAMIC_DRAW),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),a.DYNAMIC_DRAW),a.drawElements(a.TRIANGLES,i.length,a.UNSIGNED_SHORT,0)},n.createCanvas2=function(){this.canvas2=oN.createCanvas(this.canvas.width,this.canvas.height)},n.createGLContext=function(){this.gl=this.canvas.gl&&this.canvas.gl.wrap?this.canvas.gl.wrap():function(e,t){for(var n={alpha:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!1},i=["webgl","experimental-webgl"],r=null,a=0;a<i.length;++a){try{r=e.getContext(i[a],t||n)}catch(q5){}if(r)break}return r}(this.canvas2||this.canvas,this.layer.options.glOptions);var e=this.gl;e.clearColor(0,0,0,0),e.enable(e.DEPTH_TEST),e.enable(e.STENCIL_TEST),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.program=this.createProgram("\n        attribute vec2 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\n\n            v_texCoord = a_texCoord;\n        }\n    ",this.layer.options.fragmentShader||"\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n        uniform float u_debug_line;\n        uniform vec4 u_base_color;\n        uniform float u_alpha_test;\n        varying vec2 v_texCoord;\n\n        void main() {\n            if (u_debug_line == 1.) {\n                gl_FragColor = vec4(0., 1., 0., 1.);\n            } else {\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n            }\n            gl_FragColor *= u_base_color;\n            if (gl_FragColor.a < u_alpha_test) {\n                discard;\n            }\n        }\n    "),this._debugBuffer=this.createBuffer(),this.useProgram(this.program),this.texBuffer=this.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2,"UNSIGNED_BYTE"]),e.bufferData(e.ARRAY_BUFFER,new Uint8Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW),this.enableSampler("u_image"),e.activeTexture(e.TEXTURE0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)},n.resizeGLCanvas=function(){this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2&&(this.canvas2.width===this.canvas.width&&this.canvas2.height===this.canvas.height||(this.canvas2.width=this.canvas.width,this.canvas2.height=this.canvas.height))},n.clearGLCanvas=function(){this.gl&&(this.gl.clearStencil(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)),this.gl.wrap||this.gl.clear(this.gl.DEPTH_BUFFER_BIT)},n.disposeImage=function(e){e&&(e.texture&&this.saveTexture(e.texture),e.glBuffer&&this.saveImageBuffer(e.glBuffer),delete e.texture,delete e.glBuffer)},n._createTexture=function(e){var t=this.gl,n=this.getTexture()||t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);var i=this.layer.options.mipmapTexture;return!i||Rj(e.width)&&Rj(e.height)||(e=function(e){if(Rj(e.width)&&Rj(e.height))return e;var t=e.width,n=e.height;Rj(t)||(t=Oj(t)),Rj(n)||(n=Oj(n));var i=document.createElement("canvas");i.width=t,i.height=n;var r=i.getContext("2d");return r.imageSmoothingEnabled=!1,r.drawImage(e,0,0,t,n),i}(e)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),i&&t.generateMipmap(t.TEXTURE_2D),n},n.getTexture=function(){this._textures||(this._textures=[]);var e=this._textures;return e&&e.length>0?e.pop():null},n.saveTexture=function(e){this._textures.push(e)},n.loadTexture=function(e){var t=this.getMap(),n=this.gl,i=e.texture;return i||(i=this._createTexture(e),e.texture=i),n.bindTexture(n.TEXTURE_2D,i),this.layer.options.mipmapTexture&&(t.isMoving()&&t.getRenderer().isViewChanged()?n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR):n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR)),i},n.getImageBuffer=function(){this._imageBuffers||(this._imageBuffers=[]);var e=this._imageBuffers;return e&&e.length>0?e.pop():null},n.saveImageBuffer=function(e){this._imageBuffers||(this._imageBuffers=[]),this._imageBuffers.push(e)},n.loadImageBuffer=function(e,t){var n=this.gl,i=t||this.createImageBuffer();return n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW),i},n.createImageBuffer=function(){return this.getImageBuffer()||this.createBuffer()},n.removeGLCanvas=function(){var e=this.gl;if(e){if(this._debugBuffer&&(e.deleteBuffer(this._debugBuffer),delete this._debugBuffer),this._buffers&&(this._buffers.forEach((function(t){e.deleteBuffer(t)})),delete this._buffers),this._textures&&(this._textures.forEach((function(t){return e.deleteTexture(t)})),delete this._textures),this._debugInfoCanvas){var t=this._debugInfoCanvas.texture;t&&e.deleteTexture(t),delete this._debugInfoCanvas.texture,delete this._debugInfoCanvas}var n=e.program;e.deleteShader(n.fragmentShader),e.deleteShader(n.vertexShader),e.deleteProgram(n),delete this.gl,delete this.canvas2}},n.createBuffer=function(){var e=this.gl.createBuffer();if(!e)throw new Error("Failed to create the buffer object");return this._buffers||(this._buffers=[]),this._buffers.push(e),e},n.enableVertexAttrib=function(e){Cj(this.gl,this.gl.program,e)},n.createProgram=function(e,t){for(var n=this.gl,i=kj(n,e,t),r=i.program,a=i.vertexShader,o=i.fragmentShader,s=n.getProgramParameter(r,35718),l=[],u=0;u<s;++u){var c=n.getActiveUniform(r,u);l.push(c.name)}return r.vertexShader=a,r.fragmentShader=o,this._initUniforms(r,l),r},n.useProgram=function(e){var t=this.gl;return t.useProgram(e),t.program=e,this},n.enableSampler=function(e,t){var n=this.gl,i=this._getUniform(n.program,e);return t||(t=0),n.uniform1i(i,t),i},n._initUniforms=function(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=t[n],a=i.indexOf("[");a>=0&&(i=i.substring(0,a),AI||(r=r.substring(0,a))),e[i]=this._getUniform(e,r)}},n._getUniform=function(e,t){var n=this.gl.getUniformLocation(e,t);if(!n)throw new Error("Failed to get the storage location of "+t);return n},t}(e);return _I(n.prototype,{set8:(t=lA.ie9?null:new Float32Array(8),function(e,n,i,r,a,o,s,l){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t}),set8Int:function(){var e=lA.ie9?null:new Int16Array(8);return function(t,n,i,r,a,o,s,l){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e[4]=a,e[5]=o,e[6]=s,e[7]=l,e}}()}),n};function Rj(e){return 0==(e&e-1)&&0!==e}function Oj(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}var Nj={renderer:lA.webgl?"gl":"canvas",crossOrigin:null,alphaTest:0,depthMask:!0,depthFunc:"<="},Dj=new xA(0,0),zj=function(e){function t(t,n,i){var r;return!n||Array.isArray(n)||n.url||(i=n,n=null),(r=e.call(this,t,i)||this)._images=n,r}cA(t,e);var n=t.prototype;return n.onAdd=function(){this._prepareImages(this._images)},n.setImages=function(e){return this._images=e,this._prepareImages(e),this},n.getImages=function(){return this._images},n._prepareImages=function(e){e=e||[],Array.isArray(e)||(e=[e]);var t=this.getMap(),n=t.getGLRes();this._imageData=e.map((function(e){var i=new VN(e.extent);return _I({},e,{extent:i,extent2d:i.convertTo((function(e){return t.coordToPointAtRes(e,n)}))})})),this._images=e;var i=this.getRenderer();i&&i.refreshImages()},t}(nL);zj.mergeOptions(Nj);var Lj=[],Bj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("ImageLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),!1)},n.checkResources=function(){var e=this;if(this._imageLoaded)return Lj;var t=this.layer._imageData.map((function(e){return[e.url,null,null]}));if(this.resources){var n=[],i=new AD;t.forEach((function(t){if(e.resources.isResourceLoaded(t)){var r=e.resources.getImage(t);i.addResource(t,r)}else n.push(t)})),this.resources.forEach((function(t,n){i.isResourceLoaded(t)||e.retireImage(n.image)})),this.resources=i,t=n}return this._imageLoaded=!0,t},n.retireImage=function(e){e.close&&e.close()},n.refreshImages=function(){this._imageLoaded=!1,this.setToRedraw()},n.draw=function(e,t){this.isDrawable()&&(this.prepareCanvas(),this._painted=!1,this._drawImages(e,t),this.completeRender())},n._drawImages=function(){var e=this.layer._imageData,t=this.getMap(),n=t._get2DExtentAtRes(t.getGLRes());if(e&&e.length)for(var i=0;i<e.length;i++){var r=e[i].extent2d,a=this.resources&&this.resources.getImage(e[i].url);a&&n.intersects(r)&&(this._painted=!0,this._drawImage(a,r,e[i].opacity||1))}},n._drawImage=function(e,t,n){var i=0,r=this.context;n<1&&(i=r.globalAlpha,r.globalAlpha=n);var a=this.getMap(),o=Dj.set(t.xmin,t.ymax),s=a._pointAtResToContainerPoint(o,a.getGLRes()),l=s.x,u=s.y,c=a.getBearing();c&&(r.save(),r.translate(l,u),c&&r.rotate(-c*Math.PI/180),l=u=0);var h=a.getGLScale();r.drawImage(e,l,u,t.getWidth()/h,t.getHeight()/h),c&&r.restore(),i&&(r.globalAlpha=i)},n.drawOnInteracting=function(){this.draw()},t}(ID),Fj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.drawOnInteracting=function(e,t,n){this.draw(t,n)},n._prepareGLContext=function(){var e=this.gl;e&&(e.disable(e.STENCIL_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.depthFunc(Sj[this.layer.options.depthFunc]),e.depthMask(!!this.layer.options.depthMask))},n._drawImages=function(t,n){var i=this.gl;if(n&&n.renderTarget){var r=n.renderTarget.fbo;if(r){var a=n.renderTarget.getFramebuffer(r);i.bindFramebuffer(i.FRAMEBUFFER,a)}}this._prepareGLContext(),e.prototype._drawImages.call(this),n&&n.renderTarget&&n.renderTarget.fbo&&i.bindFramebuffer(i.FRAMEBUFFER,null)},n.isDrawable=function(){return!0},n._drawImage=function(e,t,n){this.drawGLImage(e,t.xmin,t.ymax,t.getWidth(),t.getHeight(),1,n)},n.createContext=function(){this.createGLContext()},n.resizeCanvas=function(t){this.canvas&&(e.prototype.resizeCanvas.call(this,t),this.resizeGLCanvas())},n.clearCanvas=function(){this.canvas&&(e.prototype.clearCanvas.call(this),this.clearGLCanvas())},n.retireImage=function(e){e.close&&e.close(),this.disposeImage(e)},n.onRemove=function(){this.removeGLCanvas(),e.prototype.onRemove.call(this)},t}(Aj(Bj));zj.registerRenderer("canvas",Bj),zj.registerRenderer("gl",Fj);var jj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.getPrepareParams=function(){return[]},n.getDrawParams=function(){return[]},n.onCanvasCreate=function(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=oN.createCanvas(this.canvas.width,this.canvas.height,this.getMap().CanvasClass))},n.needToRedraw=function(){return!!this.layer.options.animation||!(this.getMap().isInteracting()&&!this.layer.drawOnInteracting)&&e.prototype.needToRedraw.call(this)},n.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer.apply(this,arguments)},n.drawOnInteracting=function(){this._drawLayerOnInteracting.apply(this,arguments)},n.getCanvasImage=function(){var t=e.prototype.getCanvasImage.call(this);if(t&&t.image&&this.layer.options.doubleBuffer){var n=t.image;this.buffer.width===n.width&&this.buffer.height===n.height||(this.buffer.width=n.width,this.buffer.height=n.height);var i=this.buffer.getContext("2d"),r=this.layer.doubleBuffer(i,this.context);(void 0===r||r)&&(oN.image(i,n,0,0),t.image=this.buffer)}return t},n.remove=function(){return delete this._drawContext,e.prototype.remove.call(this)},n.onZoomStart=function(t){this.layer.onZoomStart(t),e.prototype.onZoomStart.call(this,t)},n.onZooming=function(t){this.layer.onZooming(t),e.prototype.onZooming.call(this,t)},n.onZoomEnd=function(t){this.layer.onZoomEnd(t),e.prototype.onZoomEnd.call(this,t)},n.onMoveStart=function(t){this.layer.onMoveStart(t),e.prototype.onMoveStart.call(this,t)},n.onMoving=function(t){this.layer.onMoving(t),e.prototype.onMoving.call(this,t)},n.onMoveEnd=function(t){this.layer.onMoveEnd(t),e.prototype.onMoveEnd.call(this,t)},n.onResize=function(t){this.layer.onResize(t),e.prototype.onResize.call(this,t)},n.prepareDrawContext=function(){if(!this._predrawed){var e=Hj(this.getPrepareParams());this._drawContext=this.layer.prepareToDraw.apply(this.layer,[this.context].concat(e)),this._drawContext||(this._drawContext=[]),Array.isArray(this._drawContext)||(this._drawContext=[this._drawContext]),this._predrawed=!0}},n._prepareDrawParams=function(){if(!this.getMap())return null;var e=this.getViewExtent();if(e.maskExtent&&!e.extent.intersects(e.maskExtent))return this.completeRender(),null;var t=[this.context,e],n=Hj(this.getDrawParams());return t.push.apply(t,n),t.push.apply(t,this._drawContext),t},n._drawLayer=function(){var e=this._prepareDrawParams();if(e){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.layer.draw.apply(this.layer,e.concat(n)),this.completeRender()}},n._drawLayerOnInteracting=function(){if(this.layer.drawOnInteracting){var e=this._prepareDrawParams();if(e){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.layer.drawOnInteracting.apply(this.layer,e.concat(n)),this.completeRender()}}},t}(ID);function Hj(e){return e||(e=[]),Array.isArray(e)||(e=[e]),e}var Vj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.isCanvasRender=function(){return!0},n.prepareToDraw=function(){},n.draw=function(){},n.redraw=function(){return this._getRenderer()&&this._getRenderer().setToRedraw(),this},n.play=function(){return this.config("animation",!0),this},n.pause=function(){return this.config("animation",!1),this},n.isPlaying=function(){return this.options.animation},n.clearCanvas=function(){return this._getRenderer()&&this._getRenderer().clearCanvas(),this},n.requestMapToRender=function(){return this._getRenderer()&&this._getRenderer().requestMapToRender(),this},n.completeRender=function(){return this._getRenderer()&&this._getRenderer().completeRender(),this},n.onCanvasCreate=function(){return this},n.onZoomStart=function(){},n.onZooming=function(){},n.onZoomEnd=function(){},n.onMoveStart=function(){},n.onMoving=function(){},n.onMoveEnd=function(){},n.onResize=function(){},n.doubleBuffer=function(e){return e.clearRect(0,0,e.canvas.width,e.canvas.height),this},t}(nL);Vj.mergeOptions({doubleBuffer:!1,animation:!1}),Vj.registerRenderer("canvas",jj);var Uj=new xA(0,0),qj=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.getParticles=function(){},n.draw=function(e,t){var n=this.getParticles(yI());if(n&&0!==n.length){var i=this.getMap(),r=t.extent;t.maskExtent&&(r=t.extent.intersection(t.maskExtent)),r=r.convertTo((function(e){return i._pointToContainerPoint(e,void 0,0,Uj)}));for(var a=2*Math.PI,o=0,s=n.length;o<s;o++){var l=n[o].point;if(r.contains(l)){var u=n[o].color||this.options.lineColor||"#fff",c=n[o].r;e.fillStyle!==u&&(e.fillStyle=u),c<=2?e.fillRect(l.x-c/2,l.y-c/2,c,c):(e.beginPath(),e.arc(l.x,l.y,c/2,0,a),e.fill())}}this._fillCanvas(e)}else this._getRenderer()&&(this._getRenderer()._shouldClear=!0)},n._fillCanvas=function(e){var t=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",e.fillStyle="rgba(0, 0, 0, "+1/(this.options.trail||30)+")",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation=t},t}(Vj);qj.mergeOptions({animation:!0}),qj.registerRenderer("canvas",function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.draw=function(){this.canvas&&this.layer.options.animation&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this.prepareDrawContext(),this._drawLayer()},n.drawOnInteracting=function(){this.draw(),this._shouldClear=!1},n.onSkipDrawOnInteracting=function(){this._shouldClear=!0},t}(jj));var Gj,Wj,Zj=new AD,Xj=function(e){function t(t,n,i){var r;(r=e.call(this,i)||this).target=t,t.once("remove",r.delete,vA(vA(r)));var a=r.options.symbol,o=a.markerLineWidth||1;return r.w=a.markerWidth+o,r.h=a.markerHeight+o,r.opacity=xI(a.opacity)?1:a.opacity,r.map=n,r.events=i.events,r._fetchImage(),r.addTo(n),r}cA(t,e);var n=t.prototype;return n.getCursor=function(){return this.options.cursor||"default"},n._fetchImage=function(){var e=this.map,t=this.options.symbol,n=t.markerFile;this.url=n||XR(t);var i=Zj.getImage(this.url);if(!i){var r=this.w,a=this.h;if(n)(i=new Image).onload=function(){var t=e.getRenderer();t&&t.setToRedraw()},i.src=this.url;else{var o=document.createElement("canvas");o.width=r,o.height=a,i=cz(o.getContext("2d"),{x:r/2,y:a/2},t,Zj)}Zj.addResource([this.url,r,a],i)}Zj.login(this.url),this._img=i},n.setContainerPoint=function(e){this._point=e,this._point._sub(this.w/2,this.h/2)},n.getContainerPoint=function(){return this._point.add(this.w/2,this.h/2)},n.offset=function(e){this._point._add(e)},n.render=function(e){if(!this._img)return!1;var t=this.options.symbol,n=t.markerDx||0,i=t.markerDy||0,r=this.map,a=this._point,o=a.x,s=a.y,l=this.w,u=this.h;if(o+l>0&&o<r.width&&s+u>0&&s<r.height){var c=r.getDevicePixelRatio();return e.globalAlpha=this.opacity,e.drawImage(this._img,Math.round((o+n)*c),Math.round((s+i)*c),Math.round(l*c),Math.round(u*c)),!0}return!1},n.delete=function(){if(this.map){var e=this.map.getRenderer();e&&e.removeTopElement(this)}Zj.logout(this.url),this._dragger&&(this._dragger.disable(),delete this._dragger),delete this.map},n.hitTest=function(e){var t=this.options.symbol,n=this._point.x+(t.markerDx||0),i=this._point.y+(t.markerDy||0);return e.x>=n&&e.x<=n+this.w&&e.y>=i&&e.y<=i+this.h},n.addTo=function(e){this.map=e,e.getRenderer().addTopElement(this)},n.onEvent=function(e){this.fire(e.type,e)},n.mousedown=function(e){var t=this.options.cursor;t&&e.target.setCursor(t),this.onDragstart(e)},n.onDragstart=function(e){var t=e.containerPoint,n=e.target,i=this._dragger=new EN(n._panels.mapWrapper||n._containerDOM);i.on("dragging",this.onDragging,this).on("mouseup",this.onDragend,this).enable(),i.type="handle",i.onMouseDown(e.domEvent),Gj=t.x,Wj=t.y,this.fire("dragstart",{containerPoint:t})},n.onDragging=function(e){if(this._dragger){var t=this.map,n=pO(e.domEvent,t._containerDOM),i={x:n.x-Gj,y:n.y-Wj},r=t.containerPointToCoord(new xA(Gj,Wj)),a=t.containerPointToCoord(n);Gj=n.x,Wj=n.y,this.offset(i),this.fire("dragging",{containerPoint:n,coordOffset:a._sub(r)})}},n.onDragend=function(e){if(this._dragger){var t=this.map;t.resetCursor();var n=pO(e.domEvent,t._containerDOM);this.offset({x:n.x-Gj,y:n.y-Wj}),this._dragger.disable(),delete this._dragger,this.fire("dragend",{containerPoint:n})}},t}(dN(pN)),Kj=function(){function e(e,t){this.target=e,e.once("remove",this.delete,this),this.map=t,this.addTo(t)}var t=e.prototype;return t.setPoints=function(e){this.points=e;var t=e.map((function(e){return e.x})),n=e.map((function(e){return e.y}));this.xmin=Math.min.apply(Math,t),this.xmax=Math.max.apply(Math,t),this.ymin=Math.min.apply(Math,n),this.ymax=Math.max.apply(Math,n)},t.hitTest=function(){return!1},t.render=function(e){var t=this.map;if(!(this.xmax<=0||this.xmin>=t.width||this.ymax<=0||this.ymin>=t.height)){var n=t.getDevicePixelRatio();e.lineWidth=1,e.strokeStyle="#000",e.globalAlpha=1,e.beginPath();var i=this.points;e.moveTo(a(i[0].x),a(i[0].y));for(var r=1;r<this.points.length;r++)e.lineTo(a(i[r].x),a(i[r].y));e.closePath(),e.stroke()}function a(e){return Math.round(e)*n+.5}},t.addTo=function(e){this.map=e,e.getRenderer().addTopElement(this)},t.delete=function(){if(this.map){var e=this.map.getRenderer();e&&e.removeTopElement(this)}},e}();function Yj(e,t){return{markerType:e,markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:t}}var Jj={fixAspectRatio:!1,symbol:null,removeVertexOn:"contextmenu",centerHandleSymbol:Yj("ellipse",1),vertexHandleSymbol:Yj("square",1),newVertexHandleSymbol:Yj("square",.4)},Qj=function(e){function t(t,n){var i;return(i=e.call(this,n)||this)._geometry=t,i._geometry?i:vA(i)}cA(t,e);var n=t.prototype;return n.getMap=function(){return this._geometry.getMap()},n.prepare=function(){var e=this.getMap();e&&(e.on("drawtopstart",this._refresh,this),this.options.symbol&&(this._originalSymbol=this._geometry.getSymbol(),this._geometry.setSymbol(this.options.symbol)),this._prepareEditStageLayer())},n._prepareEditStageLayer=function(){var e=this._geometry.getLayer();if("canvas"===e.options.renderer){var t=this.getMap(),n="_maptalks__internal_layer__edit_stage_"+CA()+"_shadow";this._shadowLayer=t.getLayer(n),this._shadowLayer||(this._shadowLayer=new(0,e.constructor)(n),t.addLayer(this._shadowLayer))}},n.start=function(){if(this._geometry&&this._geometry.getMap()&&!this._geometry.editing){this.editing=!0,this.prepare();var e,t=this._geometry,n="canvas"===this._geometry.getLayer().options.renderer;this._geometryDraggble=t.options.draggable,n?(t.config("draggable",!1),(e=t.copy()).setSymbol(t._getInternalSymbol()),e.copyEventListeners(t),t._getParent()&&e.copyEventListeners(t._getParent()),e._setEventTarget(t),e.setId(null).config({draggable:!1}),this._shadow=e,t.hide()):t instanceof LL&&t.config("draggable",!0),this._switchGeometryEvents("on"),(t instanceof LL||t instanceof JL||t instanceof $L||t instanceof QL)&&this._createOrRefreshOutline(),this._shadowLayer&&this._shadowLayer.bringToFront().addGeometry(e),t instanceof LL?e&&(e.config("draggable",!0),e.on("dragend",this._onMarkerDragEnd,this)):this._createCenterHandle(),t instanceof LL&&!1!==this.options.resize?this.createMarkerEditor():t instanceof JL?this.createCircleEditor():t instanceof $L||t instanceof QL?this.createEllipseOrRectEditor():t instanceof eB||(t instanceof NL||t instanceof FL)&&this.createPolygonEditor()}},n.stop=function(){delete this._history,delete this._historyPointer,delete this._editOutline,this._switchGeometryEvents("off"),this.getMap()?(this._geometry.config("draggable",this._geometryDraggble),this._shadow&&(delete this._shadow,delete this._geometryDraggble,this._geometry.show()),this._shadowLayer&&(this._shadowLayer.remove(),delete this._shadowLayer),this._refreshHooks=[],this.options.symbol&&(this._geometry.setSymbol(this._originalSymbol),delete this._originalSymbol),this.editing=!1,this.fire("remove")):this.fire("remove")},n.isEditing=function(){return!xI(this.editing)&&this.editing},n._getGeometryEvents=function(){return{symbolchange:this._onGeoSymbolChange,dragstart:this._onDragStart,dragend:this._onDragEnd,"positionchange shapechange":this._exeAndReset}},n._switchGeometryEvents=function(e){if(this._geometry){var t=this._getGeometryEvents();for(var n in t)this._geometry[e](n,t[n],this)}},n._onGeoSymbolChange=function(e){this._shadow&&this._shadow.setSymbol(e.target._getInternalSymbol())},n._onMarkerDragEnd=function(){this._update("setCoordinates",this._shadow.getCoordinates().toArray())},n._createOrRefreshOutline=function(){var e=this._geometry,t=this._editOutline;t||(this._editOutline=new Kj(this,this.getMap()),this._addRefreshHook(this._createOrRefreshOutline));var n=this._editOutline.points;if(e instanceof LL)this._editOutline.setPoints(e.getContainerExtent().toArray(n));else{var i=this.getMap();(n=e._getPrjExtent().toArray(n)).forEach((function(e){return i._prjToContainerPoint(e,null,e)})),this._editOutline.setPoints(n)}return t},n._createCenterHandle=function(){var e,t=this,n=this.getMap(),i=this.options.centerHandleSymbol,r=n.coordToContainerPoint(this._geometry.getCenter()),a=this.createHandle(r,{symbol:i,cursor:"move",onDown:function(){if(t._shadow){var n=KR((e=t._shadow.copy())._getInternalSymbol(),.5);e.setSymbol(n).addTo(t._geometry.getLayer())}},onMove:function(n){var i=n.coordOffset;e?e.translate(i):t._geometry.translate(i)},onUp:function(){if(e){var n=e.getFirstCoordinate(),i=t._geometry.getFirstCoordinate(),r=n.sub(i);t._update("translate",r),e.remove()}}});this._addRefreshHook((function(){var e=t._geometry.getCenter();a.setContainerPoint(n.coordToContainerPoint(e))}))},n._createHandleInstance=function(e,t){var n=this.getMap(),i=uR(t.symbol,(function(){return[n.getZoom(),{"{bearing}":n.getBearing(),"{pitch}":n.getPitch(),"{zoom}":n.getZoom()}]})),r=new Xj(this,n,{symbol:i,cursor:t.cursor,events:this.options.removeVertexOn});return r.setContainerPoint(e),r},n.createHandle=function(e,t){t||(t={});var n=this._createHandleInstance(e,t),i=this;return n.on("dragstart",(function(e){return this._updating=!0,t.onDown&&(t.onDown.call(i,e.containerPoint,e),this._geometry.fire("handledragstart")),!1}),this),n.on("dragging",(function(e){return i._hideContext(),t.onMove&&(t.onMove.call(i,e),this._geometry.fire("handledragging")),!1}),this),n.on("dragend",(function(e){return t.onUp&&(t.onUp.call(i,e),this._geometry.fire("handledragend")),this._updating=!1,!1}),this),t.onRefresh&&(n.refresh=t.onRefresh),n},n._createResizeHandles=function(e,t,n){var i=this,r=["nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize"],a=[null,"y",null,"x","x",null,"y",null],o=this._geometry,s=o instanceof LL;e||(e=[]);var l=this,u=[],c={},h=this.getMap(),d=this.options.vertexHandleSymbol,f=function(){for(var f=function(){if(s){var e=o.getContainerExtent();return[new xA(e.xmin,e.ymin),new xA((e.xmax+e.xmin)/2,e.ymin),new xA(e.xmax,e.ymin),new xA(e.xmin,(e.ymin+e.ymax)/2),new xA(e.xmax,(e.ymin+e.ymax)/2),new xA(e.xmin,e.ymax),new xA((e.xmax+e.xmin)/2,e.ymax),new xA(e.xmax,e.ymax)]}var t=o._getPrjExtent();return[new xA(t.xmin,t.ymax),new xA((t.xmax+t.xmin)/2,t.ymax),new xA(t.xmax,t.ymax),new xA(t.xmin,(t.ymax+t.ymin)/2),new xA(t.xmax,(t.ymax+t.ymin)/2),new xA(t.xmin,t.ymin),new xA((t.xmax+t.xmin)/2,t.ymin),new xA(t.xmax,t.ymin)]}(),p=function(p){if(Array.isArray(e)&&e.some((function(e){return e===p})))return"continue";var m,v=f[p],g=s?v:h._prjToContainerPoint(v);if(u.length<f.length-e.length){var y=i.createHandle(g,{symbol:d,cursor:r[p],axis:a[p],onMove:(m=p,function(e){l._updating=!0,t(e.containerPoint,m),o.fire("resizing")}),onUp:function(){l._updating=!1,n()}});c[p]=u.length,u.push(y)}else u[c[p]].setContainerPoint(g)},m=0;m<f.length;m++)p(m)};return f(),this._addRefreshHook(f),u},n.createMarkerEditor=function(){var e=this,t=this._shadow||this._geometry,n=this.getMap();if(t._canEdit()){this._history||this._recordHistory(f());var i=t._getInternalSymbol(),r=new xA(0,0);bI(i.markerDx)&&(r.x=i.markerDx),bI(i.markerDy)&&(r.y=i.markerDy);var a=null,o="middle",s="middle";if(Az.test(i)){var l=i.markerType;"pin"===l||"pie"===l||"bar"===l?(a=[5,6,7],o="bottom"):"rectangle"===l&&(a=[0,1,2,3,5],o="top",s="left")}else(wz.test(i)||Rz.test(i))&&(o="bottom",a=[5,6,7]);var u,c=[2,1,2,0,0,2,1,2];if(this.options.fixAspectRatio){var h=t.getSize();u=h.width/h.height}var d=this._createResizeHandles(a,(function(i,l){if(a&&a.indexOf(l)>=0){var h=n.containerPointToCoordinate(i.sub(r)),f=t.getCoordinates();h.x=f.x,t.setCoordinates(h),e._updateCoordFromShadow(!0),i=d[d.length-1-l].getContainerPoint()}var p=n.coordToContainerPoint(t.getCoordinates()).add(r),m=t._getInternalSymbol(),v=i.sub(p);"bottom"===o&&i.y>p.y&&(v.y=0);var g="middle"===o?2:1,y="left"===s?1:2,_=Math.abs(v.x)*y,x=Math.abs(v.y)*g;u&&(x=(_=Math.max(_,x*u))/u);var b=c[l];t instanceof lB?((u||0===b||2===b)&&(t.setWidth(_),t!==e._geometry&&e._geometry.setWidth(_)),(u||1===b||2===b)&&(t.setHeight(x),t!==e._geometry&&e._geometry.setHeight(x))):((u||0===b||2===b)&&(m.markerWidth=Math.min(_,e._geometry.options.maxMarkerWidth||1/0)),(u||1===b||2===b)&&(m.markerHeight=Math.min(x,e._geometry.options.maxMarkerHeight||1/0)),t.setSymbol(m),t!==e._geometry&&e._geometry.setSymbol(m))}),(function(){e._update(f())}))}else console&&console.warn("A marker can't be resized with symbol:",t.getSymbol());function f(){var e=[["setCoordinates",t.getCoordinates().toArray()]];return t instanceof lB?(e.push(["setWidth",t.getWidth()]),e.push(["setHeight",t.getHeight()])):e.push(["setSymbol",t.getSymbol()]),e}},n.createCircleEditor=function(){var e=this,t=this._shadow||this._geometry,n=this.getMap();this._history||this._recordHistory([["setCoordinates",t.getCoordinates().toArray()],["setRadius",t.getRadius()]]),this._createResizeHandles(null,(function(i){var r=t.getCenter(),a=n.containerPointToCoord(i),o=new FL([[r.x,r.y],[a.x,r.y]]),s=new FL([[r.x,r.y],[r.x,a.y]]),l=Math.max(n.computeGeometryLength(o),n.computeGeometryLength(s));t.setRadius(l),t!==e._geometry&&e._geometry.setRadius(l)}),(function(){e._update("setRadius",t.getRadius())}))},n.createEllipseOrRectEditor=function(){var e=this,t=[2,1,2,0,0,2,1,2],n=this._shadow||this._geometry;this._history||this._recordHistory(s());var i,r=this.getMap(),a=this._geometry instanceof $L;this.options.fixAspectRatio&&(i=n.getWidth()/n.getHeight());var o=this._createResizeHandles(null,(function(s,l){var u,c,h,d=a?1:2,f=o[l].getContainerPoint(),p=t[l];if(a){var m=o[7-l].getContainerPoint(),v=(u=f.sub(m)).abs();c=r.pixelToDistance(v.x,0),h=r.pixelToDistance(0,v.y);var g=n.getSize(),y=n.getCoordinates(),_=n.getWidth(),x=n.getHeight(),b=r.containerPointToCoord(s),w=r.containerPointToCoord(m),k=new FL([[w.x,w.y],[b.x,w.y]]),C=new FL([[w.x,w.y],[w.x,b.y]]);if(c=r.computeGeometryLength(k),h=r.computeGeometryLength(C),0===p)if(i&&(v.y=v.x/i,g.height=Math.abs(v.y),h=c/i),f.y=m.y-g.height/2,b.y=y.y,4===l)b.x=Math.min(b.x,y.x);else{var S=r.locate(y,_,0);b.x=r.locate(new PN(S.x,b.y),-c,0).x}else if(1===p)i&&(v.x=v.y*i,g.width=Math.abs(v.x),c=h*i),f.x=m.x-g.width/2,b.x=y.x,b.y=Math.max(b.y,w.y);else{if(i&&(c>h*i?(h=c/i,f.y=m.y+v.x*IA(u.y)/i):(c=h*i,f.x=m.x+v.y*IA(u.x)*i)),0===l||5===l){var T=r.locate(y,_,0===l?0:-x);b.x=r.locate(new PN(T.x,b.y),-c,0).x}else b.x=Math.min(b.x,w.x);b.y=Math.max(b.y,w.y)}n.setCoordinates(b),e._updateCoordFromShadow(!0)}else{var E=n.getCenter(),P=r.containerPointToCoord(f),M=new FL([[E.x,E.y],[P.x,E.y]]),I=new FL([[E.x,E.y],[E.x,P.y]]);c=r.computeGeometryLength(M),h=r.computeGeometryLength(I),i&&(h=(c=Math.max(c,h*i))/i)}(i||0===p||2===p)&&(n.setWidth(c*d),n!==e._geometry&&e._geometry.setWidth(c*d)),(i||1===p||2===p)&&(n.setHeight(h*d),n!==e._geometry&&e._geometry.setHeight(h*d))}),(function(){e._update(s())}));function s(){return[["setCoordinates",n.getCoordinates().toArray()],["setWidth",n.getWidth()],["setHeight",n.getHeight()]]}},n.createPolygonEditor=function(){var e=this.getMap(),t=this._shadow||this._geometry,n=this;this._history||this._recordHistory("setCoordinates",PN.toNumberArrays(t.getCoordinates()));var i=t instanceof NL?3:2,r="maptalks--editor-vertex-index",a={0:[]},o={0:[]};function s(e){if(void 0===e&&(e=0),t instanceof NL){var n=t.getCoordinates()[e]||[];return n.slice(0,n.length-1)}return t.getCoordinates()}function l(e){return void 0===e&&(e=0),0===e?t._getPrjCoordinates():t._getPrjHoles()[e-1]}function u(){for(var e in a){for(var t=a[e].length-1;t>=0;t--)a[e][t][r]=t;for(var i=o[e].length-1;i>=0;i--)o[e][i][r]=i}n._updateCoordFromShadow()}function c(e){n._updating=!0;var s=e.target,c=s[r],h=bI(s._ringIndex)?s._ringIndex:0,d=l(h);if(!(d.length<=i)){var f,p=t instanceof FL&&(0===c||c===d.length-1);if(d.splice(c,1),h>0?t._prjHoles[h-1]=d:t._setPrjCoordinates(d),t._updateCache(),a[h].splice(c,1)[0].delete(),c<o[h].length&&o[h].splice(c,1)[0].delete(),o[h].splice(f=0===c?o[h].length-1:c-1,1)[0].delete(),p||o[h].splice(f,0,v.call(n,f,h)),h>0){var m=t.getCoordinates(),g=m[h];g&&Array.isArray(g)&&g.length>1&&(g.splice(c,1),t!==this._geometry&&t.setCoordinates(m))}u(),n._updating=!1}}function h(i,r,a){void 0===a&&(a=0);var s=n._geometry.snapTo;s&&SI(s)&&(i=n._geometry.snapTo(i)||i);var u,c=l(a),h=e._containerPointToPrj(i.sub(f())),d=c[r];d.x=h.x,d.y=h.y,t._updateCache(),t.onShapeChanged(),n._updateCoordFromShadow(!0),u=0===r?o[a].length-1:r-1,o[a][r]&&o[a][r].refresh(),o[a][u]&&o[a][u].refresh()}var d=new xA(0,0);function f(){var e=t._getCompiledSymbol();return d.x=e.lineDx||0,d.y=e.lineDy||0,d}function p(t,i,a){void 0===i&&(i=0);var o=(a||s(i))[t],l=n.createHandle(e.coordToContainerPoint(o)._add(f()),{symbol:n.options.vertexHandleSymbol,cursor:"pointer",axis:null,onMove:function(){h(l.getContainerPoint(),l[r],i)},onRefresh:function(t,n){o=(n||s(i))[l[r]];var a=e.coordToContainerPoint(o);l.setContainerPoint(a._add(f()))},onUp:function(){n._updateCoordFromShadow()},onDown:function(e,t){}});return l[r]=t,l._ringIndex=i,l.on(n.options.removeVertexOn,c),l}var m=!1;function v(i,c,d){void 0===c&&(c=0);var g=d||s(c),y=g[i].add(i+1>=g.length?g[0]:g[i+1]).multi(.5),_=n.createHandle(y,{symbol:n.options.newVertexHandleSymbol,cursor:"pointer",axis:null,onDown:function(i,a){if(!a||!a.domEvent||2!==a.domEvent.button){var s=l(c),u=_[r],h=_.getContainerPoint(),d=e._containerPointToPrj(h);s.splice(u+1,0,d),c>0?t._prjHoles[c-1]=s:t._setPrjCoordinates(s),t._updateCache(),_.opacity=1,o[c].splice(u,0,v.call(n,u,c),v.call(n,u+1,c)),m=!0}},onMove:function(){h(_.getContainerPoint(),_[r]+1,c)},onUp:function(e){if(e&&e.domEvent&&2===e.domEvent.button)m=!1;else{var t=_[r];EA(_,o[c]),_.delete(),a[c].splice(t+1,0,p.call(n,t+1,c)),u(),n._updateCoordFromShadow(),m=!1}},onRefresh:function(t,n){g=n||s(t);var i=_[r],a=g[i].add(g[i===g.length-1?0:i+1]).multi(.5),o=e.coordToContainerPoint(a);_.setContainerPoint(o._add(f()))}});return _[r]=i,_}if(t instanceof NL)for(var g=t.getHoles().length+1,y=0;y<g;y++){a[y]=[],o[y]=[];for(var _=s(y),x=0,b=_.length;x<b;x++)a[y].push(p.call(this,x,y,_)),x<b-1&&o[y].push(v.call(this,x,y,_));o[y].push(v.call(this,_.length-1,y,_))}else{for(var w=s(0),k=0,C=w.length;k<C;k++)a[0].push(p.call(this,k,0,w)),k<C-1&&o[0].push(v.call(this,k,0,w));o[0].length&&2===t.getCoordinates().length&&(o[0][0].options.symbol.markerDx=12)}this._addRefreshHook((function(){if(!m){for(var e in o)for(var n=s(e),i=o[e].length-1;i>=0;i--)o[e][i].refresh(e,n);for(var r in o[0].length&&t instanceof FL&&(2===t.getCoordinates().length?o[0][0].options.symbol.markerDx=12:t.getCoordinates().length>2&&(o[0][0].options.symbol.markerDx=0)),a)for(var l=s(r),u=a[r].length-1;u>=0;u--)a[r][u].refresh(r,l)}}))},n._refresh=function(){if(this._refreshHooks)for(var e=this._refreshHooks.length-1;e>=0;e--)this._refreshHooks[e].call(this)},n._hideContext=function(){this._geometry&&(this._geometry.closeMenu(),this._geometry.closeInfoWindow())},n._addRefreshHook=function(e){e&&(this._refreshHooks||(this._refreshHooks=[]),this._refreshHooks.push(e))},n._update=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this._exeHistory([e,n]),this._recordHistory.apply(this,[e].concat(n))},n._updateCoordFromShadow=function(e){var t=(this._shadow||this._geometry).getCoordinates(),n=this._geometry,i=this._updating;this._updating=!0,n.setCoordinates(t),e||this._recordHistory("setCoordinates",PN.toNumberArrays(n.getCoordinates())),this._updating=i},n._recordHistory=function(e){this._history||(this._history=[],this._historyPointer=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this._history.length){var r=this._history[this._history.length-1];if(r[0]===e&&JSON.stringify(r[1])===JSON.stringify(n))return}this._historyPointer<this._history.length-1&&this._history.splice(this._historyPointer+1),this._history.push([e,n]),this._historyPointer=this._history.length-1,this._geometry.fire("editrecord")},n.cancel=function(){return this._history&&0!==this._historyPointer?(this._historyPointer=0,this._exeAndReset(this._history[0]),this):this},n.undo=function(){if(!this._history||0===this._historyPointer)return this;var e=this._history[--this._historyPointer];return this._exeAndReset(e),this},n.redo=function(){if(!this._history||this._historyPointer===this._history.length-1)return this;var e=this._history[++this._historyPointer];return this._exeAndReset(e),this},n._exeAndReset=function(e){if(!this._updating){this._exeHistory(e);var t=this._history,n=this._historyPointer;this.stop(),this._history=t,this._historyPointer=n,this.start()}},n._onDragStart=function(){this._updating=!0},n._onDragEnd=function(){this._updating=!1},n._exeHistory=function(e){if(Array.isArray(e)){var t=this._updating;this._updating=!0;var n=this._shadow||this._geometry,i=this._geometry;Array.isArray(e[0])?e[0].forEach((function(e){var t=e[0],r=e.slice(1);n[t].apply(n,r),n!==i&&i[t].apply(i,r)})):(n[e[0]].apply(n,e[1]),n!==i&&i[e[0]].apply(i,e[1])),this._updating=t}},t}(dN(pN));Qj.mergeOptions(Jj),sB.include({startEditText:function(){return this.getMap()?(this.hide(),this.endEditText(),this._prepareEditor(),this._fireEvent("edittextstart"),this):this},endEditText:function(){if(this._textEditor){var e=this._textEditor.innerHTML;e=e.replace(/<p>/gi,"").replace(/<\/p>/gi,"<br/>"),this._textEditor.innerHTML=e;var t=this._textEditor.innerText.replace(/[\r\n]+$/gi,"");this.setContent(t),wO(this._textEditor,"mousedown dblclick",hO),this.getMap().off("mousedown",this.endEditText,this),this._editUIMarker.remove(),delete this._editUIMarker,this._textEditor.onkeyup=null,delete this._textEditor,this.show(),this._fireEvent("edittextend")}return this},isEditingText:function(){return!!this._textEditor},getTextEditor:function(){return this._editUIMarker},_prepareEditor:function(){var e=this.getMap(),t=this._createEditor();this._textEditor=t,e.on("mousedown",this.endEditText,this);var n=this._getEditorOffset();this._editUIMarker=new kF(this.getCoordinates(),{animation:null,content:t,dx:n.dx,dy:n.dy}).addTo(e),this._setCursorToLast(this._textEditor)},_getEditorOffset:function(){var e=this._getInternalSymbol()||{},t=0,n=0,i=e.textHorizontalAlignment;return"middle"===i||xI(i)?(t=(e.textDx||0)-2,n=(e.textDy||0)-2):(t=(e.markerDx||0)-2,n=(e.markerDy||0)-2),{dx:t,dy:n}},_createEditor:function(){var e=this.getContent(),t=this.getSize(),n=this._getInternalSymbol()||{},i=t.width,r=n.textFill||"#000000",a=n.textSize||12,o=t.height,s=n.markerLineColor||"#000",l=n.markerFill||"#3398CC",u=n.textLineSpacing||0,c=rO("div");return c.contentEditable=!0,c.style.cssText="background:"+l+"; border:1px solid "+s+";\n            color:"+r+";font-size:"+a+"px;width:"+(i-2)+"px;height:"+(o-2)+"px;margin: auto;\n            line-height:"+(a+u)+"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;",c.innerText=e,bO(c,"mousedown dblclick",hO),c.onkeyup=function(e){13===e.keyCode&&(c.style.height=parseInt(c.style.height||0)+a/2+"px")},c},_setCursorToLast:function(e){var t;window.getSelection?(e.focus(),(t=window.getSelection()).selectAllChildren(e),t.collapseToEnd()):document.selection&&((t=document.selection.createRange()).moveToElementText(e),t.collapse(!1),t.select())}}),Jz.include({animate:function(e,t,n){var i=this;this._animPlayer&&this._animPlayer.finish(),SI(t)&&(n=t),t||(t={});var r,a=this.getMap(),o=this._getProjection(),s=this._prepareAnimationStyles(e),l=t.focus;if(delete this._animationStarted,a){var u=a._getRenderer();t.framer=function(e){u.callInNextFrame(e)}}var c=RL.animate(s,t,(function(e){if(a&&a.isRemoved())c.finish();else{a&&!i._animationStarted&&l&&a.onMoveStart();var t=e.styles;for(var s in t)if("symbol"!==s&&"translate"!==s&&t.hasOwnProperty(s)){var u="set"+s[0].toUpperCase()+s.slice(1);i[u](t[s])}var h=t.translate;if(h){var d=h;r&&(d=h.sub(r)),r=h,i.translate(d)}var f=t.symbol;if(f){var p=i.getSymbol()||{};i.setSymbol(YR(p,f))}if(a&&l){var m=o.project(i.getCenter());a._setPrjCenter(m);var v=a._parseEventFromCoord(o.unproject(m));"running"!==c.playState?a.onMoveEnd(v):a.onMoving(v)}i._fireAnimateEvent(c.playState),n&&n(e)}}),this);return this._animPlayer=c,this._animPlayer.play()},_prepareAnimationStyles:function(e){var t=this._getInternalSymbol(),n={};for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if("translate"!==i&&"symbol"!==i){var a=this["get"+i[0].toUpperCase()+i.substring(1)]();n[i]=[a,r]}else if("symbol"===i){var o=void 0;if(Array.isArray(e.symbol)){if(!Array.isArray(t))throw new Error("geometry'symbol isn't a composite symbol, while the symbol in styles is.");o=[];for(var s=e.symbol,l=0;l<s.length;l++)if(s[l]){var u={};for(var c in s[l])s[l].hasOwnProperty(c)&&(u[c]=[t[l][c],s[l][c]]);o.push(u)}else o.push(null)}else{if(Array.isArray(t))throw new Error("geometry'symbol is a composite symbol, while the symbol in styles isn't.");for(var h in o={},r)r.hasOwnProperty(h)&&(o[h]=[t[h],r[h]])}n.symbol=o}else"translate"===i&&(n.translate=new PN(r))}return n},_fireAnimateEvent:function(e){"finished"===e?(delete this._animationStarted,this._fireEvent("animateend")):"running"===e&&(this._animationStarted?this._fireEvent("animating"):(this._fireEvent("animatestart"),this._animationStarted=!0))}});var $j=lA.touch?"touchstart mousedown":"mousedown",eH=function(e){function t(t){return e.call(this,t)||this}cA(t,e);var n=t.prototype;return n.addHooks=function(){this.target.on($j,this._startDrag,this)},n.removeHooks=function(){this._endDrag(),this.target.off($j,this._startDrag,this),delete this.container},n._prepareDragHandler=function(){this._dragHandler=new EN(this.container),this._dragHandler.on("dragging",this._dragging,this).on("mouseup",this._endDrag,this).enable()},n._prepareShadow=function(){var e=this,t=this.target;if("canvas"===t.getLayer().options.renderer){this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var n=this._shadow=t.copy();if(n.getGeometries){var i=n.getGeometries(),r=t.getGeometries();i.forEach((function(t,n){e._updateShadowSymbol(t,r[n])}))}else this._updateShadowSymbol(n,t);n.setId(null),this._prepareShadowConnectors()}},n._updateShadowSymbol=function(e,t){if(e.setSymbol(t._getInternalSymbol()),t.options.dragShadow){var n=KR(e._getInternalSymbol(),.5);e.setSymbol(n)}},n._prepareShadowConnectors=function(){var e=this.target,t=this._shadow,n=this._dragStageLayer._getRenderer().resources,i=[];if(dB._hasConnectors(e))for(var r=dB._getConnectors(e),a=0,o=r.length;a<o;a++){var s,l=r[a],u=l.config(),c=l._getInternalSymbol();u.symbol=KR(c,.5),s=l.getConnectSource()===e?new l.constructor(t,l.getConnectTarget(),u):new l.constructor(l.getConnectSource(),t,u),i.push(s),l.getLayer()&&l.getLayer()._getRenderer()&&n.merge(l.getLayer()._getRenderer().resources)}this._shadowConnectors=i,i.push(t),this._dragStageLayer.bringToFront().addGeometry(i)},n._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target._getSymbol())},n._prepareDragStageLayer=function(){var e=this.target.getMap(),t=this.target.getLayer();this._dragStageLayer=e.getLayer("_maptalks__internal_layer__drag_stage"),this._dragStageLayer||(this._dragStageLayer=new _B("_maptalks__internal_layer__drag_stage",{enableAltitude:t.options.enableAltitude,altitudeProperty:t.options.altitudeProperty}),e.addLayer(this._dragStageLayer));var n=new AD;n.merge(t._getRenderer().resources),this._dragStageLayer._getRenderer().resources=n},n._startDrag=function(e){var t=this.target.getMap();if(t&&!this.target._getParent()&&!this.isDragging()){var n=e.domEvent;n.touches&&n.touches.length>1||2===n.button||(this.container=t._panels.mapWrapper||t._containerDOM,this.target.on("click",this._endDrag,this),this._lastCoord=this._correctCoord(e.coordinate),this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),bO(this.container,"mouseleave",this._endDrag,this),this._startParam=e,this._moved=!1)}},n._dragging=function(e){var t=this.target,n=t.getMap();if(!n._isEventOutMap(e.domEvent)){var i=n._parseEvent(e.domEvent),r=i.domEvent;if(!(r.touches&&r.touches.length>1)){var a=n._getVisualHeight(n.options.maxVisualPitch);if(!(i.containerPoint.y<n.height-a)){if(!this._moved)return this._moved=!0,t.on("symbolchange",this._onTargetUpdated,this),this._isDragging=!0,this._prepareShadow(),this._shadow&&(t.options.dragShadow||t.hide(),this._shadow._fireEvent("dragstart",i)),this.target._fireEvent("dragstart",this._startParam||i),void delete this._startParam;var o=this._shadow||t,s=o.options.dragOnAxis,l=o.options.dragOnScreenAxis,u=i.containerPoint,c=i.coordinate;this._lastPoint=this._lastPoint||u,this._lastCoord=this._lastCoord||c,l?("x"===s?u.y=this._lastPoint.y:"y"===s&&(u.x=this._lastPoint.x),c=n.containerPointToCoord(u)):c=this._correctCoord(c);var h=u.sub(this._lastPoint),d=c.sub(this._lastCoord);l||("x"===s?h.y=d.y=0:"y"===s&&(h.x=d.x=0)),this._lastPoint=u,this._lastCoord=c,o.translate(d),o===t||t.options.dragShadow||t.translate(d),i.coordOffset=d,i.pointOffset=h,o._fireEvent("dragging",i),o!==t&&t._fireEvent("dragging",i)}}}},n._endDrag=function(e){if(this._dragHandler&&(this._dragHandler.disable(),delete this._dragHandler),this.container&&wO(this.container,"mouseleave",this._endDrag,this),this.target){var t=this.target;t.off("click",this._endDrag,this),t.off("symbolchange",this._onTargetUpdated,this),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1;var n=t.getMap();if(this.enabled()&&n){var i=n._parseEvent(e?e.domEvent:null);this._updateTargetAndRemoveShadow(i),this._moved&&t._fireEvent("dragend",i)}}},n.isDragging=function(){return!!this._isDragging},n._updateTargetAndRemoveShadow=function(e){if(this._shadow){var t=this.target,n=t.getMap();t.options.dragShadow||t.show();var i=this._shadow;if(i){if(t.options.dragShadow){var r=i.getFirstCoordinate(),a=t.getFirstCoordinate(),o=r.sub(a);t.translate(o)}i._fireEvent("dragend",e),i.remove(),delete this._shadow}this._shadowConnectors&&(n.getLayer("_maptalks__internal_layer__drag_stage").removeGeometry(this._shadowConnectors),delete this._shadowConnectors),this._dragStageLayer&&(this._dragStageLayer._getRenderer().resources=new AD,this._dragStageLayer.remove())}},n._correctCoord=function(e){var t=this.target.getMap();if(!t.getPitch())return e;var n=this.target;if(!n.getMinAltitude())return e;var i=(n.getMinAltitude()+n.getMaxAltitude())/2;return t.locateByPoint(e,0,-i)},t}(fN);Jz.mergeOptions({draggable:!1,dragShadow:!0,dragOnAxis:null,dragOnScreenAxis:!1}),Jz.addInitHook("addHandler","draggable",eH),Jz.include({isDragging:function(){return this._getParent()?this._getParent().isDragging():!!this.draggable&&this.draggable.isDragging()}}),Jz.include({startEdit:function(e){var t=this.getMap();return t&&this.options.editable?(this._editor&&this.endEdit(),this._editor=new Qj(this,e),this._editor.start(),this._getParent()||this.fire("editstart"),t.getRenderer().setToRedraw(),this):this},endEdit:function(){if(this._editor){this._editor.stop(),delete this._editor,this._getParent()||this.fire("editend");var e=this.getMap();e&&e.getRenderer().setToRedraw()}return this},redoEdit:function(){return this.isEditing()?(this._editor.redo(),this._getParent()||this.fire("redoedit"),this):this},undoEdit:function(){return this.isEditing()?(this._editor.undo(),this._getParent()||this.fire("undoedit"),this):this},cancelEdit:function(){return this.isEditing()?(this._editor.cancel(),this._getParent()||this.fire("canceledit"),this):this},isEditing:function(){return!!this._editor&&this._editor.isEditing()}}),Jz.include({_onEvent:function(e,t){var n=this.getMap();if(n){var i=t||this._getEventTypeToFire(e);"contextmenu"===i&&this.listens("contextmenu")&&(hO(e),cO(e));var r=n._getEventParams(e);bI(this._pickGeometryIndex)&&(r.pickGeometryIndex=this._pickGeometryIndex),this._fireEvent(i,r)}},_getEventTypeToFire:function(e){return e.type}}),Jz.include({setInfoWindow:function(e){return this.removeInfoWindow(),e instanceof MF?(this._infoWindow=e,this._infoWinOptions=_I({},this._infoWindow.options),this._infoWindow.addTo(this),this):(this._infoWinOptions=_I({},e),this._infoWindow?this._infoWindow.setOptions(e):this.getMap()&&this._bindInfoWindow(),this)},getInfoWindow:function(){return this._infoWindow?this._infoWindow:null},openInfoWindow:function(e){return this.getMap()?(e||(e=this.getCenter()),this._infoWindow?this._infoWindow.show(e):this._infoWinOptions&&this.getMap()&&(this._bindInfoWindow(),this._infoWindow.show(e)),this):this},closeInfoWindow:function(){return this._infoWindow&&this._infoWindow.hide(),this},removeInfoWindow:function(){return this._unbindInfoWindow(),delete this._infoWinOptions,delete this._infoWindow,this},_bindInfoWindow:function(){var e=this._infoWinOptions;return e?(this._infoWindow=new MF(e),this._infoWindow.addTo(this),this):this},_unbindInfoWindow:function(){return this._infoWindow&&(this.closeInfoWindow(),this._infoWindow.remove(),delete this._infoWindow),this}});var tH=new xA(0,0),nH=new xA(0,0),iH=new xA(0,0),rH=new xA(0,0),aH=[],oH=function(e){function t(){return e.call(this,"core-fetch-image")||this}cA(t,e);var n=t.prototype;return n.checkUrl=function(e){return e&&CI(e)?GA(e):e},n.fetchImage=function(e,t,n,i){e=this.checkUrl(e),this.send({url:e,fetchOptions:i},aH,n,t)},t}(ED),sH=new Image,lH=function(e){function t(t){var n;(n=e.call(this,t)||this).tilesInView={},n.tilesLoading={},n._parentTiles=[],n._childTiles=[],n._tileQueue=[],n._tileQueueIds=new Set;var i=t.getTileSize().width;return n.tileCache=new YO(t.options.maxCacheSize*i/512*i/512,(function(e){n.deleteTile(e)})),lA.decodeImageInWorker&&n.layer.options.decodeImageInWorker&&("gl"===t.options.renderer||!lA.safari&&!lA.iosWeixin)&&(n._tileImageWorkerConn=new oH),n._compareTiles=cH.bind(vA(vA(n))),n}cA(t,e);var n=t.prototype;return n.getCurrentTileZoom=function(){return this._tileZoom},n.draw=function(e,t){var n=this.getMap();if(this.isDrawable()){var i=this.prepareCanvas();if(!i||i.intersects(this.canvasExtent2D)){var r;this._renderTimestamp!==e&&(this._consumeTileQueue(),this._computeAvgTileAltitude(),this._renderTimestamp=e);var a=!1,o=this._frameTiles;if(o&&e===o.timestamp){if(o.empty)return;r=o}else{if(!(r=this._getTilesInCurrentFrame()))return this._frameTiles={empty:!0,timestamp:e},void this.completeRender();a=!0,this._frameTiles=r,this._frameTiles.timestamp=e,r.loadingCount&&this.loadTileQueue(r.tileQueue)}var s=r.loading,l=r.loadingCount;this._drawTiles(r.tiles,r.parentTiles,r.childTiles,r.placeholders,t,r.missedTiles,r.incompleteTiles),l||s||(n.isAnimating()||!this._parentTiles.length&&!this._childTiles.length||(this._parentTiles=[],this._childTiles=[],this.setToRedraw()),this.completeRender()),a&&this.retireTiles()}else this.completeRender()}},n.getTileGridsInCurrentFrame=function(){return this._frameTileGrids},n.getCurrentTimestamp=function(){return this._renderTimestamp||0},n._getTilesInCurrentFrame=function(){var e=this.getMap(),t=this.layer,n=t._isPyramidMode()&&t.options.terrainTileMode,i=t.getTiles();if(this._frameTileGrids=i,!(i=i.tileGrids)||!i.length)return null;var r=i.reduce((function(e,t){return e+(t&&t.tiles&&t.tiles.length||0)}),0);r>=this.tileCache.max/2&&this.tileCache.setMaxSize(2*r+1);var a=0,o=!1,s={},l=[],u=[],c={},h=[],d={},f=[],p={},m={},v=this.markTiles(),g=this._getLoadLimit(),y=i.length,_=void 0===this._tileZoom&&!this._terrainHelper;this._tileZoom=i[0].zoom;var x=null,b=null;n&&(x=[],b=new Map);for(var w=0;w<y;w++){var k=i[w],C=k.tiles,S=k.parents||aH,T=S.length,E=_?C:S.concat(C),P=void 0;E.length&&(P=this._generatePlaceHolder(E[0].res));for(var M=0,I=E.length;M<I;M++){var A=E[M],R=A.id,O=M<T,N=!1,D=l.length;if(this._isLoadingTile(R))N=o=!0,this.markCurrent(this.tilesLoading[R],!0);else{var z=this.getCachedTile(A,O);if(z)O||(z.image&&this.isTileFadingIn(z.image)&&(N=o=!0,this.setToRedraw()),this.isTileComplete(z)?l.push(z):(N=!0,n&&b.set(R,z)));else{N=o=!0;var L=g&&a+v[0]>g;this._tileQueueIds.has(A.id)||L||e.isInteracting()&&!e.isMoving()&&!e.isRotating()||(a++,m[R]=A)}}if(n&&!O&&(l.length===D?x.push(A):s[A.id]=1),!n&&!O&&N&&!s[R]){s[R]=1,P&&!p[R]&&(A.cache=!1,f.push({image:P,info:A}),p[R]=1);var B=this._findChildTiles(A);if(B.length&&B.forEach((function(e){d[e.info.id]||(h.push(e),d[e.info.id]=1)})),!B.length||4!==B.length){var F=this._findParentTile(A);if(F){var j=F.info.id;void 0===c[j]&&(c[j]=u.length,u.push(F))}}}}}var H=[];if(n)for(var V=0;V<x.length;V++){var U=x[V].info?x[V].info:x[V];if(U.parent&&!s[U.id]){var q=this._findChildTiles(U),G=q.tiles,W=q.missedTiles;G.length?(TA(l,G),TA(H,W)):b.has(U.id)?(l.push(b.get(U.id)),b.delete(U.id)):(s[U.id]=1,H.push(U))}}return this.tileCache.shrink(),{childTiles:h,missedTiles:H,parentTiles:u,tiles:l,incompleteTiles:b&&Array.from(b.values()),placeholders:f,loading:o,loadingCount:a,tileQueue:m}},n.removeTileCache=function(e){delete this.tilesInView[e],this.tileCache.remove(e)},n.isTileCachedOrLoading=function(e){return this.tileCache.get(e)||this.tilesInView[e]||this.tilesLoading[e]},n.isTileCached=function(e){return!(!this.tileCache.get(e)&&!this.tilesInView[e])},n.isTileFadingIn=function(e){return this._getTileFadingOpacity(e)<1},n._drawTiles=function(e,t,n,i,r){var a=this;t.length&&(t.sort(this._compareTiles),this._parentTiles=t),n.length&&(this._childTiles=n,this._childTiles.sort(this._compareTiles));var o=!0;this.layer.constructor!==hj&&this.layer.constructor!==xj||(this._renderTimestamp===this.canvas._parentTileTimestamp?o=!1:this.canvas._parentTileTimestamp=this._renderTimestamp);var s="gl"===this.layer.options.renderer&&(!this.isGL||this.isGL()),l={tiles:e,parentTiles:this._parentTiles,childTiles:this._childTiles,parentContext:r};if(this.onDrawTileStart(l,r),o&&1===this.layer.options.opacity){this.layer._silentConfig=!0;var u=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,s?(this._drawChildTiles(n,r),this._drawParentTiles(this._parentTiles,r)):(this._drawParentTiles(this._parentTiles,r),this._drawChildTiles(n,r)),this.layer.options.fadeAnimation=u,this.layer._silentConfig=!1}this.drawingCurrentTiles=!0,e.sort(this._compareTiles);for(var c=0,h=e.length;c<h;c++)this._drawTileAndCache(e[c],r);if(delete this.drawingCurrentTiles,o&&this.layer.options.opacity<1){this.layer._silentConfig=!0;var d=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,s?(this._drawChildTiles(n,r),this._drawParentTiles(this._parentTiles,r)):(this._drawParentTiles(this._parentTiles,r),this._drawChildTiles(n,r)),this.layer.options.fadeAnimation=d,this.layer._silentConfig=!1}i.forEach((function(e){return a._drawTile(e.info,e.image,r)})),this.onDrawTileEnd(l,r)},n._drawChildTiles=function(e,t){var n=this;this.drawingChildTiles=!0,e.forEach((function(e){return n._drawTile(e.info,e.image,t)})),delete this.drawingChildTiles},n._drawParentTiles=function(e,t){var n=this;this.drawingParentTiles=!0,this._parentTiles.forEach((function(e){return n._drawTile(e.info,e.image,t)})),delete this.drawingParentTiles},n.onDrawTileStart=function(){},n.onDrawTileEnd=function(){},n._drawTile=function(e,t,n){t&&this.drawTile(e,t,n)},n._drawTileAndCache=function(e,t){this.isValidCachedTile(e)&&this._addTileToCache(e.info,e.image),this._drawTile(e.info,e.image,t)},n.drawOnInteracting=function(e,t,n){this.draw(t,n)},n.needToRedraw=function(){var t=this.getMap();return!!this._tileQueue.length||(t.getPitch()?e.prototype.needToRedraw.call(this):!(!t.isRotating()&&!t.isZooming())||(t.isMoving()?!!this.layer.options.forceRenderOnMoving:e.prototype.needToRedraw.call(this)))},n.hitDetect=function(){return!1},n._getLoadLimit=function(){return this.getMap().isInteracting()?this.layer.options.loadingLimitOnInteracting:this.layer.options.loadingLimit||0},n.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("TileLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),this.clear(),!1)},n.clear=function(){this.retireTiles(!0),this.tileCache.reset(),this.tilesInView={},this.tilesLoading={},this._tileQueue=[],this._tileQueueIds.clear(),this._parentTiles=[],this._childTiles=[],e.prototype.clear.call(this)},n._isLoadingTile=function(e){return!!this.tilesLoading[e]},n.clipCanvas=function(t){return e.prototype.clipCanvas.call(this,t)},n._clipByPitch=function(e){var t=this.getMap();if(t.getPitch()<=t.options.maxVisualPitch)return!1;if(!this.layer.options.clipByPitch)return!1;var n=t.getContainerExtent(),i=t.getDevicePixelRatio();return e.save(),e.strokeStyle="rgba(0, 0, 0, 0)",e.beginPath(),e.rect(0,Math.ceil(n.ymin)*i,Math.ceil(n.getWidth())*i,Math.ceil(n.getHeight())*i),e.stroke(),e.clip(),!0},n.loadTileQueue=function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t],i=this.loadTile(n);void 0===i.loadTime&&(this.tilesLoading[n.id]={image:i,current:!0,info:n})}},n.loadTile=function(e){var t=this,n={};if(this.loadTileBitmap)this.loadTileBitmap(e.url,e,(function(n){t.onTileLoad(n,e)}));else if(this._tileImageWorkerConn&&this.loadTileImage===this.constructor.prototype.loadTileImage)this._fetchImage(n,e);else{var i=this.layer.getTileSize(e.layer);(n=new Image).width=i.width,n.height=i.height,n.onload=this.onTileLoad.bind(this,n,e),n.onerror=this.onTileError.bind(this,n,e),this.loadTileImage(n,e.url)}return n},n._fetchImage=function(e,t){var n=this;if(e instanceof Image)e.src=t.url;else{var i=Math.abs(t.x+t.y)%this._tileImageWorkerConn.workers.length;this._tileImageWorkerConn.fetchImage(t.url,i,(function(i,r){i?n.onTileError(e,t,i):qA(r,(function(e){n.onTileLoad(e,t)}))}),this.layer.options.fetchOptions||{referrer:document.location.href,headers:{accept:"image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"}})}},n.loadTileImage=function(e,t){var n=this.layer.options.crossOrigin;return xI(n)||(e.crossOrigin=n),wA(e,[t])},n.abortTileLoading=function(e,t){t&&void 0!==t.id&&this.removeTileLoading(t),e&&e instanceof Image&&(e.onload=uH,e.onerror=uH,e.src=FA)},n.onTileLoad=function(e,t){this.removeTileLoading(t),this._tileQueue.push({tileInfo:t,tileData:e}),this._tileQueueIds.add(t.id),this.setToRedraw()},n.removeTileLoading=function(e){delete this.tilesLoading[e.id],this.setToRedraw()},n._consumeTileQueue=function(){for(var e=0,t=this.layer.options.tileLimitPerFrame,n=this._tileQueue;n.length&&(t<=0||e<t);){var i=n.shift(),r=i.tileData,a=i.tileInfo;this._tileQueueIds.has(a.id)&&(this._tileQueueIds.delete(a.id),this.checkTileInQueue(r,a)&&(this.consumeTile(r,a),e++))}},n._computeAvgTileAltitude=function(){var e=0,t=0,n=0;for(var i in this.tilesInView){var r=this.tilesInView[i]&&this.tilesInView[i].info;r&&(e+=r.minAltitude||0,t+=r.maxAltitude||0,n++)}this.avgMinAltitude=e/n,this.avgMaxAltitude=t/n},n.checkTileInQueue=function(){return!0},n.consumeTile=function(e,t){if(this.layer&&this.tilesInView){var n={tile:t,tileImage:e};this.resetTileLoadTime(e=n.tileImage),this.removeTileLoading(t),this._addTileToCache(t,e),this.layer.fire("tileload",n),this.setToRedraw()}},n.resetTileLoadTime=function(e){e.loadTime=yI()},n.onTileError=function(e,t){if(this.layer){if(e.onerrorTick=e.onerrorTick||0,this.layer.options.tileRetryCount>e.onerrorTick)return e.onerrorTick++,this._fetchImage(e,t),void this.removeTileLoading(t);var n=this.layer.options.errorUrl;if(n){if(e instanceof Image&&e.src!==n)return e.src=n,void this.removeTileLoading(t);(e=new Image).src=n}e=e instanceof Image?e:sH,this.abortTileLoading(e,t),e.loadTime=0,this.removeTileLoading(t),this._addTileToCache(t,e),this.setToRedraw(),this.layer.fire("tileerror",{tile:t})}},n.drawTile=function(e,t){if(t&&this.getMap()){var n=e.extent2d,i=e.offset,r=tH.set(n.xmin-i[0],n.ymax-i[1]),a=e.z,o=e.id,s=this.getMap(),l=s.getZoom(),u=this.context,c=s._pointAtResToContainerPoint(r,e.res,0,nH),h=s.getBearing(),d=h||l!==a,f=this.getTileOpacity(t,e),p=u.globalAlpha;f<1&&(u.globalAlpha=f),d||c._round();var m=c.x,v=c.y,g=e.extent2d.xmax-e.extent2d.xmin,y=e.extent2d.ymax-e.extent2d.ymin,_=this.layer,x=_?_.options.bufferPixel:0;if(d){u.save(),u.translate(m,v),h&&u.rotate(-h*Math.PI/180),g+=x,y+=x;var b=s._getResolution();if(b!==e.res){var w=e.res/b;u.scale(w,w)}m=v=0}if(oN.image(u,t,m,v,g,y),this.layer.options.debug){var k=this.layer.options.debugOutline;u.save(),u.strokeStyle=k,u.fillStyle=k,u.strokeWidth=10,u.font="20px monospace";var C=new xA(m,v);oN.rectangle(u,C,{width:g,height:y},1,0),oN.fillText(u,this.getDebugInfo(o),C._add(32,y-14),k),oN.drawCross(u,m+g/2,v+y/2,2,k),u.restore()}d&&u.restore(),u.globalAlpha!==p&&(u.globalAlpha=p),this.setCanvasUpdated()}},n.getDebugInfo=function(e){var t=e.split("_"),n=t.length;return t[n-3]+"/"+t[n-2]+"/"+t[n-1]},n.findChildTiles=function(e){return this._findChildTiles(e)},n._findChildTiles=function(e){var t=this._getLayerOfTile(e.layer),n=t&&t.options.terrainTileMode&&t._isPyramidMode();if(!t||!t.options.background&&!n||e.z>this.layer.getMaxZoom())return aH;var i=this.getMap(),r=[];if(t._isPyramidMode()){if(!n){for(var a=this._getLayerOfTile(e.layer),o=2*e.x,s=2*e.y,l=e.z+1,u=[],c=0;c<2;c++)for(var h=0;h<2;h++)u.push(o+c,s+h,l);for(;u.length;){var d=u.pop(),f=u.pop(),p=u.pop(),m=a._getTileId(p,f,d,e.layer),v=d+1<=e.z+2,g=this.tileCache.getAndRemove(m);if(g){if(this.isValidCachedTile(g))r.push(g),this.tileCache.add(m,g);else if(v)for(var y=0;y<2;y++)for(var _=0;_<2;_++)u.push(2*p+y,2*f+_,d+1)}else if(v)for(var x=0;x<2;x++)for(var b=0;b<2;b++)u.push(2*p+x,2*f+b,d+1)}return r}var w;n&&(w=[]);for(var k=2*e.x,C=2*e.y,S=e.z+1,T=[],E=0;E<2;E++)for(var P=0;P<2;P++){var M=t._getTileId(k+E,C+P,S,e.layer),I=this.tileCache.getAndRemove(M);I&&this.isValidCachedTile(I)?(r.push(I),this.tileCache.add(M,I),T.push(null)):T.push(M)}if(r.length<4)for(var A=0,R=0;R<2;R++)for(var O=0;O<2;O++){var N=T[A++];if(N){for(var D=k+R,z=C+O,L=S,B=r.length,F=[],j=0;j<2;j++)for(var H=0;H<2;H++){var V=t._getTileId(2*D+j,2*z+H,L+1,e.layer),U=this.tileCache.getAndRemove(V);U&&this.isValidCachedTile(U)?(r.push(U),this.tileCache.add(V,U),F.push(null)):F.push(V)}if(n&&r.length-B<4){var q=t.tileInfoCache.get(N)||t._createChildNode(e,R,O,[0,0],N);if(r.length-B==0)w.push(q);else for(var G=0,W=0;W<2;W++)for(var Z=0;Z<2;Z++){var X=F[G++];if(X){var K=this.layer.tileInfoCache.get(X)||t._createChildNode(q,W,Z,[0,0],X);w.push(K)}}}}}return n?{tiles:r,missedTiles:w}:r}for(var Y=e.res,J=e.extent2d.getMin(),Q=e.extent2d.getMax(),$=t._project(i._pointToPrjAtRes(J,Y,iH),iH),ee=t._project(i._pointToPrjAtRes(Q,Y,rH),rH),te=1;te<1;te++)this._findChildTilesAt(r,$,ee,t,e.z+te);return r},n._findChildTilesAt=function(e,t,n,i,r){var a=i.getId(),o=i.getSpatialReference().getResolution(r);if(o)for(var s,l,u=i._getTileConfig().getTileIndex(t,o),c=i._getTileConfig().getTileIndex(n,o),h=Math.min(u.idx,c.idx),d=Math.max(u.idx,c.idx),f=Math.min(u.idy,c.idy),p=Math.max(u.idy,c.idy),m=h;m<d;m++)for(var v=f;v<p;v++)s=i._getTileId(m,v,r,a),(l=this.tileCache.getAndRemove(s))&&this.isValidCachedTile(l)&&(e.push(l),this.tileCache.add(s,l))},n.findParentTile=function(e,t){return this._findParentTile(e,t)},n._findParentTile=function(e,t){var n=this.getMap(),i=this._getLayerOfTile(e.layer);if(!i||!i.options.background&&!i.options.terrainTileMode)return null;var r=i.getMinZoom(),a=t||e.z-r;if(i._isPyramidMode()){for(var o=e.z-a,s=e.z-1;s>=o;s--){var l,u=Math.pow(2,e.z-s),c=Math.floor(e.x/u),h=Math.floor(e.y/u);l=s===e.z-1?e.parent:i._getTileId(c,h,s,e.layer);var d=this.tileCache.getAndRemove(l);if(d&&this.isValidCachedTile(d))return this.tileCache.add(l,d),d}return null}for(var f=i.getSpatialReference(),p=f.getZoomDirection(),m=e.res,v=e.extent2d.getCenter(),g=i._project(n._pointToPrjAtRes(v,m)),y=1;y<=a;y++){var _=e.z-p*y,x=f.getResolution(_);if(x){var b=i._getTileConfig().getTileIndex(g,x),w=i._getTileId(b.x,b.y,_,e.layer),k=this.tileCache.getAndRemove(w);if(k)return this.tileCache.add(w,k),k}}return null},n.isValidCachedTile=function(e){return!!e.image},n.isTileComplete=function(){return!0},n._getLayerOfTile=function(e){return this.layer.getChildLayer?this.layer.getChildLayer(e):this.layer},n.getCachedTile=function(e,t){var n=e.id,i=this.tilesInView,r=this.tileCache.getAndRemove(n);if(r){t||(i[n]=r);var a=this.tilesLoading;if(a&&a[n]){this.markCurrent(a[n],!1);var o=a[n];this.abortTileLoading(o.image,o.info),delete a[n]}}else r=i[n];return r&&(r.current=!0,this.isValidCachedTile(r)&&this.tileCache.add(n,r)),r},n._addTileToCache=function(e,t){this.isValidCachedTile({info:e,image:t})&&(this.tilesInView[e.id]={image:t,current:!0,info:e})},n.getTileOpacity=function(e,t){var n=this._getTileFadingOpacity(e);if(this.layer.getChildLayer){var i=this.layer.getLayer(t.layer);i&&(n*=i.options.opacity)}return n},n._getTileFadingOpacity=function(e){return this.layer.options.fadeAnimation&&e.loadTime?Math.min(1,(yI()-e.loadTime)/this.layer.options.fadeDuration):1},n.onRemove=function(){this.clear(),delete this.tileCache,delete this._tilePlaceHolder,delete this._tileZoom,e.prototype.onRemove.call(this)},n.markCurrent=function(e,t){e.current=t},n.markTiles=function(){var e=0,t=0;if(this.tilesLoading)for(var n in this.tilesLoading)this.markCurrent(this.tilesLoading[n],!1),e++;if(this.tilesInView)for(var i in this.tilesInView)this.markCurrent(this.tilesInView[i],!1),t++;return[e,t]},n.retireTiles=function(e){for(var t in this.tilesLoading){var n=this.tilesLoading[t];!e&&n.current||(n.image&&this.abortTileLoading(n.image,n.info),this.deleteTile(n),this.removeTileLoading(n.info))}for(var i in this.tilesInView){var r=this.tilesInView[i];r.current||(delete this.tilesInView[i],this.tileCache.has(i)||this.deleteTile(r))}},n.deleteTile=function(e){if(e&&e.image){var t=e.info.id;this._tileQueueIds.has(t)&&this._tileQueueIds.delete(t),e.image.close&&e.image.close(),e.image instanceof Image&&(e.image.onload=null,e.image.onerror=null)}},n._generatePlaceHolder=function(e){var t=this.getMap(),n=this.layer.options.placeholder;if(!n||t.getPitch())return null;var i=this.layer.getTileSize(),r=e/t._getResolution(),a=this._tilePlaceHolder=this._tilePlaceHolder||oN.createCanvas(1,1,t.CanvasClass);return a.width=i.width*r,a.height=i.height*r,SI(n)?n(a):function(e){var t=e.getContext("2d"),n=e.width,i=e.height,r=n/16,a=i/16;t.beginPath();for(var o=0;o<16;o++)t.moveTo(0,o*a),t.lineTo(n,o*a),t.moveTo(o*r,0),t.lineTo(o*r,i);t.strokeStyle="rgba(180, 180, 180, 0.1)",t.lineWidth=1,t.stroke(),t.beginPath();for(var s=[[0,0],[n,0],[0,i],[n,i],[0,0],[0,i],[n,0],[n,i],[0,i/2],[n,i/2],[n/2,0],[n/2,i]],l=1;l<s.length;l+=2)t.moveTo(s[l-1][0],s[l-1][1]),t.lineTo(s[l][0],s[l][1]);t.lineWidth=4,t.stroke()}(a),a},n.setTerrainHelper=function(e){this._terrainHelper=e},t}(ID);function uH(){return!1}function cH(e,t){return Math.abs(this._tileZoom-e.info.z)-Math.abs(this._tileZoom-t.info.z)}hj.registerRenderer("canvas",lH);var hH=new xA(0,0),dH={properties:{}},fH=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.isDrawable=function(){return!0},n.needToRedraw=function(){var t=this.getMap();return!(!this.isGL()||t.getPitch()||!t.isZooming()||t.isMoving()||t.isRotating())||e.prototype.needToRedraw.call(this)},n.onDrawTileStart=function(e,t){var n=this.gl;if(n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.enable(n.POLYGON_OFFSET_FILL),n.enable(n.STENCIL_TEST),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),n.depthMask(!!this.layer.options.depthMask),t&&t.renderTarget){var i=t.renderTarget.fbo;if(i){var r=t.renderTarget.getFramebuffer(i);n.bindFramebuffer(n.FRAMEBUFFER,r)}}},n.onDrawTileEnd=function(e,t){var n=this.gl;t&&t.renderTarget&&t.renderTarget.fbo&&n.bindFramebuffer(n.FRAMEBUFFER,null)},n.drawTile=function(t,n,i){if(!i||!i.sceneFilter||i.sceneFilter(dH)){var r=this.getMap();if(t&&r&&n){var a=t._glScale=t._glScale||t.res/r.getGLRes(),o=t.extent2d.xmax-t.extent2d.xmin,s=t.extent2d.ymax-t.extent2d.ymin;if(!1!==t.cache&&this._bindGLBuffer(n,o,s),this.isGL()){var l=t.offset,u=hH.set(t.extent2d.xmin-l[0],t.extent2d.ymax-l[1]),c=u.x*a,h=u.y*a,d=this.getTileOpacity(n,t),f=null;this.layer.options.debug&&(f=this.getDebugInfo(t.id));var p=this.gl;p.stencilFunc(p.LEQUAL,Math.abs(this.getCurrentTileZoom()-t.z),255);var m=this.layer.getPolygonOffset(),v=this.drawingCurrentTiles?m:m+1;p.polygonOffset(v,v),this.drawGLImage(n,c,h,o,s,a,d,f),this._getTileFadingOpacity(n)<1?this.setToRedraw():this.setCanvasUpdated()}else e.prototype.drawTile.call(this,t,n)}}},n._bindGLBuffer=function(e,t,n){e.glBuffer||(e.glBuffer=this.bufferTileData(0,0,t,n))},n.loadTileImage=function(e,t){var n=this.layer.options.crossOrigin;e.crossOrigin=null!==n?n:"",e.src=t},n.onCanvasCreate=function(){this.canvas.gl&&this.canvas.gl.wrap||this.createCanvas2()},n.createContext=function(){e.prototype.createContext.call(this),this.createGLContext()},n.resizeCanvas=function(t){this.canvas&&(e.prototype.resizeCanvas.call(this,t),this.resizeGLCanvas())},n.clearCanvas=function(){this.canvas&&(e.prototype.clearCanvas.call(this),this.clearGLCanvas())},n.getCanvasImage=function(){if(!this.isGL()||!this.canvas2)return e.prototype.getCanvasImage.call(this);var t=e.prototype.getCanvasImage.call(this);return t&&(t.image=this.canvas2),t},n.isGL=function(){if(this.canvas.gl&&this.canvas.gl.wrap)return!0;var e=this.getMap();return e&&(e.getPitch()||e.getBearing())||this.layer&&!!this.layer.options.fragmentShader},n.deleteTile=function(t){e.prototype.deleteTile.call(this,t),t&&t.image&&this.disposeImage(t.image),delete t.image},n.onRemove=function(){e.prototype.onRemove.call(this),this.removeGLCanvas()},t}(Aj(lH));function pH(e){var t=this.layer.getTileSize(),n=this.canvas.constructor,i=this.getMap(),r=i.getDevicePixelRatio(),a=oN.createCanvas(t.width*r,t.height*r,n);a.layer=this.layer;var o=this,s=new xA(e.extent2d.xmin,e.extent2d.ymax),l=new VN(i.pointToCoordinate(s),i.pointToCoordinate(s.add(t.width,t.height)),i.getProjection());return this.layer.drawTile(a,{url:e.url,point:s,center:i.pointToCoordinate(s.add(t.width/2,t.height/2)),extent:l,z:e.z,x:e.x,y:e.y},(function(t){t?o.onTileError(a,e):o.onTileLoad(a,e)})),a}hj.registerRenderer("gl",fH);var mH=function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.prototype.loadTile=function(){return pH.apply(this,arguments)},t}(lH),vH=function(e){function t(){return e.apply(this,arguments)||this}return cA(t,e),t.prototype.loadTile=function(){return pH.apply(this,arguments)},t}(fH);bj.registerRenderer("canvas",mH),bj.registerRenderer("gl",vH);var gH,yH="undefined"!=typeof Int8Array?new Int8Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]):[];(gH=(function(e,t,n){var i;this.gl=e,this.quadVertices=t||yH,this.attributes=["a_position",3,(i=t,i instanceof Float32Array?"FLOAT":i instanceof Int16Array?"SHORT":i instanceof Uint16Array?"UNSIGNED_SHORT":i instanceof Int8Array?"BYTE":i instanceof Uint8Array||i instanceof Uint8ClampedArray?"UNSIGNED_BYTE":"FLOAT")],this.debug=n}).prototype).start=function(){var e=this.gl;e.enable(e.STENCIL_TEST),e.stencilMask(255),e.stencilOp(e.KEEP,e.REPLACE,e.REPLACE),e.depthMask(!1),this._save(),this.buffer||(this._createBuffer(),this._createProgram()),e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),Cj(e,this.program,this.attributes),this.transformLoc||(this.transformLoc=e.getUniformLocation(this.program,"transform")),this.colorLoc||(this.colorLoc=e.getUniformLocation(this.program,"color")),this.debug||e.colorMask(!1,!1,!1,!1)},gH.end=function(){var e=this.gl;e.depthMask(!0),this._restore(),this.debug||e.colorMask(!0,!0,!0,!0)},gH.draw=function(e){var t=this.gl;t.uniformMatrix4fv(this.transformLoc,!1,e),t.uniform3fv(this.colorLoc,[Math.random(),Math.random(),Math.random()]),t.drawArrays(t.TRIANGLE_STRIP,0,4)},gH.remove=function(){var e=this.gl;return this.buffer&&e.deleteBuffer(this.buffer),this.program&&(e.deleteShader(this.program.fragmentShader),e.deleteShader(this.program.vertexShader),e.deleteProgram(this.program)),delete this.transformLoc,delete this.gl,this},gH.stencilMask=function(e){return this.gl.stencilMask(e),this},gH.stencilFunc=function(e,t,n){return this.ref=t,this.gl.stencilFunc(e,t,n),this},gH.stencilOp=function(e,t,n){return this.gl.stencilOp(e,t,n),this},gH.resetFunc=function(){return this.ref=1,this.gl.stencilFunc(this.gl.ALWAYS,1,255),this},gH._save=function(){this._savedProgram=this.gl.program},gH._restore=function(){var e=this.gl;e.program=this._savedProgram,e.program&&e.useProgram(e.program)},gH._createBuffer=function(){var e=this.gl;if(this.buffer=e.createBuffer(),!this.buffer)throw new Error("Failed to create the buffer object");e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.quadVertices,e.STATIC_DRAW)},gH._createProgram=function(){var e=kj(this.gl,"\n    attribute vec3 a_position;\n    uniform mat4 transform;\n\n    void main()\n    {\n        gl_Position = transform * vec4(a_position, 1.0);\n    }\n","\n    precision mediump float;\n    uniform vec3 color;\n    void main()\n    {\n        gl_FragColor = vec4(color, 1.0);\n    }\n"),t=e.program,n=e.fragmentShader;t.vertexShader=e.vertexShader,t.fragmentShader=n,this.program=t};var _H=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.checkResources=function(){var e=this._geosToCheck||[];if(!this._resourceChecked&&this.layer._geoList&&TA(e,this.layer._geoList),!NA(e))return[];for(var t=[],n={},i=e.length-1;i>=0;i--){var r=e[i]._getExternalResources();if(r.length)if(this.resources)for(var a=0;a<r.length;a++){var o=r[a][0];this.resources.isResourceLoaded(r[a])||n[o]||(t.push(r[a]),n[o]=1)}else t.push.apply(t,r)}return this._resourceChecked=!0,delete this._geosToCheck,t},n.render=function(){return this.layer._sortGeometries(),e.prototype.render.apply(this,arguments)},n._addGeoToCheckRes=function(e){e&&(Array.isArray(e)||(e=[e]),this._geosToCheck||(this._geosToCheck=[]),TA(this._geosToCheck,e))},n.onGeometryAdd=function(e){this._addGeoToCheckRes(e),xH(this)},n.onGeometryRemove=function(){xH(this)},n.onGeometrySymbolChange=function(e){this._addGeoToCheckRes(e.target),xH(this)},n.onGeometryShapeChange=function(){xH(this)},n.onGeometryPositionChange=function(){xH(this)},n.onGeometryZIndexChange=function(){xH(this)},n.onGeometryShow=function(){xH(this)},n.onGeometryHide=function(){xH(this)},n.onGeometryPropertiesChange=function(){xH(this)},t}(ID);function xH(e){e.layer.options.drawImmediate&&e.render(),e.setToRedraw()}var bH=new qN,wH=[],kH=new qN,CH=new kN;function SH(e){if(!e)return null;var t=e.getContext("2d");return t.clearRect(0,0,e.width,e.height),t}function TH(e){return e&&e.options.progressiveRender&&e.options.progressiveRenderDebug}var EH=function(e){function t(){return e.apply(this,arguments)||this}cA(t,e);var n=t.prototype;return n.setToRedraw=function(){return e.prototype.setToRedraw.call(this),this._resetProgressiveRender(),this},n._geoIsCollision=function(e,t){if(!e)return!1;if(!e.options.collision)return!1;if(e.isPoint&&e.getContainerExtent){e.bbox||(e.bbox=[0,0,0,0]);var n=this.layer.options.collisionBufferSize,i=e.getContainerExtent();if(!i)return!1;if(e.bbox[0]=i.xmin-n,e.bbox[1]=i.ymin-n,e.bbox[2]=i.xmax+n,e.bbox[3]=i.ymax+n,t.collides(e.bbox))return!0;t.insertBox(e.bbox)}return!1},n.getImageData=function(){if(!this._lastRenderTime||yI()-this._lastRenderTime<32)return null;if(!this.context||!this.context.canvas)return null;if(!this._imageData){var e=this.context.canvas,t=e.width,n=e.height;try{this._imageData=this.context.getImageData(0,0,t,n)}catch(i){console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",i)}}return this._imageData},n.clearImageData=function(){this._imageData=null,delete this._imageData,this._lastRenderTime=yI()},n.checkResources=function(){var t=this,n=e.prototype.checkResources.apply(this,arguments),i=this.layer.getStyle();return i&&(Array.isArray(i)||(i=[i]),i.forEach((function(e){for(var i=PR(e.symbol,!0),r=0,a=i.length;r<a;r++)t.resources.isResourceLoaded(i[r])||n.push(i[r])}))),n},n.needToRedraw=function(){if(this.isProgressiveRender()&&!this.renderEnd)return!0;var t=this.getMap();return!(!t.isInteracting()||!this.layer.options.enableAltitude)||!(t.isZooming()&&!t.isRotating()&&!t.getPitch()&&!this._hasPoint&&this.layer.constructor===_B)&&e.prototype.needToRedraw.call(this)},n.draw=function(){if(this.getMap()){if(!this.layer.isVisible()||this.layer.isEmpty())return this.clearCanvas(),void this.completeRender();this.prepareCanvas(),this.drawGeos(),this.completeRender()}},n.isBlank=function(){return!!this.context&&!this.isProgressiveRender()&&!this.context.canvas._drawn},n.drawOnInteracting=function(){if(this._geosToDraw){this._updateMapStateCache(),this._updateDisplayExtent();var e=this.getMap(),t=this.layer.getCount(),n=this.mapStateCache.resolution;(e.isZooming()&&e.options.seamlessZoom&&void 0!==this._drawnRes&&n>1.5*this._drawnRes&&this._geosToDraw.length<t||e.isMoving()||e.isInteracting())&&(this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this._checkGeos(),this._drawnRes=n),this._sortByDistanceToCamera(e.cameraPosition);var i=this.layer.options,r=i.collisionDelay;if(i.collision){var a=yI();this._lastCollisionTime||(this._lastCollisionTime=a),a-this._lastCollisionTime<=r?this._geosToDraw=this._lastGeosToDraw||this._geosToDraw:(this._collidesGeos(),this._lastCollisionTime=a)}for(var o=0,s=this._geosToDraw.length;o<s;o++){var l=this._geosToDraw[o];l._isCheck||l.isVisible()?(l._paint(this._displayExtent),this._geosToDraw[o]._cPoint=void 0,this._geosToDraw[o]._inCurrentView=void 0):(delete l._cPoint,delete l._inCurrentView)}this.clearImageData(),this._lastGeosToDraw=this._geosToDraw,TH(this.layer)&&console.log("progressiveRender on drawOnInteracting page:",this.page)}},n.show=function(){this.layer.forEach((function(e){e._repaint()})),e.prototype.show.apply(this,arguments)},n.forEachGeo=function(e,t){this.layer.forEach(e,t)},n._checkGeos=function(){for(var e=this._getCurrentNeedRenderGeos(),t=0,n=e.length;t<n;t++)this.checkGeo(e[t]);return this},n.drawGeos=function(){this._drawSnapshot(),this._updateMapStateCache(),this._drawnRes=this.mapStateCache.resolution,this._updateDisplayExtent(),this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this._checkGeos(),this._sortByDistanceToCamera(this.getMap().cameraPosition),this._collidesGeos();for(var e=0,t=this._geosToDraw.length;e<t;e++)this._geosToDraw[e]._paint(),this._geosToDraw[e]._cPoint=void 0,this._geosToDraw[e]._inCurrentView=void 0;this.clearImageData(),this._lastGeosToDraw=this._geosToDraw,TH(this.layer)&&console.log("progressiveRender drawGeos page:",this.page),this._snapshot(),this._setDrawGeosDrawTime()},n.prepareToDraw=function(){return this.layer._drawTime=yI(),this._hasPoint=!1,this._geosToDraw=[],this},n._setDrawGeosDrawTime=function(){for(var e=yI(),t=this.layer._drawTime,n=this.getGeoPainterList(),i=0,r=n.length;i<r;i++){var a=n[i];a&&a._setDrawTime&&a._setDrawTime(t)}return TH(this.layer)&&console.log("_setDrawGeosDrawTime time:",yI()-e+"ms"),this},n.checkGeo=function(e){if(e.isPoint&&void 0!==this._onlyHasPoint)e._inCurrentView&&(this._hasPoint=!0,e._isCheck=!0,this._geosToDraw.push(e));else if(e._isCheck=!1,e&&e.isVisible()&&e.getMap()&&e.getLayer()&&e.getLayer().isCanvasRender()){var t=e._getPainter(),n=!0;if(e._inCurrentView)n=!0;else if(!1===e._inCurrentView)n=!1;else{var i=t.get2DExtent(this.resources,bH);i&&i.intersects(this._displayExtent)||(n=!1)}n&&(t.hasPoint()&&(this._hasPoint=!0),e._isCheck=!0,this._geosToDraw.push(e))}},n._collidesGeos=function(){if(!this.layer.options.collision)return this;var e=this.layer.options.collisionScope,t=this.layer.getMap(),n="map"===e?t.getCollisionIndex():CH;n===CH&&n.clear();var i=this._geosToDraw;this._geosToDraw=[];for(var r=0,a=i.length;r<a;r++)this._geoIsCollision(i[r],n)||this._geosToDraw.push(i[r]);return this},n.onZoomEnd=function(){delete this.canvasExtent2D,e.prototype.onZoomEnd.apply(this,arguments)},n.onRemove=function(){this.forEachGeo((function(e){e.onHide()})),delete this._geosToDraw,delete this.snapshotCanvas,delete this.pageGeos,delete this.geoPainterList},n.onGeometryPropertiesChange=function(t){t&&this.layer._styleGeometry(t.target),e.prototype.onGeometryPropertiesChange.call(this,t)},n._updateDisplayExtent=function(){var e=this.canvasExtent2D;if(this._maskExtent){if(!this._maskExtent.intersects(e))return void this.completeRender();e=e.intersection(this._maskExtent)}this._displayExtent=e},n.identifyAtPoint=function(e,t){void 0===t&&(t={});var n=this.getGeosForIdentify();return n?this.layer._hitGeos(n,e,t):[]},n._updateMapStateCache=function(){var e=this.getMap(),t=e._pointToContainerPoint(this.southWest)._add(0,-e.height),n=e.getResolution(),i=e.getPitch(),r=e.getBearing(),a=e.getGLScale(),o=e.getGLRes(),s=e.getContainerExtent(),l=e._get2DExtent(),u=e._get2DExtentAtRes(o);return this.mapStateCache={resolution:n,pitch:i,bearing:r,glScale:a,glRes:o,_2DExtent:l,glExtent:u,containerExtent:s,offset:t},this},n._batchConversionMarkers=function(e){if(this._onlyHasPoint=void 0,!this._constructorIsThis())return[];var t=[],n=[],i=[],r={},a=this.layer,o=a.options,s=a.getAltitude?a.getAltitude():0,l=a.isCanvasRender();this._onlyHasPoint=!0;for(var u=0,c=this._getCurrentNeedRenderGeos(),h=0,d=c.length;h<d;h++){var f=c[h];if(f.isPoint){var p=f._painter;p||(p=f._getPainter());var m=p.getRenderPoints("center")[0][0],v=o.enableAltitude?f._getAltitude():s;void 0===r[v]&&(r[v]=p.getAltitude()),t[u]=m,i[u]=r[v],n[u]=f,u++}else this._onlyHasPoint=!1}if(0===u)return[];var g=this.getMap(),y=UA(t,"_pt");y=g._pointsAtResToContainerPoints(t,e,i,y);for(var _=g.getContainerExtent(),x=_.xmax,b=_.ymax,w=_.xmin,k=_.ymin,C={},S=0,T=n.length;S<T;S++){var E=n[S];if(E._cPoint=y[S],E._cPoint){var P=y[S],M=P.x,I=P.y;if(E._inCurrentView=M>=w&&I>=k&&M<=x&&I<=b,!E._inCurrentView){var A,R=E.getSymbolHash();A=R?C[R]=C[R]||E._painter.getFixedExtent():E._painter.getFixedExtent(),kH.set(A.xmin,A.ymin,A.xmax,A.ymax),kH._add(y[S]),E._inCurrentView=kH.intersects(_)}E._inCurrentView&&(E.isVisible()&&l||(E._inCurrentView=!1),this._onlyHasPoint&&E._inCurrentView&&(this._hasPoint=!0,E._isCheck=!0,this._geosToDraw.push(E)))}else E._inCurrentView=!1}return y},n._sortByDistanceToCamera=function(e){if(this.layer.options.sortByDistanceToCamera&&this._geosToDraw.length){var t=this.getMap(),n=t.distanceToPoint(1e3,0,t.getGLScale()).x/1e3;this._geosToDraw.sort((function(t,i){if(!t.isPoint||!i.isPoint)return 0;var r=t._painter,a=i._painter;if(!r||!a)return 0;var o=r.getRenderPoints("center")[0][0],s=a.getRenderPoints("center")[0][0],l=r.getAltitude()*n,u=a.getAltitude()*n;LB(wH,o.x,o.y,l);var c=VB(wH,e);return LB(wH,s.x,s.y,u),VB(wH,e)-c}))}},n._constructorIsThis=function(){return this.constructor===t},n.isProgressiveRender=function(){var e=this.layer;if(!e)return!1;var t=e.options||{};return!t.collision&&t.progressiveRender},n.getGeosForIdentify=function(){return this.isProgressiveRender()?this.pageGeos||[]:this._geosToDraw||[]},n.getGeoPainterList=function(){if(!this.isProgressiveRender()){for(var e=[],t=this._geosToDraw||[],n=0,i=t.length;n<i;n++)e.push(t[n]._painter);return e}return this.geoPainterList||[]},n._checkSnapshotCanvas=function(){if(!this.isProgressiveRender())return delete this.snapshotCanvas,null;var e=this.canvas;if(!e)return delete this.snapshotCanvas,null;this.snapshotCanvas||(this.snapshotCanvas=oN.createCanvas(1,1));var t=this.snapshotCanvas,n=e.width,i=e.height,r=e.style;return t.width===n&&t.height===i||(t.width=n,t.height=i),t.style.width===r.width&&t.style.height===r.height||(t.style.width=r.width,t.style.height=r.height),t},n._getCurrentNeedRenderGeos=function(){var e=this.layer._geoList||[];if(!this.isProgressiveRender())return e;if(this.renderEnd)return[];var t=this.layer.options.progressiveRenderCount,n=this.page;return e.slice((n-1)*t,n*t)},n._resetProgressiveRender=function(){TH(this.layer)&&console.log("progressiveRender resetProgressiveRender"),this.renderEnd=!1,this.page=1,this.pageGeos=[],this.geoPainterList=[],this.maxTolerance=0,this._clearSnapshotCanvas()},n._clearSnapshotCanvas=function(){var e=this._checkSnapshotCanvas();e&&SH(e)},n._snapshot=function(){for(var e=this.isProgressiveRender(),t=this._geosToDraw||[],n=0,i=t.length;n<i;n++){var r=t[n],a=r._hitTestTolerance()||0;this.maxTolerance=Math.max(this.maxTolerance,a),e&&(this.pageGeos.push(r),this.geoPainterList.push(r._painter))}if(!e)return this;var o=yI(),s=this._checkSnapshotCanvas();s&&this.canvas&&SH(s).drawImage(this.canvas,0,0);var l=this.layer,u=Math.ceil((l._geoList||[]).length/l.options.progressiveRenderCount);return this.renderEnd=this.page>=u,this.renderEnd&&this._setDrawGeosDrawTime(),TH(this.layer)&&console.log("snapshot time:",yI()-o+"ms"),this.page++,this},n._drawSnapshot=function(){if(!this.isProgressiveRender())return this;var e=this.snapshotCanvas,t=this.context;if(!e||!t)return this;var n=this.getMap();if(!n)return this;var i=n.getDevicePixelRatio()||1,r=1/i;return t.scale(r,r),t.drawImage(e,0,0),t.scale(i,i),this},t}(_H);_B.registerRenderer("canvas",EH);var PH=function(e){function t(t){var n;return(n=e.call(this,t)||this)._containerIsCanvas=!!t._containerDOM.getContext,n._registerEvents(),n._loopTime=0,n._resizeEventList=[],n._resizeTime=-1/0,n}cA(t,e);var n=t.prototype;return n.load=function(){this.initContainer()},n.renderFrame=function(e){var t=this.map;if(!t||!t.options.renderable)return!1;if(this._handleResizeEventList(e),t.options.stopRenderOnOffscreen&&this._containerIsOffscreen())return!0;this._updateDomPosition(e),delete this._isViewChanged,t._fireEvent("framestart"),this.updateMapDOM(),t.clearCollisionIndex();var n=this._getAllLayerToRender();return this.drawLayers(n,e),this.drawLayerCanvas(n)&&(this.drawTops(),this._drawCenterCross(),t.options.debugSky&&this._debugSky()),this._needClear=!1,t._fireEvent("frameend"),this._recordView(),this._mapview=this._getMapView(),delete this._spatialRefChanged,this._fireLayerLoadEvents(),this.executeFrameCallbacks(),this._canvasUpdated=!1,t.uiCollides(),!0},n.updateMapDOM=function(){var e=this.map;if(!e.isZooming()){var t=e._getViewPointFrameOffset();t?e.offsetPlatform(t):this.domChanged()&&this.offsetPlatform(null,!0)}},n.drawLayers=function(e,t){for(var n=this.map,i=n.isInteracting(),r=[],a=[],o=n.options.fpsOnInteracting||0,s=0===o?0:1e3/o,l=this.map.options.layerCanvasLimitOnInteracting,u=e.length,c=n.getBaseLayer(),h=0,d=0;d<u;d++){var f=e[d];if(f.isVisible()){var p=f.isCanvasRender();p&&r.push(f.getId());var m=f._getRenderer();if(m){var v=this._checkLayerRedraw(f);p&&m.isCanvasUpdated()&&(v||a.push(f.getId()),this.setLayerCanvasUpdated());var g=m.__zoomTransformMatrix;if(delete m.__zoomTransformMatrix,v){if(i&&p){if(l>0&&u-1-d>l&&f!==c){f._getRenderer().clearCanvas();continue}h+=this._drawCanvasLayerOnInteracting(f,h,s,t)}else i&&m.drawOnInteracting?(m.prepareRender&&m.prepareRender(),m.checkAndDraw?m.checkAndDraw(m.drawOnInteracting,this._eventParam,t):m.drawOnInteracting(this._eventParam,t)):(m.render(t),p&&g&&m.isLoadingResource()&&(m.__zoomTransformMatrix=g));p&&(a.push(f.getId()),this.setLayerCanvasUpdated())}else p&&i&&(n.isZooming()&&!n.getPitch()?(m.prepareRender(),m.__zoomTransformMatrix=this._zoomMatrix):(n.getPitch()||n.isRotating())&&m.clearCanvas())}}}var y=this._canvasIds||[],_=this._updatedIds||[];this._canvasIds=r,this._updatedIds=a,this.isLayerCanvasUpdated()||y.join("---")===r.join("---")&&_.join("---")===a.join("---")||this.setLayerCanvasUpdated()},n._checkLayerRedraw=function(e){if(this.isSpatialReferenceChanged())return!0;var t=this.map,n=e._getRenderer();return e.isCanvasRender()?n.testIfNeedRedraw():!(!n.needToRedraw||!n.needToRedraw())||t.isInteracting()||this.isViewChanged()},n._drawCanvasLayerOnInteracting=function(e,t,n,i){var r=this.map,a=e._getRenderer(),o=a.getDrawTime(),s=0===n||n>0&&t+o<=n;if(a.mustRenderOnInteracting&&a.mustRenderOnInteracting())a.render(i);else{if(a.drawOnInteracting&&(e===r.getBaseLayer()||s||r.isZooming()&&e.options.forceRenderOnZooming||r.isMoving()&&e.options.forceRenderOnMoving||r.isRotating()&&e.options.forceRenderOnRotating))return a.prepareRender(),a.prepareCanvas(),a.checkAndDraw?a.checkAndDraw(a.drawOnInteracting,this._eventParam,i):a.drawOnInteracting(this._eventParam,i),o;!r.isZooming()||r.getPitch()||r.isRotating()?(r.getPitch()||r.isRotating())&&a.clearCanvas():(a.prepareRender(),a.__zoomTransformMatrix=this._zoomMatrix)}return a.drawOnInteracting&&!s&&a.onSkipDrawOnInteracting(this._eventParam,i),0},n._fireLayerLoadEvents=function(){if(this._updatedIds&&this._updatedIds.length>0){var e=this.map;this._updatedIds.reverse().forEach((function(t){var n=e.getLayer(t);if(n){var i=n._getRenderer();i&&i.isRenderComplete()&&n.fire("layerload")}}))}},n.isLayerCanvasUpdated=function(){return this._canvasUpdated},n.setLayerCanvasUpdated=function(){this._canvasUpdated=!0},n.drawLayerCanvas=function(e){var t=this.map;if(!t)return!1;if(!this.isLayerCanvasUpdated()&&!this.isViewChanged()&&!1===this._needClear)return!1;this.canvas||this.createCanvas(),t._fireEvent("renderstart",{context:this.context}),this._updateCanvasSize()||this.clearCanvas();for(var n,i=t.isInteracting(),r=t.options.layerCanvasLimitOnInteracting,a=e.length,o=[],s=0;s<a;s++)if(e[s].isVisible()&&e[s].isCanvasRender()&&e[s]._getRenderer()){var l=this._getLayerImage(e[s]);l&&l.image&&(e[s]===t.getBaseLayer()?n=[e[s],l]:o.push([e[s],l]))}var u=this.canvas.width,c=this.canvas.height;n&&(this._drawLayerCanvasImage(n[0],n[1],u,c),this._drawFog()),a=o.length;for(var h=i&&r>=0&&a>r?a-r:0;h<a;h++)this._drawLayerCanvasImage(o[h][0],o[h][1],u,c);return t._fireEvent("renderend",{context:this.context}),!0},n.setToRedraw=function(){var e=this._getAllLayerToRender();this._needClear=!0;for(var t=0,n=e.length;t<n;t++){var i=e[t].getRenderer();i&&i.canvas&&i.setToRedraw&&i.setToRedraw()}},n.updateMapSize=function(e){if(e&&!this._containerIsCanvas){var t=e.height+"px",n=this.map._panels;n.mapWrapper.style.width=e.width+"px",n.mapWrapper.style.height=t,this._updateCanvasSize()}},n.getMainPanel=function(){return this.map?this._containerIsCanvas?this.map._containerDOM:this.map._panels?this.map._panels.mapWrapper:null:null},n.toDataURL=function(e,t){return this.canvas?this.canvas.toDataURL(e,t):null},n.remove=function(){lA.webgl&&"undefined"!=typeof document&&(mN.off("dprchange",this._thisDocDPRChange,this),mN.off("docvisibilitychange",this._thisDocVisibilitychange,this),mN.off("dragstart",this._thisDocDragStart,this),mN.off("dragend",this._thisDocDragEnd,this)),this._resizeInterval&&clearInterval(this._resizeInterval),this._resizeObserver&&this._resizeObserver.disconnect(),delete this.context,delete this.canvas,delete this.map,delete this._spatialRefChanged,this._cancelFrameLoop()},n.hitDetect=function(e){var t=this.map;if(t&&t.options.hitDetect&&!t.isInteracting()){var n=t._getLayers(),i="default",r=t.options.hitDetectLimit||0,a=0;e&&e._round&&e._round();for(var o=n.length-1;o>=0;o--){var s=n[o];if(!(!s.options.hitDetect||s.isEmpty&&s.isEmpty())&&s.options.geometryEvents){var l=s._getRenderer();if(l&&l.hitDetect&&(!l.isBlank||!l.isBlank())){if("default"!==s.options.cursor&&l.hitDetect(e)){i=s.options.cursor||"pointer";break}if(a++,r>0&&a>r)break}}}t._trySetCursor(i)}},n._getLayerImage=function(e){var t=e._getRenderer();return t.getCanvasImage?t.getCanvasImage():null},n.initContainer=function(){var e=this.map._panels;function t(t,n,i,r){var a,o=rO("div",n);return i&&(o.style.cssText=i),e[t]=o,r||((a=o).onselectstart=function(){return!1},a.ondragstart=function(){return!1},a.setAttribute("unselectable","on")),o}var n=this.map._containerDOM;if(!this._containerIsCanvas){n.innerHTML="";var i="position:absolute;top:0px;left:0px;",r=t("mapWrapper","maptalks-wrapper","position:absolute;overflow:hidden;",!0),a=t("allLayers","maptalks-all-layers",i+"padding:0px;margin:0px;z-index:0;overflow:visible;",!0),o=t("backStatic","maptalks-back-static",i+"z-index:0;",!0),s=t("back","maptalks-back",i+"z-index:1;"),l=t("backLayer","maptalks-back-layer",i),u=t("canvasContainer","maptalks-canvas-layer",i+"border:none;z-index:2;"),c=t("frontStatic","maptalks-front-static",i+"z-index:3;",!0),h=t("front","maptalks-front",i+"z-index:4;",!0),d=t("frontLayer","maptalks-front-layer",i+"z-index:0;"),f=t("ui","maptalks-ui",i+"border:none;z-index:1;",!0),p=t("control","maptalks-control","z-index:1",!0);n.appendChild(r),a.appendChild(o),s.appendChild(l),s.layerDOM=l,a.appendChild(s),a.appendChild(u),h.appendChild(d),h.layerDOM=d,h.uiDOM=f,a.appendChild(c),a.appendChild(h),h.appendChild(f),r.appendChild(a),r.appendChild(p),this.createCanvas(),this.resetContainer();var m=this.map._getContainerDomSize();this.updateMapSize(m)}},n.isViewChanged=function(){if(void 0!==this._isViewChanged)return this._isViewChanged;var e=this._mapview,t=this._getMapView();return this._isViewChanged=!e||!jA(e,t),this._isViewChanged},n._recordView=function(){var e=this.map;!e._onViewChange||e.isInteracting()||e.isAnimating()||jA(e.getView(),e._getCurrentView())||e._onViewChange(e.getView())},n.isSpatialReferenceChanged=function(){return this._spatialRefChanged},n._getMapView=function(){var e=this.map,t=e._getPrjCenter();return{x:t.x,y:t.y,zoom:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),width:e.width,height:e.height}},n._frameLoop=function(e){var t=this;this.map?(this._frameTimestamp=e=e||0,this._resizeCount=0,this.renderFrame(e),this._animationFrame=gA((function(e){t._frameLoop(e)}))):this._cancelFrameLoop()},n._cancelFrameLoop=function(){this._animationFrame&&yA(this._animationFrame)},n._drawLayerCanvasImage=function(e,t,n,i){var r=this.context,a=t.point.round(),o=this.map.getDevicePixelRatio();1!==o&&a._multi(o);var s=t.image,l=s.width,u=s.height;if(!(a.x+l<=0||a.y+u<=0)){var c=e.options.opacity;if(bI(c)||(c=1),!(c<=0)){var h=t.opacity;if(bI(h)||(h=1),!(h<=0)){var d=r.globalAlpha;c<1&&(r.globalAlpha*=c),h<1&&(r.globalAlpha*=h),e.options.cssFilter&&(r.filter=e.options.cssFilter);var f=e.getRenderer(),p=f.__zoomTransformMatrix,m=f.clipCanvas(this.context);p&&(r.save(),r.setTransform.apply(r,p)),r.drawImage(s,0,0,l,u,a.x,a.y,n,i),p&&r.restore(),m&&r.restore(),"none"!==r.filter&&(r.filter="none"),r.globalAlpha=d}}}},n._drawCenterCross=function(){var e=this.map.options.centerCross;if(e){var t=this.context,n=new xA(this.canvas.width/2,this.canvas.height/2);SI(e)?e(t,n):oN.drawCross(this.context,n.x,n.y,2,"#f00")}},n._drawContainerExtent=function(){var e=this.map.options.cascadePitches,t=this.map.height-this.map._getVisualHeight(e[0]),n=this.map.height-this.map._getVisualHeight(e[1]),i=this.map.getContainerExtent(),r=this.context;r.beginPath(),r.moveTo(0,i.ymin),r.lineTo(i.xmax,i.ymin),r.stroke(),r.beginPath(),r.moveTo(0,t),r.lineTo(i.xmax,t),r.stroke(),r.beginPath(),r.moveTo(0,n),r.lineTo(i.xmax,n),r.stroke()},n._drawFog=function(){var e=this.map;if(!(e.getPitch()<=e.options.maxVisualPitch)&&e.options.fog){var t=e.getDevicePixelRatio(),n=this.context,i=e.getContainerExtent(),r=(e.height-e._getVisualHeight(75))*t;r<0&&(r=0);var a=i.ymin*t,o=Math.ceil(a-r),s=e.options.fogColor.join(),l=n.createLinearGradient(0,r,0,a+30),u=1-30/(o+30);l.addColorStop(0,"rgba("+s+", 0)"),l.addColorStop(.3,"rgba("+s+", 0.3)"),l.addColorStop(u,"rgba("+s+", 1)"),l.addColorStop(1,"rgba("+s+", 0)"),n.beginPath(),n.fillStyle=l,n.fillRect(0,r,Math.ceil(i.getWidth())*t,Math.ceil(o+30))}},n._debugSky=function(){var e=this.map;if(!e)return this;var t=e.getContainerExtent().ymin;if(t<=0)return this;var n=this.context;return n.strokeStyle="red",n.strokeRect(0,0,e.width,t),this},n._getAllLayerToRender=function(){return this.map._getLayers()},n.clearCanvas=function(){this.canvas&&oN.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},n._updateCanvasSize=function(){if(!this.canvas||this._containerIsCanvas)return!1;var e=this.map,t=e.getSize(),n=this.canvas,i=XA(t,e.getDevicePixelRatio()),r=i.width,a=i.height,o=i.cssWidth,s=i.cssHeight;return!n.style||n.style.width===o&&n.style.height===s||(n.style.width=o,n.style.height=s),(r!==n.width||a!==n.height)&&(n.height=a,n.width=r,this.topLayer.width=n.width,this.topLayer.height=n.height,!0)},n.createCanvas=function(){this.topLayer=rO("canvas"),this.topCtx=this.topLayer.getContext("2d"),this._containerIsCanvas?this.canvas=this.map._containerDOM:(this.canvas=rO("canvas"),this._updateCanvasSize(),this.map._panels.canvasContainer.appendChild(this.canvas)),this.context=this.canvas.getContext("2d")},n._updateDomPosition=function(e){return void 0===this._checkPositionTime&&(this._checkPositionTime=-1/0),Math.abs(e-this._checkPositionTime)>=500&&(fO(this.map._containerDOM),this._checkPositionTime=Math.min(e,this._checkPositionTime)),this},n._handleResizeEventList=function(e){if(!this._resizeEventList)return this;var t=this._resizeEventList.length;if(0===t)return this;if(this._resizeTime&&e-this._resizeTime<60)return this;var n=this._resizeEventList[t-1].contentRect;return this.map._containerDomContentRect=n,this._resizeEventList=[],this._checkSize(n),this._resizeCount=this._resizeCount||0,this.renderFrame((this._frameTimestamp||0)+ ++this._resizeCount/100),this._resizeTime=e,this},n._checkSize=function(){this.map&&this.map.checkSize()},n._setCheckSizeInterval=function(e){var t=this;lA.resizeObserver?(this._resizeObserver&&this._resizeObserver.disconnect(),this.map&&(this._resizeObserver=new ResizeObserver((function(e){!t.map||t.map.isRemoved()?t._resizeObserver.disconnect():e.length&&(t._resizeEventList=t._resizeEventList||[],t._resizeEventList.push(e[0]))})),this._resizeObserver.observe(this.map._containerDOM))):(clearInterval(this._resizeInterval),this._checkSizeInterval=e,this._resizeInterval=setInterval((function(){!t.map||t.map.isRemoved()?clearInterval(t._resizeInterval):t._checkSize()}),this._checkSizeInterval))},n._registerEvents=function(){var e=this,t=this.map;t.options.checkSize&&!AI&&"undefined"!=typeof window&&this._setCheckSizeInterval(t.options.checkSizeInterval),lA.mobile||t.on("_mousemove",this._onMapMouseMove,this),t.on("_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart",(function(t){e._eventParam=t})),t.on("_zooming",(function(n){t.getPitch()||(e._zoomMatrix=n.matrix.container),e._eventParam=n})),t.on("_zoomend",(function(t){e._eventParam=t,delete e._zoomMatrix})),t.on("_spatialreferencechange",(function(){e._spatialRefChanged=!0})),lA.webgl&&"undefined"!=typeof document&&(mN.on("dprchange",this._thisDocDPRChange,this),mN.on("docvisibilitychange",this._thisDocVisibilitychange,this),mN.on("dragstart",this._thisDocDragStart,this),mN.on("dragend",this._thisDocDragEnd,this))},n._onMapMouseMove=function(e){var t=this,n=this.map;!n.isInteracting()&&n.options.hitDetect&&(this._hitDetectFrame&&yA(this._hitDetectFrame),this._hitDetectFrame=gA((function(){t.hitDetect(e.containerPoint)})))},n._getCanvasLayers=function(){return this.map._getLayers((function(e){return e.isCanvasRender()}))},n.addTopElement=function(e){this._tops||(this._tops=[]),this._tops.push(e)},n.removeTopElement=function(e){if(this._tops){var t=this._tops.indexOf(e);t>=0&&this._tops.splice(t,1)}},n.getTopElements=function(){return this._tops||[]},n.drawTops=function(){this.topCtx.clearRect(0,0,this.topLayer.width,this.topLayer.height),this.map.fire("drawtopstart"),this.map.fire("drawtops");for(var e=this.getTopElements(),t=!1,n=0;n<e.length;n++)e[n].render(this.topCtx)&&(t=!0);t&&this.context.drawImage(this.topLayer,0,0),this.map.fire("drawtopsend")},t}(function(e){function t(t){var n;return(n=e.call(this)||this).map=t,n._handlerQueue=[],n._thisDocVisibilitychange=n._onDocVisibilitychange.bind(vA(vA(n))),n._thisDocDragStart=n._onDocDragStart.bind(vA(vA(n))),n._thisDocDragEnd=n._onDocDragEnd.bind(vA(vA(n))),n._thisDocDPRChange=n._onDocDPRChange.bind(vA(vA(n))),n}cA(t,e);var n=t.prototype;return n.callInNextFrame=function(e){this._handlerQueue.push(e)},n.executeFrameCallbacks=function(){var e=this._handlerQueue;this._handlerQueue=[];for(var t=0,n=e.length;t<n;t++)e[t]()},n.offsetPlatform=function(e,t){if(!this.map._panels.front)return this;if(!t&&0===e.x&&0===e.y)return this;var n=this.map._panels,i=this._frontCount=n.back.layerDOM.childElementCount,r=this._backCount=n.front.layerDOM.childElementCount,a=this._uiCount=n.front.uiDOM.childElementCount;if(i||r||a){var o=this.map.offsetPlatform();o=e?o.add(e)._round():o.round(),r&&dO(n.back,o),(i||a)&&dO(n.front,o)}return this},n.domChanged=function(){var e=this.map._panels;return!!e.front&&(void 0===this._frontCount||this._frontCount!==e.back.layerDOM.childElementCount||void 0===this._backCount||this._backCount!==e.front.layerDOM.childElementCount||void 0===this._uiCount||this._uiCount!==e.front.uiDOM.childElementCount)},n.resetContainer=function(){if(this.map&&(this.map._resetMapViewPoint(),this.map._panels.front)){var e=new xA(0,0);dO(this.map._panels.back,e),dO(this.map._panels.front,e)}},n.onZoomEnd=function(){this.resetContainer()},n.onLoad=function(){this._frameLoop()},n._onDocVisibilitychange=function(){"visible"===document.visibilityState&&this.setToRedraw()},n._getWrapPanel=function(){if(!this.map)return null;var e=this.map.getPanels();return e&&e.mapWrapper},n._onDocDragStart=function(){var e=this._getWrapPanel();e&&(e.style.overflow="visible")},n._onDocDragEnd=function(){var e=this._getWrapPanel();e&&(e.style.overflow="hidden")},n._onDocDPRChange=function(){var e=this.map;e&&e.options&&!e.options.devicePixelRatio&&e.checkSize&&e.getRenderer&&e.getRenderer()&&e.checkSize(!0)},n._containerIsOffscreen=function(){var e=this.map.getContainer();return!e||!e.style||"none"===e.style.display||Math.min(e.clientWidth,e.clientHeight)<=0},t}(pN));gL.registerRenderer("canvas",PH),gL.mergeOptions({fog:!1,fogColor:[233,233,233]});var MH={_getRenderPoints:function(){return[[this._getCenter2DPoint(this.getMap().getGLRes())],null]}};LL.include(MH),QL.include(MH),JL.include(MH),eB.include(MH),$L.include({_getRenderPoints:function(e){var t=this.getMap(),n=t.getGLRes();if("vertex"===e){for(var i=this._trimRing(this.getShell()),r=[],a=0,o=i.length;a<o;a++)r.push(t.coordToPointAtRes(i[a],n));return[r,null]}return[[t.coordToPointAtRes(this.getCenter(),n)],null]}});var IH={_getRenderPoints:function(e){var t,n=this.getMap(),i=n.getGLRes(),r=null;if("point"===e)(t=this._getPath2DPoints(this._getPrjCoordinates(),!1,i))&&t.length>0&&Array.isArray(t[0])&&(t=t[0].concat(t[1]));else if("vertex"===e)if(r=[],(t=this._getPath2DPoints(this._getPrjCoordinates(),!1,i))&&t.length>0&&Array.isArray(t[0])){for(var a=0,o=t.length;a<o;a++)for(var s=0,l=t[a].length;s<l;s++)r.push(0===s?[t[a][s],t[a][s+1]]:[t[a][s-1],t[a][s]]);t=t[0].concat(t[1])}else for(var u=0,c=t.length;u<c;u++)r.push(0===u?[t[u],t[u+1]]:[t[u-1],t[u]]);else if("line"===e){t=[],r=[];var h=this._getPath2DPoints(this._getPrjCoordinates(),!1,i);if(h.length>0&&Array.isArray(h[0]))for(var d,f=1,p=h.length;f<p;f++){d=h[f],this instanceof NL&&d.length>0&&!d[0].equals(d[d.length-1])&&d.push(d[0]);for(var m=1,v=d.length;m<v;m++)t.push(d[m].add(d[m-1])._multi(.5)),r.push([d[m-1],d[m]])}else{this instanceof NL&&h.length>0&&!h[0].equals(h[h.length-1])&&h.push(h[0]);for(var g=1,y=h.length;g<y;g++)t.push(h[g].add(h[g-1])._multi(.5)),r.push([h[g-1],h[g]])}}else if("vertex-first"===e){var _=this._getPrjCoordinates(),x=_.length,b=x?n._prjToPointAtRes(_[0],i):null;t=x?[b]:[],r=x?[[b,_[1]?n._prjToPointAtRes(_[1],i):b]]:[]}else if("vertex-last"===e){var w=this._getPrjCoordinates(),k=w.length,C=k?n._prjToPointAtRes(w[k-1],i):null;t=k?[C]:[];var S=k>1?k-2:k-1;r=k?[[w[S]?n._prjToPointAtRes(w[S],i):C,C]]:[]}else{var T=this.getCenter();if(T){var E=this._getProjection().project(T);t=[n._prjToPointAtRes(E,i)]}else t=[]}return[t,r]}};FL.include(IH),NL.include(IH);var AH={within:!1,center:[0,0]};function RH(e){if(e&&e._containerBbox){AH.within=!1;var t=e._containerBbox,n=t.minx,i=t.miny,r=t.maxx,a=t.maxy,o=Math.abs(r-n),s=Math.abs(a-i);o<=1&&s<=1&&(AH.within=!0,AH.center[0]=(n+r)/2,AH.center[1]=(i+a)/2),delete e._containerBbox}else AH.within=!1;return AH}function OH(){var e=[1/0,1/0,-1/0,-1/0];return eN(this._getPrjShell(),e),new VN(e[0],e[1],e[2],e[3])}function NH(){var e=this._getPrjShell();if(!e||!Array.isArray(e))return[];var t=this._getProjection(),n=this.getCoordinates()||{};return e.map((function(e){var i=t.unproject(e);return i.z=n.z||0,i}))}Jz.include({_redrawWhenPitch:function(){return!1},_redrawWhenRotate:function(){return!1},_getRenderBBOX:function(e,t){return e.isHitTesting?null:($O(QO),eN(t,QO),QO)}});var DH={_redrawWhenPitch:function(){return!0},_redrawWhenRotate:function(){return this instanceof QL||this instanceof eB},_computeRotatedPrjExtent:OH,getRotatedShell:NH,_paintAsPath:function(){if(this.isRotated())return!0;var e=this.getMap();return this._getAltitude()>0||e.getPitch()||this instanceof QL&&e.getBearing()},_getPaintParams:function(){var e=this.getMap();if(this._paintAsPath())return NL.prototype._getPaintParams.call(this,!0);var t=this._getPrjCoordinates(),n=e._prjToPointAtRes(t,e.getGLRes()),i=this._getRenderSize(n);return[n].concat(i)},_paintOn:function(){return this._paintAsPath()?oN.polygon.apply(oN,arguments):oN.ellipse.apply(oN,arguments)},_getRenderSize:function(e){var t=this.getMap(),n=t.getGLRes(),i=this._getPrjExtent(),r=t._prjToPointAtRes(i.getMin(),n),a=t._prjToPointAtRes(i.getMax(),n);return[Math.abs(a.x-r.x)/2,Math.abs(a.y-e.y),Math.abs(e.y-r.y)]}};QL.include(DH),JL.include(DH),$L.include({_getPaintParams:function(){var e=this.getMap(),t=this._getPrjShell();return[this._getPath2DPoints(t,!1,e.getGLRes())]},_paintOn:oN.polygon,_computeRotatedPrjExtent:OH,getRotatedShell:NH}),eB.include(DH,{_redrawWhenPitch:function(){return!0},_getPaintParams:function(){if(this._paintAsPath())return NL.prototype._getPaintParams.call(this,!0);var e=this.getMap(),t=e._prjToPointAtRes(this._getPrjCoordinates(),e.getGLRes());return[t,this._getRenderSize(t)[0],[this.getStartAngle(),this.getEndAngle()]]},_paintOn:function(){if(this._paintAsPath())return oN.polygon.apply(oN,arguments);var e=this.getMap().getBearing(),t=arguments;return e&&(t[3]=t[3].slice(0),t[3][0]+=e,t[3][1]+=e),oN.sector.apply(oN,t)}}),OL.include({_paintAsPath:function(){return!0}}),FL.include({arrowStyles:{classic:[3,4]},_getArrowShape:function(e,t,n,i,r){if(!e||!t||e.equals(t))return null;r||(r=0);var a,o=n*i[1]+r,s=n*i[0]/2+r;(a=t.sub(t.nextCtrlPoint||t.prevCtrlPoint?new xA(t.prevCtrlPoint?t.prevCtrlPoint:t.nextCtrlPoint):e))._unit();var l=t.sub(a.multi(o));a._perp();var u=l.add(a.multi(s));return a._multi(-1),[u,t,l.add(a.multi(s)),u]},_getPaintParams:function(){var e=this._getPrjCoordinates();return[this._getPath2DPoints(e,!1,this.getMap().getGLRes())]},_paintOn:function(e,t,n,i,r){var a=RH(this._painter);return a.within?oN.pixelRect(e,a.center,n,i):this.options.smoothness?oN.paintSmoothLine(e,t,n,this.options.smoothness,!1,this._animIdx,this._animTailRatio):oN.path(e,t,n,null,r),this._paintArrow(e,t,n),this._getRenderBBOX(e,t)},_getArrowPlacement:function(){return this.options.arrowPlacement},_getArrowStyle:function(){var e=this.options.arrowStyle;return e?Array.isArray(e)?e:this.arrowStyles[e]:null},_getArrows:function(e,t,n){var i=this._getArrowStyle();if(!i||e.length<2)return[];for(var r=e.length>0&&Array.isArray(e[0])?e:[e],a=this._getArrowPlacement(),o=[],s=this.getMap(),l=s.coordToContainerPoint(this.getFirstCoordinate()),u=s.coordToContainerPoint(this.getLastCoordinate()),c=r.length-1;c>=0;c--){if("vertex-first"===a||"vertex-firstlast"===a&&r[c][0].closeTo(l,.01)){var h=this._getArrowShape(r[c][1],r[c][0],t,i,n);h&&o.push(h)}if("vertex-last"===a||"vertex-firstlast"===a&&r[c][r[c].length-1].closeTo(u,.01)){var d=this._getArrowShape(r[c][r[c].length-2],r[c][r[c].length-1],t,i,n);d&&o.push(d)}else"point"===a&&this._getArrowPoints(o,r[c],t,i,n)}return o},_getArrowPoints:function(e,t,n,i,r){for(var a=0,o=t.length-1;a<o;a++){var s=this._getArrowShape(t[a],t[a+1],n,i,r);s&&e.push(s)}},_paintArrow:function(e,t,n){var i=this._getInternalSymbol().lineWidth;(!bI(i)||i<3)&&(i=3);var r=this._getArrows(t,i);if(r.length){e.setLineDash&&e.setLineDash([]);for(var a=r.length-1;a>=0;a--)e.fillStyle=e.strokeStyle,oN.polygon(e,r[a],n,n)}}}),NL.include({_getPaintParams:function(e){var t=this.getMap().getGLRes(),n=this._getPrjShell(),i=this._getPath2DPoints(n,e,t),r=i.length>0&&Array.isArray(i[0]);r&&(i=[[i[0]],[i[1]]]);var a=this._getPrjHoles(),o=[];if(a&&a.length>0){for(var s=this._simplified,l=0;l<a.length;l++){var u=this._getPath2DPoints(a[l],e,t);Array.isArray(u)&&r?Array.isArray(u[0])?(i[0].push(u[0]),i[1].push(u[1])):i[0].push(u):o.push(u)}s&&(this._simplified=s)}return r||TA(i=[i],o),[i]},_paintOn:function(e,t,n,i,r){var a=RH(this._painter);return a.within?oN.pixelRect(e,a.center,n,i):oN.polygon(e,t,n,i,r,this.options.smoothness),this._getRenderBBOX(e,t)}}),gL.VERSION="1.0.0-rc.30";var zH,LH=((zH=function(){function e(t){_classCallCheck(this,e),this.http=t,this.apiBaseUrl="https://mapmatrixnodej-803097e9a651.herokuapp.com",this.selectedtab=0,this.sharedSiteDetails=new wp([]),this.obtainedSiteDetails=this.sharedSiteDetails.asObservable(),this.SharedFacilityDtailes=new wp([]),this.obtainedFacilityDetails=this.SharedFacilityDtailes.asObservable(),this.SharedLevelDtailes=new wp([]),this.obtainedLevelDetails=this.SharedLevelDtailes.asObservable(),this.SharedSpaceeDetailes=new wp([]),this.obtainedspaceDetails=this.SharedSpaceeDetailes.asObservable(),this.SharedDeviceDetailes=new wp([]),this.obtainedDeviceDetails=this.SharedDeviceDetailes.asObservable()}return _createClass(e,[{key:"addSite",value:function(e){return this.http.post(this.apiBaseUrl+"/Sites",e)}},{key:"addFacility",value:function(e){return this.http.post(this.apiBaseUrl+"/Facilities",e)}},{key:"addLevel",value:function(e){return this.http.post(this.apiBaseUrl+"/Levels",e)}},{key:"addSpaces",value:function(e){return this.http.post(this.apiBaseUrl+"/Spaces",e)}},{key:"adddevices",value:function(e){return this.http.post(this.apiBaseUrl+"/Devices",e)}},{key:"getAllSites",value:function(){return this.http.get(this.apiBaseUrl+"/Sites")}},{key:"getAllFacilities",value:function(){return this.http.get(this.apiBaseUrl+"/Facilities")}},{key:"getAllLevels",value:function(){return this.http.get(this.apiBaseUrl+"/Levels")}},{key:"getAllSpaces",value:function(){return this.http.get(this.apiBaseUrl+"/Spaces")}},{key:"getSpacesbyId",value:function(e){return this.http.get(this.apiBaseUrl+"/Spaces/byId/"+e)}},{key:"saveAllsiteDetails",value:function(e){this.sharedSiteDetails.next(e)}},{key:"saveAllFacilityDetails",value:function(e){this.SharedFacilityDtailes.next(e)}},{key:"saveAllLevelDetails",value:function(e){this.SharedLevelDtailes.next(e)}},{key:"saveAllSpaceDetails",value:function(e){this.SharedSpaceeDetailes.next(e)}},{key:"saveAllDeviceDetails",value:function(e){this.SharedDeviceDetailes.next(e)}}]),e}()).\u0275fac=function(e){return new(e||zH)($e(xw))},zH.\u0275prov=me({token:zH,factory:zH.\u0275fac,providedIn:"root"}),zH);function BH(e,t){if(1&e){var n=zo();Ao(0,"div",1),Ao(1,"button",2),Fo("click",(function(){return en(n),qo().action()})),ms(2),Ro(),Ro()}if(2&e){var i=qo();yr(2),vs(i.data.action)}}function FH(e,t){}var jH,HH,VH,UH,qH,GH,WH,ZH=Math.pow(2,31)-1,XH=function(){function e(t,n){var i=this;_classCallCheck(this,e),this._overlayRef=n,this._afterDismissed=new I,this._afterOpened=new I,this._onAction=new I,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe((function(){return i.dismiss()})),t._onExit.subscribe((function(){return i._finishDismiss()}))}return _createClass(e,[{key:"dismiss",value:function(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}},{key:"dismissWithAction",value:function(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}},{key:"closeWithAction",value:function(){this.dismissWithAction()}},{key:"_dismissAfter",value:function(e){var t=this;this._durationTimeoutId=setTimeout((function(){return t.dismiss()}),Math.min(e,ZH))}},{key:"_open",value:function(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}},{key:"_finishDismiss",value:function(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}},{key:"afterDismissed",value:function(){return this._afterDismissed.asObservable()}},{key:"afterOpened",value:function(){return this.containerInstance._onEnter}},{key:"onAction",value:function(){return this._onAction.asObservable()}}]),e}(),KH=new qe("MatSnackBarData"),YH=_createClass((function e(){_classCallCheck(this,e),this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"})),JH=((jH=function(){function e(t,n){_classCallCheck(this,e),this.snackBarRef=t,this.data=n}return _createClass(e,[{key:"action",value:function(){this.snackBarRef.dismissWithAction()}},{key:"hasAction",get:function(){return!!this.data.action}}]),e}()).\u0275fac=function(e){return new(e||jH)(To(XH),To(KH))},jH.\u0275cmp=yt({type:jH,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(Ao(0,"span"),ms(1),Ro(),Co(2,BH,3,1,"div",0)),2&e&&(yr(1),vs(t.data.message),yr(1),Mo("ngIf",t.hasAction))},directives:[Fc,FT],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),jH),QH={snackBarState:Wh("state",[Yh("void, hidden",Kh({transform:"scale(0.8)",opacity:0})),Yh("visible",Kh({transform:"scale(1)",opacity:1})),Jh("* => visible",Zh("150ms cubic-bezier(0, 0, 0.2, 1)")),Jh("* => void, * => hidden",Zh("75ms cubic-bezier(0.4, 0.0, 1, 1)",Kh({opacity:0})))])},$H=((VH=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t))._ngZone=e,a._elementRef=n,a._changeDetectorRef=i,a.snackBarConfig=r,a._destroyed=!1,a._onExit=new I,a._onEnter=new I,a._animationState="void",a.attachDomPortal=function(e){return a._assertNotAttached(),a._applySnackBarClasses(),a._portalOutlet.attachDomPortal(e)},a._role="assertive"!==r.politeness||r.announcementMessage?"off"===r.politeness?null:"status":"alert",a}return _inherits(t,e),_createClass(t,[{key:"attachComponentPortal",value:function(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(e)}},{key:"attachTemplatePortal",value:function(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(e)}},{key:"onAnimationEnd",value:function(e){var t=e.fromState,n=e.toState;if(("void"===n&&"void"!==t||"hidden"===n)&&this._completeExit(),"visible"===n){var i=this._onEnter;this._ngZone.run((function(){i.next(),i.complete()}))}}},{key:"enter",value:function(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}},{key:"exit",value:function(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),this._onExit}},{key:"ngOnDestroy",value:function(){this._destroyed=!0,this._completeExit()}},{key:"_completeExit",value:function(){var e=this;this._ngZone.onMicrotaskEmpty.asObservable().pipe(Yp(1)).subscribe((function(){e._onExit.next(),e._onExit.complete()}))}},{key:"_applySnackBarClasses",value:function(){var e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach((function(t){return e.classList.add(t)})):e.classList.add(t)),"center"===this.snackBarConfig.horizontalPosition&&e.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&e.classList.add("mat-snack-bar-top")}},{key:"_assertNotAttached",value:function(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}]),t}(vS)).\u0275fac=function(e){return new(e||VH)(To(Su),To(Vs),To(Ga),To(YH))},VH.\u0275cmp=yt({type:VH,selectors:[["snack-bar-container"]],viewQuery:function(e,t){var n;1&e&&Zl(_S,!0),2&e&&Wl(n=$l())&&(t._portalOutlet=n.first)},hostAttrs:[1,"mat-snack-bar-container"],hostVars:2,hostBindings:function(e,t){1&e&&jo("@state.done",(function(e){return t.onAnimationEnd(e)})),2&e&&(wo("role",t._role),_s("@state",t._animationState))},features:[bs],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,t){1&e&&Co(0,FH,0,0,"ng-template",0)},directives:[_S],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[QH.snackBarState]}}),VH),eV=((HH=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:HH}),HH.\u0275inj=ve({factory:function(e){return new(e||HH)},imports:[[hT,wS,sh,jT,mx],mx]}),HH),tV=new qe("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new YH}}),nV=((UH=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this._overlay=t,this._live=n,this._injector=i,this._breakpointObserver=r,this._parentSnackBar=a,this._defaultConfig=o,this._snackBarRefAtThisLevel=null}return _createClass(e,[{key:"_openedSnackBarRef",get:function(){var e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel},set:function(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}},{key:"openFromComponent",value:function(e,t){return this._attach(e,t)}},{key:"openFromTemplate",value:function(e,t){return this._attach(e,t)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=Object.assign(Object.assign({},this._defaultConfig),n);return i.data={message:e,action:t},i.announcementMessage||(i.announcementMessage=e),this.openFromComponent(JH,i)}},{key:"dismiss",value:function(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}},{key:"ngOnDestroy",value:function(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}},{key:"_attachSnackBarContainer",value:function(e,t){var n=new kS(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[YH,t]])),i=new fS($H,t.viewContainerRef,n),r=e.attach(i);return r.instance.snackBarConfig=t,r.instance}},{key:"_attach",value:function(e,t){var n=Object.assign(Object.assign(Object.assign({},new YH),this._defaultConfig),t),i=this._createOverlay(n),r=this._attachSnackBarContainer(i,n),a=new XH(r,i);if(e instanceof dl){var o=new pS(e,null,{$implicit:n.data,snackBarRef:a});a.instance=r.attachTemplatePortal(o)}else{var s=this._createInjector(n,a),l=new fS(e,void 0,s),u=r.attachComponentPortal(l);a.instance=u.instance}return this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait)").pipe(Ky(i.detachments())).subscribe((function(e){var t=i.overlayElement.classList;e.matches?t.add("mat-snack-bar-handset"):t.remove("mat-snack-bar-handset")})),this._animateSnackBar(a,n),this._openedSnackBarRef=a,this._openedSnackBarRef}},{key:"_animateSnackBar",value:function(e,t){var n=this;e.afterDismissed().subscribe((function(){n._openedSnackBarRef==e&&(n._openedSnackBarRef=null),t.announcementMessage&&n._live.clear()})),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe((function(){e.containerInstance.enter()})),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe((function(){return e._dismissAfter(t.duration)})),t.announcementMessage&&this._live.announce(t.announcementMessage,t.politeness)}},{key:"_createOverlay",value:function(e){var t=new OS;t.direction=e.direction;var n=this._overlay.position().global(),i="rtl"===e.direction,r="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!i||"end"===e.horizontalPosition&&i,a=!r&&"center"!==e.horizontalPosition;return r?n.left("0"):a?n.right("0"):n.centerHorizontally(),"top"===e.verticalPosition?n.top("0"):n.bottom("0"),t.positionStrategy=n,this._overlay.create(t)}},{key:"_createInjector",value:function(e,t){return new kS(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[XH,t],[KH,e.data]]))}}]),e}()).\u0275fac=function(e){return new(e||UH)($e(aT),$e(X_),$e(so),$e(yT),$e(UH,12),$e(tV))},UH.\u0275prov=me({factory:function(){return new UH($e(aT),$e(X_),$e(Ge),$e(yT),$e(UH,12),$e(tV))},token:UH,providedIn:eV}),UH);function iV(e){return this instanceof iV?(this.v=e,this):new iV(e)}function rV(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){a.push([e,t,n,i])>1||s(e,t)}))})}function s(e,t){try{(n=r[e](t)).value instanceof iV?Promise.resolve(n.value.v).then(l,u):c(a[0][2],n)}catch(q5){c(a[0][3],q5)}var n}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function aV(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:iV(e[i](t)),done:!1}:r?r(t):t}:r}}function oV(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}}"function"==typeof SuppressedError&&SuppressedError,"undefined"!=typeof window&&window,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(qH=self.constructor)||void 0===qH?void 0:qH.name)||"ServiceWorkerGlobalScope"===(null===(GH=self.constructor)||void 0===GH?void 0:GH.name)||self);var sV,lV="undefined"!=typeof Deno&&void 0!==Deno.version&&void 0!==Deno.version.deno,uV="undefined"!=typeof process&&Boolean(process.version)&&Boolean(null===(WH=process.versions)||void 0===WH?void 0:WH.node)&&!lV;function cV(e){return e&&"function"==typeof e.getToken&&(void 0===e.signRequest||e.getToken.length>0)}"undefined"!=typeof Bun&&Bun,"undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator),function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(sV||(sV={}));var hV=function(){function e(t,n){_classCallCheck(this,e),this._nextPolicy=t,this._options=n}return _createClass(e,[{key:"shouldLog",value:function(e){return this._options.shouldLog(e)}},{key:"log",value:function(e,t){this._options.log(e,t)}}]),e}(),dV=function(){function e(t){_classCallCheck(this,e),this._logger=t}return _createClass(e,[{key:"shouldLog",value:function(e){return!!this._logger&&e!==sV.OFF&&e<=this._logger.minimumLogLevel}},{key:"log",value:function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)}}]),e}();function fV(e){return{create:function(e,t){throw new Error("ProxyPolicy is not supported in browser environment")}}}var pV="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},mV=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,vV=function(e){var t=new Set(["1.7.0"]),n=new Set,i="1.7.0".match(mV);if(!i)return function(){return!1};var r=+i[1],a=+i[2],o=+i[3];if(null!=i[4])return function(e){return"1.7.0"===e};function s(e){return n.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var i=e.match(mV);if(!i)return s(e);var u=+i[2],c=+i[3];return null!=i[4]||r!==+i[1]?s(e):0===r?a===u&&o<=c?l(e):s(e):a<=u?l(e):s(e)}}(),gV="1.7.0".split(".")[0],yV=Symbol.for("opentelemetry.js.api."+gV),_V=pV;function xV(e,t,n,i){var r;void 0===i&&(i=!1);var a=_V[yV]=null!==(r=_V[yV])&&void 0!==r?r:{version:"1.7.0"};if(!i&&a[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(o.stack||o.message),!1}return"1.7.0"!==a.version?(o=new Error("@opentelemetry/api: Registration of version v"+a.version+" for "+e+" does not match previously registered API v1.7.0"),n.error(o.stack||o.message),!1):(a[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v1.7.0."),!0)}function bV(e){var t,n,i=null===(t=_V[yV])||void 0===t?void 0:t.version;if(i&&vV(i))return null===(n=_V[yV])||void 0===n?void 0:n[e]}function wV(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v1.7.0.");var n=_V[yV];n&&delete n[e]}var kV,CV=new function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,i){var r=new e(n._currentContext);return r._currentContext.set(t,i),r},n.deleteValue=function(t){var i=new e(n._currentContext);return i._currentContext.delete(t),i}},SV=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},TV=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},EV=function(){function e(){}return e.prototype.active=function(){return CV},e.prototype.with=function(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];return t.call.apply(t,TV([n],SV(i),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),PV=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MV("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MV("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MV("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MV("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return MV("verbose",this._namespace,e)},e}();function MV(e,t,n){var i=bV("diag");if(i)return n.unshift(t),i[e].apply(i,function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}(n),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(kV||(kV={}));var IV,AV=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},RV=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},OV=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=bV("diag");if(i)return i[e].apply(i,RV([],AV(t),!1))}}var t=this;t.setLogger=function(e,n){var i,r,a;if(void 0===n&&(n={logLevel:kV.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(i=o.stack)&&void 0!==i?i:o.message),!1}"number"==typeof n&&(n={logLevel:n});var s=bV("diag"),l=function(e,t){function n(n,i){var r=t[n];return"function"==typeof r&&e>=i?r.bind(t):function(){}}return e<kV.NONE?e=kV.NONE:e>kV.ALL&&(e=kV.ALL),t=t||{},{error:n("error",kV.ERROR),warn:n("warn",kV.WARN),info:n("info",kV.INFO),debug:n("debug",kV.DEBUG),verbose:n("verbose",kV.VERBOSE)}}(null!==(r=n.logLevel)&&void 0!==r?r:kV.INFO,e);if(s&&!n.suppressOverrideMessage){var u=null!==(a=(new Error).stack)&&void 0!==a?a:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+u),l.warn("Current logger will overwrite one already registered from "+u)}return xV("diag",l,t,!0)},t.disable=function(){wV("diag",t)},t.createComponentLogger=function(e){return new PV(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),NV=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},DV=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},zV=new EV,LV=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return xV("context",e,OV.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var i,r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return(i=this._getContextManager()).with.apply(i,DV([e,t,n],NV(r),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return bV("context")||zV},e.prototype.disable=function(){this._getContextManager().disable(),wV("context",OV.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(IV||(IV={}));var BV={traceId:"00000000000000000000000000000000",spanId:"0000000000000000",traceFlags:IV.NONE},FV=function(){function e(e){void 0===e&&(e=BV),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),jV=Symbol.for("OpenTelemetry Context Key SPAN");function HV(e){return e.getValue(jV)||void 0}function VV(){return HV(LV.getInstance().active())}function UV(e,t){return e.setValue(jV,t)}function qV(e){return e.deleteValue(jV)}function GV(e,t){return UV(e,new FV(t))}function WV(e){var t;return null===(t=HV(e))||void 0===t?void 0:t.spanContext()}var ZV=/^([0-9a-f]{32})$/i,XV=/^[0-9a-f]{16}$/i;function KV(e){return ZV.test(n=e.traceId)&&"00000000000000000000000000000000"!==n&&XV.test(t=e.spanId)&&"0000000000000000"!==t;var t,n}function YV(e){return new FV(e)}var JV,QV=LV.getInstance(),$V=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=QV.active()),Boolean(null==t?void 0:t.root))return new FV;var i,r=n&&WV(n);return"object"==typeof(i=r)&&"string"==typeof i.spanId&&"string"==typeof i.traceId&&"number"==typeof i.traceFlags&&KV(r)?new FV(r):new FV},e.prototype.startActiveSpan=function(e,t,n,i){var r,a,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(r=t,o=n):(r=t,a=n,o=i);var s=null!=a?a:QV.active(),l=this.startSpan(e,r,s),u=UV(s,l);return QV.with(u,o,void 0,l)}},e}(),eU=new $V,tU=function(){function e(e,t,n,i){this._provider=e,this.name=t,this.version=n,this.options=i}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,i){var r=this._getTracer();return Reflect.apply(r.startActiveSpan,r,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):eU},e}(),nU=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new $V},e}()),iU=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var i;return null!==(i=this.getDelegateTracer(e,t,n))&&void 0!==i?i:new tU(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:nU},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var i;return null===(i=this._delegate)||void 0===i?void 0:i.getTracer(e,t,n)},e}(),rU=function(){function e(){this._proxyTracerProvider=new iU,this.wrapSpanContext=YV,this.isSpanContextValid=KV,this.deleteSpan=qV,this.getSpan=HV,this.getActiveSpan=VV,this.getSpanContext=WV,this.setSpan=UV,this.setSpanContext=GV}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=xV("trace",this._proxyTracerProvider,OV.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return bV("trace")||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){wV("trace",OV.instance()),this._proxyTracerProvider=new iU},e}().getInstance(),aU=LV.getInstance();function oU(e,t){return rU.setSpan(e,t)}!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(JV||(JV={}));var sU,lU=aU;function uU(e){var t=e.requestOptions,n=e.tracingOptions,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["requestOptions","tracingOptions"]);return t&&(i=Object.assign(Object.assign({},i),t)),n&&(i.tracingContext=n.tracingContext,i.spanOptions=null==n?void 0:n.spanOptions),i}function cU(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function hU(e){for(var t=atob(e),n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(sU||(sU={})),"function"==typeof SuppressedError&&SuppressedError;var dU,fU="$",pU=new Uint8Array(16);function mU(){if(!dU&&!(dU="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return dU(pU)}for(var vU=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,gU=function(e){return"string"==typeof e&&vU.test(e)},yU=[],_U=0;_U<256;++_U)yU.push((_U+256).toString(16).substr(1));var xU=function(e,t,n){var i=(e=e||{}).random||(e.rng||mU)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(yU[e[t+0]]+yU[e[t+1]]+yU[e[t+2]]+yU[e[t+3]]+"-"+yU[e[t+4]]+yU[e[t+5]]+"-"+yU[e[t+6]]+yU[e[t+7]]+"-"+yU[e[t+8]]+yU[e[t+9]]+"-"+yU[e[t+10]]+yU[e[t+11]]+yU[e[t+12]]+yU[e[t+13]]+yU[e[t+14]]+yU[e[t+15]]).toLowerCase();if(!gU(n))throw TypeError("Stringified UUID is invalid");return n}(i)},bU=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function wU(){return xU()}var kU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function CU(e,t,n){return e&&t?e.split(t).join(n||""):e}var SU=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,e),this.modelMappers=t,this.isXML=n}return _createClass(e,[{key:"validateConstraints",value:function(e,t,n){var i=function(e,i){throw new Error('"'.concat(n,'" with value "').concat(t,'" should satisfy the constraint "').concat(e,'": ').concat(i,"."))};if(e.constraints&&null!=t){var r=t,a=e.constraints,o=a.ExclusiveMaximum,s=a.ExclusiveMinimum,l=a.InclusiveMaximum,u=a.InclusiveMinimum,c=a.MaxItems,h=a.MaxLength,d=a.MinItems,f=a.MinLength,p=a.MultipleOf,m=a.Pattern,v=a.UniqueItems;null!=o&&r>=o&&i("ExclusiveMaximum",o),null!=s&&r<=s&&i("ExclusiveMinimum",s),null!=l&&r>l&&i("InclusiveMaximum",l),null!=u&&r<u&&i("InclusiveMinimum",u);var g=t;if(null!=c&&g.length>c&&i("MaxItems",c),null!=h&&g.length>h&&i("MaxLength",h),null!=d&&g.length<d&&i("MinItems",d),null!=f&&g.length<f&&i("MinLength",f),null!=p&&r%p!=0&&i("MultipleOf",p),m){var y="string"==typeof m?new RegExp(m):m;"string"==typeof t&&null!==t.match(y)||i("Pattern",m)}v&&g.some((function(e,t,n){return n.indexOf(e)!==t}))&&i("UniqueItems",v)}}},{key:"serialize",value:function(e,t,n){var i,r,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s={rootName:null!==(i=o.rootName)&&void 0!==i?i:"",includeRoot:null!==(r=o.includeRoot)&&void 0!==r&&r,xmlCharKey:null!==(a=o.xmlCharKey)&&void 0!==a?a:"_"},l={},u=e.type.name;n||(n=e.serializedName),null!==u.match(/^Sequence$/i)&&(l=[]),e.isConstant&&(t=e.defaultValue);var c=e.required,h=e.nullable;if(c&&h&&void 0===t)throw new Error(n+" cannot be undefined.");if(c&&!h&&null==t)throw new Error(n+" cannot be null or undefined.");if(!c&&!1===h&&null===t)throw new Error(n+" cannot be null.");return null==t||null!==u.match(/^any$/i)?l=t:null!==u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?l=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error("".concat(t," with value ").concat(n," must be of type number."))}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error("".concat(t,' with value "').concat(n,'" must be of type string.'))}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||!bU.test(n))throw new Error("".concat(t,' with value "').concat(n,'" must be of type string and a valid uuid.'))}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error("".concat(t," with value ").concat(n," must be of type boolean."))}else if(null!==e.match(/^Stream$/i)){var i=typeof n;if(!("string"===i||"function"===i||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return n}(u,n,t):null!==u.match(/^Enum$/i)?l=function(e,t,n){if(!t)throw new Error("Please provide a set of allowedValues to validate ".concat(e," as an Enum Type."));if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n})))throw new Error("".concat(n," is not a valid value for ").concat(e,". The valid values are: ").concat(JSON.stringify(t),"."));return n}(n,e.type.allowedValues,t):null!==u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?l=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return kU.test(e)}(t))throw new Error("".concat(n,' must be a string in ISO 8601 format. Instead was "').concat(t,'".'));return t}(u,t,n):null!==u.match(/^ByteArray$/i)?l=function(e,t){var n="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");n=cU(t)}return n}(n,t):null!==u.match(/^Base64Url$/i)?l=function(e,t){var n="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");n=function(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){for(var n=e.length;n-1>=0&&"="===e[n-1];)--n;return e.substr(0,n)}(cU(e)).replace(/\+/g,"-").replace(/\//g,"_")}}(t)||""}return n}(n,t):null!==u.match(/^Sequence$/i)?l=function(e,t,n,i,r,a){if(!Array.isArray(n))throw new Error(i+" must be of type Array.");var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '.concat(i,"."));for(var s=[],l=0;l<n.length;l++){var u=e.serialize(o,n[l],i,a);if(r&&o.xmlNamespace){var c=o.xmlNamespacePrefix?"xmlns:"+o.xmlNamespacePrefix:"xmlns";"Composite"===o.type.name?(s[l]=Object.assign({},u),s[l][fU]=_defineProperty({},c,o.xmlNamespace)):(s[l]={},s[l][a.xmlCharKey]=u,s[l][fU]=_defineProperty({},c,o.xmlNamespace))}else s[l]=u}return s}(this,e,t,n,Boolean(this.isXML),s):null!==u.match(/^Dictionary$/i)?l=function(e,t,n,i,r,a){if("object"!=typeof n)throw new Error(i+" must be of type object.");var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '.concat(i,"."));for(var s={},l=0,u=Object.keys(n);l<u.length;l++){var c=u[l],h=e.serialize(o,n[c],i,a);s[c]=MU(o,h,r,a)}if(r&&t.xmlNamespace){var d=s;return d[fU]=_defineProperty({},t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns",t.xmlNamespace),d}return s}(this,e,t,n,Boolean(this.isXML),s):null!==u.match(/^Composite$/i)&&(l=function(e,t,n,i,r,a){if(RU(e,t)&&(t=AU(e,t,n,"clientName")),null!=n){for(var o={},s=PU(e,t,i),l=0,u=Object.keys(s);l<u.length;l++){var c=u[l],h=s[c];if(!h.readOnly){var d=void 0,f=o;if(e.isXML)d=h.xmlIsWrapped?h.xmlName:h.xmlElementName||h.xmlName;else{var p=TU(h.serializedName);d=p.pop();var m,v=_createForOfIteratorHelper(p);try{for(v.s();!(m=v.n()).done;){var g=m.value;null!=f[g]||null==n[c]&&void 0===h.defaultValue||(f[g]={}),f=f[g]}}catch(U5){v.e(U5)}finally{v.f()}}if(null!=f){if(r&&t.xmlNamespace){var y=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns";f[fU]=Object.assign(Object.assign({},f[fU]),_defineProperty({},y,t.xmlNamespace))}var _=""!==h.serializedName?i+"."+h.serializedName:i,x=n[c],b=RU(e,t);b&&b.clientName===c&&null==x&&(x=t.serializedName);var w=e.serialize(h,x,_,a);if(void 0!==w&&null!=d){var k=MU(h,w,r,a);r&&h.xmlIsAttribute?(f[fU]=f[fU]||{},f[fU][d]=w):f[d]=r&&h.xmlIsWrapped?_defineProperty({},h.xmlElementName,k):k}}}}var C=function(e,t,n){var i=t.type.additionalProperties;if(!i&&t.type.className){var r=EU(e,t,n);return null==r?void 0:r.type.additionalProperties}return i}(e,t,i);if(C){var S=Object.keys(s),T=function(t){S.every((function(e){return e!==t}))&&(o[t]=e.serialize(C,n[t],i+'["'+t+'"]',a))};for(var E in n)T(E)}return o}return n}(this,e,t,n,Boolean(this.isXML),s)),l}},{key:"deserialize",value:function(e,t,n){var i,r,a,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l={rootName:null!==(i=s.rootName)&&void 0!==i?i:"",includeRoot:null!==(r=s.includeRoot)&&void 0!==r&&r,xmlCharKey:null!==(a=s.xmlCharKey)&&void 0!==a?a:"_"};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var u=e.type.name;if(n||(n=e.serializedName),null!==u.match(/^Composite$/i))o=function(e,t,n,i,r){var a,o,s=null!==(a=r.xmlCharKey)&&void 0!==a?a:"_";RU(e,t)&&(t=AU(e,t,n,"serializedName"));for(var l=PU(e,t,i),u={},c=[],h=0,d=Object.keys(l);h<d.length;h++){var f=d[h],p=l[f],m=TU(l[f].serializedName);c.push(m[0]);var v=p.serializedName,g=p.xmlName,y=p.xmlElementName,_=i;""!==v&&void 0!==v&&(_=i+"."+v);var x=p.headerCollectionPrefix;if(x){for(var b={},w=0,k=Object.keys(n);w<k.length;w++){var C=k[w];C.startsWith(x)&&(b[C.substring(x.length)]=e.deserialize(p.type.value,n[C],_,r)),c.push(C)}u[f]=b}else if(e.isXML)if(p.xmlIsAttribute&&n[fU])u[f]=e.deserialize(p,n[fU][g],_,r);else if(p.xmlIsMsText)void 0!==n[s]?u[f]=n[s]:"string"==typeof n&&(u[f]=n);else{var S=y||g||v;if(p.xmlIsWrapped){var T=n[g],E=null!==(o=null==T?void 0:T[y])&&void 0!==o?o:[];u[f]=e.deserialize(p,E,_,r),c.push(g)}else u[f]=e.deserialize(p,n[S],_,r),c.push(S)}else{var P,M=void 0,I=n,A=_createForOfIteratorHelper(m);try{for(A.s();!(P=A.n()).done;){var R=P.value;if(!I)break;I=I[R]}}catch(U5){A.e(U5)}finally{A.f()}M=I;var O=t.type.polymorphicDiscriminator,N=void 0;if(O&&f===O.clientName&&null==M&&(M=t.serializedName),Array.isArray(n[f])&&""===l[f].serializedName){M=n[f];for(var D=e.deserialize(p,M,_,r),z=0,L=Object.entries(u);z<L.length;z++){var B=_slicedToArray(L[z],2),F=B[0],j=B[1];Object.prototype.hasOwnProperty.call(D,F)||(D[F]=j)}u=D}else void 0===M&&void 0===p.defaultValue||(N=e.deserialize(p,M,_,r),u[f]=N)}}var H=t.type.additionalProperties;if(H){var V=function(e){for(var t in l)if(TU(l[t].serializedName)[0]===e)return!1;return!0};for(var U in n)V(U)&&(u[U]=e.deserialize(H,n[U],i+'["'+U+'"]',r))}else if(n)for(var q=0,G=Object.keys(n);q<G.length;q++){var W=G[q];void 0!==u[W]||c.includes(W)||IU(W,r)||(u[W]=n[W])}return u}(this,e,t,n,l);else{if(this.isXML){var c=l.xmlCharKey,h=t;null!=h[fU]&&null!=h[c]&&(t=h[c])}null!==u.match(/^Number$/i)?(o=parseFloat(t),isNaN(o)&&(o=t)):null!==u.match(/^Boolean$/i)?o="true"===t||"false"!==t&&t:null!==u.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?o=t:null!==u.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?o=new Date(t):null!==u.match(/^UnixTime$/i)?o=function(e){if(e)return new Date(1e3*e)}(t):null!==u.match(/^ByteArray$/i)?o=hU(t):null!==u.match(/^Base64Url$/i)?o=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return hU(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==u.match(/^Sequence$/i)?o=function(e,t,n,i,r){var a=t.type.element;if(!a||"object"!=typeof a)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+i);if(n){Array.isArray(n)||(n=[n]);for(var o=[],s=0;s<n.length;s++)o[s]=e.deserialize(a,n[s],"".concat(i,"[").concat(s,"]"),r);return o}return n}(this,e,t,n,l):null!==u.match(/^Dictionary$/i)&&(o=function(e,t,n,i,r){var a=t.type.value;if(!a||"object"!=typeof a)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+i);if(n){for(var o={},s=0,l=Object.keys(n);s<l.length;s++){var u=l[s];o[u]=e.deserialize(a,n[u],i,r)}return o}return n}(this,e,t,n,l))}return e.isConstant&&(o=e.defaultValue),o}}]),e}();function TU(e){var t=[],n="";if(e){var i,r=_createForOfIteratorHelper(e.split("."));try{for(r.s();!(i=r.n()).done;){var a=i.value;"\\"===a.charAt(a.length-1)?n+=a.substr(0,a.length-1)+".":(n+=a,t.push(n),n="")}}catch(U5){r.e(U5)}finally{r.f()}}return t}function EU(e,t,n){var i=t.type.className;if(!i)throw new Error('Class name for model "'.concat(n,'" is not provided in the mapper "').concat(JSON.stringify(t,void 0,2),'".'));return e.modelMappers[i]}function PU(e,t,n){var i=t.type.modelProperties;if(!i){var r=EU(e,t,n);if(!r)throw new Error('mapper() cannot be null or undefined for model "'.concat(t.type.className,'".'));if(!(i=null==r?void 0:r.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'.concat(JSON.stringify(r),'" of type "').concat(t.type.className,'" for object "').concat(n,'".'))}return i}function MU(e,t,n,i){if(!n||!e.xmlNamespace)return t;var r=_defineProperty({},e.xmlNamespacePrefix?"xmlns:"+e.xmlNamespacePrefix:"xmlns",e.xmlNamespace);if(["Composite"].includes(e.type.name)){if(t[fU])return t;var a=Object.assign({},t);return a[fU]=r,a}var o={};return o[i.xmlCharKey]=t,o[fU]=r,o}function IU(e,t){return[fU,t.xmlCharKey].includes(e)}function AU(e,t,n,i){var r=RU(e,t);if(r){var a=r[i];if(null!=a){var o=n[a];if(null!=o){var s=t.type.uberParent||t.type.className,l=e.modelMappers.discriminators[o===s?o:s+"."+o];l&&(t=l)}}}return t}function RU(e,t){return t.type.polymorphicDiscriminator||OU(e,t.type.uberParent)||OU(e,t.type.className)}function OU(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var NU,DU=function(e){for(var t={},n=0,i=["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"];n<i.length;n++){var r=i[n];t[r]=r}return t}(),zU={serializedName:"BlobServiceProperties",xmlName:"StorageServiceProperties",type:{name:"Composite",className:"BlobServiceProperties",modelProperties:{blobAnalyticsLogging:{serializedName:"Logging",xmlName:"Logging",type:{name:"Composite",className:"Logging"}},hourMetrics:{serializedName:"HourMetrics",xmlName:"HourMetrics",type:{name:"Composite",className:"Metrics"}},minuteMetrics:{serializedName:"MinuteMetrics",xmlName:"MinuteMetrics",type:{name:"Composite",className:"Metrics"}},cors:{serializedName:"Cors",xmlName:"Cors",xmlIsWrapped:!0,xmlElementName:"CorsRule",type:{name:"Sequence",element:{type:{name:"Composite",className:"CorsRule"}}}},defaultServiceVersion:{serializedName:"DefaultServiceVersion",xmlName:"DefaultServiceVersion",type:{name:"String"}},deleteRetentionPolicy:{serializedName:"DeleteRetentionPolicy",xmlName:"DeleteRetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}},staticWebsite:{serializedName:"StaticWebsite",xmlName:"StaticWebsite",type:{name:"Composite",className:"StaticWebsite"}}}}},LU={serializedName:"Logging",type:{name:"Composite",className:"Logging",modelProperties:{version:{serializedName:"Version",required:!0,xmlName:"Version",type:{name:"String"}},deleteProperty:{serializedName:"Delete",required:!0,xmlName:"Delete",type:{name:"Boolean"}},read:{serializedName:"Read",required:!0,xmlName:"Read",type:{name:"Boolean"}},write:{serializedName:"Write",required:!0,xmlName:"Write",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},BU={serializedName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy",modelProperties:{enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},days:{constraints:{InclusiveMinimum:1},serializedName:"Days",xmlName:"Days",type:{name:"Number"}}}}},FU={serializedName:"Metrics",type:{name:"Composite",className:"Metrics",modelProperties:{version:{serializedName:"Version",xmlName:"Version",type:{name:"String"}},enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},includeAPIs:{serializedName:"IncludeAPIs",xmlName:"IncludeAPIs",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},jU={serializedName:"CorsRule",type:{name:"Composite",className:"CorsRule",modelProperties:{allowedOrigins:{serializedName:"AllowedOrigins",required:!0,xmlName:"AllowedOrigins",type:{name:"String"}},allowedMethods:{serializedName:"AllowedMethods",required:!0,xmlName:"AllowedMethods",type:{name:"String"}},allowedHeaders:{serializedName:"AllowedHeaders",required:!0,xmlName:"AllowedHeaders",type:{name:"String"}},exposedHeaders:{serializedName:"ExposedHeaders",required:!0,xmlName:"ExposedHeaders",type:{name:"String"}},maxAgeInSeconds:{constraints:{InclusiveMinimum:0},serializedName:"MaxAgeInSeconds",required:!0,xmlName:"MaxAgeInSeconds",type:{name:"Number"}}}}},HU={serializedName:"StaticWebsite",type:{name:"Composite",className:"StaticWebsite",modelProperties:{enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},indexDocument:{serializedName:"IndexDocument",xmlName:"IndexDocument",type:{name:"String"}},errorDocument404Path:{serializedName:"ErrorDocument404Path",xmlName:"ErrorDocument404Path",type:{name:"String"}},defaultIndexDocumentPath:{serializedName:"DefaultIndexDocumentPath",xmlName:"DefaultIndexDocumentPath",type:{name:"String"}}}}},VU={serializedName:"StorageError",type:{name:"Composite",className:"StorageError",modelProperties:{message:{serializedName:"Message",xmlName:"Message",type:{name:"String"}},code:{serializedName:"Code",xmlName:"Code",type:{name:"String"}}}}},UU={serializedName:"BlobServiceStatistics",xmlName:"StorageServiceStats",type:{name:"Composite",className:"BlobServiceStatistics",modelProperties:{geoReplication:{serializedName:"GeoReplication",xmlName:"GeoReplication",type:{name:"Composite",className:"GeoReplication"}}}}},qU={serializedName:"GeoReplication",type:{name:"Composite",className:"GeoReplication",modelProperties:{status:{serializedName:"Status",required:!0,xmlName:"Status",type:{name:"Enum",allowedValues:["live","bootstrap","unavailable"]}},lastSyncOn:{serializedName:"LastSyncTime",required:!0,xmlName:"LastSyncTime",type:{name:"DateTimeRfc1123"}}}}},GU={serializedName:"ListContainersSegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListContainersSegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},containerItems:{serializedName:"ContainerItems",required:!0,xmlName:"Containers",xmlIsWrapped:!0,xmlElementName:"Container",type:{name:"Sequence",element:{type:{name:"Composite",className:"ContainerItem"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},WU={serializedName:"ContainerItem",xmlName:"Container",type:{name:"Composite",className:"ContainerItem",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},deleted:{serializedName:"Deleted",xmlName:"Deleted",type:{name:"Boolean"}},version:{serializedName:"Version",xmlName:"Version",type:{name:"String"}},properties:{serializedName:"Properties",xmlName:"Properties",type:{name:"Composite",className:"ContainerProperties"}},metadata:{serializedName:"Metadata",xmlName:"Metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},ZU={serializedName:"ContainerProperties",type:{name:"Composite",className:"ContainerProperties",modelProperties:{lastModified:{serializedName:"Last-Modified",required:!0,xmlName:"Last-Modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"Etag",required:!0,xmlName:"Etag",type:{name:"String"}},leaseStatus:{serializedName:"LeaseStatus",xmlName:"LeaseStatus",type:{name:"Enum",allowedValues:["locked","unlocked"]}},leaseState:{serializedName:"LeaseState",xmlName:"LeaseState",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseDuration:{serializedName:"LeaseDuration",xmlName:"LeaseDuration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},publicAccess:{serializedName:"PublicAccess",xmlName:"PublicAccess",type:{name:"Enum",allowedValues:["container","blob"]}},hasImmutabilityPolicy:{serializedName:"HasImmutabilityPolicy",xmlName:"HasImmutabilityPolicy",type:{name:"Boolean"}},hasLegalHold:{serializedName:"HasLegalHold",xmlName:"HasLegalHold",type:{name:"Boolean"}},defaultEncryptionScope:{serializedName:"DefaultEncryptionScope",xmlName:"DefaultEncryptionScope",type:{name:"String"}},preventEncryptionScopeOverride:{serializedName:"DenyEncryptionScopeOverride",xmlName:"DenyEncryptionScopeOverride",type:{name:"Boolean"}},deletedOn:{serializedName:"DeletedTime",xmlName:"DeletedTime",type:{name:"DateTimeRfc1123"}},remainingRetentionDays:{serializedName:"RemainingRetentionDays",xmlName:"RemainingRetentionDays",type:{name:"Number"}},isImmutableStorageWithVersioningEnabled:{serializedName:"ImmutableStorageWithVersioningEnabled",xmlName:"ImmutableStorageWithVersioningEnabled",type:{name:"Boolean"}}}}},XU={serializedName:"KeyInfo",type:{name:"Composite",className:"KeyInfo",modelProperties:{startsOn:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"String"}},expiresOn:{serializedName:"Expiry",required:!0,xmlName:"Expiry",type:{name:"String"}}}}},KU={serializedName:"UserDelegationKey",type:{name:"Composite",className:"UserDelegationKey",modelProperties:{signedObjectId:{serializedName:"SignedOid",required:!0,xmlName:"SignedOid",type:{name:"String"}},signedTenantId:{serializedName:"SignedTid",required:!0,xmlName:"SignedTid",type:{name:"String"}},signedStartsOn:{serializedName:"SignedStart",required:!0,xmlName:"SignedStart",type:{name:"String"}},signedExpiresOn:{serializedName:"SignedExpiry",required:!0,xmlName:"SignedExpiry",type:{name:"String"}},signedService:{serializedName:"SignedService",required:!0,xmlName:"SignedService",type:{name:"String"}},signedVersion:{serializedName:"SignedVersion",required:!0,xmlName:"SignedVersion",type:{name:"String"}},value:{serializedName:"Value",required:!0,xmlName:"Value",type:{name:"String"}}}}},YU={serializedName:"FilterBlobSegment",xmlName:"EnumerationResults",type:{name:"Composite",className:"FilterBlobSegment",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},where:{serializedName:"Where",required:!0,xmlName:"Where",type:{name:"String"}},blobs:{serializedName:"Blobs",required:!0,xmlName:"Blobs",xmlIsWrapped:!0,xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"FilterBlobItem"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},JU={serializedName:"FilterBlobItem",xmlName:"Blob",type:{name:"Composite",className:"FilterBlobItem",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",type:{name:"String"}},tags:{serializedName:"Tags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags"}}}}},QU={serializedName:"BlobTags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags",modelProperties:{blobTagSet:{serializedName:"BlobTagSet",required:!0,xmlName:"TagSet",xmlIsWrapped:!0,xmlElementName:"Tag",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobTag"}}}}}}},$U={serializedName:"BlobTag",xmlName:"Tag",type:{name:"Composite",className:"BlobTag",modelProperties:{key:{serializedName:"Key",required:!0,xmlName:"Key",type:{name:"String"}},value:{serializedName:"Value",required:!0,xmlName:"Value",type:{name:"String"}}}}},eq={serializedName:"SignedIdentifier",xmlName:"SignedIdentifier",type:{name:"Composite",className:"SignedIdentifier",modelProperties:{id:{serializedName:"Id",required:!0,xmlName:"Id",type:{name:"String"}},accessPolicy:{serializedName:"AccessPolicy",xmlName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy"}}}}},tq={serializedName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy",modelProperties:{startsOn:{serializedName:"Start",xmlName:"Start",type:{name:"String"}},expiresOn:{serializedName:"Expiry",xmlName:"Expiry",type:{name:"String"}},permissions:{serializedName:"Permission",xmlName:"Permission",type:{name:"String"}}}}},nq={serializedName:"ListBlobsFlatSegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListBlobsFlatSegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},segment:{serializedName:"Segment",xmlName:"Blobs",type:{name:"Composite",className:"BlobFlatListSegment"}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},iq={serializedName:"BlobFlatListSegment",xmlName:"Blobs",type:{name:"Composite",className:"BlobFlatListSegment",modelProperties:{blobItems:{serializedName:"BlobItems",required:!0,xmlName:"BlobItems",xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobItemInternal"}}}}}}},rq={serializedName:"BlobItemInternal",xmlName:"Blob",type:{name:"Composite",className:"BlobItemInternal",modelProperties:{name:{serializedName:"Name",xmlName:"Name",type:{name:"Composite",className:"BlobName"}},deleted:{serializedName:"Deleted",required:!0,xmlName:"Deleted",type:{name:"Boolean"}},snapshot:{serializedName:"Snapshot",required:!0,xmlName:"Snapshot",type:{name:"String"}},versionId:{serializedName:"VersionId",xmlName:"VersionId",type:{name:"String"}},isCurrentVersion:{serializedName:"IsCurrentVersion",xmlName:"IsCurrentVersion",type:{name:"Boolean"}},properties:{serializedName:"Properties",xmlName:"Properties",type:{name:"Composite",className:"BlobPropertiesInternal"}},metadata:{serializedName:"Metadata",xmlName:"Metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}},blobTags:{serializedName:"BlobTags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags"}},objectReplicationMetadata:{serializedName:"ObjectReplicationMetadata",xmlName:"OrMetadata",type:{name:"Dictionary",value:{type:{name:"String"}}}},hasVersionsOnly:{serializedName:"HasVersionsOnly",xmlName:"HasVersionsOnly",type:{name:"Boolean"}}}}},aq={serializedName:"BlobName",type:{name:"Composite",className:"BlobName",modelProperties:{encoded:{serializedName:"Encoded",xmlName:"Encoded",xmlIsAttribute:!0,type:{name:"Boolean"}},content:{serializedName:"content",xmlName:"content",xmlIsMsText:!0,type:{name:"String"}}}}},oq={serializedName:"BlobPropertiesInternal",xmlName:"Properties",type:{name:"Composite",className:"BlobPropertiesInternal",modelProperties:{createdOn:{serializedName:"Creation-Time",xmlName:"Creation-Time",type:{name:"DateTimeRfc1123"}},lastModified:{serializedName:"Last-Modified",required:!0,xmlName:"Last-Modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"Etag",required:!0,xmlName:"Etag",type:{name:"String"}},contentLength:{serializedName:"Content-Length",xmlName:"Content-Length",type:{name:"Number"}},contentType:{serializedName:"Content-Type",xmlName:"Content-Type",type:{name:"String"}},contentEncoding:{serializedName:"Content-Encoding",xmlName:"Content-Encoding",type:{name:"String"}},contentLanguage:{serializedName:"Content-Language",xmlName:"Content-Language",type:{name:"String"}},contentMD5:{serializedName:"Content-MD5",xmlName:"Content-MD5",type:{name:"ByteArray"}},contentDisposition:{serializedName:"Content-Disposition",xmlName:"Content-Disposition",type:{name:"String"}},cacheControl:{serializedName:"Cache-Control",xmlName:"Cache-Control",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"BlobType",xmlName:"BlobType",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},leaseStatus:{serializedName:"LeaseStatus",xmlName:"LeaseStatus",type:{name:"Enum",allowedValues:["locked","unlocked"]}},leaseState:{serializedName:"LeaseState",xmlName:"LeaseState",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseDuration:{serializedName:"LeaseDuration",xmlName:"LeaseDuration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},copyId:{serializedName:"CopyId",xmlName:"CopyId",type:{name:"String"}},copyStatus:{serializedName:"CopyStatus",xmlName:"CopyStatus",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},copySource:{serializedName:"CopySource",xmlName:"CopySource",type:{name:"String"}},copyProgress:{serializedName:"CopyProgress",xmlName:"CopyProgress",type:{name:"String"}},copyCompletedOn:{serializedName:"CopyCompletionTime",xmlName:"CopyCompletionTime",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"CopyStatusDescription",xmlName:"CopyStatusDescription",type:{name:"String"}},serverEncrypted:{serializedName:"ServerEncrypted",xmlName:"ServerEncrypted",type:{name:"Boolean"}},incrementalCopy:{serializedName:"IncrementalCopy",xmlName:"IncrementalCopy",type:{name:"Boolean"}},destinationSnapshot:{serializedName:"DestinationSnapshot",xmlName:"DestinationSnapshot",type:{name:"String"}},deletedOn:{serializedName:"DeletedTime",xmlName:"DeletedTime",type:{name:"DateTimeRfc1123"}},remainingRetentionDays:{serializedName:"RemainingRetentionDays",xmlName:"RemainingRetentionDays",type:{name:"Number"}},accessTier:{serializedName:"AccessTier",xmlName:"AccessTier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}},accessTierInferred:{serializedName:"AccessTierInferred",xmlName:"AccessTierInferred",type:{name:"Boolean"}},archiveStatus:{serializedName:"ArchiveStatus",xmlName:"ArchiveStatus",type:{name:"Enum",allowedValues:["rehydrate-pending-to-hot","rehydrate-pending-to-cool","rehydrate-pending-to-cold"]}},customerProvidedKeySha256:{serializedName:"CustomerProvidedKeySha256",xmlName:"CustomerProvidedKeySha256",type:{name:"String"}},encryptionScope:{serializedName:"EncryptionScope",xmlName:"EncryptionScope",type:{name:"String"}},accessTierChangedOn:{serializedName:"AccessTierChangeTime",xmlName:"AccessTierChangeTime",type:{name:"DateTimeRfc1123"}},tagCount:{serializedName:"TagCount",xmlName:"TagCount",type:{name:"Number"}},expiresOn:{serializedName:"Expiry-Time",xmlName:"Expiry-Time",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"Sealed",xmlName:"Sealed",type:{name:"Boolean"}},rehydratePriority:{serializedName:"RehydratePriority",xmlName:"RehydratePriority",type:{name:"Enum",allowedValues:["High","Standard"]}},lastAccessedOn:{serializedName:"LastAccessTime",xmlName:"LastAccessTime",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"ImmutabilityPolicyUntilDate",xmlName:"ImmutabilityPolicyUntilDate",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"ImmutabilityPolicyMode",xmlName:"ImmutabilityPolicyMode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"LegalHold",xmlName:"LegalHold",type:{name:"Boolean"}}}}},sq={serializedName:"ListBlobsHierarchySegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListBlobsHierarchySegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},delimiter:{serializedName:"Delimiter",xmlName:"Delimiter",type:{name:"String"}},segment:{serializedName:"Segment",xmlName:"Blobs",type:{name:"Composite",className:"BlobHierarchyListSegment"}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},lq={serializedName:"BlobHierarchyListSegment",xmlName:"Blobs",type:{name:"Composite",className:"BlobHierarchyListSegment",modelProperties:{blobPrefixes:{serializedName:"BlobPrefixes",xmlName:"BlobPrefixes",xmlElementName:"BlobPrefix",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobPrefix"}}}},blobItems:{serializedName:"BlobItems",required:!0,xmlName:"BlobItems",xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobItemInternal"}}}}}}},uq={serializedName:"BlobPrefix",type:{name:"Composite",className:"BlobPrefix",modelProperties:{name:{serializedName:"Name",xmlName:"Name",type:{name:"Composite",className:"BlobName"}}}}},cq={serializedName:"BlockLookupList",xmlName:"BlockList",type:{name:"Composite",className:"BlockLookupList",modelProperties:{committed:{serializedName:"Committed",xmlName:"Committed",xmlElementName:"Committed",type:{name:"Sequence",element:{type:{name:"String"}}}},uncommitted:{serializedName:"Uncommitted",xmlName:"Uncommitted",xmlElementName:"Uncommitted",type:{name:"Sequence",element:{type:{name:"String"}}}},latest:{serializedName:"Latest",xmlName:"Latest",xmlElementName:"Latest",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},hq={serializedName:"BlockList",type:{name:"Composite",className:"BlockList",modelProperties:{committedBlocks:{serializedName:"CommittedBlocks",xmlName:"CommittedBlocks",xmlIsWrapped:!0,xmlElementName:"Block",type:{name:"Sequence",element:{type:{name:"Composite",className:"Block"}}}},uncommittedBlocks:{serializedName:"UncommittedBlocks",xmlName:"UncommittedBlocks",xmlIsWrapped:!0,xmlElementName:"Block",type:{name:"Sequence",element:{type:{name:"Composite",className:"Block"}}}}}}},dq={serializedName:"Block",type:{name:"Composite",className:"Block",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},size:{serializedName:"Size",required:!0,xmlName:"Size",type:{name:"Number"}}}}},fq={serializedName:"PageList",type:{name:"Composite",className:"PageList",modelProperties:{pageRange:{serializedName:"PageRange",xmlName:"PageRange",xmlElementName:"PageRange",type:{name:"Sequence",element:{type:{name:"Composite",className:"PageRange"}}}},clearRange:{serializedName:"ClearRange",xmlName:"ClearRange",xmlElementName:"ClearRange",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClearRange"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},pq={serializedName:"PageRange",xmlName:"PageRange",type:{name:"Composite",className:"PageRange",modelProperties:{start:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"Number"}},end:{serializedName:"End",required:!0,xmlName:"End",type:{name:"Number"}}}}},mq={serializedName:"ClearRange",xmlName:"ClearRange",type:{name:"Composite",className:"ClearRange",modelProperties:{start:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"Number"}},end:{serializedName:"End",required:!0,xmlName:"End",type:{name:"Number"}}}}},vq={serializedName:"QueryRequest",xmlName:"QueryRequest",type:{name:"Composite",className:"QueryRequest",modelProperties:{queryType:{serializedName:"QueryType",required:!0,xmlName:"QueryType",type:{name:"String"}},expression:{serializedName:"Expression",required:!0,xmlName:"Expression",type:{name:"String"}},inputSerialization:{serializedName:"InputSerialization",xmlName:"InputSerialization",type:{name:"Composite",className:"QuerySerialization"}},outputSerialization:{serializedName:"OutputSerialization",xmlName:"OutputSerialization",type:{name:"Composite",className:"QuerySerialization"}}}}},gq={serializedName:"QuerySerialization",type:{name:"Composite",className:"QuerySerialization",modelProperties:{format:{serializedName:"Format",xmlName:"Format",type:{name:"Composite",className:"QueryFormat"}}}}},yq={serializedName:"QueryFormat",type:{name:"Composite",className:"QueryFormat",modelProperties:{type:{serializedName:"Type",required:!0,xmlName:"Type",type:{name:"Enum",allowedValues:["delimited","json","arrow","parquet"]}},delimitedTextConfiguration:{serializedName:"DelimitedTextConfiguration",xmlName:"DelimitedTextConfiguration",type:{name:"Composite",className:"DelimitedTextConfiguration"}},jsonTextConfiguration:{serializedName:"JsonTextConfiguration",xmlName:"JsonTextConfiguration",type:{name:"Composite",className:"JsonTextConfiguration"}},arrowConfiguration:{serializedName:"ArrowConfiguration",xmlName:"ArrowConfiguration",type:{name:"Composite",className:"ArrowConfiguration"}},parquetTextConfiguration:{serializedName:"ParquetTextConfiguration",xmlName:"ParquetTextConfiguration",type:{name:"any"}}}}},_q={serializedName:"DelimitedTextConfiguration",xmlName:"DelimitedTextConfiguration",type:{name:"Composite",className:"DelimitedTextConfiguration",modelProperties:{columnSeparator:{serializedName:"ColumnSeparator",xmlName:"ColumnSeparator",type:{name:"String"}},fieldQuote:{serializedName:"FieldQuote",xmlName:"FieldQuote",type:{name:"String"}},recordSeparator:{serializedName:"RecordSeparator",xmlName:"RecordSeparator",type:{name:"String"}},escapeChar:{serializedName:"EscapeChar",xmlName:"EscapeChar",type:{name:"String"}},headersPresent:{serializedName:"HeadersPresent",xmlName:"HasHeaders",type:{name:"Boolean"}}}}},xq={serializedName:"JsonTextConfiguration",xmlName:"JsonTextConfiguration",type:{name:"Composite",className:"JsonTextConfiguration",modelProperties:{recordSeparator:{serializedName:"RecordSeparator",xmlName:"RecordSeparator",type:{name:"String"}}}}},bq={serializedName:"ArrowConfiguration",xmlName:"ArrowConfiguration",type:{name:"Composite",className:"ArrowConfiguration",modelProperties:{schema:{serializedName:"Schema",required:!0,xmlName:"Schema",xmlIsWrapped:!0,xmlElementName:"Field",type:{name:"Sequence",element:{type:{name:"Composite",className:"ArrowField"}}}}}}},wq={serializedName:"ArrowField",xmlName:"Field",type:{name:"Composite",className:"ArrowField",modelProperties:{type:{serializedName:"Type",required:!0,xmlName:"Type",type:{name:"String"}},name:{serializedName:"Name",xmlName:"Name",type:{name:"String"}},precision:{serializedName:"Precision",xmlName:"Precision",type:{name:"Number"}},scale:{serializedName:"Scale",xmlName:"Scale",type:{name:"Number"}}}}},kq={serializedName:"Service_setPropertiesHeaders",type:{name:"Composite",className:"ServiceSetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Cq={serializedName:"Service_setPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceSetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Sq={serializedName:"Service_getPropertiesHeaders",type:{name:"Composite",className:"ServiceGetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Tq={serializedName:"Service_getPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Eq={serializedName:"Service_getStatisticsHeaders",type:{name:"Composite",className:"ServiceGetStatisticsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Pq={serializedName:"Service_getStatisticsExceptionHeaders",type:{name:"Composite",className:"ServiceGetStatisticsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Mq={serializedName:"Service_listContainersSegmentHeaders",type:{name:"Composite",className:"ServiceListContainersSegmentHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Iq={serializedName:"Service_listContainersSegmentExceptionHeaders",type:{name:"Composite",className:"ServiceListContainersSegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Aq={serializedName:"Service_getUserDelegationKeyHeaders",type:{name:"Composite",className:"ServiceGetUserDelegationKeyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Rq={serializedName:"Service_getUserDelegationKeyExceptionHeaders",type:{name:"Composite",className:"ServiceGetUserDelegationKeyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Oq={serializedName:"Service_getAccountInfoHeaders",type:{name:"Composite",className:"ServiceGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}},isHierarchicalNamespaceEnabled:{serializedName:"x-ms-is-hns-enabled",xmlName:"x-ms-is-hns-enabled",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Nq={serializedName:"Service_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"ServiceGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Dq={serializedName:"Service_submitBatchHeaders",type:{name:"Composite",className:"ServiceSubmitBatchHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zq={serializedName:"Service_submitBatchExceptionHeaders",type:{name:"Composite",className:"ServiceSubmitBatchExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Lq={serializedName:"Service_filterBlobsHeaders",type:{name:"Composite",className:"ServiceFilterBlobsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Bq={serializedName:"Service_filterBlobsExceptionHeaders",type:{name:"Composite",className:"ServiceFilterBlobsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Fq={serializedName:"Container_createHeaders",type:{name:"Composite",className:"ContainerCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},jq={serializedName:"Container_createExceptionHeaders",type:{name:"Composite",className:"ContainerCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Hq={serializedName:"Container_getPropertiesHeaders",type:{name:"Composite",className:"ContainerGetPropertiesHeaders",modelProperties:{metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobPublicAccess:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}},hasImmutabilityPolicy:{serializedName:"x-ms-has-immutability-policy",xmlName:"x-ms-has-immutability-policy",type:{name:"Boolean"}},hasLegalHold:{serializedName:"x-ms-has-legal-hold",xmlName:"x-ms-has-legal-hold",type:{name:"Boolean"}},defaultEncryptionScope:{serializedName:"x-ms-default-encryption-scope",xmlName:"x-ms-default-encryption-scope",type:{name:"String"}},denyEncryptionScopeOverride:{serializedName:"x-ms-deny-encryption-scope-override",xmlName:"x-ms-deny-encryption-scope-override",type:{name:"Boolean"}},isImmutableStorageWithVersioningEnabled:{serializedName:"x-ms-immutable-storage-with-versioning-enabled",xmlName:"x-ms-immutable-storage-with-versioning-enabled",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Vq={serializedName:"Container_getPropertiesExceptionHeaders",type:{name:"Composite",className:"ContainerGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Uq={serializedName:"Container_deleteHeaders",type:{name:"Composite",className:"ContainerDeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},qq={serializedName:"Container_deleteExceptionHeaders",type:{name:"Composite",className:"ContainerDeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Gq={serializedName:"Container_setMetadataHeaders",type:{name:"Composite",className:"ContainerSetMetadataHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Wq={serializedName:"Container_setMetadataExceptionHeaders",type:{name:"Composite",className:"ContainerSetMetadataExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Zq={serializedName:"Container_getAccessPolicyHeaders",type:{name:"Composite",className:"ContainerGetAccessPolicyHeaders",modelProperties:{blobPublicAccess:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Xq={serializedName:"Container_getAccessPolicyExceptionHeaders",type:{name:"Composite",className:"ContainerGetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Kq={serializedName:"Container_setAccessPolicyHeaders",type:{name:"Composite",className:"ContainerSetAccessPolicyHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Yq={serializedName:"Container_setAccessPolicyExceptionHeaders",type:{name:"Composite",className:"ContainerSetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Jq={serializedName:"Container_restoreHeaders",type:{name:"Composite",className:"ContainerRestoreHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Qq={serializedName:"Container_restoreExceptionHeaders",type:{name:"Composite",className:"ContainerRestoreExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},$q={serializedName:"Container_renameHeaders",type:{name:"Composite",className:"ContainerRenameHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},eG={serializedName:"Container_renameExceptionHeaders",type:{name:"Composite",className:"ContainerRenameExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},tG={serializedName:"Container_submitBatchHeaders",type:{name:"Composite",className:"ContainerSubmitBatchHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}}}}},nG={serializedName:"Container_submitBatchExceptionHeaders",type:{name:"Composite",className:"ContainerSubmitBatchExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},iG={serializedName:"Container_filterBlobsHeaders",type:{name:"Composite",className:"ContainerFilterBlobsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},rG={serializedName:"Container_filterBlobsExceptionHeaders",type:{name:"Composite",className:"ContainerFilterBlobsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},aG={serializedName:"Container_acquireLeaseHeaders",type:{name:"Composite",className:"ContainerAcquireLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},oG={serializedName:"Container_acquireLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerAcquireLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},sG={serializedName:"Container_releaseLeaseHeaders",type:{name:"Composite",className:"ContainerReleaseLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},lG={serializedName:"Container_releaseLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerReleaseLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},uG={serializedName:"Container_renewLeaseHeaders",type:{name:"Composite",className:"ContainerRenewLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},cG={serializedName:"Container_renewLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerRenewLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},hG={serializedName:"Container_breakLeaseHeaders",type:{name:"Composite",className:"ContainerBreakLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseTime:{serializedName:"x-ms-lease-time",xmlName:"x-ms-lease-time",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},dG={serializedName:"Container_breakLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerBreakLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},fG={serializedName:"Container_changeLeaseHeaders",type:{name:"Composite",className:"ContainerChangeLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},pG={serializedName:"Container_changeLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerChangeLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},mG={serializedName:"Container_listBlobFlatSegmentHeaders",type:{name:"Composite",className:"ContainerListBlobFlatSegmentHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},vG={serializedName:"Container_listBlobFlatSegmentExceptionHeaders",type:{name:"Composite",className:"ContainerListBlobFlatSegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gG={serializedName:"Container_listBlobHierarchySegmentHeaders",type:{name:"Composite",className:"ContainerListBlobHierarchySegmentHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yG={serializedName:"Container_listBlobHierarchySegmentExceptionHeaders",type:{name:"Composite",className:"ContainerListBlobHierarchySegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_G={serializedName:"Container_getAccountInfoHeaders",type:{name:"Composite",className:"ContainerGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}}}}},xG={serializedName:"Container_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"ContainerGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},bG={serializedName:"Blob_downloadHeaders",type:{name:"Composite",className:"BlobDownloadHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},createdOn:{serializedName:"x-ms-creation-time",xmlName:"x-ms-creation-time",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},objectReplicationPolicyId:{serializedName:"x-ms-or-policy-id",xmlName:"x-ms-or-policy-id",type:{name:"String"}},objectReplicationRules:{serializedName:"x-ms-or",xmlName:"x-ms-or",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-or-"},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},contentRange:{serializedName:"content-range",xmlName:"content-range",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletedOn:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},isCurrentVersion:{serializedName:"x-ms-is-current-version",xmlName:"x-ms-is-current-version",type:{name:"Boolean"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},blobContentMD5:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}},tagCount:{serializedName:"x-ms-tag-count",xmlName:"x-ms-tag-count",type:{name:"Number"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}},lastAccessed:{serializedName:"x-ms-last-access-time",xmlName:"x-ms-last-access-time",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}},contentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}}}},wG={serializedName:"Blob_downloadExceptionHeaders",type:{name:"Composite",className:"BlobDownloadExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},kG={serializedName:"Blob_getPropertiesHeaders",type:{name:"Composite",className:"BlobGetPropertiesHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},createdOn:{serializedName:"x-ms-creation-time",xmlName:"x-ms-creation-time",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},objectReplicationPolicyId:{serializedName:"x-ms-or-policy-id",xmlName:"x-ms-or-policy-id",type:{name:"String"}},objectReplicationRules:{serializedName:"x-ms-or",xmlName:"x-ms-or",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-or-"},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletedOn:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},isIncrementalCopy:{serializedName:"x-ms-incremental-copy",xmlName:"x-ms-incremental-copy",type:{name:"Boolean"}},destinationSnapshot:{serializedName:"x-ms-copy-destination-snapshot",xmlName:"x-ms-copy-destination-snapshot",type:{name:"String"}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},accessTier:{serializedName:"x-ms-access-tier",xmlName:"x-ms-access-tier",type:{name:"String"}},accessTierInferred:{serializedName:"x-ms-access-tier-inferred",xmlName:"x-ms-access-tier-inferred",type:{name:"Boolean"}},archiveStatus:{serializedName:"x-ms-archive-status",xmlName:"x-ms-archive-status",type:{name:"String"}},accessTierChangedOn:{serializedName:"x-ms-access-tier-change-time",xmlName:"x-ms-access-tier-change-time",type:{name:"DateTimeRfc1123"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},isCurrentVersion:{serializedName:"x-ms-is-current-version",xmlName:"x-ms-is-current-version",type:{name:"Boolean"}},tagCount:{serializedName:"x-ms-tag-count",xmlName:"x-ms-tag-count",type:{name:"Number"}},expiresOn:{serializedName:"x-ms-expiry-time",xmlName:"x-ms-expiry-time",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}},rehydratePriority:{serializedName:"x-ms-rehydrate-priority",xmlName:"x-ms-rehydrate-priority",type:{name:"Enum",allowedValues:["High","Standard"]}},lastAccessed:{serializedName:"x-ms-last-access-time",xmlName:"x-ms-last-access-time",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},CG={serializedName:"Blob_getPropertiesExceptionHeaders",type:{name:"Composite",className:"BlobGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},SG={serializedName:"Blob_deleteHeaders",type:{name:"Composite",className:"BlobDeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},TG={serializedName:"Blob_deleteExceptionHeaders",type:{name:"Composite",className:"BlobDeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},EG={serializedName:"Blob_undeleteHeaders",type:{name:"Composite",className:"BlobUndeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},PG={serializedName:"Blob_undeleteExceptionHeaders",type:{name:"Composite",className:"BlobUndeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},MG={serializedName:"Blob_setExpiryHeaders",type:{name:"Composite",className:"BlobSetExpiryHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},IG={serializedName:"Blob_setExpiryExceptionHeaders",type:{name:"Composite",className:"BlobSetExpiryExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},AG={serializedName:"Blob_setHttpHeadersHeaders",type:{name:"Composite",className:"BlobSetHttpHeadersHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},RG={serializedName:"Blob_setHttpHeadersExceptionHeaders",type:{name:"Composite",className:"BlobSetHttpHeadersExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},OG={serializedName:"Blob_setImmutabilityPolicyHeaders",type:{name:"Composite",className:"BlobSetImmutabilityPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiry:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}}}}},NG={serializedName:"Blob_setImmutabilityPolicyExceptionHeaders",type:{name:"Composite",className:"BlobSetImmutabilityPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},DG={serializedName:"Blob_deleteImmutabilityPolicyHeaders",type:{name:"Composite",className:"BlobDeleteImmutabilityPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},zG={serializedName:"Blob_deleteImmutabilityPolicyExceptionHeaders",type:{name:"Composite",className:"BlobDeleteImmutabilityPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},LG={serializedName:"Blob_setLegalHoldHeaders",type:{name:"Composite",className:"BlobSetLegalHoldHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}}}},BG={serializedName:"Blob_setLegalHoldExceptionHeaders",type:{name:"Composite",className:"BlobSetLegalHoldExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},FG={serializedName:"Blob_setMetadataHeaders",type:{name:"Composite",className:"BlobSetMetadataHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},jG={serializedName:"Blob_setMetadataExceptionHeaders",type:{name:"Composite",className:"BlobSetMetadataExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},HG={serializedName:"Blob_acquireLeaseHeaders",type:{name:"Composite",className:"BlobAcquireLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},VG={serializedName:"Blob_acquireLeaseExceptionHeaders",type:{name:"Composite",className:"BlobAcquireLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},UG={serializedName:"Blob_releaseLeaseHeaders",type:{name:"Composite",className:"BlobReleaseLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},qG={serializedName:"Blob_releaseLeaseExceptionHeaders",type:{name:"Composite",className:"BlobReleaseLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},GG={serializedName:"Blob_renewLeaseHeaders",type:{name:"Composite",className:"BlobRenewLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},WG={serializedName:"Blob_renewLeaseExceptionHeaders",type:{name:"Composite",className:"BlobRenewLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},ZG={serializedName:"Blob_changeLeaseHeaders",type:{name:"Composite",className:"BlobChangeLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},XG={serializedName:"Blob_changeLeaseExceptionHeaders",type:{name:"Composite",className:"BlobChangeLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},KG={serializedName:"Blob_breakLeaseHeaders",type:{name:"Composite",className:"BlobBreakLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseTime:{serializedName:"x-ms-lease-time",xmlName:"x-ms-lease-time",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},YG={serializedName:"Blob_breakLeaseExceptionHeaders",type:{name:"Composite",className:"BlobBreakLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},JG={serializedName:"Blob_createSnapshotHeaders",type:{name:"Composite",className:"BlobCreateSnapshotHeaders",modelProperties:{snapshot:{serializedName:"x-ms-snapshot",xmlName:"x-ms-snapshot",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},QG={serializedName:"Blob_createSnapshotExceptionHeaders",type:{name:"Composite",className:"BlobCreateSnapshotExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},$G={serializedName:"Blob_startCopyFromURLHeaders",type:{name:"Composite",className:"BlobStartCopyFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},eW={serializedName:"Blob_startCopyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobStartCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},tW={serializedName:"Blob_copyFromURLHeaders",type:{name:"Composite",className:"BlobCopyFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{defaultValue:"success",isConstant:!0,serializedName:"x-ms-copy-status",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},nW={serializedName:"Blob_copyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},iW={serializedName:"Blob_abortCopyFromURLHeaders",type:{name:"Composite",className:"BlobAbortCopyFromURLHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},rW={serializedName:"Blob_abortCopyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobAbortCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},aW={serializedName:"Blob_setTierHeaders",type:{name:"Composite",className:"BlobSetTierHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},oW={serializedName:"Blob_setTierExceptionHeaders",type:{name:"Composite",className:"BlobSetTierExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},sW={serializedName:"Blob_getAccountInfoHeaders",type:{name:"Composite",className:"BlobGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}}}}},lW={serializedName:"Blob_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"BlobGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},uW={serializedName:"Blob_queryHeaders",type:{name:"Composite",className:"BlobQueryHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}}},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},contentRange:{serializedName:"content-range",xmlName:"content-range",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletionTime:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},blobContentMD5:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}},contentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}}}},cW={serializedName:"Blob_queryExceptionHeaders",type:{name:"Composite",className:"BlobQueryExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},hW={serializedName:"Blob_getTagsHeaders",type:{name:"Composite",className:"BlobGetTagsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},dW={serializedName:"Blob_getTagsExceptionHeaders",type:{name:"Composite",className:"BlobGetTagsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},fW={serializedName:"Blob_setTagsHeaders",type:{name:"Composite",className:"BlobSetTagsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},pW={serializedName:"Blob_setTagsExceptionHeaders",type:{name:"Composite",className:"BlobSetTagsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},mW={serializedName:"PageBlob_createHeaders",type:{name:"Composite",className:"PageBlobCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},vW={serializedName:"PageBlob_createExceptionHeaders",type:{name:"Composite",className:"PageBlobCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gW={serializedName:"PageBlob_uploadPagesHeaders",type:{name:"Composite",className:"PageBlobUploadPagesHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yW={serializedName:"PageBlob_uploadPagesExceptionHeaders",type:{name:"Composite",className:"PageBlobUploadPagesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_W={serializedName:"PageBlob_clearPagesHeaders",type:{name:"Composite",className:"PageBlobClearPagesHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},xW={serializedName:"PageBlob_clearPagesExceptionHeaders",type:{name:"Composite",className:"PageBlobClearPagesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},bW={serializedName:"PageBlob_uploadPagesFromURLHeaders",type:{name:"Composite",className:"PageBlobUploadPagesFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},wW={serializedName:"PageBlob_uploadPagesFromURLExceptionHeaders",type:{name:"Composite",className:"PageBlobUploadPagesFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},kW={serializedName:"PageBlob_getPageRangesHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},CW={serializedName:"PageBlob_getPageRangesExceptionHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},SW={serializedName:"PageBlob_getPageRangesDiffHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesDiffHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},TW={serializedName:"PageBlob_getPageRangesDiffExceptionHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesDiffExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},EW={serializedName:"PageBlob_resizeHeaders",type:{name:"Composite",className:"PageBlobResizeHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},PW={serializedName:"PageBlob_resizeExceptionHeaders",type:{name:"Composite",className:"PageBlobResizeExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},MW={serializedName:"PageBlob_updateSequenceNumberHeaders",type:{name:"Composite",className:"PageBlobUpdateSequenceNumberHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},IW={serializedName:"PageBlob_updateSequenceNumberExceptionHeaders",type:{name:"Composite",className:"PageBlobUpdateSequenceNumberExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},AW={serializedName:"PageBlob_copyIncrementalHeaders",type:{name:"Composite",className:"PageBlobCopyIncrementalHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},RW={serializedName:"PageBlob_copyIncrementalExceptionHeaders",type:{name:"Composite",className:"PageBlobCopyIncrementalExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},OW={serializedName:"AppendBlob_createHeaders",type:{name:"Composite",className:"AppendBlobCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},NW={serializedName:"AppendBlob_createExceptionHeaders",type:{name:"Composite",className:"AppendBlobCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},DW={serializedName:"AppendBlob_appendBlockHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobAppendOffset:{serializedName:"x-ms-blob-append-offset",xmlName:"x-ms-blob-append-offset",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zW={serializedName:"AppendBlob_appendBlockExceptionHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},LW={serializedName:"AppendBlob_appendBlockFromUrlHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockFromUrlHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobAppendOffset:{serializedName:"x-ms-blob-append-offset",xmlName:"x-ms-blob-append-offset",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},BW={serializedName:"AppendBlob_appendBlockFromUrlExceptionHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockFromUrlExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},FW={serializedName:"AppendBlob_sealHeaders",type:{name:"Composite",className:"AppendBlobSealHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}}}}},jW={serializedName:"AppendBlob_sealExceptionHeaders",type:{name:"Composite",className:"AppendBlobSealExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},HW={serializedName:"BlockBlob_uploadHeaders",type:{name:"Composite",className:"BlockBlobUploadHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},VW={serializedName:"BlockBlob_uploadExceptionHeaders",type:{name:"Composite",className:"BlockBlobUploadExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},UW={serializedName:"BlockBlob_putBlobFromUrlHeaders",type:{name:"Composite",className:"BlockBlobPutBlobFromUrlHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},qW={serializedName:"BlockBlob_putBlobFromUrlExceptionHeaders",type:{name:"Composite",className:"BlockBlobPutBlobFromUrlExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},GW={serializedName:"BlockBlob_stageBlockHeaders",type:{name:"Composite",className:"BlockBlobStageBlockHeaders",modelProperties:{contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},WW={serializedName:"BlockBlob_stageBlockExceptionHeaders",type:{name:"Composite",className:"BlockBlobStageBlockExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},ZW={serializedName:"BlockBlob_stageBlockFromURLHeaders",type:{name:"Composite",className:"BlockBlobStageBlockFromURLHeaders",modelProperties:{contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},XW={serializedName:"BlockBlob_stageBlockFromURLExceptionHeaders",type:{name:"Composite",className:"BlockBlobStageBlockFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},KW={serializedName:"BlockBlob_commitBlockListHeaders",type:{name:"Composite",className:"BlockBlobCommitBlockListHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},YW={serializedName:"BlockBlob_commitBlockListExceptionHeaders",type:{name:"Composite",className:"BlockBlobCommitBlockListExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},JW={serializedName:"BlockBlob_getBlockListHeaders",type:{name:"Composite",className:"BlockBlobGetBlockListHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},QW={serializedName:"BlockBlob_getBlockListExceptionHeaders",type:{name:"Composite",className:"BlockBlobGetBlockListExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}};!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(NU||(NU={}));var $W={parameterPath:["options","contentType"],mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},eZ={parameterPath:"blobServiceProperties",mapper:zU},tZ={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},nZ={parameterPath:"url",mapper:{serializedName:"url",required:!0,xmlName:"url",type:{name:"String"}},skipEncoding:!0},iZ={parameterPath:"restype",mapper:{defaultValue:"service",isConstant:!0,serializedName:"restype",type:{name:"String"}}},rZ={parameterPath:"comp",mapper:{defaultValue:"properties",isConstant:!0,serializedName:"comp",type:{name:"String"}}},aZ={parameterPath:["options","timeoutInSeconds"],mapper:{constraints:{InclusiveMinimum:0},serializedName:"timeout",xmlName:"timeout",type:{name:"Number"}}},oZ={parameterPath:"version",mapper:{defaultValue:"2023-11-03",isConstant:!0,serializedName:"x-ms-version",type:{name:"String"}}},sZ={parameterPath:["options","requestId"],mapper:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}}},lZ={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},uZ={parameterPath:"comp",mapper:{defaultValue:"list",isConstant:!0,serializedName:"comp",type:{name:"String"}}},cZ={parameterPath:["options","prefix"],mapper:{serializedName:"prefix",xmlName:"prefix",type:{name:"String"}}},hZ={parameterPath:["options","marker"],mapper:{serializedName:"marker",xmlName:"marker",type:{name:"String"}}},dZ={parameterPath:["options","maxPageSize"],mapper:{constraints:{InclusiveMinimum:1},serializedName:"maxresults",xmlName:"maxresults",type:{name:"Number"}}},fZ={parameterPath:["options","include"],mapper:{serializedName:"include",xmlName:"include",xmlElementName:"ListContainersIncludeType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["metadata","deleted","system"]}}}},collectionFormat:NU.Csv},pZ={parameterPath:"keyInfo",mapper:XU},mZ={parameterPath:"restype",mapper:{defaultValue:"account",isConstant:!0,serializedName:"restype",type:{name:"String"}}},vZ={parameterPath:"body",mapper:{serializedName:"body",required:!0,xmlName:"body",type:{name:"Stream"}}},gZ={parameterPath:"comp",mapper:{defaultValue:"batch",isConstant:!0,serializedName:"comp",type:{name:"String"}}},yZ={parameterPath:"contentLength",mapper:{serializedName:"Content-Length",required:!0,xmlName:"Content-Length",type:{name:"Number"}}},_Z={parameterPath:"multipartContentType",mapper:{serializedName:"Content-Type",required:!0,xmlName:"Content-Type",type:{name:"String"}}},xZ={parameterPath:"comp",mapper:{defaultValue:"blobs",isConstant:!0,serializedName:"comp",type:{name:"String"}}},bZ={parameterPath:["options","where"],mapper:{serializedName:"where",xmlName:"where",type:{name:"String"}}},wZ={parameterPath:"restype",mapper:{defaultValue:"container",isConstant:!0,serializedName:"restype",type:{name:"String"}}},kZ={parameterPath:["options","metadata"],mapper:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"}},CZ={parameterPath:["options","access"],mapper:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}}},SZ={parameterPath:["options","leaseAccessConditions","leaseId"],mapper:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}}},TZ={parameterPath:["options","modifiedAccessConditions","ifModifiedSince"],mapper:{serializedName:"If-Modified-Since",xmlName:"If-Modified-Since",type:{name:"DateTimeRfc1123"}}},EZ={parameterPath:["options","modifiedAccessConditions","ifUnmodifiedSince"],mapper:{serializedName:"If-Unmodified-Since",xmlName:"If-Unmodified-Since",type:{name:"DateTimeRfc1123"}}},PZ={parameterPath:"comp",mapper:{defaultValue:"metadata",isConstant:!0,serializedName:"comp",type:{name:"String"}}},MZ={parameterPath:"comp",mapper:{defaultValue:"acl",isConstant:!0,serializedName:"comp",type:{name:"String"}}},IZ={parameterPath:"comp",mapper:{defaultValue:"undelete",isConstant:!0,serializedName:"comp",type:{name:"String"}}},AZ={parameterPath:"comp",mapper:{defaultValue:"lease",isConstant:!0,serializedName:"comp",type:{name:"String"}}},RZ={parameterPath:"action",mapper:{defaultValue:"acquire",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},OZ={parameterPath:["options","duration"],mapper:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Number"}}},NZ={parameterPath:["options","proposedLeaseId"],mapper:{serializedName:"x-ms-proposed-lease-id",xmlName:"x-ms-proposed-lease-id",type:{name:"String"}}},DZ={parameterPath:"action",mapper:{defaultValue:"release",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},zZ={parameterPath:"leaseId",mapper:{serializedName:"x-ms-lease-id",required:!0,xmlName:"x-ms-lease-id",type:{name:"String"}}},LZ={parameterPath:"action",mapper:{defaultValue:"renew",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},BZ={parameterPath:"action",mapper:{defaultValue:"break",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},FZ={parameterPath:["options","breakPeriod"],mapper:{serializedName:"x-ms-lease-break-period",xmlName:"x-ms-lease-break-period",type:{name:"Number"}}},jZ={parameterPath:"action",mapper:{defaultValue:"change",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},HZ={parameterPath:"proposedLeaseId",mapper:{serializedName:"x-ms-proposed-lease-id",required:!0,xmlName:"x-ms-proposed-lease-id",type:{name:"String"}}},VZ={parameterPath:["options","include"],mapper:{serializedName:"include",xmlName:"include",xmlElementName:"ListBlobsIncludeItem",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["copy","deleted","metadata","snapshots","uncommittedblobs","versions","tags","immutabilitypolicy","legalhold","deletedwithversions"]}}}},collectionFormat:NU.Csv},UZ={parameterPath:["options","snapshot"],mapper:{serializedName:"snapshot",xmlName:"snapshot",type:{name:"String"}}},qZ={parameterPath:["options","versionId"],mapper:{serializedName:"versionid",xmlName:"versionid",type:{name:"String"}}},GZ={parameterPath:["options","range"],mapper:{serializedName:"x-ms-range",xmlName:"x-ms-range",type:{name:"String"}}},WZ={parameterPath:["options","cpkInfo","encryptionKey"],mapper:{serializedName:"x-ms-encryption-key",xmlName:"x-ms-encryption-key",type:{name:"String"}}},ZZ={parameterPath:["options","cpkInfo","encryptionKeySha256"],mapper:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}}},XZ={parameterPath:["options","cpkInfo","encryptionAlgorithm"],mapper:{serializedName:"x-ms-encryption-algorithm",xmlName:"x-ms-encryption-algorithm",type:{name:"String"}}},KZ={parameterPath:["options","modifiedAccessConditions","ifMatch"],mapper:{serializedName:"If-Match",xmlName:"If-Match",type:{name:"String"}}},YZ={parameterPath:["options","modifiedAccessConditions","ifNoneMatch"],mapper:{serializedName:"If-None-Match",xmlName:"If-None-Match",type:{name:"String"}}},JZ={parameterPath:["options","modifiedAccessConditions","ifTags"],mapper:{serializedName:"x-ms-if-tags",xmlName:"x-ms-if-tags",type:{name:"String"}}},QZ={parameterPath:["options","blobHttpHeaders","blobCacheControl"],mapper:{serializedName:"x-ms-blob-cache-control",xmlName:"x-ms-blob-cache-control",type:{name:"String"}}},$Z={parameterPath:["options","blobHttpHeaders","blobContentType"],mapper:{serializedName:"x-ms-blob-content-type",xmlName:"x-ms-blob-content-type",type:{name:"String"}}},eX={parameterPath:["options","blobHttpHeaders","blobContentMD5"],mapper:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}}},tX={parameterPath:["options","blobHttpHeaders","blobContentEncoding"],mapper:{serializedName:"x-ms-blob-content-encoding",xmlName:"x-ms-blob-content-encoding",type:{name:"String"}}},nX={parameterPath:["options","blobHttpHeaders","blobContentLanguage"],mapper:{serializedName:"x-ms-blob-content-language",xmlName:"x-ms-blob-content-language",type:{name:"String"}}},iX={parameterPath:["options","blobHttpHeaders","blobContentDisposition"],mapper:{serializedName:"x-ms-blob-content-disposition",xmlName:"x-ms-blob-content-disposition",type:{name:"String"}}},rX={parameterPath:"comp",mapper:{defaultValue:"immutabilityPolicies",isConstant:!0,serializedName:"comp",type:{name:"String"}}},aX={parameterPath:["options","immutabilityPolicyExpiry"],mapper:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}}},oX={parameterPath:["options","immutabilityPolicyMode"],mapper:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}}},sX={parameterPath:["options","encryptionScope"],mapper:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}}},lX={parameterPath:["options","tier"],mapper:{serializedName:"x-ms-access-tier",xmlName:"x-ms-access-tier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}}},uX={parameterPath:["options","rehydratePriority"],mapper:{serializedName:"x-ms-rehydrate-priority",xmlName:"x-ms-rehydrate-priority",type:{name:"Enum",allowedValues:["High","Standard"]}}},cX={parameterPath:["options","sourceModifiedAccessConditions","sourceIfModifiedSince"],mapper:{serializedName:"x-ms-source-if-modified-since",xmlName:"x-ms-source-if-modified-since",type:{name:"DateTimeRfc1123"}}},hX={parameterPath:["options","sourceModifiedAccessConditions","sourceIfUnmodifiedSince"],mapper:{serializedName:"x-ms-source-if-unmodified-since",xmlName:"x-ms-source-if-unmodified-since",type:{name:"DateTimeRfc1123"}}},dX={parameterPath:["options","sourceModifiedAccessConditions","sourceIfMatch"],mapper:{serializedName:"x-ms-source-if-match",xmlName:"x-ms-source-if-match",type:{name:"String"}}},fX={parameterPath:["options","sourceModifiedAccessConditions","sourceIfNoneMatch"],mapper:{serializedName:"x-ms-source-if-none-match",xmlName:"x-ms-source-if-none-match",type:{name:"String"}}},pX={parameterPath:["options","sourceModifiedAccessConditions","sourceIfTags"],mapper:{serializedName:"x-ms-source-if-tags",xmlName:"x-ms-source-if-tags",type:{name:"String"}}},mX={parameterPath:"copySource",mapper:{serializedName:"x-ms-copy-source",required:!0,xmlName:"x-ms-copy-source",type:{name:"String"}}},vX={parameterPath:["options","blobTagsString"],mapper:{serializedName:"x-ms-tags",xmlName:"x-ms-tags",type:{name:"String"}}},gX={parameterPath:["options","legalHold"],mapper:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}},yX={parameterPath:["options","sourceContentMD5"],mapper:{serializedName:"x-ms-source-content-md5",xmlName:"x-ms-source-content-md5",type:{name:"ByteArray"}}},_X={parameterPath:["options","copySourceAuthorization"],mapper:{serializedName:"x-ms-copy-source-authorization",xmlName:"x-ms-copy-source-authorization",type:{name:"String"}}},xX={parameterPath:["options","copySourceTags"],mapper:{serializedName:"x-ms-copy-source-tag-option",xmlName:"x-ms-copy-source-tag-option",type:{name:"Enum",allowedValues:["REPLACE","COPY"]}}},bX={parameterPath:["options","queryRequest"],mapper:vq},wX={parameterPath:"comp",mapper:{defaultValue:"tags",isConstant:!0,serializedName:"comp",type:{name:"String"}}},kX={parameterPath:["options","tags"],mapper:QU},CX={parameterPath:["options","transactionalContentMD5"],mapper:{serializedName:"Content-MD5",xmlName:"Content-MD5",type:{name:"ByteArray"}}},SX={parameterPath:["options","transactionalContentCrc64"],mapper:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}},TX={parameterPath:"blobContentLength",mapper:{serializedName:"x-ms-blob-content-length",required:!0,xmlName:"x-ms-blob-content-length",type:{name:"Number"}}},EX={parameterPath:["options","blobSequenceNumber"],mapper:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}}},PX={parameterPath:["options","contentType"],mapper:{defaultValue:"application/octet-stream",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},MX={parameterPath:"body",mapper:{serializedName:"body",required:!0,xmlName:"body",type:{name:"Stream"}}},IX={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},AX={parameterPath:"comp",mapper:{defaultValue:"page",isConstant:!0,serializedName:"comp",type:{name:"String"}}},RX={parameterPath:"pageWrite",mapper:{defaultValue:"update",isConstant:!0,serializedName:"x-ms-page-write",type:{name:"String"}}},OX={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberLessThanOrEqualTo"],mapper:{serializedName:"x-ms-if-sequence-number-le",xmlName:"x-ms-if-sequence-number-le",type:{name:"Number"}}},NX={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberLessThan"],mapper:{serializedName:"x-ms-if-sequence-number-lt",xmlName:"x-ms-if-sequence-number-lt",type:{name:"Number"}}},DX={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberEqualTo"],mapper:{serializedName:"x-ms-if-sequence-number-eq",xmlName:"x-ms-if-sequence-number-eq",type:{name:"Number"}}},zX={parameterPath:"sourceUrl",mapper:{serializedName:"x-ms-copy-source",required:!0,xmlName:"x-ms-copy-source",type:{name:"String"}}},LX={parameterPath:["options","sourceContentCrc64"],mapper:{serializedName:"x-ms-source-content-crc64",xmlName:"x-ms-source-content-crc64",type:{name:"ByteArray"}}},BX={parameterPath:"comp",mapper:{defaultValue:"pagelist",isConstant:!0,serializedName:"comp",type:{name:"String"}}},FX={parameterPath:"comp",mapper:{defaultValue:"appendblock",isConstant:!0,serializedName:"comp",type:{name:"String"}}},jX={parameterPath:["options","appendPositionAccessConditions","maxSize"],mapper:{serializedName:"x-ms-blob-condition-maxsize",xmlName:"x-ms-blob-condition-maxsize",type:{name:"Number"}}},HX={parameterPath:["options","appendPositionAccessConditions","appendPosition"],mapper:{serializedName:"x-ms-blob-condition-appendpos",xmlName:"x-ms-blob-condition-appendpos",type:{name:"Number"}}},VX={parameterPath:["options","sourceRange"],mapper:{serializedName:"x-ms-source-range",xmlName:"x-ms-source-range",type:{name:"String"}}},UX={parameterPath:"blobType",mapper:{defaultValue:"BlockBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}},qX={parameterPath:"comp",mapper:{defaultValue:"block",isConstant:!0,serializedName:"comp",type:{name:"String"}}},GX={parameterPath:"blockId",mapper:{serializedName:"blockid",required:!0,xmlName:"blockid",type:{name:"String"}}},WX={parameterPath:"blocks",mapper:cq},ZX={parameterPath:"comp",mapper:{defaultValue:"blocklist",isConstant:!0,serializedName:"comp",type:{name:"String"}}},XX=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"setProperties",value:function(e,t){var n={blobServiceProperties:e,options:uU(t||{})};return this.client.sendOperationRequest(n,YX)}},{key:"getProperties",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,JX)}},{key:"getStatistics",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,QX)}},{key:"listContainersSegment",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,$X)}},{key:"getUserDelegationKey",value:function(e,t){var n={keyInfo:e,options:uU(t||{})};return this.client.sendOperationRequest(n,eK)}},{key:"getAccountInfo",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,tK)}},{key:"submitBatch",value:function(e,t,n,i){var r={contentLength:e,multipartContentType:t,body:n,options:uU(i||{})};return this.client.sendOperationRequest(r,nK)}},{key:"filterBlobs",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,iK)}}]),e}(),KX=new SU(r,!0),YX={path:"/",httpMethod:"PUT",responses:{202:{headersMapper:kq},default:{bodyMapper:VU,headersMapper:Cq}},requestBody:eZ,queryParameters:[iZ,rZ,aZ],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:KX},JX={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:zU,headersMapper:Sq},default:{bodyMapper:VU,headersMapper:Tq}},queryParameters:[iZ,rZ,aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:KX},QX={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:UU,headersMapper:Eq},default:{bodyMapper:VU,headersMapper:Pq}},queryParameters:[iZ,aZ,{parameterPath:"comp",mapper:{defaultValue:"stats",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:KX},$X={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:GU,headersMapper:Mq},default:{bodyMapper:VU,headersMapper:Iq}},queryParameters:[aZ,uZ,cZ,hZ,dZ,fZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:KX},eK={path:"/",httpMethod:"POST",responses:{200:{bodyMapper:KU,headersMapper:Aq},default:{bodyMapper:VU,headersMapper:Rq}},requestBody:pZ,queryParameters:[iZ,aZ,{parameterPath:"comp",mapper:{defaultValue:"userdelegationkey",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:KX},tK={path:"/",httpMethod:"GET",responses:{200:{headersMapper:Oq},default:{bodyMapper:VU,headersMapper:Nq}},queryParameters:[rZ,mZ],urlParameters:[nZ],headerParameters:[oZ,lZ],isXML:!0,serializer:KX},nK={path:"/",httpMethod:"POST",responses:{202:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:Dq},default:{bodyMapper:VU,headersMapper:zq}},requestBody:vZ,queryParameters:[aZ,gZ],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,yZ,_Z],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:KX},iK={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:YU,headersMapper:Lq},default:{bodyMapper:VU,headersMapper:Bq}},queryParameters:[aZ,hZ,dZ,xZ,bZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:KX},rK=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"create",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,oK)}},{key:"getProperties",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,sK)}},{key:"delete",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,lK)}},{key:"setMetadata",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,uK)}},{key:"getAccessPolicy",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,cK)}},{key:"setAccessPolicy",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,hK)}},{key:"restore",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,dK)}},{key:"rename",value:function(e,t){var n={sourceContainerName:e,options:uU(t||{})};return this.client.sendOperationRequest(n,fK)}},{key:"submitBatch",value:function(e,t,n,i){var r={contentLength:e,multipartContentType:t,body:n,options:uU(i||{})};return this.client.sendOperationRequest(r,pK)}},{key:"filterBlobs",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,mK)}},{key:"acquireLease",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,vK)}},{key:"releaseLease",value:function(e,t){var n={leaseId:e,options:uU(t||{})};return this.client.sendOperationRequest(n,gK)}},{key:"renewLease",value:function(e,t){var n={leaseId:e,options:uU(t||{})};return this.client.sendOperationRequest(n,yK)}},{key:"breakLease",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,_K)}},{key:"changeLease",value:function(e,t,n){var i={leaseId:e,proposedLeaseId:t,options:uU(n||{})};return this.client.sendOperationRequest(i,xK)}},{key:"listBlobFlatSegment",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,bK)}},{key:"listBlobHierarchySegment",value:function(e,t){var n={delimiter:e,options:uU(t||{})};return this.client.sendOperationRequest(n,wK)}},{key:"getAccountInfo",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,kK)}}]),e}(),aK=new SU(r,!0),oK={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:Fq},default:{bodyMapper:VU,headersMapper:jq}},queryParameters:[aZ,wZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,CZ,{parameterPath:["options","containerEncryptionScope","defaultEncryptionScope"],mapper:{serializedName:"x-ms-default-encryption-scope",xmlName:"x-ms-default-encryption-scope",type:{name:"String"}}},{parameterPath:["options","containerEncryptionScope","preventEncryptionScopeOverride"],mapper:{serializedName:"x-ms-deny-encryption-scope-override",xmlName:"x-ms-deny-encryption-scope-override",type:{name:"Boolean"}}}],isXML:!0,serializer:aK},sK={path:"/{containerName}",httpMethod:"GET",responses:{200:{headersMapper:Hq},default:{bodyMapper:VU,headersMapper:Vq}},queryParameters:[aZ,wZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ],isXML:!0,serializer:aK},lK={path:"/{containerName}",httpMethod:"DELETE",responses:{202:{headersMapper:Uq},default:{bodyMapper:VU,headersMapper:qq}},queryParameters:[aZ,wZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ],isXML:!0,serializer:aK},uK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:Gq},default:{bodyMapper:VU,headersMapper:Wq}},queryParameters:[aZ,wZ,PZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,SZ,TZ],isXML:!0,serializer:aK},cK={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}},serializedName:"SignedIdentifiers",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier"},headersMapper:Zq},default:{bodyMapper:VU,headersMapper:Xq}},queryParameters:[aZ,wZ,MZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ],isXML:!0,serializer:aK},hK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:Kq},default:{bodyMapper:VU,headersMapper:Yq}},requestBody:{parameterPath:["options","containerAcl"],mapper:{serializedName:"containerAcl",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier",type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}}}},queryParameters:[aZ,wZ,MZ],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,CZ,SZ,TZ,EZ],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:aK},dK={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:Jq},default:{bodyMapper:VU,headersMapper:Qq}},queryParameters:[aZ,wZ,IZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,{parameterPath:["options","deletedContainerName"],mapper:{serializedName:"x-ms-deleted-container-name",xmlName:"x-ms-deleted-container-name",type:{name:"String"}}},{parameterPath:["options","deletedContainerVersion"],mapper:{serializedName:"x-ms-deleted-container-version",xmlName:"x-ms-deleted-container-version",type:{name:"String"}}}],isXML:!0,serializer:aK},fK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:$q},default:{bodyMapper:VU,headersMapper:eG}},queryParameters:[aZ,wZ,{parameterPath:"comp",mapper:{defaultValue:"rename",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,{parameterPath:"sourceContainerName",mapper:{serializedName:"x-ms-source-container-name",required:!0,xmlName:"x-ms-source-container-name",type:{name:"String"}}},{parameterPath:["options","sourceLeaseId"],mapper:{serializedName:"x-ms-source-lease-id",xmlName:"x-ms-source-lease-id",type:{name:"String"}}}],isXML:!0,serializer:aK},pK={path:"/{containerName}",httpMethod:"POST",responses:{202:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:tG},default:{bodyMapper:VU,headersMapper:nG}},requestBody:vZ,queryParameters:[aZ,gZ,wZ],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,yZ,_Z],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:aK},mK={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:YU,headersMapper:iG},default:{bodyMapper:VU,headersMapper:rG}},queryParameters:[aZ,hZ,dZ,xZ,bZ,wZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:aK},vK={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:aG},default:{bodyMapper:VU,headersMapper:oG}},queryParameters:[aZ,wZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,RZ,OZ,NZ],isXML:!0,serializer:aK},gK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:sG},default:{bodyMapper:VU,headersMapper:lG}},queryParameters:[aZ,wZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,DZ,zZ],isXML:!0,serializer:aK},yK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:uG},default:{bodyMapper:VU,headersMapper:cG}},queryParameters:[aZ,wZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,zZ,LZ],isXML:!0,serializer:aK},_K={path:"/{containerName}",httpMethod:"PUT",responses:{202:{headersMapper:hG},default:{bodyMapper:VU,headersMapper:dG}},queryParameters:[aZ,wZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,BZ,FZ],isXML:!0,serializer:aK},xK={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:fG},default:{bodyMapper:VU,headersMapper:pG}},queryParameters:[aZ,wZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,zZ,jZ,HZ],isXML:!0,serializer:aK},bK={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:nq,headersMapper:mG},default:{bodyMapper:VU,headersMapper:vG}},queryParameters:[aZ,uZ,cZ,hZ,dZ,wZ,VZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:aK},wK={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:sq,headersMapper:gG},default:{bodyMapper:VU,headersMapper:yG}},queryParameters:[aZ,uZ,cZ,hZ,dZ,wZ,VZ,{parameterPath:"delimiter",mapper:{serializedName:"delimiter",required:!0,xmlName:"delimiter",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:aK},kK={path:"/{containerName}",httpMethod:"GET",responses:{200:{headersMapper:_G},default:{bodyMapper:VU,headersMapper:xG}},queryParameters:[rZ,mZ],urlParameters:[nZ],headerParameters:[oZ,lZ],isXML:!0,serializer:aK};function CK(e){return function(t,n){var i,r=rU.getTracer("azure/core-tracing",void 0),a=(null==n?void 0:n.tracingOptions)||{},o=Object.assign({kind:JV.INTERNAL},a.spanOptions),s=e.packagePrefix?"".concat(e.packagePrefix,".").concat(t):t;i=function(){var e;if("undefined"==typeof process)return!1;var t=null===(e=process.env.AZURE_TRACING_DISABLED)||void 0===e?void 0:e.toLowerCase();return"false"!==t&&"0"!==t&&Boolean(t)}()?rU.wrapSpanContext(BV):r.startSpan(s,o,a.tracingContext),e.namespace&&i.setAttribute("az.namespace",e.namespace);var l=a.spanOptions||{};i.isRecording()&&e.namespace&&(l=Object.assign(Object.assign({},a.spanOptions),{attributes:Object.assign(Object.assign({},o.attributes),{"az.namespace":e.namespace})}));var u=Object.assign(Object.assign({},a),{spanOptions:l,tracingContext:oU(a.tracingContext||lU.active(),i)});return{span:i,updatedOptions:Object.assign(Object.assign({},n),{tracingOptions:u})}}}var SK,TK="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,EK=[],PK=[],MK=[];TK&&AK(TK);var IK=Object.assign((function(e){return OK(e)}),{enable:AK,enabled:RK,disable:function(){var e=SK||"";return AK(""),e},log:function(){if(arguments.length>0){var e,t,n,i,r=String(arguments.length<=0?void 0:arguments[0]);r.includes(":error")?(e=console).error.apply(e,arguments):r.includes(":warning")?(t=console).warn.apply(t,arguments):r.includes(":info")?(n=console).info.apply(n,arguments):(r.includes(":verbose"),(i=console).debug.apply(i,arguments))}}});function AK(e){SK=e,EK=[],PK=[];var t,n=/\*/g,i=_createForOfIteratorHelper(e.split(",").map((function(e){return e.trim().replace(n,".*?")})));try{for(i.s();!(t=i.n()).done;){var r=t.value;r.startsWith("-")?PK.push(new RegExp("^".concat(r.substr(1),"$"))):EK.push(new RegExp("^".concat(r,"$")))}}catch(U5){i.e(U5)}finally{i.f()}var a,o=_createForOfIteratorHelper(MK);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.enabled=RK(s.namespace)}}catch(U5){o.e(U5)}finally{o.f()}}function RK(e){if(e.endsWith("*"))return!0;var t,n=_createForOfIteratorHelper(PK);try{for(n.s();!(t=n.n()).done;){if(t.value.test(e))return!1}}catch(U5){n.e(U5)}finally{n.f()}var i,r=_createForOfIteratorHelper(EK);try{for(r.s();!(i=r.n()).done;){if(i.value.test(e))return!0}}catch(U5){r.e(U5)}finally{r.f()}return!1}function OK(e){var t=Object.assign((function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.enabled&&(i.length>0&&(i[0]="".concat(e," ").concat(i[0])),t.log.apply(t,i))}),{enabled:RK(e),destroy:NK,log:IK.log,namespace:e,extend:DK});return MK.push(t),t}function NK(){var e=MK.indexOf(this);return e>=0&&(MK.splice(e,1),!0)}function DK(e){var t=OK("".concat(this.namespace,":").concat(e));return t.log=this.log,t}var zK,LK=IK,BK=new Set,FK="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,jK=LK("azure");jK.log=function(){LK.log.apply(LK,arguments)};var HK=["verbose","info","warning","error"];FK&&(ZK(FK)?function(e){if(e&&!ZK(e))throw new Error("Unknown log level '".concat(e,"'. Acceptable values: ").concat(HK.join(",")));zK=e;var t,n=[],i=_createForOfIteratorHelper(BK);try{for(i.s();!(t=i.n()).done;){var r=t.value;WK(r)&&n.push(r.namespace)}}catch(U5){i.e(U5)}finally{i.f()}LK.enable(n.join(","))}(FK):console.error("AZURE_LOG_LEVEL set to unknown log level '".concat(FK,"'; logging is not enabled. Acceptable values: ").concat(HK.join(", "),".")));var VK={verbose:400,info:300,warning:200,error:100};function UK(e){var t=jK.extend(e);return qK(jK,t),{error:GK(t,"error"),warning:GK(t,"warning"),info:GK(t,"info"),verbose:GK(t,"verbose")}}function qK(e,t){t.log=function(){e.log.apply(e,arguments)}}function GK(e,t){var n=Object.assign(e.extend(t),{level:t});if(qK(e,n),WK(n)){var i=LK.disable();LK.enable(i+","+n.namespace)}return BK.add(n),n}function WK(e){return Boolean(zK&&VK[e.level]<=VK[zK])}function ZK(e){return HK.includes(e)}var XK=UK("core-http"),KK=CK({packagePrefix:"",namespace:""});function YK(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{create:function(t,n){return new JK(t,n,e)}}}var JK=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).userAgent=i.userAgent,r}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.tracingContext){e.next=2;break}return e.abrupt("return",this._nextPolicy.sendRequest(t));case 2:if(n=this.tryCreateSpan(t)){e.next=5;break}return e.abrupt("return",this._nextPolicy.sendRequest(t));case 5:return e.prev=5,e.next=8,this._nextPolicy.sendRequest(t);case 8:return i=e.sent,e.abrupt("return",(this.tryProcessResponse(n,i),i));case 12:throw e.prev=12,e.t0=e.catch(5),this.tryProcessError(n,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(e){return n.apply(this,arguments)})},{key:"tryCreateSpan",value:function(e){var t;try{var n=KK("HTTP "+e.method,{tracingOptions:{spanOptions:Object.assign(Object.assign({},e.spanOptions),{kind:JV.CLIENT}),tracingContext:e.tracingContext}}).span;if(!n.isRecording())return void n.end();var i=null===(t=e.tracingContext)||void 0===t?void 0:t.getValue(Symbol.for("az.namespace"));"string"==typeof i&&n.setAttribute("az.namespace",i),n.setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&n.setAttribute("http.user_agent",this.userAgent);var r=n.spanContext(),a=function(e){var t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),!t.length){var n=(e.traceFlags||0).toString(16);return"00-".concat(e.traceId,"-").concat(e.spanId,"-").concat(1===n.length?"0"+n:n)}}(r);if(a&&rU.isSpanContextValid(r)){e.headers.set("traceparent",a);var o=r.traceState&&r.traceState.serialize();o&&e.headers.set("tracestate",o)}return n}catch(s){return void XK.warning("Skipping creating a tracing span due to an error: "+s.message)}}},{key:"tryProcessError",value:function(e,t){try{e.setStatus({code:sU.ERROR,message:t.message}),t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){XK.warning("Skipping tracing span processing due to an error: "+n.message)}}},{key:"tryProcessResponse",value:function(e,t){try{e.setAttribute("http.status_code",t.status);var n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({code:sU.OK}),e.end()}catch(i){XK.warning("Skipping tracing span processing due to an error: "+i.message)}}}]),t}(hV),QK={enable:!0},$K=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).keepAliveOptions=i,r}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t.keepAlive=this.keepAliveOptions.enable,this._nextPolicy.sendRequest(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV);function eY(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x-ms-client-request-id";return{create:function(t,n){return new tY(t,n,e)}}}var tY=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n]))._requestIdHeaderName=i,r}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)}}]),t}(hV),nY=function(){function e(){_classCallCheck(this,e),this._rawQuery={}}return _createClass(e,[{key:"any",value:function(){return Object.keys(this._rawQuery).length>0}},{key:"keys",value:function(){return Object.keys(this._rawQuery)}},{key:"set",value:function(e,t){var n=t;if(e)if(null!=n){var i=Array.isArray(n)?n:n.toString();this._rawQuery[e]=i}else delete this._rawQuery[e]}},{key:"get",value:function(e){return e?this._rawQuery[e]:void 0}},{key:"toString",value:function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var n=this._rawQuery[t];if(Array.isArray(n)){var i,r=[],a=_createForOfIteratorHelper(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;r.push("".concat(t,"=").concat(o))}}catch(U5){a.e(U5)}finally{a.f()}e+=r.join("&")}else e+="".concat(t,"=").concat(n)}return e}}],[{key:"parse",value:function(t){var n=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var i="ParameterName",r="",a="",o=0;o<t.length;++o){var s=t[o];switch(i){case"ParameterName":switch(s){case"=":i="ParameterValue";break;case"&":r="",a="";break;default:r+=s}break;case"ParameterValue":switch(s){case"&":n.set(r,a),r="",a="",i="ParameterName";break;default:a+=s}break;default:throw new Error("Unrecognized URLQuery parse state: "+i)}}"ParameterValue"===i&&n.set(r,a)}return n}}]),e}(),iY=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"setScheme",value:function(e){e?this.set(e,"SCHEME"):this._scheme=void 0}},{key:"getScheme",value:function(){return this._scheme}},{key:"setHost",value:function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0}},{key:"getHost",value:function(){return this._host}},{key:"setPort",value:function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")}},{key:"getPort",value:function(){return this._port}},{key:"setPath",value:function(e){if(e){var t=e.indexOf("://");if(-1!==t){var n=e.lastIndexOf("/",t);this.set(-1===n?e:e.substr(n+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0}},{key:"appendPath",value:function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}}},{key:"getPath",value:function(){return this._path}},{key:"setQuery",value:function(e){this._query=e?nY.parse(e):void 0}},{key:"setQueryParameter",value:function(e,t){e&&(this._query||(this._query=new nY),this._query.set(e,t))}},{key:"getQueryParameterValue",value:function(e){return this._query?this._query.get(e):void 0}},{key:"getQuery",value:function(){return this._query?this._query.toString():void 0}},{key:"set",value:function(e,t){for(var n=new aY(e,t);n.next();){var i=n.current(),r=void 0;if(i)switch(i.type){case"SCHEME":this._scheme=i.text||void 0;break;case"HOST":this._host=i.text||void 0;break;case"PORT":this._port=i.text||void 0;break;case"PATH":r=i.text||void 0,this._path&&"/"!==this._path&&"/"===r||(this._path=r);break;case"QUERY":this._query=nY.parse(i.text);break;default:throw new Error("Unrecognized URLTokenType: "+i.type)}}}},{key:"toString",value:function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e}},{key:"replaceAll",value:function(e,t){e&&(this.setScheme(CU(this.getScheme(),e,t)),this.setHost(CU(this.getHost(),e,t)),this.setPort(CU(this.getPort(),e,t)),this.setPath(CU(this.getPath(),e,t)),this.setQuery(CU(this.getQuery(),e,t)))}}],[{key:"parse",value:function(t){var n=new e;return n.set(t,"SCHEME_OR_HOST"),n}}]),e}(),rY=function(){function e(t,n){_classCallCheck(this,e),this.text=t,this.type=n}return _createClass(e,null,[{key:"scheme",value:function(t){return new e(t,"SCHEME")}},{key:"host",value:function(t){return new e(t,"HOST")}},{key:"port",value:function(t){return new e(t,"PORT")}},{key:"path",value:function(t){return new e(t,"PATH")}},{key:"query",value:function(t){return new e(t,"QUERY")}}]),e}(),aY=function(){function e(t,n){_classCallCheck(this,e),this._text=t,this._textLength=t?t.length:0,this._currentState=null!=n?n:"SCHEME_OR_HOST",this._currentIndex=0}return _createClass(e,[{key:"current",value:function(){return this._currentToken}},{key:"next",value:function(){if(oY(this))switch(this._currentState){case"SCHEME":t=function(e){return cY(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=rY.scheme(t),e._currentState=oY(e)?"HOST":"DONE";break;case"SCHEME_OR_HOST":!function(e){var t=hY(e,":","/","?");oY(e)?":"===sY(e)?"://"===uY(e,3)?(e._currentToken=rY.scheme(t),e._currentState="HOST"):(e._currentToken=rY.host(t),e._currentState="PORT"):(e._currentToken=rY.host(t),e._currentState="/"===sY(e)?"PATH":"QUERY"):(e._currentToken=rY.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===uY(e,3)&&lY(e,3);var t=hY(e,":","/","?");e._currentToken=rY.host(t),e._currentState=oY(e)?":"===sY(e)?"PORT":"/"===sY(e)?"PATH":"QUERY":"DONE"}(this);break;case"PORT":!function(e){":"===sY(e)&&lY(e);var t=hY(e,"/","?");e._currentToken=rY.port(t),e._currentState=oY(e)?"/"===sY(e)?"PATH":"QUERY":"DONE"}(this);break;case"PATH":!function(e){var t=hY(e,"?");e._currentToken=rY.path(t),e._currentState=oY(e)?"QUERY":"DONE"}(this);break;case"QUERY":!function(e){"?"===sY(e)&&lY(e);var t=function(e){var t="";return e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength),t}(e);e._currentToken=rY.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken}}]),e}();function oY(e){return e._currentIndex<e._textLength}function sY(e){return e._text[e._currentIndex]}function lY(e,t){oY(e)&&(t||(t=1),e._currentIndex+=t)}function uY(e,t){var n=e._currentIndex+t;return e._textLength<n&&(n=e._textLength),e._text.substring(e._currentIndex,n)}function cY(e,t){for(var n="";oY(e);){var i=sY(e);if(!t(i))break;n+=i,lY(e)}return n}function hY(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return cY(e,(function(e){return-1===n.indexOf(e)}))}var dY,fY,pY,mY,vY,gY=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],yY=["api-version"],_Y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.allowedHeaderNames,i=void 0===n?[]:n,r=t.allowedQueryParameters,a=void 0===r?[]:r;_classCallCheck(this,e),i=Array.isArray(i)?gY.concat(i):gY,a=Array.isArray(a)?yY.concat(a):yY,this.allowedHeaderNames=new Set(i.map((function(e){return e.toLowerCase()}))),this.allowedQueryParameters=new Set(a.map((function(e){return e.toLowerCase()})))}return _createClass(e,[{key:"sanitize",value:function(e){var t=this,n=new Set;return JSON.stringify(e,(function(e,i){if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if("_headersMap"===e)return t.sanitizeHeaders(i);if("url"===e)return t.sanitizeUrl(i);if("query"===e)return t.sanitizeQuery(i);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(i)||!("object"!=typeof(r=i)||null===r||Array.isArray(r)||r instanceof RegExp||r instanceof Date)){if(n.has(i))return"[Circular]";n.add(i)}var r;return i}}),2)}},{key:"sanitizeHeaders",value:function(e){return this.sanitizeObject(e,this.allowedHeaderNames,(function(e,t){return e[t].value}))}},{key:"sanitizeQuery",value:function(e){return this.sanitizeObject(e,this.allowedQueryParameters,(function(e,t){return e[t]}))}},{key:"sanitizeObject",value:function(e,t,n){if("object"!=typeof e||null===e)return e;for(var i={},r=0,a=Object.keys(e);r<a.length;r++){var o=a[r];i[o]=t.has(o.toLowerCase())?n(e,o):"REDACTED"}return i}},{key:"sanitizeUrl",value:function(e){if("string"!=typeof e||null===e)return e;var t=iY.parse(e),n=t.getQuery();if(!n)return e;var i,r=nY.parse(n),a=_createForOfIteratorHelper(r.keys());try{for(a.s();!(i=a.n()).done;){var o=i.value;this.allowedQueryParameters.has(o.toLowerCase())||r.set(o,"REDACTED")}}catch(U5){a.e(U5)}finally{a.f()}return t.setQuery(r.toString()),t.toString()}}]),e}(),xY={},bY=new _Y,wY=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).name="RestError",o.code=n,o.statusCode=i,o.request=r,o.response=a,Object.setPrototypeOf(_assertThisInitialized2(o),t.prototype),o}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t,[{key:xY,value:function(){return"RestError: ".concat(this.message," \n ").concat(bY.sanitize(this))}}]),t}();if(wY.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",wY.PARSE_ERROR="PARSE_ERROR",!(self.document&&self.DOMParser&&self.Node&&self.XMLSerializer))throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');function kY(){return dY||(dY=document.implementation.createDocument(null,null,null)),dY}function CY(){return fY||(fY=new DOMParser),fY}function SY(e){var t,n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={rootName:null!==(t=r.rootName)&&void 0!==t?t:"root",includeRoot:null!==(n=r.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(i=r.xmlCharKey)&&void 0!==i?i:"_"},o=function e(t,n,i){if(null==t||"string"==typeof t||"number"==typeof t||"boolean"==typeof t){var r=kY().createElement(n);return r.textContent=null==t?"":t.toString(),[r]}if(Array.isArray(t)){var a,o=[],s=_createForOfIteratorHelper(t);try{for(s.s();!(a=s.n()).done;){var l,u=_createForOfIteratorHelper(e(a.value,n,i));try{for(u.s();!(l=u.n()).done;){var c=l.value;o.push(c)}}catch(U5){u.e(U5)}finally{u.f()}}}catch(U5){s.e(U5)}finally{s.f()}return o}if("object"==typeof t){for(var h=kY().createElement(n),d=0,f=Object.keys(t);d<f.length;d++){var p=f[d];if(p===fU){var m,v=_createForOfIteratorHelper(TY(t[p]));try{for(v.s();!(m=v.n()).done;){var g=m.value;h.attributes.setNamedItem(g)}}catch(U5){v.e(U5)}finally{v.f()}}else if(p===i.xmlCharKey)h.textContent=t[p].toString();else{var y,_=_createForOfIteratorHelper(e(t[p],p,i));try{for(_.s();!(y=_.n()).done;){var x=y.value;h.appendChild(x)}}catch(U5){_.e(U5)}finally{_.f()}}}return[h]}throw new Error("Illegal value passed to buildObject: "+t)}(e,a.rootName,a)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(pY||(pY=new XMLSerializer),pY).serializeToString(o)}function TY(e){for(var t=[],n=0,i=Object.keys(e);n<i.length;n++){var r=i[n],a=kY().createAttribute(r);a.value=e[r].toString(),t.push(a)}return t}function EY(e,t){return{create:function(n,i){return new IY(n,i,e,t)}}}void 0!==self.trustedTypes&&(mY=self.trustedTypes.createPolicy("@azure/core-http#xml.browser",{createHTML:function(e){return e}}));var PY=["application/json","text/json"],MY=["application/xml","application/atom+xml"],IY=function(e){function t(e,n,i){var r,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).jsonContentTypes=i&&i.json||PY,r.xmlContentTypes=i&&i.xml||MY,r.xmlCharKey=null!==(a=o.xmlCharKey)&&void 0!==a?a:"_",r}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._nextPolicy.sendRequest(t).then((function(e){return function(e,t,n){var i,r,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s={rootName:null!==(i=o.rootName)&&void 0!==i?i:"",includeRoot:null!==(r=o.includeRoot)&&void 0!==r&&r,xmlCharKey:null!==(a=o.xmlCharKey)&&void 0!==a?a:"_"};return function(e,t,n,i){var r,a=function(e){var t=new wY('Error "'.concat(e,'" occurred while parsing the response body - ').concat(n.bodyAsText,"."),e.code||wY.PARSE_ERROR,n.status,n.request,n);return Promise.reject(t)};if(!(null===(r=n.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(n.status))&&!n.request.streamResponseBody&&n.bodyAsText){var o=n.bodyAsText,s=n.headers.get("Content-Type")||"",l=s?s.split(";").map((function(e){return e.toLowerCase()})):[];if(0===l.length||l.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){n.parsedBody=JSON.parse(o),e(n)})).catch(a);if(l.some((function(e){return-1!==t.indexOf(e)})))return function(e){var t,n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var o,s={rootName:null!==(t=a.rootName)&&void 0!==t?t:"",includeRoot:null!==(n=a.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(i=a.xmlCharKey)&&void 0!==i?i:"_"},l=CY().parseFromString(null!==(r=null==mY?void 0:mY.createHTML(e))&&void 0!==r?r:e,"application/xml");return function(e){var t=e.getElementsByTagName("parsererror");if(t.length>0&&function(){var e,t;if(void 0===vY)try{var n=null!==(e=null==mY?void 0:mY.createHTML("INVALID"))&&void 0!==e?e:"INVALID";vY=null!==(t=CY().parseFromString(n,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==t?t:""}catch(i){vY=""}return vY}())for(var n=0;n<t.length;n++)if(t[n].namespaceURI===vY)throw new Error(t[n].innerHTML)}(l),o=function e(t,n){var i={},r=t.childNodes.length,a=t.childNodes[0],o=a&&1===r&&a.nodeType===Node.TEXT_NODE&&a.nodeValue||void 0,s=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(t);if(s){i[fU]={};for(var l=0;l<s.attributes.length;l++){var u=s.attributes[l];i[fU][u.nodeName]=u.nodeValue}o&&(i[n.xmlCharKey]=o)}else 0===r?i="":o&&(i=o);if(!o)for(var c=0;c<r;c++){var h=t.childNodes[c];if(h.nodeType!==Node.TEXT_NODE){var d=e(h,n);i[h.nodeName]?Array.isArray(i[h.nodeName])?i[h.nodeName].push(d):i[h.nodeName]=[i[h.nodeName],d]:i[h.nodeName]=d}}return i}(s.includeRoot?l:l.childNodes[0],s),Promise.resolve(o)}catch(U5){return Promise.reject(U5)}}(o,i).then((function(e){return n.parsedBody=e,n})).catch(a)}return Promise.resolve(n)}(e,t,n,s).then((function(e){if(!function(e){var t=e.request.shouldDeserialize;return void 0===t||("boolean"==typeof t?t:t(e))}(e))return e;var t=e.request.operationSpec;if(!t||!t.responses)return e;var i=function(e){var t,n=e.request,i=n.operationSpec;if(i){var r=n.operationResponseGetter;t=r?r(i,e):i.responses[e.status]}return t}(e),r=function(e,t,n){var i,r=200<=e.status&&e.status<300;if(function(e){var t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?r:n){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}var a=null!=n?n:t.responses.default,o=(null===(i=e.request.streamResponseStatusCodes)||void 0===i?void 0:i.has(e.status))||e.request.streamResponseBody,s=new wY(o?"Unexpected status code: "+e.status:e.bodyAsText,void 0,e.status,e.request,e);if(!a)throw s;var l=a.bodyMapper,u=a.headersMapper;try{if(e.parsedBody){var c,h=e.parsedBody;if(l){var d=h;t.isXML&&l.type.name===DU.Sequence&&(d="object"==typeof h?h[l.xmlElementName]:[]),c=t.serializer.deserialize(l,d,"error.response.parsedBody")}var f=h.error||c||h;s.code=f.code,f.message&&(s.message=f.message),l&&(s.response.parsedBody=c)}e.headers&&u&&(s.response.parsedHeaders=t.serializer.deserialize(u,e.headers.toJson(),"operationRes.parsedHeaders"))}catch(p){s.message='Error "'.concat(p.message,'" occurred in deserializing the responseBody - "').concat(e.bodyAsText,'" for the default response.')}return{error:s,shouldReturnResponse:!1}}(e,t,i),a=r.error,s=r.shouldReturnResponse;if(a)throw a;if(s)return e;if(i){if(i.bodyMapper){var l=e.parsedBody;t.isXML&&i.bodyMapper.type.name===DU.Sequence&&(l="object"==typeof l?l[i.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(i.bodyMapper,l,"operationRes.parsedBody",o)}catch(u){throw new wY("Error ".concat(u," occurred in deserializing the responseBody - ").concat(e.bodyAsText),void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=n.status>=200&&n.status<300);i.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(i.headersMapper,e.headers.toJson(),"operationRes.parsedHeaders",o))}return e}))}(n.jsonContentTypes,n.xmlContentTypes,e,{xmlCharKey:n.xmlCharKey})})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV);function AY(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{create:function(t,n){return new RY(t,n,e)}}}var RY=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.logger,o=void 0===a?XK.info:a,s=r.allowedHeaderNames,l=void 0===s?[]:s,u=r.allowedQueryParameters,c=void 0===u?[]:u;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).logger=o,i.sanitizer=new _Y({allowedHeaderNames:l,allowedQueryParameters:c}),i}return _inherits(t,e),_createClass(t,[{key:"allowedHeaderNames",get:function(){return this.sanitizer.allowedHeaderNames},set:function(e){this.sanitizer.allowedHeaderNames=e}},{key:"allowedQueryParameters",get:function(){return this.sanitizer.allowedQueryParameters},set:function(e){this.sanitizer.allowedQueryParameters=e}},{key:"sendRequest",value:function(e){var t=this;return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then((function(e){return t.logResponse(e)}))):this._nextPolicy.sendRequest(e)}},{key:"logRequest",value:function(e){this.logger("Request: "+this.sanitizer.sanitize(e))}},{key:"logResponse",value:function(e){return this.logger("Response status code: "+e.status),this.logger("Headers: "+this.sanitizer.sanitize(e.headers)),e}}]),t}(hV),OY=UK("storage-blob"),NY=["Access-Control-Allow-Origin","Cache-Control","Content-Length","Content-Type","Date","Request-Id","traceparent","Transfer-Encoding","User-Agent","x-ms-client-request-id","x-ms-date","x-ms-error-code","x-ms-request-id","x-ms-return-client-request-id","x-ms-version","Accept-Ranges","Content-Disposition","Content-Encoding","Content-Language","Content-MD5","Content-Range","ETag","Last-Modified","Server","Vary","x-ms-content-crc64","x-ms-copy-action","x-ms-copy-completion-time","x-ms-copy-id","x-ms-copy-progress","x-ms-copy-status","x-ms-has-immutability-policy","x-ms-has-legal-hold","x-ms-lease-state","x-ms-lease-status","x-ms-range","x-ms-request-server-encrypted","x-ms-server-encrypted","x-ms-snapshot","x-ms-source-range","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","x-ms-access-tier","x-ms-access-tier-change-time","x-ms-access-tier-inferred","x-ms-account-kind","x-ms-archive-status","x-ms-blob-append-offset","x-ms-blob-cache-control","x-ms-blob-committed-block-count","x-ms-blob-condition-appendpos","x-ms-blob-condition-maxsize","x-ms-blob-content-disposition","x-ms-blob-content-encoding","x-ms-blob-content-language","x-ms-blob-content-length","x-ms-blob-content-md5","x-ms-blob-content-type","x-ms-blob-public-access","x-ms-blob-sequence-number","x-ms-blob-type","x-ms-copy-destination-snapshot","x-ms-creation-time","x-ms-default-encryption-scope","x-ms-delete-snapshots","x-ms-delete-type-permanent","x-ms-deny-encryption-scope-override","x-ms-encryption-algorithm","x-ms-if-sequence-number-eq","x-ms-if-sequence-number-le","x-ms-if-sequence-number-lt","x-ms-incremental-copy","x-ms-lease-action","x-ms-lease-break-period","x-ms-lease-duration","x-ms-lease-id","x-ms-lease-time","x-ms-page-write","x-ms-proposed-lease-id","x-ms-range-get-content-md5","x-ms-rehydrate-priority","x-ms-sequence-number-action","x-ms-sku-name","x-ms-source-content-md5","x-ms-source-if-match","x-ms-source-if-modified-since","x-ms-source-if-none-match","x-ms-source-if-unmodified-since","x-ms-tag-count","x-ms-encryption-key-sha256","x-ms-if-tags","x-ms-source-if-tags"],DY=["comp","maxresults","rscc","rscd","rsce","rscl","rsct","se","si","sip","sp","spr","sr","srt","ss","st","sv","include","marker","prefix","copyid","restype","blockid","blocklisttype","delimiter","prevsnapshot","ske","skoid","sks","skt","sktid","skv","snapshot"],zY=["10000","10001","10002","10003","10004","10100","10101","10102","10103","10104","11000","11001","11002","11003","11004","11100","11101","11102","11103","11104"];function LY(e){return e.toLowerCase()}function BY(e){if(e&&"object"==typeof e){var t=e;if("function"==typeof t.rawHeaders&&"function"==typeof t.clone&&"function"==typeof t.get&&"function"==typeof t.set&&"function"==typeof t.contains&&"function"==typeof t.remove&&"function"==typeof t.headersArray&&"function"==typeof t.headerValues&&"function"==typeof t.headerNames&&"function"==typeof t.toJson)return!0}return!1}var FY=function(){function e(t){if(_classCallCheck(this,e),this._headersMap={},t)for(var n in t)this.set(n,t[n])}return _createClass(e,[{key:"set",value:function(e,t){this._headersMap[LY(e)]={name:e,value:t.toString().trim()}}},{key:"get",value:function(e){var t=this._headersMap[LY(e)];return t?t.value:void 0}},{key:"contains",value:function(e){return!!this._headersMap[LY(e)]}},{key:"remove",value:function(e){var t=this.contains(e);return delete this._headersMap[LY(e)],t}},{key:"rawHeaders",value:function(){return this.toJson({preserveCase:!0})}},{key:"headersArray",value:function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e}},{key:"headerNames",value:function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].name);return e}},{key:"headerValues",value:function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].value);return e}},{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};if(e.preserveCase)for(var n in this._headersMap){var i=this._headersMap[n];t[i.name]=i.value}else for(var r in this._headersMap){var a=this._headersMap[r];t[LY(a.name)]=a.value}return t}},{key:"toString",value:function(){return JSON.stringify(this.toJson({preserveCase:!0}))}},{key:"clone",value:function(){var t={};for(var n in this._headersMap){var i=this._headersMap[n];t[i.name]=i.value}return new e(t)}}]),e}();function jY(e,t){var n,i=_createForOfIteratorHelper(e.split(";"));try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.trim().startsWith(t))return r.trim().match(t+"=(.*)")[1]}}catch(U5){i.e(U5)}finally{i.f()}return""}function HY(e){var t="";e.startsWith("UseDevelopmentStorage=true")&&(t=function(e){var t="";if(-1!==e.search("DevelopmentStorageProxyUri=")){var n,i=_createForOfIteratorHelper(e.split(";"));try{for(i.s();!(n=i.n()).done;){var r=n.value;r.trim().startsWith("DevelopmentStorageProxyUri=")&&(t=r.trim().match("DevelopmentStorageProxyUri=(.*)")[1])}}catch(U5){i.e(U5)}finally{i.f()}}return t}(e),e="DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;");var n=jY(e,"BlobEndpoint");if(n=n.endsWith("/")?n.slice(0,-1):n,-1!==e.search("DefaultEndpointsProtocol=")&&-1!==e.search("AccountKey=")){var i,r="",a=Buffer.from("accountKey","base64"),o="";if(i=jY(e,"AccountName"),a=Buffer.from(jY(e,"AccountKey"),"base64"),!n){var s=(r=jY(e,"DefaultEndpointsProtocol")).toLowerCase();if("https"!==s&&"http"!==s)throw new Error("Invalid DefaultEndpointsProtocol in the provided Connection String. Expecting 'https' or 'http'");if(!(o=jY(e,"EndpointSuffix")))throw new Error("Invalid EndpointSuffix in the provided Connection String");n="".concat(r,"://").concat(i,".blob.").concat(o)}if(!i)throw new Error("Invalid AccountName in the provided Connection String");if(0===a.length)throw new Error("Invalid AccountKey in the provided Connection String");return{kind:"AccountConnString",url:n,accountName:i,accountKey:a,proxyUri:t}}var l=jY(e,"SharedAccessSignature"),u=jY(e,"AccountName");if(u||(u=JY(n)),!n)throw new Error("Invalid BlobEndpoint in the provided SAS Connection String");if(!l)throw new Error("Invalid SharedAccessSignature in the provided SAS Connection String");return{kind:"SASConnString",url:n,accountName:u,accountSas:l}}function VY(e,t){var n=iY.parse(e),i=n.getPath();return i=i?i.endsWith("/")?"".concat(i).concat(t):"".concat(i,"/").concat(t):t,n.setPath(i),new URL(n.toString()).toString()}function UY(e,t,n){var i=iY.parse(e);return i.setQueryParameter(t,n),i.toString()}function qY(e,t){return iY.parse(e).getQueryParameterValue(t)}function GY(e){return iY.parse(e).getPath()}function WY(e){var t=iY.parse(e),n=t.getPath();if(!n)throw new RangeError("Invalid url without valid path.");var i=t.getQuery()||"";return""!==(i=i.trim())&&(i=i.startsWith("?")?i:"?"+i),"".concat(n).concat(i)}function ZY(e,t){var n=iY.parse(e),i=n.getQuery();return i?i+="&"+t:i=t,n.setQuery(i),n.toString()}function XY(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.toISOString();return t?n.substring(0,n.length-1)+"0000Z":n.substring(0,n.length-5)+"Z"}function KY(e,t){return e.length>42&&(e=e.slice(0,42)),n=e+function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return String.prototype.padStart?e.padStart(t,n):(n=n||" ",e.length>t?e:((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+e))}(t.toString(),48-e.length,"0"),uV?Buffer.from(n).toString("base64"):btoa(n);var n}function YY(e,t){return e.toLocaleLowerCase()===t.toLocaleLowerCase()}function JY(e){var t=iY.parse(e);try{return"blob"===t.getHost().split(".")[1]?t.getHost().split(".")[0]:QY(t)?t.getPath().split("/")[1]:""}catch(n){throw new Error("Unable to extract accountName with provided information.")}}function QY(e){if(void 0===e.getHost())return!1;var t=e.getHost()+(void 0===e.getPort()?"":":"+e.getPort());return/^.*:.*:.*$|^(localhost|host.docker.internal)(:[0-9]+)?$|^(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])){3}(:[0-9]+)?$/.test(t)||void 0!==e.getPort()&&zY.includes(e.getPort())}function $Y(e){if(void 0!==e){var t=[];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=e[n];t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i)))}return t.join("&")}}function eJ(e){if(void 0!==e){var t={blobTagSet:[]};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.blobTagSet.push({key:n,value:e[n]});return t}}function tJ(e){if(void 0!==e){var t,n={},i=_createForOfIteratorHelper(e.blobTagSet);try{for(i.s();!(t=i.n()).done;){var r=t.value;n[r.key]=r.value}}catch(U5){i.e(U5)}finally{i.f()}return n}}function nJ(e){if(void 0!==e)switch(e.kind){case"csv":return{format:{type:"delimited",delimitedTextConfiguration:{columnSeparator:e.columnSeparator||",",fieldQuote:e.fieldQuote||"",recordSeparator:e.recordSeparator,escapeChar:e.escapeCharacter||"",headersPresent:e.hasHeaders||!1}}};case"json":return{format:{type:"json",jsonTextConfiguration:{recordSeparator:e.recordSeparator}}};case"arrow":return{format:{type:"arrow",arrowConfiguration:{schema:e.schema}}};case"parquet":return{format:{type:"parquet"}};default:throw Error("Invalid BlobQueryTextConfiguration.")}}function iJ(e){if(e&&!("policy-id"in e)){var t=[],n=function(){var n=i.split("_");n[0].startsWith("or-")&&(n[0]=n[0].substring("or-".length));var r={ruleId:n[1],replicationStatus:e[i]},a=t.findIndex((function(e){return e.policyId===n[0]}));a>-1?t[a].rules.push(r):t.push({policyId:n[0],rules:[r]})};for(var i in e)n();return t}}function rJ(e,t){return e.credential=t,e}function aJ(e){return e?e.scheme+" "+e.value:void 0}function oJ(e){return e.encoded?decodeURIComponent(e.content):e.content}function sJ(e){var t;return Object.assign(Object.assign({},e),{segment:{blobPrefixes:null===(t=e.segment.blobPrefixes)||void 0===t?void 0:t.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name)})})),blobItems:e.segment.blobItems.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name)})}))}})}function lJ(e){var t,n,r,a;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=[],n=[],e.pageRange&&(t=e.pageRange),e.clearRange&&(n=e.clearRange),r=0,a=0;case 3:if(!(r<t.length&&a<n.length)){i.next=15;break}if(!(t[r].start<n[a].start)){i.next=10;break}return i.next=7,{start:t[r].start,end:t[r].end,isClear:!1};case 7:++r,i.next=13;break;case 10:return i.next=12,{start:n[a].start,end:n[a].end,isClear:!0};case 12:++a;case 13:i.next=3;break;case 15:if(!(r<t.length)){i.next=21;break}return i.next=18,{start:t[r].start,end:t[r].end,isClear:!1};case 18:++r,i.next=15;break;case 21:if(!(a<n.length)){i.next=27;break}return i.next=24,{start:n[a].start,end:n[a].end,isClear:!0};case 24:++a,i.next=21;break;case 27:case"end":return i.stop()}}),i)}function uJ(e){for(var t=e.split("/"),n=0;n<t.length;n++)t[n]=encodeURIComponent(t[n]);return t.join("/")}var cJ=function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t,[e,n])}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(uV||("GET"!==t.method.toUpperCase()&&"HEAD"!==t.method.toUpperCase()||(t.url=UY(t.url,"_",(new Date).getTime().toString())),t.headers.remove("Cookie"),t.headers.remove("Content-Length")),this._nextPolicy.sendRequest(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV),hJ=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e,t){return new cJ(e,t)}}]),e}();new WeakMap,new WeakMap;var dJ,fJ=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="AbortError",n}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t)}();!function(e){e[e.EXPONENTIAL=0]="EXPONENTIAL",e[e.FIXED=1]="FIXED"}(dJ||(dJ={}));var pJ={maxRetryDelayInMs:12e4,maxTries:4,retryDelayInMs:4e3,retryPolicyType:dJ.EXPONENTIAL,secondaryHost:"",tryTimeoutInMs:void 0},mJ=new fJ("The operation was aborted."),vJ=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pJ;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).retryOptions={retryPolicyType:r.retryPolicyType?r.retryPolicyType:pJ.retryPolicyType,maxTries:r.maxTries&&r.maxTries>=1?Math.floor(r.maxTries):pJ.maxTries,tryTimeoutInMs:r.tryTimeoutInMs&&r.tryTimeoutInMs>=0?r.tryTimeoutInMs:pJ.tryTimeoutInMs,retryDelayInMs:r.retryDelayInMs&&r.retryDelayInMs>=0?Math.min(r.retryDelayInMs,r.maxRetryDelayInMs?r.maxRetryDelayInMs:pJ.maxRetryDelayInMs):pJ.retryDelayInMs,maxRetryDelayInMs:r.maxRetryDelayInMs&&r.maxRetryDelayInMs>=0?r.maxRetryDelayInMs:pJ.maxRetryDelayInMs,secondaryHost:r.secondaryHost?r.secondaryHost:pJ.secondaryHost},i}var n,i,r;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.attemptSendRequest(t,!1,1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"attemptSendRequest",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.clone(),(a=n||!this.retryOptions.secondaryHost||!("GET"===t.method||"HEAD"===t.method||"OPTIONS"===t.method)||i%2==1)||(r.url=(s=r.url,l=this.retryOptions.secondaryHost,u=void 0,(u=iY.parse(s)).setHost(l),u.toString())),this.retryOptions.tryTimeoutInMs&&(r.url=UY(r.url,"timeout",Math.floor(this.retryOptions.tryTimeoutInMs/1e3).toString())),e.prev=2,OY.info("RetryPolicy: =====> Try=".concat(i," ").concat(a?"Primary":"Secondary")),e.next=6,this._nextPolicy.sendRequest(r);case 6:if(o=e.sent,this.shouldRetry(a,i,o)){e.next=9;break}return e.abrupt("return",o);case 9:n=n||!a&&404===o.status,e.next=16;break;case 12:if(e.prev=12,e.t0=e.catch(2),OY.error("RetryPolicy: Caught error, message: ".concat(e.t0.message,", code: ").concat(e.t0.code)),this.shouldRetry(a,i,o,e.t0)){e.next=16;break}throw e.t0;case 16:return e.next=18,this.delay(a,i,t.abortSignal);case 18:return e.abrupt("return",this.attemptSendRequest(t,n,++i));case 19:case"end":return e.stop()}var s,l,u}),e,this,[[2,12]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"shouldRetry",value:function(e,t,n,i){if(t>=this.retryOptions.maxTries)return OY.info("RetryPolicy: Attempt(s) ".concat(t," >= maxTries ").concat(this.retryOptions.maxTries,", no further try.")),!1;if(i){var r,a=_createForOfIteratorHelper(["ETIMEDOUT","ESOCKETTIMEDOUT","ECONNREFUSED","ECONNRESET","ENOENT","ENOTFOUND","TIMEOUT","EPIPE","REQUEST_SEND_ERROR"]);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(i.name.toUpperCase().includes(o)||i.message.toUpperCase().includes(o)||i.code&&i.code.toString().toUpperCase()===o)return OY.info("RetryPolicy: Network error ".concat(o," found, will retry.")),!0}}catch(i){a.e(i)}finally{a.f()}}if(n||i){var s=n?n.status:i?i.statusCode:0;if(!e&&404===s)return OY.info("RetryPolicy: Secondary access with 404, will retry."),!0;if(503===s||500===s)return OY.info("RetryPolicy: Will retry for status code ".concat(s,".")),!0}return!("PARSE_ERROR"!==(null==i?void 0:i.code)||!(null==i?void 0:i.message.startsWith('Error "Error: Unclosed root tag'))||(OY.info("RetryPolicy: Incomplete XML response likely due to service timeout, will retry."),0))}},{key:"delay",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=0,!t){e.next=10;break}e.t0=this.retryOptions.retryPolicyType,e.next=e.t0===dJ.EXPONENTIAL?5:e.t0===dJ.FIXED?7:8;break;case 5:return r=Math.min((Math.pow(2,n-1)-1)*this.retryOptions.retryDelayInMs,this.retryOptions.maxRetryDelayInMs),e.abrupt("break",8);case 7:r=this.retryOptions.retryDelayInMs;case 8:e.next=11;break;case 10:r=1e3*Math.random();case 11:return e.abrupt("return",(OY.info("RetryPolicy: Delay for ".concat(r,"ms")),function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var a,o=function(){void 0!==a&&clearTimeout(a),r(i)};a=setTimeout((function(){void 0!==n&&n.removeEventListener("abort",o),e()}),t),void 0!==n&&n.addEventListener("abort",o)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}()(r,i,mJ)));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}]),t}(hV),gJ=function(){function e(t){_classCallCheck(this,e),this.retryOptions=t}return _createClass(e,[{key:"create",value:function(e,t){return new vJ(e,t,this.retryOptions)}}]),e}(),yJ=function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t,[e,n])}return _inherits(t,e),_createClass(t)}(function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){return this._nextPolicy.sendRequest(this.signRequest(e))}},{key:"signRequest",value:function(e){return e}}]),t}(hV)),_J=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e,t){return new yJ(e,t)}}]),t}(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e,t){throw new Error("Method should be implemented in children classes.")}}]),e}()),xJ=n(0),bJ=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).telemetry=i,r}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(uV&&(t.headers||(t.headers=new FY),t.headers.get("User-Agent")||t.headers.set("User-Agent",this.telemetry)),this._nextPolicy.sendRequest(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV),wJ=function(){function e(t){_classCallCheck(this,e);var n=[];if(uV){if(t){var i=t.userAgentPrefix||"";i.length>0&&-1===n.indexOf(i)&&n.push(i)}var r="azsdk-js-storageblob/12.17.0";-1===n.indexOf(r)&&n.push(r);var a="(NODE-VERSION ".concat(process.version,")");xJ&&(a="(NODE-VERSION ".concat(process.version,"; ").concat(xJ.type()," ").concat(xJ.release(),")")),-1===n.indexOf(a)&&n.push(a)}this.telemetryString=n.join(" ")}return _createClass(e,[{key:"create",value:function(e,t){return new bJ(e,t,this.telemetryString)}}]),e}(),kJ=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"sendRequest",value:function(e){var t,n=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var i=e.abortSignal;if(i){if(i.aborted)return Promise.reject(new fJ("The operation was aborted."));var r=function(){n.abort()};i.addEventListener("abort",r),n.addEventListener("readystatechange",(function(){n.readyState===XMLHttpRequest.DONE&&i.removeEventListener("abort",r)}))}if(CJ(n.upload,e.onUploadProgress),CJ(n,e.onDownloadProgress),e.formData){for(var a=e.formData,o=new FormData,s=function(e,t){t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"options")?o.append(e,t.value,t.options):o.append(e,t)},l=0,u=Object.keys(a);l<u.length;l++){var c=u[l],h=a[c];if(Array.isArray(h))for(var d=0;d<h.length;d++)s(c,h[d]);else s(c,h)}e.body=o,e.formData=void 0;var f=e.headers.get("Content-Type");f&&-1!==f.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}n.open(e.method,e.url),n.timeout=e.timeout,n.withCredentials=e.withCredentials;var p,m=_createForOfIteratorHelper(e.headers.headersArray());try{for(m.s();!(p=m.n()).done;){var v=p.value;n.setRequestHeader(v.name,v.value)}}catch(U5){m.e(U5)}finally{m.f()}return n.responseType=(null===(t=e.streamResponseStatusCodes)||void 0===t?void 0:t.size)||e.streamResponseBody?"blob":"text",n.send(void 0===e.body?null:e.body),new Promise("blob"===n.responseType?function(t,i){!function(e,t,n,i){e.addEventListener("readystatechange",(function(){var r;if(e.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(t.streamResponseBody||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))){var a=new Promise((function(n,i){e.addEventListener("load",(function(){n(e.response)})),TJ(t,e,i)}));n({request:t,status:e.status,headers:SJ(e),blobBody:a})}else e.addEventListener("load",(function(){if(e.response){var r=new FileReader;r.onload=function(i){var r,a=null===(r=i.target)||void 0===r?void 0:r.result;n({request:t,status:e.status,headers:SJ(e),bodyAsText:a})},r.onerror=function(e){i(r.error)},r.readAsText(e.response,"UTF-8")}else n({request:t,status:e.status,headers:SJ(e)})}))}))}(n,e,t,i),TJ(e,n,i)}:function(t,i){n.addEventListener("load",(function(){return t({request:e,status:n.status,headers:SJ(n),bodyAsText:n.responseText})})),TJ(e,n,i)})}}]),e}();function CJ(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function SJ(e){var t,n=new FY,i=_createForOfIteratorHelper(e.getAllResponseHeaders().trim().split(/[\r\n]+/));try{for(i.s();!(t=i.n()).done;){var r=t.value,a=r.indexOf(":"),o=r.slice(0,a),s=r.slice(a+2);n.set(o,s)}}catch(U5){i.e(U5)}finally{i.f()}return n}function TJ(e,t,n){t.addEventListener("error",(function(){return n(new wY("Failed to send request to "+e.url,wY.REQUEST_SEND_ERROR,void 0,e))}));var i=new fJ("The operation was aborted.");t.addEventListener("abort",(function(){return n(i)})),t.addEventListener("timeout",(function(){return n(i)}))}var EJ=new kJ;function PJ(e,t){var n,i=null!=t?t:{},r=i.abortSignal,a=i.abortErrorMsg;return function(t,i){var r=null!=i?i:{},a=r.cleanupBeforeAbort,o=r.abortSignal,s=r.abortErrorMsg;return new Promise((function(t,i){function r(){i(new fJ(null!=s?s:"The operation was aborted."))}function l(){null==o||o.removeEventListener("abort",u)}function u(){null==a||a(),l(),r()}if(null==o?void 0:o.aborted)return r();try{!function(t){n=setTimeout(t,e)}((function(e){l(),t(e)}))}catch(U5){i(U5)}null==o||o.addEventListener("abort",u)}))}(0,{cleanupBeforeAbort:function(){return clearTimeout(n)},abortSignal:r,abortErrorMsg:null!=a?a:"The delay was aborted."})}var MJ={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function IJ(e,t,n){var i=null,r=null,a=Object.assign(Object.assign({},MJ),n),o={get isRefreshing(){return null!==i},get shouldRefresh(){var e;return!o.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function s(n){var s,l;return o.isRefreshing||(i=(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Date.now()<i){e.next=7;break}return e.next=3,t();case 3:if(null!==(n=e.sent)){e.next=6;break}throw new Error("Failed to refresh access token.");case 6:return e.abrupt("return",n);case 7:return e.prev=7,e.next=10,t();case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(7),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},e.next=4,r();case 4:o=e.sent;case 5:if(null!==o){e.next=13;break}return e.next=8,PJ(n);case 8:return e.next=10,r();case 10:o=e.sent;case 11:e.next=5;break;case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),function(e,t,n){return l.apply(this,arguments)})((function(){return e.getToken(t,n)}),a.retryIntervalInMs,null!==(s=null==r?void 0:r.expiresOnTimestamp)&&void 0!==s?s:Date.now()).then((function(e){return i=null,r=e})).catch((function(e){throw i=null,r=null,e}))),i}return function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.mustRefresh?s(t):(o.shouldRefresh&&s(t),r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function AJ(e){if(!e||"object"!=typeof e)return!1;var t=e;return Array.isArray(t.factories)&&"object"==typeof t.options&&"function"==typeof t.toServiceClientOptions}var RJ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.factories=t,this.options=Object.assign(Object.assign({},n),{httpClient:n.httpClient||EJ})}return _createClass(e,[{key:"toServiceClientOptions",value:function(){return{httpClient:this.options.httpClient,requestPolicyFactories:this.factories}}}]),e}();function OJ(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0===e&&(e=new _J);var i,r=new wJ(n.userAgentOptions),a=[YK({userAgent:r.telemetryString}),(i=n.keepAliveOptions,{create:function(e,t){return new $K(e,t,i||QK)}}),r,eY(),new hJ,new gJ(n.retryOptions),EY(void 0,{xmlCharKey:"#"}),AY({logger:OY.info,allowedHeaderNames:NY,allowedQueryParameters:DY})];return uV&&(a.push(fV()),a.push({create:function(e,t){throw new Error("DisableResponseDecompressionPolicy is not supported in browser environment")}})),a.push(cV(e)?rJ(function(e,t){var n=IJ(e,t),i=function(t){function i(e,t){return _classCallCheck(this,i),_callSuper(this,i,[e,t])}var r;return _inherits(i,t),_createClass(i,[{key:"sendRequest",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function t(i){var r,a,o,s,l,u,c,h,d;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.url.toLowerCase().startsWith("https://")){t.next=2;break}throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");case 2:return r=n,t.next=5,r({abortSignal:i.abortSignal,tracingOptions:{tracingContext:i.tracingContext}});case 5:return a=t.sent.token,i.headers.set("authorization","Bearer "+a),t.next=9,this._nextPolicy.sendRequest(i);case 9:if(401!==(null==(o=t.sent)?void 0:o.status)){t.next=21;break}if(!(s=function(e){var t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(o))){t.next=21;break}return l=function(e){return(e.slice("Bearer ".length).trim()+" ").split(" ").filter((function(e){return e})).map((function(e){return t=e.trim().split("="),_defineProperty({},(n=_slicedToArray(t,2))[0],n[1]);var t,n})).reduce((function(e,t){return Object.assign(Object.assign({},e),t)}),{})}(s),u=l.resource_id+"/.default",c=iY.parse(l.authorization_uri).getPath().split("/")[1],h=IJ(e,u),t.next=19,h({abortSignal:i.abortSignal,tracingOptions:{tracingContext:i.tracingContext},tenantId:c});case 19:return d=t.sent.token,t.abrupt("return",(n=h,i.headers.set("authorization","Bearer "+d),this._nextPolicy.sendRequest(i)));case 21:return t.abrupt("return",o);case 22:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})}]),i}(hV);return{create:function(e,t){return new i(e,t)}}}(e,null!==(t=n.audience)&&void 0!==t?t:"https://storage.azure.com/.default"),e):e),new RJ(a,n)}var NJ,DJ=_createClass((function e(){_classCallCheck(this,e)})),zJ=["GET","HEAD"],LJ=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n])).maxRetries=r,i}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return function e(t,n,i){var r=n.request,a=n.status,o=n.headers.get("location");if(o&&(300===a||301===a&&zJ.includes(r.method)||302===a&&zJ.includes(r.method)||303===a&&"POST"===r.method||307===a)&&(!t.maxRetries||i<t.maxRetries)){var s=iY.parse(r.url);return s.setPath(o),r.url=s.toString(),303===a&&(r.method="GET",delete r.body),t._nextPolicy.sendRequest(r).then((function(n){return e(t,n,i+1)}))}return Promise.resolve(n)}(t,e,0)}))}}]),t}(hV);function BJ(e){return"number"==typeof e}function FJ(e,t,n,i,r){return!!t(i,r)&&n.retryCount<e}function jJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{retryCount:0,retryInterval:0},n=arguments.length>2?arguments[2]:void 0;n&&(t.error&&(n.innerError=t.error),t.error=n),t.retryCount++;var i=Math.pow(2,t.retryCount-1)-1;return i*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+i,e.maxRetryInterval),t}!function(e){e[e.Exponential=0]="Exponential"}(NJ||(NJ={}));var HJ=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e,n])).retryCount=BJ(i)?i:3,o.retryInterval=BJ(r)?r:3e4,o.maxRetryInterval=BJ(a)?a:9e4,o}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return VJ(t,e,n)})).catch((function(n){return VJ(t,e,n.response,void 0,n)}))}}]),t}(hV);function VJ(e,t,n,i,r){return UJ.apply(this,arguments)}function UJ(){return(UJ=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r,a){var o,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=jJ({retryInterval:t.retryInterval,minRetryInterval:0,maxRetryInterval:t.maxRetryInterval},r,a),!(o=n.abortSignal&&n.abortSignal.aborted)&&FJ(t.retryCount,(function(e){var t=null==e?void 0:e.status;return!(503===t&&(null==i?void 0:i.headers.get("Retry-After"))||void 0===t||t<500&&408!==t||501===t||505===t)}),r,i)){e.next=6;break}if(!o&&!a&&i){e.next=5;break}throw r.error||new wY("Failed to send the request.",wY.REQUEST_SEND_ERROR,i&&i.status,i&&i.request,i);case 5:return e.abrupt("return",i);case 6:return XK.info("Retrying request in "+r.retryInterval),e.prev=7,e.next=10,PJ(r.retryInterval);case 10:return e.next=12,t._nextPolicy.sendRequest(n.clone());case 12:return s=e.sent,e.abrupt("return",VJ(t,n,s,r));case 16:return e.prev=16,e.t0=e.catch(7),e.abrupt("return",VJ(t,n,i,r,e.t0));case 19:case"end":return e.stop()}}),e,null,[[7,16]])})))).apply(this,arguments)}function qJ(e){return GJ(e.parameterPath,e.mapper)}function GJ(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}var WJ=function(){function e(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){_classCallCheck(this,e),this.streamResponseBody=o,this.streamResponseStatusCodes=m,this.url=t||"",this.method=n||"GET",this.headers=BY(a)?a:new FY(a),this.body=i,this.query=r,this.formData=void 0,this.withCredentials=s||!1,this.abortSignal=l,this.timeout=u||0,this.onUploadProgress=c,this.onDownloadProgress=h,this.proxySettings=d,this.keepAlive=f,this.decompressResponse=p,this.requestId=this.headers.get("x-ms-client-request-id")||wU()}return _createClass(e,[{key:"validateRequestProperties",value:function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")}},{key:"prepare",value:function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var n=e.pathTemplate,i=e.pathParameters;if("string"!=typeof n)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var r=e.baseUrl,a=r+(r.endsWith("/")?"":"/")+(n.startsWith("/")?n.slice(1):n),o=a.match(/({[\w-]*\s*[\w-]*})/gi);if(o&&o.length){if(!i)throw new Error("pathTemplate: ".concat(n," has been provided. Hence, options.pathParameters must also be provided."));o.forEach((function(e){var t=e.slice(1,-1),r=i[t];if(null==r||"string"!=typeof r&&"object"!=typeof r){var o=JSON.stringify(i,void 0,2);throw new Error("pathTemplate: ".concat(n," contains the path parameter ").concat(t," however, it is not present in parameters: ").concat(o,'.The value of the path parameter can either be a "string" of the form { ').concat(t,': "some sample value" } or it can be an "object" of the form { "').concat(t,'": { value: "some sample value", skipUrlEncoding: true } }.'))}if("string"==typeof r.valueOf()&&(a=a.replace(e,encodeURIComponent(r))),"object"==typeof r.valueOf()){if(!r.value)throw new Error("options.pathParameters[".concat(t,'] is of type "object" but it does not contain a "value" property.'));a=a.replace(e,r.skipUrlEncoding?r.value:encodeURIComponent(r.value))}}))}this.url=a}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var l=[];for(var u in this.query={},s){var c=s[u];if(c)if("string"==typeof c)l.push(u+"="+encodeURIComponent(c)),this.query[u]=encodeURIComponent(c);else if("object"==typeof c){if(!c.value)throw new Error("options.queryParameters[".concat(u,'] is of type "object" but it does not contain a "value" property.'));c.skipUrlEncoding?(l.push(u+"="+c.value),this.query[u]=c.value):(l.push(u+"="+encodeURIComponent(c.value)),this.query[u]=encodeURIComponent(c.value))}}this.url+=l.join("&")}if(e.headers)for(var h=e.headers,d=0,f=Object.keys(e.headers);d<f.length;d++){var p=f[d];this.headers.set(p,h[p])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new SU(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),e.tracingContext&&(this.tracingContext=e.tracingContext),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this}},{key:"clone",value:function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t}}]),e}(),ZJ=function(){return"x-ms-useragent"};function XJ(){var e=function(){var e=self.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return e.map((function(e){return"".concat(e.key).concat(e.value?"".concat(n).concat(e.value):"")})).join(t)}([{key:"core-http",value:"3.0.4"}].concat(e))}var KJ,YJ=function(e){function t(e,n,i,r){var a;return _classCallCheck(this,t),(a=_callSuper(this,t,[e,n]))._nextPolicy=e,a._options=n,a.headerKey=i,a.headerValue=r,a}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)}},{key:"addUserAgentHeader",value:function(e){e.headers||(e.headers=new FY),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)}}]),t}(hV),JJ={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function QJ(e,t){var n=function(e,t,n){var i=null,r=null,a=Object.assign(Object.assign({},JJ),void 0),o={get isRefreshing(){return null!==i},get shouldRefresh(){var e;return!o.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function s(n){var s,l;return o.isRefreshing||(i=(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Date.now()<i){e.next=7;break}return e.next=3,t();case 3:if(null!==(n=e.sent)){e.next=6;break}throw new Error("Failed to refresh access token.");case 6:return e.abrupt("return",n);case 7:return e.prev=7,e.next=10,t();case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(7),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},e.next=4,r();case 4:o=e.sent;case 5:if(null!==o){e.next=13;break}return e.next=8,PJ(n);case 8:return e.next=10,r();case 10:o=e.sent;case 11:e.next=5;break;case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),function(e,t,n){return l.apply(this,arguments)})((function(){return e.getToken(t,n)}),a.retryIntervalInMs,null!==(s=null==r?void 0:r.expiresOnTimestamp)&&void 0!==s?s:Date.now()).then((function(e){return i=null,r=e})).catch((function(e){throw i=null,r=null,e}))),i}return function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.mustRefresh?s(t):(o.shouldRefresh&&s(t),r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(e,t),i=function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t,[e,n])}var i;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url.toLowerCase().startsWith("https://")){e.next=2;break}throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");case 2:return e.next=4,n({abortSignal:t.abortSignal,tracingOptions:{tracingContext:t.tracingContext}});case 4:return i=e.sent,r=i.token,e.abrupt("return",(t.headers.set("authorization","Bearer "+r),this._nextPolicy.sendRequest(t)));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}]),t}(hV);return{create:function(e,t){return new i(e,t)}}}var $J=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;return _classCallCheck(this,t),(i=_callSuper(this,t,[e,n]))._retryTimeout=r,i}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return function(e,t,n){if(409===n.status){var i=function(e){var t,n;if(e){try{n=JSON.parse(e)}catch(U5){}if(n&&n.error&&n.error.message&&n.error.code&&"MissingSubscriptionRegistration"===n.error.code){var i=n.error.message.match(/.*'(.*)'/i);i&&(t=i.pop())}}return t}(n.bodyAsText);if(i){var r=function(e){var t=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!t||!t[0])throw new Error("Unable to extract subscriptionId from the given url - ".concat(e,"."));return t[0]}(t.url);return(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r){var a,o,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(n,"providers/").concat(i,"/register?api-version=2016-02-01"),o="".concat(n,"providers/").concat(i,"?api-version=2016-02-01"),(s=eQ(r)).method="POST",s.url=a,e.next=5,t._nextPolicy.sendRequest(s);case 5:if(e.t0=e.sent.status,200===e.t0){e.next=8;break}throw new Error("Autoregistration of ".concat(i," failed. Please try registering manually."));case 8:return e.abrupt("return",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,i,r){var a,o,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=eQ(r)).url=i,a.method="GET",e.next=4,n._nextPolicy.sendRequest(a);case 4:if(o=e.sent,s=o.parsedBody,e.t0=!(!o.parsedBody||!s.registrationState||"Registered"!==s.registrationState),e.t0){e.next=11;break}return e.next=10,PJ(1e3*n._retryTimeout);case 10:e.t0=t(n,i,r);case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e)})));function t(t,n,i){return e.apply(this,arguments)}return t}()(t,o,r));case 9:case"end":return e.stop()}}),e)}))),function(e,t,n,i){return a.apply(this,arguments)})(e,r,i,t).catch((function(){return!1})).then((function(i){return i?(t.headers.set("x-ms-client-request-id",wU()),e._nextPolicy.sendRequest(t.clone())):n}))}}var a;return Promise.resolve(n)}(t,e,n)}))}}]),t}(hV);function eQ(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.clone();return t&&(n.url=e.url),n.headers.set("x-ms-client-request-id",wU()),n.headers.set("Content-Type","application/json; charset=utf-8"),n}var tQ=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).authenticationProvider=i,r}return _inherits(t,e),_createClass(t,[{key:"signRequest",value:function(e){return this.authenticationProvider.signRequest(e)}},{key:"sendRequest",value:function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))}}]),t}(hV),nQ=function(e){function t(e,n,i,r,a,o){var s;return _classCallCheck(this,t),(s=_callSuper(this,t,[e,n])).retryCount=BJ(i)?i:3,s.retryInterval=BJ(r)?r:3e4,s.minRetryInterval=BJ(a)?a:3e3,s.maxRetryInterval=BJ(o)?o:9e4,s}return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).catch((function(n){return function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,i,r,a,o){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=jJ(n,o,a),FJ(n.retryCount,(function(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}),o,r,a)){e.next=2;break}return e.abrupt("return",a?Promise.reject(o.error):r);case 2:return e.prev=2,e.next=5,PJ(o.retryInterval);case 5:return e.abrupt("return",n._nextPolicy.sendRequest(i.clone()));case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",t(n,i,r,e.t0,o));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));function t(t,n,i,r,a){return e.apply(this,arguments)}return t}()(t,e,n.response,n)}))}}]),t}(hV),iQ=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,n])).numberOfRetries=0,r._handleResponse=i||r._defaultResponseHandler,r}var n,i;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._nextPolicy.sendRequest(t.clone());case 2:return n=e.sent,e.abrupt("return",429!==n.status&&503!==n.status?n:this._handleResponse(t,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_defaultResponseHandler",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,i){var r,a,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=i.headers.get("Retry-After"))){e.next=10;break}if(!(o=t.parseRetryAfterHeader(a))){e.next=10;break}return this.numberOfRetries+=1,e.next=7,PJ(o,{abortSignal:n.abortSignal,abortErrorMsg:"The operation was aborted."});case 7:if(!(null===(r=n.abortSignal)||void 0===r?void 0:r.aborted)){e.next=9;break}throw new fJ("The operation was aborted.");case 9:return e.abrupt("return",this.numberOfRetries<3?this.sendRequest(n):this._nextPolicy.sendRequest(n));case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}],[{key:"parseRetryAfterHeader",value:function(e){var n=Number(e);return Number.isNaN(n)?t.parseDateRetryAfterHeader(e):1e3*n}},{key:"parseDateRetryAfterHeader",value:function(e){try{var t=Date.now(),n=Date.parse(e)-t;return Number.isNaN(n)?void 0:n}catch(i){return}}}]),t}(hV);function rQ(e,t){var n;return"string"==typeof e?n=e:(n=t(),"function"==typeof e&&(n=e(n))),n}function aQ(e,t,n,i){return function e(t,n,i,r,a){var o,s;"string"==typeof i&&(i=[i]);var l=null===(o=n.options)||void 0===o?void 0:o.serializerOptions;if(Array.isArray(i)){if(i.length>0){if(r.isConstant)s=r.defaultValue;else{var u=oQ(n,i);u.propertyFound||(u=oQ(t,i));var c=!1;u.propertyFound||(c=r.required||"options"===i[0]&&2===i.length),s=c?r.defaultValue:u.propertyValue}var h=GJ(i,r);a.serialize(r,s,h,l)}}else for(var d in r.required&&(s={}),i){var f=r.type.modelProperties[d],p=i[d],m=e(t,n,p,f,a),v=GJ(p,f);a.serialize(f,m,v,l),null!=m&&(s||(s={}),s[d]=m)}return s}(e,t,n.parameterPath,n.mapper,i)}function oQ(e,t){for(var n={propertyFound:!1},i=0;i<t.length;++i){var r=t[i];if(null==e||!(r in e))break;e=e[r]}return i===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}function sQ(e,t){var n,i=e.parsedHeaders,r=t&&t.bodyMapper,a=function(t){return Object.defineProperty(t,"_response",{value:e})};if(r){var o=r.type.name;if("Stream"===o)return a(Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var s="Composite"===o&&r.type.modelProperties||{},l=Object.keys(s).some((function(e){return""===s[e].serializedName}));if("Sequence"===o||l){for(var u=_toConsumableArray(e.parsedBody||[]),c=0,h=Object.keys(s);c<h.length;c++){var d=h[c];s[d].serializedName&&(u[d]=e.parsedBody[d])}if(i)for(var f=0,p=Object.keys(i);f<p.length;f++){var m=p[f];u[m]=i[m]}return a(u),u}if("Composite"===o||"Dictionary"===o)return a(Object.assign(Object.assign({},i),e.parsedBody))}return r||"HEAD"===e.request.method||"object"!=typeof(n=e.parsedBody)&&"function"!=typeof n||null===n?a(Object.assign(Object.assign({},i),{body:e.parsedBody})):a(Object.assign(Object.assign({},i),e.parsedBody))}var lQ=function(e){function t(e,n){var i;if(_classCallCheck(this,t),void 0===e)throw new Error("'url' cannot be null");if(n||(n={}),!n.userAgent){var r=XJ();n.userAgent="azure-storage-blob/12.17.0 "+r}return(i=_callSuper(this,t,[void 0,n])).requestContentType="application/json; charset=utf-8",i.baseUri=n.endpoint||"{url}",i.url=e,i.version=n.version||"2023-11-03",i}return _inherits(t,e),_createClass(t)}(function(){function e(t,n){var i,r,a,o,s,l=this;if(_classCallCheck(this,e),n||(n={}),this._withCredentials=n.withCredentials||!1,this._httpClient=n.httpClient||(KJ||(KJ=new kJ),KJ),this._requestPolicyOptions=new dV(n.httpPipelineLogger),Array.isArray(n.requestPolicyFactories))XK.info("ServiceClient: using custom request policies"),i=n.requestPolicyFactories;else{var u=void 0;if(cV(t))XK.info("ServiceClient: creating bearer token authentication policy from provided credentials"),r=void 0,a=l,o=n,u={create:function(e,n){var i=function(e,t){return(null==e?void 0:e.credentialScopes)?e.credentialScopes:t?t+"/.default":void 0}(o,a.baseUri);if(!i)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==r&&(r=QJ(t,i)),r.create(e,n)}};else if(t&&"function"==typeof t.signRequest)XK.info("ServiceClient: creating signing policy from provided credentials"),s=t,u={create:function(e,t){return new tQ(e,t,s)}};else if(null!=t)throw new Error("The credentials argument must implement the TokenCredential interface");if(XK.info("ServiceClient: using default request policies"),i=function(e,t){var n=[];t.generateClientRequestIdHeader&&n.push(eY(t.clientRequestIdHeaderName)),e&&n.push(e);var i,r,a,o=rQ(t.userAgentHeaderName,ZJ),s=rQ(t.userAgent,XJ);return o&&s&&n.push((r=(i={key:o,value:s})&&null!=i.key?i.key:"x-ms-useragent",a=i&&null!=i.value?i.value:XJ(),{create:function(e,t){return new YJ(e,t,r,a)}})),n.push(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return{create:function(t,n){return new LJ(t,n,e)}}}()),n.push(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return{create:function(t,n){return new $J(t,n,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(n.push({create:function(e,t){return new HJ(e,t,void 0,void 0,void 0)}}),n.push({create:function(e,t){return new nQ(e,t,void 0,void 0,void 0,void 0)}}),n.push({create:function(e,t){return new iQ(e,t)}})),n.push(EY(t.deserializationContentTypes)),uV&&n.push(fV()),n.push(AY({logger:XK.info})),n}(u,n),n.requestPolicyFactories){var c=n.requestPolicyFactories(i);c&&(i=c)}}this._requestPolicyFactories=i}var t;return _createClass(e,[{key:"sendRequest",value:function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{!function(e){if(e&&"object"==typeof e){var t=e;if("string"==typeof t.url&&"string"==typeof t.method&&"object"==typeof t.headers&&BY(t.headers)&&"function"==typeof t.validateRequestProperties&&"function"==typeof t.prepare&&"function"==typeof t.clone)return!0}return!1}(e)?t=(t=new WJ).prepare(e):(e.validateRequestProperties(),t=e)}catch(r){return Promise.reject(r)}var n=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var i=this._requestPolicyFactories.length-1;i>=0;--i)n=this._requestPolicyFactories[i].create(n,this._requestPolicyOptions);return n.sendRequest(t)}},{key:"sendOperationRequest",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w,k,C,S,T,E,P,M,I,A,R,O,N;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof t.options&&(i=t.options,t.options=void 0),a=null===(r=t.options)||void 0===r?void 0:r.serializerOptions,o=new WJ,e.prev=2,l=n.baseUrl||this.baseUri){e.next=6;break}throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");case 6:if(o.method=n.httpMethod,o.operationSpec=n,u=iY.parse(l),n.path&&u.appendPath(n.path),n.urlParameters&&n.urlParameters.length>0){c=_createForOfIteratorHelper(n.urlParameters);try{for(c.s();!(h=c.n()).done;)d=h.value,f=aQ(this,t,d,n.serializer),f=n.serializer.serialize(d.mapper,f,qJ(d),a),d.skipEncoding||(f=encodeURIComponent(f)),u.replaceAll("{".concat(d.mapper.serializedName||qJ(d),"}"),f)}catch(U5){c.e(U5)}finally{c.f()}}if(!(n.queryParameters&&n.queryParameters.length>0)){e.next=37;break}p=_createForOfIteratorHelper(n.queryParameters),e.prev=11,p.s();case 13:if((m=p.n()).done){e.next=29;break}if(v=m.value,null==(g=aQ(this,t,v,n.serializer))){e.next=27;break}if(g=n.serializer.serialize(v.mapper,g,qJ(v),a),null==v.collectionFormat){e.next=25;break}if(v.collectionFormat!==NU.Multi){e.next=24;break}if(0!==g.length){e.next=21;break}return e.abrupt("continue",27);case 21:for(y in g)_=g[y],g[y]=null==_?"":_.toString();e.next=25;break;case 24:v.collectionFormat!==NU.Ssv&&v.collectionFormat!==NU.Tsv||(g=g.join(v.collectionFormat));case 25:if(!v.skipEncoding)if(Array.isArray(g))for(x in g)null!=g[x]&&(g[x]=encodeURIComponent(g[x]));else g=encodeURIComponent(g);null!=v.collectionFormat&&v.collectionFormat!==NU.Multi&&v.collectionFormat!==NU.Ssv&&v.collectionFormat!==NU.Tsv&&(g=g.join(v.collectionFormat)),u.setQueryParameter(v.mapper.serializedName||qJ(v),g);case 27:e.next=13;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(11),p.e(e.t0);case 34:return e.prev=34,p.f(),e.finish(34);case 37:if(o.url=u.toString(),(b=n.contentType||this.requestContentType)&&n.requestBody&&o.headers.set("Content-Type",b),n.headerParameters){w=_createForOfIteratorHelper(n.headerParameters);try{for(w.s();!(k=w.n()).done;)if(C=k.value,null!=(S=aQ(this,t,C,n.serializer)))if(S=n.serializer.serialize(C.mapper,S,qJ(C),a),T=C.mapper.headerCollectionPrefix)for(E=0,P=Object.keys(S);E<P.length;E++)M=P[E],o.headers.set(T+M,S[M]);else o.headers.set(C.mapper.serializedName||qJ(C),S)}catch(U5){w.e(U5)}finally{w.f()}}if(I=t.options){if(I.customHeaders)for(A in I.customHeaders)o.headers.set(A,I.customHeaders[A]);I.abortSignal&&(o.abortSignal=I.abortSignal),I.timeout&&(o.timeout=I.timeout),I.onUploadProgress&&(o.onUploadProgress=I.onUploadProgress),I.onDownloadProgress&&(o.onDownloadProgress=I.onDownloadProgress),I.spanOptions&&(o.spanOptions=I.spanOptions),I.tracingContext&&(o.tracingContext=I.tracingContext),null!=I.shouldDeserialize&&(o.shouldDeserialize=I.shouldDeserialize)}return o.withCredentials=this._withCredentials,function(e,t,n,i){var r,a,o,s,l,u,c=null!==(a=null===(r=n.options)||void 0===r?void 0:r.serializerOptions)&&void 0!==a?a:{},h={rootName:null!==(o=c.rootName)&&void 0!==o?o:"",includeRoot:null!==(s=c.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(l=c.xmlCharKey)&&void 0!==l?l:"_"},d=c.xmlCharKey;if(i.requestBody&&i.requestBody.mapper){t.body=aQ(e,n,i.requestBody,i.serializer);var f=i.requestBody.mapper,p=f.required,m=f.xmlName,v=f.xmlElementName,g=f.serializedName,y=f.xmlNamespace,_=f.xmlNamespacePrefix,x=f.type.name;try{if(null!=t.body||p){var b=qJ(i.requestBody);t.body=i.serializer.serialize(f,t.body,b,h);var w=x===DU.Stream;if(i.isXML){var k=_?"xmlns:"+_:"xmlns",C=function(e,t,n,i,r){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){var a={};return a[r.xmlCharKey]=i,a[fU]=_defineProperty({},t,e),a}return i}(y,k,x,t.body,h);x===DU.Sequence?t.body=SY(function(e,t,n,i){if(Array.isArray(e)||(e=[e]),!n||!i)return _defineProperty({},t,e);var r=_defineProperty({},t,e);return r[fU]=_defineProperty({},n,i),r}(C,v||m||g,k,y),{rootName:m||g,xmlCharKey:d}):w||(t.body=SY(C,{rootName:m||g,xmlCharKey:d}))}else{if(x===DU.String&&((null===(u=i.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===i.mediaType))return;w||(t.body=JSON.stringify(t.body))}}}catch(I){throw new Error('Error "'.concat(I.message,'" occurred in serializing the payload - ').concat(JSON.stringify(g,void 0,"  "),"."))}}else if(i.formDataParameters&&i.formDataParameters.length>0){t.formData={};var S,T=_createForOfIteratorHelper(i.formDataParameters);try{for(T.s();!(S=T.n()).done;){var E=S.value,P=aQ(e,n,E,i.serializer);if(null!=P){var M=E.mapper.serializedName||qJ(E);t.formData[M]=i.serializer.serialize(E.mapper,P,qJ(E),h)}}}catch(U5){T.e(U5)}finally{T.f()}}}(this,o,t,n),void 0===o.streamResponseStatusCodes&&(o.streamResponseStatusCodes=function(e){var t=new Set;for(var n in e.responses){var i=e.responses[n];i.bodyMapper&&i.bodyMapper.type.name===DU.Stream&&t.add(Number(n))}return t}(n)),e.prev=43,e.next=46,this.sendRequest(o);case 46:R=e.sent,e.next=52;break;case 49:e.prev=49,e.t1=e.catch(43),O=e.t1;case 52:O?(O.response&&(O.details=sQ(O.response,n.responses[O.statusCode]||n.responses.default)),s=Promise.reject(O)):s=Promise.resolve(sQ(R,n.responses[R.status])),e.next=58;break;case 55:e.prev=55,e.t2=e.catch(2),s=Promise.reject(e.t2);case 58:return N=i,e.abrupt("return",(N&&s.then((function(e){return N(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return N(e)})),s));case 60:case"end":return e.stop()}}),e,this,[[2,55],[11,31,34,37],[43,49]])}))),function(e,n,i){return t.apply(this,arguments)})}]),e}()),uQ=_createClass((function e(t,n){_classCallCheck(this,e),this.url=function(e){var t=iY.parse(e),n=t.getPath();return n=n||"/",n=encodeURIComponent(n).replace(/%2F/g,"/").replace(/'/g,"%27").replace(/\+/g,"%20").replace(/%25/g,"%"),t.setPath(n),t.toString()}(t),this.accountName=JY(t),this.pipeline=n,this.storageClientContext=new lQ(this.url,n.toServiceClientOptions()),this.isHttps=YY(function(e){return iY.parse(e).getScheme()}(this.url)||"","https"),this.credential=new _J;var i,r=_createForOfIteratorHelper(this.pipeline.factories);try{for(r.s();!(i=r.n()).done;){var a=i.value;uV&&a instanceof DJ||a instanceof _J?this.credential=a:cV(a.credential)&&(this.credential=a.credential)}}catch(U5){r.e(U5)}finally{r.f()}this.storageClientContext.requestContentType=void 0})),cQ=CK({packagePrefix:"Azure.Storage.Blob",namespace:"Microsoft.Storage"});function hQ(e){var t,n;return{spanOptions:null===(t=null==e?void 0:e.tracingOptions)||void 0===t?void 0:t.spanOptions,tracingContext:null===(n=null==e?void 0:e.tracingOptions)||void 0===n?void 0:n.tracingContext}}var dQ,fQ=function(){function e(){_classCallCheck(this,e),this.read=!1,this.add=!1,this.create=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.tag=!1,this.move=!1,this.execute=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1}return _createClass(e,[{key:"toString",value:function(){var e=[];return this.read&&e.push("r"),this.add&&e.push("a"),this.create&&e.push("c"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.tag&&e.push("t"),this.move&&e.push("m"),this.execute&&e.push("e"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),e.join("")}}],[{key:"parse",value:function(t){var n,i=new e,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;switch(a){case"r":i.read=!0;break;case"a":i.add=!0;break;case"c":i.create=!0;break;case"w":i.write=!0;break;case"d":i.delete=!0;break;case"x":i.deleteVersion=!0;break;case"t":i.tag=!0;break;case"m":i.move=!0;break;case"e":i.execute=!0;break;case"i":i.setImmutabilityPolicy=!0;break;case"y":i.permanentDelete=!0;break;default:throw new RangeError("Invalid permission: "+a)}}}catch(U5){r.e(U5)}finally{r.f()}return i}},{key:"from",value:function(t){var n=new e;return t.read&&(n.read=!0),t.add&&(n.add=!0),t.create&&(n.create=!0),t.write&&(n.write=!0),t.delete&&(n.delete=!0),t.deleteVersion&&(n.deleteVersion=!0),t.tag&&(n.tag=!0),t.move&&(n.move=!0),t.execute&&(n.execute=!0),t.setImmutabilityPolicy&&(n.setImmutabilityPolicy=!0),t.permanentDelete&&(n.permanentDelete=!0),n}}]),e}(),pQ=function(){function e(){_classCallCheck(this,e),this.read=!1,this.add=!1,this.create=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.list=!1,this.tag=!1,this.move=!1,this.execute=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1,this.filterByTags=!1}return _createClass(e,[{key:"toString",value:function(){var e=[];return this.read&&e.push("r"),this.add&&e.push("a"),this.create&&e.push("c"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.list&&e.push("l"),this.tag&&e.push("t"),this.move&&e.push("m"),this.execute&&e.push("e"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),this.filterByTags&&e.push("f"),e.join("")}}],[{key:"parse",value:function(t){var n,i=new e,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;switch(a){case"r":i.read=!0;break;case"a":i.add=!0;break;case"c":i.create=!0;break;case"w":i.write=!0;break;case"d":i.delete=!0;break;case"l":i.list=!0;break;case"t":i.tag=!0;break;case"x":i.deleteVersion=!0;break;case"m":i.move=!0;break;case"e":i.execute=!0;break;case"i":i.setImmutabilityPolicy=!0;break;case"y":i.permanentDelete=!0;break;case"f":i.filterByTags=!0;break;default:throw new RangeError("Invalid permission "+a)}}}catch(U5){r.e(U5)}finally{r.f()}return i}},{key:"from",value:function(t){var n=new e;return t.read&&(n.read=!0),t.add&&(n.add=!0),t.create&&(n.create=!0),t.write&&(n.write=!0),t.delete&&(n.delete=!0),t.list&&(n.list=!0),t.deleteVersion&&(n.deleteVersion=!0),t.tag&&(n.tag=!0),t.move&&(n.move=!0),t.execute&&(n.execute=!0),t.setImmutabilityPolicy&&(n.setImmutabilityPolicy=!0),t.permanentDelete&&(n.permanentDelete=!0),t.filterByTags&&(n.filterByTags=!0),n}}]),e}(),mQ=_createClass((function e(){_classCallCheck(this,e)}));function vQ(e){return e.end?"".concat(e.start,"-").concat(e.end):e.start}!function(e){e.Https="https",e.HttpsAndHttp="https,http"}(dQ||(dQ={}));var gQ=function(){function e(t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x){_classCallCheck(this,e),this.version=t,this.signature=n,void 0!==i&&"string"!=typeof i?(this.permissions=i.permissions,this.services=i.services,this.resourceTypes=i.resourceTypes,this.protocol=i.protocol,this.startsOn=i.startsOn,this.expiresOn=i.expiresOn,this.ipRangeInner=i.ipRange,this.identifier=i.identifier,this.encryptionScope=i.encryptionScope,this.resource=i.resource,this.cacheControl=i.cacheControl,this.contentDisposition=i.contentDisposition,this.contentEncoding=i.contentEncoding,this.contentLanguage=i.contentLanguage,this.contentType=i.contentType,i.userDelegationKey&&(this.signedOid=i.userDelegationKey.signedObjectId,this.signedTenantId=i.userDelegationKey.signedTenantId,this.signedStartsOn=i.userDelegationKey.signedStartsOn,this.signedExpiresOn=i.userDelegationKey.signedExpiresOn,this.signedService=i.userDelegationKey.signedService,this.signedVersion=i.userDelegationKey.signedVersion,this.preauthorizedAgentObjectId=i.preauthorizedAgentObjectId,this.correlationId=i.correlationId)):(this.services=r,this.resourceTypes=a,this.expiresOn=l,this.permissions=i,this.protocol=o,this.startsOn=s,this.ipRangeInner=u,this.encryptionScope=x,this.identifier=c,this.resource=h,this.cacheControl=d,this.contentDisposition=f,this.contentEncoding=p,this.contentLanguage=m,this.contentType=v,g&&(this.signedOid=g.signedObjectId,this.signedTenantId=g.signedTenantId,this.signedStartsOn=g.signedStartsOn,this.signedExpiresOn=g.signedExpiresOn,this.signedService=g.signedService,this.signedVersion=g.signedVersion,this.preauthorizedAgentObjectId=y,this.correlationId=_))}return _createClass(e,[{key:"ipRange",get:function(){if(this.ipRangeInner)return{end:this.ipRangeInner.end,start:this.ipRangeInner.start}}},{key:"toString",value:function(){for(var e=[],t=0,n=["sv","ss","srt","spr","st","se","sip","si","ses","skoid","sktid","skt","ske","sks","skv","sr","sp","sig","rscc","rscd","rsce","rscl","rsct","saoid","scid"];t<n.length;t++){var i=n[t];switch(i){case"sv":this.tryAppendQueryParameter(e,i,this.version);break;case"ss":this.tryAppendQueryParameter(e,i,this.services);break;case"srt":this.tryAppendQueryParameter(e,i,this.resourceTypes);break;case"spr":this.tryAppendQueryParameter(e,i,this.protocol);break;case"st":this.tryAppendQueryParameter(e,i,this.startsOn?XY(this.startsOn,!1):void 0);break;case"se":this.tryAppendQueryParameter(e,i,this.expiresOn?XY(this.expiresOn,!1):void 0);break;case"sip":this.tryAppendQueryParameter(e,i,this.ipRange?vQ(this.ipRange):void 0);break;case"si":this.tryAppendQueryParameter(e,i,this.identifier);break;case"ses":this.tryAppendQueryParameter(e,i,this.encryptionScope);break;case"skoid":this.tryAppendQueryParameter(e,i,this.signedOid);break;case"sktid":this.tryAppendQueryParameter(e,i,this.signedTenantId);break;case"skt":this.tryAppendQueryParameter(e,i,this.signedStartsOn?XY(this.signedStartsOn,!1):void 0);break;case"ske":this.tryAppendQueryParameter(e,i,this.signedExpiresOn?XY(this.signedExpiresOn,!1):void 0);break;case"sks":this.tryAppendQueryParameter(e,i,this.signedService);break;case"skv":this.tryAppendQueryParameter(e,i,this.signedVersion);break;case"sr":this.tryAppendQueryParameter(e,i,this.resource);break;case"sp":this.tryAppendQueryParameter(e,i,this.permissions);break;case"sig":this.tryAppendQueryParameter(e,i,this.signature);break;case"rscc":this.tryAppendQueryParameter(e,i,this.cacheControl);break;case"rscd":this.tryAppendQueryParameter(e,i,this.contentDisposition);break;case"rsce":this.tryAppendQueryParameter(e,i,this.contentEncoding);break;case"rscl":this.tryAppendQueryParameter(e,i,this.contentLanguage);break;case"rsct":this.tryAppendQueryParameter(e,i,this.contentType);break;case"saoid":this.tryAppendQueryParameter(e,i,this.preauthorizedAgentObjectId);break;case"scid":this.tryAppendQueryParameter(e,i,this.correlationId)}}return e.join("&")}},{key:"tryAppendQueryParameter",value:function(e,t,n){n&&(t=encodeURIComponent(t),n=encodeURIComponent(n),t.length>0&&n.length>0&&e.push("".concat(t,"=").concat(n)))}}]),e}();function yQ(e,t,n){var i,r=e.version?e.version:"2023-11-03",a=t instanceof DJ?t:void 0;if(void 0===a&&void 0!==n&&(i=new mQ(n,t)),void 0===a&&void 0===i)throw TypeError("Invalid sharedKeyCredential, userDelegationKey or accountName.");if(r>="2020-12-06")return void 0!==a?function(e,t){if(!((e=xQ(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");var n,i="c",r=e.snapshotTime;e.blobName&&(i="b",e.snapshotTime?i="bs":e.versionId&&(i="bv",r=e.versionId)),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var a=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,i,r,e.encryptionScope,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),o=t.computeHMACSHA256(a);return new gQ(e.version,o,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,void 0,void 0,void 0,e.encryptionScope)}(e,a):function(e,t){if(!(e=xQ(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");var n,i="c",r=e.snapshotTime;e.blobName&&(i="b",e.snapshotTime?i="bs":e.versionId&&(i="bv",r=e.versionId)),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var a=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?XY(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?XY(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.preauthorizedAgentObjectId,void 0,e.correlationId,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,i,r,e.encryptionScope,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(a);return new gQ(e.version,o,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey,e.preauthorizedAgentObjectId,e.correlationId,e.encryptionScope)}(e,i);if(r>="2018-11-09")return void 0!==a?function(e,t){if(!((e=xQ(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");var n,i="c",r=e.snapshotTime;e.blobName&&(i="b",e.snapshotTime?i="bs":e.versionId&&(i="bv",r=e.versionId)),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var a=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,i,r,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),o=t.computeHMACSHA256(a);return new gQ(e.version,o,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType)}(e,a):r>="2020-02-10"?function(e,t){if(!(e=xQ(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");var n,i="c",r=e.snapshotTime;e.blobName&&(i="b",e.snapshotTime?i="bs":e.versionId&&(i="bv",r=e.versionId)),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var a=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?XY(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?XY(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.preauthorizedAgentObjectId,void 0,e.correlationId,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,i,r,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(a);return new gQ(e.version,o,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey,e.preauthorizedAgentObjectId,e.correlationId)}(e,i):function(e,t){if(!(e=xQ(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");var n,i="c",r=e.snapshotTime;e.blobName&&(i="b",e.snapshotTime?i="bs":e.versionId&&(i="bv",r=e.versionId)),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var a=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?XY(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?XY(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,i,r,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(a);return new gQ(e.version,o,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey)}(e,i);if(r>="2015-04-05"){if(void 0!==a)return function(e,t){if(!((e=xQ(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");var n,i="c";e.blobName&&(i="b"),e.permissions&&(n=e.blobName?fQ.parse(e.permissions.toString()).toString():pQ.parse(e.permissions.toString()).toString());var r=[n||"",e.startsOn?XY(e.startsOn,!1):"",e.expiresOn?XY(e.expiresOn,!1):"",_Q(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",e.version,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),a=t.computeHMACSHA256(r);return new gQ(e.version,a,n,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,i,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType)}(e,a);throw new RangeError("'version' must be >= '2018-11-09' when generating user delegation SAS using user delegation key.")}throw new RangeError("'version' must be >= '2015-04-05'.")}function _Q(e,t,n){var i=["/blob/".concat(e,"/").concat(t)];return n&&i.push("/"+n),i.join("")}function xQ(e){var t=e.version?e.version:"2023-11-03";if(e.snapshotTime&&t<"2018-11-09")throw RangeError("'version' must be >= '2018-11-09' when providing 'snapshotTime'.");if(void 0===e.blobName&&e.snapshotTime)throw RangeError("Must provide 'blobName' when providing 'snapshotTime'.");if(e.versionId&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'versionId'.");if(void 0===e.blobName&&e.versionId)throw RangeError("Must provide 'blobName' when providing 'versionId'.");if(e.permissions&&e.permissions.setImmutabilityPolicy&&t<"2020-08-04")throw RangeError("'version' must be >= '2020-08-04' when provided 'i' permission.");if(e.permissions&&e.permissions.deleteVersion&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'x' permission.");if(e.permissions&&e.permissions.permanentDelete&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'y' permission.");if(e.permissions&&e.permissions.tag&&t<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when providing 't' permission.");if(t<"2020-02-10"&&e.permissions&&(e.permissions.move||e.permissions.execute))throw RangeError("'version' must be >= '2020-02-10' when providing the 'm' or 'e' permission.");if(t<"2021-04-10"&&e.permissions&&e.permissions.filterByTags)throw RangeError("'version' must be >= '2021-04-10' when providing the 'f' permission.");if(t<"2020-02-10"&&(e.preauthorizedAgentObjectId||e.correlationId))throw RangeError("'version' must be >= '2020-02-10' when providing 'preauthorizedAgentObjectId' or 'correlationId'.");if(e.encryptionScope&&t<"2020-12-06")throw RangeError("'version' must be >= '2020-12-06' when provided 'encryptionScope' in SAS.");return e.version=t,e}var bQ,wQ,kQ,CQ=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"download",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,TQ)}},{key:"getProperties",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,EQ)}},{key:"delete",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,PQ)}},{key:"undelete",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,MQ)}},{key:"setExpiry",value:function(e,t){var n={expiryOptions:e,options:uU(t||{})};return this.client.sendOperationRequest(n,IQ)}},{key:"setHttpHeaders",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,AQ)}},{key:"setImmutabilityPolicy",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,RQ)}},{key:"deleteImmutabilityPolicy",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,OQ)}},{key:"setLegalHold",value:function(e,t){var n={legalHold:e,options:uU(t||{})};return this.client.sendOperationRequest(n,NQ)}},{key:"setMetadata",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,DQ)}},{key:"acquireLease",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,zQ)}},{key:"releaseLease",value:function(e,t){var n={leaseId:e,options:uU(t||{})};return this.client.sendOperationRequest(n,LQ)}},{key:"renewLease",value:function(e,t){var n={leaseId:e,options:uU(t||{})};return this.client.sendOperationRequest(n,BQ)}},{key:"changeLease",value:function(e,t,n){var i={leaseId:e,proposedLeaseId:t,options:uU(n||{})};return this.client.sendOperationRequest(i,FQ)}},{key:"breakLease",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,jQ)}},{key:"createSnapshot",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,HQ)}},{key:"startCopyFromURL",value:function(e,t){var n={copySource:e,options:uU(t||{})};return this.client.sendOperationRequest(n,VQ)}},{key:"copyFromURL",value:function(e,t){var n={copySource:e,options:uU(t||{})};return this.client.sendOperationRequest(n,UQ)}},{key:"abortCopyFromURL",value:function(e,t){var n={copyId:e,options:uU(t||{})};return this.client.sendOperationRequest(n,qQ)}},{key:"setTier",value:function(e,t){var n={tier:e,options:uU(t||{})};return this.client.sendOperationRequest(n,GQ)}},{key:"getAccountInfo",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,WQ)}},{key:"query",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,ZQ)}},{key:"getTags",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,XQ)}},{key:"setTags",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,KQ)}}]),e}(),SQ=new SU(r,!0),TQ={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:bG},206:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:bG},default:{bodyMapper:VU,headersMapper:wG}},queryParameters:[aZ,UZ,qZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,GZ,{parameterPath:["options","rangeGetContentMD5"],mapper:{serializedName:"x-ms-range-get-content-md5",xmlName:"x-ms-range-get-content-md5",type:{name:"Boolean"}}},{parameterPath:["options","rangeGetContentCRC64"],mapper:{serializedName:"x-ms-range-get-content-crc64",xmlName:"x-ms-range-get-content-crc64",type:{name:"Boolean"}}},WZ,ZZ,XZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},EQ={path:"/{containerName}/{blob}",httpMethod:"HEAD",responses:{200:{headersMapper:kG},default:{bodyMapper:VU,headersMapper:CG}},queryParameters:[aZ,UZ,qZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},PQ={path:"/{containerName}/{blob}",httpMethod:"DELETE",responses:{202:{headersMapper:SG},default:{bodyMapper:VU,headersMapper:TG}},queryParameters:[aZ,UZ,qZ,{parameterPath:["options","blobDeleteType"],mapper:{serializedName:"deletetype",xmlName:"deletetype",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,KZ,YZ,JZ,{parameterPath:["options","deleteSnapshots"],mapper:{serializedName:"x-ms-delete-snapshots",xmlName:"x-ms-delete-snapshots",type:{name:"Enum",allowedValues:["include","only"]}}}],isXML:!0,serializer:SQ},MQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:EG},default:{bodyMapper:VU,headersMapper:PG}},queryParameters:[aZ,IZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:SQ},IQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:MG},default:{bodyMapper:VU,headersMapper:IG}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"expiry",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,{parameterPath:"expiryOptions",mapper:{serializedName:"x-ms-expiry-option",required:!0,xmlName:"x-ms-expiry-option",type:{name:"String"}}},{parameterPath:["options","expiresOn"],mapper:{serializedName:"x-ms-expiry-time",xmlName:"x-ms-expiry-time",type:{name:"String"}}}],isXML:!0,serializer:SQ},AQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:AG},default:{bodyMapper:VU,headersMapper:RG}},queryParameters:[rZ,aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX],isXML:!0,serializer:SQ},RQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:OG},default:{bodyMapper:VU,headersMapper:NG}},queryParameters:[aZ,rX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,EZ,aX,oX],isXML:!0,serializer:SQ},OQ={path:"/{containerName}/{blob}",httpMethod:"DELETE",responses:{200:{headersMapper:DG},default:{bodyMapper:VU,headersMapper:zG}},queryParameters:[aZ,rX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ],isXML:!0,serializer:SQ},NQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:LG},default:{bodyMapper:VU,headersMapper:BG}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"legalhold",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,{parameterPath:"legalHold",mapper:{serializedName:"x-ms-legal-hold",required:!0,xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}}],isXML:!0,serializer:SQ},DQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:FG},default:{bodyMapper:VU,headersMapper:jG}},queryParameters:[aZ,PZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX],isXML:!0,serializer:SQ},zQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:HG},default:{bodyMapper:VU,headersMapper:VG}},queryParameters:[aZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,RZ,OZ,NZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},LQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:UG},default:{bodyMapper:VU,headersMapper:qG}},queryParameters:[aZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,DZ,zZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},BQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:GG},default:{bodyMapper:VU,headersMapper:WG}},queryParameters:[aZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,zZ,LZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},FQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:ZG},default:{bodyMapper:VU,headersMapper:XG}},queryParameters:[aZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,zZ,jZ,HZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},jQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:KG},default:{bodyMapper:VU,headersMapper:YG}},queryParameters:[aZ,AZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,BZ,FZ,KZ,YZ,JZ],isXML:!0,serializer:SQ},HQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:JG},default:{bodyMapper:VU,headersMapper:QG}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"snapshot",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX],isXML:!0,serializer:SQ},VQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:$G},default:{bodyMapper:VU,headersMapper:eW}},queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,SZ,TZ,EZ,KZ,YZ,JZ,aX,oX,lX,uX,cX,hX,dX,fX,pX,mX,vX,{parameterPath:["options","sealBlob"],mapper:{serializedName:"x-ms-seal-blob",xmlName:"x-ms-seal-blob",type:{name:"Boolean"}}},gX],isXML:!0,serializer:SQ},UQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:tW},default:{bodyMapper:VU,headersMapper:nW}},queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,kZ,SZ,TZ,EZ,KZ,YZ,JZ,aX,oX,sX,lX,cX,hX,dX,fX,mX,vX,gX,{parameterPath:"xMsRequiresSync",mapper:{defaultValue:"true",isConstant:!0,serializedName:"x-ms-requires-sync",type:{name:"String"}}},yX,_X,xX],isXML:!0,serializer:SQ},qQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{204:{headersMapper:iW},default:{bodyMapper:VU,headersMapper:rW}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"copy",isConstant:!0,serializedName:"comp",type:{name:"String"}}},{parameterPath:"copyId",mapper:{serializedName:"copyid",required:!0,xmlName:"copyid",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,{parameterPath:"copyActionAbortConstant",mapper:{defaultValue:"abort",isConstant:!0,serializedName:"x-ms-copy-action",type:{name:"String"}}}],isXML:!0,serializer:SQ},GQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:aW},202:{headersMapper:aW},default:{bodyMapper:VU,headersMapper:oW}},queryParameters:[aZ,UZ,qZ,{parameterPath:"comp",mapper:{defaultValue:"tier",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,JZ,uX,{parameterPath:"tier",mapper:{serializedName:"x-ms-access-tier",required:!0,xmlName:"x-ms-access-tier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}}}],isXML:!0,serializer:SQ},WQ={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{headersMapper:sW},default:{bodyMapper:VU,headersMapper:lW}},queryParameters:[rZ,mZ],urlParameters:[nZ],headerParameters:[oZ,lZ],isXML:!0,serializer:SQ},ZQ={path:"/{containerName}/{blob}",httpMethod:"POST",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:uW},206:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:uW},default:{bodyMapper:VU,headersMapper:cW}},requestBody:bX,queryParameters:[aZ,UZ,{parameterPath:"comp",mapper:{defaultValue:"query",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:SQ},XQ={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:QU,headersMapper:hW},default:{bodyMapper:VU,headersMapper:dW}},queryParameters:[aZ,UZ,qZ,wX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,JZ],isXML:!0,serializer:SQ},KQ={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{204:{headersMapper:fW},default:{bodyMapper:VU,headersMapper:pW}},requestBody:kX,queryParameters:[aZ,qZ,wX],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,SZ,JZ,CX,SX],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:SQ},YQ=function(){function e(t,n){_classCallCheck(this,e);var i=new lQ(t.url,t.pipeline.toServiceClientOptions());this._url=t.url,void 0===t.name?(this._isContainer=!0,this._containerOrBlobOperation=new rK(i)):(this._isContainer=!1,this._containerOrBlobOperation=new CQ(i)),n||(n=wU()),this._leaseId=n}var t,n,i,r,a;return _createClass(e,[{key:"leaseId",get:function(){return this._leaseId}},{key:"url",get:function(){return this._url}},{key:"acquireLease",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h,d=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:{},u=cQ("BlobLeaseClient-acquireLease",n),c=u.span,h=u.updatedOptions,!this._isContainer||!((null===(i=n.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(r=n.conditions)||void 0===r?void 0:r.ifMatch)||(null===(a=n.conditions)||void 0===a?void 0:a.ifNoneMatch)&&""!==(null===(o=n.conditions)||void 0===o?void 0:o.ifNoneMatch)||(null===(s=n.conditions)||void 0===s?void 0:s.tagConditions))){e.next=4;break}throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");case 4:return e.prev=4,e.next=7,this._containerOrBlobOperation.acquireLease(Object.assign({abortSignal:n.abortSignal,duration:t,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(l=n.conditions)||void 0===l?void 0:l.tagConditions}),proposedLeaseId:this._leaseId},hQ(h)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),c.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,c.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,10,13,16]])}))),function(e){return a.apply(this,arguments)})},{key:"changeLease",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h,d,f=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:{},u=cQ("BlobLeaseClient-changeLease",n),c=u.span,h=u.updatedOptions,!this._isContainer||!((null===(i=n.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(r=n.conditions)||void 0===r?void 0:r.ifMatch)||(null===(a=n.conditions)||void 0===a?void 0:a.ifNoneMatch)&&""!==(null===(o=n.conditions)||void 0===o?void 0:o.ifNoneMatch)||(null===(s=n.conditions)||void 0===s?void 0:s.tagConditions))){e.next=4;break}throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");case 4:return e.prev=4,e.next=7,this._containerOrBlobOperation.changeLease(this._leaseId,t,Object.assign({abortSignal:n.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(l=n.conditions)||void 0===l?void 0:l.tagConditions})},hQ(h)));case 7:return d=e.sent,e.abrupt("return",(this._leaseId=t,d));case 11:throw e.prev=11,e.t0=e.catch(4),c.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,c.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[4,11,14,17]])}))),function(e){return r.apply(this,arguments)})},{key:"releaseLease",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:{},l=cQ("BlobLeaseClient-releaseLease",t),u=l.span,c=l.updatedOptions,!this._isContainer||!((null===(n=t.conditions)||void 0===n?void 0:n.ifMatch)&&""!==(null===(i=t.conditions)||void 0===i?void 0:i.ifMatch)||(null===(r=t.conditions)||void 0===r?void 0:r.ifNoneMatch)&&""!==(null===(a=t.conditions)||void 0===a?void 0:a.ifNoneMatch)||(null===(o=t.conditions)||void 0===o?void 0:o.tagConditions))){e.next=4;break}throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");case 4:return e.prev=4,e.next=7,this._containerOrBlobOperation.releaseLease(this._leaseId,Object.assign({abortSignal:t.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(s=t.conditions)||void 0===s?void 0:s.tagConditions})},hQ(c)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),u.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,u.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,10,13,16]])}))),function(){return i.apply(this,arguments)})},{key:"renewLease",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:{},l=cQ("BlobLeaseClient-renewLease",t),u=l.span,c=l.updatedOptions,!this._isContainer||!((null===(n=t.conditions)||void 0===n?void 0:n.ifMatch)&&""!==(null===(i=t.conditions)||void 0===i?void 0:i.ifMatch)||(null===(r=t.conditions)||void 0===r?void 0:r.ifNoneMatch)&&""!==(null===(a=t.conditions)||void 0===a?void 0:a.ifNoneMatch)||(null===(o=t.conditions)||void 0===o?void 0:o.tagConditions))){e.next=4;break}throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");case 4:return e.prev=4,e.next=7,this._containerOrBlobOperation.renewLease(this._leaseId,Object.assign({abortSignal:t.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(s=t.conditions)||void 0===s?void 0:s.tagConditions})},hQ(c)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),u.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,u.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,10,13,16]])}))),function(){return n.apply(this,arguments)})},{key:"breakLease",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h,d,f=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:{},u=cQ("BlobLeaseClient-breakLease",n),c=u.span,h=u.updatedOptions,!this._isContainer||!((null===(i=n.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(r=n.conditions)||void 0===r?void 0:r.ifMatch)||(null===(a=n.conditions)||void 0===a?void 0:a.ifNoneMatch)&&""!==(null===(o=n.conditions)||void 0===o?void 0:o.ifNoneMatch)||(null===(s=n.conditions)||void 0===s?void 0:s.tagConditions))){e.next=4;break}throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");case 4:return e.prev=4,d=Object.assign({abortSignal:n.abortSignal,breakPeriod:t,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(l=n.conditions)||void 0===l?void 0:l.tagConditions})},hQ(h)),e.next=8,this._containerOrBlobOperation.breakLease(d);case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(4),c.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,c.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[4,11,14,17]])}))),function(e){return t.apply(this,arguments)})}]),e}(),JQ=function(){function e(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,e),this.originalResponse=t}return _createClass(e,[{key:"acceptRanges",get:function(){return this.originalResponse.acceptRanges}},{key:"cacheControl",get:function(){return this.originalResponse.cacheControl}},{key:"contentDisposition",get:function(){return this.originalResponse.contentDisposition}},{key:"contentEncoding",get:function(){return this.originalResponse.contentEncoding}},{key:"contentLanguage",get:function(){return this.originalResponse.contentLanguage}},{key:"blobSequenceNumber",get:function(){return this.originalResponse.blobSequenceNumber}},{key:"blobType",get:function(){return this.originalResponse.blobType}},{key:"contentLength",get:function(){return this.originalResponse.contentLength}},{key:"contentMD5",get:function(){return this.originalResponse.contentMD5}},{key:"contentRange",get:function(){return this.originalResponse.contentRange}},{key:"contentType",get:function(){return this.originalResponse.contentType}},{key:"copyCompletedOn",get:function(){}},{key:"copyId",get:function(){return this.originalResponse.copyId}},{key:"copyProgress",get:function(){return this.originalResponse.copyProgress}},{key:"copySource",get:function(){return this.originalResponse.copySource}},{key:"copyStatus",get:function(){return this.originalResponse.copyStatus}},{key:"copyStatusDescription",get:function(){return this.originalResponse.copyStatusDescription}},{key:"leaseDuration",get:function(){return this.originalResponse.leaseDuration}},{key:"leaseState",get:function(){return this.originalResponse.leaseState}},{key:"leaseStatus",get:function(){return this.originalResponse.leaseStatus}},{key:"date",get:function(){return this.originalResponse.date}},{key:"blobCommittedBlockCount",get:function(){return this.originalResponse.blobCommittedBlockCount}},{key:"etag",get:function(){return this.originalResponse.etag}},{key:"errorCode",get:function(){return this.originalResponse.errorCode}},{key:"isServerEncrypted",get:function(){return this.originalResponse.isServerEncrypted}},{key:"blobContentMD5",get:function(){return this.originalResponse.blobContentMD5}},{key:"lastModified",get:function(){return this.originalResponse.lastModified}},{key:"metadata",get:function(){return this.originalResponse.metadata}},{key:"requestId",get:function(){return this.originalResponse.requestId}},{key:"clientRequestId",get:function(){return this.originalResponse.clientRequestId}},{key:"version",get:function(){return this.originalResponse.version}},{key:"encryptionKeySha256",get:function(){return this.originalResponse.encryptionKeySha256}},{key:"contentCrc64",get:function(){return this.originalResponse.contentCrc64}},{key:"blobBody",get:function(){throw Error("Quick query in browser is not supported yet.")}},{key:"readableStreamBody",get:function(){}},{key:"_response",get:function(){return this.originalResponse._response}}]),e}(),QQ=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"create",value:function(e,t){var n={contentLength:e,options:uU(t||{})};return this.client.sendOperationRequest(n,t$)}},{key:"appendBlock",value:function(e,t,n){var i={contentLength:e,body:t,options:uU(n||{})};return this.client.sendOperationRequest(i,n$)}},{key:"appendBlockFromUrl",value:function(e,t,n){var i={sourceUrl:e,contentLength:t,options:uU(n||{})};return this.client.sendOperationRequest(i,i$)}},{key:"seal",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,r$)}}]),e}(),$Q=new SU(r,!0),e$=new SU(r,!1),t$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:OW},default:{bodyMapper:VU,headersMapper:NW}},queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX,aX,oX,sX,vX,gX,{parameterPath:"blobType",mapper:{defaultValue:"AppendBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}}],isXML:!0,serializer:$Q},n$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:DW},default:{bodyMapper:VU,headersMapper:zW}},requestBody:MX,queryParameters:[aZ,FX],urlParameters:[nZ],headerParameters:[oZ,sZ,yZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,CX,SX,PX,IX,jX,HX],mediaType:"binary",serializer:e$},i$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:LW},default:{bodyMapper:VU,headersMapper:BW}},queryParameters:[aZ,FX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,cX,hX,dX,fX,yX,_X,CX,zX,LX,jX,HX,VX],isXML:!0,serializer:$Q},r$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:FW},default:{bodyMapper:VU,headersMapper:jW}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"seal",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,KZ,YZ,HX],isXML:!0,serializer:$Q},a$=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"upload",value:function(e,t,n){var i={contentLength:e,body:t,options:uU(n||{})};return this.client.sendOperationRequest(i,l$)}},{key:"putBlobFromUrl",value:function(e,t,n){var i={contentLength:e,copySource:t,options:uU(n||{})};return this.client.sendOperationRequest(i,u$)}},{key:"stageBlock",value:function(e,t,n,i){var r={blockId:e,contentLength:t,body:n,options:uU(i||{})};return this.client.sendOperationRequest(r,c$)}},{key:"stageBlockFromURL",value:function(e,t,n,i){var r={blockId:e,contentLength:t,sourceUrl:n,options:uU(i||{})};return this.client.sendOperationRequest(r,h$)}},{key:"commitBlockList",value:function(e,t){var n={blocks:e,options:uU(t||{})};return this.client.sendOperationRequest(n,d$)}},{key:"getBlockList",value:function(e,t){var n={listType:e,options:uU(t||{})};return this.client.sendOperationRequest(n,f$)}}]),e}(),o$=new SU(r,!0),s$=new SU(r,!1),l$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:HW},default:{bodyMapper:VU,headersMapper:VW}},requestBody:MX,queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,yZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX,aX,oX,sX,lX,vX,gX,CX,SX,PX,IX,UX],mediaType:"binary",serializer:s$},u$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:UW},default:{bodyMapper:VU,headersMapper:qW}},queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX,sX,lX,cX,hX,dX,fX,pX,mX,vX,yX,_X,xX,CX,UX,{parameterPath:["options","copySourceBlobProperties"],mapper:{serializedName:"x-ms-copy-source-blob-properties",xmlName:"x-ms-copy-source-blob-properties",type:{name:"Boolean"}}}],isXML:!0,serializer:o$},c$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:GW},default:{bodyMapper:VU,headersMapper:WW}},requestBody:MX,queryParameters:[aZ,qX,GX],urlParameters:[nZ],headerParameters:[oZ,sZ,yZ,SZ,WZ,ZZ,XZ,sX,CX,SX,PX,IX],mediaType:"binary",serializer:s$},h$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:ZW},default:{bodyMapper:VU,headersMapper:XW}},queryParameters:[aZ,qX,GX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,SZ,WZ,ZZ,XZ,sX,cX,hX,dX,fX,yX,_X,zX,LX,VX],isXML:!0,serializer:o$},d$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:KW},default:{bodyMapper:VU,headersMapper:YW}},requestBody:WX,queryParameters:[aZ,ZX],urlParameters:[nZ],headerParameters:[$W,tZ,oZ,sZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX,aX,oX,sX,lX,vX,gX,CX,SX],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:o$},f$={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:hq,headersMapper:JW},default:{bodyMapper:VU,headersMapper:QW}},queryParameters:[aZ,UZ,ZX,{parameterPath:"listType",mapper:{defaultValue:"committed",serializedName:"blocklisttype",required:!0,xmlName:"blocklisttype",type:{name:"Enum",allowedValues:["committed","uncommitted","all"]}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,JZ],isXML:!0,serializer:o$},p$=function(){function e(t){_classCallCheck(this,e),this.client=t}return _createClass(e,[{key:"create",value:function(e,t,n){var i={contentLength:e,blobContentLength:t,options:uU(n||{})};return this.client.sendOperationRequest(i,g$)}},{key:"uploadPages",value:function(e,t,n){var i={contentLength:e,body:t,options:uU(n||{})};return this.client.sendOperationRequest(i,y$)}},{key:"clearPages",value:function(e,t){var n={contentLength:e,options:uU(t||{})};return this.client.sendOperationRequest(n,_$)}},{key:"uploadPagesFromURL",value:function(e,t,n,i,r){var a={sourceUrl:e,sourceRange:t,contentLength:n,range:i,options:uU(r||{})};return this.client.sendOperationRequest(a,x$)}},{key:"getPageRanges",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,b$)}},{key:"getPageRangesDiff",value:function(e){var t={options:uU(e||{})};return this.client.sendOperationRequest(t,w$)}},{key:"resize",value:function(e,t){var n={blobContentLength:e,options:uU(t||{})};return this.client.sendOperationRequest(n,k$)}},{key:"updateSequenceNumber",value:function(e,t){var n={sequenceNumberAction:e,options:uU(t||{})};return this.client.sendOperationRequest(n,C$)}},{key:"copyIncremental",value:function(e,t){var n={copySource:e,options:uU(t||{})};return this.client.sendOperationRequest(n,S$)}}]),e}(),m$=new SU(r,!0),v$=new SU(r,!1),g$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:mW},default:{bodyMapper:VU,headersMapper:vW}},queryParameters:[aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,kZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,QZ,$Z,eX,tX,nX,iX,aX,oX,sX,lX,vX,gX,{parameterPath:"blobType",mapper:{defaultValue:"PageBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}},TX,EX],isXML:!0,serializer:m$},y$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:gW},default:{bodyMapper:VU,headersMapper:yW}},requestBody:MX,queryParameters:[aZ,AX],urlParameters:[nZ],headerParameters:[oZ,sZ,yZ,SZ,TZ,EZ,GZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,CX,SX,PX,IX,RX,OX,NX,DX],mediaType:"binary",serializer:v$},_$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:_W},default:{bodyMapper:VU,headersMapper:xW}},queryParameters:[aZ,AX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,SZ,TZ,EZ,GZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,OX,NX,DX,{parameterPath:"pageWrite",mapper:{defaultValue:"clear",isConstant:!0,serializedName:"x-ms-page-write",type:{name:"String"}}}],isXML:!0,serializer:m$},x$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:bW},default:{bodyMapper:VU,headersMapper:wW}},queryParameters:[aZ,AX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,yZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,cX,hX,dX,fX,yX,_X,RX,OX,NX,DX,zX,{parameterPath:"sourceRange",mapper:{serializedName:"x-ms-source-range",required:!0,xmlName:"x-ms-source-range",type:{name:"String"}}},LX,{parameterPath:"range",mapper:{serializedName:"x-ms-range",required:!0,xmlName:"x-ms-range",type:{name:"String"}}}],isXML:!0,serializer:m$},b$={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:fq,headersMapper:kW},default:{bodyMapper:VU,headersMapper:CW}},queryParameters:[aZ,hZ,dZ,UZ,BX],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,GZ,KZ,YZ,JZ],isXML:!0,serializer:m$},w$={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:fq,headersMapper:SW},default:{bodyMapper:VU,headersMapper:TW}},queryParameters:[aZ,hZ,dZ,UZ,BX,{parameterPath:["options","prevsnapshot"],mapper:{serializedName:"prevsnapshot",xmlName:"prevsnapshot",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,GZ,KZ,YZ,JZ,{parameterPath:["options","prevSnapshotUrl"],mapper:{serializedName:"x-ms-previous-snapshot-url",xmlName:"x-ms-previous-snapshot-url",type:{name:"String"}}}],isXML:!0,serializer:m$},k$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:EW},default:{bodyMapper:VU,headersMapper:PW}},queryParameters:[rZ,aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,WZ,ZZ,XZ,KZ,YZ,JZ,sX,TX],isXML:!0,serializer:m$},C$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:MW},default:{bodyMapper:VU,headersMapper:IW}},queryParameters:[rZ,aZ],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,SZ,TZ,EZ,KZ,YZ,JZ,EX,{parameterPath:"sequenceNumberAction",mapper:{serializedName:"x-ms-sequence-number-action",required:!0,xmlName:"x-ms-sequence-number-action",type:{name:"Enum",allowedValues:["max","update","increment"]}}}],isXML:!0,serializer:m$},S$={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:AW},default:{bodyMapper:VU,headersMapper:RW}},queryParameters:[aZ,{parameterPath:"comp",mapper:{defaultValue:"incrementalcopy",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[nZ],headerParameters:[oZ,sZ,lZ,TZ,EZ,KZ,YZ,JZ,mX],isXML:!0,serializer:m$};function T$(e){if(void 0!==e)return e}function E$(e,t){if(e&&!t)throw new RangeError("Customer-provided encryption key must be used over HTTPS.");e&&!e.encryptionAlgorithm&&(e.encryptionAlgorithm="AES256")}function P$(e){var t=(e._response.parsedBody.pageRange||[]).map((function(e){return{offset:e.start,count:e.end-e.start}})),n=(e._response.parsedBody.clearRange||[]).map((function(e){return{offset:e.start,count:e.end-e.start}}));return Object.assign(Object.assign({},e),{pageRange:t,clearRange:n,_response:Object.assign(Object.assign({},e._response),{parsedBody:{pageRange:t,clearRange:n}})})}!function(e){e.Hot="Hot",e.Cool="Cool",e.Cold="Cold",e.Archive="Archive"}(bQ||(bQ={})),function(e){e.P4="P4",e.P6="P6",e.P10="P10",e.P15="P15",e.P20="P20",e.P30="P30",e.P40="P40",e.P50="P50",e.P60="P60",e.P70="P70",e.P80="P80"}(wQ||(wQ={})),function(e){e.StorageOAuthScopes="https://storage.azure.com/.default",e.DiskComputeOAuthScopes="https://disk.compute.azure.com/.default"}(kQ||(kQ={}));var M$=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="PollerStoppedError",Object.setPrototypeOf(_assertThisInitialized2(n),t.prototype),n}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t)}(),I$=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="PollerCancelledError",Object.setPrototypeOf(_assertThisInitialized2(n),t.prototype),n}return _inherits(t,_wrapNativeSuper2(Error)),_createClass(t)}(),A$=function(e){function t(e){var n;_classCallCheck(this,t);var i,r=e.blobClient,a=e.copySource,o=e.intervalInMs,s=void 0===o?15e3:o,l=e.onProgress,u=e.resumeFrom,c=e.startCopyFromURLOptions;return u&&(i=JSON.parse(u).state),n=_callSuper(this,t,[D$(Object.assign(Object.assign({},i),{blobClient:r,copySource:a,startCopyFromURLOptions:c}))]),"function"==typeof l&&n.onProgress(l),n.intervalInMs=s,n}return _inherits(t,e),_createClass(t,[{key:"delay",value:function(){return PJ(this.intervalInMs)}}]),t}(function(){function e(t){var n=this;_classCallCheck(this,e),this.resolveOnUnsuccessful=!1,this.stopped=!0,this.pollProgressCallbacks=[],this.operation=t,this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),this.promise.catch((function(){}))}var t,n,i,r;return _createClass(e,[{key:"startPolling",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:{},this.stopped&&(this.stopped=!1);case 2:if(this.isStopped()||this.isDone()){e.next=9;break}return e.next=5,this.poll(t);case 5:return e.next=7,this.delay();case 7:e.next=2;break;case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"pollOnce",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},e.t0=this.isDone(),e.t0){e.next=6;break}return e.next=5,this.operation.update({abortSignal:t.abortSignal,fireProgress:this.fireProgress.bind(this)});case 5:this.operation=e.sent;case 6:this.processUpdatedState();case 7:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"fireProgress",value:function(e){var t,n=_createForOfIteratorHelper(this.pollProgressCallbacks);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(U5){n.e(U5)}finally{n.f()}}},{key:"cancelOnce",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,this.operation.cancel(t);case 3:this.operation=e.sent;case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"poll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.pollOncePromise){this.pollOncePromise=this.pollOnce(t);var n=function(){e.pollOncePromise=void 0};this.pollOncePromise.then(n,n).catch(this.reject)}return this.pollOncePromise}},{key:"processUpdatedState",value:function(){if(this.operation.state.error&&(this.stopped=!0,!this.resolveOnUnsuccessful))throw this.reject(this.operation.state.error),this.operation.state.error;if(this.operation.state.isCancelled&&(this.stopped=!0,!this.resolveOnUnsuccessful)){var e=new I$("Operation was canceled");throw this.reject(e),e}this.isDone()&&this.resolve&&this.resolve(this.getResult())}},{key:"pollUntilDone",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",(this.stopped&&this.startPolling(t).catch(this.reject),this.processUpdatedState(),this.promise));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onProgress",value:function(e){var t=this;return this.pollProgressCallbacks.push(e),function(){t.pollProgressCallbacks=t.pollProgressCallbacks.filter((function(t){return t!==e}))}}},{key:"isDone",value:function(){var e=this.operation.state;return Boolean(e.isCompleted||e.isCancelled||e.error)}},{key:"stopPolling",value:function(){this.stopped||(this.stopped=!0,this.reject&&this.reject(new M$("This poller is already stopped")))}},{key:"isStopped",value:function(){return this.stopped}},{key:"cancelOperation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.cancelPromise){if(e.abortSignal)throw new Error("A cancel request is currently pending")}else this.cancelPromise=this.cancelOnce(e);return this.cancelPromise}},{key:"getOperationState",value:function(){return this.operation.state}},{key:"getResult",value:function(){return this.operation.state.result}},{key:"toString",value:function(){return this.operation.toString()}}]),e}()),R$=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},n=this.state,i=n.copyId,!n.isCompleted){e.next=6;break}e.t0=D$(n),e.next=15;break;case 6:if(!i){e.next=13;break}return e.next=9,n.blobClient.abortCopyFromURL(i,{abortSignal:t.abortSignal});case 9:n.isCancelled=!0,e.t1=D$(n),e.next=14;break;case 13:e.t1=(n.isCancelled=!0,D$(n));case 14:e.t0=e.t1;case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),O$=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:{},n=this.state,i=n.blobClient,r=n.copySource,a=n.startCopyFromURLOptions,!n.isStarted){e.next=19;break}if(n.isCompleted){e.next=17;break}return e.prev=4,e.next=7,n.blobClient.getProperties({abortSignal:t.abortSignal});case 7:o=e.sent,s=o.copyStatus,l=o.copyProgress,u=n.copyProgress,l&&(n.copyProgress=l),"pending"===s&&l!==u&&"function"==typeof t.fireProgress?t.fireProgress(n):"success"===s?(n.result=o,n.isCompleted=!0):"failed"===s&&(n.error=new Error('Blob copy failed with reason: "'.concat(o.copyStatusDescription||"unknown",'"')),n.isCompleted=!0),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.error=e.t0,n.isCompleted=!0;case 17:e.next=24;break;case 19:return n.isStarted=!0,e.next=22,i.startCopyFromURL(r,a);case 22:c=e.sent,n.copyId=c.copyId,"success"===c.copyStatus&&(n.result=c,n.isCompleted=!0);case 24:return e.abrupt("return",D$(n));case 25:case"end":return e.stop()}}),e,this,[[4,14]])})));return function(){return e.apply(this,arguments)}}(),N$=function(){return JSON.stringify({state:this.state},(function(e,t){if("blobClient"!==e)return t}))};function D$(e){return{state:Object.assign({},e),cancel:R$,toString:N$,update:O$}}function z$(e){if(e.offset<0)throw new RangeError("Range.offset cannot be smaller than 0.");if(e.count&&e.count<=0)throw new RangeError("Range.count must be larger than 0. Leave it undefined if you want a range from offset to the end.");return e.count?"bytes=".concat(e.offset,"-").concat(e.offset+e.count-1):"bytes=".concat(e.offset,"-")}var L$,B$,F$=n("+qE3");!function(e){e[e.Good=0]="Good",e[e.Error=1]="Error"}(L$||(L$={}));var j$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;if(_classCallCheck(this,e),this.actives=0,this.completed=0,this.offset=0,this.operations=[],this.state=L$.Good,t<1)throw new RangeError("concurrency must be larger than 0");this.concurrency=t,this.emitter=new F$.EventEmitter}var t;return _createClass(e,[{key:"addOperation",value:function(e){var t=this;this.operations.push(_asyncToGenerator(_regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.actives++,n.next=4,e();case 4:t.actives--,t.completed++,t.parallelExecute(),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),t.emitter.emit("error",n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])}))))}},{key:"do",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",0===this.operations.length?Promise.resolve():(this.parallelExecute(),new Promise((function(e,n){t.emitter.on("finish",e),t.emitter.on("error",(function(e){t.state=L$.Error,n(e)}))}))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"nextOperation",value:function(){return this.offset<this.operations.length?this.operations[this.offset++]:null}},{key:"parallelExecute",value:function(){if(this.state!==L$.Error)if(this.completed>=this.operations.length)this.emitter.emit("finish");else for(;this.actives<this.concurrency;){var e=this.nextOperation();if(!e)return;e()}}}]),e}(),H$=_createClass((function e(){_classCallCheck(this,e)})),V$=function(e){function t(e,n,i,r){var a,o,s,l;if(_classCallCheck(this,t),r=r||{},AJ(n))l=e,s=n;else if(uV&&n instanceof DJ||n instanceof _J||cV(n))l=e,s=OJ(n,r=i);else if(n||"string"==typeof n){if(!n||"string"!=typeof n||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");var u=n,c=i,h=HY(e);if("AccountConnString"===h.kind){if(!uV)throw new Error("Account connection string is only supported in Node.js environment");var d=new DJ(h.accountName,h.accountKey);l=VY(VY(h.url,encodeURIComponent(u)),encodeURIComponent(c)),r.proxyOptions||(r.proxyOptions=void 0),s=OJ(d,r)}else{if("SASConnString"!==h.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");l=VY(VY(h.url,encodeURIComponent(u)),encodeURIComponent(c))+"?"+h.accountSas,s=OJ(new _J,r)}}else l=e,i&&"string"!=typeof i&&(r=i),s=OJ(new _J,r);return a=(o=_callSuper(this,t,[l,s])).getBlobAndContainerNamesFromUrl(),o._name=a.blobName,o._containerName=a.containerName,o.blobContext=new CQ(o.storageClientContext),o._snapshot=qY(o.url,"snapshot"),o._versionId=qY(o.url,"versionid"),o}var n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y,_,x,b,w;return _inherits(t,e),_createClass(t,[{key:"name",get:function(){return this._name}},{key:"containerName",get:function(){return this._containerName}},{key:"withSnapshot",value:function(e){return new t(UY(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}},{key:"withVersion",value:function(e){return new t(UY(this.url,"versionid",0===e.length?void 0:e),this.pipeline)}},{key:"getAppendBlobClient",value:function(){return new U$(this.url,this.pipeline)}},{key:"getBlockBlobClient",value:function(){return new q$(this.url,this.pipeline)}},{key:"getPageBlobClient",value:function(){return new G$(this.url,this.pipeline)}},{key:"download",value:(w=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c=this,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:0,n=h.length>1?h[1]:void 0,(i=h.length>2&&void 0!==h[2]?h[2]:{}).conditions=i.conditions||{},i.conditions=i.conditions||{},E$(i.customerProvidedKey,this.isHttps),a=cQ("BlobClient-download",i),o=a.span,s=a.updatedOptions,e.prev=5,e.next=8,this.blobContext.download(Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions}),requestOptions:{onDownloadProgress:uV?void 0:i.onProgress},range:0!==t||n?z$({offset:t,count:n}):void 0,rangeGetContentMD5:i.rangeGetContentMD5,rangeGetContentCRC64:i.rangeGetContentCrc64,snapshot:i.snapshot,cpkInfo:i.customerProvidedKey},hQ(s)));case 8:if(l=e.sent,u=Object.assign(Object.assign({},l),{_response:l._response,objectReplicationDestinationPolicyId:l.objectReplicationPolicyId,objectReplicationSourceProperties:iJ(l.objectReplicationRules)}),uV){e.next=12;break}return e.abrupt("return",u);case 12:if((void 0===i.maxRetryRequests||i.maxRetryRequests<0)&&(i.maxRetryRequests=5),void 0!==l.contentLength){e.next=14;break}throw new RangeError("File download response doesn't contain valid content length header");case 14:if(l.etag){e.next=16;break}throw new RangeError("File download response doesn't contain valid etag header");case 16:return e.abrupt("return",new 1(u,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={leaseAccessConditions:i.conditions,modifiedAccessConditions:{ifMatch:i.conditions.ifMatch||l.etag,ifModifiedSince:i.conditions.ifModifiedSince,ifNoneMatch:i.conditions.ifNoneMatch,ifUnmodifiedSince:i.conditions.ifUnmodifiedSince,ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions},range:z$({count:t+l.contentLength-n,offset:n}),rangeGetContentMD5:i.rangeGetContentMD5,rangeGetContentCRC64:i.rangeGetContentCrc64,snapshot:i.snapshot,cpkInfo:i.customerProvidedKey},e.next=3,c.blobContext.download(Object.assign({abortSignal:i.abortSignal},a));case 3:return e.abrupt("return",e.sent.readableStreamBody);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t,l.contentLength,{maxRetryRequests:i.maxRetryRequests,onProgress:i.onProgress}));case 19:throw e.prev=19,e.t0=e.catch(5),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 22:return e.prev=22,o.end(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[5,19,22,25]])}))),function(){return w.apply(this,arguments)})},{key:"exists",value:(b=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("BlobClient-exists",t),i=n.span,r=n.updatedOptions,e.prev=2,E$(t.customerProvidedKey,this.isHttps),e.next=6,this.getProperties({abortSignal:t.abortSignal,customerProvidedKey:t.customerProvidedKey,conditions:t.conditions,tracingOptions:r.tracingOptions});case 6:return e.abrupt("return",!0);case 9:if(e.prev=9,e.t0=e.catch(2),404!==e.t0.statusCode){e.next=13;break}return e.abrupt("return",!1);case 13:if(409!==e.t0.statusCode||"BlobUsesCustomerSpecifiedEncryption"!==e.t0.details.errorCode&&"BlobDoesNotUseCustomerSpecifiedEncryption"!==e.t0.details.errorCode){e.next=15;break}return e.abrupt("return",!0);case 15:throw i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 16:return e.prev=16,i.end(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,9,16,19]])}))),function(){return b.apply(this,arguments)})},{key:"getProperties",value:(x=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},i=cQ("BlobClient-getProperties",t),r=i.span,a=i.updatedOptions,e.prev=2,t.conditions=t.conditions||{},E$(t.customerProvidedKey,this.isHttps),e.next=6,this.blobContext.getProperties(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions}),cpkInfo:t.customerProvidedKey},hQ(a)));case 6:return o=e.sent,e.abrupt("return",Object.assign(Object.assign({},o),{_response:o._response,objectReplicationDestinationPolicyId:o.objectReplicationPolicyId,objectReplicationSourceProperties:iJ(o.objectReplicationRules)}));case 10:throw e.prev=10,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,r.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(){return x.apply(this,arguments)})},{key:"delete",value:(_=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},i=cQ("BlobClient-delete",t),r=i.span,a=i.updatedOptions,t.conditions=t.conditions||{},e.prev=3,e.next=6,this.blobContext.delete(Object.assign({abortSignal:t.abortSignal,deleteSnapshots:t.deleteSnapshots,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions})},hQ(a)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(){return _.apply(this,arguments)})},{key:"deleteIfExists",value:(y=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=cQ("BlobClient-deleteIfExists",t),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.delete(o);case 5:return s=e.sent,e.abrupt("return",Object.assign(Object.assign({succeeded:!0},s),{_response:s._response}));case 9:if(e.prev=9,e.t0=e.catch(2),"BlobNotFound"!==(null===(n=e.t0.details)||void 0===n?void 0:n.errorCode)){e.next=13;break}return e.abrupt("return",(a.setStatus({code:sU.ERROR,message:"Expected exception when deleting a blob or snapshot only if it exists."}),Object.assign(Object.assign({succeeded:!1},null===(i=e.t0.response)||void 0===i?void 0:i.parsedHeaders),{_response:e.t0.response})));case 13:throw a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,a.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,9,14,17]])}))),function(){return y.apply(this,arguments)})},{key:"undelete",value:(g=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("BlobClient-undelete",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.blobContext.undelete(Object.assign({abortSignal:t.abortSignal},hQ(r)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,i.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(){return g.apply(this,arguments)})},{key:"setHTTPHeaders",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=cQ("BlobClient-setHTTPHeaders",n),a=r.span,o=r.updatedOptions,n.conditions=n.conditions||{},e.prev=3,E$(n.customerProvidedKey,this.isHttps),e.next=7,this.blobContext.setHttpHeaders(Object.assign({abortSignal:n.abortSignal,blobHttpHeaders:t,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions})},hQ(o)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,a.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e){return v.apply(this,arguments)})},{key:"setMetadata",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=cQ("BlobClient-setMetadata",n),a=r.span,o=r.updatedOptions,n.conditions=n.conditions||{},e.prev=3,E$(n.customerProvidedKey,this.isHttps),e.next=7,this.blobContext.setMetadata(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,metadata:t,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope},hQ(o)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,a.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e){return m.apply(this,arguments)})},{key:"setTags",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=cQ("BlobClient-setTags",n),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.blobContext.setTags(Object.assign(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions})},hQ(o)),{tags:eJ(t)}));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,a.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return p.apply(this,arguments)})},{key:"getTags",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},i=cQ("BlobClient-getTags",t),r=i.span,a=i.updatedOptions,e.prev=2,e.next=5,this.blobContext.getTags(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions})},hQ(a)));case 5:return o=e.sent,e.abrupt("return",Object.assign(Object.assign({},o),{_response:o._response,tags:tJ({blobTagSet:o.blobTagSet})||{}}));case 9:throw e.prev=9,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(){return f.apply(this,arguments)})},{key:"getBlobLeaseClient",value:function(e){return new YQ(this,e)}},{key:"createSnapshot",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},i=cQ("BlobClient-createSnapshot",t),r=i.span,a=i.updatedOptions,t.conditions=t.conditions||{},e.prev=3,E$(t.customerProvidedKey,this.isHttps),e.next=7,this.blobContext.createSnapshot(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,metadata:t.metadata,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions}),cpkInfo:t.customerProvidedKey,encryptionScope:t.encryptionScope},hQ(a)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,r.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(){return d.apply(this,arguments)})},{key:"beginCopyFromURL",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r=this,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},i=new A$({blobClient:{abortCopyFromURL:function(){return r.abortCopyFromURL.apply(r,arguments)},getProperties:function(){return r.getProperties.apply(r,arguments)},startCopyFromURL:function(){return r.startCopyFromURL.apply(r,arguments)}},copySource:t,intervalInMs:n.intervalInMs,onProgress:n.onProgress,resumeFrom:n.resumeFrom,startCopyFromURLOptions:n}),e.next=4,i.poll();case 4:return e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"abortCopyFromURL",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},i=cQ("BlobClient-abortCopyFromURL",n),r=i.span,a=i.updatedOptions,e.prev=2,e.next=5,this.blobContext.abortCopyFromURL(t,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions},hQ(a)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,r.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return c.apply(this,arguments)})},{key:"syncCopyFromURL",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},o=cQ("BlobClient-syncCopyFromURL",n),s=o.span,l=o.updatedOptions,n.conditions=n.conditions||{},n.sourceConditions=n.sourceConditions||{},e.prev=3,e.next=6,this.blobContext.copyFromURL(t,Object.assign({abortSignal:n.abortSignal,metadata:n.metadata,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:n.sourceConditions.ifMatch,sourceIfModifiedSince:n.sourceConditions.ifModifiedSince,sourceIfNoneMatch:n.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:n.sourceConditions.ifUnmodifiedSince},sourceContentMD5:n.sourceContentMD5,copySourceAuthorization:aJ(n.sourceAuthorization),tier:T$(n.tier),blobTagsString:$Y(n.tags),immutabilityPolicyExpiry:null===(r=n.immutabilityPolicy)||void 0===r?void 0:r.expiriesOn,immutabilityPolicyMode:null===(a=n.immutabilityPolicy)||void 0===a?void 0:a.policyMode,legalHold:n.legalHold,encryptionScope:n.encryptionScope,copySourceTags:n.copySourceTags},hQ(l)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,s.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e){return u.apply(this,arguments)})},{key:"setAccessTier",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=cQ("BlobClient-setAccessTier",n),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.blobContext.setTier(T$(t),Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),rehydratePriority:n.rehydratePriority},hQ(o)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,a.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return l.apply(this,arguments)})},{key:"downloadToBuffer",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u,c,h,d,f,p,m,v,g=this,y=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>3&&void 0!==y[3]?y[3]:{},o=0,s=0,l=r,t instanceof Buffer?(a=t,o=n||0,s="number"==typeof i?i:0):(o="number"==typeof t?t:0,s="number"==typeof n?n:0,l=i||{}),u=cQ("BlobClient-downloadToBuffer",l),c=u.span,h=u.updatedOptions,e.prev=4,l.blockSize||(l.blockSize=0),!(l.blockSize<0)){e.next=7;break}throw new RangeError("blockSize option must be >= 0");case 7:if(0===l.blockSize&&(l.blockSize=4194304),!(o<0)){e.next=9;break}throw new RangeError("offset option must be >= 0");case 9:if(!(s&&s<=0)){e.next=11;break}throw new RangeError("count option must be greater than 0");case 11:if(l.conditions||(l.conditions={}),s){e.next=17;break}return e.next=14,this.getProperties(Object.assign(Object.assign({},l),{tracingOptions:Object.assign(Object.assign({},l.tracingOptions),hQ(h))}));case 14:if(d=e.sent,!((s=d.contentLength-o)<0)){e.next=17;break}throw new RangeError("offset ".concat(o," shouldn't be larger than blob size ").concat(d.contentLength));case 17:if(a){e.next=25;break}e.prev=18,a=Buffer.alloc(s),e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(18),new Error("Unable to allocate the buffer of size: ".concat(s,'(in bytes). Please try passing your own buffer to the "downloadToBuffer" method or try using other methods like "download" or "downloadToFile".\t ').concat(e.t0.message));case 25:if(!(a.length<s)){e.next=27;break}throw new RangeError("The buffer's size should be equal to or larger than the request count of bytes: "+s);case 27:f=0,p=new j$(l.concurrency),m=_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.addOperation(_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o+s,t+l.blockSize<n&&(n=t+l.blockSize),e.next=4,g.download(t,n-t,{abortSignal:l.abortSignal,conditions:l.conditions,maxRetryRequests:l.maxRetryRequestsPerBlock,customerProvidedKey:l.customerProvidedKey,tracingOptions:Object.assign(Object.assign({},l.tracingOptions),hQ(h))});case 4:return void(e.next=6);case 6:f+=n-t,l.onProgress&&l.onProgress({loadedBytes:f});case 8:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})),v=o;case 31:if(!(v<o+s)){e.next=36;break}return e.delegateYield(m(v),"t1",33);case 33:v+=l.blockSize,e.next=31;break;case 36:return e.next=38,p.do();case 38:return e.abrupt("return",a);case 41:throw e.prev=41,e.t2=e.catch(4),c.setStatus({code:sU.ERROR,message:e.t2.message}),e.t2;case 44:return e.prev=44,c.end(),e.finish(44);case 47:case"end":return e.stop()}}),e,this,[[4,41,44,47],[18,22]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"downloadToFile",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:0,i=u.length>2?u[2]:void 0,r=u.length>3&&void 0!==u[3]?u[3]:{},a=cQ("BlobClient-downloadToFile",r),o=a.span,s=a.updatedOptions,e.prev=4,e.next=7,this.download(n,i,Object.assign(Object.assign({},r),{tracingOptions:Object.assign(Object.assign({},r.tracingOptions),hQ(s))}));case 7:if(l=e.sent,e.t0=l.readableStreamBody,!e.t0){e.next=12;break}return void(e.next=12);case 12:return l.blobDownloadStream=void 0,e.abrupt("return",l);case 16:throw e.prev=16,e.t1=e.catch(4),o.setStatus({code:sU.ERROR,message:e.t1.message}),e.t1;case 19:return e.prev=19,o.end(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[4,16,19,22]])}))),function(e){return o.apply(this,arguments)})},{key:"getBlobAndContainerNamesFromUrl",value:function(){var e,t;try{var n=iY.parse(this.url);if("blob"===n.getHost().split(".")[1]){var i=n.getPath().match("/([^/]*)(/(.*))?");e=i[1],t=i[3]}else if(QY(n)){var r=n.getPath().match("/([^/]*)/([^/]*)(/(.*))?");e=r[2],t=r[4]}else{var a=n.getPath().match("/([^/]*)(/(.*))?");e=a[1],t=a[3]}if(e=decodeURIComponent(e),t=(t=decodeURIComponent(t)).replace(/\\/g,"/"),!e)throw new Error("Provided containerName is invalid.");return{blobName:t,containerName:e}}catch(o){throw new Error("Unable to extract blobName and containerName with provided information.")}}},{key:"startCopyFromURL",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},o=cQ("BlobClient-startCopyFromURL",n),s=o.span,l=o.updatedOptions,n.conditions=n.conditions||{},n.sourceConditions=n.sourceConditions||{},e.prev=3,e.next=6,this.blobContext.startCopyFromURL(t,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,metadata:n.metadata,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:n.sourceConditions.ifMatch,sourceIfModifiedSince:n.sourceConditions.ifModifiedSince,sourceIfNoneMatch:n.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:n.sourceConditions.ifUnmodifiedSince,sourceIfTags:n.sourceConditions.tagConditions},immutabilityPolicyExpiry:null===(r=n.immutabilityPolicy)||void 0===r?void 0:r.expiriesOn,immutabilityPolicyMode:null===(a=n.immutabilityPolicy)||void 0===a?void 0:a.policyMode,legalHold:n.legalHold,rehydratePriority:n.rehydratePriority,tier:T$(n.tier),blobTagsString:$Y(n.tags),sealBlob:n.sealBlob},hQ(l)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,s.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e){return a.apply(this,arguments)})},{key:"generateSasUrl",value:function(e){var t=this;return new Promise((function(n){if(!(t.credential instanceof DJ))throw new RangeError("Can only generate the SAS when the client is initialized with a shared key credential");var i=yQ(Object.assign({containerName:t._containerName,blobName:t._name,snapshotTime:t._snapshot,versionId:t._versionId},e),t.credential).toString();n(ZY(t.url,i))}))}},{key:"deleteImmutabilityPolicy",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=cQ("BlobClient-deleteImmutabilityPolicy",t),i=n.span,r=n.updatedOptions,e.prev=1,e.next=4,this.blobContext.deleteImmutabilityPolicy(Object.assign({abortSignal:null==t?void 0:t.abortSignal},hQ(r)));case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 10:return e.prev=10,i.end(),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])}))),function(e){return r.apply(this,arguments)})},{key:"setImmutabilityPolicy",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=cQ("BlobClient-setImmutabilityPolicy",n),r=i.span,a=i.updatedOptions,e.prev=1,e.next=4,this.blobContext.setImmutabilityPolicy(Object.assign({abortSignal:null==n?void 0:n.abortSignal,immutabilityPolicyExpiry:t.expiriesOn,immutabilityPolicyMode:t.policyMode,modifiedAccessConditions:null==n?void 0:n.modifiedAccessCondition},hQ(a)));case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 10:return e.prev=10,r.end(),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])}))),function(e,t){return i.apply(this,arguments)})},{key:"setLegalHold",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=cQ("BlobClient-setLegalHold",n),r=i.span,a=i.updatedOptions,e.prev=1,e.next=4,this.blobContext.setLegalHold(t,Object.assign({abortSignal:null==n?void 0:n.abortSignal},hQ(a)));case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 10:return e.prev=10,r.end(),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])}))),function(e,t){return n.apply(this,arguments)})}]),t}(uQ),U$=function(e){function t(e,n,i,r){var a,o,s;if(_classCallCheck(this,t),r=r||{},AJ(n))s=e,o=n;else if(uV&&n instanceof DJ||n instanceof _J||cV(n))s=e,o=OJ(n,r=i);else if(n||"string"==typeof n){if(!n||"string"!=typeof n||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");var l=n,u=i,c=HY(e);if("AccountConnString"===c.kind){if(!uV)throw new Error("Account connection string is only supported in Node.js environment");var h=new DJ(c.accountName,c.accountKey);s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u)),r.proxyOptions||(r.proxyOptions=void 0),o=OJ(h,r)}else{if("SASConnString"!==c.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u))+"?"+c.accountSas,o=OJ(new _J,r)}}else s=e,o=OJ(new _J,r);return(a=_callSuper(this,t,[s,o])).appendBlobContext=new QQ(a.storageClientContext),a}var n,i,r,a,o;return _inherits(t,e),_createClass(t,[{key:"withSnapshot",value:function(e){return new t(UY(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}},{key:"create",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},a=cQ("AppendBlobClient-create",t),o=a.span,s=a.updatedOptions,t.conditions=t.conditions||{},e.prev=3,E$(t.customerProvidedKey,this.isHttps),e.next=7,this.appendBlobContext.create(0,Object.assign({abortSignal:t.abortSignal,blobHttpHeaders:t.blobHTTPHeaders,leaseAccessConditions:t.conditions,metadata:t.metadata,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions}),cpkInfo:t.customerProvidedKey,encryptionScope:t.encryptionScope,immutabilityPolicyExpiry:null===(i=t.immutabilityPolicy)||void 0===i?void 0:i.expiriesOn,immutabilityPolicyMode:null===(r=t.immutabilityPolicy)||void 0===r?void 0:r.policyMode,legalHold:t.legalHold,blobTagsString:$Y(t.tags)},hQ(s)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,o.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(){return o.apply(this,arguments)})},{key:"createIfNotExists",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=cQ("AppendBlobClient-createIfNotExists",t),a=r.span,o=r.updatedOptions,s={ifNoneMatch:"*"},e.prev=2,e.next=5,this.create(Object.assign(Object.assign({},o),{conditions:s}));case 5:return l=e.sent,e.abrupt("return",Object.assign(Object.assign({succeeded:!0},l),{_response:l._response}));case 9:if(e.prev=9,e.t0=e.catch(2),"BlobAlreadyExists"!==(null===(n=e.t0.details)||void 0===n?void 0:n.errorCode)){e.next=13;break}return e.abrupt("return",(a.setStatus({code:sU.ERROR,message:"Expected exception when creating a blob only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(i=e.t0.response)||void 0===i?void 0:i.parsedHeaders),{_response:e.t0.response})));case 13:throw a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,a.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,9,14,17]])}))),function(){return a.apply(this,arguments)})},{key:"seal",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},i=cQ("AppendBlobClient-seal",t),r=i.span,a=i.updatedOptions,t.conditions=t.conditions||{},e.prev=3,e.next=6,this.appendBlobContext.seal(Object.assign({abortSignal:t.abortSignal,appendPositionAccessConditions:t.conditions,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(n=t.conditions)||void 0===n?void 0:n.tagConditions})},hQ(a)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(){return r.apply(this,arguments)})},{key:"appendBlock",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:{},a=cQ("AppendBlobClient-appendBlock",i),o=a.span,s=a.updatedOptions,i.conditions=i.conditions||{},e.prev=3,E$(i.customerProvidedKey,this.isHttps),e.next=7,this.appendBlobContext.appendBlock(n,t,Object.assign({abortSignal:i.abortSignal,appendPositionAccessConditions:i.conditions,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions}),requestOptions:{onUploadProgress:i.onProgress},transactionalContentMD5:i.transactionalContentMD5,transactionalContentCrc64:i.transactionalContentCrc64,cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope},hQ(s)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,o.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e,t){return i.apply(this,arguments)})},{key:"appendBlockFromURL",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>3&&void 0!==u[3]?u[3]:{},o=cQ("AppendBlobClient-appendBlockFromURL",r),s=o.span,l=o.updatedOptions,r.conditions=r.conditions||{},r.sourceConditions=r.sourceConditions||{},e.prev=3,E$(r.customerProvidedKey,this.isHttps),e.next=7,this.appendBlobContext.appendBlockFromUrl(t,0,Object.assign({abortSignal:r.abortSignal,sourceRange:z$({offset:n,count:i}),sourceContentMD5:r.sourceContentMD5,sourceContentCrc64:r.sourceContentCrc64,leaseAccessConditions:r.conditions,appendPositionAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(a=r.conditions)||void 0===a?void 0:a.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:r.sourceConditions.ifMatch,sourceIfModifiedSince:r.sourceConditions.ifModifiedSince,sourceIfNoneMatch:r.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:r.sourceConditions.ifUnmodifiedSince},copySourceAuthorization:aJ(r.sourceAuthorization),cpkInfo:r.customerProvidedKey,encryptionScope:r.encryptionScope},hQ(l)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,s.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e,t,i){return n.apply(this,arguments)})}]),t}(V$),q$=function(e){function t(e,n,i,r){var a,o,s;if(_classCallCheck(this,t),r=r||{},AJ(n))s=e,o=n;else if(uV&&n instanceof DJ||n instanceof _J||cV(n))s=e,o=OJ(n,r=i);else if(n||"string"==typeof n){if(!n||"string"!=typeof n||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");var l=n,u=i,c=HY(e);if("AccountConnString"===c.kind){if(!uV)throw new Error("Account connection string is only supported in Node.js environment");var h=new DJ(c.accountName,c.accountKey);s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u)),r.proxyOptions||(r.proxyOptions=void 0),o=OJ(h,r)}else{if("SASConnString"!==c.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u))+"?"+c.accountSas,o=OJ(new _J,r)}}else s=e,i&&"string"!=typeof i&&(r=i),o=OJ(new _J,r);return(a=_callSuper(this,t,[s,o])).blockBlobContext=new a$(a.storageClientContext),a._blobContext=new CQ(a.storageClientContext),a}var n,i,r,a,o,s,l,u,c,h,d,f;return _inherits(t,e),_createClass(t,[{key:"withSnapshot",value:function(e){return new t(UY(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}},{key:"query",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E$((n=l.length>1&&void 0!==l[1]?l[1]:{}).customerProvidedKey,this.isHttps),r=cQ("BlockBlobClient-query",n),a=r.span,o=r.updatedOptions,e.prev=3,uV){e.next=6;break}throw new Error("This operation currently is only supported in Node.js.");case 6:return E$(n.customerProvidedKey,this.isHttps),e.next=9,this._blobContext.query(Object.assign({abortSignal:n.abortSignal,queryRequest:{queryType:"SQL",expression:t,inputSerialization:nJ(n.inputTextConfiguration),outputSerialization:nJ(n.outputTextConfiguration)},leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:n.customerProvidedKey},hQ(o)));case 9:return s=e.sent,e.abrupt("return",new JQ(s,{abortSignal:n.abortSignal,onProgress:n.onProgress,onError:n.onError}));case 13:throw e.prev=13,e.t0=e.catch(3),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 16:return e.prev=16,a.end(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[3,13,16,19]])}))),function(e){return f.apply(this,arguments)})},{key:"upload",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=c.length>2&&void 0!==c[2]?c[2]:{}).conditions=i.conditions||{},s=cQ("BlockBlobClient-upload",i),l=s.span,u=s.updatedOptions,e.prev=3,E$(i.customerProvidedKey,this.isHttps),e.next=7,this.blockBlobContext.upload(n,t,Object.assign({abortSignal:i.abortSignal,blobHttpHeaders:i.blobHTTPHeaders,leaseAccessConditions:i.conditions,metadata:i.metadata,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions}),requestOptions:{onUploadProgress:i.onProgress},cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope,immutabilityPolicyExpiry:null===(a=i.immutabilityPolicy)||void 0===a?void 0:a.expiriesOn,immutabilityPolicyMode:null===(o=i.immutabilityPolicy)||void 0===o?void 0:o.policyMode,legalHold:i.legalHold,tier:T$(i.tier),blobTagsString:$Y(i.tags)},hQ(u)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),l.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,l.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e,t){return d.apply(this,arguments)})},{key:"syncUploadFromURL",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=h.length>1&&void 0!==h[1]?h[1]:{}).conditions=n.conditions||{},l=cQ("BlockBlobClient-syncUploadFromURL",n),u=l.span,c=l.updatedOptions,e.prev=3,E$(n.customerProvidedKey,this.isHttps),e.next=7,this.blockBlobContext.putBlobFromUrl(0,t,Object.assign(Object.assign(Object.assign({},n),{blobHttpHeaders:n.blobHTTPHeaders,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:n.conditions.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:null===(i=n.sourceConditions)||void 0===i?void 0:i.ifMatch,sourceIfModifiedSince:null===(r=n.sourceConditions)||void 0===r?void 0:r.ifModifiedSince,sourceIfNoneMatch:null===(a=n.sourceConditions)||void 0===a?void 0:a.ifNoneMatch,sourceIfUnmodifiedSince:null===(o=n.sourceConditions)||void 0===o?void 0:o.ifUnmodifiedSince,sourceIfTags:null===(s=n.sourceConditions)||void 0===s?void 0:s.tagConditions},cpkInfo:n.customerProvidedKey,copySourceAuthorization:aJ(n.sourceAuthorization),tier:T$(n.tier),blobTagsString:$Y(n.tags),copySourceTags:n.copySourceTags}),hQ(c)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),u.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,u.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e){return h.apply(this,arguments)})},{key:"stageBlock",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>3&&void 0!==l[3]?l[3]:{},a=cQ("BlockBlobClient-stageBlock",r),o=a.span,s=a.updatedOptions,e.prev=2,E$(r.customerProvidedKey,this.isHttps),e.next=6,this.blockBlobContext.stageBlock(t,i,n,Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,requestOptions:{onUploadProgress:r.onProgress},transactionalContentMD5:r.transactionalContentMD5,transactionalContentCrc64:r.transactionalContentCrc64,cpkInfo:r.customerProvidedKey,encryptionScope:r.encryptionScope},hQ(s)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(2),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,o.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e,t,n){return c.apply(this,arguments)})},{key:"stageBlockFromURL",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:0,r=u.length>3?u[3]:void 0,a=u.length>4&&void 0!==u[4]?u[4]:{},o=cQ("BlockBlobClient-stageBlockFromURL",a),s=o.span,l=o.updatedOptions,e.prev=4,E$(a.customerProvidedKey,this.isHttps),e.next=8,this.blockBlobContext.stageBlockFromURL(t,0,n,Object.assign({abortSignal:a.abortSignal,leaseAccessConditions:a.conditions,sourceContentMD5:a.sourceContentMD5,sourceContentCrc64:a.sourceContentCrc64,sourceRange:0!==i||r?z$({offset:i,count:r}):void 0,cpkInfo:a.customerProvidedKey,encryptionScope:a.encryptionScope,copySourceAuthorization:aJ(a.sourceAuthorization)},hQ(l)));case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(4),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,s.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[4,11,14,17]])}))),function(e,t){return u.apply(this,arguments)})},{key:"commitBlockList",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=u.length>1&&void 0!==u[1]?u[1]:{}).conditions=n.conditions||{},o=cQ("BlockBlobClient-commitBlockList",n),s=o.span,l=o.updatedOptions,e.prev=3,E$(n.customerProvidedKey,this.isHttps),e.next=7,this.blockBlobContext.commitBlockList({latest:t},Object.assign({abortSignal:n.abortSignal,blobHttpHeaders:n.blobHTTPHeaders,leaseAccessConditions:n.conditions,metadata:n.metadata,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope,immutabilityPolicyExpiry:null===(r=n.immutabilityPolicy)||void 0===r?void 0:r.expiriesOn,immutabilityPolicyMode:null===(a=n.immutabilityPolicy)||void 0===a?void 0:a.policyMode,legalHold:n.legalHold,tier:T$(n.tier),blobTagsString:$Y(n.tags)},hQ(l)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,s.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e){return l.apply(this,arguments)})},{key:"getBlockList",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=cQ("BlockBlobClient-getBlockList",n),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.blockBlobContext.getBlockList(t,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions})},hQ(o)));case 5:return s=e.sent,e.abrupt("return",(s.committedBlocks||(s.committedBlocks=[]),s.uncommittedBlocks||(s.uncommittedBlocks=[]),s));case 9:throw e.prev=9,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,a.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e){return s.apply(this,arguments)})},{key:"uploadData",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},i=cQ("BlockBlobClient-uploadData",n),r=i.span,a=i.updatedOptions,e.prev=2,!uV){e.next=5;break}return e.abrupt("return",(t instanceof Buffer?o=t:t instanceof ArrayBuffer?o=Buffer.from(t):(t=t,o=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),this.uploadSeekableInternal((function(e,t){return o.slice(e,e+t)}),o.byteLength,a)));case 5:return s=new Blob([t]),e.abrupt("return",this.uploadSeekableInternal((function(e,t){return s.slice(e,e+t)}),s.size,a));case 9:throw e.prev=9,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e){return o.apply(this,arguments)})},{key:"uploadBrowserData",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=cQ("BlockBlobClient-uploadBrowserData",n),r=i.span,a=i.updatedOptions,e.prev=2,o=new Blob([t]),e.next=6,this.uploadSeekableInternal((function(e,t){return o.slice(e,e+t)}),o.size,a);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e){return a.apply(this,arguments)})},{key:"uploadSeekableInternal",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u,c,h,d,f,p=this,m=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=m.length>2&&void 0!==m[2]?m[2]:{}).blockSize||(i.blockSize=0),!(i.blockSize<0||i.blockSize>4194304e3)){e.next=3;break}throw new RangeError("blockSize option must be >= 0 and <= 4194304000");case 3:if(0===i.maxSingleShotSize||i.maxSingleShotSize||(i.maxSingleShotSize=268435456),!(i.maxSingleShotSize<0||i.maxSingleShotSize>268435456)){e.next=5;break}throw new RangeError("maxSingleShotSize option must be >= 0 and <= 268435456");case 5:if(0!==i.blockSize){e.next=9;break}if(!(n>2097152e8)){e.next=8;break}throw new RangeError(n+" is too larger to upload to a block blob.");case 8:n>i.maxSingleShotSize&&(i.blockSize=Math.ceil(n/5e4),i.blockSize<4194304&&(i.blockSize=4194304));case 9:if(i.blobHTTPHeaders||(i.blobHTTPHeaders={}),i.conditions||(i.conditions={}),r=cQ("BlockBlobClient-uploadSeekableInternal",i),a=r.span,o=r.updatedOptions,e.prev=11,!(n<=i.maxSingleShotSize)){e.next=16;break}return e.next=15,this.upload(t(0,n),n,o);case 15:return e.abrupt("return",e.sent);case 16:if(!((s=Math.floor((n-1)/i.blockSize)+1)>5e4)){e.next=19;break}throw new RangeError("The buffer's size is too big or the BlockSize is too small;the number of blocks must be <= 50000");case 19:l=[],u=wU(),c=0,h=new j$(i.concurrency),d=_regeneratorRuntime().mark((function e(r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.addOperation(_asyncToGenerator(_regeneratorRuntime().mark((function e(){var a,h,d;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=KY(u,r),h=i.blockSize*r,d=(r===s-1?n:h+i.blockSize)-h,l.push(a),e.next=4,p.stageBlock(a,t(h,d),d,{abortSignal:i.abortSignal,conditions:i.conditions,encryptionScope:i.encryptionScope,tracingOptions:o.tracingOptions});case 4:c+=d,i.onProgress&&i.onProgress({loadedBytes:c});case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})),f=0;case 24:if(!(f<s)){e.next=29;break}return e.delegateYield(d(f),"t0",26);case 26:f++,e.next=24;break;case 29:return e.next=31,h.do();case 31:return e.abrupt("return",this.commitBlockList(l,o));case 34:throw e.prev=34,e.t1=e.catch(11),a.setStatus({code:sU.ERROR,message:e.t1.message}),e.t1;case 37:return e.prev=37,a.end(),e.finish(37);case 40:case"end":return e.stop()}}),e,this,[[11,34,37,40]])}))),function(e,t){return r.apply(this,arguments)})},{key:"uploadFile",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=cQ("BlockBlobClient-uploadFile",n),r=i.span,a=i.updatedOptions,e.prev=2,void(e.next=5);case 5:return o=e.sent.size,e.next=8,this.uploadSeekableInternal((function(e,t){return function(){}}),o,Object.assign(Object.assign({},n),{tracingOptions:Object.assign(Object.assign({},n.tracingOptions),hQ(a))}));case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,r.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,11,14,17]])}))),function(e){return i.apply(this,arguments)})},{key:"uploadStream",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h,d,f=this,p=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:8388608,i=p.length>2&&void 0!==p[2]?p[2]:5,(r=p.length>3&&void 0!==p[3]?p[3]:{}).blobHTTPHeaders||(r.blobHTTPHeaders={}),r.conditions||(r.conditions={}),a=cQ("BlockBlobClient-uploadStream",r),o=a.span,s=a.updatedOptions,e.prev=5,l=0,u=wU(),c=0,h=[],d=new H$(t,n,i,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=KY(u,l),h.push(i),l++,e.next=5,f.stageBlock(i,t,n,{conditions:r.conditions,encryptionScope:r.encryptionScope,tracingOptions:s.tracingOptions});case 5:c+=n,r.onProgress&&r.onProgress({loadedBytes:c});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Math.ceil(i/4*3)),e.next=12,d.do();case 12:return e.next=14,this.commitBlockList(h,Object.assign(Object.assign({},r),{tracingOptions:Object.assign(Object.assign({},r.tracingOptions),hQ(s))}));case 14:return e.abrupt("return",e.sent);case 17:throw e.prev=17,e.t0=e.catch(5),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 20:return e.prev=20,o.end(),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[5,17,20,23]])}))),function(e){return n.apply(this,arguments)})}]),t}(V$),G$=function(e){function t(e,n,i,r){var a,o,s;if(_classCallCheck(this,t),r=r||{},AJ(n))s=e,o=n;else if(uV&&n instanceof DJ||n instanceof _J||cV(n))s=e,o=OJ(n,r=i);else if(n||"string"==typeof n){if(!n||"string"!=typeof n||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");var l=n,u=i,c=HY(e);if("AccountConnString"===c.kind){if(!uV)throw new Error("Account connection string is only supported in Node.js environment");var h=new DJ(c.accountName,c.accountKey);s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u)),r.proxyOptions||(r.proxyOptions=void 0),o=OJ(h,r)}else{if("SASConnString"!==c.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=VY(VY(c.url,encodeURIComponent(l)),encodeURIComponent(u))+"?"+c.accountSas,o=OJ(new _J,r)}}else s=e,o=OJ(new _J,r);return(a=_callSuper(this,t,[s,o])).pageBlobContext=new p$(a.storageClientContext),a}var n,i,r,a,o,s,l,u,c,h,d,f,p;return _inherits(t,e),_createClass(t,[{key:"withSnapshot",value:function(e){return new t(UY(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}},{key:"create",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=u.length>1&&void 0!==u[1]?u[1]:{}).conditions=n.conditions||{},o=cQ("PageBlobClient-create",n),s=o.span,l=o.updatedOptions,e.prev=3,E$(n.customerProvidedKey,this.isHttps),e.next=7,this.pageBlobContext.create(0,t,Object.assign({abortSignal:n.abortSignal,blobHttpHeaders:n.blobHTTPHeaders,blobSequenceNumber:n.blobSequenceNumber,leaseAccessConditions:n.conditions,metadata:n.metadata,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope,immutabilityPolicyExpiry:null===(r=n.immutabilityPolicy)||void 0===r?void 0:r.expiriesOn,immutabilityPolicyMode:null===(a=n.immutabilityPolicy)||void 0===a?void 0:a.policyMode,legalHold:n.legalHold,tier:T$(n.tier),blobTagsString:$Y(n.tags)},hQ(l)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,s.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e){return p.apply(this,arguments)})},{key:"createIfNotExists",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},a=cQ("PageBlobClient-createIfNotExists",n),o=a.span,s=a.updatedOptions,e.prev=2,l={ifNoneMatch:"*"},e.next=6,this.create(t,Object.assign(Object.assign({},n),{conditions:l,tracingOptions:s.tracingOptions}));case 6:return u=e.sent,e.abrupt("return",Object.assign(Object.assign({succeeded:!0},u),{_response:u._response}));case 10:if(e.prev=10,e.t0=e.catch(2),"BlobAlreadyExists"!==(null===(i=e.t0.details)||void 0===i?void 0:i.errorCode)){e.next=14;break}return e.abrupt("return",(o.setStatus({code:sU.ERROR,message:"Expected exception when creating a blob only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(r=e.t0.response)||void 0===r?void 0:r.parsedHeaders),{_response:e.t0.response})));case 14:throw o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 15:return e.prev=15,o.end(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,10,15,18]])}))),function(e){return f.apply(this,arguments)})},{key:"uploadPages",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=u.length>3&&void 0!==u[3]?u[3]:{}).conditions=r.conditions||{},o=cQ("PageBlobClient-uploadPages",r),s=o.span,l=o.updatedOptions,e.prev=3,E$(r.customerProvidedKey,this.isHttps),e.next=7,this.pageBlobContext.uploadPages(i,t,Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(a=r.conditions)||void 0===a?void 0:a.tagConditions}),requestOptions:{onUploadProgress:r.onProgress},range:z$({offset:n,count:i}),sequenceNumberAccessConditions:r.conditions,transactionalContentMD5:r.transactionalContentMD5,transactionalContentCrc64:r.transactionalContentCrc64,cpkInfo:r.customerProvidedKey,encryptionScope:r.encryptionScope},hQ(l)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,s.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e,t,n){return d.apply(this,arguments)})},{key:"uploadPagesFromURL",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r){var a,o,s,l,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=c.length>4&&void 0!==c[4]?c[4]:{}).conditions=a.conditions||{},a.sourceConditions=a.sourceConditions||{},s=cQ("PageBlobClient-uploadPagesFromURL",a),l=s.span,u=s.updatedOptions,e.prev=3,E$(a.customerProvidedKey,this.isHttps),e.next=7,this.pageBlobContext.uploadPagesFromURL(t,z$({offset:n,count:r}),0,z$({offset:i,count:r}),Object.assign({abortSignal:a.abortSignal,sourceContentMD5:a.sourceContentMD5,sourceContentCrc64:a.sourceContentCrc64,leaseAccessConditions:a.conditions,sequenceNumberAccessConditions:a.conditions,modifiedAccessConditions:Object.assign(Object.assign({},a.conditions),{ifTags:null===(o=a.conditions)||void 0===o?void 0:o.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:a.sourceConditions.ifMatch,sourceIfModifiedSince:a.sourceConditions.ifModifiedSince,sourceIfNoneMatch:a.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:a.sourceConditions.ifUnmodifiedSince},cpkInfo:a.customerProvidedKey,encryptionScope:a.encryptionScope,copySourceAuthorization:aJ(a.sourceAuthorization)},hQ(u)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(3),l.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,l.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])}))),function(e,t,n,i){return h.apply(this,arguments)})},{key:"clearPages",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,n=l.length>1?l[1]:void 0,(i=l.length>2&&void 0!==l[2]?l[2]:{}).conditions=i.conditions||{},a=cQ("PageBlobClient-clearPages",i),o=a.span,s=a.updatedOptions,e.prev=5,e.next=8,this.pageBlobContext.clearPages(0,Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions}),range:z$({offset:t,count:n}),sequenceNumberAccessConditions:i.conditions,cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope},hQ(s)));case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(5),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,o.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,11,14,17]])}))),function(){return c.apply(this,arguments)})},{key:"getPageRanges",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,n=l.length>1?l[1]:void 0,(i=l.length>2&&void 0!==l[2]?l[2]:{}).conditions=i.conditions||{},a=cQ("PageBlobClient-getPageRanges",i),o=a.span,s=a.updatedOptions,e.prev=5,e.next=8,this.pageBlobContext.getPageRanges(Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions}),range:z$({offset:t,count:n})},hQ(s))).then(P$);case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(5),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,o.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,11,14,17]])}))),function(){return u.apply(this,arguments)})},{key:"listPageRangesSegment",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:0,n=u.length>1?u[1]:void 0,i=u.length>2?u[2]:void 0,r=u.length>3&&void 0!==u[3]?u[3]:{},o=cQ("PageBlobClient-getPageRangesSegment",r),s=o.span,l=o.updatedOptions,e.prev=5,e.next=8,this.pageBlobContext.getPageRanges(Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(a=r.conditions)||void 0===a?void 0:a.tagConditions}),range:z$({offset:t,count:n}),marker:i,maxPageSize:r.maxPageSize},hQ(l)));case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(5),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,s.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,11,14,17]])}))),function(){return l.apply(this,arguments)})},{key:"listPageRangeItemSegments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return rV(this,arguments,_regeneratorRuntime().mark((function r(){var a;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n&&void 0!==n){r.next=14;break}case 1:return r.next=3,iV(this.listPageRangesSegment(e,t,n,i));case 3:return a=r.sent,n=a.continuationToken,r.t0=iV,r.next=8,iV(a);case 8:return r.t1=r.sent,r.next=11,(0,r.t0)(r.t1);case 11:return r.next=13,r.sent;case 13:if(n){r.next=1;break}case 14:case"end":return r.stop()}}),r,this)})))}},{key:"listPageRangeItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return rV(this,arguments,_regeneratorRuntime().mark((function i(){var r,a,o,s,l;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.prev=0,s=oV(this.listPageRangeItemSegments(e,t,void 0,n));case 2:return i.next=4,iV(s.next());case 4:if((o=i.sent).done){i.next=13;break}return l=o.value,i.t0=iV,i.delegateYield(aV(oV(lJ(l))),"t1",8);case 8:return i.t2=i.t1,i.next=11,(0,i.t0)(i.t2);case 11:i.next=2;break;case 13:i.next=18;break;case 15:i.prev=15,i.t3=i.catch(0),r={error:i.t3};case 18:if(i.prev=18,i.prev=19,i.t4=o&&!o.done&&(a=s.return),!i.t4){i.next=24;break}return i.next=24,iV(a.call(s));case 24:if(i.prev=24,!r){i.next=27;break}throw r.error;case 27:return i.finish(24);case 28:return i.finish(18);case 29:case"end":return i.stop()}}),i,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"listPageRanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.conditions=i.conditions||{};var r=this.listPageRangeItems(t,n,i);return _defineProperty(_defineProperty({next:function(){return r.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.listPageRangeItemSegments(t,n,r.continuationToken,Object.assign({maxPageSize:r.maxPageSize},i))}))}},{key:"getPageRangesDiff",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=u.length>3&&void 0!==u[3]?u[3]:{}).conditions=r.conditions||{},o=cQ("PageBlobClient-getPageRangesDiff",r),s=o.span,l=o.updatedOptions,e.prev=3,e.next=6,this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(a=r.conditions)||void 0===a?void 0:a.tagConditions}),prevsnapshot:i,range:z$({offset:t,count:n})},hQ(l))).then(P$);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,s.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"listPageRangesDiffSegment",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r,a){var o,s,l,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=cQ("PageBlobClient-getPageRangesDiffSegment",a),l=s.span,u=s.updatedOptions,e.prev=1,e.next=4,this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:null==a?void 0:a.abortSignal,leaseAccessConditions:null==a?void 0:a.conditions,modifiedAccessConditions:Object.assign(Object.assign({},null==a?void 0:a.conditions),{ifTags:null===(o=null==a?void 0:a.conditions)||void 0===o?void 0:o.tagConditions}),prevsnapshot:i,range:z$({offset:t,count:n}),marker:r,maxPageSize:null==a?void 0:a.maxPageSize},hQ(u)));case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),l.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 10:return e.prev=10,l.end(),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])}))),function(e,t,n,i,r){return o.apply(this,arguments)})},{key:"listPageRangeDiffItemSegments",value:function(e,t,n,i,r){return rV(this,arguments,_regeneratorRuntime().mark((function a(){var o;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i&&void 0!==i){a.next=14;break}case 1:return a.next=3,iV(this.listPageRangesDiffSegment(e,t,n,i,r));case 3:return o=a.sent,i=o.continuationToken,a.t0=iV,a.next=8,iV(o);case 8:return a.t1=a.sent,a.next=11,(0,a.t0)(a.t1);case 11:return a.next=13,a.sent;case 13:if(i){a.next=1;break}case 14:case"end":return a.stop()}}),a,this)})))}},{key:"listPageRangeDiffItems",value:function(e,t,n,i){return rV(this,arguments,_regeneratorRuntime().mark((function r(){var a,o,s,l,u;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,l=oV(this.listPageRangeDiffItemSegments(e,t,n,void 0,i));case 2:return r.next=4,iV(l.next());case 4:if((s=r.sent).done){r.next=13;break}return u=s.value,r.t0=iV,r.delegateYield(aV(oV(lJ(u))),"t1",8);case 8:return r.t2=r.t1,r.next=11,(0,r.t0)(r.t2);case 11:r.next=2;break;case 13:r.next=18;break;case 15:r.prev=15,r.t3=r.catch(0),a={error:r.t3};case 18:if(r.prev=18,r.prev=19,r.t4=s&&!s.done&&(o=l.return),!r.t4){r.next=24;break}return r.next=24,iV(o.call(l));case 24:if(r.prev=24,!a){r.next=27;break}throw a.error;case 27:return r.finish(24);case 28:return r.finish(18);case 29:case"end":return r.stop()}}),r,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"listPageRangesDiff",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.conditions=r.conditions||{};var a=this.listPageRangeDiffItems(e,t,n,Object.assign({},r));return _defineProperty(_defineProperty({next:function(){return a.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.listPageRangeDiffItemSegments(e,t,n,a.continuationToken,Object.assign({maxPageSize:a.maxPageSize},r))}))}},{key:"getPageRangesDiffForManagedDisks",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=u.length>3&&void 0!==u[3]?u[3]:{}).conditions=r.conditions||{},o=cQ("PageBlobClient-GetPageRangesDiffForManagedDisks",r),s=o.span,l=o.updatedOptions,e.prev=3,e.next=6,this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(a=r.conditions)||void 0===a?void 0:a.tagConditions}),prevSnapshotUrl:i,range:z$({offset:t,count:n})},hQ(l))).then(P$);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,s.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"resize",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=s.length>1&&void 0!==s[1]?s[1]:{}).conditions=n.conditions||{},r=cQ("PageBlobClient-resize",n),a=r.span,o=r.updatedOptions,e.prev=3,e.next=6,this.pageBlobContext.resize(t,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions}),encryptionScope:n.encryptionScope},hQ(o)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,a.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e){return r.apply(this,arguments)})},{key:"updateSequenceNumber",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=l.length>2&&void 0!==l[2]?l[2]:{}).conditions=i.conditions||{},a=cQ("PageBlobClient-updateSequenceNumber",i),o=a.span,s=a.updatedOptions,e.prev=3,e.next=6,this.pageBlobContext.updateSequenceNumber(t,Object.assign({abortSignal:i.abortSignal,blobSequenceNumber:n,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(r=i.conditions)||void 0===r?void 0:r.tagConditions})},hQ(s)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,o.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(e,t){return i.apply(this,arguments)})},{key:"startCopyIncremental",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=cQ("PageBlobClient-startCopyIncremental",n),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.pageBlobContext.copyIncremental(t,Object.assign({abortSignal:n.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(i=n.conditions)||void 0===i?void 0:i.tagConditions})},hQ(o)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,a.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return n.apply(this,arguments)})}]),t}(V$),W$=function(){function e(t,n){if(_classCallCheck(this,e),!t||!t.contentType)throw new RangeError("batchResponse is malformed or doesn't contain valid content-type.");if(!n||0===n.size)throw new RangeError("Invalid state: subRequests is not provided or size is 0.");this.batchResponse=t,this.subRequests=n,this.responseBatchBoundary=this.batchResponse.contentType.split("=")[1],this.perResponsePrefix="--".concat(this.responseBatchBoundary,"\r\n"),this.batchResponseEnding="--".concat(this.responseBatchBoundary,"--")}var t;return _createClass(e,[{key:"parseBatchResponse",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,v,g,y;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(202===this.batchResponse._response.status){e.next=2;break}throw new Error("Invalid state: batch request failed with status: '".concat(this.batchResponse._response.status,"'."));case 2:return e.next=4,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise((function(e,i){n.onloadend=function(t){e(t.target.result)},n.onerror=i,n.readAsText(t)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,t.blobBody;case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.batchResponse);case 4:if(t=e.sent.split(this.batchResponseEnding)[0].split(this.perResponsePrefix).slice(1),(n=t.length)===this.subRequests.size||1===n){e.next=8;break}throw new Error("Invalid state: sub responses' count is not equal to sub requests' count.");case 8:i=new Array(n),r=0,a=0,o=0;case 11:if(!(o<n)){e.next=51;break}s=t[o],(l={}).headers=new FY,u=s.split("\r\n"),c=!1,h=!1,d=!1,f=-1,p=_createForOfIteratorHelper(u),e.prev=17,p.s();case 19:if((m=p.n()).done){e.next=39;break}if(v=m.value,!c){e.next=36;break}if(""===v.trim()){e.next=33;break}if(!h){e.next=27;break}l.bodyAsText||(l.bodyAsText=""),l.bodyAsText+=v,e.next=31;break;case 27:if(-1!==v.indexOf(": ")){e.next=29;break}throw new Error("Invalid state: find non-empty line '".concat(v,"' without HTTP header delimiter ': '."));case 29:g=v.split(": "),l.headers.set(g[0],g[1]),"x-ms-error-code"===g[0]&&(l.errorCode=g[1],d=!0);case 31:e.next=34;break;case 33:h||(h=!0);case 34:e.next=37;break;case 36:v.startsWith("Content-ID")&&(f=parseInt(v.split(": ")[1])),v.startsWith("HTTP/1.1")&&(c=!0,y=v.split(" "),l.status=parseInt(y[1]),l.statusMessage=y.slice(2).join(" "));case 37:e.next=19;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(17),p.e(e.t0);case 44:return e.prev=44,p.f(),e.finish(44);case 47:-1!==f&&Number.isInteger(f)&&f>=0&&f<this.subRequests.size&&void 0===i[f]?(l._request=this.subRequests.get(f),i[f]=l):OY.error("subResponses[".concat(o,"] is dropped as the Content-ID is not found or invalid, Content-ID: ").concat(f)),d?a++:r++;case 48:o++,e.next=11;break;case 51:return e.abrupt("return",{subResponses:i,subResponsesSucceededCount:r,subResponsesFailedCount:a});case 52:case"end":return e.stop()}}),e,this,[[17,41,44,47]])}))),function(){return t.apply(this,arguments)})}]),e}();!function(e){e[e.LOCKED=0]="LOCKED",e[e.UNLOCKED=1]="UNLOCKED"}(B$||(B$={}));var Z$=function(){function e(){_classCallCheck(this,e)}var t,n;return _createClass(e,null,[{key:"lock",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){void 0===n.keys[t]||n.keys[t]===B$.UNLOCKED?(n.keys[t]=B$.LOCKED,e()):n.onUnlockEvent(t,(function(){n.keys[t]=B$.LOCKED,e()}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"unlock",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.keys[t]===B$.LOCKED&&n.emitUnlockEvent(t),delete n.keys[t],e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"onUnlockEvent",value:function(e,t){void 0===this.listeners[e]?this.listeners[e]=[t]:this.listeners[e].push(t)}},{key:"emitUnlockEvent",value:function(e){var t=this;if(void 0!==this.listeners[e]&&this.listeners[e].length>0){var n=this.listeners[e].shift();setImmediate((function(){n.call(t)}))}}}]),e}();Z$.keys={},Z$.listeners={};var X$=function(){function e(){_classCallCheck(this,e),this.batch="batch",this.batchRequest=new K$}var t,n,i;return _createClass(e,[{key:"getMultiPartContentType",value:function(){return this.batchRequest.getMultipartContentType()}},{key:"getHttpRequestBody",value:function(){return this.batchRequest.getHttpRequestBody()}},{key:"getSubRequests",value:function(){return this.batchRequest.getSubRequests()}},{key:"addSubRequestInternal",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z$.lock(this.batch);case 2:return e.prev=2,this.batchRequest.preAddSubRequest(t),e.next=6,n();case 6:this.batchRequest.postAddSubRequest(t);case 7:return e.prev=7,e.next=10,Z$.unlock(this.batch);case 10:return e.finish(7);case 11:case"end":return e.stop()}}),e,this,[[2,,7,11]])}))),function(e,t){return i.apply(this,arguments)})},{key:"setBatchType",value:function(e){if(this.batchType||(this.batchType=e),this.batchType!==e)throw new RangeError("BlobBatch only supports one operation type per batch and it already is being used for ".concat(this.batchType," operations."))}},{key:"deleteBlob",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t||!(uV&&n instanceof DJ||n instanceof _J||cV(n))){e.next=4;break}r=t,a=n,e.next=7;break;case 4:if(t instanceof V$){e.next=6;break}throw new RangeError("Invalid arguments. Either url and credential, or BlobClient need be provided.");case 6:r=t.url,a=t.credential,i=n;case 7:return i||(i={}),o=cQ("BatchDeleteRequest-addSubRequest",i),s=o.span,l=o.updatedOptions,e.prev=9,this.setBatchType("delete"),e.next=13,this.addSubRequestInternal({url:r,credential:a},_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new V$(r,u.batchRequest.createPipeline(a)).delete(l);case 2:case"end":return e.stop()}}),e)}))));case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(9),s.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 18:return e.prev=18,s.end(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[9,15,18,21]])}))),function(e,t,i){return n.apply(this,arguments)})},{key:"setBlobAccessTier",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r){var a,o,s,l,u,c,h=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t||!(uV&&n instanceof DJ||n instanceof _J||cV(n))){e.next=4;break}a=t,o=n,s=i,e.next=7;break;case 4:if(t instanceof V$){e.next=6;break}throw new RangeError("Invalid arguments. Either url and credential, or BlobClient need be provided.");case 6:a=t.url,o=t.credential,s=n,r=i;case 7:return r||(r={}),l=cQ("BatchSetTierRequest-addSubRequest",r),u=l.span,c=l.updatedOptions,e.prev=9,this.setBatchType("setAccessTier"),e.next=13,this.addSubRequestInternal({url:a,credential:o},_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new V$(a,h.batchRequest.createPipeline(o)).setAccessTier(s,c);case 2:case"end":return e.stop()}}),e)}))));case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(9),u.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 18:return e.prev=18,u.end(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[9,15,18,21]])}))),function(e,n,i,r){return t.apply(this,arguments)})}]),e}(),K$=function(){function e(){_classCallCheck(this,e),this.operationCount=0,this.body="";var t=wU();this.boundary="batch_"+t,this.subRequestPrefix="--".concat(this.boundary,"\r\nContent-Type: application/http\r\nContent-Transfer-Encoding: binary"),this.multipartContentType="multipart/mixed; boundary="+this.boundary,this.batchRequestEnding="--".concat(this.boundary,"--"),this.subRequests=new Map}return _createClass(e,[{key:"createPipeline",value:function(e){var t=e instanceof _J,n=3+(t?0:1),i=new Array(n);return i[0]=EY(),i[1]=new $$,t||(i[2]=cV(e)?rJ(QJ(e,"https://storage.azure.com/.default"),e):e),i[n-1]=new J$(this),new RJ(i,{})}},{key:"appendSubRequestToBody",value:function(e){this.body+=[this.subRequestPrefix,"Content-ID: "+this.operationCount,"","".concat(e.method.toString()," ").concat(WY(e.url)," HTTP/1.1\r\n")].join("\r\n");var t,n=_createForOfIteratorHelper(e.headers.headersArray());try{for(n.s();!(t=n.n()).done;){var i=t.value;this.body+="".concat(i.name,": ").concat(i.value,"\r\n")}}catch(U5){n.e(U5)}finally{n.f()}this.body+="\r\n"}},{key:"preAddSubRequest",value:function(e){if(this.operationCount>=256)throw new RangeError("Cannot exceed 256 sub requests in a single batch");var t=GY(e.url);if(!t||""===t)throw new RangeError("Invalid url for sub request: '".concat(e.url,"'"))}},{key:"postAddSubRequest",value:function(e){this.subRequests.set(this.operationCount,e),this.operationCount++}},{key:"getHttpRequestBody",value:function(){return"".concat(this.body).concat(this.batchRequestEnding,"\r\n")}},{key:"getMultipartContentType",value:function(){return this.multipartContentType}},{key:"getSubRequests",value:function(){return this.subRequests}}]),e}(),Y$=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[n,i])).dummyResponse={request:new WJ,status:200,headers:new FY},r.batchRequest=e,r}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.batchRequest.appendSubRequestToBody(t);case 2:return e.abrupt("return",this.dummyResponse);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV),J$=function(){function e(t){_classCallCheck(this,e),this.batchRequest=t}return _createClass(e,[{key:"create",value:function(e,t){return new Y$(this.batchRequest,e,t)}}]),e}(),Q$=function(e){function t(e,n){return _classCallCheck(this,t),_callSuper(this,t,[e,n])}var n;return _inherits(t,e),_createClass(t,[{key:"sendRequest",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",i=_createForOfIteratorHelper(t.headers.headersArray());try{for(i.s();!(r=i.n()).done;)YY((a=r.value).name,"x-ms-version")&&(n=a.name)}catch(U5){i.e(U5)}finally{i.f()}return e.abrupt("return",(""!==n&&t.headers.remove(n),this._nextPolicy.sendRequest(t)));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(hV),$$=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e,t){return new Q$(e,t)}}]),e}(),e0=function(){function e(t,n,i){var r;_classCallCheck(this,e),r=AJ(n)?n:OJ(n||new _J,i);var a=new lQ(t,r.toServiceClientOptions()),o=GY(t);this.serviceOrContainerContext=o&&"/"!==o?new rK(a):new XX(a)}var t,n,i;return _createClass(e,[{key:"createBatch",value:function(){return new X$}},{key:"deleteBlobs",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new X$,a=_createForOfIteratorHelper(t),e.prev=2,a.s();case 4:if((o=a.n()).done){e.next=15;break}if("string"!=typeof(s=o.value)){e.next=11;break}return e.next=9,r.deleteBlob(s,n,i);case 9:e.next=13;break;case 11:return e.next=13,r.deleteBlob(s,n);case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:return e.abrupt("return",this.submitBatch(r));case 24:case"end":return e.stop()}}),e,this,[[2,17,20,23]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"setBlobsAccessTier",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i,r){var a,o,s,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new X$,o=_createForOfIteratorHelper(t),e.prev=2,o.s();case 4:if((s=o.n()).done){e.next=15;break}if("string"!=typeof(l=s.value)){e.next=11;break}return e.next=9,a.setBlobAccessTier(l,n,i,r);case 9:e.next=13;break;case 11:return e.next=13,a.setBlobAccessTier(l,n,i);case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:return e.abrupt("return",this.submitBatch(a));case 24:case"end":return e.stop()}}),e,this,[[2,17,20,23]])}))),function(e,t,i,r){return n.apply(this,arguments)})},{key:"submitBatch",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:{},t&&0!==t.getSubRequests().size){e.next=3;break}throw new RangeError("Batch request should contain one or more sub requests.");case 3:return i=cQ("BlobBatchClient-submitBatch",n),r=i.span,a=i.updatedOptions,e.prev=4,o=t.getHttpRequestBody(),e.next=8,this.serviceOrContainerContext.submitBatch((c=o,new Blob([c]).size),t.getMultiPartContentType(),o,Object.assign(Object.assign({},n),hQ(a)));case 8:return s=e.sent,l=new W$(s,t.getSubRequests()),e.next=12,l.parseBatchResponse();case 12:return u=e.sent,e.abrupt("return",{_response:s._response,contentType:s.contentType,errorCode:s.errorCode,requestId:s.requestId,clientRequestId:s.clientRequestId,version:s.version,subResponses:u.subResponses,subResponsesSucceededCount:u.subResponsesSucceededCount,subResponsesFailedCount:u.subResponsesFailedCount});case 16:throw e.prev=16,e.t0=e.catch(4),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 19:return e.prev=19,r.end(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[4,16,19,22]])}))),function(e){return t.apply(this,arguments)})}]),e}(),t0=function(e){function t(e,n,i){var r,a,o;if(_classCallCheck(this,t),i=i||{},AJ(n))o=e,a=n;else if(uV&&n instanceof DJ||n instanceof _J||cV(n))o=e,a=OJ(n,i);else if(n||"string"==typeof n){if(!n||"string"!=typeof n)throw new Error("Expecting non-empty strings for containerName parameter");var s=n,l=HY(e);if("AccountConnString"===l.kind){if(!uV)throw new Error("Account connection string is only supported in Node.js environment");var u=new DJ(l.accountName,l.accountKey);o=VY(l.url,encodeURIComponent(s)),i.proxyOptions||(i.proxyOptions=void 0),a=OJ(u,i)}else{if("SASConnString"!==l.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");o=VY(l.url,encodeURIComponent(s))+"?"+l.accountSas,a=OJ(new _J,i)}}else o=e,a=OJ(new _J,i);return(r=_callSuper(this,t,[o,a]))._containerName=r.getContainerNameFromUrl(),r.containerContext=new rK(r.storageClientContext),r}var n,i,r,a,o,s,l,u,c,h,d,f,p,m;return _inherits(t,e),_createClass(t,[{key:"containerName",get:function(){return this._containerName}},{key:"create",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("ContainerClient-create",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.containerContext.create(Object.assign(Object.assign({},t),hQ(r)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,i.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(){return m.apply(this,arguments)})},{key:"createIfNotExists",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=cQ("ContainerClient-createIfNotExists",t),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.create(o);case 5:return s=e.sent,e.abrupt("return",Object.assign(Object.assign({succeeded:!0},s),{_response:s._response}));case 9:if(e.prev=9,e.t0=e.catch(2),"ContainerAlreadyExists"!==(null===(n=e.t0.details)||void 0===n?void 0:n.errorCode)){e.next=13;break}return e.abrupt("return",(a.setStatus({code:sU.ERROR,message:"Expected exception when creating a container only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(i=e.t0.response)||void 0===i?void 0:i.parsedHeaders),{_response:e.t0.response})));case 13:throw a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,a.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,9,14,17]])}))),function(){return p.apply(this,arguments)})},{key:"exists",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("ContainerClient-exists",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.getProperties({abortSignal:t.abortSignal,tracingOptions:r.tracingOptions});case 5:return e.abrupt("return",!0);case 8:if(e.prev=8,e.t0=e.catch(2),404!==e.t0.statusCode){e.next=12;break}return e.abrupt("return",(i.setStatus({code:sU.ERROR,message:"Expected exception when checking container existence"}),!1));case 12:throw i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,i.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,8,13,16]])}))),function(){return f.apply(this,arguments)})},{key:"getBlobClient",value:function(e){return new V$(VY(this.url,uJ(e)),this.pipeline)}},{key:"getAppendBlobClient",value:function(e){return new U$(VY(this.url,uJ(e)),this.pipeline)}},{key:"getBlockBlobClient",value:function(e){return new q$(VY(this.url,uJ(e)),this.pipeline)}},{key:"getPageBlobClient",value:function(e){return new G$(VY(this.url,uJ(e)),this.pipeline)}},{key:"getProperties",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=a.length>0&&void 0!==a[0]?a[0]:{}).conditions||(t.conditions={}),n=cQ("ContainerClient-getProperties",t),i=n.span,r=n.updatedOptions,e.prev=3,e.next=6,this.containerContext.getProperties(Object.assign(Object.assign({abortSignal:t.abortSignal},t.conditions),hQ(r)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,i.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(){return d.apply(this,arguments)})},{key:"delete",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=a.length>0&&void 0!==a[0]?a[0]:{}).conditions||(t.conditions={}),n=cQ("ContainerClient-delete",t),i=n.span,r=n.updatedOptions,e.prev=3,e.next=6,this.containerContext.delete(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:t.conditions},hQ(r)));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,i.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[3,9,12,15]])}))),function(){return h.apply(this,arguments)})},{key:"deleteIfExists",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=cQ("ContainerClient-deleteIfExists",t),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.delete(o);case 5:return s=e.sent,e.abrupt("return",Object.assign(Object.assign({succeeded:!0},s),{_response:s._response}));case 9:if(e.prev=9,e.t0=e.catch(2),"ContainerNotFound"!==(null===(n=e.t0.details)||void 0===n?void 0:n.errorCode)){e.next=13;break}return e.abrupt("return",(a.setStatus({code:sU.ERROR,message:"Expected exception when deleting a container only if it exists."}),Object.assign(Object.assign({succeeded:!1},null===(i=e.t0.response)||void 0===i?void 0:i.parsedHeaders),{_response:e.t0.response})));case 13:throw a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 14:return e.prev=14,a.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,9,14,17]])}))),function(){return c.apply(this,arguments)})},{key:"setMetadata",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=o.length>1&&void 0!==o[1]?o[1]:{}).conditions||(n.conditions={}),!n.conditions.ifUnmodifiedSince){e.next=3;break}throw new RangeError("the IfUnmodifiedSince must have their default values because they are ignored by the blob service");case 3:return i=cQ("ContainerClient-setMetadata",n),r=i.span,a=i.updatedOptions,e.prev=4,e.next=7,this.containerContext.setMetadata(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,metadata:t,modifiedAccessConditions:n.conditions},hQ(a)));case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,r.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[4,10,13,16]])}))),function(e){return u.apply(this,arguments)})},{key:"getAccessPolicy",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=h.length>0&&void 0!==h[0]?h[0]:{}).conditions||(t.conditions={}),n=cQ("ContainerClient-getAccessPolicy",t),i=n.span,r=n.updatedOptions,e.prev=3,e.next=6,this.containerContext.getAccessPolicy(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions},hQ(r)));case 6:a=e.sent,o={_response:a._response,blobPublicAccess:a.blobPublicAccess,date:a.date,etag:a.etag,errorCode:a.errorCode,lastModified:a.lastModified,requestId:a.requestId,clientRequestId:a.clientRequestId,signedIdentifiers:[],version:a.version},s=_createForOfIteratorHelper(a);try{for(s.s();!(l=s.n()).done;)u=l.value,c=void 0,u.accessPolicy&&(c={permissions:u.accessPolicy.permissions},u.accessPolicy.expiresOn&&(c.expiresOn=new Date(u.accessPolicy.expiresOn)),u.accessPolicy.startsOn&&(c.startsOn=new Date(u.accessPolicy.startsOn))),o.signedIdentifiers.push({accessPolicy:c,id:u.id})}catch(U5){s.e(U5)}finally{s.f()}return e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(3),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 16:return e.prev=16,i.end(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[3,13,16,19]])}))),function(){return l.apply(this,arguments)})},{key:"setAccessPolicy",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u,c,h=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=h.length>2&&void 0!==h[2]?h[2]:{}).conditions=i.conditions||{},r=cQ("ContainerClient-setAccessPolicy",i),a=r.span,o=r.updatedOptions,e.prev=3,s=[],l=_createForOfIteratorHelper(n||[]);try{for(l.s();!(u=l.n()).done;)c=u.value,s.push({accessPolicy:{expiresOn:c.accessPolicy.expiresOn?XY(c.accessPolicy.expiresOn):"",permissions:c.accessPolicy.permissions,startsOn:c.accessPolicy.startsOn?XY(c.accessPolicy.startsOn):""},id:c.id})}catch(U5){l.e(U5)}finally{l.f()}return e.next=9,this.containerContext.setAccessPolicy(Object.assign({abortSignal:i.abortSignal,access:t,containerAcl:s,leaseAccessConditions:i.conditions,modifiedAccessConditions:i.conditions},hQ(o)));case 9:return e.abrupt("return",e.sent);case 12:throw e.prev=12,e.t0=e.catch(3),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 15:return e.prev=15,a.end(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[3,12,15,18]])}))),function(e,t){return s.apply(this,arguments)})},{key:"getBlobLeaseClient",value:function(e){return new YQ(this,e)}},{key:"uploadBlockBlob",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var r,a,o,s,l,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>3&&void 0!==c[3]?c[3]:{},a=cQ("ContainerClient-uploadBlockBlob",r),o=a.span,s=a.updatedOptions,e.prev=2,l=this.getBlockBlobClient(t),e.next=6,l.upload(n,i,s);case 6:return u=e.sent,e.abrupt("return",{blockBlobClient:l,response:u});case 10:throw e.prev=10,e.t0=e.catch(2),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,o.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e,t,n){return o.apply(this,arguments)})},{key:"deleteBlob",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=cQ("ContainerClient-deleteBlob",n),r=i.span,a=i.updatedOptions,e.prev=2,o=this.getBlobClient(t),n.versionId&&(o=o.withVersion(n.versionId)),e.next=7,o.delete(a);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,r.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e){return a.apply(this,arguments)})},{key:"listBlobFlatSegment",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},i=cQ("ContainerClient-listBlobFlatSegment",n),r=i.span,a=i.updatedOptions,e.prev=2,e.next=5,this.containerContext.listBlobFlatSegment(Object.assign(Object.assign({marker:t},n),hQ(a)));case 5:return o=e.sent,e.abrupt("return",Object.assign(Object.assign({},o),{_response:Object.assign(Object.assign({},o._response),{parsedBody:(s=o._response.parsedBody,Object.assign(Object.assign({},s),{segment:{blobItems:s.segment.blobItems.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name)})}))}}))}),segment:Object.assign(Object.assign({},o.segment),{blobItems:o.segment.blobItems.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name),tags:tJ(e.blobTags),objectReplicationSourceProperties:iJ(e.objectReplicationMetadata)})}))})}));case 9:throw e.prev=9,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e){return r.apply(this,arguments)})},{key:"listBlobHierarchySegment",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},a=cQ("ContainerClient-listBlobHierarchySegment",i),o=a.span,s=a.updatedOptions,e.prev=2,e.next=5,this.containerContext.listBlobHierarchySegment(t,Object.assign(Object.assign({marker:n},i),hQ(s)));case 5:return l=e.sent,e.abrupt("return",Object.assign(Object.assign({},l),{_response:Object.assign(Object.assign({},l._response),{parsedBody:sJ(l._response.parsedBody)}),segment:Object.assign(Object.assign({},l.segment),{blobItems:l.segment.blobItems.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name),tags:tJ(e.blobTags),objectReplicationSourceProperties:iJ(e.objectReplicationMetadata)})})),blobPrefixes:null===(r=l.segment.blobPrefixes)||void 0===r?void 0:r.map((function(e){return Object.assign(Object.assign({},e),{name:oJ(e.name)})}))})}));case 9:throw e.prev=9,e.t0=e.catch(2),o.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,o.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e,t){return i.apply(this,arguments)})},{key:"listSegments",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rV(this,arguments,_regeneratorRuntime().mark((function n(){var i;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e&&void 0!==e){n.next=14;break}case 1:return n.next=3,iV(this.listBlobFlatSegment(e,t));case 3:return i=n.sent,e=i.continuationToken,n.t0=iV,n.next=8,iV(i);case 8:return n.t1=n.sent,n.next=11,(0,n.t0)(n.t1);case 11:return n.next=13,n.sent;case 13:if(e){n.next=1;break}case 14:case"end":return n.stop()}}),n,this)})))}},{key:"listItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rV(this,arguments,_regeneratorRuntime().mark((function t(){var n,i,r,a,o;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,a=oV(this.listSegments(void 0,e));case 2:return t.next=4,iV(a.next());case 4:if((r=t.sent).done){t.next=13;break}return o=r.value,t.t0=iV,t.delegateYield(aV(oV(o.segment.blobItems)),"t1",8);case 8:return t.t2=t.t1,t.next=11,(0,t.t0)(t.t2);case 11:t.next=2;break;case 13:t.next=18;break;case 15:t.prev=15,t.t3=t.catch(0),n={error:t.t3};case 18:if(t.prev=18,t.prev=19,t.t4=r&&!r.done&&(i=a.return),!t.t4){t.next=24;break}return t.next=24,iV(i.call(a));case 24:if(t.prev=24,!n){t.next=27;break}throw n.error;case 27:return t.finish(24);case 28:return t.finish(18);case 29:case"end":return t.stop()}}),t,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"listBlobsFlat",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=[];t.includeCopy&&n.push("copy"),t.includeDeleted&&n.push("deleted"),t.includeMetadata&&n.push("metadata"),t.includeSnapshots&&n.push("snapshots"),t.includeVersions&&n.push("versions"),t.includeUncommitedBlobs&&n.push("uncommittedblobs"),t.includeTags&&n.push("tags"),t.includeDeletedWithVersions&&n.push("deletedwithversions"),t.includeImmutabilityPolicy&&n.push("immutabilitypolicy"),t.includeLegalHold&&n.push("legalhold"),""===t.prefix&&(t.prefix=void 0);var i=Object.assign(Object.assign({},t),n.length>0?{include:n}:{}),r=this.listItems(i);return _defineProperty(_defineProperty({next:function(){return r.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.listSegments(t.continuationToken,Object.assign({maxPageSize:t.maxPageSize},i))}))}},{key:"listHierarchySegments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return rV(this,arguments,_regeneratorRuntime().mark((function i(){var r;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t&&void 0!==t){i.next=14;break}case 1:return i.next=3,iV(this.listBlobHierarchySegment(e,t,n));case 3:return r=i.sent,t=r.continuationToken,i.t0=iV,i.next=8,iV(r);case 8:return i.t1=i.sent,i.next=11,(0,i.t0)(i.t1);case 11:return i.next=13,i.sent;case 13:if(t){i.next=1;break}case 14:case"end":return i.stop()}}),i,this)})))}},{key:"listItemsByHierarchy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rV(this,arguments,_regeneratorRuntime().mark((function n(){var i,r,a,o,s,l,u,c,h,d,f;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,o=oV(this.listHierarchySegments(e,void 0,t));case 2:return n.next=4,iV(o.next());case 4:if((a=n.sent).done){n.next=47;break}if(!(s=a.value.segment).blobPrefixes){n.next=26;break}l=_createForOfIteratorHelper(s.blobPrefixes),n.prev=8,l.s();case 10:if((u=l.n()).done){n.next=18;break}return c=u.value,n.next=14,iV(Object.assign({kind:"prefix"},c));case 14:return n.next=16,n.sent;case 16:n.next=10;break;case 18:n.next=23;break;case 20:n.prev=20,n.t0=n.catch(8),l.e(n.t0);case 23:return n.prev=23,l.f(),n.finish(23);case 26:h=_createForOfIteratorHelper(s.blobItems),n.prev=27,h.s();case 29:if((d=h.n()).done){n.next=37;break}return f=d.value,n.next=33,iV(Object.assign({kind:"blob"},f));case 33:return n.next=35,n.sent;case 35:n.next=29;break;case 37:n.next=42;break;case 39:n.prev=39,n.t1=n.catch(27),h.e(n.t1);case 42:return n.prev=42,h.f(),n.finish(42);case 45:n.next=2;break;case 47:n.next=52;break;case 49:n.prev=49,n.t2=n.catch(0),i={error:n.t2};case 52:if(n.prev=52,n.prev=53,n.t3=a&&!a.done&&(r=o.return),!n.t3){n.next=58;break}return n.next=58,iV(r.call(o));case 58:if(n.prev=58,!i){n.next=61;break}throw i.error;case 61:return n.finish(58);case 62:return n.finish(52);case 63:case"end":return n.stop()}}),n,this,[[0,49,52,63],[8,20,23,26],[27,39,42,45],[53,,58,62]])})))}},{key:"listBlobsByHierarchy",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(""===e)throw new RangeError("delimiter should contain one or more characters");var i=[];n.includeCopy&&i.push("copy"),n.includeDeleted&&i.push("deleted"),n.includeMetadata&&i.push("metadata"),n.includeSnapshots&&i.push("snapshots"),n.includeVersions&&i.push("versions"),n.includeUncommitedBlobs&&i.push("uncommittedblobs"),n.includeTags&&i.push("tags"),n.includeDeletedWithVersions&&i.push("deletedwithversions"),n.includeImmutabilityPolicy&&i.push("immutabilitypolicy"),n.includeLegalHold&&i.push("legalhold"),""===n.prefix&&(n.prefix=void 0);var r,a=Object.assign(Object.assign({},n),i.length>0?{include:i}:{}),o=this.listItemsByHierarchy(e,a);return _defineProperty(_defineProperty({next:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.next());case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.listHierarchySegments(e,n.continuationToken,Object.assign({maxPageSize:n.maxPageSize},a))}))}},{key:"findBlobsByTagsSegment",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:{},r=cQ("ContainerClient-findBlobsByTagsSegment",i),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.containerContext.filterBlobs(Object.assign({abortSignal:i.abortSignal,where:t,marker:n,maxPageSize:i.maxPageSize},hQ(o)));case 5:return s=e.sent,e.abrupt("return",Object.assign(Object.assign({},s),{_response:s._response,blobs:s.blobs.map((function(e){var t,n="";return 1===(null===(t=e.tags)||void 0===t?void 0:t.blobTagSet.length)&&(n=e.tags.blobTagSet[0].value),Object.assign(Object.assign({},e),{tags:tJ(e.tags),tagValue:n})}))}));case 9:throw e.prev=9,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,a.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e,t){return n.apply(this,arguments)})},{key:"findBlobsByTagsSegments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return rV(this,arguments,_regeneratorRuntime().mark((function i(){var r;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t&&void 0!==t){i.next=11;break}case 1:return i.next=3,iV(this.findBlobsByTagsSegment(e,t,n));case 3:return(r=i.sent).blobs=r.blobs||[],t=r.continuationToken,i.next=8,iV(r);case 8:return i.next=10,i.sent;case 10:if(t){i.next=1;break}case 11:case"end":return i.stop()}}),i,this)})))}},{key:"findBlobsByTagsItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rV(this,arguments,_regeneratorRuntime().mark((function n(){var i,r,a,o,s;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,o=oV(this.findBlobsByTagsSegments(e,void 0,t));case 2:return n.next=4,iV(o.next());case 4:if((a=n.sent).done){n.next=13;break}return s=a.value,n.t0=iV,n.delegateYield(aV(oV(s.blobs)),"t1",8);case 8:return n.t2=n.t1,n.next=11,(0,n.t0)(n.t2);case 11:n.next=2;break;case 13:n.next=18;break;case 15:n.prev=15,n.t3=n.catch(0),i={error:n.t3};case 18:if(n.prev=18,n.prev=19,n.t4=a&&!a.done&&(r=o.return),!n.t4){n.next=24;break}return n.next=24,iV(r.call(o));case 24:if(n.prev=24,!i){n.next=27;break}throw i.error;case 27:return n.finish(24);case 28:return n.finish(18);case 29:case"end":return n.stop()}}),n,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"findBlobsByTags",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},n),r=this.findBlobsByTagsItems(e,i);return _defineProperty(_defineProperty({next:function(){return r.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.findBlobsByTagsSegments(e,n.continuationToken,Object.assign({maxPageSize:n.maxPageSize},i))}))}},{key:"getContainerNameFromUrl",value:function(){var e;try{var t=iY.parse(this.url);if(e="blob"===t.getHost().split(".")[1]?t.getPath().split("/")[1]:QY(t)?t.getPath().split("/")[2]:t.getPath().split("/")[1],!(e=decodeURIComponent(e)))throw new Error("Provided containerName is invalid.");return e}catch(n){throw new Error("Unable to extract containerName with provided information.")}}},{key:"generateSasUrl",value:function(e){var t=this;return new Promise((function(n){if(!(t.credential instanceof DJ))throw new RangeError("Can only generate the SAS when the client is initialized with a shared key credential");var i=yQ(Object.assign({containerName:t._containerName},e),t.credential).toString();n(ZY(t.url,i))}))}},{key:"getBlobBatchClient",value:function(){return new e0(this.url,this.pipeline)}}]),t}(uQ);"function"==typeof SuppressedError&&SuppressedError;var n0,i0,r0=function(){function e(){_classCallCheck(this,e),this.read=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.list=!1,this.add=!1,this.create=!1,this.update=!1,this.process=!1,this.tag=!1,this.filter=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1}return _createClass(e,[{key:"toString",value:function(){var e=[];return this.read&&e.push("r"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.filter&&e.push("f"),this.tag&&e.push("t"),this.list&&e.push("l"),this.add&&e.push("a"),this.create&&e.push("c"),this.update&&e.push("u"),this.process&&e.push("p"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),e.join("")}}],[{key:"parse",value:function(t){var n,i=new e,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;switch(a){case"r":i.read=!0;break;case"w":i.write=!0;break;case"d":i.delete=!0;break;case"x":i.deleteVersion=!0;break;case"l":i.list=!0;break;case"a":i.add=!0;break;case"c":i.create=!0;break;case"u":i.update=!0;break;case"p":i.process=!0;break;case"t":i.tag=!0;break;case"f":i.filter=!0;break;case"i":i.setImmutabilityPolicy=!0;break;case"y":i.permanentDelete=!0;break;default:throw new RangeError("Invalid permission character: "+a)}}}catch(U5){r.e(U5)}finally{r.f()}return i}},{key:"from",value:function(t){var n=new e;return t.read&&(n.read=!0),t.write&&(n.write=!0),t.delete&&(n.delete=!0),t.deleteVersion&&(n.deleteVersion=!0),t.filter&&(n.filter=!0),t.tag&&(n.tag=!0),t.list&&(n.list=!0),t.add&&(n.add=!0),t.create&&(n.create=!0),t.update&&(n.update=!0),t.process&&(n.process=!0),t.setImmutabilityPolicy&&(n.setImmutabilityPolicy=!0),t.permanentDelete&&(n.permanentDelete=!0),n}}]),e}(),a0=function(){function e(){_classCallCheck(this,e),this.service=!1,this.container=!1,this.object=!1}return _createClass(e,[{key:"toString",value:function(){var e=[];return this.service&&e.push("s"),this.container&&e.push("c"),this.object&&e.push("o"),e.join("")}}],[{key:"parse",value:function(t){var n,i=new e,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;switch(a){case"s":i.service=!0;break;case"c":i.container=!0;break;case"o":i.object=!0;break;default:throw new RangeError("Invalid resource type: "+a)}}}catch(U5){r.e(U5)}finally{r.f()}return i}}]),e}(),o0=function(){function e(){_classCallCheck(this,e),this.blob=!1,this.file=!1,this.queue=!1,this.table=!1}return _createClass(e,[{key:"toString",value:function(){var e=[];return this.blob&&e.push("b"),this.table&&e.push("t"),this.queue&&e.push("q"),this.file&&e.push("f"),e.join("")}}],[{key:"parse",value:function(t){var n,i=new e,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;switch(a){case"b":i.blob=!0;break;case"f":i.file=!0;break;case"q":i.queue=!0;break;case"t":i.table=!0;break;default:throw new RangeError("Invalid service character: "+a)}}}catch(U5){r.e(U5)}finally{r.f()}return i}}]),e}(),s0=function(e){function t(e,n,i){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e,AJ(n)?n:uV&&n instanceof DJ||n instanceof _J||cV(n)?OJ(n,i):OJ(new _J,i)])).serviceContext=new XX(r.storageClientContext),r}var n,i,r,a,o,s,l,u,c,h,d;return _inherits(t,e),_createClass(t,[{key:"getContainerClient",value:function(e){return new t0(VY(this.url,encodeURIComponent(e)),this.pipeline)}},{key:"createContainer",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},i=cQ("BlobServiceClient-createContainer",n),r=i.span,a=i.updatedOptions,e.prev=2,o=this.getContainerClient(t),e.next=6,o.create(a);case 6:return s=e.sent,e.abrupt("return",{containerClient:o,containerCreateResponse:s});case 10:throw e.prev=10,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,r.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e){return d.apply(this,arguments)})},{key:"deleteContainer",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o,s=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=cQ("BlobServiceClient-deleteContainer",n),r=i.span,a=i.updatedOptions,e.prev=2,o=this.getContainerClient(t),e.next=6,o.delete(a);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,r.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e){return h.apply(this,arguments)})},{key:"undeleteContainer",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},r=cQ("BlobServiceClient-undeleteContainer",i),a=r.span,o=r.updatedOptions,e.prev=2,s=this.getContainerClient(i.destinationContainerName||t),l=new rK(s.storageClientContext),e.t0=s,e.next=7,l.restore(Object.assign({deletedContainerName:t,deletedContainerVersion:n},o));case 7:return e.t1=e.sent,e.abrupt("return",{containerClient:e.t0,containerUndeleteResponse:e.t1});case 11:throw e.prev=11,e.t2=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t2.message}),e.t2;case 14:return e.prev=14,a.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,11,14,17]])}))),function(e,t){return c.apply(this,arguments)})},{key:"renameContainer",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]?c[2]:{},a=cQ("BlobServiceClient-renameContainer",i),o=a.span,s=a.updatedOptions,e.prev=2,l=this.getContainerClient(n),u=new rK(l.storageClientContext),e.t0=l,e.next=7,u.rename(t,Object.assign(Object.assign({},s),{sourceLeaseId:null===(r=i.sourceCondition)||void 0===r?void 0:r.leaseId}));case 7:return e.t1=e.sent,e.abrupt("return",{containerClient:e.t0,containerRenameResponse:e.t1});case 11:throw e.prev=11,e.t2=e.catch(2),o.setStatus({code:sU.ERROR,message:e.t2.message}),e.t2;case 14:return e.prev=14,o.end(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[2,11,14,17]])}))),function(e,t){return u.apply(this,arguments)})},{key:"getProperties",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("BlobServiceClient-getProperties",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.serviceContext.getProperties(Object.assign({abortSignal:t.abortSignal},hQ(r)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,i.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(){return l.apply(this,arguments)})},{key:"setProperties",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},i=cQ("BlobServiceClient-setProperties",n),r=i.span,a=i.updatedOptions,e.prev=2,e.next=5,this.serviceContext.setProperties(t,Object.assign({abortSignal:n.abortSignal},hQ(a)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,r.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return s.apply(this,arguments)})},{key:"getStatistics",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("BlobServiceClient-getStatistics",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.serviceContext.getStatistics(Object.assign({abortSignal:t.abortSignal},hQ(r)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,i.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(){return o.apply(this,arguments)})},{key:"getAccountInfo",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,r,a=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=cQ("BlobServiceClient-getAccountInfo",t),i=n.span,r=n.updatedOptions,e.prev=2,e.next=5,this.serviceContext.getAccountInfo(Object.assign({abortSignal:t.abortSignal},hQ(r)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),i.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,i.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(){return a.apply(this,arguments)})},{key:"listContainersSegment",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,a,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},i=cQ("BlobServiceClient-listContainersSegment",n),r=i.span,a=i.updatedOptions,e.prev=2,e.next=5,this.serviceContext.listContainersSegment(Object.assign(Object.assign(Object.assign({abortSignal:n.abortSignal,marker:t},n),{include:"string"==typeof n.include?[n.include]:n.include}),hQ(a)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),r.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 11:return e.prev=11,r.end(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[2,8,11,14]])}))),function(e){return r.apply(this,arguments)})},{key:"findBlobsByTagsSegment",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:{},r=cQ("BlobServiceClient-findBlobsByTagsSegment",i),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.serviceContext.filterBlobs(Object.assign({abortSignal:i.abortSignal,where:t,marker:n,maxPageSize:i.maxPageSize},hQ(o)));case 5:return s=e.sent,e.abrupt("return",Object.assign(Object.assign({},s),{_response:s._response,blobs:s.blobs.map((function(e){var t,n="";return 1===(null===(t=e.tags)||void 0===t?void 0:t.blobTagSet.length)&&(n=e.tags.blobTagSet[0].value),Object.assign(Object.assign({},e),{tags:tJ(e.tags),tagValue:n})}))}));case 9:throw e.prev=9,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 12:return e.prev=12,a.end(),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e,t){return i.apply(this,arguments)})},{key:"findBlobsByTagsSegments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return rV(this,arguments,_regeneratorRuntime().mark((function i(){var r;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t&&void 0!==t){i.next=11;break}case 1:return i.next=3,iV(this.findBlobsByTagsSegment(e,t,n));case 3:return(r=i.sent).blobs=r.blobs||[],t=r.continuationToken,i.next=8,iV(r);case 8:return i.next=10,i.sent;case 10:if(t){i.next=1;break}case 11:case"end":return i.stop()}}),i,this)})))}},{key:"findBlobsByTagsItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rV(this,arguments,_regeneratorRuntime().mark((function n(){var i,r,a,o,s;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,o=oV(this.findBlobsByTagsSegments(e,void 0,t));case 2:return n.next=4,iV(o.next());case 4:if((a=n.sent).done){n.next=13;break}return s=a.value,n.t0=iV,n.delegateYield(aV(oV(s.blobs)),"t1",8);case 8:return n.t2=n.t1,n.next=11,(0,n.t0)(n.t2);case 11:n.next=2;break;case 13:n.next=18;break;case 15:n.prev=15,n.t3=n.catch(0),i={error:n.t3};case 18:if(n.prev=18,n.prev=19,n.t4=a&&!a.done&&(r=o.return),!n.t4){n.next=24;break}return n.next=24,iV(r.call(o));case 24:if(n.prev=24,!i){n.next=27;break}throw i.error;case 27:return n.finish(24);case 28:return n.finish(18);case 29:case"end":return n.stop()}}),n,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"findBlobsByTags",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},n),r=this.findBlobsByTagsItems(e,i);return _defineProperty(_defineProperty({next:function(){return r.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.findBlobsByTagsSegments(e,n.continuationToken,Object.assign({maxPageSize:n.maxPageSize},i))}))}},{key:"listSegments",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rV(this,arguments,_regeneratorRuntime().mark((function n(){var i;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e&&void 0!==e){n.next=15;break}case 1:return n.next=3,iV(this.listContainersSegment(e,t));case 3:return(i=n.sent).containerItems=i.containerItems||[],e=i.continuationToken,n.t0=iV,n.next=9,iV(i);case 9:return n.t1=n.sent,n.next=12,(0,n.t0)(n.t1);case 12:return n.next=14,n.sent;case 14:if(e){n.next=1;break}case 15:case"end":return n.stop()}}),n,this)})))}},{key:"listItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rV(this,arguments,_regeneratorRuntime().mark((function t(){var n,i,r,a,o;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,a=oV(this.listSegments(void 0,e));case 2:return t.next=4,iV(a.next());case 4:if((r=t.sent).done){t.next=13;break}return o=r.value,t.t0=iV,t.delegateYield(aV(oV(o.containerItems)),"t1",8);case 8:return t.t2=t.t1,t.next=11,(0,t.t0)(t.t2);case 11:t.next=2;break;case 13:t.next=18;break;case 15:t.prev=15,t.t3=t.catch(0),n={error:t.t3};case 18:if(t.prev=18,t.prev=19,t.t4=r&&!r.done&&(i=a.return),!t.t4){t.next=24;break}return t.next=24,iV(i.call(a));case 24:if(t.prev=24,!n){t.next=27;break}throw n.error;case 27:return t.finish(24);case 28:return t.finish(18);case 29:case"end":return t.stop()}}),t,this,[[0,15,18,29],[19,,24,28]])})))}},{key:"listContainers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};""===t.prefix&&(t.prefix=void 0);var n=[];t.includeDeleted&&n.push("deleted"),t.includeMetadata&&n.push("metadata"),t.includeSystem&&n.push("system");var i=Object.assign(Object.assign({},t),n.length>0?{include:n}:{}),r=this.listItems(i);return _defineProperty(_defineProperty({next:function(){return r.next()}},Symbol.asyncIterator,(function(){return this})),"byPage",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.listSegments(t.continuationToken,Object.assign({maxPageSize:t.maxPageSize},i))}))}},{key:"getUserDelegationKey",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i,r,a,o,s,l,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},r=cQ("BlobServiceClient-getUserDelegationKey",i),a=r.span,o=r.updatedOptions,e.prev=2,e.next=5,this.serviceContext.getUserDelegationKey({startsOn:XY(t,!1),expiresOn:XY(n,!1)},Object.assign({abortSignal:i.abortSignal},hQ(o)));case 5:return s=e.sent,l={signedObjectId:s.signedObjectId,signedTenantId:s.signedTenantId,signedStartsOn:new Date(s.signedStartsOn),signedExpiresOn:new Date(s.signedExpiresOn),signedService:s.signedService,signedVersion:s.signedVersion,value:s.value},e.abrupt("return",Object.assign({_response:s._response,requestId:s.requestId,clientRequestId:s.clientRequestId,version:s.version,date:s.date,errorCode:s.errorCode},l));case 10:throw e.prev=10,e.t0=e.catch(2),a.setStatus({code:sU.ERROR,message:e.t0.message}),e.t0;case 13:return e.prev=13,a.end(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e,t){return n.apply(this,arguments)})},{key:"getBlobBatchClient",value:function(){return new e0(this.url,this.pipeline)}},{key:"generateAccountSasUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r0.parse("r"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sco",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!(this.credential instanceof DJ))throw RangeError("Can only generate the account SAS when the client is initialized with a shared key credential");if(void 0===e){var r=new Date;e=new Date(r.getTime()+36e5)}var a=function(e,t){var n=e.version?e.version:"2023-11-03";if(e.permissions&&e.permissions.setImmutabilityPolicy&&n<"2020-08-04")throw RangeError("'version' must be >= '2020-08-04' when provided 'i' permission.");if(e.permissions&&e.permissions.deleteVersion&&n<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when provided 'x' permission.");if(e.permissions&&e.permissions.permanentDelete&&n<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when provided 'y' permission.");if(e.permissions&&e.permissions.tag&&n<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when provided 't' permission.");if(e.permissions&&e.permissions.filter&&n<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when provided 'f' permission.");if(e.encryptionScope&&n<"2020-12-06")throw RangeError("'version' must be >= '2020-12-06' when provided 'encryptionScope' in SAS.");var i,r=r0.parse(e.permissions.toString()),a=o0.parse(e.services).toString(),o=a0.parse(e.resourceTypes).toString();i=n>="2020-12-06"?[t.accountName,r,a,o,e.startsOn?XY(e.startsOn,!1):"",XY(e.expiresOn,!1),e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",n,e.encryptionScope?e.encryptionScope:"",""].join("\n"):[t.accountName,r,a,o,e.startsOn?XY(e.startsOn,!1):"",XY(e.expiresOn,!1),e.ipRange?vQ(e.ipRange):"",e.protocol?e.protocol:"",n,""].join("\n");var s=t.computeHMACSHA256(i);return new gQ(n,s,r.toString(),a,o,e.protocol,e.startsOn,e.expiresOn,e.ipRange,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e.encryptionScope)}(Object.assign({permissions:t,expiresOn:e,resourceTypes:n,services:o0.parse("b").toString()},i),this.credential).toString();return ZY(this.url,a)}}],[{key:"fromConnectionString",value:function(e,n){n=n||{};var i=HY(e);if("AccountConnString"===i.kind){if(uV){var r=new DJ(i.accountName,i.accountKey);n.proxyOptions||(n.proxyOptions=void 0);var a=OJ(r,n);return new t(i.url,a)}throw new Error("Account connection string is only supported in Node.js environment")}if("SASConnString"===i.kind){var o=OJ(new _J,n);return new t(i.url+"?"+i.accountSas,o)}throw new Error("Connection string must be either an Account connection string or a SAS connection string")}}]),t}(uQ),l0=((i0=function(){function e(){_classCallCheck(this,e),this.picturesAccount="storagesmartroute27",this.picturesContainer="filesupload"}return _createClass(e,[{key:"uploadImage",value:function(e,t,n,i){"exe"!=n.split(".")[1]&&this.uploadBlob(t,n,this.containerClient(e),i)}},{key:"listImages",value:function(e){return this.listBlobs(this.containerClient(e))}},{key:"downloadImage",value:function(e,t,n){this.downloadBlob(t,this.containerClient(e),n)}},{key:"deleteImage",value:function(e,t,n){this.deleteBlob(t,this.containerClient(e),n)}},{key:"uploadBlob",value:function(e,t,n,i){var r=n.getBlockBlobClient(t),a=e.type;t.indexOf("geojson")>=0&&(a="geojson"),r.uploadData(e,{blobHTTPHeaders:{blobContentType:a}}).then((function(){return i()}))}},{key:"listBlobs",value:function(e){var t,n,i,r,a;return i=this,a=_regeneratorRuntime().mark((function i(){var r,a,o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=[],a=e.listBlobsFlat(),i.prev=1,s=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}}(a);case 3:return i.next=5,s.next();case 5:if((o=i.sent).done){i.next=9;break}r.push(o.value.name);case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),t={error:i.t0};case 14:if(i.prev=14,i.prev=15,i.t1=o&&!o.done&&(n=s.return),!i.t1){i.next=20;break}return i.next=20,n.call(s);case 20:if(i.prev=20,!t){i.next=23;break}throw t.error;case 23:return i.finish(20);case 24:return i.finish(14);case 25:return i.abrupt("return",r);case 26:case"end":return i.stop()}}),i,null,[[1,11,14,25],[15,,20,24]])})),new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{s(a.next(e))}catch(q5){t(q5)}}function o(e){try{s(a.throw(e))}catch(q5){t(q5)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(n,o)}s((a=a.apply(i,[])).next())}))}},{key:"downloadBlob",value:function(e,t,n){t.getBlobClient(e).download().then((function(e){e.blobBody.then((function(e){n(e)}))}))}},{key:"deleteBlob",value:function(e,t,n){t.deleteBlob(e).then((function(){n()}))}},{key:"containerClient",value:function(e){return new s0("https://".concat(this.picturesAccount,".blob.core.windows.net?").concat(e)).getContainerClient(this.picturesContainer)}}]),e}()).\u0275fac=function(e){return new(e||i0)},i0.\u0275prov=me({token:i0,factory:i0.\u0275fac,providedIn:"root"}),i0),u0=((n0=function(){function e(){_classCallCheck(this,e),this.siteparams=new wp([]),this.addSiteData=this.siteparams.asObservable(),this.facilityparams=new wp([]),this.addFacilityData=this.facilityparams.asObservable(),this.facilityLocation=new wp([]),this.locateFacility=this.facilityLocation.asObservable(),this.levelParams=new wp([]),this.addlevelData=this.levelParams.asObservable(),this.polygondata=new wp([]),this.polygongeojson=this.polygondata.asObservable(),this.api=this.load()}return _createClass(e,[{key:"load",value:function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0;var t="GooglePlaces_cb_"+(1e9*Math.random()>>>0);e.src=this.getScriptSrc(t);var n=window,i=new Promise((function(i,r){n[t]=i,e.onerror=r}));return document.body.appendChild(e),i.then((function(){return google.maps}))}},{key:"getScriptSrc",value:function(e){var t={v:"3",callback:e,key:"AIzaSyCaKbVhcX_22R_pRKDYuNA7vox-PtGaDkI",libraries:"places"};return"//maps.googleapis.com/maps/api/js?".concat(Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&"),"&language=fr")}},{key:"setFacilitylocation",value:function(e){this.facilityLocation.next(e)}},{key:"addsitevalues",value:function(e){this.siteparams.next(e)}},{key:"addFacilityvalues",value:function(e){this.facilityparams.next(e)}},{key:"addLevelValues",value:function(e){this.levelParams.next(e)}},{key:"addpolygondata",value:function(e){this.polygondata.next(e)}}]),e}()).\u0275fac=function(e){return new(e||n0)},n0.\u0275prov=me({token:n0,factory:n0.\u0275fac,providedIn:"root"}),n0);function c0(e,t){1&e&&(Ao(0,"div"),ms(1,"Sitename is required"),Ro())}function h0(e,t){if(1&e&&(Ao(0,"div",20),Co(1,c0,2,0,"div",21),Ro()),2&e){qo();var n=So(8);yr(1),Mo("ngIf",n.errors.required)}}function d0(e,t){if(1&e){var n=zo();Ao(0,"a",22),Fo("click",(function(){return en(n),qo().redirect()})),ms(1,"click here to locate from map"),Ro()}}function f0(e,t){1&e&&(Ao(0,"div"),ms(1,"location is required"),Ro())}function p0(e,t){if(1&e&&(Ao(0,"div",20),Co(1,f0,2,0,"div",21),Ro()),2&e){qo();var n=So(28);yr(1),Mo("ngIf",n.errors.required)}}var m0,v0=function(e){return{"is-invalid":e}},g0=((m0=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this.snackBar=t,this.blobService=n,this.dialog=i,this.router=r,this.route=a,this.locationservice=o,this.siteonboarding=s,this.showPortal=!1,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteName:"",fileUrl:"",lan:0,lat:0},this.locationservice.addSiteData.subscribe((function(e){l.form.siteName=e[0].siteName,l.form.fileUrl=e[0].fileUrl,l.form.lan=e[0].lan,l.form.lat=e[0].lat,l.lanlat=e[0].lan+","+e[0].lat}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"fileUpload",value:function(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.picturesList=[],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.form.siteName.replace(/\s+/g,"")+"/"+this.fileType+"/"+e.name,(function(){})),this.reloadImages())}},{key:"locationchange",value:function(e){console.log(e.target.value,"::::event.target.value:::"),this.form.lan=e.target.value.split(",")[0],this.form.lat=e.target.value.split(",")[1],this.lanlat=e.target.value}},{key:"reloadImages",value:function(){var e=this;this.blobService.listImages(this.sas).then((function(t){t&&(e.form.fileUrl="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(e.form.siteName.replace(/\s+/g,""),"/").concat(e.fileType,"/").concat(e.fileName))}))}},{key:"onchangeSiteName",value:function(e){this.form.siteName=e}},{key:"redirect",value:function(){this.locationservice.addsitevalues([this.form]),this.router.navigate(["maptool/1"])}},{key:"onSubmit",value:function(){var e=this;console.log(this.form),0==this.form.lan&&this.lanlat.split(","),0==this.form.lat&&this.lanlat.split(","),this.siteonboarding.addSite(this.form).subscribe((function(t){console.log(t,"add site responce"),Object.entries(t).length>0?(e.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),e.dialog.closeAll(),e.router.navigate(["/map"])):e.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})}))}},{key:"onReset",value:function(e){e.reset()}}]),e}()).\u0275fac=function(e){return new(e||m0)(To(nV),To(l0),To(zM),To(zg),To(Tv),To(u0),To(LH))},m0.\u0275cmp=yt({type:m0,selectors:[["app-addsite"]],decls:35,vars:14,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["matInput","","type","text","name","sitename","placeholder","Enter site Name","required","",1,"form-control",3,"ngModel","ngClass","change","ngModelChange"],["sitename","ngModel"],["class","invalid-feedback",4,"ngIf"],[1,"buttongroup"],[1,"image-upload"],["for","file-input"],[1,"note"],[2,"font-size","12px"],["id","file-input","type","file","accept",".jpg,.img,.png,.JPEG",1,"upload",3,"disabled","change"],[3,"click",4,"ngIf"],["matSuffix",""],["matInput","","type","text","placeholder","Enter Coordinate Ex:[Lan, Lat]","name","Location","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange","change"],["location","ngModel"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"]],template:function(e,t){if(1&e){var n=zo();Ao(0,"div",0),Ao(1,"form",1,2),Fo("ngSubmit",(function(){return en(n),So(2).form.valid})),Ao(3,"div",3),Ao(4,"label"),ms(5,"Site Name"),Ro(),Ao(6,"mat-form-field",4),Ao(7,"input",5,6),Fo("change",(function(){en(n);var e=So(8);return t.onchangeSiteName(e.value)}))("ngModelChange",(function(e){return t.form.siteName=e})),Ro(),Co(9,h0,2,1,"div",7),Ro(),Ro(),Ao(10,"div",3),Ao(11,"div",8),Ao(12,"div",9),Ao(13,"label",10),Ao(14,"mat-icon"),ms(15,"cloud_upload"),Ro(),Ro(),Ao(16,"p",11),Ao(17,"span",12),ms(18,"(Supported File Formats:*/.png,.jpg,JPEG)"),Ro(),Ro(),Ao(19,"input",13),Fo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ro(),Ro(),Ro(),Ro(),Ao(20,"div",3),Ao(21,"label"),ms(22," Location"),Ro(),Co(23,d0,2,0,"a",14),Ao(24,"mat-icon",15),ms(25,"location_on"),Ro(),Ao(26,"mat-form-field",4),Ao(27,"input",16,17),Fo("ngModelChange",(function(e){return t.lanlat=e}))("change",(function(e){return t.locationchange(e)})),Ro(),Co(29,p0,2,1,"div",7),Ro(),Ro(),Ao(30,"div",8),Ao(31,"button",18),Fo("click",(function(){return t.onSubmit()})),ms(32,"Submit"),Ro(),Ao(33,"button",19),Fo("click",(function(){en(n);var e=So(2);return t.onReset(e)})),ms(34," Reset "),Ro(),Ro(),Ro(),Ro()}if(2&e){var i=So(2),r=So(8),a=So(28);yr(7),Mo("ngModel",t.form.siteName)("ngClass",Al(10,v0,i.submitted&&r.errors)),yr(2),Mo("ngIf",i.submitted&&r.errors),yr(10),Mo("disabled",!t.form.siteName),yr(4),Mo("ngIf",t.form.fileUrl),yr(4),Mo("disabled",!t.form.fileUrl)("ngModel",t.lanlat)("ngClass",Al(12,v0,i.submitted&&a.errors)),yr(2),Mo("ngIf",i.submitted&&a.errors),yr(2),Mo("disabled",!t.lanlat)}},directives:[HC,_k,RC,LP,UP,uk,GC,yk,jC,Dc,Fc,nk,RP,FT],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),m0);function y0(e,t){if(1&e&&(Ao(0,"mat-option",30),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.siteId),yr(1),vs(n.siteName)}}function _0(e,t){1&e&&(Ao(0,"div"),ms(1,"Sitename is required"),Ro())}function x0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,_0,2,0,"div",32),Ro()),2&e){qo();var n=So(11);yr(1),Mo("ngIf",n.errors.required)}}function b0(e,t){1&e&&(Ao(0,"div"),ms(1,"Facility name is required"),Ro())}function w0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,b0,2,0,"div",32),Ro()),2&e){qo();var n=So(21);yr(1),Mo("ngIf",n.errors.required)}}function k0(e,t){1&e&&(Ao(0,"div"),ms(1,"No. of Levels required"),Ro())}function C0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,k0,2,0,"div",32),Ro()),2&e){qo();var n=So(28);yr(1),Mo("ngIf",n.errors.required)}}function S0(e,t){1&e&&(Ao(0,"div"),ms(1,"Working Hours From required"),Ro())}function T0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,S0,2,0,"div",32),Ro()),2&e){qo();var n=So(36);yr(1),Mo("ngIf",n.errors.required)}}function E0(e,t){1&e&&(Ao(0,"div"),ms(1,"Working Hours To required"),Ro())}function P0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,E0,2,0,"div",32),Ro()),2&e){qo();var n=So(43);yr(1),Mo("ngIf",n.errors.required)}}function M0(e,t){if(1&e){var n=zo();Ao(0,"a",33),Fo("click",(function(){return en(n),qo().redirect()})),ms(1,"click here to locate from map "),Ro()}}function I0(e,t){1&e&&(Ao(0,"div"),ms(1,"location is required"),Ro())}function A0(e,t){1&e&&(Ao(0,"div"),ms(1," location must me geometry "),Ro())}function R0(e,t){1&e&&(Ao(0,"div"),ms(1," location must me geometry "),Ro())}function O0(e,t){if(1&e&&(Ao(0,"div",31),Co(1,I0,2,0,"div",32),Co(2,A0,2,0,"div",32),Co(3,R0,2,0,"div",32),Ro()),2&e){qo();var n=So(52);yr(1),Mo("ngIf",n.errors.required),yr(1),Mo("ngIf",n.errors.minlength),yr(1),Mo("ngIf",n.errors.maxlength)}}var N0,D0=function(e){return{"is-invalid":e}},z0=((N0=function(){function e(t,n,i,r,a,o){var s=this;_classCallCheck(this,e),this.dialog=t,this.blobService=n,this.snackBar=i,this.router=r,this.siteonboarding=a,this.maplocationservice=o,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.sitesData=[],this.form={siteId:"",facilityName:"",imageUrl:"",lan:0,lat:0,HrsFrom:0,HrsTo:0,MaxLevels:0},this.maplocationservice.addFacilityData.subscribe((function(e){s.form.siteId=e[0].siteId,s.form.facilityName=e[0].facilityName,s.form.imageUrl=e[0].imageUrl,s.form.lan=e[0].lan,s.form.lat=e[0].lat,s.form.HrsFrom=e[0].HrsFrom,s.form.HrsTo=e[0].HrsTo,s.form.MaxLevels=e[0].MaxLevels,s.lanlat=e[0].lan+","+e[0].lat}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.getAllSites()}},{key:"fileUpload",value:function(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1];var t=this.form.facilityName.replace(/\s+/g,"");console.log(t),this.picturesList=[],this.form.facilityName&&(this.blobService.uploadImage(this.sas,e,this.sitename+"/"+t+"/"+this.fileType+"/"+e.name,(function(){})),this.reloadImages())}},{key:"reloadImages",value:function(){var e=this;this.blobService.listImages(this.sas).then((function(t){e.form.imageUrl="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(e.sitename,"/").concat(e.form.facilityName.replace(/\s+/g,""),"/").concat(e.fileType,"/").concat(e.fileName),t.push("https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(e.sitename,"/").concat(e.form.facilityName.replace(/\s+/g,""),"/").concat(e.fileType,"/").concat(e.fileName)),t.forEach((function(t){e.downloadThisBlob(t,e.containerClient(e.sas))})),console.log(e.form,"list")}))}},{key:"containerClient",value:function(e){return new s0("https://".concat(this.blobService.picturesAccount,".blob.core.windows.net?").concat(e)).getContainerClient(this.blobService.picturesContainer)}},{key:"downloadThisBlob",value:function(e,t){var n=t.getBlobClient(e);return e.indexOf("geojson")>=0?n.setHTTPHeaders({blobContentType:"geojson"}):n.setHTTPHeaders({blobContentType:"application/octet-stream"}),n.url}},{key:"selectedSite",value:function(e){var t=this.sitesData.filter((function(t,n){return t.siteId==e}));this.sitename=t[0].siteName,this.maplocationservice.setFacilitylocation(t[0].location.coordinates)}},{key:"getAllSites",value:function(){var e=this;console.log(":::loading  sites::::"),this.siteonboarding.obtainedSiteDetails.subscribe((function(t){console.log(t),t&&(e.sitesData=t),console.log(e.sitesData,"siteData")}))}},{key:"redirect",value:function(){this.maplocationservice.addFacilityvalues([this.form]),this.router.navigate(["maptool/2"])}},{key:"locationchange",value:function(e){console.log(e.target.value,"::::event.target.value:::"),this.form.lan=e.target.value.split(",")[0],this.form.lat=e.target.value.split(",")[1],this.lanlat=e.target.value.split(",")[0]+","+e.target.value.split(",")[1]}},{key:"onSubmit",value:function(){var e=this;console.log(this.form,"add facility payload"),0==this.form.lan&&this.lanlat.split(","),0==this.form.lat&&this.lanlat.split(","),this.siteonboarding.addFacility(this.form).subscribe((function(t){Object.entries(t).length>0?(console.log(t,"add facility responce"),e.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),e.dialog.closeAll(),e.router.navigate(["/map"])):e.snackBar.open("Failed","retry",{duration:3e3,verticalPosition:"top"})}))}},{key:"onReset",value:function(e){e.reset()}}]),e}()).\u0275fac=function(e){return new(e||N0)(To(zM),To(l0),To(nV),To(zg),To(LH),To(u0))},N0.\u0275cmp=yt({type:N0,selectors:[["app-add-facility"]],decls:66,vars:39,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange","selectionChange"],["sitename","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["matInput","","type","text","name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["facilityname","ngModel"],["matInput","","type","number","name","MaxLevels","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["MaxLevels","ngModel"],["matInput","","type","time","name","workingHrs_Froms","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["workingHrs_Froms","ngModel"],["matInput","","type","time","name","workingHrs_To","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["workingHrs_To","ngModel"],[1,"buttongroup"],[3,"click",4,"ngIf"],["matInput","","type","text","name","Location","placeholder","Enter Coordinate Ex:[Lan, Lat]","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange","change"],["location","ngModel"],[1,"image-upload"],["for","file-input"],[2,"font-size","12px"],["id","file-input","type","file","accept","..jpg,.img,.png,.JPEG,.JPG",1,"upload",3,"disabled","change"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"]],template:function(e,t){if(1&e){var n=zo();Ao(0,"div",0),Ao(1,"form",1,2),Fo("ngSubmit",(function(){return en(n),So(2).form.valid})),Ao(3,"div",3),Ao(4,"div",4),Oo(5,"div",5),Ao(6,"div",5),Ao(7,"label"),ms(8,"Site Name"),Ro(),Ao(9,"mat-form-field",6),Ao(10,"mat-select",7,8),Fo("ngModelChange",(function(e){return t.form.siteId=e}))("selectionChange",(function(){en(n);var e=So(11);return t.selectedSite(e.value)})),Ao(12,"mat-option",9),ms(13,"Select Site"),Ro(),Co(14,y0,2,2,"mat-option",10),Ro(),Ro(),Co(15,x0,2,1,"div",11),Ro(),Ao(16,"div",5),Ao(17,"label"),ms(18,"Facility Name"),Ro(),Ao(19,"mat-form-field",6),Ao(20,"input",12,13),Fo("ngModelChange",(function(e){return t.form.facilityName=e})),Ro(),Ro(),Co(22,w0,2,1,"div",11),Ro(),Ao(23,"div",5),Ao(24,"label"),ms(25,"No. of Levels in Facility "),Ro(),Ao(26,"mat-form-field",6),Ao(27,"input",14,15),Fo("ngModelChange",(function(e){return t.form.MaxLevels=e})),Ro(),Ro(),Co(29,C0,2,1,"div",11),Ro(),Ro(),Ao(30,"div",4),Ao(31,"div",5),Ao(32,"label"),ms(33,"Working Hours From"),Ro(),Ao(34,"mat-form-field",6),Ao(35,"input",16,17),Fo("ngModelChange",(function(e){return t.form.HrsFrom=e})),Ro(),Ro(),Co(37,T0,2,1,"div",11),Ro(),Ao(38,"div",5),Ao(39,"label"),ms(40,"Working Hours To"),Ro(),Ao(41,"mat-form-field",6),Ao(42,"input",18,19),Fo("ngModelChange",(function(e){return t.form.HrsTo=e})),Ro(),Ro(),Co(44,P0,2,1,"div",11),Ro(),Ao(45,"div",5),Ao(46,"div",20),Ao(47,"label"),ms(48,"Location "),Ro(),Co(49,M0,2,0,"a",21),Ro(),Ao(50,"mat-form-field",6),Ao(51,"input",22,23),Fo("ngModelChange",(function(e){return t.lanlat=e}))("change",(function(e){return t.locationchange(e)})),Ro(),Ro(),Co(53,O0,4,3,"div",11),Ro(),Ro(),Ro(),Ao(54,"div",20),Ao(55,"div",24),Ao(56,"label",25),Ao(57,"mat-icon"),ms(58,"cloud_upload"),Ro(),Ao(59,"span",26),ms(60,"(Supported File Formats:*/.png,.jpg,JPEG)"),Ro(),Ro(),Ao(61,"input",27),Fo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ro(),Ro(),Ao(62,"button",28),Fo("click",(function(){return t.onSubmit()})),ms(63,"Submit"),Ro(),Ao(64,"button",29),Fo("click",(function(){en(n);var e=So(2);return t.onReset(e)})),ms(65," Reset "),Ro(),Ro(),Ro(),Ro()}if(2&e){var i=So(2),r=So(11),a=So(21),o=So(28),s=So(36),l=So(43),u=So(52);yr(10),Mo("ngModel",t.form.siteId)("ngClass",Al(27,D0,i.submitted&&r.errors)),yr(4),Mo("ngForOf",t.sitesData),yr(1),Mo("ngIf",i.submitted&&r.errors),yr(5),Mo("disabled",!t.form.siteId)("ngModel",t.form.facilityName)("ngClass",Al(29,D0,i.submitted&&a.errors)),yr(2),Mo("ngIf",i.submitted&&a.errors),yr(5),Mo("disabled",!t.form.facilityName)("ngModel",t.form.MaxLevels)("ngClass",Al(31,D0,i.submitted&&o.errors)),yr(2),Mo("ngIf",i.submitted&&o.errors),yr(6),Mo("disabled",!t.form.facilityName)("ngModel",t.form.HrsFrom)("ngClass",Al(33,D0,i.submitted&&s.errors)),yr(2),Mo("ngIf",i.submitted&&s.errors),yr(5),Mo("disabled",!t.form.facilityName)("ngModel",t.form.HrsTo)("ngClass",Al(35,D0,i.submitted&&l.errors)),yr(2),Mo("ngIf",i.submitted&&l.errors),yr(5),Mo("ngIf",t.form.imageUrl),yr(2),Mo("disabled",!t.form.facilityName)("ngModel",t.lanlat)("ngClass",Al(37,D0,i.submitted&&u.errors)),yr(2),Mo("ngIf",i.submitted&&u.errors),yr(8),Mo("disabled",!t.form.facilityName),yr(1),Mo("disabled",!t.lanlat)}},directives:[HC,_k,RC,LP,fM,GC,yk,jC,Dc,fb,Lc,Fc,UP,uk,Lk,nk,FT],styles:[".card[_ngcontent-%COMP%]{justify-content:center;margin:0}.card[_ngcontent-%COMP%], .items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.row[_ngcontent-%COMP%]{display:flex;justify-items:space-between}.col-md-6[_ngcontent-%COMP%]{padding:5px;margin:5px}"]}),N0);function L0(e,t){if(1&e&&(Ao(0,"mat-option",12),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.siteId),yr(1),vs(n.siteName)}}function B0(e,t){1&e&&(Ao(0,"div"),ms(1,"Site name is required"),Ro())}function F0(e,t){if(1&e&&(Ao(0,"div",27),Co(1,B0,2,0,"div",28),Ro()),2&e){qo();var n=So(8);yr(1),Mo("ngIf",n.errors.required)}}function j0(e,t){if(1&e&&(Ao(0,"mat-option",12),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.facilityId),yr(1),vs(n.facilityName)}}function H0(e,t){1&e&&(Ao(0,"div"),ms(1,"facility name is required"),Ro())}function V0(e,t){if(1&e&&(Ao(0,"div",27),Co(1,H0,2,0,"div",28),Ro()),2&e){qo();var n=So(18);yr(1),Mo("ngIf",n.errors.required)}}function U0(e,t){1&e&&(Ao(0,"div"),ms(1,"Level name is required"),Ro())}function q0(e,t){if(1&e&&(Ao(0,"div",27),Co(1,U0,2,0,"div",28),Ro()),2&e){qo();var n=So(28);yr(1),Mo("ngIf",n.errors.required)}}function G0(e,t){1&e&&(Ao(0,"div"),ms(1,"Capacity & Max-capacity required"),Ro())}function W0(e,t){if(1&e&&(Ao(0,"div",27),Co(1,G0,2,0,"div",28),Ro()),2&e){qo();var n=So(37),i=So(43);yr(1),Mo("ngIf",n.errors.required&&i.errors.required)}}var Z0,X0=function(e){return{"is-invalid":e}},K0=((Z0=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this.http=t,this.snackBar=n,this.router=i,this.blobService=r,this.siteonboarding=a,this.maplocationservice=o,this.dialog=s,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteId:"",facilityId:"",levelName:"",fileUrl:"",capacity:0,Max_capacity:0},this.allFacilities=[],this.sitesData=[],this.facilityData=[],this.selectedfile={},this.maplocationservice.addFacilityData.subscribe((function(e){console.log("In add floor component/constructor"),l.form.siteId=e.siteId,l.form.facilityId=e.facilityName,l.form.levelName=e.levelName,l.form.fileUrl=e.fileUrl}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.getSites(),this.getFacilities()}},{key:"handleFileSelect",value:function(e){}},{key:"fileUpload",value:function(e){var t=this;if(this.fileName=e.name,this.fileType=e.name.split(".")[1],"geojson"!==this.fileType)(new FormData).append("file",e),this.picturesList=[],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.sitename+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.form.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+e.name,(function(){})),this.reloadImages());else if("geojson"===this.fileType){var n=new FileReader;n.readAsText(e,"UTF-8"),n.onload=function(){t.selectedfile=JSON.parse(n.result),console.log(t.selectedfile),t.form.fileUrl="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(t.sitename,"/").concat(t.facilityName.replace(/\s+/g,""),"/").concat(t.form.levelName.replace(/\s+/g,""),"/").concat(t.fileType,"/").concat(t.fileName)},n.onerror=function(e){console.log(e)}}}},{key:"download",value:function(e,t,n){console.log(t);var i=document.createElement("a"),r=new Blob([e],{type:n});i.href=URL.createObjectURL(r),i.download=t,(new FormData).append("file",r),this.fileName&&(this.blobService.uploadImage(this.sas,r,this.sitename+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.form.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+this.fileName,(function(){})),this.reloadImages())}},{key:"onDownload",value:function(e){console.log(e,"editedgeojson"),this.download(JSON.stringify(e),this.form.levelName.replace(/\s+/g,"")+".geojson","text/plain")}},{key:"reloadImages",value:function(){var e=this;this.blobService.listImages(this.sas).then((function(t){t&&(e.form.fileUrl="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(e.sitename,"/").concat(e.facilityName.replace(/\s+/g,""),"/").concat(e.form.levelName.replace(/\s+/g,""),"/").concat(e.fileType,"/").concat(e.fileName))}))}},{key:"redirect",value:function(){console.log(this.form,"in add level after adding new level"),this.router.navigate(["createspaces/3"])}},{key:"getSites",value:function(){var e=this;this.siteonboarding.obtainedSiteDetails.subscribe((function(t){e.sitesData=t}))}},{key:"getFacilities",value:function(){var e=this;this.allFacilities=[],this.siteonboarding.obtainedFacilityDetails.subscribe((function(t){e.allFacilities=t}))}},{key:"selectedSite",value:function(e){this.facilityData=[],this.facilityName=null,console.log(e,this.allFacilities),this.facilityData=this.allFacilities.filter((function(t,n){return t.Site_Id==e})),this.facilityName=this.facilityData[0].facilityName}},{key:"selectedFacility",value:function(e){var t=this,n=this.facilityData.filter((function(t){return t.facilityId==e})),i=this.sitesData.filter((function(e){return e.siteId==t.form.siteId}));console.log(i,"selectedsiteobj"),this.sitename=i[0].siteName,this.maplocationservice.setFacilitylocation(n[0].facilitylocation.coordinates)}},{key:"onSubmit",value:function(){var e=this;console.log(this.form,"::::::form data:::::"),this.siteonboarding.addLevel(this.form).subscribe((function(t){Object.entries(t).length>0?(console.log(e.selectedfile.features,"this.selectedfile.features"),e.getAllLevels(),e.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),t.fileUrl.toString(),e.responceFacilityId=t.Facility_Id,e.maplocationservice.addLevelValues([t])):e.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})}))}},{key:"getAllLevels",value:function(){var e=this;this.siteonboarding.getAllLevels().subscribe((function(t){if(t)if(e.siteonboarding.saveAllLevelDetails(t),e.selectedfile.features){var n;n=t.filter((function(t,n){return t.Facility_Id===e.responceFacilityId&&t.levelName==e.form.levelName})),e.selectedfile.features.length>0&&e.selectedfile.features.forEach((function(t,i){t.properties?t.properties.levelId=n[0].levelId:null==t.properties&&(t.properties={levelId:n[0].levelId}),i==e.selectedfile.features.length-1&&(e.onDownload(e.selectedfile),e.siteonboarding.selectedtab=3)}))}else e.siteonboarding.selectedtab=3}))}},{key:"onReset",value:function(e){e.reset()}}]),e}()).\u0275fac=function(e){return new(e||Z0)(To(xw),To(nV),To(zg),To(l0),To(LH),To(u0),To(zM))},Z0.\u0275cmp=yt({type:Z0,selectors:[["app-add-floor"]],decls:57,vars:32,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange","selectionChange"],["sitename","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["facilityname","ngModel"],[3,"value"],["matInput","","type","text","name","levelname","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["levelname","ngModel"],[1,"buttongroup"],[1,"col"],["matInput","","type","number","name","capacity","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["capacity","ngModel"],["matInput","","type","number","name","Max_capacity","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["Max_capacity","ngModel"],[1,"image-upload"],["for","file-input"],[2,"font-size","12px"],["id","file-input","type","file","accept",".geojson,.jpg,.img,.png,.JPEG",1,"upload",3,"disabled","change"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){if(1&e){var n=zo();Ao(0,"div",0),Ao(1,"form",1,2),Fo("ngSubmit",(function(){return en(n),So(2).form.valid})),Ao(3,"div",3),Ao(4,"label"),ms(5,"Site Name"),Ro(),Ao(6,"mat-form-field",4),Ao(7,"mat-select",5,6),Fo("ngModelChange",(function(e){return t.form.siteId=e}))("selectionChange",(function(){en(n);var e=So(8);return t.selectedSite(e.value)})),Ao(9,"mat-option",7),ms(10,"Select Site"),Ro(),Co(11,L0,2,2,"mat-option",8),Ro(),Ro(),Co(12,F0,2,1,"div",9),Ro(),Ao(13,"div",3),Ao(14,"label"),ms(15,"Facility Name"),Ro(),Ao(16,"mat-form-field",4),Ao(17,"mat-select",10,11),Fo("selectionChange",(function(){en(n);var e=So(18);return t.selectedFacility(e.value)}))("ngModelChange",(function(e){return t.form.facilityId=e})),Ao(19,"mat-option",12),ms(20,"Select Facility"),Ro(),Co(21,j0,2,2,"mat-option",8),Ro(),Ro(),Co(22,V0,2,1,"div",9),Ro(),Ao(23,"div",3),Ao(24,"label"),ms(25,"Level Name"),Ro(),Ao(26,"mat-form-field",4),Ao(27,"input",13,14),Fo("ngModelChange",(function(e){return t.form.levelName=e})),Ro(),Ro(),Co(29,q0,2,1,"div",9),Ro(),Ao(30,"div",3),Ao(31,"div",15),Ao(32,"div",16),Ao(33,"label"),ms(34,"Capacity "),Ro(),Ao(35,"mat-form-field",4),Ao(36,"input",17,18),Fo("ngModelChange",(function(e){return t.form.capacity=e})),Ro(),Ro(),Ro(),Ao(38,"div",16),Ao(39,"label"),ms(40,"Max Capacity "),Ro(),Ao(41,"mat-form-field",4),Ao(42,"input",19,20),Fo("ngModelChange",(function(e){return t.form.Max_capacity=e})),Ro(),Ro(),Ro(),Ro(),Co(44,W0,2,1,"div",9),Ro(),Ao(45,"div",15),Ao(46,"div",21),Ao(47,"label",22),Ao(48,"mat-icon"),ms(49,"cloud_upload"),Ro(),Ro(),Ao(50,"span",23),ms(51,"(Supported File Formats:*/geojson,.png,.jpg,JPEG)"),Ro(),Ao(52,"input",24),Fo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ro(),Ro(),Ao(53,"button",25),Fo("click",(function(){return t.onSubmit()})),ms(54,"Submit"),Ro(),Ao(55,"button",26),Fo("click",(function(){en(n);var e=So(2);return t.onReset(e)})),ms(56," Reset "),Ro(),Ro(),Ro(),Ro()}if(2&e){var i=So(2),r=So(8),a=So(18),o=So(28),s=So(37),l=So(43);yr(7),Mo("ngModel",t.form.siteId)("ngClass",Al(22,X0,i.submitted&&r.errors)),yr(4),Mo("ngForOf",t.sitesData),yr(1),Mo("ngIf",i.submitted&&r.errors),yr(5),Mo("disabled",!t.form.siteId)("ngModel",t.form.facilityId)("ngClass",Al(24,X0,i.submitted&&a.errors)),yr(4),Mo("ngForOf",t.facilityData),yr(1),Mo("ngIf",i.submitted&&a.errors),yr(5),Mo("disabled",!t.form.facilityId)("ngModel",t.form.levelName)("ngClass",Al(26,X0,i.submitted&&o.errors)),yr(2),Mo("ngIf",i.submitted&&o.errors),yr(7),Mo("disabled",!t.form.levelName)("ngModel",t.form.capacity)("ngClass",Al(28,X0,i.submitted&&s.errors)),yr(6),Mo("disabled",!t.form.levelName)("ngModel",t.form.Max_capacity)("ngClass",Al(30,X0,i.submitted&&l.errors)),yr(2),Mo("ngIf",i.submitted&&s.errors&&l),yr(8),Mo("disabled",!t.form.levelName),yr(1),Mo("disabled",!t.form.fileUrl)}},directives:[HC,_k,RC,LP,fM,GC,yk,jC,Dc,fb,Lc,Fc,UP,uk,Lk,nk,FT],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),Z0);function Y0(e,t){if(1&e&&(Ao(0,"mat-option",15),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.siteId),yr(1),vs(n.siteName)}}function J0(e,t){1&e&&(Ao(0,"div"),ms(1,"Site name is required"),Ro())}function Q0(e,t){if(1&e&&(Ao(0,"div",16),Co(1,J0,2,0,"div",17),Ro()),2&e){qo();var n=So(8);yr(1),Mo("ngIf",n.errors.required)}}function $0(e,t){if(1&e&&(Ao(0,"mat-option",15),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.facilityId),yr(1),vs(n.facilityName)}}function e1(e,t){1&e&&(Ao(0,"div"),ms(1,"facility name is required"),Ro())}function t1(e,t){if(1&e&&(Ao(0,"div",16),Co(1,e1,2,0,"div",17),Ro()),2&e){qo();var n=So(16);yr(1),Mo("ngIf",n.errors.required)}}function n1(e,t){if(1&e&&(Ao(0,"mat-option",15),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n.levelId),yr(1),vs(n.levelName)}}function i1(e,t){1&e&&(Ao(0,"div"),ms(1,"Level name is required"),Ro())}function r1(e,t){if(1&e&&(Ao(0,"div",16),Co(1,i1,2,0,"div",17),Ro()),2&e){qo();var n=So(24);yr(1),Mo("ngIf",n.errors.required)}}function a1(e,t){if(1&e){var n=zo();Ao(0,"a",18),Fo("click",(function(){return en(n),qo().redirect()})),ms(1,"click here to locate from map "),Ao(2,"mat-icon",19),ms(3,"location_on"),Ro(),Ro()}}var o1,s1,l1=function(e){return{"is-invalid":e}},u1=((s1=function(){function e(t,n,i,r,a,o){_classCallCheck(this,e),this.http=t,this.router=n,this.blobService=i,this.siteonboarding=r,this.maplocationservice=a,this.dialog=o,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteId:"",facilityId:"",levelId:"",fileUrl:"",spaceDetails:[]},this.allFacilities=[],this.sitesData=[],this.facilityData=[],this.getLevels()}return _createClass(e,[{key:"ngOnInit",value:function(){this.getSites(),this.getFacilities()}},{key:"fileUpload",value:function(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.picturesList=[]}},{key:"reloadImages",value:function(){var e=this;this.blobService.listImages(this.sas).then((function(t){t&&e.maplocationservice.addLevelValues(e.form)}))}},{key:"containerClient",value:function(e){return new s0("https://".concat(this.blobService.picturesAccount,".blob.core.windows.net?").concat(e)).getContainerClient(this.blobService.picturesContainer)}},{key:"downloadThisBlob",value:function(e,t){var n=t.getBlobClient(e);return e.indexOf("geojson")>=0?n.setHTTPHeaders({blobContentType:"geojson"}):n.setHTTPHeaders({blobContentType:"application/octet-stream"}),n.url}},{key:"redirect",value:function(){this.router.navigate(["createspaces/4"])}},{key:"getSites",value:function(){var e=this;this.siteonboarding.obtainedSiteDetails.subscribe((function(t){e.sitesData=t}))}},{key:"getFacilities",value:function(){var e=this;this.allFacilities=[],this.siteonboarding.obtainedFacilityDetails.subscribe((function(t){e.allFacilities=t}))}},{key:"getLevels",value:function(){var e=this;this.siteonboarding.obtainedLevelDetails.subscribe((function(t){console.log(t,"in add space"),e.allLevels=t}))}},{key:"selectedSite",value:function(e){this.facilityData=[],this.facilityName=null,console.log(e,this.allFacilities),this.facilityData=this.allFacilities.filter((function(t,n){return t.Site_Id==e})),console.log(this.facilityData,"faciltity data"),this.facilityName=this.facilityData[0].facilityName}},{key:"selectedFacility",value:function(e){console.log(this.allLevels,"all levels"),this.levelsData=[],this.levelsData=this.allLevels.filter((function(t,n){return t.Facility_Id==e})),console.log(this.levelsData);var t=this.facilityData.filter((function(t){return t.facilityId==e}));this.maplocationservice.setFacilitylocation(t[0].facilitylocation.coordinates)}},{key:"selectLevel",value:function(e){var t=this.levelsData.filter((function(t){return t.levelId==e}));console.log(t,"selectedlevelObj"),this.maplocationservice.addLevelValues(t)}},{key:"onSubmit",value:function(){var e=this;this.siteonboarding.addLevel(this.form).subscribe((function(t){if(t){console.log(t,"add level responce");var n=t.fileUrl.toString();e.reloadImages(),e.redirect(),e.dialog.closeAll(),e.http.get(n).subscribe((function(e){console.log("trying to get uploaded image "),console.log(e)}))}}))}},{key:"onReset",value:function(e){e.reset()}}]),e}()).\u0275fac=function(e){return new(e||s1)(To(xw),To(zg),To(l0),To(LH),To(u0),To(zM))},s1.\u0275cmp=yt({type:s1,selectors:[["app-add-space"]],decls:29,vars:21,consts:[[1,"register-form"],["name","form"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","selectionChange","ngModelChange"],["sitename","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["facilityname","ngModel"],["name","levelname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["levelname","ngModel"],[1,"buttongroup"],[3,"click",4,"ngIf"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"],["matSuffix",""]],template:function(e,t){if(1&e){var n=zo();Ao(0,"div",0),Ao(1,"form",1,2),Ao(3,"div",3),Ao(4,"label"),ms(5,"Site Name"),Ro(),Ao(6,"mat-form-field",4),Ao(7,"mat-select",5,6),Fo("selectionChange",(function(){en(n);var e=So(8);return t.selectedSite(e.value)}))("ngModelChange",(function(e){return t.form.siteId=e})),Co(9,Y0,2,2,"mat-option",7),Ro(),Ro(),Co(10,Q0,2,1,"div",8),Ro(),Ao(11,"div",3),Ao(12,"label"),ms(13,"Facility Name"),Ro(),Ao(14,"mat-form-field",4),Ao(15,"mat-select",9,10),Fo("selectionChange",(function(){en(n);var e=So(16);return t.selectedFacility(e.value)}))("ngModelChange",(function(e){return t.form.facilityId=e})),Co(17,$0,2,2,"mat-option",7),Ro(),Ro(),Co(18,t1,2,1,"div",8),Ro(),Ao(19,"div",3),Ao(20,"label"),ms(21,"Level Name"),Ro(),Ao(22,"mat-form-field",4),Ao(23,"mat-select",11,12),Fo("selectionChange",(function(){en(n);var e=So(24);return t.selectLevel(e.value)}))("ngModelChange",(function(e){return t.form.levelId=e})),Co(25,n1,2,2,"mat-option",7),Ro(),Ro(),Co(26,r1,2,1,"div",8),Ro(),Ao(27,"div",13),Co(28,a1,4,0,"a",14),Ro(),Ro(),Ro()}if(2&e){var i=So(2),r=So(8),a=So(16),o=So(24);yr(7),Mo("ngModel",t.form.siteId)("ngClass",Al(15,l1,i.submitted&&r.errors)),yr(2),Mo("ngForOf",t.sitesData),yr(1),Mo("ngIf",i.submitted&&r.errors),yr(5),Mo("disabled",!t.form.siteId)("ngModel",t.form.facilityId)("ngClass",Al(17,l1,i.submitted&&a.errors)),yr(2),Mo("ngForOf",t.facilityData),yr(1),Mo("ngIf",i.submitted&&a.errors),yr(5),Mo("disabled",!t.form.facilityId)("ngModel",t.form.levelId)("ngClass",Al(19,l1,i.submitted&&o.errors)),yr(2),Mo("ngForOf",t.levelsData),yr(1),Mo("ngIf",i.submitted&&o.errors),yr(2),Mo("ngIf",t.form.levelId)}},directives:[HC,_k,RC,LP,fM,GC,yk,jC,Dc,Lc,Fc,fb,nk,RP],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),s1),c1=((o1=function(){function e(t){_classCallCheck(this,e),this.siteonboardingservice=t}return _createClass(e,[{key:"ngOnInit",value:function(){this.demo1TabIndex=this.siteonboardingservice.selectedtab}}]),e}()).\u0275fac=function(e){return new(e||o1)(To(LH))},o1.\u0275cmp=yt({type:o1,selectors:[["app-addbuildingpopup"]],decls:9,vars:1,consts:[[3,"selectedIndex","selectedIndexChange"],["label","Add Site "],["label","Add Facility"],["label","Add Level"],["label","Add Space"]],template:function(e,t){1&e&&(Ao(0,"mat-tab-group",0),Fo("selectedIndexChange",(function(e){return t.siteonboardingservice.selectedtab=e})),Ao(1,"mat-tab",1),Oo(2,"app-addsite"),Ro(),Ao(3,"mat-tab",2),Oo(4,"app-add-facility"),Ro(),Ao(5,"mat-tab",3),Oo(6,"app-add-floor"),Ro(),Ao(7,"mat-tab",4),Oo(8,"app-add-space"),Ro(),Ro()),2&e&&Mo("selectedIndex",t.siteonboardingservice.selectedtab)},directives:[zE,TE,g0,z0,K0,u1],styles:[".user[_ngcontent-%COMP%]{color:#00f}"]}),o1),h1=["map"];function d1(e,t){if(1&e){var n=zo();Ao(0,"div",10),Ao(1,"div"),Ao(2,"button",11),Fo("click",(function(){return en(n),qo().showOccupency()})),Oo(3,"img",12),Ro(),Ro(),Ao(4,"div"),Ao(5,"button",13),Fo("click",(function(){return en(n),qo().showIAQ()})),Oo(6,"img",14),Ro(),Ro(),Ao(7,"div"),Ao(8,"button",15),Fo("click",(function(){return en(n),qo().showCameras()})),Oo(9,"img",16),Ro(),Ro(),Ao(10,"div"),Ao(11,"button",17),Fo("click",(function(){return en(n),qo().showRouters()})),Oo(12,"img",18),Ro(),Ro(),Ro()}}function f1(e,t){if(1&e){var n=zo();Ao(0,"button",6),Fo("click",(function(e){return en(n),qo().refreshpage(e)})),Ao(1,"mat-icon",19),ms(2," refresh "),Ro(),Ro()}}var p1,m1,v1,g1,y1=((v1=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this.dialog=t,this.http=n,this.snackBar=i,this.router=r,this.siteonboarding=a,this.selectedsiteFacilities=[],this.selectedLevels=[],this.sitemarker=null,this.facilitymarker=null,this.showRefresh=!1,this.showicons=!1,this.markerLocations=[{lat:38.914764662971436,lng:-97.01461108304595},{lat:2,lng:2}],this.polygons=[],this.centeroid={type:"FeatureCollection",features:[]},this.Devicescentroid=[],this.Devicegeojson={type:"FeatureCollection",features:[]},this.sitesdata=[],this.router.events.pipe(Rp((function(e){return e instanceof bm}))).subscribe((function(e){"/map"!=e.url&&o.dialog.closeAll()}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.getAllSites(),this.getAllFacilities(),this.getAllLevels()}},{key:"loadMap",value:function(e){document.getElementById("map").innerHTML="",this.map=null,this.showRefresh=!1,this.showicons=!1,this.map=new gL("map",{center:[-1.85306,52.63249],zoom:2.5,minZoom:2,pitch:6,baseLayer:new hj("base",{urlTemplate:"http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})}),this.layer=new _B("vector").setOptions({enableAltitude:!0}).addTo(this.map),document.querySelector(".maptalks-attribution").innerHTML="",console.log(this.sitesdata),this.sitesdata&&this.plotingsitemarkers(this.sitesdata)}},{key:"getAllSites",value:function(){var e=this;this.siteonboarding.getAllSites().subscribe((function(t){t&&(e.sitesdata=t,e.siteonboarding.saveAllsiteDetails(t),e.loadMap(e.sitesdata))}))}},{key:"plotingsitemarkers",value:function(e){var t=this;this.selectedsiteFacilities=[],this.facilityName=null,this.sitename=null,console.log(e,":::sites:::"),e.forEach((function(e){t.sitemarker=new NF.UIMarker(e.location.coordinates,{draggable:!1,single:!1,id:e.siteId,name:e.siteName,type:"sitemarker",content:'\n        <style>   \n        .main {\n          min-height: 50px;\n          min-width: 200px;\n          background-color: #673ab7;\n          border-radius: 8px;\n          display: flex;\n          padding: 5px;\n          box-sizing: border-box;\n          position: relative;\n      }\n      .main::after{\n          content: "";\n        position: absolute;\n        top: 100%;\n        left: 50%;\n        margin-left: -5px;\n        border-width: 5px;\n        border-width: 10px;\n        border-style: solid;\n        border-color: #673ab7 transparent transparent transparent;\n      }\n      .marker{\n          max-width: 100%; \n          display: flex;\n      }\n      \n      .image{\n          background-color: none;\n          border-radius: 5px;\n          width: 40px;\n          height: 100%;\n          margin-right: 5px;\n          flex: 1;\n      }\n      \n      .image img{\n          width: 100%;\n          height: 100%;\n          object-fit: fill;\n          border-radius: 5px;\n      }\n      \n      .info{\n          /* background-color: aquamarine; */\n          height: 100%;\n          width: 100%;\n          display: flex;\n          flex: 2;\n          flex-grow: 5;\n          flex-direction: column;\n          padding-left: 10px;\n          color:#ffff;\n\n      }\n      .title{\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        max-width: 200px;\n      }\n\n        </style>\n        <div class="marker" id=\'sitemarker\'>\n        <div class="main">\n          <div class="image">\n          <img src=\''.concat(e.fileUrl,'\' alt="Profile Image">\n          </div>\n          <div class="info">\n            <div class="title">').concat(e.siteName,'</div>\n            <div class="contant">&#127970;No.of Facilities: ').concat(e.total_Facilities,"</div>\n          </div>\n        </div>\n      </div>\n       \n        ")}).addTo(t.map).on("click",(function(e){t.siteonboarding.obtainedFacilityDetails.subscribe((function(n){console.log(e.target.options.id),n.forEach((function(i,r){i.Site_Id==e.target.options.id&&t.selectedsiteFacilities.push(n[r])})),console.log(t.selectedsiteFacilities,"matched facilities"),t.sitename=e.target.options.name,t.gotofacilities(t.selectedsiteFacilities),e.target.remove()}))}))}))}},{key:"gotofacilities",value:function(e){var t=this;this.facilitymarker=null,this.levelName=null,this.selectedLevels=[],e.forEach((function(e,n){console.log(e.fileUrl);var i={draggable:!1,single:!1,id:e.facilityId,name:e.facilityName,type:"facilitymarker",content:'\n        <style>   \n        .main {\n          min-height: 50px;\n          min-width: 200px;\n          background-color: #673ab7;\n          border-radius: 8px;\n          display: flex;\n          padding: 5px;\n          box-sizing: border-box;\n          position: relative;\n      }\n      .main::after{\n          content: "";\n        position: absolute;\n        top: 100%;\n        left: 50%;\n        margin-left: -5px;\n        border-width: 5px;\n        border-width: 10px;\n        border-style: solid;\n        border-color: #673ab7 transparent transparent transparent;\n      }\n      .marker{\n          max-width: 100%; \n          display: flex;\n      }\n      \n      .image{\n          background-color: none;\n          border-radius: 5px;\n          width: 40px;\n          height: 100%;\n          margin-right: 5px;\n          flex: 1;\n      }\n      \n      .image img{\n          width: 100%;\n          height: 100%;\n          object-fit: fill;\n          border-radius: 5px;\n      }\n      \n      .info{\n          /* background-color: aquamarine; */\n          height: 100%;\n          width: 100%;\n          display: flex;\n          flex: 2;\n          flex-grow: 5;\n          flex-direction: column;\n          padding-left: 10px;\n          color:#ffff;\n\n      }\n      .title{\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        max-width: 200px;\n      }\n        </style>\n        <div class="marker" id=\'facilityMarker\'>\n        <div class="main">\n          <div class="image">\n          <img src='.concat(e.fileUrl.toString(),' alt="Profile Image">\n          </div>\n          <div class="info">\n            <div class="title">').concat(e.facilityName,'</div>\n            <div class="contant">&#127970;No.Of Levels:').concat(e.total_Levels,"</div>\n          </div>\n        </div>\n      </div>      \n        ")};t.facilitymarker=new NF.UIMarker(e.facilitylocation.coordinates,i),t.facilitymarker.addTo(t.map).show(),t.facilitymarker.on("click",(function(e){t.facilityName=e.target.options.name,t.sitemarker.setContent(""),t.siteonboarding.obtainedLevelDetails.subscribe((function(n){n&&(n.forEach((function(i,r){i.Facility_Id==e.target.options.id&&t.selectedLevels.push(n[r])})),console.log(t.selectedLevels),t.getpolygonsdata(e.target._coordinate))})),t.levelName=t.selectedLevels[0].levelName,document.getElementById("facilityMarker").style.display="none",t.facilitymarker.remove()}))})),this.map.animateTo({center:e[0].facilitylocation.coordinates,zoom:18,pitch:35,bearing:0},{duration:3e3})}},{key:"opentoster",value:function(e,t){this.snackBar.open(e,"close",{duration:t,verticalPosition:"top"})}},{key:"getspaceIdsbyId",value:function(e,t){var n=this;this.Devicescentroid=[],this.showicons=!0,this.centeroid.features=[],console.log(e),this.siteonboarding.getSpacesbyId(e).subscribe((function(i){i&&(i.forEach((function(e){var i={type:"Feature"};i.properties={Altitude:t,spaceName:e.spaceName,spaceId:e.spaceId,levelId:e.Level_Id},i.geometry=e.spacelocation,n.centeroid.features.push(i),0!=e.Devices.lenght&&e.Devices.forEach((function(e){n.Devicescentroid.push(e)}))})),n.addSpacenamestomap(t,e))})),this.layer.getGeometries().forEach((function(t,i){"Polygon"!=t.type&&"Point"!=t.type||t.properties.levelId===e||n.layer.getGeometries()[i].setOptions({visible:!1})}))}},{key:"addSpacenamestomap",value:function(e,t){var n=this;this.centeroid.features.forEach((function(e,t){n.layer.setOptions({enableAltitude:!0}).addGeometry(new LL(e.geometry.coordinates,{symbol:[{markerWidth:18,markerHeight:20},{textFaceName:"sans-serif",textName:"{name}",textSize:9,textFill:"black",markerFillOpacity:1,textDy:5}],properties:{id:e.properties.spaceId,levelId:e.properties.levelId,name:e.properties.spaceName,altitude:e.properties.Altitude,visible:!0}}))})),this.Devicescentroid.forEach((function(i){var r={type:"Feature"};r.properties={Altitude:e,spaceId:i.Space_Id,levelId:t,deviceType:i.deviceType},r.geometry=i.devicelocation,n.Devicegeojson.features.push(r)})),console.log(this.Devicegeojson),this.plottingdeviceMarkers()}},{key:"plottingdeviceMarkers",value:function(){var e=this;console.log(this.Devicegeojson),this.Devicegeojson.features.forEach((function(t){console.log(t,"device objects");var n="";"Occupency"==t.properties.deviceType?n="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-user-groups-80.png":"IAQ"==t.properties.deviceType?n="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/IAQ.png":"IoT Cam"==t.properties.deviceType?n="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/camera marker.png":"Router"==t.properties.deviceType&&(n="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-router-50.png"),e.layer.setOptions({enableAltitude:!0}).addGeometry(new LL(t.geometry.coordinates,{symbol:[{markerFile:n,markerWidth:40,markerHeight:30,markerDx:0,markerDy:0,markerOpacity:1,markerRotation:0},{textFaceName:"sans-serif",textName:"{deviceType}",textSize:10,textDy:14}],properties:{id:t.properties.spaceId,levelId:t.properties.levelId,deviceType:t.properties.deviceType,altitude:t.properties.Altitude}}).setOptions({visible:!1}))}))}},{key:"getpolygonsdata",value:function(e){var t=this,n="";this.selectedLevels.sort((function(e,t){return new Date(e.createdAt).getTime()>new Date(t.createdAt).getTime()?1:-1})),console.log(this.selectedLevels,"this.selectedLevels"),this.selectedLevels.forEach((function(i,r){n=i.fileUrl.includes(".geojson")?t.selectedLevels[r].fileUrl:"https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(t.sitename,"/").concat(t.facilityName.replace(/\s+/g,""),"/").concat(i.levelName.replace(/\s+/g,""),"/geojson/").concat(i.levelName.replace(/\s+/g,"")+".geojson"),t.createpolygons(n,r),t.map.animateTo({center:e,zoom:20.5,pitch:55,bearing:0},{duration:1e3}),t.facilitymarker.remove()}))}},{key:"createpolygons",value:function(e,t){var n=this;console.log(e),this.http.get(String(e)).subscribe((function(e){var i;n.showRefresh=!0,console.log(e,"geojson data"),e.features.forEach((function(e){"Polygon"==e.geometry.type?i=e.geometry.coordinates:"MultiPolygon"==e.geometry.type&&(i=e.geometry.coordinates[0][0]),n.layer.setOptions({enableAltitude:!0}).addGeometry(new NL(i,{visible:!0,editable:!0,cursor:"pointer",draggable:!1,dragShadow:!1,drawOnAxis:null,symbol:{lineColor:"#34495e",lineWidth:.5,polygonFill:"rgb(135,196,240)",polygonOpacity:.6},properties:{id:e.properties.levelId,levelId:e.properties.levelId,name:e.properties.levelId,altitude:4*t,visible:!0}}).on("click",(function(e){console.log(e),n.focuspoint=e.coordinate,n.getspaceIdsbyId(e.target.properties.id,e.target.properties.altitude),n.map.animateTo({center:e.coordinate,zoom:23,pitch:0,bearing:0},{duration:1e3}),n.map.removeBaseLayer()})).on("contextmenu",(function(e){console.log(e),n.layer.getGeometries().forEach((function(e,t){"Point"==e.type&&e.properties.deviceType?n.layer.getGeometries()[t].setOptions({visible:!1}):"Polygon"==e.type&&e.setOptions({visible:!0})})),n.map.animateTo({center:e.coordinate,zoom:21,pitch:55,bearing:0},{duration:1e3})})))}))}))}},{key:"getAllLevels",value:function(){var e=this;this.siteonboarding.getAllLevels().subscribe((function(t){t&&e.siteonboarding.saveAllLevelDetails(t)}))}},{key:"getAllFacilities",value:function(){var e=this;this.siteonboarding.getAllFacilities().subscribe((function(t){t&&e.siteonboarding.saveAllFacilityDetails(t)}))}},{key:"refreshpage",value:function(e){this.map.removeLayer("vector"),this.ngOnInit()}},{key:"openDailog",value:function(e){this.dialog.open(c1,{closeOnNavigation:!0,autoFocus:!0,data:e})}},{key:"showOccupency",value:function(){var e=this;this.layer.getGeometries().forEach((function(t,n){"Point"==t.type&&t.properties.deviceType&&"Occupency"==t.properties.deviceType?e.layer.getGeometries()[n].setOptions({visible:!0}):"Point"==t.type&&t.properties.deviceType&&"Occupency"!==t.properties.deviceType&&e.layer.getGeometries()[n].setOptions({visible:!1})})),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()-1,pitch:0,bearing:0},{duration:1e3})}},{key:"showIAQ",value:function(){var e=this;this.layer.getGeometries().forEach((function(t,n){"Point"==t.type&&t.properties.deviceType&&"IAQ"==t.properties.deviceType?e.layer.getGeometries()[n].setOptions({visible:!0}):"Point"==t.type&&t.properties.deviceType&&"IAQ"!==t.properties.deviceType&&e.layer.getGeometries()[n].setOptions({visible:!1})})),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()+1,pitch:0,bearing:0},{duration:1e3})}},{key:"showCameras",value:function(){var e=this;this.layer.getGeometries().forEach((function(t,n){"Point"==t.type&&t.properties.deviceType&&"IoT Cam"==t.properties.deviceType?e.layer.getGeometries()[n].setOptions({visible:!0}):"Point"==t.type&&t.properties.deviceType&&"IoT Cam"!==t.properties.deviceType&&e.layer.getGeometries()[n].setOptions({visible:!1})})),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()-1,pitch:0,bearing:0},{duration:1e3})}},{key:"showRouters",value:function(){var e=this;this.layer.getGeometries().forEach((function(t,n){"Point"==t.type&&t.properties.deviceType&&"Router"==t.properties.deviceType?e.layer.getGeometries()[n].setOptions({visible:!0}):"Point"==t.type&&t.properties.deviceType&&"Router"!==t.properties.deviceType&&e.layer.getGeometries()[n].setOptions({visible:!1})})),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()+1,pitch:0,bearing:0},{duration:1e3})}}]),e}()).\u0275fac=function(e){return new(e||v1)(To(zM),To(xw),To(nV),To(zg),To(LH))},v1.\u0275cmp=yt({type:v1,selectors:[["app-map"]],viewQuery:function(e,t){var n;1&e&&Xl(h1,!0),2&e&&Wl(n=$l())&&(t.mapContainer=n.first)},decls:11,vars:2,consts:[[1,"row"],[1,"col-lg-12"],["id","map"],["id","state-legend","class","legend",4,"ngIf"],["id","buttongrouping",1,"buttongrouping"],[1,"example-button-container"],["mat-fab","","color","primary",3,"click"],["matTooltip","Add building","matTooltipPosition","right"],["mat-fab","","color","primary",3,"click",4,"ngIf"],[1,"name"],["id","state-legend",1,"legend"],["matTooltip","Occupancy","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/icons8-user-groups-80.png","alt","",1,"icon"],["matTooltip","IAQ","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/IAQ.png","alt","",1,"icon"],["matTooltip","IOT Camera","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/camera marker.png","alt","",1,"icon"],["matTooltip","Routers","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-router-50.png","alt","",1,"icon"],["matTooltip","Refresh","matTooltipPosition","right"]],template:function(e,t){1&e&&(Ao(0,"div",0),Ao(1,"div",1),Oo(2,"div",2),Co(3,d1,13,0,"div",3),Ao(4,"div",4),Ao(5,"div",5),Ao(6,"button",6),Fo("click",(function(e){return t.openDailog(e)})),Ao(7,"mat-icon",7),ms(8," domain "),Ro(),Ro(),Co(9,f1,3,0,"button",8),Ro(),Oo(10,"div",9),Ro(),Ro(),Ro()),2&e&&(yr(3),Mo("ngIf",t.showicons),yr(6),Mo("ngIf",t.showRefresh))},directives:[Fc,FT,nk,RT],styles:['@import url("https://unpkg.com/maptalks/dist/maptalks.css");#map[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}.maptalks-attribution[_ngcontent-%COMP%]{display:none}.buttongrouping[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:100}.text_marker[_ngcontent-%COMP%]{font:30px bold sans-serif;color:#34495e;text-shadow:2px 0 #fff;width:160px}.legend[_ngcontent-%COMP%]{background-color:rgba(131,104,178,.7333333333333333);border-radius:50px;width:auto;bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.1);justify-items:center;font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;padding:10px;position:absolute;right:10px;z-index:1;display:grid}.legend[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:40px;height:40px}.legend[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-radius:50%;display:inline-block;padding:10px;height:30px;margin:5px;width:30px}.example-button-container[_ngcontent-%COMP%]{display:grid;justify-content:space-around;width:120px;padding:auto}']}),v1),_1=((m1=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||m1)},m1.\u0275cmp=yt({type:m1,selectors:[["app-occupency"]],decls:2,vars:0,template:function(e,t){1&e&&(Ao(0,"p"),ms(1," occupency works! "),Ro())},encapsulation:2}),m1),x1=((p1=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||p1)},p1.\u0275cmp=yt({type:p1,selectors:[["app-maintenance"]],decls:2,vars:0,template:function(e,t){1&e&&(Ao(0,"p"),ms(1," maintenance works! "),Ro())},encapsulation:2}),p1),b1=n("4ZJM"),w1=n("iFvi"),k1=((g1=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.route=t,this.dialog=n,this.maplocationservice=i,this.facilityLocation=[],this.routeparams=this.route.snapshot.paramMap.get("id"),1==this.routeparams?(this.formelement=g0,this.maplocationservice.addSiteData.subscribe((function(e){r.formdata=e}))):2==this.routeparams?(this.formelement=z0,this.maplocationservice.locateFacility.subscribe((function(e){r.facilityLocation=e})),this.maplocationservice.addFacilityData.subscribe((function(e){console.log(e,"::facility params"),r.formdata=e}))):3==this.routeparams&&(this.formelement=K0)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=0==this.facilityLocation.length?0:19,t=0==this.facilityLocation.length?[-24,42]:this.facilityLocation;b1.accessToken="pk.eyJ1IjoidmlrYXMtc3dhbXkiLCJhIjoiY2t3eWticmc1MG5yZjM0cXR3czBheDMyeCJ9.ROb_2S1Qd_47JhnT_x6xMQ";var n=new b1.Map({container:"mapa-mapbox",style:"mapbox://styles/mapbox/streets-v12",center:t,zoom:e}),i=this,r=new b1.Marker({draggable:!0,color:"red",scale:.8,pitchAlignment:"auto",rotationAlignment:"auto"});1!=this.routeparams&&2!=this.routeparams||(n.once("dblclick",(function(e){var t=e.lngLat;i.formdata.lan=t.lng,i.formdata.lat=t.lat,console.log("Lng:",t.lng,"Lat:",t.lat),r.setLngLat(t).addTo(n),i.opendialog()})),r.on("dragend",(function(){var e=r.getLngLat();console.log(e,"lngLat"),i.formdata.lan=e.lng,i.formdata.lat=e.lat,i.opendialog()}))),1==this.routeparams&&n.addControl(new w1({accessToken:b1.accessToken,mapboxgl:b1}))}},{key:"opendialog",value:function(){console.log(this.formdata,"openDialog"),this.maplocationservice.addsitevalues(this.formdata),this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{left:"100px",top:"0px"}})}}]),e}()).\u0275fac=function(e){return new(e||g1)(To(Tv),To(zM),To(u0))},g1.\u0275cmp=yt({type:g1,selectors:[["app-airquaility"]],decls:3,vars:0,consts:[[1,"row"],[1,"col-md-12"],["id","mapa-mapbox"]],template:function(e,t){1&e&&(Ao(0,"div",0),Ao(1,"div",1),Oo(2,"div",2),Ro(),Ro())},styles:["#mapa-mapbox[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}"]}),g1),C1=["search"];function S1(e,t){1&e&&(Ao(0,"div",4),Oo(1,"input",5,6),Ro())}var T1,E1=((T1=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.route=t,this.dialog=n,this.maplocationservice=i,this.ngZone=r,this.entries=[],this.facilityLocation=[],this.routeparams=this.route.snapshot.paramMap.get("id"),1==this.routeparams?(this.formelement=g0,this.maplocationservice.addSiteData.subscribe((function(e){console.log(e,"::::addsite formdata::::"),a.formdata=e}))):2==this.routeparams&&(this.formelement=z0,this.maplocationservice.locateFacility.subscribe((function(e){a.facilityLocation=e})),this.maplocationservice.addFacilityData.subscribe((function(e){a.formdata=e})))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.maplocationservice.api.then((function(t){e.initAutocomplete(t)})),this.initmap()}},{key:"initmap",value:function(){var e=this,t=0==this.facilityLocation.length?3:19,n=0==this.facilityLocation.length?[-1.85306,52.63249]:this.facilityLocation;document.getElementById("mapa-mapbox").innerHTML="",this.map=null,this.map=new gL("mapa-mapbox",{center:n,zoom:t,minZoom:2,pitch:6,baseLayer:new hj("base",{urlTemplate:"http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})}),document.querySelector(".maptalks-attribution").innerHTML="",new _B("vector").setOptions({editable:!0}).addTo(this.map),2==this.routeparams&&this.map.once("click",(function(t){new LL(t.coordinate,{draggable:!0}).addTo(e.map.getLayer("vector")).on("dragend",(function(t){var n=t.coordinate;e.formdata[0].lan=n.x,e.formdata[0].lat=n.y,console.log(e.formdata[0]),e.opendialog()}));var n=t.coordinate;e.formdata[0].lan=n.x,e.formdata[0].lat=n.y,console.log(e.formdata[0]),e.opendialog()}))}},{key:"initAutocomplete",value:function(e){var t=this,n=new e.places.Autocomplete(this.searchElementRef.nativeElement);n.addListener("place_changed",(function(){t.ngZone.run((function(){t.onPlaceChange(n.getPlace())}))}))}},{key:"onPlaceChange",value:function(e){var t=this,n=this.locationFromPlace(e);this.entries.unshift({place:e,location:n}),console.log([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],"lnglat"),this.map.setCenterAndZoom([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],21),new LL([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],{draggable:!0}).addTo(this.map.getLayer("vector")).addEventListener("dragend",(function(e){console.log(e,"afterdraging");var n=e.coordinate;t.formdata[0].lan=n.x,t.formdata[0].lat=n.y,console.log(t.formdata[0]),t.opendialog()}))}},{key:"locationFromPlace",value:function(e){var t=e.address_components;if(void 0===t)return null;var n=I1(t,"administrative_area_level_3"),i=M1(t,"locality")||n,r=M1(t,"country"),a=I1(t,"country"),o=I1(t,"administrative_area_level_1"),s=e.name!==i?e.name:null,l={latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()};return{name:s,cityName:i,countryName:r,countryCode:a,stateCode:o,bounds:e.geometry.viewport.toJSON(),coordinates:l}}},{key:"opendialog",value:function(){1==this.routeparams?this.maplocationservice.addsitevalues(this.formdata):2==this.routeparams&&this.maplocationservice.addFacilityvalues(this.formdata),this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{left:"100px",top:"0px"}})}}]),e}()).\u0275fac=function(e){return new(e||T1)(To(Tv),To(zM),To(u0),To(Su))},T1.\u0275cmp=yt({type:T1,selectors:[["app-geo-referencing-map"]],viewQuery:function(e,t){var n;1&e&&Xl(C1,!0),2&e&&Wl(n=$l())&&(t.searchElementRef=n.first)},decls:4,vars:1,consts:[[1,"row"],[1,"col-md-12"],["id","search",4,"ngIf"],["id","mapa-mapbox"],["id","search"],["placeholder","search for location","autocorrect","off","autocapitalize","off","spellcheck","off","type","text",1,"form-control"],["search",""]],template:function(e,t){1&e&&(Ao(0,"div",0),Ao(1,"div",1),Co(2,S1,3,0,"div",2),Oo(3,"div",3),Ro(),Ro()),2&e&&(yr(2),Mo("ngIf",1==t.routeparams))},directives:[Fc],styles:["#mapa-mapbox[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{font-family:Lato}dl[_ngcontent-%COMP%]{font-size:13px}dl[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{padding:0 3px;border:1px solid #ccc;white-space:nowrap}input[type=text][_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;width:300px;padding:5px;height:20px;border-radius:5px 0 0 5px;outline:none;color:#9dbfaf}table[_ngcontent-%COMP%]{margin:10px 0;border:1px solid red}code[_ngcontent-%COMP%], dt[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-family:Source Code Pro;font-size:12px}"]}),T1);function P1(e,t){return e.filter((function(e){return e.types[0]===t}))[0]}function M1(e,t){var n=P1(e,t);return n&&n.long_name}function I1(e,t){var n=P1(e,t);return n&&n.short_name}function A1(e){var t=e.subscriber,n=e.counter,i=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:i},i)}function R1(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function O1(e,t){var n=t?"":"none";R1(e.style,{touchAction:t?"":"none",webkitUserDrag:t?"":"none",webkitTapHighlightColor:t?"":"transparent",userSelect:n,msUserSelect:n,webkitUserSelect:n,MozUserSelect:n})}function N1(e){var t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function D1(e,t){return e.getPropertyValue(t).split(",").map((function(e){return e.trim()}))}function z1(e){var t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}}function L1(e,t,n){var i=e.top,r=e.bottom,a=e.left,o=e.right;return n>=i&&n<=r&&t>=a&&t<=o}function B1(e,t,n){e.top+=t,e.bottom=e.top+e.height,e.left+=n,e.right=e.left+e.width}function F1(e,t,n,i){var r=e.top,a=e.right,o=e.bottom,s=e.left,l=e.width*t,u=e.height*t;return i>r-u&&i<o+u&&n>s-l&&n<a+l}var j1=function(){function e(t,n){_classCallCheck(this,e),this._document=t,this._viewportRuler=n,this.positions=new Map}return _createClass(e,[{key:"clear",value:function(){this.positions.clear()}},{key:"cache",value:function(e){var t=this;this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),e.forEach((function(e){t.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:z1(e)})}))}},{key:"handleScroll",value:function(e){var t=e.target,n=this.positions.get(t);if(!n)return null;var i,r,a=t===this._document?t.documentElement:t,o=n.scrollPosition;if(t===this._document){var s=this._viewportRuler.getViewportScrollPosition();i=s.top,r=s.left}else i=t.scrollTop,r=t.scrollLeft;var l=o.top-i,u=o.left-r;return this.positions.forEach((function(e,n){e.clientRect&&t!==n&&a.contains(n)&&B1(e.clientRect,l,u)})),o.top=i,o.left=r,{top:l,left:u}}}]),e}(),H1=Sy({passive:!0}),V1=Sy({passive:!1}),U1=function(){function e(t,n,i,r,a,o){var s=this;_classCallCheck(this,e),this._config=n,this._document=i,this._ngZone=r,this._viewportRuler=a,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new I,this._pointerMoveSubscription=p.EMPTY,this._pointerUpSubscription=p.EMPTY,this._scrollSubscription=p.EMPTY,this._resizeSubscription=p.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new I,this.started=new I,this.released=new I,this.ended=new I,this.entered=new I,this.exited=new I,this.dropped=new I,this.moved=this._moveEvents.asObservable(),this._pointerDown=function(e){if(s.beforeStarted.next(),s._handles.length){var t=s._handles.find((function(t){var n=e.target;return!!n&&(n===t||t.contains(n))}));!t||s._disabledHandles.has(t)||s.disabled||s._initializeDragSequence(t,e)}else s.disabled||s._initializeDragSequence(s._rootElement,e)},this._pointerMove=function(e){e.preventDefault();var t=s._getPointerPositionOnPage(e);if(s._hasStartedDragging){s._boundaryElement&&(s._previewRect&&(s._previewRect.width||s._previewRect.height)||(s._previewRect=(s._preview||s._rootElement).getBoundingClientRect()));var n=s._getConstrainedPointerPosition(t);if(s._hasMoved=!0,s._updatePointerDirectionDelta(n),s._dropContainer)s._updateActiveDropContainer(n);else{var i=s._activeTransform;i.x=n.x-s._pickupPositionOnPage.x+s._passiveTransform.x,i.y=n.y-s._pickupPositionOnPage.y+s._passiveTransform.y,s._applyRootElementTransform(i.x,i.y),"undefined"!=typeof SVGElement&&s._rootElement instanceof SVGElement&&s._rootElement.setAttribute("transform","translate(".concat(i.x," ").concat(i.y,")"))}s._moveEvents.observers.length&&s._ngZone.run((function(){s._moveEvents.next({source:s,pointerPosition:n,event:e,distance:s._getDragDistance(n),delta:s._pointerDirectionDelta})}))}else if(Math.abs(t.x-s._pickupPositionOnPage.x)+Math.abs(t.y-s._pickupPositionOnPage.y)>=s._config.dragStartThreshold){if(!(Date.now()>=s._dragStartTime+s._getDragStartDelay(e)))return void s._endDragSequence(e);s._dropContainer&&s._dropContainer.isDragging()||(s._hasStartedDragging=!0,s._ngZone.run((function(){return s._startDragSequence(e)})))}},this._pointerUp=function(e){s._endDragSequence(e)},this.withRootElement(t),this._parentPositions=new j1(i,a),o.registerDragItem(this)}return _createClass(e,[{key:"disabled",get:function(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)},set:function(e){var t=Py(e);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions())}},{key:"getPlaceholderElement",value:function(){return this._placeholder}},{key:"getRootElement",value:function(){return this._rootElement}},{key:"getVisibleElement",value:function(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}},{key:"withHandles",value:function(e){return this._handles=e.map((function(e){return Ry(e)})),this._handles.forEach((function(e){return O1(e,!1)})),this._toggleNativeDragInteractions(),this}},{key:"withPreviewTemplate",value:function(e){return this._previewTemplate=e,this}},{key:"withPlaceholderTemplate",value:function(e){return this._placeholderTemplate=e,this}},{key:"withRootElement",value:function(e){var t=this,n=Ry(e);return n!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular((function(){n.addEventListener("mousedown",t._pointerDown,V1),n.addEventListener("touchstart",t._pointerDown,H1)})),this._initialTransform=void 0,this._rootElement=n),this}},{key:"withBoundaryElement",value:function(e){var t=this;return this._boundaryElement=e?Ry(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe((function(){return t._containInsideBoundaryOnResize()}))),this}},{key:"dispose",value:function(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Z1(this._rootElement),Z1(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}},{key:"isDragging",value:function(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}},{key:"reset",value:function(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}},{key:"disableHandle",value:function(e){this._handles.indexOf(e)>-1&&this._disabledHandles.add(e)}},{key:"enableHandle",value:function(e){this._disabledHandles.delete(e)}},{key:"withDirection",value:function(e){return this._direction=e,this}},{key:"_withDropContainer",value:function(e){this._dropContainer=e}},{key:"getFreeDragPosition",value:function(){var e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}},{key:"setFreeDragPosition",value:function(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}},{key:"_sortFromLastPointerPosition",value:function(){var e=this._pointerPositionAtLastDirectionChange;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e))}},{key:"_removeSubscriptions",value:function(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}},{key:"_destroyPreview",value:function(){this._preview&&Z1(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}},{key:"_destroyPlaceholder",value:function(){this._placeholder&&Z1(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}},{key:"_endDragSequence",value:function(e){var t=this;this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then((function(){t._cleanupDragArtifacts(e),t._cleanupCachedDimensions(),t._dragDropRegistry.stopDragging(t)}))):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run((function(){t.ended.next({source:t,distance:t._getDragDistance(t._getPointerPositionOnPage(e))})})),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}},{key:"_startDragSequence",value:function(e){this.started.next({source:this}),X1(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();var t,n=this._dropContainer;if(n){var i=this._rootElement,r=i.parentNode,a=this._preview=this._createPreviewElement(),o=this._placeholder=this._createPlaceholderElement(),s=this._anchor=this._anchor||this._document.createComment("");r.insertBefore(s,i),i.style.display="none",this._document.body.appendChild(r.replaceChild(o,i)),(t=this._document,t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||t.body).appendChild(a),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}},{key:"_initializeDragSequence",value:function(e,t){var n=this;t.stopPropagation();var i=this.isDragging(),r=X1(t),a=!r&&0!==t.button,o=this._rootElement,s=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(t.target&&t.target.draggable&&"mousedown"===t.type&&t.preventDefault(),!(i||a||s)){this._handles.length&&(this._rootElementTapHighlight=o.style.webkitTapHighlightColor,o.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe((function(e){n._updateOnScroll(e)})),this._boundaryElement&&(this._boundaryRect=z1(this._boundaryElement));var l=this._previewTemplate;this._pickupPositionInElement=l&&l.template&&!l.matchSize?{x:0,y:0}:this._getPointerPositionInElement(e,t);var u=this._pickupPositionOnPage=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}}},{key:"_cleanupDragArtifacts",value:function(e){var t=this;this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run((function(){var n=t._dropContainer,i=n.getItemIndex(t),r=t._getPointerPositionOnPage(e),a=t._getDragDistance(t._getPointerPositionOnPage(e)),o=n._isOverContainer(r.x,r.y);t.ended.next({source:t,distance:a}),t.dropped.next({item:t,currentIndex:i,previousIndex:t._initialIndex,container:n,previousContainer:t._initialContainer,isPointerOverContainer:o,distance:a}),n.drop(t,i,t._initialContainer,o,a,t._initialIndex),t._dropContainer=t._initialContainer}))}},{key:"_updateActiveDropContainer",value:function(e){var t=this,n=e.x,i=e.y,r=this._initialContainer._getSiblingContainerFromPosition(this,n,i);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,i)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run((function(){t.exited.next({item:t,container:t._dropContainer}),t._dropContainer.exit(t),t._dropContainer=r,t._dropContainer.enter(t,n,i,r===t._initialContainer&&r.sortingDisabled?t._initialIndex:void 0),t.entered.next({item:t,container:r,currentIndex:r.getItemIndex(t)})})),this._dropContainer._startScrollingIfNecessary(n,i),this._dropContainer._sortItem(this,n,i,this._pointerDirectionDelta),this._preview.style.transform=q1(n-this._pickupPositionInElement.x,i-this._pickupPositionInElement.y)}},{key:"_createPreviewElement",value:function(){var e,t=this._previewTemplate,n=this.previewClass,i=t?t.template:null;if(i&&t){var r=t.matchSize?this._rootElement.getBoundingClientRect():null,a=t.viewContainer.createEmbeddedView(i,t.context);a.detectChanges(),e=K1(a,this._document),this._previewRef=a,t.matchSize?Y1(e,r):e.style.transform=q1(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{var o=this._rootElement;Y1(e=G1(o),o.getBoundingClientRect())}return R1(e.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:""+(this._config.zIndex||1e3)}),O1(e,!1),e.classList.add("cdk-drag-preview"),e.setAttribute("dir",this._direction),n&&(Array.isArray(n)?n.forEach((function(t){return e.classList.add(t)})):e.classList.add(n)),e}},{key:"_animatePreviewToPlaceholder",value:function(){var e=this;if(!this._hasMoved)return Promise.resolve();var t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=q1(t.left,t.top);var n=function(e){var t=getComputedStyle(e),n=D1(t,"transition-property"),i=n.find((function(e){return"transform"===e||"all"===e}));if(!i)return 0;var r=n.indexOf(i),a=D1(t,"transition-duration"),o=D1(t,"transition-delay");return N1(a[r])+N1(o[r])}(this._preview);return 0===n?Promise.resolve():this._ngZone.runOutsideAngular((function(){return new Promise((function(t){var i=function n(i){(!i||i.target===e._preview&&"transform"===i.propertyName)&&(e._preview.removeEventListener("transitionend",n),t(),clearTimeout(r))},r=setTimeout(i,1.5*n);e._preview.addEventListener("transitionend",i)}))}))}},{key:"_createPlaceholderElement",value:function(){var e,t=this._placeholderTemplate,n=t?t.template:null;return n?(this._placeholderRef=t.viewContainer.createEmbeddedView(n,t.context),this._placeholderRef.detectChanges(),e=K1(this._placeholderRef,this._document)):e=G1(this._rootElement),e.classList.add("cdk-drag-placeholder"),e}},{key:"_getPointerPositionInElement",value:function(e,t){var n=this._rootElement.getBoundingClientRect(),i=e===this._rootElement?null:e,r=i?i.getBoundingClientRect():n,a=X1(t)?t.targetTouches[0]:t,o=this._getViewportScrollPosition();return{x:r.left-n.left+(a.pageX-r.left-o.left),y:r.top-n.top+(a.pageY-r.top-o.top)}}},{key:"_getPointerPositionOnPage",value:function(e){var t=X1(e)?e.touches[0]||e.changedTouches[0]:e,n=this._getViewportScrollPosition();return{x:t.pageX-n.left,y:t.pageY-n.top}}},{key:"_getConstrainedPointerPosition",value:function(e){var t=this.constrainPosition?this.constrainPosition(e,this):e,n=this._dropContainer?this._dropContainer.lockAxis:null;if("x"===this.lockAxis||"x"===n?t.y=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==n||(t.x=this._pickupPositionOnPage.x),this._boundaryRect){var i=this._pickupPositionInElement,r=i.x,a=i.y,o=this._boundaryRect,s=this._previewRect,l=o.top+a,u=o.bottom-(s.height-a);t.x=W1(t.x,o.left+r,o.right-(s.width-r)),t.y=W1(t.y,l,u)}return t}},{key:"_updatePointerDirectionDelta",value:function(e){var t=e.x,n=e.y,i=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,a=Math.abs(t-r.x),o=Math.abs(n-r.y);return a>this._config.pointerDirectionChangeThreshold&&(i.x=t>r.x?1:-1,r.x=t),o>this._config.pointerDirectionChangeThreshold&&(i.y=n>r.y?1:-1,r.y=n),i}},{key:"_toggleNativeDragInteractions",value:function(){if(this._rootElement&&this._handles){var e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,O1(this._rootElement,e))}}},{key:"_removeRootElementListeners",value:function(e){e.removeEventListener("mousedown",this._pointerDown,V1),e.removeEventListener("touchstart",this._pointerDown,H1)}},{key:"_applyRootElementTransform",value:function(e,t){var n=q1(e,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?n+" "+this._initialTransform:n}},{key:"_getDragDistance",value:function(e){var t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}},{key:"_cleanupCachedDimensions",value:function(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}},{key:"_containInsideBoundaryOnResize",value:function(){var e=this._passiveTransform,t=e.x,n=e.y;if(!(0===t&&0===n||this.isDragging())&&this._boundaryElement){var i=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(!(0===i.width&&0===i.height||0===r.width&&0===r.height)){var a=i.left-r.left,o=r.right-i.right,s=i.top-r.top,l=r.bottom-i.bottom;i.width>r.width?(a>0&&(t+=a),o>0&&(t-=o)):t=0,i.height>r.height?(s>0&&(n+=s),l>0&&(n-=l)):n=0,t===this._passiveTransform.x&&n===this._passiveTransform.y||this.setFreeDragPosition({y:n,x:t})}}}},{key:"_getDragStartDelay",value:function(e){var t=this.dragStartDelay;return"number"==typeof t?t:X1(e)?t.touch:t?t.mouse:0}},{key:"_updateOnScroll",value:function(e){var t=this._parentPositions.handleScroll(e);this._boundaryRect&&t&&B1(this._boundaryRect,t.top,t.left)}},{key:"_getViewportScrollPosition",value:function(){var e=this._parentPositions.positions.get(this._document);return e?e.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}]),e}();function q1(e,t){return"translate3d(".concat(Math.round(e),"px, ").concat(Math.round(t),"px, 0)")}function G1(e){var t=e.cloneNode(!0),n=t.querySelectorAll("[id]"),i=e.querySelectorAll("canvas");t.removeAttribute("id");for(var r=0;r<n.length;r++)n[r].removeAttribute("id");if(i.length)for(var a=t.querySelectorAll("canvas"),o=0;o<i.length;o++){var s=a[o].getContext("2d");s&&s.drawImage(i[o],0,0)}return t}function W1(e,t,n){return Math.max(t,Math.min(n,e))}function Z1(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function X1(e){return"t"===e.type[0]}function K1(e,t){var n=e.rootNodes;if(1===n.length&&n[0].nodeType===t.ELEMENT_NODE)return n[0];var i=t.createElement("div");return n.forEach((function(e){return i.appendChild(e)})),i}function Y1(e,t){e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.transform=q1(t.left,t.top)}function J1(e,t,n){var i=Q1(t,e.length-1),r=Q1(n,e.length-1);if(i!==r){for(var a=e[i],o=r<i?-1:1,s=i;s!==r;s+=o)e[s]=e[s+o];e[r]=a}}function Q1(e,t){return Math.max(0,Math.min(t,e))}var $1=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this._dragDropRegistry=n,this._ngZone=r,this._viewportRuler=a,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=function(){return!0},this.beforeStarted=new I,this.entered=new I,this.exited=new I,this.dropped=new I,this.sorted=new I,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=p.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new I,this._cachedShadowRoot=null,this._startScrollInterval=function(){o._stopScrolling(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vy;return(!Gy(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=Vy),new C((function(n){return n.add(t.schedule(A1,e,{subscriber:n,counter:0,period:e})),n}))}(0,By).pipe(Ky(o._stopScrollTimers)).subscribe((function(){var e=o._scrollNode;1===o._verticalScrollDirection?t2(e,-2):2===o._verticalScrollDirection&&t2(e,2),1===o._horizontalScrollDirection?n2(e,-2):2===o._horizontalScrollDirection&&n2(e,2)}))},this.element=Ry(t),this._document=i,this.withScrollableParents([this.element]),n.registerDropContainer(this),this._parentPositions=new j1(i,a)}return _createClass(e,[{key:"dispose",value:function(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"start",value:function(){var e=this,t=Ry(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach((function(t){return t._startReceiving(e)})),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}},{key:"enter",value:function(e,t,n,i){var r;this.start(),null==i?-1===(r=this.sortingDisabled?this._draggables.indexOf(e):-1)&&(r=this._getItemIndexFromPointerPosition(e,t,n)):r=i;var a=this._activeDraggables,o=a.indexOf(e),s=e.getPlaceholderElement(),l=a[r];if(l===e&&(l=a[r+1]),o>-1&&a.splice(o,1),l&&!this._dragDropRegistry.isDragging(l)){var u=l.getRootElement();u.parentElement.insertBefore(s,u),a.splice(r,0,e)}else{var c=Ry(this.element);this._shouldEnterAsFirstChild(t,n)?(c.insertBefore(s,a[0].getRootElement()),a.unshift(e)):(c.appendChild(s),a.push(e))}s.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}},{key:"exit",value:function(e){this._reset(),this.exited.next({item:e,container:this})}},{key:"drop",value:function(e,t,n,i,r,a){this._reset(),null==a&&(a=n.getItemIndex(e)),this.dropped.next({item:e,currentIndex:t,previousIndex:a,container:this,previousContainer:n,isPointerOverContainer:i,distance:r})}},{key:"withItems",value:function(e){var t=this,n=this._draggables;return this._draggables=e,e.forEach((function(e){return e._withDropContainer(t)})),this.isDragging()&&(n.filter((function(e){return e.isDragging()})).every((function(t){return-1===e.indexOf(t)}))?this._reset():this._cacheItems()),this}},{key:"withDirection",value:function(e){return this._direction=e,this}},{key:"connectedTo",value:function(e){return this._siblings=e.slice(),this}},{key:"withOrientation",value:function(e){return this._orientation=e,this}},{key:"withScrollableParents",value:function(e){var t=Ry(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t].concat(_toConsumableArray(e)):e.slice(),this}},{key:"getScrollableParents",value:function(){return this._scrollableElements}},{key:"getItemIndex",value:function(e){return this._isDragging?e2("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,(function(t){return t.drag===e})):this._draggables.indexOf(e)}},{key:"isReceiving",value:function(){return this._activeSiblings.size>0}},{key:"_sortItem",value:function(e,t,n,i){if(!this.sortingDisabled&&F1(this._clientRect,.05,t,n)){var r=this._itemPositions,a=this._getItemIndexFromPointerPosition(e,t,n,i);if(!(-1===a&&r.length>0)){var o="horizontal"===this._orientation,s=e2(r,(function(t){return t.drag===e})),l=r[a],u=r[s].clientRect,c=l.clientRect,h=s>a?1:-1;this._previousSwap.drag=l.drag,this._previousSwap.delta=o?i.x:i.y;var d=this._getItemOffsetPx(u,c,h),f=this._getSiblingOffsetPx(s,r,h),p=r.slice();J1(r,s,a),this.sorted.next({previousIndex:s,currentIndex:a,container:this,item:e}),r.forEach((function(t,n){if(p[n]!==t){var i=t.drag===e,r=i?d:f,a=i?e.getPlaceholderElement():t.drag.getRootElement();t.offset+=r,o?(a.style.transform="translate3d(".concat(Math.round(t.offset),"px, 0, 0)"),B1(t.clientRect,0,r)):(a.style.transform="translate3d(0, ".concat(Math.round(t.offset),"px, 0)"),B1(t.clientRect,r,0))}}))}}}},{key:"_startScrollingIfNecessary",value:function(e,t){var n=this;if(!this.autoScrollDisabled){var i,r=0,a=0;if(this._parentPositions.positions.forEach((function(o,s){var l;s!==n._document&&o.clientRect&&!i&&F1(o.clientRect,.05,e,t)&&(l=_slicedToArray(function(e,t,n,i){var r=i2(t,i),a=r2(t,n),o=0,s=0;if(r){var l=e.scrollTop;1===r?l>0&&(o=1):e.scrollHeight-l>e.clientHeight&&(o=2)}if(a){var u=e.scrollLeft;1===a?u>0&&(s=1):e.scrollWidth-u>e.clientWidth&&(s=2)}return[o,s]}(s,o.clientRect,e,t),2),r=l[0],a=l[1],(r||a)&&(i=s))})),!r&&!a){var o=this._viewportRuler.getViewportSize(),s=o.width,l=o.height,u={width:s,height:l,top:0,right:s,bottom:l,left:0};r=i2(u,t),a=r2(u,e),i=window}!i||r===this._verticalScrollDirection&&a===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=r,this._horizontalScrollDirection=a,this._scrollNode=i,(r||a)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}}},{key:"_stopScrolling",value:function(){this._stopScrollTimers.next()}},{key:"_cacheParentPositions",value:function(){var e=Ry(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}},{key:"_cacheItemPositions",value:function(){var e="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map((function(e){var t=e.getVisibleElement();return{drag:e,offset:0,clientRect:z1(t)}})).sort((function(t,n){return e?t.clientRect.left-n.clientRect.left:t.clientRect.top-n.clientRect.top}))}},{key:"_reset",value:function(){var e=this;this._isDragging=!1;var t=Ry(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach((function(e){var t=e.getRootElement();t&&(t.style.transform="")})),this._siblings.forEach((function(t){return t._stopReceiving(e)})),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}},{key:"_getSiblingOffsetPx",value:function(e,t,n){var i="horizontal"===this._orientation,r=t[e].clientRect,a=t[e+-1*n],o=r[i?"width":"height"]*n;if(a){var s=i?"left":"top",l=i?"right":"bottom";-1===n?o-=a.clientRect[s]-r[l]:o+=r[s]-a.clientRect[l]}return o}},{key:"_getItemOffsetPx",value:function(e,t,n){var i="horizontal"===this._orientation,r=i?t.left-e.left:t.top-e.top;return-1===n&&(r+=i?t.width-e.width:t.height-e.height),r}},{key:"_shouldEnterAsFirstChild",value:function(e,t){if(!this._activeDraggables.length)return!1;var n=this._itemPositions,i="horizontal"===this._orientation;if(n[0].drag!==this._activeDraggables[0]){var r=n[n.length-1].clientRect;return i?e>=r.right:t>=r.bottom}var a=n[0].clientRect;return i?e<=a.left:t<=a.top}},{key:"_getItemIndexFromPointerPosition",value:function(e,t,n,i){var r=this,a="horizontal"===this._orientation;return e2(this._itemPositions,(function(o,s,l){var u=o.drag,c=o.clientRect;if(u===e)return l.length<2;if(i){var h=a?i.x:i.y;if(u===r._previousSwap.drag&&h===r._previousSwap.delta)return!1}return a?t>=Math.floor(c.left)&&t<Math.floor(c.right):n>=Math.floor(c.top)&&n<Math.floor(c.bottom)}))}},{key:"_cacheItems",value:function(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}},{key:"_isOverContainer",value:function(e,t){return L1(this._clientRect,e,t)}},{key:"_getSiblingContainerFromPosition",value:function(e,t,n){return this._siblings.find((function(i){return i._canReceive(e,t,n)}))}},{key:"_canReceive",value:function(e,t,n){if(!L1(this._clientRect,t,n)||!this.enterPredicate(e,this))return!1;var i=this._getShadowRoot().elementFromPoint(t,n);if(!i)return!1;var r=Ry(this.element);return i===r||r.contains(i)}},{key:"_startReceiving",value:function(e){var t=this._activeSiblings;t.has(e)||(t.add(e),this._cacheParentPositions(),this._listenToScrollEvents())}},{key:"_stopReceiving",value:function(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe()}},{key:"_listenToScrollEvents",value:function(){var e=this;this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe((function(t){if(e.isDragging()){var n=e._parentPositions.handleScroll(t);n&&(e._itemPositions.forEach((function(e){B1(e.clientRect,n.top,n.left)})),e._itemPositions.forEach((function(t){var n=t.drag;e._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})))}else e.isReceiving()&&e._cacheParentPositions()}))}},{key:"_getShadowRoot",value:function(){if(!this._cachedShadowRoot){var e=Ey(Ry(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}}]),e}();function e2(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return n;return-1}function t2(e,t){e===window?e.scrollBy(0,t):e.scrollTop+=t}function n2(e,t){e===window?e.scrollBy(t,0):e.scrollLeft+=t}function i2(e,t){var n=e.top,i=e.bottom,r=.05*e.height;return t>=n-r&&t<=n+r?1:t>=i-r&&t<=i+r?2:0}function r2(e,t){var n=e.left,i=e.right,r=.05*e.width;return t>=n-r&&t<=n+r?1:t>=i-r&&t<=i+r?2:0}var a2,o2,s2,l2,u2,c2,h2=Sy({passive:!1,capture:!0}),d2=((a2=function(){function e(t,n){var i=this;_classCallCheck(this,e),this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new I,this.pointerUp=new I,this.scroll=new I,this._preventDefaultWhileDragging=function(e){i._activeDragInstances.size&&e.preventDefault()},this._document=n}return _createClass(e,[{key:"registerDropContainer",value:function(e){this._dropInstances.has(e)||this._dropInstances.add(e)}},{key:"registerDragItem",value:function(e){var t=this;this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular((function(){t._document.addEventListener("touchmove",t._preventDefaultWhileDragging,h2)}))}},{key:"removeDropContainer",value:function(e){this._dropInstances.delete(e)}},{key:"removeDragItem",value:function(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,h2)}},{key:"startDragging",value:function(e,t){var n=this;if(!this._activeDragInstances.has(e)&&(this._activeDragInstances.add(e),1===this._activeDragInstances.size)){var i=t.type.startsWith("touch"),r=i?"touchend":"mouseup";this._globalListeners.set(i?"touchmove":"mousemove",{handler:function(e){return n.pointerMove.next(e)},options:h2}).set(r,{handler:function(e){return n.pointerUp.next(e)},options:!0}).set("scroll",{handler:function(e){return n.scroll.next(e)},options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:h2}),this._ngZone.runOutsideAngular((function(){n._globalListeners.forEach((function(e,t){n._document.addEventListener(t,e.handler,e.options)}))}))}}},{key:"stopDragging",value:function(e){this._activeDragInstances.delete(e),0===this._activeDragInstances.size&&this._clearGlobalListeners()}},{key:"isDragging",value:function(e){return this._activeDragInstances.has(e)}},{key:"ngOnDestroy",value:function(){var e=this;this._dragInstances.forEach((function(t){return e.removeDragItem(t)})),this._dropInstances.forEach((function(t){return e.removeDropContainer(t)})),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}},{key:"_clearGlobalListeners",value:function(){var e=this;this._globalListeners.forEach((function(t,n){e._document.removeEventListener(n,t.handler,t.options)})),this._globalListeners.clear()}}]),e}()).\u0275fac=function(e){return new(e||a2)($e(Su),$e(rc))},a2.\u0275prov=me({factory:function(){return new a2($e(Su),$e(rc))},token:a2,providedIn:"root"}),a2),f2={dragStartThreshold:5,pointerDirectionChangeThreshold:5},p2=((o2=function(){function e(t,n,i,r){_classCallCheck(this,e),this._document=t,this._ngZone=n,this._viewportRuler=i,this._dragDropRegistry=r}return _createClass(e,[{key:"createDrag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f2;return new U1(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}},{key:"createDropList",value:function(e){return new $1(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}]),e}()).\u0275fac=function(e){return new(e||o2)($e(rc),$e(Su),$e(f_),$e(d2))},o2.\u0275prov=me({factory:function(){return new o2($e(rc),$e(Su),$e(f_),$e(d2))},token:o2,providedIn:"root"}),o2),m2=new qe("CDK_DRAG_PARENT"),v2=((u2=function(){function e(t,n){_classCallCheck(this,e),this.element=t,this._stateChanges=new I,this._disabled=!1,this._parentDrag=n,O1(t.nativeElement,!1)}return _createClass(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e),this._stateChanges.next(this)}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}}]),e}()).\u0275fac=function(e){return new(e||u2)(To(Vs),To(m2,8))},u2.\u0275dir=Ct({type:u2,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:["cdkDragHandleDisabled","disabled"]}}),u2),g2=((l2=_createClass((function e(t){_classCallCheck(this,e),this.templateRef=t}))).\u0275fac=function(e){return new(e||l2)(To(dl))},l2.\u0275dir=Ct({type:l2,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"}}),l2),y2=((s2=function(){function e(t){_classCallCheck(this,e),this.templateRef=t,this._matchSize=!1}return _createClass(e,[{key:"matchSize",get:function(){return this._matchSize},set:function(e){this._matchSize=Py(e)}}]),e}()).\u0275fac=function(e){return new(e||s2)(To(dl))},s2.\u0275dir=Ct({type:s2,selectors:[["ng-template","cdkDragPreview",""]],inputs:{matchSize:"matchSize",data:"data"}}),s2),_2=new qe("CDK_DRAG_CONFIG"),x2=new qe("CDK_DROP_LIST"),b2=((c2=function(){function e(t,n,i,r,a,o,s,l,u){var c=this;_classCallCheck(this,e),this.element=t,this.dropContainer=n,this._document=i,this._ngZone=r,this._viewContainerRef=a,this._dir=s,this._changeDetectorRef=u,this._destroyed=new I,this.started=new Dl,this.released=new Dl,this.ended=new Dl,this.entered=new Dl,this.exited=new Dl,this.dropped=new Dl,this.moved=new C((function(e){var t=c._dragRef.moved.pipe(H((function(e){return{source:c,pointerPosition:e.pointerPosition,event:e.event,delta:e.delta,distance:e.distance}}))).subscribe(e);return function(){t.unsubscribe()}})),this._dragRef=l.createDrag(t,{dragStartThreshold:o&&null!=o.dragStartThreshold?o.dragStartThreshold:5,pointerDirectionChangeThreshold:o&&null!=o.pointerDirectionChangeThreshold?o.pointerDirectionChangeThreshold:5,zIndex:null==o?void 0:o.zIndex}),this._dragRef.data=this,o&&this._assignDefaults(o),n&&(this._dragRef._withDropContainer(n._dropListRef),n.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}return _createClass(e,[{key:"disabled",get:function(){return this._disabled||this.dropContainer&&this.dropContainer.disabled},set:function(e){this._disabled=Py(e),this._dragRef.disabled=this._disabled}},{key:"getPlaceholderElement",value:function(){return this._dragRef.getPlaceholderElement()}},{key:"getRootElement",value:function(){return this._dragRef.getRootElement()}},{key:"reset",value:function(){this._dragRef.reset()}},{key:"getFreeDragPosition",value:function(){return this._dragRef.getFreeDragPosition()}},{key:"ngAfterViewInit",value:function(){var e=this;this._ngZone.onStable.asObservable().pipe(Yp(1),Ky(this._destroyed)).subscribe((function(){e._updateRootElement(),e._handles.changes.pipe(om(e._handles),dm((function(t){var n=t.filter((function(t){return t._parentDrag===e})).map((function(e){return e.element}));e._dragRef.withHandles(n)})),nm((function(e){return J.apply(void 0,_toConsumableArray(e.map((function(e){return e._stateChanges.pipe(om(e))}))))})),Ky(e._destroyed)).subscribe((function(t){var n=e._dragRef,i=t.element.nativeElement;t.disabled?n.disableHandle(i):n.enableHandle(i)})),e.freeDragPosition&&e._dragRef.setFreeDragPosition(e.freeDragPosition)}))}},{key:"ngOnChanges",value:function(e){var t=e.rootElementSelector,n=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}},{key:"ngOnDestroy",value:function(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}},{key:"_updateRootElement",value:function(){var e=this.element.nativeElement,t=this.rootElementSelector?w2(e,this.rootElementSelector):e;if(t&&t.nodeType!==this._document.ELEMENT_NODE)throw Error('cdkDrag must be attached to an element node. Currently attached to "'.concat(t.nodeName,'".'));this._dragRef.withRootElement(t||e)}},{key:"_getBoundaryElement",value:function(){var e=this.boundaryElement;if(!e)return null;if("string"==typeof e)return w2(this.element.nativeElement,e);var t=Ry(e);if(Ei()&&!t.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return t}},{key:"_syncInputs",value:function(e){var t=this;e.beforeStarted.subscribe((function(){if(!e.isDragging()){var n=t._dir,i=t.dragStartDelay,r=t._placeholderTemplate?{template:t._placeholderTemplate.templateRef,context:t._placeholderTemplate.data,viewContainer:t._viewContainerRef}:null,a=t._previewTemplate?{template:t._previewTemplate.templateRef,context:t._previewTemplate.data,matchSize:t._previewTemplate.matchSize,viewContainer:t._viewContainerRef}:null;e.disabled=t.disabled,e.lockAxis=t.lockAxis,e.dragStartDelay="object"==typeof i&&i?i:My(i),e.constrainPosition=t.constrainPosition,e.previewClass=t.previewClass,e.withBoundaryElement(t._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(a),n&&e.withDirection(n.value)}}))}},{key:"_handleEvents",value:function(e){var t=this;e.started.subscribe((function(){t.started.emit({source:t}),t._changeDetectorRef.markForCheck()})),e.released.subscribe((function(){t.released.emit({source:t})})),e.ended.subscribe((function(e){t.ended.emit({source:t,distance:e.distance}),t._changeDetectorRef.markForCheck()})),e.entered.subscribe((function(e){t.entered.emit({container:e.container.data,item:t,currentIndex:e.currentIndex})})),e.exited.subscribe((function(e){t.exited.emit({container:e.container.data,item:t})})),e.dropped.subscribe((function(e){t.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,isPointerOverContainer:e.isPointerOverContainer,item:t,distance:e.distance})}))}},{key:"_assignDefaults",value:function(e){var t=e.lockAxis,n=e.dragStartDelay,i=e.constrainPosition,r=e.previewClass,a=e.boundaryElement,o=e.draggingDisabled,s=e.rootElementSelector;this.disabled=null!=o&&o,this.dragStartDelay=n||0,t&&(this.lockAxis=t),i&&(this.constrainPosition=i),r&&(this.previewClass=r),a&&(this.boundaryElement=a),s&&(this.rootElementSelector=s)}}]),e}()).\u0275fac=function(e){return new(e||c2)(To(Vs),To(x2,12),To(rc),To(Su),To(pl),To(_2,8),To(s_,8),To(p2),To(Ga))},c2.\u0275dir=Ct({type:c2,selectors:[["","cdkDrag",""]],contentQueries:function(e,t,n){var i;1&e&&(Yl(n,y2,!0),Yl(n,g2,!0),Yl(n,v2,!0)),2&e&&(Wl(i=$l())&&(t._previewTemplate=i.first),Wl(i=$l())&&(t._placeholderTemplate=i.first),Wl(i=$l())&&(t._handles=i))},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(e,t){2&e&&rs("cdk-drag-disabled",t.disabled)("cdk-drag-dragging",t._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Ls([{provide:m2,useExisting:c2}]),Es]}),c2);function w2(e,t){for(var n=e.parentElement;n;){if(n.matches?n.matches(t):n.msMatchesSelector(t))return n;n=n.parentElement}return null}var k2,C2,S2,T2=((S2=function(){function e(){_classCallCheck(this,e),this._items=new Set,this._disabled=!1}return _createClass(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e)}},{key:"ngOnDestroy",value:function(){this._items.clear()}}]),e}()).\u0275fac=function(e){return new(e||S2)},S2.\u0275dir=Ct({type:S2,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:["cdkDropListGroupDisabled","disabled"]},exportAs:["cdkDropListGroup"]}),S2),E2=0,P2=((C2=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this.element=t,this._changeDetectorRef=i,this._dir=r,this._group=a,this._scrollDispatcher=o,this._destroyed=new I,this.connectedTo=[],this.id="cdk-drop-list-"+E2++,this.enterPredicate=function(){return!0},this.dropped=new Dl,this.entered=new Dl,this.exited=new Dl,this.sorted=new Dl,this._unsortedItems=new Set,this._dropListRef=n.createDropList(t),this._dropListRef.data=this,s&&this._assignDefaults(s),this._dropListRef.enterPredicate=function(e,t){return l.enterPredicate(e.data,t.data)},this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),a&&a._items.add(this)}return _createClass(e,[{key:"disabled",get:function(){return this._disabled||!!this._group&&this._group.disabled},set:function(e){this._dropListRef.disabled=this._disabled=Py(e)}},{key:"addItem",value:function(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}},{key:"removeItem",value:function(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}},{key:"getSortedItems",value:function(){return Array.from(this._unsortedItems).sort((function(e,t){return e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1}))}},{key:"ngOnDestroy",value:function(){var t=e._dropLists.indexOf(this);t>-1&&e._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}},{key:"start",value:function(){this._dropListRef.start()}},{key:"drop",value:function(e,t,n,i){this._dropListRef.drop(e._dragRef,t,n._dropListRef,i,{x:0,y:0})}},{key:"enter",value:function(e,t,n){this._dropListRef.enter(e._dragRef,t,n)}},{key:"exit",value:function(e){this._dropListRef.exit(e._dragRef)}},{key:"getItemIndex",value:function(e){return this._dropListRef.getItemIndex(e._dragRef)}},{key:"_setupInputSyncSubscription",value:function(t){var n=this;this._dir&&this._dir.change.pipe(om(this._dir.value),Ky(this._destroyed)).subscribe((function(e){return t.withDirection(e)})),t.beforeStarted.subscribe((function(){var i=Iy(n.connectedTo).map((function(t){return"string"==typeof t?e._dropLists.find((function(e){return e.id===t})):t}));if(n._group&&n._group._items.forEach((function(e){-1===i.indexOf(e)&&i.push(e)})),!n._scrollableParentsResolved&&n._scrollDispatcher){var r=n._scrollDispatcher.getAncestorScrollContainers(n.element).map((function(e){return e.getElementRef().nativeElement}));n._dropListRef.withScrollableParents(r),n._scrollableParentsResolved=!0}t.disabled=n.disabled,t.lockAxis=n.lockAxis,t.sortingDisabled=Py(n.sortingDisabled),t.autoScrollDisabled=Py(n.autoScrollDisabled),t.connectedTo(i.filter((function(e){return e&&e!==n})).map((function(e){return e._dropListRef}))).withOrientation(n.orientation)}))}},{key:"_handleEvents",value:function(e){var t=this;e.beforeStarted.subscribe((function(){t._syncItemsWithRef(),t._changeDetectorRef.markForCheck()})),e.entered.subscribe((function(e){t.entered.emit({container:t,item:e.item.data,currentIndex:e.currentIndex})})),e.exited.subscribe((function(e){t.exited.emit({container:t,item:e.item.data}),t._changeDetectorRef.markForCheck()})),e.sorted.subscribe((function(e){t.sorted.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,container:t,item:e.item.data})})),e.dropped.subscribe((function(e){t.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,item:e.item.data,isPointerOverContainer:e.isPointerOverContainer,distance:e.distance}),t._changeDetectorRef.markForCheck()}))}},{key:"_assignDefaults",value:function(e){var t=e.lockAxis,n=e.draggingDisabled,i=e.sortingDisabled,r=e.listAutoScrollDisabled,a=e.listOrientation;this.disabled=null!=n&&n,this.sortingDisabled=null!=i&&i,this.autoScrollDisabled=null!=r&&r,this.orientation=a||"vertical",t&&(this.lockAxis=t)}},{key:"_syncItemsWithRef",value:function(){this._dropListRef.withItems(this.getSortedItems().map((function(e){return e._dragRef})))}}]),e}()).\u0275fac=function(e){return new(e||C2)(To(Vs),To(p2),To(Ga),To(s_,8),To(T2,12),To(h_),To(_2,8))},C2.\u0275dir=Ct({type:C2,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(e,t){2&e&&(ys("id",t.id),rs("cdk-drop-list-disabled",t.disabled)("cdk-drop-list-dragging",t._dropListRef.isDragging())("cdk-drop-list-receiving",t._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Ls([{provide:T2,useValue:void 0},{provide:x2,useExisting:C2}])]}),C2._dropLists=[],C2),M2=((k2=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:k2}),k2.\u0275inj=ve({factory:function(e){return new(e||k2)},providers:[p2],imports:[p_]}),k2);function I2(e,t){if(1&e&&(Ao(0,"mat-option",14),ms(1),Ro()),2&e){var n=t.$implicit;Mo("value",n),yr(1),vs(n)}}function A2(e,t){1&e&&(Ao(0,"div"),ms(1,"facility name is required"),Ro())}function R2(e,t){if(1&e&&(Ao(0,"div",15),Co(1,A2,2,0,"div",16),Ro()),2&e){qo();var n=So(8);yr(1),Mo("ngIf",n.errors.required)}}function O2(e,t){1&e&&(Ao(0,"div"),ms(1,"Level name is required"),Ro())}function N2(e,t){if(1&e&&(Ao(0,"div",15),Co(1,O2,2,0,"div",16),Ro()),2&e){qo();var n=So(16);yr(1),Mo("ngIf",n.errors.required)}}var D2,z2,L2,B2,F2=function(e){return{"is-invalid":e}},j2=((B2=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.siteonboarding=t,this.snackBar=n,this.dialog=i,this.form={Site_Id:"",Facility_Id:"",Levle_Id:"",Space_Id:"",deviceType:"",deviceId:"",devicelocation:""},this.DevicesTypes=["Occupency","IAQ","IoT Cam","Router"],this.siteonboarding.obtainedDeviceDetails.subscribe((function(e){console.log(e,"add device component"),r.form.Site_Id=e[0].properties.Site_Id,r.form.Facility_Id=e[0].properties.Facility_Id,r.form.Levle_Id=e[0].properties.Level_Id,r.form.Space_Id=e[0].properties.spaceId,r.form.devicelocation=JSON.stringify(e[0].geometry)}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSubmit",value:function(){var e=this;this.siteonboarding.adddevices(this.form).subscribe((function(t){console.log(t),Object.entries(t)?(e.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),e.dialog.closeAll()):e.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})}))}},{key:"selectedDevice",value:function(e){this.form.deviceType=e}},{key:"onReset",value:function(e){e.reset()}}]),e}()).\u0275fac=function(e){return new(e||B2)(To(LH),To(nV),To(zM))},B2.\u0275cmp=yt({type:B2,selectors:[["app-add-device"]],decls:23,vars:13,consts:[[1,"register-form"],["name","form"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","deviceType","required","",1,"form-control",3,"ngModel","ngClass","selectionChange","ngModelChange"],["deviceType","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["matInput","","type","text","name","deviceID","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["deviceID","ngModel"],[1,"buttongroup"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){if(1&e){var n=zo();Ao(0,"div",0),Ao(1,"form",1,2),Ao(3,"div",3),Ao(4,"label"),ms(5,"Device Type"),Ro(),Ao(6,"mat-form-field",4),Ao(7,"mat-select",5,6),Fo("selectionChange",(function(){en(n);var e=So(8);return t.selectedDevice(e.value)}))("ngModelChange",(function(e){return t.form.deviceType=e})),Co(9,I2,2,2,"mat-option",7),Ro(),Ro(),Co(10,R2,2,1,"div",8),Ro(),Ao(11,"div",3),Ao(12,"label"),ms(13,"Device Id"),Ro(),Ao(14,"mat-form-field",4),Ao(15,"input",9,10),Fo("ngModelChange",(function(e){return t.form.deviceId=e})),Ro(),Ro(),Co(17,N2,2,1,"div",8),Ro(),Ao(18,"div",11),Ao(19,"button",12),Fo("click",(function(){return t.onSubmit()})),ms(20,"Submit"),Ro(),Ao(21,"button",13),Fo("click",(function(){en(n);var e=So(2);return t.onReset(e)})),ms(22," Reset "),Ro(),Ro(),Ro(),Ro()}if(2&e){var i=So(2),r=So(8),a=So(16);yr(7),Mo("ngModel",t.form.deviceType)("ngClass",Al(9,F2,i.submitted&&r.errors)),yr(2),Mo("ngForOf",t.DevicesTypes),yr(1),Mo("ngIf",i.submitted&&r.errors),yr(5),Mo("disabled",!t.form.deviceType)("ngModel",t.form.deviceId)("ngClass",Al(11,F2,i.submitted&&a.errors)),yr(2),Mo("ngIf",i.submitted&&a.errors),yr(2),Mo("disabled",!t.form.deviceId)}},directives:[HC,_k,RC,LP,fM,GC,yk,jC,Dc,Lc,Fc,UP,uk,FT,fb],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.confirm-button[_ngcontent-%COMP%]{background-color:#0046ad;padding:6px;border-radius:5px;border:none;color:#fff;min-height:45%;cursor:pointer;width:94%;margin:4px 5px 0;font-size:.8rem;font-weight:400}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.buttongroup[_ngcontent-%COMP%], .fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),B2),H2=0,V2=((L2=function(){function e(){_classCallCheck(this,e),this._stateChanges=new I,this._openCloseAllActions=new I,this.id="cdk-accordion-"+H2++,this._multi=!1}return _createClass(e,[{key:"multi",get:function(){return this._multi},set:function(e){this._multi=Py(e)}},{key:"openAll",value:function(){this._openCloseAll(!0)}},{key:"closeAll",value:function(){this._openCloseAll(!1)}},{key:"ngOnChanges",value:function(e){this._stateChanges.next(e)}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"_openCloseAll",value:function(e){this.multi&&this._openCloseAllActions.next(e)}}]),e}()).\u0275fac=function(e){return new(e||L2)},L2.\u0275dir=Ct({type:L2,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[Es]}),L2),U2=0,q2=((z2=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.accordion=t,this._changeDetectorRef=n,this._expansionDispatcher=i,this._openCloseAllSubscription=p.EMPTY,this.closed=new Dl,this.opened=new Dl,this.destroyed=new Dl,this.expandedChange=new Dl,this.id="cdk-accordion-child-"+U2++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=function(){},this._removeUniqueSelectionListener=i.listen((function(e,t){r.accordion&&!r.accordion.multi&&r.accordion.id===t&&r.id!==e&&(r.expanded=!1)})),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}return _createClass(e,[{key:"expanded",get:function(){return this._expanded},set:function(e){e=Py(e),this._expanded!==e&&(this._expanded=e,this.expandedChange.emit(e),e?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=Py(e)}},{key:"ngOnDestroy",value:function(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}},{key:"toggle",value:function(){this.disabled||(this.expanded=!this.expanded)}},{key:"close",value:function(){this.disabled||(this.expanded=!1)}},{key:"open",value:function(){this.disabled||(this.expanded=!0)}},{key:"_subscribeToOpenCloseAllActions",value:function(){var e=this;return this.accordion._openCloseAllActions.subscribe((function(t){e.disabled||(e.expanded=t)}))}}]),e}()).\u0275fac=function(e){return new(e||z2)(To(V2,12),To(Ga),To(c_))},z2.\u0275dir=Ct({type:z2,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[Ls([{provide:V2,useValue:void 0}])]}),z2),G2=((D2=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:D2}),D2.\u0275inj=ve({factory:function(e){return new(e||D2)}}),D2),W2=["body"];function Z2(e,t){}var X2=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],K2=["mat-expansion-panel-header","*","mat-action-row"],Y2=function(e,t){return{collapsedHeight:e,expandedHeight:t}},J2=function(e,t){return{value:e,params:t}};function Q2(e,t){1&e&&Oo(0,"span",2),2&e&&Mo("@indicatorRotate",qo()._getExpandedState())}var $2,e3,t3,n3,i3,r3,a3,o3=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],s3=["mat-panel-title","mat-panel-description","*"],l3=new qe("MAT_ACCORDION"),u3={indicatorRotate:Wh("indicatorRotate",[Yh("collapsed, void",Kh({transform:"rotate(0deg)"})),Yh("expanded",Kh({transform:"rotate(180deg)"})),Jh("expanded <=> collapsed, void => collapsed",Zh("225ms cubic-bezier(0.4,0.0,0.2,1)"))]),expansionHeaderHeight:Wh("expansionHeight",[Yh("collapsed, void",Kh({height:"{{collapsedHeight}}"}),{params:{collapsedHeight:"48px"}}),Yh("expanded",Kh({height:"{{expandedHeight}}"}),{params:{expandedHeight:"64px"}}),Jh("expanded <=> collapsed, void => collapsed",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:3,steps:e,options:t}}([$h("@indicatorRotate",Qh(),{optional:!0}),Zh("225ms cubic-bezier(0.4,0.0,0.2,1)")]))]),bodyExpansion:Wh("bodyExpansion",[Yh("collapsed, void",Kh({height:"0px",visibility:"hidden"})),Yh("expanded",Kh({height:"*",visibility:"visible"})),Jh("expanded <=> collapsed, void => collapsed",Zh("225ms cubic-bezier(0.4,0.0,0.2,1)"))])},c3=(($2=_createClass((function e(t){_classCallCheck(this,e),this._template=t}))).\u0275fac=function(e){return new(e||$2)(To(dl))},$2.\u0275dir=Ct({type:$2,selectors:[["ng-template","matExpansionPanelContent",""]]}),$2),h3=0,d3=new qe("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),f3=((r3=function(e){function t(e,n,i,r,a,o,s){var l;return _classCallCheck(this,t),(l=_callSuper(this,t,[e,n,i]))._viewContainerRef=r,l._animationMode=o,l._hideToggle=!1,l.afterExpand=new Dl,l.afterCollapse=new Dl,l._inputChanges=new I,l._headerId="mat-expansion-panel-header-"+h3++,l._bodyAnimationDone=new I,l.accordion=e,l._document=a,l._bodyAnimationDone.pipe(Fy((function(e,t){return e.fromState===t.fromState&&e.toState===t.toState}))).subscribe((function(e){"void"!==e.fromState&&("expanded"===e.toState?l.afterExpand.emit():"collapsed"===e.toState&&l.afterCollapse.emit())})),s&&(l.hideToggle=s.hideToggle),l}return _inherits(t,e),_createClass(t,[{key:"hideToggle",get:function(){return this._hideToggle||this.accordion&&this.accordion.hideToggle},set:function(e){this._hideToggle=Py(e)}},{key:"togglePosition",get:function(){return this._togglePosition||this.accordion&&this.accordion.togglePosition},set:function(e){this._togglePosition=e}},{key:"_hasSpacing",value:function(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}},{key:"_getExpandedState",value:function(){return this.expanded?"expanded":"collapsed"}},{key:"toggle",value:function(){this.expanded=!this.expanded}},{key:"close",value:function(){this.expanded=!1}},{key:"open",value:function(){this.expanded=!0}},{key:"ngAfterContentInit",value:function(){var e=this;this._lazyContent&&this.opened.pipe(om(null),Rp((function(){return e.expanded&&!e._portal})),Yp(1)).subscribe((function(){e._portal=new pS(e._lazyContent._template,e._viewContainerRef)}))}},{key:"ngOnChanges",value:function(e){this._inputChanges.next(e)}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf2(t.prototype),"ngOnDestroy",this).call(this),this._bodyAnimationDone.complete(),this._inputChanges.complete()}},{key:"_containsFocus",value:function(){if(this._body){var e=this._document.activeElement,t=this._body.nativeElement;return e===t||t.contains(e)}return!1}}]),t}(q2)).\u0275fac=function(e){return new(e||r3)(To(l3,12),To(Ga),To(c_),To(pl),To(rc),To(yp,8),To(d3,8))},r3.\u0275cmp=yt({type:r3,selectors:[["mat-expansion-panel"]],contentQueries:function(e,t,n){var i;1&e&&Yl(n,c3,!0),2&e&&Wl(i=$l())&&(t._lazyContent=i.first)},viewQuery:function(e,t){var n;1&e&&Xl(W2,!0),2&e&&Wl(n=$l())&&(t._body=n.first)},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(e,t){2&e&&rs("mat-expanded",t.expanded)("_mat-animation-noopable","NoopAnimations"===t._animationMode)("mat-expansion-panel-spacing",t._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[Ls([{provide:l3,useValue:void 0}]),bs,Es],ngContentSelectors:K2,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(e,t){1&e&&(Wo(X2),Zo(0),Ao(1,"div",0,1),Fo("@bodyExpansion.done",(function(e){return t._bodyAnimationDone.next(e)})),Ao(3,"div",2),Zo(4,1),Co(5,Z2,0,0,"ng-template",3),Ro(),Zo(6,2),Ro()),2&e&&(yr(1),Mo("@bodyExpansion",t._getExpandedState())("id",t.id),wo("aria-labelledby",t._headerId),yr(4),Mo("cdkPortalOutlet",t._portal))},directives:[_S],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[u3.bodyExpansion]},changeDetection:0}),r3),p3=((i3=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this.panel=t,this._element=n,this._focusMonitor=i,this._changeDetectorRef=r,this._parentChangeSubscription=p.EMPTY,this._animationsDisabled=!0;var s=t.accordion?t.accordion._stateChanges.pipe(Rp((function(e){return!(!e.hideToggle&&!e.togglePosition)}))):Pp;this._parentChangeSubscription=J(t.opened,t.closed,s,t._inputChanges.pipe(Rp((function(e){return!!(e.hideToggle||e.disabled||e.togglePosition)})))).subscribe((function(){return o._changeDetectorRef.markForCheck()})),t.closed.pipe(Rp((function(){return t._containsFocus()}))).subscribe((function(){return i.focusVia(n,"program")})),i.monitor(n).subscribe((function(e){e&&t.accordion&&t.accordion._handleHeaderFocus(o)})),a&&(this.expandedHeight=a.expandedHeight,this.collapsedHeight=a.collapsedHeight)}return _createClass(e,[{key:"_animationStarted",value:function(){this._animationsDisabled=!1}},{key:"disabled",get:function(){return this.panel.disabled}},{key:"_toggle",value:function(){this.disabled||this.panel.toggle()}},{key:"_isExpanded",value:function(){return this.panel.expanded}},{key:"_getExpandedState",value:function(){return this.panel._getExpandedState()}},{key:"_getPanelId",value:function(){return this.panel.id}},{key:"_getTogglePosition",value:function(){return this.panel.togglePosition}},{key:"_showToggle",value:function(){return!this.panel.hideToggle&&!this.panel.disabled}},{key:"_keydown",value:function(e){switch(e.keyCode){case 32:case 13:v_(e)||(e.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e))}}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"program",t=arguments.length>1?arguments[1]:void 0;this._focusMonitor.focusVia(this._element,e,t)}},{key:"ngOnDestroy",value:function(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}]),e}()).\u0275fac=function(e){return new(e||i3)(To(f3,1),To(Vs),To($_),To(Ga),To(d3,8))},i3.\u0275cmp=yt({type:i3,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:19,hostBindings:function(e,t){1&e&&(jo("@expansionHeight.start",(function(){return t._animationStarted()})),Fo("click",(function(){return t._toggle()}))("keydown",(function(e){return t._keydown(e)}))),2&e&&(wo("id",t.panel._headerId)("tabindex",t.disabled?-1:0)("aria-controls",t._getPanelId())("aria-expanded",t._isExpanded())("aria-disabled",t.panel.disabled),_s("@.disabled",t._animationsDisabled)("@expansionHeight",Rl(16,J2,t._getExpandedState(),Rl(13,Y2,t.collapsedHeight,t.expandedHeight))),rs("mat-expanded",t._isExpanded())("mat-expansion-toggle-indicator-after","after"===t._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===t._getTogglePosition()))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},ngContentSelectors:s3,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(e,t){1&e&&(Wo(o3),Ao(0,"span",0),Zo(1),Zo(2,1),Zo(3,2),Ro(),Co(4,Q2,1,1,"span",1)),2&e&&(yr(4),Mo("ngIf",t._showToggle()))},directives:[Fc],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;position:relative}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}\n'],encapsulation:2,data:{animation:[u3.indicatorRotate,u3.expansionHeaderHeight]},changeDetection:0}),i3),m3=((n3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||n3)},n3.\u0275dir=Ct({type:n3,selectors:[["mat-panel-description"]],hostAttrs:[1,"mat-expansion-panel-header-description"]}),n3),v3=((t3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275fac=function(e){return new(e||t3)},t3.\u0275dir=Ct({type:t3,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),t3),g3=((e3=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments))._ownHeaders=new Ll,e._hideToggle=!1,e.displayMode="default",e.togglePosition="after",e}return _inherits(t,e),_createClass(t,[{key:"hideToggle",get:function(){return this._hideToggle},set:function(e){this._hideToggle=Py(e)}},{key:"ngAfterContentInit",value:function(){var e=this;this._headers.changes.pipe(om(this._headers)).subscribe((function(t){e._ownHeaders.reset(t.filter((function(t){return t.panel.accordion===e}))),e._ownHeaders.notifyOnChanges()})),this._keyManager=new B_(this._ownHeaders).withWrap()}},{key:"_handleHeaderKeydown",value:function(e){var t=e.keyCode,n=this._keyManager;36===t?v_(e)||(n.setFirstItemActive(),e.preventDefault()):35===t?v_(e)||(n.setLastItemActive(),e.preventDefault()):this._keyManager.onKeydown(e)}},{key:"_handleHeaderFocus",value:function(e){this._keyManager.updateActiveItem(e)}}]),t}(V2)).\u0275fac=function(e){return y3(e||e3)},e3.\u0275dir=Ct({type:e3,selectors:[["mat-accordion"]],contentQueries:function(e,t,n){var i;1&e&&Yl(n,p3,!0),2&e&&Wl(i=$l())&&(t._headers=i)},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(e,t){2&e&&rs("mat-accordion-multi",t.multi)},inputs:{multi:"multi",displayMode:"displayMode",togglePosition:"togglePosition",hideToggle:"hideToggle"},exportAs:["matAccordion"],features:[Ls([{provide:l3,useExisting:e3}]),bs]}),e3),y3=hi(g3),_3=((a3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:a3}),a3.\u0275inj=ve({factory:function(e){return new(e||a3)},imports:[[sh,G2,wS]]}),a3);function x3(e,t){if(1&e&&(Tn(),Oo(0,"circle",3)),2&e){var n=qo();is("animation-name","mat-progress-spinner-stroke-rotate-"+n.diameter)("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),wo("r",n._circleRadius)}}function b3(e,t){if(1&e&&(Tn(),Oo(0,"circle",3)),2&e){var n=qo();is("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),wo("r",n._circleRadius)}}function w3(e,t){if(1&e&&(Tn(),Oo(0,"circle",3)),2&e){var n=qo();is("animation-name","mat-progress-spinner-stroke-rotate-"+n.diameter)("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),wo("r",n._circleRadius)}}function k3(e,t){if(1&e&&(Tn(),Oo(0,"circle",3)),2&e){var n=qo();is("stroke-dashoffset",n._strokeDashOffset,"px")("stroke-dasharray",n._strokeCircumference,"px")("stroke-width",n._circleStrokeWidth,"%"),wo("r",n._circleRadius)}}var C3,S3,T3,E3=gx(_createClass((function e(t){_classCallCheck(this,e),this._elementRef=t})),"primary"),P3=new qe("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}}),M3=((T3=function(e){function t(e,n,i,r,a){var o;_classCallCheck(this,t),(o=_callSuper(this,t,[e]))._elementRef=e,o._document=i,o._diameter=100,o._value=0,o._fallbackAnimation=!1,o.mode="determinate";var s=t._diameters;return s.has(i.head)||s.set(i.head,new Set([100])),o._fallbackAnimation=n.EDGE||n.TRIDENT,o._noopAnimations="NoopAnimations"===r&&!!a&&!a._forceAnimations,a&&(a.diameter&&(o.diameter=a.diameter),a.strokeWidth&&(o.strokeWidth=a.strokeWidth)),o}return _inherits(t,e),_createClass(t,[{key:"diameter",get:function(){return this._diameter},set:function(e){this._diameter=My(e),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}},{key:"strokeWidth",get:function(){return this._strokeWidth||this.diameter/10},set:function(e){this._strokeWidth=My(e)}},{key:"value",get:function(){return"determinate"===this.mode?this._value:0},set:function(e){this._value=Math.max(0,Math.min(100,My(e)))}},{key:"ngOnInit",value:function(){var e=this._elementRef.nativeElement;this._styleRoot=Ey(e)||this._document.head,this._attachStyleNode(),e.classList.add("mat-progress-spinner-indeterminate".concat(this._fallbackAnimation?"-fallback":"","-animation"))}},{key:"_circleRadius",get:function(){return(this.diameter-10)/2}},{key:"_viewBox",get:function(){var e=2*this._circleRadius+this.strokeWidth;return"0 0 ".concat(e," ").concat(e)}},{key:"_strokeCircumference",get:function(){return 2*Math.PI*this._circleRadius}},{key:"_strokeDashOffset",get:function(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}},{key:"_circleStrokeWidth",get:function(){return this.strokeWidth/this.diameter*100}},{key:"_attachStyleNode",value:function(){var e=this._styleRoot,n=this._diameter,i=t._diameters,r=i.get(e);if(!r||!r.has(n)){var a=this._document.createElement("style");a.setAttribute("mat-spinner-animation",n+""),a.textContent=this._getAnimationText(),e.appendChild(a),r||(r=new Set,i.set(e,r)),r.add(n)}}},{key:"_getAnimationText",value:function(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*this._strokeCircumference).replace(/END_VALUE/g,""+.2*this._strokeCircumference).replace(/DIAMETER/g,""+this.diameter)}}]),t}(E3)).\u0275fac=function(e){return new(e||T3)(To(Vs),To(by),To(rc,8),To(yp,8),To(P3))},T3.\u0275cmp=yt({type:T3,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(wo("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),is("width",t.diameter,"px")("height",t.diameter,"px"),rs("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[bs],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(Tn(),Ao(0,"svg",0),Co(1,x3,1,9,"circle",1),Co(2,b3,1,7,"circle",2),Ro()),2&e&&(is("width",t.diameter,"px")("height",t.diameter,"px"),Mo("ngSwitch","indeterminate"===t.mode),wo("viewBox",t._viewBox),yr(1),Mo("ngSwitchCase",!0),yr(1),Mo("ngSwitchCase",!1))},directives:[eh,th],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),T3._diameters=new WeakMap,T3),I3=((S3=function(e){function t(e,n,i,r,a){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e,n,i,r,a])).mode="indeterminate",o}return _inherits(t,e),_createClass(t)}(M3)).\u0275fac=function(e){return new(e||S3)(To(Vs),To(by),To(rc,8),To(yp,8),To(P3))},S3.\u0275cmp=yt({type:S3,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(e,t){2&e&&(is("width",t.diameter,"px")("height",t.diameter,"px"),rs("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color"},features:[bs],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(Tn(),Ao(0,"svg",0),Co(1,w3,1,9,"circle",1),Co(2,k3,1,7,"circle",2),Ro()),2&e&&(is("width",t.diameter,"px")("height",t.diameter,"px"),Mo("ngSwitch","indeterminate"===t.mode),wo("viewBox",t._viewBox),yr(1),Mo("ngSwitchCase",!0),yr(1),Mo("ngSwitchCase",!1))},directives:[eh,th],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),S3),A3=((C3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:C3}),C3.\u0275inj=ve({factory:function(e){return new(e||C3)},imports:[[mx,sh],mx]}),C3);function R3(e,t){if(1&e){var n=zo();Ao(0,"button",3),Fo("click",(function(){return en(n),qo().onDownload()})),Ao(1,"mat-icon",14),ms(2,"save"),Ro(),Ro()}}function O3(e,t){1&e&&Oo(0,"mat-spinner",15),2&e&&Mo("diameter",36)}function N3(e,t){if(1&e){var n=zo();Ao(0,"mat-expansion-panel",20),Fo("opened",(function(){return en(n),qo(3).panelOpenState=!0}))("closed",(function(){return en(n),qo(3).panelOpenState=!1})),Ao(1,"mat-expansion-panel-header"),Oo(2,"mat-panel-title"),Ao(3,"mat-panel-description"),ms(4),Ro(),Ro(),Ao(5,"form",21,22),Fo("ngSubmit",(function(){return en(n),So(6).form.valid})),Ao(7,"label"),ms(8," SpaceName"),Ro(),Ao(9,"mat-form-field",23),Ao(10,"input",24,25),Fo("ngModelChange",(function(e){return en(n),t.$implicit.spaceName=e})),Ro(),Ro(),Ao(12,"label"),ms(13," Space Type"),Ro(),Ao(14,"mat-form-field",23),Ao(15,"input",26,27),Fo("ngModelChange",(function(e){return en(n),t.$implicit.spaceType=e})),Ro(),Ro(),Ao(17,"label"),ms(18," Space Capacity"),Ro(),Ao(19,"mat-form-field",23),Ao(20,"input",28,29),Fo("ngModelChange",(function(e){return en(n),t.$implicit.capacity=e})),Ro(),Ro(),Ro(),Ro()}if(2&e){var i=t.$implicit,r=qo(2).$implicit;yr(4),gs("",r.levelName," "),yr(6),Mo("ngModel",i.spaceName),yr(5),Mo("ngModel",i.spaceType),yr(5),Mo("ngModel",i.capacity)}}function D3(e,t){if(1&e&&(No(0),Ao(1,"mat-accordion"),Co(2,N3,22,4,"mat-expansion-panel",19),Ro(),Do()),2&e){var n=qo().$implicit;yr(2),Mo("ngForOf",n.subAccordion)}}function z3(e,t){if(1&e){var n=zo();Ao(0,"mat-expansion-panel",16),Fo("opened",(function(){return en(n),qo().panelOpenState=!0}))("closed",(function(){return en(n),qo().panelOpenState=!1})),Ao(1,"button",17),Fo("click",(function(e){en(n);var i=t.$implicit,r=t.index;return qo().deleteItem(e,i,r)})),Ao(2,"mat-icon"),ms(3,"cancel"),Ro(),Ro(),Ao(4,"mat-expansion-panel-header"),Ao(5,"mat-panel-title"),ms(6),Ro(),Ao(7,"mat-panel-description"),ms(8),Ro(),Ro(),Co(9,D3,3,1,"ng-container",18),Ro()}if(2&e){var i=t.$implicit,r=t.index;yr(6),vs(r+1),yr(2),vs(i.facilityName),yr(1),Mo("ngIf",i.subAccordion)}}function L3(e,t){if(1&e){var n=zo();Ao(0,"button",30),Fo("click",(function(){return en(n),qo().submitSpaces()})),ms(1,"Confirm Spaces & Submit"),Ro()}}var B3,F3,j3,H3,V3,U3,q3,G3,W3,Z3,X3,K3,Y3,J3,Q3,$3,e5,t5,n5,i5,r5,a5,o5,s5,l5,u5=((F3=function(){function e(t,n,i,r,a,o,s){var l=this;_classCallCheck(this,e),this.snackBar=t,this.http=n,this.route=i,this.siteonboarding=r,this.blobService=a,this.dialog=o,this.maplocationservice=s,this.isUserAllowedFurter=!0,this.markerLocations=[{lat:38.914764662971436,lng:-97.01461108304595},{lat:2,lng:2}],this.sampleGeojson={type:"FeatureCollection",features:[]},this.spacecentroid={type:"FeatureCollection",features:[]},this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.showupload=!1,this.facilityLocation=[],this.formpayload=[],this.drawToolitems=[],this.loader=!0,this.panelOpenState=!0,this.accordions=[],this.routeparams=this.route.snapshot.paramMap.get("id"),this.formelement=j2,this.maplocationservice.locateFacility.subscribe((function(e){l.facilityLocation=e})),this.maplocationservice.addlevelData.subscribe((function(e){l.Facility_Id=e[0].Facility_Id,l.Site_Id=e[0].Site_Id,l.Level_Id=e[0].levelId,l.levelName=e[0].levelName,l.formdata=e}))}return _createClass(e,[{key:"drop",value:function(e){J1(this.accordions,e.previousIndex,e.currentIndex)}},{key:"ngOnInit",value:function(){var e,t=this;this.getSpaces(),this.siteonboarding.obtainedLevelDetails.subscribe((function(e){e.forEach((function(n,i){n.levelId==t.formdata[0].levelId&&(t.Level_Id=e[i].levelId,t.levelName=e[i].levelName)}))})),this.siteonboarding.obtainedFacilityDetails.subscribe((function(e){e.forEach((function(n,i){n.facilityId==t.formdata[0].Facility_Id&&(t.facilityName=e[i].facilityName)}))})),this.siteonboarding.obtainedSiteDetails.subscribe((function(e){e.forEach((function(n,i){n.siteId==t.formdata[0].Site_Id&&(t.siteName=e[i].siteName)}))}));var n=null;n=new gL("createspace",{center:0==this.facilityLocation.length?[-24,42]:this.facilityLocation,zoom:0==this.facilityLocation.length?0:24,minZoom:2,pitch:6,layerSwitcherControl:{position:{top:"20",right:"750"},baseTitle:"Base Layers",overlayTitle:"Layers",repeatWorld:!1,excludeLayers:["vector"],containerClass:"maptalks-layer-switcher"},baseLayer:new vj("Base TileLayer",[new hj("Carto light",{visible:!0,repeatWorld:!1,urlTemplate:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]}),new hj("Satellite",{visible:!1,repeatWorld:!1,urlTemplate:"http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})])});var i=new _B("vector").setOptions({editable:!0}).addTo(n);this.siteonboarding.obtainedspaceDetails.subscribe((function(e){n.getLayers().forEach((function(e){e._geoList.forEach((function(t,n){"Marker"==t._jsonType&&t.options.id&&e._geoList[n].remove()}))})),e&&e.forEach((function(i,r){YL.toGeometry(i).setOptions({id:t.levelName}).addTo(n.getLayer("vector")).bringToFront().on("click",(function(t){i.properties.spaceId==t.target.properties.spaceId&&a.siteonboarding.saveAllDeviceDetails([e[r]]),a.opendialog()}))}))})),this.maplocationservice.polygongeojson.subscribe((function(e){n.getLayers().forEach((function(e){e._geoList.forEach((function(t,n){"Polygon"==t._jsonType&&e._geoList[n].remove()}))})),e[0]&&(t.loader=!1,e[0].features.forEach((function(e){i.addGeometry(e)})),0==e[0].features.lenght&&(t.showupload=!1))}));var r="";this.formdata.fileUrl&&!this.formdata[0].fileUrl.includes(".geojson")?(r=0==this.formdata.fileUrl.includes(".geojson")?this.formdata.fileUrl:"",this.geojsonLink="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(this.siteName,"/").concat(this.facilityName.replace(/\s+/g,""),"/").concat(this.levelName.replace(/\s+/g,""),"/geojson/").concat(this.levelName.replace(/\s+/g,"")+".geojson"),this.drawToolitems=["Point","LineString","Polygon","Circle","Ellipse","Rectangle","FreeHandLineString","FreeHandPolygon"]):this.formdata[0].fileUrl&&!this.formdata[0].fileUrl.includes(".geojson")?(r=0==this.formdata[0].fileUrl.includes(".geojson")?this.formdata[0].fileUrl:"",this.geojsonLink="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(this.siteName,"/").concat(this.facilityName.replace(/\s+/g,""),"/").concat(this.levelName.replace(/\s+/g,""),"/geojson/").concat(this.levelName.replace(/\s+/g,"")+".geojson"),this.drawToolitems=["Point","LineString","Polygon","Circle","Ellipse","Rectangle","FreeHandLineString","FreeHandPolygon"]):this.formdata[0].fileUrl.includes(".geojson")?(this.geojsonLink=this.formdata[0].fileUrl,this.drawToolitems=["Point"]):this.formdata[0].fileUrl.includes(".geojson")||(this.geojsonLink="https://storagesmartroute27.blob.core.windows.net/filesupload/".concat(this.siteName,"/").concat(this.facilityName.replace(/\s+/g,""),"/").concat(this.levelName.replace(/\s+/g,""),"/geojson/").concat(this.levelName.replace(/\s+/g,"")+".geojson"),this.drawToolitems=["Point"]),this.getpolygonsdata(),this.point=new LL(this.facilityLocation,{visible:!0,editable:!0,cursor:"pointer",draggable:!1,dragShadow:!1,drawOnAxis:null,symbol:{markerFile:r,markerWidth:200,markerHeight:100,markerDx:0,markerDy:0,markerOpacity:1},properties:{id:this.levelName}}),r&&new _B("customimage",this.point,{enableAltitude:!0}).addTo(n),n.on("zoomend ",(function(){(e=n.getZoom())>21?t.point.updateSymbol({markerWidth:400,markerHeight:300}):e<=21&&t.point.updateSymbol({markerWidth:10*e,markerHeight:5*e}),t.point.updateSymbol({markerWidth:10*e,markerHeight:5*e})}));var a=this,o=new kB({mode:"Point"}).addTo(n).disable();o.on("drawend",(function(e){var t=JSON.stringify(e.geometry.toGeoJSON()),n=JSON.parse(t);n.properties={spacename:"",levelId:a.Level_Id},a.selecteddrawToolOption=n.geometry.type,"Point"==n.geometry.type?(e.geometry.setOptions({id:a.levelName}),a.accordions.push({facilityName:a.facilityName,levelName:a.levelName,subAccordion:[{Facility_Id:a.Facility_Id,Level_Id:a.Level_Id,Site_Id:a.Site_Id,spaceName:"",spaceType:"",capacity:0,spacelocation:JSON.stringify(n)}]}),a.spacecentroid.features.push(n)):(a.showupload=!0,a.sampleGeojson.features.push(n)),i.addGeometry(e.geometry)})),n.getLayer("vector").bringToFront();var s=this.drawToolitems.map((function(e){return{item:e,click:function(){o.setMode(e).enable()}}}));new WF.Toolbar({items:[{item:"Shape",children:s},{item:"Disable",click:function(){o.disable()}},{item:"Clear",click:function(){"Point"==a.selecteddrawToolOption?(a.spacecentroid.features.splice(-1,1),a.accordions.splice(-1,1),a.siteonboarding.saveAllSpaceDetails(a.spacecentroid.features),a.accordions.splice(-1,1)):(a.sampleGeojson.features.splice(-1,1),a.maplocationservice.addpolygondata([a.sampleGeojson]))}}]}).addTo(n);var l=Oy(document,"keydown").pipe(Rp((function(e){return 27===e.keyCode})),Fy());this.subscription=l.subscribe((function(e){"keydown"===e.type&&o.disable()}))}},{key:"getpolygonsdata",value:function(){var e=this;this.loader=!0,this.http.get(String(this.geojsonLink)).subscribe((function(t){t&&(e.loader=!1,e.sampleGeojson.features=[],t.features.forEach((function(t){e.sampleGeojson.features.push(t)})),e.maplocationservice.addpolygondata([e.sampleGeojson]))}))}},{key:"getSpaces",value:function(){var e=this;this.siteonboarding.getAllSpaces().subscribe((function(t){if(t){var n=[];t.forEach((function(i,r){var a={};i.Level_Id==e.Level_Id&&(a.type="Feature",a.geometry=t[r].spacelocation,a.properties={spaceName:t[r].spaceName,spaceType:t[r].spaceType,spaceId:t[r].spaceId,Site_Id:t[r].Site_Id,Facility_Id:t[r].Facility_Id,Level_Id:t[r].Level_Id},n.push(a))})),e.siteonboarding.saveAllSpaceDetails(n)}}))}},{key:"deleteItem",value:function(e,t,n){this.accordions.splice(n-1,1)}},{key:"opendialog",value:function(){this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{right:"100px",top:"50px"}})}},{key:"fileUpload",value:function(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.facilityName+"/"+this.levelName+"/"+this.fileType+"/"+e.name,(function(){})),this.reloadImages())}},{key:"reloadImages",value:function(){var e=this;this.blobService.listImages(this.sas).then((function(t){t&&(e.snackBar.open("File/data saved successfully","close",{duration:3e3,verticalPosition:"top"}),e.getpolygonsdata())}))}},{key:"startEdit",value:function(){this.point.startEdit()}},{key:"endEdit",value:function(){this.point.endEdit()}},{key:"download",value:function(e,t,n){var i=document.createElement("a"),r=new Blob([e],{type:n});i.href=URL.createObjectURL(r),i.download=t,(new FormData).append("file",r),this.fileName=t,this.fileType=t.split(".")[1],this.fileName&&(this.blobService.uploadImage(this.sas,r,this.siteName+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+t,(function(){})),this.reloadImages())}},{key:"onDownload",value:function(){this.download(JSON.stringify(this.sampleGeojson),this.levelName.replace(/\s+/g,"")+".geojson","text/plain"),this.showupload=!0}},{key:"submitForm",value:function(e){var t=this;this.siteonboarding.addSpaces(e).subscribe((function(e){e.length>0?(t.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),t.accordions=[],t.getSpaces()):t.snackBar.open("Failed","retry",{duration:3e3,verticalPosition:"top"})}))}},{key:"submitSpaces",value:function(){var e=this;this.formpayload=[],this.accordions.forEach((function(t,n){t.subAccordion.forEach((function(t){e.formpayload.push(t),n==e.accordions.length-1&&e.submitForm(e.formpayload)}))}))}}]),e}()).\u0275fac=function(e){return new(e||F3)(To(nV),To(xw),To(Tv),To(LH),To(l0),To(zM),To(u0))},F3.\u0275cmp=yt({type:F3,selectors:[["app-create-spaces"]],decls:17,vars:4,consts:[[1,"row"],[1,"col-lg-12"],[1,"pane"],["mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["matTooltip","Start Edit"],["matTooltip","Done"],["mat-icon-button","","color","primary","aria-label","normal button",3,"click",4,"ngIf"],[1,"spinner-div"],["class","spinner","color","primary",3,"diameter",4,"ngIf"],["id","createspace"],[1,"accordian"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"opened","closed",4,"ngFor","ngForOf"],["type","button","class","confirm-button","id","left-panel-link",3,"click",4,"ngIf"],["matTooltip","Save"],["color","primary",1,"spinner",3,"diameter"],["cdkDrag","",3,"opened","closed"],["mat-icon-button","","color","gray","aria-label","normal button",1,"icon-button-small",3,"click"],[4,"ngIf"],[3,"opened","closed",4,"ngFor","ngForOf"],[3,"opened","closed"],["name","form",3,"ngSubmit"],["f","ngForm"],["appearance","outline"],["matInput","","type","text","name","spaceName","required","",1,"form-control",3,"ngModel","ngModelChange"],["spaceName","ngModel"],["matInput","","type","text","name","SpaceType","required","",1,"form-control",3,"ngModel","ngModelChange"],["SpaceType","ngModel"],["matInput","","type","text","name","Capacity","required","",1,"form-control",3,"ngModel","ngModelChange"],["Capacity","ngModel"],["type","button","id","left-panel-link",1,"confirm-button",3,"click"]],template:function(e,t){1&e&&(Ao(0,"div",0),Ao(1,"div",1),Ao(2,"div",2),Ao(3,"button",3),Fo("click",(function(){return t.startEdit()})),Ao(4,"mat-icon",4),ms(5,"edit"),Ro(),Ro(),Ao(6,"button",3),Fo("click",(function(){return t.endEdit()})),Ao(7,"mat-icon",5),ms(8,"done_all"),Ro(),Ro(),Co(9,R3,3,0,"button",6),Ro(),Ao(10,"div",7),Co(11,O3,1,1,"mat-spinner",8),Ro(),Oo(12,"div",9),Ao(13,"div",10),Ao(14,"mat-accordion",11),Fo("cdkDropListDropped",(function(e){return t.drop(e)})),Co(15,z3,10,3,"mat-expansion-panel",12),Ro(),Co(16,L3,2,0,"button",13),Ro(),Ro(),Ro()),2&e&&(yr(9),Mo("ngIf",t.showupload),yr(2),Mo("ngIf",t.loader),yr(4),Mo("ngForOf",t.accordions),yr(1),Mo("ngIf",t.accordions.length>0))},directives:[FT,nk,RT,Fc,g3,P2,Lc,I3,f3,b2,p3,v3,m3,HC,_k,RC,LP,UP,uk,GC,yk,jC],styles:["#createspace[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}.spinner-div[_ngcontent-%COMP%]{z-index:100000;top:50%;bottom:50%;position:absolute}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]{width:80px;height:80px;line-height:80px}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;line-height:48px}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]   .mat-button-ripple[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]{position:absolute;top:0;right:5px;width:24px;height:24px;line-height:24px}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]   .mat-button-ripple[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}.pane[_ngcontent-%COMP%]{background:none;line-height:28px;color:#fff;z-index:10;position:absolute;top:30px;left:30px;display:flex}.pane[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;color:#fff;text-align:left;padding:0 10px;min-width:28px;min-height:28px;float:left}.mat-form-field[_ngcontent-%COMP%]{width:100%}.maptalks-toolbar-horizonal[_ngcontent-%COMP%], div[_ngcontent-%COMP%]{margin:-20px!important}.image-upload[_ngcontent-%COMP%]{position:absolute;top:20px;right:100px;z-index:100}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.accordian[_ngcontent-%COMP%]{background:none;line-height:28px;color:#fff;z-index:10;position:absolute;justify-content:center;min-width:250px;max-width:300px;min-height:450px;max-height:500px;overflow-y:auto;overflow-x:hidden;top:100px;left:20px}.card-footer[_ngcontent-%COMP%]{margin:10px;height:10vh}.confirm-button[_ngcontent-%COMP%]{background-color:#0046ad;padding:6px;border-radius:5px;border:none;color:#fff;min-height:45%;cursor:pointer;width:94%;margin:4px 5px 0;font-size:.8rem;font-weight:400}"]}),F3),c5=((B3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:B3}),B3.\u0275inj=ve({factory:function(e){return new(e||B3)},imports:[[mx,ib],mx]}),B3),h5=new qe("mat-chips-default-options"),d5={separatorKeyCodes:[13]},f5=((H3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:H3}),H3.\u0275inj=ve({factory:function(e){return new(e||H3)},providers:[Bx,{provide:h5,useValue:d5}]}),H3),p5=((j3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:j3}),j3.\u0275inj=ve({factory:function(e){return new(e||j3)},imports:[[Xx,mx],Xx,mx]}),j3),m5={provide:new qe("mat-menu-scroll-strategy"),deps:[aT],useFactory:function(e){return function(){return e.scrollStrategies.reposition()}}},v5=((q3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:q3}),q3.\u0275inj=ve({factory:function(e){return new(e||q3)},providers:[m5],imports:[mx]}),q3),g5=((U3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:U3}),U3.\u0275inj=ve({factory:function(e){return new(e||U3)},providers:[m5],imports:[[sh,mx,ib,hT,v5],p_,mx,v5]}),U3),y5=((V3=_createClass((function e(){_classCallCheck(this,e),this.changes=new I,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=function(e,t,n){if(0==n||0==t)return"0 of "+n;var i=e*t;return"".concat(i+1," \u2013 ").concat(i<(n=Math.max(n,0))?Math.min(i+t,n):i+t," of ").concat(n)}}))).\u0275fac=function(e){return new(e||V3)},V3.\u0275prov=me({factory:function(){return new V3},token:V3,providedIn:"root"}),V3),_5={provide:y5,deps:[[new ue,new he,y5]],useFactory:function(e){return e||new y5}},x5=((Y3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Y3}),Y3.\u0275inj=ve({factory:function(e){return new(e||Y3)},providers:[_5],imports:[[sh,jT,pM,NT]]}),Y3),b5=((K3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:K3}),K3.\u0275inj=ve({factory:function(e){return new(e||K3)},imports:[[sh,mx],mx]}),K3),w5=((X3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:X3}),X3.\u0275inj=ve({factory:function(e){return new(e||X3)},imports:[[sh,mx],mx]}),X3),k5=((Z3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Z3}),Z3.\u0275inj=ve({factory:function(e){return new(e||Z3)}}),Z3),C5=((W3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:W3}),W3.\u0275inj=ve({factory:function(e){return new(e||W3)},imports:[[k5,ib,mx,P_],k5,mx]}),W3),S5=((G3=_createClass((function e(){_classCallCheck(this,e),this.changes=new I,this.sortButtonLabel=function(e){return"Change sorting for "+e}}))).\u0275fac=function(e){return new(e||G3)},G3.\u0275prov=me({factory:function(){return new G3},token:G3,providedIn:"root"}),G3),T5={provide:S5,deps:[[new ue,new he,S5]],useFactory:function(e){return e||new S5}},E5=((n5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:n5}),n5.\u0275inj=ve({factory:function(e){return new(e||n5)},providers:[T5],imports:[[sh]]}),n5),P5=((t5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:t5}),t5.\u0275inj=ve({factory:function(e){return new(e||t5)}}),t5),M5=((e5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:e5}),e5.\u0275inj=ve({factory:function(e){return new(e||e5)},imports:[[P5,mx],mx]}),e5),I5=(($3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:$3}),$3.\u0275inj=ve({factory:function(e){return new(e||$3)},imports:[[mx],mx]}),$3),A5=((Q3=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:Q3}),Q3.\u0275inj=ve({factory:function(e){return new(e||Q3)},imports:[[l_]]}),Q3),R5=((J3=_createClass((function e(){_classCallCheck(this,e),this.changes=new I,this.optionalLabel="Optional"}))).\u0275fac=function(e){return new(e||J3)},J3.\u0275prov=me({factory:function(){return new J3},token:J3,providedIn:"root"}),J3),O5={provide:R5,deps:[[new ue,new he,R5]],useFactory:function(e){return e||new R5}},N5=((o5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:o5}),o5.\u0275inj=ve({factory:function(e){return new(e||o5)},providers:[O5,Bx],imports:[[mx,sh,wS,jT,A5,ik,ib],mx]}),o5),D5=((a5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:a5}),a5.\u0275inj=ve({factory:function(e){return new(e||a5)},imports:[[ox,mx],mx]}),a5),z5=((r5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:r5}),r5.\u0275inj=ve({factory:function(e){return new(e||r5)},imports:[[hT,mx,wS],mx]}),r5),L5=((i5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:i5}),i5.\u0275inj=ve({factory:function(e){return new(e||i5)},imports:[vM,jT,z5,c5,GP,UM,f5,M5,jM,LM,_3,BP,p5,ik,qP,oS,g5,x5,b5,A3,HM,ib,pM,D5,Wb,C5,w5,eV,E5,N5,UE,I5,NT,Lx,P5,ox,l_,G2,P_,hT,wy,wS,M2]}),i5),B5=[{path:"maptool/:id",component:E1},{path:"createspaces/:id",component:u5}],F5=((s5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:s5}),s5.\u0275inj=ve({factory:function(e){return new(e||s5)},imports:[[ry.forRoot(B5),sh,qh,xp,ZC,L5]]}),s5),j5=[{path:"map",component:y1},{path:"Occupancy",component:_1},{path:"PM",component:x1},{path:"maptool/:id",component:k1},{path:"",component:y1}],H5=((l5=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=wt({type:l5,bootstrap:[QM]}),l5.\u0275inj=ve({factory:function(e){return new(e||l5)},imports:[[ry.forRoot(j5),qh,Dw,xp,Wb,oS,ik,UE,GP,LM,NT,jT,qP,pM,BP,jM,HM,UM,vM,F5]]}),l5);(function(){if(Ti)throw new Error("Cannot enable prod mode after platform setup.");Si=!1})(),Vh().bootstrapModule(H5).catch((function(e){return console.error(e)}))},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[1,0]]]);