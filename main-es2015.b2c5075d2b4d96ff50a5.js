(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+qE3":function(e,t,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,s),n(i)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}_(e,t,s,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&_(e,"error",t,{once:!0})}(e,r)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var r,s,o;if(c(i),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),s=e._events),o=s[t]),void 0===o)o=s[t]=i,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=h(e))>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=d.bind(n);return r.listener=i,n.wrapFn=r,r}function m(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):g(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function _(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){n.once&&e.removeEventListener(t,r),i(s)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return h(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)s(l,this,t);else{var c=l.length,h=g(l,c);for(i=0;i<c;++i)s(h[i],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var i,n,r,s,o;if(c(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return m(this,e,!0)},a.prototype.rawListeners=function(e){return m(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},"/5w7":function(e,t,i){"use strict";e.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},"/t/I":function(e,t){!function(t){"use strict";var i,n,r="fulfilled",s="undefined",o=function(){var e=[],i=0;function r(){for(;e.length-i;){try{e[i]()}catch(r){t.console&&t.console.error(r)}e[i++]=n,1024==i&&(e.splice(0,1024),i=0)}}var o=function(){if(typeof MutationObserver===s)return typeof process!==s&&"function"==typeof process.nextTick?function(){process.nextTick(r)}:typeof setImmediate!==s?function(){setImmediate(r)}:function(){setTimeout(r,0)};var e=document.createElement("div");return new MutationObserver(r).observe(e,{attributes:!0}),function(){e.setAttribute("a",0)}}();return function(t){e.push(t),e.length-i==1&&o()}}();function a(e){if(!(this instanceof a))throw new TypeError("Zousan must be created with the new keyword");if("function"==typeof e){var t=this;try{e((function(e){t.resolve(e)}),(function(e){t.reject(e)}))}catch(e){t.reject(e)}}else if(0<arguments.length)throw new TypeError("Zousan resolver "+e+" is not a function")}function l(e,t){if("function"==typeof e.y)try{var i=e.y.call(n,t);e.p.resolve(i)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function c(e,t){if("function"==typeof e.n)try{var i=e.n.call(n,t);e.p.resolve(i)}catch(t){e.p.reject(t)}else e.p.reject(t)}a.prototype={resolve:function(e){if(this.state===i){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var t=this;if(e&&("function"==typeof e||"object"==typeof e))try{var n=!0,s=e.then;if("function"==typeof s)return void s.call(e,(function(e){n&&(n=!1,t.resolve(e))}),(function(e){n&&(n=!1,t.reject(e))}))}catch(s){return void(n&&this.reject(s))}this.state=r,this.v=e,t.c&&o((function(){for(var i=0,n=t.c.length;i<n;i++)l(t.c[i],e)}))}},reject:function(e){if(this.state===i){var n=this;this.state="rejected",this.v=e;var r=this.c;o(r?function(){for(var t=0,i=r.length;t<i;t++)c(r[t],e)}:function(){n.handled||!a.suppressUncaughtRejectionError&&t.console&&a.warn("You upset Zousan. Please catch rejections: ",e,e?e.stack:null)})}},then:function(e,t){var n=new a,s={y:e,n:t,p:n};if(this.state===i)this.c?this.c.push(s):this.c=[s];else{var h=this.state,u=this.v;this.handled=!0,o((function(){h===r?l(s,u):c(s,u)}))}return n},catch:function(e){return this.then(null,e)},finally:function(e){return this.then(e,e)},timeout:function(e,t){t=t||"Timeout";var i=this;return new a((function(n,r){setTimeout((function(){r(Error(t))}),e),i.then((function(e){n(e)}),(function(e){r(e)}))}))}},a.resolve=function(e){var t=new a;return t.resolve(e),t},a.reject=function(e){var t=new a;return t.c=[],t.reject(e),t},a.all=function(e){var t=[],i=0,n=new a;function r(r,s){r&&"function"==typeof r.then||(r=a.resolve(r)),r.then((function(r){t[s]=r,++i==e.length&&n.resolve(t)}),(function(e){n.reject(e)}))}for(var s=0;s<e.length;s++)r(e[s],s);return e.length||n.resolve(t),n},a.warn=console.warn,typeof e!=s&&e.exports&&(e.exports=a),t.define&&t.define.amd&&t.define([],(function(){return a})),(t.Zousan=a).soon=o}("undefined"!=typeof global?global:this)},0:function(e,t){},"0KjW":function(e,t,i){"use strict";var n=i("KXza");e.exports=n},1:function(e,t,i){e.exports=i("zUnb")},"2+Hy":function(e,t,i){"use strict";var n=i("YI60"),r=i("U6jy"),s=i("uhBA"),o=i("d0rS"),a=i("jLWS"),l=1;function c(e,t){if(!e)throw new Error("MapiRequest requires a client");if(!t||!t.path||!t.method)throw new Error("MapiRequest requires an options object with path and method properties");var i={};t.body&&(i["content-type"]="application/json");var n=r(i,t.headers),o=Object.keys(n).reduce((function(e,t){return e[t.toLowerCase()]=n[t],e}),{});this.id=l++,this._options=t,this.emitter=new s,this.client=e,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=t.path,this.method=t.method,this.origin=t.origin||e.origin,this.query=t.query||{},this.params=t.params||{},this.body=t.body||null,this.file=t.file||null,this.encoding=t.encoding||"utf8",this.sendFileAs=t.sendFileAs||null,this.headers=o}c.prototype.url=function(e){var t=o.prependOrigin(this.path,this.origin);t=o.appendQueryObject(t,this.query);var i=this.params,s=null==e?this.client.accessToken:e;if(s){t=o.appendQueryParam(t,"access_token",s);var a=n(s).user;i=r({ownerId:a},i)}return o.interpolateRouteParams(t,i)},c.prototype.send=function(){var e=this;if(e.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return e.sent=!0,e.client.sendRequest(e).then((function(t){return e.response=t,e.emitter.emit(a.EVENT_RESPONSE,t),t}),(function(t){throw e.error=t,e.emitter.emit(a.EVENT_ERROR,t),t}))},c.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},c.prototype.eachPage=function(e){var t=this;function i(i){e(null,i,(function(){delete t._nextPageRequest;var e=i.nextPage();e&&(t._nextPageRequest=e,r(e))}))}function n(t){e(t,null,(function(){}))}function r(e){e.send().then(i,n)}r(this)},c.prototype.clone=function(){return this._extend()},c.prototype._extend=function(e){var t=r(this._options,e);return new c(this.client,t)},e.exports=c},"4ZJM":function(e,t,i){e.exports=function(){"use strict";var e,t,i;function n(n,r){if(e)if(t){var s="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",o={};e(o),i=r(o),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"})))}else t=r;else e=r}return n(0,(function(e){var t="undefined"!=typeof self?self:{},i="2.15.0";let n;const r={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==n){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{n=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):e}catch(t){n=e}}return n},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!r.API_URL)return null;try{const e=new URL(r.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},s={supported:!1,testSupport:function(e){!l&&a&&(c?h(e):o=e)}};let o,a,l=!1,c=!1;function h(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.isContextLost())return;s.supported=!0}catch(e){}e.deleteTexture(t),l=!0}t.document&&(a=t.document.createElement("img"),a.onload=function(){o&&h(o),o=null,c=!0},a.onerror=function(){l=!0,o=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const u="01";function d(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var p=m;function m(e,t,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=i,this.p2y=n}m.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,n=0;n<8;n++){var r=this.sampleCurveX(i)-e;if(Math.abs(r)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=r/s}var o=0,a=1;for(i=e,n=0;n<20&&(r=this.sampleCurveX(i),!(Math.abs(r-e)<t));n++)e>r?o=i:a=i,i=.5*(a-o)+o;return i},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var f=d(p),g=_;function _(e,t){this.x=e,this.y=t}_.prototype={clone:function(){return new _(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),n=Math.sin(e),r=t.y+n*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-n*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_.convert=function(e){return e instanceof _?e:Array.isArray(e)?new _(e[0],e[1]):e};var y=d(g);const v=Math.PI/180,x=180/Math.PI;function b(e){return e*v}function w(e){return e*x}const C=[[0,0],[1,0],[1,1],[0,1]];function S(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function E(e,t,i,n){const r=new f(e,t,i,n);return function(e){return r.solve(e)}}const T=E(.25,.1,.25,1);function P(e,t,i){return Math.min(i,Math.max(t,e))}function M(e,t,i){return(i=P((i-e)/(t-e),0,1))*i*(3-2*i)}function k(e,t,i){const n=i-t,r=((e-t)%n+n)%n+t;return r===t?i:r}function A(e,t,i){if(!e.length)return i(null,[]);let n=e.length;const r=new Array(e.length);let s=null;e.forEach((e,o)=>{t(e,(e,t)=>{e&&(s=e),r[o]=t,0==--n&&i(s,r)})})}function I(e){const t=[];for(const i in e)t.push(e[i]);return t}function R(e,...t){for(const i of t)for(const t in i)e[t]=i[t];return e}let O=1;function N(){return O++}function D(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function z(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function L(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function B(e,t){e.forEach(e=>{t[e]&&(t[e]=t[e].bind(t))})}function F(e,t){return-1!==e.indexOf(t,e.length-t.length)}function j(e,t,i){const n={};for(const r in e)n[r]=t.call(i||this,e[r],r,e);return n}function V(e,t,i){const n={};for(const r in e)t.call(i||this,e[r],r,e)&&(n[r]=e[r]);return n}function U(e){return Array.isArray(e)?e.map(U):"object"==typeof e&&e?j(e,U):e}const q={};function H(e){q[e]||("undefined"!=typeof console&&console.warn(e),q[e]=!0)}function G(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function W(e){let t=0;for(let i,n,r=0,s=e.length,o=s-1;r<s;o=r++)i=e[r],n=e[o],t+=(n.x-i.x)*(i.y+n.y);return t}function Z(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function $(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(e,i,n,r)=>{const s=n||r;return t[i]=!s||s.toLowerCase(),""}),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let X=null;function K(e){if(null==X){const t=e.navigator?e.navigator.userAgent:null;X=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return X}function Y(e){try{const i=t[e];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function J(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}const Q="mapbox-tiles";let ee,te,ie=500,ne=50;function re(){try{return t.caches}catch(e){}}function se(){re()&&!ee&&(ee=t.caches.open(Q))}function oe(e){const t=e.indexOf("?");if(t<0)return e;const i=function(e){const t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}(e).filter(e=>{const t=e.split("=");return"language"===t[0]||"worldview"===t[0]});return i.length?`${e.slice(0,t)}?${i.join("&")}`:e.slice(0,t)}let ae=1/0;const le={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(le);class ce extends Error{constructor(e,t,i){401===t&&xe(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=i}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const he=Z()?()=>self.worker&&self.worker.referrer:()=>("blob:"===t.location.protocol?t.parent:t).location.href,ue=function(e,i){if(!(/^file:/.test(n=e.url)||/^file:/.test(he())&&!/^\w+:/.test(n))){if(t.fetch&&t.Request&&t.AbortController&&t.Request.prototype.hasOwnProperty("signal"))return function(e,i){const n=new t.AbortController,r=new t.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:he(),referrerPolicy:e.referrerPolicy,signal:n.signal});let s=!1,o=!1;const a=(l=r.url).indexOf("sku=")>0&&xe(l);var l;"json"===e.type&&r.headers.set("Accept","application/json");const c=(n,s,l)=>{if(o)return;if(n&&"SecurityError"!==n.message&&H(n.toString()),s&&l)return h(s);const c=Date.now();t.fetch(r).then(t=>{if(t.ok){const e=a?t.clone():null;return h(t,e,c)}return i(new ce(t.statusText,t.status,e.url))}).catch(t=>{"AbortError"!==t.name&&i(new Error(`${t.message} ${e.url}`))})},h=(n,a,l)=>{("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then(e=>{o||(a&&l&&function(e,i,n){if(se(),!ee)return;const r={status:i.status,statusText:i.statusText,headers:new t.Headers};i.headers.forEach((e,t)=>r.headers.set(t,e));const s=$(i.headers.get("Cache-Control")||"");if(s["no-store"])return;s["max-age"]&&r.headers.set("Expires",new Date(n+1e3*s["max-age"]).toUTCString());const o=r.headers.get("Expires");o&&(new Date(o).getTime()-n<42e4||function(e,t){if(void 0===te)try{new Response(new ReadableStream),te=!0}catch(e){te=!1}te?t(e.body):e.blob().then(t)}(i,i=>{const n=new t.Response(i,r);se(),ee&&ee.then(t=>t.put(oe(e.url),n)).catch(e=>H(e.message))}))}(r,a,l),s=!0,i(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))}).catch(e=>{o||i(new Error(e.message))})};return a?function(e,t){if(se(),!ee)return t(null);const i=oe(e.url);ee.then(e=>{e.match(i).then(n=>{const r=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),i=$(e.headers.get("Cache-Control")||"");return t>Date.now()&&!i["no-cache"]}(n);e.delete(i),r&&e.put(i,n.clone()),t(null,n,r)}).catch(t)}).catch(t)}(r,c):c(null,null),{cancel:()=>{o=!0,s||n.abort()}}}(e,i);if(Z()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,i,void 0,!0)}var n;return function(e,i){const n=new t.XMLHttpRequest;n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer");for(const t in e.headers)n.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=()=>{i(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let t=n.response;if("json"===e.type)try{t=JSON.parse(n.response)}catch(e){return i(e)}i(null,t,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else i(new ce(n.statusText,n.status,e.url))},n.send(e.body),{cancel:()=>n.abort()}}(e,i)},de=function(e,t){return ue(R(e,{type:"arrayBuffer"}),t)};function pe(e){const i=t.document.createElement("a");return i.href=e,i.protocol===t.document.location.protocol&&i.host===t.document.location.host}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fe,ge;fe=[],ge=0;const _e=function(e,i){if(s.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ge>=r.MAX_PARALLEL_IMAGE_REQUESTS){const t={requestParameters:e,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return fe.push(t),t}ge++;let n=!1;const o=()=>{if(!n)for(n=!0,ge--;fe.length&&ge<r.MAX_PARALLEL_IMAGE_REQUESTS;){const e=fe.shift(),{requestParameters:t,callback:i,cancelled:n}=e;n||(e.cancel=_e(t,i).cancel)}},a=de(e,(e,n,r,s)=>{o(),e?i(e):n&&(t.createImageBitmap?function(e,i){const n=new t.Blob([new Uint8Array(e)],{type:"image/png"});t.createImageBitmap(n).then(e=>{i(null,e)}).catch(e=>{i(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(n,(e,t)=>i(e,t,r,s)):function(e,i){const n=new t.Image,r=t.URL;n.onload=()=>{i(null,n),r.revokeObjectURL(n.src),n.onload=null,t.requestAnimationFrame(()=>{n.src=me})},n.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const s=new t.Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?r.createObjectURL(s):me}(n,(e,t)=>i(e,t,r,s)))});return{cancel:()=>{a.cancel(),o()}}},ye="NO_ACCESS_TOKEN";function ve(e){return 0===e.indexOf("mapbox:")}function xe(e){return r.API_URL_REGEX.test(e)}function be(e){return r.API_CDN_URL_REGEX.test(e)}function we(e){return r.API_STYLE_REGEX.test(e)&&!Ce(e)}function Ce(e){return r.API_SPRITE_REGEX.test(e)}const Se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ee(e){const t=e.match(Se);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Te(e){const t=e.params.length?"?"+e.params.join("&"):"";return`${e.protocol}://${e.authority}${e.path}${t}`}const Pe="mapbox.eventData";function Me(e){if(!e)return null;const i=e.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(t.atob(i[1]).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(e){return null}}class ke{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Me(r.ACCESS_TOKEN);let n="";return n=i&&i.u?t.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode(Number("0x"+t)))):r.ACCESS_TOKEN||"",e?`${Pe}.${e}:${n}`:`${Pe}:${n}`}fetchEventData(){const e=Y("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const e=t.localStorage.getItem(i);e&&(this.eventData=JSON.parse(e));const r=t.localStorage.getItem(n);r&&(this.anonId=r)}catch(e){H("Unable to read from LocalStorage")}}saveEventData(){const e=Y("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{t.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&t.localStorage.setItem(i,JSON.stringify(this.eventData))}catch(e){H("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,t,i,n){if(!r.EVENTS_URL)return;const s=Ee(r.EVENTS_URL);s.params.push("access_token="+(n||r.ACCESS_TOKEN||""));const o={event:this.type,created:new Date(e).toISOString()},a=t?R(o,t):o,l={url:Te(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(e,t){return ue(R(e,{method:"POST"}),t)}(l,e=>{this.pendingRequest=null,i(e),this.saveEventData(),this.processRequests(n)})}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const Ae=new class extends ke{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){r.EVENTS_URL&&r.ACCESS_TOKEN&&Array.isArray(e)&&e.some(e=>ve(e)||xe(e))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Me(r.ACCESS_TOKEN),n=t?t.u:r.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;L(this.anonId)||(this.anonId=D(),s=!0);const o=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(o),i=(o-this.eventData.lastSuccess)/864e5;s=s||i>=1||i<-1||e.getDate()!==t.getDate()}else s=!0;s?this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:i,skuId:u,"enabled.telemetry":!1,userId:this.anonId},e=>{e||(this.eventData.lastSuccess=o,this.eventData.tokenU=n)},e):this.processRequests()}},Ie=Ae.postTurnstileEvent.bind(Ae),Re=new class extends ke{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,i,n){this.skuToken=t,this.errorCb=n,r.EVENTS_URL&&(i||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ye)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=D()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:i,skuId:u,skuToken:this.skuToken,userId:this.anonId},e=>{e?this.errorCb(e):t&&(this.success[t]=!0)},e))}},Oe=Re.postMapLoadEvent.bind(Re),Ne=new class extends ke{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){r.EVENTS_URL&&(e||r.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:n,performanceData:r}=this.queue.shift(),s=function(e){const n=t.performance.getEntriesByType("resource"),r=t.performance.getEntriesByType("mark"),s=function(e){const t={};if(e)for(const i in e)if("other"!==i)for(const n of e[i]){const e=i+"ResolveRangeMin",r=i+"ResolveRangeMax",s=i+"RequestCount",o=i+"RequestCachedCount";t[e]=Math.min(t[e]||1/0,n.startTime),t[r]=Math.max(t[r]||-1/0,n.responseEnd);const a=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==n.transferSize&&0===n.transferSize&&a(o),a(s)}return t}(function(e,t){const i={};if(e)for(const n of e){const e=t(n);void 0===i[e]&&(i[e]=[]),i[e].push(n)}return i}(n,Ve)),o=t.devicePixelRatio,a=t.navigator.connection||t.navigator.mozConnection||t.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},c=(e,t,i)=>{null!=i&&e.push({name:t,value:i.toString()})};for(const t in s)c(l.counters,t,s[t]);if(e.interactionRange[0]!==1/0&&e.interactionRange[1]!==-1/0&&(c(l.counters,"interactionRangeMin",e.interactionRange[0]),c(l.counters,"interactionRangeMax",e.interactionRange[1])),r)for(const t of Object.keys(Fe)){const e=Fe[t],i=r.find(t=>t.name===e);i&&c(l.counters,e,i.startTime)}return c(l.counters,"visibilityHidden",e.visibilityHidden),c(l.attributes,"style",function(e){if(e)for(const t of e){const e=t.name.split("?")[0];if(we(e)){const t=e.split("/").slice(-2);if(2===t.length)return`mapbox://styles/${t[0]}/${t[1]}`}}}(n)),c(l.attributes,"terrainEnabled",e.terrainEnabled?"true":"false"),c(l.attributes,"fogEnabled",e.fogEnabled?"true":"false"),c(l.attributes,"projection",e.projection),c(l.attributes,"zoom",e.zoom),c(l.metadata,"devicePixelRatio",o),c(l.metadata,"connectionEffectiveType",a?a.effectiveType:void 0),c(l.metadata,"navigatorUserAgent",t.navigator.userAgent),c(l.metadata,"screenWidth",t.screen.width),c(l.metadata,"screenHeight",t.screen.height),c(l.metadata,"windowWidth",t.innerWidth),c(l.metadata,"windowHeight",t.innerHeight),c(l.metadata,"mapWidth",e.width/o),c(l.metadata,"mapHeight",e.height/o),c(l.metadata,"webglRenderer",e.renderer),c(l.metadata,"webglVendor",e.vendor),c(l.metadata,"sdkVersion",i),c(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(r);for(const t of s.metadata);for(const t of s.counters);for(const t of s.attributes);this.postEvent(n,s,()=>{},e)}},De=Ne.postPerformanceEvent.bind(Ne),ze=new class extends ke{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,i,n){if(!r.API_URL||!r.SESSION_PATH)return;const s=Ee(r.API_URL+r.SESSION_PATH);s.params.push("sku="+(t||"")),s.params.push("access_token="+(n||r.ACCESS_TOKEN||""));const o={url:Te(s),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(e,t){return ue(R(e,{method:"GET"}),t)}(o,e=>{this.pendingRequest=null,i(e),this.saveEventData(),this.processRequests(n)})}getSessionAPI(e,t,i,n){this.skuToken=t,this.errorCb=n,r.SESSION_PATH&&r.API_URL&&(i||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ye)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,e=>{e?this.errorCb(e):t&&(this.success[t]=!0)},e)}},Le=ze.getSessionAPI.bind(ze),Be=new Set,Fe={create:"create",load:"load",fullLoad:"fullLoad"},je={mark(e){t.performance.mark(e)},measure(e,i,n){t.performance.measure(e,i,n)}};function Ve(e){const t=e.name.split("?")[0];return be(t)&&t.includes("mapbox-gl.js")?"javascript":be(t)&&t.includes("mapbox-gl.css")?"css":function(e){return r.API_FONTS_REGEX.test(e)}(t)?"fontRange":Ce(t)?"sprite":we(t)?"style":function(e){return r.API_TILEJSON_REGEX.test(e)}(t)?"tilejson":"other"}const Ue=t.performance;function qe(e){const t=e?e.url.toString():void 0;return Ue.getEntriesByName(t)}let He,Ge,We,Ze;const $e={now:()=>void 0!==We?We:t.performance.now(),setNow(e){We=e},restoreNow(){We=void 0},frame(e){const i=t.requestAnimationFrame(e);return{cancel:()=>t.cancelAnimationFrame(i)}},getImageData(e,i=0){const{width:n,height:r}=e;Ze||(Ze=t.document.createElement("canvas"));const s=Ze.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return(n>Ze.width||r>Ze.height)&&(Ze.width=n,Ze.height=r),s.clearRect(-i,-i,n+2*i,r+2*i),s.drawImage(e,0,0,n,r),s.getImageData(-i,-i,n+2*i,r+2*i)},resolveURL:e=>(He||(He=t.document.createElement("a")),He.href=e,He.href),get devicePixelRatio(){return t.devicePixelRatio},get prefersReducedMotion(){return!!t.matchMedia&&(null==Ge&&(Ge=t.matchMedia("(prefers-reduced-motion: reduce)")),Ge.matches)}};function Xe(e,t,i){i[e]&&-1!==i[e].indexOf(t)||(i[e]=i[e]||[],i[e].push(t))}function Ke(e,t,i){if(i&&i[e]){const n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}class Ye{constructor(e,t={}){R(this,t),this.type=e}}class Je extends Ye{constructor(e,t={}){super("error",R({error:e},t))}}class Qe{on(e,t){return this._listeners=this._listeners||{},Xe(e,t,this._listeners),this}off(e,t){return Ke(e,t,this._listeners),Ke(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Xe(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t))}fire(e,t){"string"==typeof e&&(e=new Ye(e,t||{}));const i=e.type;if(this.listens(i)){e.target=this;const t=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of t)i.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const s of n)Ke(i,s,this._oneTimeListeners),s.call(this,e);const r=this._eventedParent;r&&(R(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(e))}else e instanceof Je&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function tt(e,...t){for(const i of t)for(const t in i)e[t]=i[t];return e}function it(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nt(e){if(Array.isArray(e))return e.map(nt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const i in e)t[i]=nt(e[i]);return t}return it(e)}class rt extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}var st=rt;class ot{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[i,n]of t)this.bindings[i]=n}concat(e){return new ot(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var at=ot;const lt={kind:"null"},ct={kind:"number"},ht={kind:"string"},ut={kind:"boolean"},dt={kind:"color"},pt={kind:"object"},mt={kind:"value"},ft={kind:"collator"},gt={kind:"formatted"},_t={kind:"resolvedImage"};function yt(e,t){return{kind:"array",itemType:e,N:t}}function vt(e){if("array"===e.kind){const t=vt(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const xt=[lt,ct,ht,ut,dt,gt,pt,yt(mt),_t];function bt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!bt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of xt)if(!bt(e,t))return null}return`Expected ${vt(e)} but found ${vt(t)} instead.`}function wt(e,t){return t.some(t=>t.kind===e.kind)}function Ct(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}var St,Et={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tt(e){return(e=Math.round(e))<0?0:e>255?255:e}function Pt(e){return Tt("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function Mt(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function kt(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{St={}.parseCSSColor=function(e){var t,i=e.replace(/ /g,"").toLowerCase();if(i in Et)return Et[i].slice();if("#"===i[0])return 4===i.length?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===i.length&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=i.indexOf("("),r=i.indexOf(")");if(-1!==n&&r+1===i.length){var s=i.substr(0,n),o=i.substr(n+1,r-(n+1)).split(","),a=1;switch(s){case"rgba":if(4!==o.length)return null;a=Mt(o.pop());case"rgb":return 3!==o.length?null:[Pt(o[0]),Pt(o[1]),Pt(o[2]),a];case"hsla":if(4!==o.length)return null;a=Mt(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,c=Mt(o[1]),h=Mt(o[2]),u=h<=.5?h*(c+1):h+c-h*c,d=2*h-u;return[Tt(255*kt(d,u,l+1/3)),Tt(255*kt(d,u,l)),Tt(255*kt(d,u,l-1/3)),a];default:return null}}return null}}catch(e){}class At{constructor(e,t,i,n=1){this.r=e,this.g=t,this.b=i,this.a=n}static parse(e){if(!e)return;if(e instanceof At)return e;if("string"!=typeof e)return;const t=St(e);return t?new At(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,i,n]=this.toArray();return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(i)},${n})`}toArray(){const{r:e,g:t,b:i,a:n}=this;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*i/n,n]}toArray01(){const{r:e,g:t,b:i,a:n}=this;return 0===n?[0,0,0,0]:[e/n,t/n,i/n,n]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:i,a:n}=this;return[e,t,i,n]}}At.black=new At(0,0,0,1),At.white=new At(1,1,1,1),At.transparent=new At(0,0,0,0),At.red=new At(1,0,0,1),At.blue=new At(0,0,1,1);var It=At;class Rt{constructor(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ot{constructor(e,t,i,n,r){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=i,this.fontStack=n,this.textColor=r}}class Nt{constructor(e){this.sections=e}static fromString(e){return new Nt([new Ot(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Nt?e:Nt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const i={};t.fontStack&&(i["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(i["font-scale"]=t.scale),t.textColor&&(i["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(i)}return e}}class Dt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Dt({name:e,available:!1}):null}serialize(){return["image",this.name]}}function zt(e,t,i,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,i,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,i,n]:[e,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Lt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof It)return!0;if(e instanceof Rt)return!0;if(e instanceof Nt)return!0;if(e instanceof Dt)return!0;if(Array.isArray(e)){for(const t of e)if(!Lt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Lt(e[t]))return!1;return!0}return!1}function Bt(e){if(null===e)return lt;if("string"==typeof e)return ht;if("boolean"==typeof e)return ut;if("number"==typeof e)return ct;if(e instanceof It)return dt;if(e instanceof Rt)return ft;if(e instanceof Nt)return gt;if(e instanceof Dt)return _t;if(Array.isArray(e)){const t=e.length;let i;for(const n of e){const e=Bt(n);if(i){if(i===e)continue;i=mt;break}i=e}return yt(i||mt,t)}return pt}function Ft(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof It||e instanceof Nt||e instanceof Dt?e.toString():JSON.stringify(e)}class jt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Lt(e[1]))return t.error("invalid value");const i=e[1];let n=Bt(i);const r=t.expectedType;return"array"!==n.kind||0!==n.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(n=r),new jt(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof It?["rgba"].concat(this.value.toArray()):this.value instanceof Nt?this.value.serialize():this.value}}var Vt=jt,Ut=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const qt={string:ht,number:ct,boolean:ut,object:pt};class Ht{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let i,n=1;const r=e[0];if("array"===r){let r,s;if(e.length>2){const i=e[1];if("string"!=typeof i||!(i in qt)||"object"===i)return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=qt[i],n++}else r=mt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);s=e[2],n++}i=yt(r,s)}else i=qt[r];const s=[];for(;n<e.length;n++){const i=t.parse(e[n],n,mt);if(!i)return null;s.push(i)}return new Ht(i,s)}evaluate(e){for(let t=0;t<this.args.length;t++){const i=this.args[t].evaluate(e);if(!bt(this.type,Bt(i)))return i;if(t===this.args.length-1)throw new Ut(`Expected value to be of type ${vt(this.type)}, but found ${vt(Bt(i))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const i=e.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){t.push(i.kind);const n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map(e=>e.serialize()))}}var Gt=Ht;class Wt{constructor(e){this.type=gt,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&"object"==typeof i)return t.error("First argument must be an image or text section.");const n=[];let r=!1;for(let s=1;s<=e.length-1;++s){const i=e[s];if(r&&"object"==typeof i&&!Array.isArray(i)){r=!1;let e=null;if(i["font-scale"]&&(e=t.parse(i["font-scale"],1,ct),!e))return null;let s=null;if(i["text-font"]&&(s=t.parse(i["text-font"],1,yt(ht)),!s))return null;let o=null;if(i["text-color"]&&(o=t.parse(i["text-color"],1,dt),!o))return null;const a=n[n.length-1];a.scale=e,a.font=s,a.textColor=o}else{const i=t.parse(e[s],1,mt);if(!i)return null;const o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,n.push({content:i,scale:null,font:null,textColor:null})}}return new Wt(n)}evaluate(e){return new Nt(this.sections.map(t=>{const i=t.content.evaluate(e);return Bt(i)===_t?new Ot("",i,null,null,null):new Ot(Ft(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const i={};t.scale&&(i["font-scale"]=t.scale.serialize()),t.font&&(i["text-font"]=t.font.serialize()),t.textColor&&(i["text-color"]=t.textColor.serialize()),e.push(i)}return e}}class Zt{constructor(e){this.type=_t,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,ht);return i?new Zt(i):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),i=Dt.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const $t={"to-boolean":ut,"to-color":dt,"to-number":ct,"to-string":ht};class Xt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[0];if(("to-boolean"===i||"to-string"===i)&&2!==e.length)return t.error("Expected one argument.");const n=$t[i],r=[];for(let s=1;s<e.length;s++){const i=t.parse(e[s],s,mt);if(!i)return null;r.push(i)}return new Xt(n,r)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,i;for(const n of this.args){if(t=n.evaluate(e),i=null,t instanceof It)return t;if("string"==typeof t){const i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&(i=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:zt(t[0],t[1],t[2],t[3]),!i))return new It(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ut(i||`Could not parse color from value '${"string"==typeof t?t:String(JSON.stringify(t))}'`)}if("number"===this.type.kind){let t=null;for(const i of this.args){if(t=i.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Ut(`Could not convert ${JSON.stringify(t)} to number.`)}return"formatted"===this.type.kind?Nt.fromString(Ft(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Dt.fromString(Ft(this.args[0].evaluate(e))):Ft(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Wt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Zt(this.args[0]).serialize();const e=["to-"+this.type.kind];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Kt=Xt;const Yt=["Unknown","Point","LineString","Polygon"];var Jt=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Yt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:n}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-e[0])+this.featureDistanceData.bearing[1]*(n*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=It.parse(e)),t}};class Qt{constructor(e,t,i,n){this.name=e,this.type=t,this._evaluate=i,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,t){const i=e[0],n=Qt.definitions[i];if(!n)return t.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(n)?n[0]:n.type,s=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=s.filter(([t])=>!Array.isArray(t)||t.length===e.length-1);let a=null;for(const[l,c]of o){a=new Ti(t.registry,t.path,null,t.scope);const n=[];let s=!1;for(let t=1;t<e.length;t++){const i=e[t],r=Array.isArray(l)?l[t-1]:l.type,o=a.parse(i,1+n.length,r);if(!o){s=!0;break}n.push(o)}if(!s)if(Array.isArray(l)&&l.length!==n.length)a.error(`Expected ${l.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){const t=Array.isArray(l)?l[e]:l.type,i=n[e];a.concat(e+1).checkSubtype(t,i.type)}if(0===a.errors.length)return new Qt(i,r,c,n)}}if(1===o.length)t.errors.push(...a.errors);else{const i=(o.length?o:s).map(([e])=>{return t=e,Array.isArray(t)?`(${t.map(vt).join(", ")})`:`(${vt(t.type)}...)`;var t}).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(vt(i.type))}t.error(`Expected arguments of type ${i}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Qt.definitions=t;for(const i in t)e[i]=Qt}}var ei=Qt;class ti{constructor(e,t,i){this.type=ft,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const i=e[1];if("object"!=typeof i||Array.isArray(i))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,ut);if(!n)return null;const r=t.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,ut);if(!r)return null;let s=null;return i.locale&&(s=t.parse(i.locale,1,ht),!s)?null:new ti(n,r,s)}evaluate(e){return new Rt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ii=8192;function ni(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ri(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function si(e,t){const i=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(i*r*ii),Math.round(n*r*ii)]}function oi(e,t,i){const n=e[0]-t[0],r=e[1]-t[1],s=e[0]-i[0],o=e[1]-i[1];return n*o-s*r==0&&n*s<=0&&r*o<=0}function ai(e,t){let i=!1;for(let o=0,a=t.length;o<a;o++){const a=t[o];for(let t=0,o=a.length;t<o-1;t++){if(oi(e,a[t],a[t+1]))return!1;(r=a[t])[1]>(n=e)[1]!=(s=a[t+1])[1]>n[1]&&n[0]<(s[0]-r[0])*(n[1]-r[1])/(s[1]-r[1])+r[0]&&(i=!i)}}var n,r,s;return i}function li(e,t){for(let i=0;i<t.length;i++)if(ai(e,t[i]))return!0;return!1}function ci(e,t,i,n){const r=n[0]-i[0],s=n[1]-i[1],o=(e[0]-i[0])*s-r*(e[1]-i[1]),a=(t[0]-i[0])*s-r*(t[1]-i[1]);return o>0&&a<0||o<0&&a>0}function hi(e,t,i){for(const c of i)for(let i=0;i<c.length-1;++i)if(0!=(a=[(o=c[i+1])[0]-(s=c[i])[0],o[1]-s[1]])[0]*(l=[(r=t)[0]-(n=e)[0],r[1]-n[1]])[1]-a[1]*l[0]&&ci(n,r,s,o)&&ci(s,o,n,r))return!0;var n,r,s,o,a,l;return!1}function ui(e,t){for(let i=0;i<e.length;++i)if(!ai(e[i],t))return!1;for(let i=0;i<e.length-1;++i)if(hi(e[i],e[i+1],t))return!1;return!0}function di(e,t){for(let i=0;i<t.length;i++)if(ui(e,t[i]))return!0;return!1}function pi(e,t,i){const n=[];for(let r=0;r<e.length;r++){const s=[];for(let n=0;n<e[r].length;n++){const o=si(e[r][n],i);ni(t,o),s.push(o)}n.push(s)}return n}function mi(e,t,i){const n=[];for(let r=0;r<e.length;r++){const s=pi(e[r],t,i);n.push(s)}return n}function fi(e,t,i,n){if(e[0]<i[0]||e[0]>i[2]){const t=.5*n;let r=e[0]-i[0]>t?-n:i[0]-e[0]>t?n:0;0===r&&(r=e[0]-i[2]>t?-n:i[2]-e[0]>t?n:0),e[0]+=r}ni(t,e)}function gi(e,t,i,n){const r=Math.pow(2,n.z)*ii,s=[n.x*ii,n.y*ii],o=[];if(!e)return o;for(const a of e)for(const e of a){const n=[e.x+s[0],e.y+s[1]];fi(n,t,i,r),o.push(n)}return o}function _i(e,t,i,n){const r=Math.pow(2,n.z)*ii,s=[n.x*ii,n.y*ii],o=[];if(!e)return o;for(const l of e){const e=[];for(const i of l){const n=[i.x+s[0],i.y+s[1]];ni(t,n),e.push(n)}o.push(e)}if(t[2]-t[0]<=r/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const e of o)for(const n of e)fi(n,t,i,r)}var a;return o}class yi{constructor(e,t){this.type=ut,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Lt(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const i=t.features[e].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new yi(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new yi(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new yi(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const s=pi(t.coordinates,n,r),o=gi(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!ai(e,s))return!1}if("MultiPolygon"===t.type){const s=mi(t.coordinates,n,r),o=gi(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!li(e,s))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const s=pi(t.coordinates,n,r),o=_i(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!ui(e,s))return!1}if("MultiPolygon"===t.type){const s=mi(t.coordinates,n,r),o=_i(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!di(e,s))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var vi=yi;function xi(e){if(e instanceof ei){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof vi)return!1;let t=!0;return e.eachChild(e=>{t&&!xi(e)&&(t=!1)}),t}function bi(e){if(e instanceof ei&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!bi(e)&&(t=!1)}),t}function wi(e,t){if(e instanceof ei&&t.indexOf(e.name)>=0)return!1;let i=!0;return e.eachChild(e=>{i&&!wi(e,t)&&(i=!1)}),i}class Ci{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const i=e[1];return t.scope.has(i)?new Ci(i,t.scope.get(i)):t.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Si=Ci;class Ei{constructor(e,t=[],i,n=new at,r=[]){this.registry=e,this.path=t,this.key=t.map(e=>`[${e}]`).join(""),this.scope=n,this.errors=r,this.expectedType=i}parse(e,t,i,n,r={}){return t?this.concat(t,i,n)._parse(e,r):this._parse(e,r)}_parse(e,t){function i(e,t,i){return"assert"===i?new Gt(t,[e]):"coerce"===i?new Kt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[n];if(r){let n=r.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,r=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(e,r))return null}else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"assert")}if(!(n instanceof Vt)&&"resolvedImage"!==n.type.kind&&function e(t){if(t instanceof Si)return e(t.boundExpression);if(t instanceof ei&&"error"===t.name)return!1;if(t instanceof ti)return!1;if(t instanceof vi)return!1;const i=t instanceof Kt||t instanceof Gt;let n=!0;return t.eachChild(t=>{n=i?n&&e(t):n&&t instanceof Vt}),!!n&&xi(t)&&wi(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}(n)){const t=new Jt;try{n=new Vt(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,i){const n="number"==typeof e?this.path.concat(e):this.path,r=i?this.scope.concat(i):this.scope;return new Ei(this.registry,n,t||null,r,this.errors)}error(e,...t){const i=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new st(i,e))}checkSubtype(e,t){const i=bt(e,t);return i&&this.error(i),i}}var Ti=Ei;function Pi(e,t){const i=e.length-1;let n,r,s=0,o=i,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),n=e[a],r=e[a+1],n<=t){if(a===i||t<r)return a;s=a+1}else{if(!(n>t))throw new Ut("Input is not a number.");o=a-1}return 0}class Mi{constructor(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,r]of i)this.labels.push(n),this.outputs.push(r)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const i=t.parse(e[1],1,ct);if(!i)return null;const n=[];let r=null;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(let s=1;s<e.length;s+=2){const i=1===s?-1/0:e[s],o=e[s+1],a=s,l=s+1;if("number"!=typeof i)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=i)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=t.parse(o,l,r);if(!c)return null;r=r||c.type,n.push([i,c])}return new Mi(r,i,n)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;return n>=t[r-1]?i[r-1].evaluate(e):i[Pi(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var ki=Mi;function Ai(e,t,i){return e*(1-i)+t*i}var Ii=Object.freeze({__proto__:null,array:function(e,t,i){return e.map((e,n)=>Ai(e,t[n],i))},color:function(e,t,i){return new It(Ai(e.r,t.r,i),Ai(e.g,t.g,i),Ai(e.b,t.b,i),Ai(e.a,t.a,i))},number:Ai});const Ri=6/29*3*(6/29),Oi=Math.PI/180,Ni=180/Math.PI;function Di(e){return e>.008856451679035631?Math.pow(e,1/3):e/Ri+4/29}function zi(e){return e>6/29?e*e*e:Ri*(e-4/29)}function Li(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Bi(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Fi(e){const t=Bi(e.r),i=Bi(e.g),n=Bi(e.b),r=Di((.4124564*t+.3575761*i+.1804375*n)/.95047),s=Di((.2126729*t+.7151522*i+.072175*n)/1);return{l:116*s-16,a:500*(r-s),b:200*(s-Di((.0193339*t+.119192*i+.9503041*n)/1.08883)),alpha:e.a}}function ji(e){let t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*zi(t),i=.95047*zi(i),n=1.08883*zi(n),new It(Li(3.2404542*i-1.5371385*t-.4985314*n),Li(-.969266*i+1.8760108*t+.041556*n),Li(.0556434*i-.2040259*t+1.0572252*n),e.alpha)}function Vi(e,t,i){const n=t-e;return e+i*(n>180||n<-180?n-360*Math.round(n/360):n)}const Ui={forward:Fi,reverse:ji,interpolate:function(e,t,i){return{l:Ai(e.l,t.l,i),a:Ai(e.a,t.a,i),b:Ai(e.b,t.b,i),alpha:Ai(e.alpha,t.alpha,i)}}},qi={forward:function(e){const{l:t,a:i,b:n}=Fi(e),r=Math.atan2(n,i)*Ni;return{h:r<0?r+360:r,c:Math.sqrt(i*i+n*n),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Oi,i=e.c;return ji({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Vi(e.h,t.h,i),c:Ai(e.c,t.c,i),l:Ai(e.l,t.l,i),alpha:Ai(e.alpha,t.alpha,i)}}};var Hi=Object.freeze({__proto__:null,hcl:qi,lab:Ui});class Gi{constructor(e,t,i,n,r){this.type=e,this.operator=t,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[s,o]of r)this.labels.push(s),this.outputs.push(o)}static interpolationFactor(e,t,i,n){let r=0;if("exponential"===e.name)r=Wi(t,e.base,i,n);else if("linear"===e.name)r=Wi(t,1,i,n);else if("cubic-bezier"===e.name){const s=e.controlPoints;r=new f(s[0],s[1],s[2],s[3]).solve(Wi(t,1,i,n))}return r}static parse(e,t){let[i,n,r,...s]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);{const e=n.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(r=t.parse(r,2,ct),!r)return null;const o=[];let a=null;"interpolate-hcl"===i||"interpolate-lab"===i?a=dt:t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let l=0;l<s.length;l+=2){const e=s[l],i=s[l+1],n=l+3,r=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(o.length&&o[o.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=t.parse(i,r,a);if(!c)return null;a=a||c.type,o.push([e,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Gi(a,i,n,r,o):t.error(`Type ${vt(a)} is not interpolatable.`)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;if(n>=t[r-1])return i[r-1].evaluate(e);const s=Pi(t,n),o=Gi.interpolationFactor(this.interpolation,n,t[s],t[s+1]),a=i[s].evaluate(e),l=i[s+1].evaluate(e);return"interpolate"===this.operator?Ii[this.type.kind.toLowerCase()](a,l,o):"interpolate-hcl"===this.operator?qi.reverse(qi.interpolate(qi.forward(a),qi.forward(l),o)):Ui.reverse(Ui.interpolate(Ui.forward(a),Ui.forward(l),o))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t}}function Wi(e,t,i,n){const r=n-i,s=e-i;return 0===r?0:1===t?s/r:(Math.pow(t,s)-1)/(Math.pow(t,r)-1)}var Zi=Gi;class $i{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let i=null;const n=t.expectedType;n&&"value"!==n.kind&&(i=n);const r=[];for(const o of e.slice(1)){const e=t.parse(o,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!e)return null;i=i||e.type,r.push(e)}const s=n&&r.some(e=>bt(n,e.type));return new $i(s?mt:i,r)}evaluate(e){let t,i=null,n=0;for(const r of this.args){if(n++,i=r.evaluate(e),i&&i instanceof Dt&&!i.available&&(t||(t=i),i=null,n===this.args.length))return t;if(null!==i)break}return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Xi=$i;class Ki{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const i=[];for(let r=1;r<e.length-1;r+=2){const n=e[r];if("string"!=typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,r);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);const s=t.parse(e[r+1],r+1);if(!s)return null;i.push([n,s])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return n?new Ki(i,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,i]of this.bindings)e.push(t,i.serialize());return e.push(this.result.serialize()),e}}var Yi=Ki;class Ji{constructor(e,t,i){this.type=e,this.index=t,this.input=i}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,ct),n=t.parse(e[2],2,yt(t.expectedType||mt));return i&&n?new Ji(n.type.itemType,i,n):null}evaluate(e){const t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Ut(`Array index out of bounds: ${t} < 0.`);if(t>=i.length)throw new Ut(`Array index out of bounds: ${t} > ${i.length-1}.`);if(t!==Math.floor(t))throw new Ut(`Array index must be an integer, but found ${t} instead.`);return i[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Qi=Ji;class en{constructor(e,t){this.type=ut,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,mt);return i&&n?wt(i.type,[ut,ht,ct,lt,mt])?new en(i,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${vt(i.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(null==i)return!1;if(!Ct(t,["boolean","string","number","null"]))throw new Ut(`Expected first argument to be of type boolean, string, number or null, but found ${vt(Bt(t))} instead.`);if(!Ct(i,["string","array"]))throw new Ut(`Expected second argument to be of type array or string, but found ${vt(Bt(i))} instead.`);return i.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var tn=en;class nn{constructor(e,t,i){this.type=ct,this.needle=e,this.haystack=t,this.fromIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,mt);if(!i||!n)return null;if(!wt(i.type,[ut,ht,ct,lt,mt]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${vt(i.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ct);return r?new nn(i,n,r):null}return new nn(i,n)}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Ct(t,["boolean","string","number","null"]))throw new Ut(`Expected first argument to be of type boolean, string, number or null, but found ${vt(Bt(t))} instead.`);if(!Ct(i,["string","array"]))throw new Ut(`Expected second argument to be of type array or string, but found ${vt(Bt(i))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(e);return i.indexOf(t,n)}return i.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var rn=nn;class sn{constructor(e,t,i,n,r,s){this.inputType=e,this.type=t,this.input=i,this.cases=n,this.outputs=r,this.otherwise=s}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let i,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const r={},s=[];for(let l=2;l<e.length-1;l+=2){let o=e[l];const a=e[l+1];Array.isArray(o)||(o=[o]);const c=t.concat(l);if(0===o.length)return c.error("Expected at least one branch label.");for(const e of o){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,Bt(e)))return null}else i=Bt(e);if(void 0!==r[String(e)])return c.error("Branch labels must be unique.");r[String(e)]=s.length}const h=t.parse(a,l,n);if(!h)return null;n=n||h.type,s.push(h)}const o=t.parse(e[1],1,mt);if(!o)return null;const a=t.parse(e[e.length-1],e.length-1,n);return a?"value"!==o.type.kind&&t.concat(1).checkSubtype(i,o.type)?null:new sn(i,n,o,r,s,a):null}evaluate(e){const t=this.input.evaluate(e);return(Bt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),i=[],n={};for(const s of t){const e=n[this.cases[s]];void 0===e?(n[this.cases[s]]=i.length,i.push([this.cases[s],[s]])):i[e][1].push(s)}const r=e=>"number"===this.inputType.kind?Number(e):e;for(const[s,o]of i)e.push(1===o.length?r(o[0]):o.map(r)),e.push(this.outputs[s].serialize());return e.push(this.otherwise.serialize()),e}}var on=sn;class an{constructor(e,t,i){this.type=e,this.branches=t,this.otherwise=i}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const n=[];for(let s=1;s<e.length-1;s+=2){const r=t.parse(e[s],s,ut);if(!r)return null;const o=t.parse(e[s+1],s+1,i);if(!o)return null;n.push([r,o]),i=i||o.type}const r=t.parse(e[e.length-1],e.length-1,i);return r?new an(i,n,r):null}evaluate(e){for(const[t,i]of this.branches)if(t.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,i]of this.branches)e(t),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var ln=an;class cn{constructor(e,t,i,n){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,ct);if(!i||!n)return null;if(!wt(i.type,[yt(mt),ht,mt]))return t.error(`Expected first argument to be of type array or string, but found ${vt(i.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ct);return r?new cn(i.type,i,n,r):null}return new cn(i.type,i,n)}evaluate(e){const t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Ct(t,["string","array"]))throw new Ut(`Expected first argument to be of type array or string, but found ${vt(Bt(t))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(i,n)}return t.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var hn=cn;function un(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function dn(e,t,i,n){return 0===n.compare(t,i)}function pn(e,t,i){const n="=="!==e&&"!="!==e;return class r{constructor(e,t,i){this.type=ut,this.lhs=e,this.rhs=t,this.collator=i,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const i=e[0];let s=t.parse(e[1],1,mt);if(!s)return null;if(!un(i,s.type))return t.concat(1).error(`"${i}" comparisons are not supported for type '${vt(s.type)}'.`);let o=t.parse(e[2],2,mt);if(!o)return null;if(!un(i,o.type))return t.concat(2).error(`"${i}" comparisons are not supported for type '${vt(o.type)}'.`);if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return t.error(`Cannot compare types '${vt(s.type)}' and '${vt(o.type)}'.`);n&&("value"===s.type.kind&&"value"!==o.type.kind?s=new Gt(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new Gt(s.type,[o])));let a=null;if(4===e.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(a=t.parse(e[3],3,ft),!a)return null}return new r(s,o,a)}evaluate(r){const s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){const t=Bt(s),i=Bt(o);if(t.kind!==i.kind||"string"!==t.kind&&"number"!==t.kind)throw new Ut(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${i.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=Bt(s),i=Bt(o);if("string"!==e.kind||"string"!==i.kind)return t(r,s,o)}return this.collator?i(r,s,o,this.collator.evaluate(r)):t(r,s,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild(e=>{t.push(e.serialize())}),t}}}const mn=pn("==",(function(e,t,i){return t===i}),dn),fn=pn("!=",(function(e,t,i){return t!==i}),(function(e,t,i,n){return!dn(0,t,i,n)})),gn=pn("<",(function(e,t,i){return t<i}),(function(e,t,i,n){return n.compare(t,i)<0})),_n=pn(">",(function(e,t,i){return t>i}),(function(e,t,i,n){return n.compare(t,i)>0})),yn=pn("<=",(function(e,t,i){return t<=i}),(function(e,t,i,n){return n.compare(t,i)<=0})),vn=pn(">=",(function(e,t,i){return t>=i}),(function(e,t,i,n){return n.compare(t,i)>=0}));class xn{constructor(e,t,i,n,r,s){this.type=ht,this.number=e,this.locale=t,this.currency=i,this.unit=n,this.minFractionDigits=r,this.maxFractionDigits=s}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,ct);if(!i)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let r=null;if(n.locale&&(r=t.parse(n.locale,1,ht),!r))return null;let s=null;if(n.currency&&(s=t.parse(n.currency,1,ht),!s))return null;let o=null;if(n.unit&&(o=t.parse(n.unit,1,ht),!o))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,ct),!a))return null;let l=null;return n["max-fraction-digits"]&&(l=t.parse(n["max-fraction-digits"],1,ct),!l)?null:new xn(i,r,s,o,a,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class bn{constructor(e){this.type=ct,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const i=t.parse(e[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?t.error(`Expected argument of type string or array, but found ${vt(i.type)} instead.`):new bn(i):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Ut(`Expected value to be of type string or array, but found ${vt(Bt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(t=>{e.push(t.serialize())}),e}}const wn={"==":mn,"!=":fn,">":_n,"<":gn,">=":vn,"<=":yn,array:Gt,at:Qi,boolean:Gt,case:ln,coalesce:Xi,collator:ti,format:Wt,image:Zt,in:tn,"index-of":rn,interpolate:Zi,"interpolate-hcl":Zi,"interpolate-lab":Zi,length:bn,let:Yi,literal:Vt,match:on,number:Gt,"number-format":xn,object:Gt,slice:hn,step:ki,string:Gt,"to-boolean":Kt,"to-color":Kt,"to-number":Kt,"to-string":Kt,var:Si,within:vi};function Cn(e,[t,i,n,r]){t=t.evaluate(e),i=i.evaluate(e),n=n.evaluate(e);const s=r?r.evaluate(e):1,o=zt(t,i,n,s);if(o)throw new Ut(o);return new It(t/255*s,i/255*s,n/255*s,s)}function Sn(e,t){return e in t}function En(e,t){const i=t[e];return void 0===i?null:i}function Tn(e){return{type:e}}ei.register(wn,{error:[{kind:"error"},[ht],(e,[t])=>{throw new Ut(t.evaluate(e))}],typeof:[ht,[mt],(e,[t])=>vt(Bt(t.evaluate(e)))],"to-rgba":[yt(ct,4),[dt],(e,[t])=>t.evaluate(e).toArray()],rgb:[dt,[ct,ct,ct],Cn],rgba:[dt,[ct,ct,ct,ct],Cn],has:{type:ut,overloads:[[[ht],(e,[t])=>Sn(t.evaluate(e),e.properties())],[[ht,pt],(e,[t,i])=>Sn(t.evaluate(e),i.evaluate(e))]]},get:{type:mt,overloads:[[[ht],(e,[t])=>En(t.evaluate(e),e.properties())],[[ht,pt],(e,[t,i])=>En(t.evaluate(e),i.evaluate(e))]]},"feature-state":[mt,[ht],(e,[t])=>En(t.evaluate(e),e.featureState||{})],properties:[pt,[],e=>e.properties()],"geometry-type":[ht,[],e=>e.geometryType()],id:[mt,[],e=>e.id()],zoom:[ct,[],e=>e.globals.zoom],pitch:[ct,[],e=>e.globals.pitch||0],"distance-from-center":[ct,[],e=>e.distanceFromCenter()],"heatmap-density":[ct,[],e=>e.globals.heatmapDensity||0],"line-progress":[ct,[],e=>e.globals.lineProgress||0],"sky-radial-progress":[ct,[],e=>e.globals.skyRadialProgress||0],accumulated:[mt,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ct,Tn(ct),(e,t)=>{let i=0;for(const n of t)i+=n.evaluate(e);return i}],"*":[ct,Tn(ct),(e,t)=>{let i=1;for(const n of t)i*=n.evaluate(e);return i}],"-":{type:ct,overloads:[[[ct,ct],(e,[t,i])=>t.evaluate(e)-i.evaluate(e)],[[ct],(e,[t])=>-t.evaluate(e)]]},"/":[ct,[ct,ct],(e,[t,i])=>t.evaluate(e)/i.evaluate(e)],"%":[ct,[ct,ct],(e,[t,i])=>t.evaluate(e)%i.evaluate(e)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(e,[t,i])=>Math.pow(t.evaluate(e),i.evaluate(e))],sqrt:[ct,[ct],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))],log2:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[ct,[ct],(e,[t])=>Math.sin(t.evaluate(e))],cos:[ct,[ct],(e,[t])=>Math.cos(t.evaluate(e))],tan:[ct,[ct],(e,[t])=>Math.tan(t.evaluate(e))],asin:[ct,[ct],(e,[t])=>Math.asin(t.evaluate(e))],acos:[ct,[ct],(e,[t])=>Math.acos(t.evaluate(e))],atan:[ct,[ct],(e,[t])=>Math.atan(t.evaluate(e))],min:[ct,Tn(ct),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[ct,Tn(ct),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[ct,[ct],(e,[t])=>Math.abs(t.evaluate(e))],round:[ct,[ct],(e,[t])=>{const i=t.evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[ct,[ct],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[ct,[ct],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[ut,[ht,mt],(e,[t,i])=>e.properties()[t.value]===i.value],"filter-id-==":[ut,[mt],(e,[t])=>e.id()===t.value],"filter-type-==":[ut,[ht],(e,[t])=>e.geometryType()===t.value],"filter-<":[ut,[ht,mt],(e,[t,i])=>{const n=e.properties()[t.value],r=i.value;return typeof n==typeof r&&n<r}],"filter-id-<":[ut,[mt],(e,[t])=>{const i=e.id(),n=t.value;return typeof i==typeof n&&i<n}],"filter->":[ut,[ht,mt],(e,[t,i])=>{const n=e.properties()[t.value],r=i.value;return typeof n==typeof r&&n>r}],"filter-id->":[ut,[mt],(e,[t])=>{const i=e.id(),n=t.value;return typeof i==typeof n&&i>n}],"filter-<=":[ut,[ht,mt],(e,[t,i])=>{const n=e.properties()[t.value],r=i.value;return typeof n==typeof r&&n<=r}],"filter-id-<=":[ut,[mt],(e,[t])=>{const i=e.id(),n=t.value;return typeof i==typeof n&&i<=n}],"filter->=":[ut,[ht,mt],(e,[t,i])=>{const n=e.properties()[t.value],r=i.value;return typeof n==typeof r&&n>=r}],"filter-id->=":[ut,[mt],(e,[t])=>{const i=e.id(),n=t.value;return typeof i==typeof n&&i>=n}],"filter-has":[ut,[mt],(e,[t])=>t.value in e.properties()],"filter-has-id":[ut,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[ut,[yt(ht)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[ut,[yt(mt)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[ut,[ht,yt(mt)],(e,[t,i])=>i.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[ut,[ht,yt(mt)],(e,[t,i])=>function(e,t,i,n){for(;i<=n;){const r=i+n>>1;if(t[r]===e)return!0;t[r]>e?n=r-1:i=r+1}return!1}(e.properties()[t.value],i.value,0,i.value.length-1)],all:{type:ut,overloads:[[[ut,ut],(e,[t,i])=>t.evaluate(e)&&i.evaluate(e)],[Tn(ut),(e,t)=>{for(const i of t)if(!i.evaluate(e))return!1;return!0}]]},any:{type:ut,overloads:[[[ut,ut],(e,[t,i])=>t.evaluate(e)||i.evaluate(e)],[Tn(ut),(e,t)=>{for(const i of t)if(i.evaluate(e))return!0;return!1}]]},"!":[ut,[ut],(e,[t])=>!t.evaluate(e)],"is-supported-script":[ut,[ht],(e,[t])=>{const i=e.globals&&e.globals.isSupportedScript;return!i||i(t.evaluate(e))}],upcase:[ht,[ht],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[ht,[ht],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[ht,Tn(mt),(e,t)=>t.map(t=>Ft(t.evaluate(e))).join("")],"resolved-locale":[ht,[ft],(e,[t])=>t.evaluate(e).resolvedLocale()]});var Pn=wn;function Mn(e){return{result:"success",value:e}}function kn(e){return{result:"error",value:e}}function An(e){return"data-driven"===e["property-type"]}function In(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Rn(e){return!!e.expression&&e.expression.interpolated}function On(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Nn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Dn(e){return e}function zn(e,t,i){return void 0!==e?e:void 0!==t?t:void 0!==i?i:void 0}function Ln(e,t,i,n,r){return zn(typeof i===r?n[i]:void 0,e.default,t.default)}function Bn(e,t,i){if("number"!==On(i))return zn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[n-1][0])return e.stops[n-1][1];const r=Pi(e.stops.map(e=>e[0]),i);return e.stops[r][1]}function Fn(e,t,i){const n=void 0!==e.base?e.base:1;if("number"!==On(i))return zn(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[r-1][0])return e.stops[r-1][1];const s=Pi(e.stops.map(e=>e[0]),i),o=function(e,t,i,n){const r=n-i,s=e-i;return 0===r?0:1===t?s/r:(Math.pow(t,s)-1)/(Math.pow(t,r)-1)}(i,n,e.stops[s][0],e.stops[s+1][0]),a=e.stops[s][1],l=e.stops[s+1][1];let c=Ii[t.type]||Dn;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Hi[e.colorSpace];c=(e,i)=>t.reverse(t.interpolate(t.forward(e),t.forward(i),o))}return"function"==typeof a.evaluate?{evaluate(...e){const t=a.evaluate.apply(void 0,e),i=l.evaluate.apply(void 0,e);if(void 0!==t&&void 0!==i)return c(t,i,o)}}:c(a,l,o)}function jn(e,t,i){return"color"===t.type?i=It.parse(i):"formatted"===t.type?i=Nt.fromString(i.toString()):"resolvedImage"===t.type?i=Dt.fromString(i.toString()):On(i)===t.type||"enum"===t.type&&t.values[i]||(i=void 0),zn(i,e.default,t.default)}class Vn{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Jt,this._defaultValue=t?function(e){return"color"===e.type&&(Nn(e.default)||Array.isArray(e.default))?new It(0,0,0,0):"color"===e.type?It.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,i,n,r,s,o,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,i,n,r,s,o,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Ut(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Un(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Pn}function qn(e,t){const i=new Ti(Pn,[],t?function(e){const t={color:dt,string:ht,number:ct,enum:ht,boolean:ut,formatted:gt,resolvedImage:_t};return"array"===e.type?yt(t[e.value]||mt,e.length):t[e.type]}(t):void 0),n=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Mn(new Vn(n,t)):kn(i.errors)}class Hn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!bi(t.expression)}evaluateWithoutErrorHandling(e,t,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,s)}evaluate(e,t,i,n,r,s){return this._styleExpression.evaluate(e,t,i,n,r,s)}}class Gn{constructor(e,t,i,n){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent="camera"!==e&&!bi(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,s)}evaluate(e,t,i,n,r,s){return this._styleExpression.evaluate(e,t,i,n,r,s)}interpolationFactor(e,t,i){return this.interpolationType?Zi.interpolationFactor(this.interpolationType,e,t,i):0}}function Wn(e,t){if("error"===(e=qn(e,t)).result)return e;const i=e.value.expression,n=xi(i);if(!n&&!An(t))return kn([new st("","data expressions not supported")]);const r=wi(i,["zoom","pitch","distance-from-center"]);if(!r&&!In(t))return kn([new st("","zoom expressions not supported")]);const s=function e(t){let i=null;if(t instanceof Yi)i=e(t.result);else if(t instanceof Xi){for(const n of t.args)if(i=e(n),i)break}else(t instanceof ki||t instanceof Zi)&&t.input instanceof ei&&"zoom"===t.input.name&&(i=t);return i instanceof st||t.eachChild(t=>{const n=e(t);n instanceof st?i=n:!i&&n?i=new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&n&&i!==n&&(i=new st("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}(i);return s||r?s instanceof st?kn([s]):s instanceof Zi&&!Rn(t)?kn([new st("",'"interpolate" expressions cannot be used with this property')]):Mn(s?new Gn(n?"camera":"composite",e.value,s.labels,s instanceof Zi?s.interpolation:void 0):new Hn(n?"constant":"source",e.value)):kn([new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Zn{constructor(e,t){this._parameters=e,this._specification=t,tt(this,function e(t,i){const n="color"===i.type,r=t.stops&&"object"==typeof t.stops[0][0],s=r||!(r||void 0!==t.property),o=t.type||(Rn(i)?"exponential":"interval");if(n&&((t=tt({},t)).stops&&(t.stops=t.stops.map(e=>[e[0],It.parse(e[1])])),t.default=It.parse(t.default?t.default:i.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!Hi[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);let a,l,c;if("exponential"===o)a=Fn;else if("interval"===o)a=Bn;else if("categorical"===o){a=Ln,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);a=jn}if(r){const n={},r=[];for(let e=0;e<t.stops.length;e++){const i=t.stops[e],s=i[0].zoom;void 0===n[s]&&(n[s]={zoom:s,type:t.type,property:t.property,default:t.default,stops:[]},r.push(s)),n[s].stops.push([i[0].value,i[1]])}const s=[];for(const t of r)s.push([n[t].zoom,e(n[t],i)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:Zi.interpolationFactor.bind(void 0,o),zoomStops:s.map(e=>e[0]),evaluate:({zoom:e},n)=>Fn({stops:s,base:t.base},i,e).evaluate(e,n)}}if(s){const e="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:e,interpolationFactor:Zi.interpolationFactor.bind(void 0,e),zoomStops:t.stops.map(e=>e[0]),evaluate:({zoom:e})=>a(t,i,e,l,c)}}return{kind:"source",evaluate(e,n){const r=n&&n.properties?n.properties[t.property]:void 0;return void 0===r?zn(t.default,i.default):a(t,i,r,l,c)}}}(this._parameters,this._specification))}static deserialize(e){return new Zn(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}class $n{constructor(e,t,i,n){this.message=(e?e+": ":"")+i,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function Xn(e){const t=e.key,i=e.value,n=e.valueSpec||{},r=e.objectElementValidators||{},s=e.style,o=e.styleSpec;let a=[];const l=On(i);if("object"!==l)return[new $n(t,i,`object expected, ${l} found`)];for(const c in i){const e=c.split(".")[0];let l;r[e]?l=r[e]:n[e]?l=Er:r["*"]?l=r["*"]:n["*"]&&(l=Er),l?a=a.concat(l({key:(t?t+".":t)+c,value:i[c],valueSpec:n[e]||n["*"],style:s,styleSpec:o,object:i,objectKey:c},i)):a.push(new $n(t,i[c],`unknown property "${c}"`))}for(const c in n)r[c]||n[c].required&&void 0===n[c].default&&void 0===i[c]&&a.push(new $n(t,i,`missing required property "${c}"`));return a}function Kn(e){const t=e.value,i=e.valueSpec,n=e.style,r=e.styleSpec,s=e.key,o=e.arrayElementValidator||Er;if("array"!==On(t))return[new $n(s,t,`array expected, ${On(t)} found`)];if(i.length&&t.length!==i.length)return[new $n(s,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new $n(s,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let a={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};r.$version<7&&(a.function=i.function),"object"===On(i.value)&&(a=i.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(o({array:t,arrayIndex:c,value:t[c],valueSpec:a,style:n,styleSpec:r,key:`${s}[${c}]`}));return l}function Yn(e){const t=e.key,i=e.value,n=e.valueSpec;let r=On(i);if("number"===r&&i!=i&&(r="NaN"),"number"!==r)return[new $n(t,i,`number expected, ${r} found`)];if("minimum"in n){let r=n.minimum;if("array"===On(n.minimum)&&(r=n.minimum[e.arrayIndex]),i<r)return[new $n(t,i,`${i} is less than the minimum value ${r}`)]}if("maximum"in n){let r=n.maximum;if("array"===On(n.maximum)&&(r=n.maximum[e.arrayIndex]),i>r)return[new $n(t,i,`${i} is greater than the maximum value ${r}`)]}return[]}function Jn(e){const t=e.valueSpec,i=it(e.value.type);let n,r,s,o={};const a="categorical"!==i&&void 0===e.value.property,l=!a,c="array"===On(e.value.stops)&&"array"===On(e.value.stops[0])&&"object"===On(e.value.stops[0][0]),h=Xn({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new $n(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Kn({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:u})),"array"===On(n)&&0===n.length&&t.push(new $n(e.key,n,"array must have at least one stop")),t},default:function(e){return Er({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===i&&a&&h.push(new $n(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||h.push(new $n(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!Rn(e.valueSpec)&&h.push(new $n(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!An(e.valueSpec)?h.push(new $n(e.key,e.value,"property functions not supported")):a&&!In(e.valueSpec)&&h.push(new $n(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==e.value.property||h.push(new $n(e.key,e.value,'"property" property is required')),h;function u(e){let i=[];const n=e.value,a=e.key;if("array"!==On(n))return[new $n(a,n,`array expected, ${On(n)} found`)];if(2!==n.length)return[new $n(a,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==On(n[0]))return[new $n(a,n,`object expected, ${On(n[0])} found`)];if(void 0===n[0].zoom)return[new $n(a,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new $n(a,n,"object stop key must have value")];const t=it(n[0].zoom);if("number"!=typeof t)return[new $n(a,n[0].zoom,"stop zoom values must be numbers")];if(s&&s>t)return[new $n(a,n[0].zoom,"stop zoom values must appear in ascending order")];t!==s&&(s=t,r=void 0,o={}),i=i.concat(Xn({key:a+"[0]",value:n[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Yn,value:d}}))}else i=i.concat(d({key:a+"[0]",value:n[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},n));return Un(nt(n[1]))?i.concat([new $n(a+"[1]",n[1],"expressions are not allowed in function stops.")]):i.concat(Er({key:a+"[1]",value:n[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function d(e,s){const a=On(e.value),l=it(e.value),c=null!==e.value?e.value:s;if(n){if(a!==n)return[new $n(e.key,c,`${a} stop domain type must match previous stop domain type ${n}`)]}else n=a;if("number"!==a&&"string"!==a&&"boolean"!==a&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new $n(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){let n=`number expected, ${a} found`;return An(t)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $n(e.key,c,n)]}return"categorical"!==i||"number"!==a||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===a&&"number"==typeof l&&"number"==typeof r&&void 0!==r&&l<r?[new $n(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in o?[new $n(e.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new $n(e.key,c,"integer expected, found "+String(l))]}}function Qn(e){const t=("property"===e.expressionContext?Wn:qn)(nt(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new $n(`${e.key}${t.key}`,e.value,t.message));const i=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new $n(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!bi(i))return[new $n(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return function e(t,i){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const s of i.valueSpec.expression.parameters)n.delete(s);if(0===n.size)return[];const r=[];return t instanceof ei&&n.has(t.name)?[new $n(i.key,i.value,`["${t.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(t.eachChild(t=>{r.push(...e(t,i))}),r)}(i,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!wi(i,["zoom","feature-state"]))return[new $n(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!xi(i))return[new $n(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function er(e){const t=e.key,i=e.value,n=e.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(it(i))&&r.push(new $n(t,i,`expected one of [${n.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(n.values).indexOf(it(i))&&r.push(new $n(t,i,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(i)} found`)),r}function tr(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!tr(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function ir(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};tr(e)||(e=ar(e));const i=e;let n=!0;try{n=function(e){if(!nr(e))return e;let t=nt(e);return function e(t){let i=!1;const n=[];if("case"===t[0]){for(let e=1;e<t.length-1;e+=2)i=i||nr(t[e]),n.push(t[e+1]);n.push(t[t.length-1])}else if("match"===t[0]){i=i||nr(t[1]);for(let e=2;e<t.length-1;e+=2)n.push(t[e+1]);n.push(t[t.length-1])}else if("step"===t[0]){i=i||nr(t[1]);for(let e=1;e<t.length-1;e+=2)n.push(t[e+1])}i&&(t.length=0,t.push("any",...n));for(let r=1;r<t.length;r++)e(t[r])}(t),t=function e(t){if(!Array.isArray(t))return t;const i=function(e){if(rr.has(e[0]))for(let t=1;t<e.length;t++)if(nr(e[t]))return!0;return e}(t);return!0===i?i:i.map(t=>e(t))}(t),t}(i)}catch(e){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const r=et["filter_"+t],s=qn(n,r);let o=null;if("error"===s.result)throw new Error(s.value.map(e=>`${e.key}: ${e.message}`).join(", "));o=(e,t,i)=>s.value.evaluate(e,t,{},i);let a=null,l=null;if(n!==i){const e=qn(i,r);if("error"===e.result)throw new Error(e.value.map(e=>`${e.key}: ${e.message}`).join(", "));a=(t,i,n,r,s)=>e.value.evaluate(t,i,{},n,void 0,void 0,r,s),l=!xi(e.value.expression)}return{filter:o,dynamicFilter:a||void 0,needGeometry:or(n),needFeature:!!l}}function nr(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let i=1;i<e.length;i++)if(nr(e[i]))return!0;return!1}const rr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function sr(e,t){return e<t?-1:e>t?1:0}function or(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(or(e[t]))return!0;return!1}function ar(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?lr(e[1],e[2],"=="):"!="===t?ur(lr(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?lr(e[1],e[2],t):"any"===t?(i=e.slice(1),["any"].concat(i.map(ar))):"all"===t?["all"].concat(e.slice(1).map(ar)):"none"===t?["all"].concat(e.slice(1).map(ar).map(ur)):"in"===t?cr(e[1],e.slice(2)):"!in"===t?ur(cr(e[1],e.slice(2))):"has"===t?hr(e[1]):"!has"===t?ur(hr(e[1])):"within"!==t||e;var i}function lr(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function cr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(sr)]]:["filter-in-small",e,["literal",t]]}}function hr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function ur(e){return["!",e]}function dr(e){return tr(nt(e.value))?Qn(tt({},e,{expressionContext:"filter",valueSpec:e.styleSpec["filter_"+(e.layerType||"fill")]})):function e(t){const i=t.value,n=t.key;if("array"!==On(i))return[new $n(n,i,`array expected, ${On(i)} found`)];const r=t.styleSpec;let s,o=[];if(i.length<1)return[new $n(n,i,"filter array must have at least 1 element")];switch(o=o.concat(er({key:n+"[0]",value:i[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),it(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===it(i[1])&&o.push(new $n(n,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&o.push(new $n(n,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(s=On(i[1]),"string"!==s&&o.push(new $n(n+"[1]",i[1],`string expected, ${s} found`)));for(let e=2;e<i.length;e++)s=On(i[e]),"$type"===it(i[1])?o=o.concat(er({key:`${n}[${e}]`,value:i[e],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==s&&"number"!==s&&"boolean"!==s&&o.push(new $n(`${n}[${e}]`,i[e],`string, number, or boolean expected, ${s} found`));break;case"any":case"all":case"none":for(let r=1;r<i.length;r++)o=o.concat(e({key:`${n}[${r}]`,value:i[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":s=On(i[1]),2!==i.length?o.push(new $n(n,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==s&&o.push(new $n(n+"[1]",i[1],`string expected, ${s} found`));break;case"within":s=On(i[1]),2!==i.length?o.push(new $n(n,i,`filter array for "${i[0]}" operator must have 2 elements`)):"object"!==s&&o.push(new $n(n+"[1]",i[1],`object expected, ${s} found`))}return o}(e)}function pr(e,t){const i=e.key,n=e.style,r=e.styleSpec,s=e.value,o=e.objectKey,a=r[`${t}_${e.layerType}`];if(!a)return[];const l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&a[l[1]]&&a[l[1]].transition)return Er({key:i,value:s,valueSpec:r.transition,style:n,styleSpec:r});const c=e.valueSpec||a[o];if(!c)return[new $n(i,s,`unknown property "${o}"`)];let h;if("string"===On(s)&&An(c)&&!c.tokens&&(h=/^{([^}]+)}$/.exec(s))){const e=`\`{ "type": "identity", "property": ${h?JSON.stringify(h[1]):'"_"'} }\``;return[new $n(i,s,`"${o}" does not support interpolation syntax\nUse an identity property function instead: ${e}.`)]}const u=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&u.push(new $n(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Nn(nt(s))&&"identity"===it(s.type)&&u.push(new $n(i,s,'"text-font" does not support identity functions'))),u.concat(Er({key:e.key,value:s,valueSpec:c,style:n,styleSpec:r,expressionContext:"property",propertyType:t,propertyKey:o}))}function mr(e){return pr(e,"paint")}function fr(e){return pr(e,"layout")}function gr(e){let t=[];const i=e.value,n=e.key,r=e.style,s=e.styleSpec;i.type||i.ref||t.push(new $n(n,i,'either "type" or "ref" is required'));let o=it(i.type);const a=it(i.ref);if(i.id){const s=it(i.id);for(let o=0;o<e.arrayIndex;o++){const e=r.layers[o];it(e.id)===s&&t.push(new $n(n,i.id,`duplicate layer id "${i.id}", previously used at line ${e.id.__line__}`))}}if("ref"in i){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in i&&t.push(new $n(n,i[e],`"${e}" is prohibited for ref layers`))}),r.layers.forEach(t=>{it(t.id)===a&&(e=t)}),e?e.ref?t.push(new $n(n,i.ref,"ref cannot reference another ref layer")):o=it(e.type):"string"==typeof a&&t.push(new $n(n,i.ref,`ref layer "${a}" not found`))}else if("background"!==o&&"sky"!==o)if(i.source){const e=r.sources&&r.sources[i.source],s=e&&it(e.type);e?"vector"===s&&"raster"===o?t.push(new $n(n,i.source,`layer "${i.id}" requires a raster source`)):"raster"===s&&"raster"!==o?t.push(new $n(n,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==s||i["source-layer"]?"raster-dem"===s&&"hillshade"!==o?t.push(new $n(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===s&&e.lineMetrics||t.push(new $n(n,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new $n(n,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new $n(n,i.source,`source "${i.source}" not found`))}else t.push(new $n(n,i,'missing required property "source"'));return t=t.concat(Xn({key:n,value:i,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Er({key:n+".type",value:i.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"}),filter:e=>dr(tt({layerType:o},e)),layout:e=>Xn({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>fr(tt({layerType:o},e))}}),paint:e=>Xn({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>mr(tt({layerType:o},e))}})}})),t}function _r(e){const t=e.value,i=e.key,n=On(t);return"string"!==n?[new $n(i,t,`string expected, ${n} found`)]:[]}const yr={promoteId:function({key:e,value:t}){if("string"===On(t))return _r({key:e,value:t});{const i=[];for(const n in t)i.push(..._r({key:`${e}.${n}`,value:t[n]}));return i}}};function vr(e){const t=e.value,i=e.key,n=e.styleSpec,r=e.style;if(!t.type)return[new $n(i,t,'"type" is required')];const s=it(t.type);let o;switch(s){case"vector":case"raster":case"raster-dem":return o=Xn({key:i,value:t,valueSpec:n["source_"+s.replace("-","_")],style:e.style,styleSpec:n,objectElementValidators:yr}),o;case"geojson":if(o=Xn({key:i,value:t,valueSpec:n.source_geojson,style:r,styleSpec:n,objectElementValidators:yr}),t.cluster)for(const e in t.clusterProperties){const[n,r]=t.clusterProperties[e],s="string"==typeof n?[n,["accumulated"],["get",e]]:n;o.push(...Qn({key:`${i}.${e}.map`,value:r,expressionContext:"cluster-map"})),o.push(...Qn({key:`${i}.${e}.reduce`,value:s,expressionContext:"cluster-reduce"}))}return o;case"video":return Xn({key:i,value:t,valueSpec:n.source_video,style:r,styleSpec:n});case"image":return Xn({key:i,value:t,valueSpec:n.source_image,style:r,styleSpec:n});case"canvas":return[new $n(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return er({key:i+".type",value:t.type,valueSpec:{values:xr(n)},style:r,styleSpec:n})}}function xr(e){return e.source.reduce((t,i)=>{const n=e[i];return"enum"===n.type.type&&(t=t.concat(Object.keys(n.type.values))),t},[])}function br(e){const t=e.value,i=e.styleSpec,n=i.light,r=e.style;let s=[];const o=On(t);if(void 0===t)return s;if("object"!==o)return s=s.concat([new $n("light",t,`object expected, ${o} found`)]),s;for(const a in t){const e=a.match(/^(.*)-transition$/);s=s.concat(e&&n[e[1]]&&n[e[1]].transition?Er({key:a,value:t[a],valueSpec:i.transition,style:r,styleSpec:i}):n[a]?Er({key:a,value:t[a],valueSpec:n[a],style:r,styleSpec:i}):[new $n(a,t[a],`unknown property "${a}"`)])}return s}function wr(e){const t=e.value,i=e.key,n=e.style,r=e.styleSpec,s=r.terrain;let o=[];const a=On(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new $n("terrain",t,`object expected, ${a} found`)]),o;for(const l in t){const e=l.match(/^(.*)-transition$/);o=o.concat(e&&s[e[1]]&&s[e[1]].transition?Er({key:l,value:t[l],valueSpec:r.transition,style:n,styleSpec:r}):s[l]?Er({key:l,value:t[l],valueSpec:s[l],style:n,styleSpec:r}):[new $n(l,t[l],`unknown property "${l}"`)])}if(t.source){const e=n.sources&&n.sources[t.source],r=e&&it(e.type);e?"raster-dem"!==r&&o.push(new $n(i,t.source,`terrain cannot be used with a source of type ${String(r)}, it only be used with a "raster-dem" source type`)):o.push(new $n(i,t.source,`source "${t.source}" not found`))}else o.push(new $n(i,t,'terrain is missing required property "source"'));return o}function Cr(e){const t=e.value,i=e.style,n=e.styleSpec,r=n.fog;let s=[];const o=On(t);if(void 0===t)return s;if("object"!==o)return s=s.concat([new $n("fog",t,`object expected, ${o} found`)]),s;for(const a in t){const e=a.match(/^(.*)-transition$/);s=s.concat(e&&r[e[1]]&&r[e[1]].transition?Er({key:a,value:t[a],valueSpec:n.transition,style:i,styleSpec:n}):r[a]?Er({key:a,value:t[a],valueSpec:r[a],style:i,styleSpec:n}):[new $n(a,t[a],`unknown property "${a}"`)])}return s}const Sr={"*":()=>[],array:Kn,boolean:function(e){const t=e.value,i=e.key,n=On(t);return"boolean"!==n?[new $n(i,t,`boolean expected, ${n} found`)]:[]},number:Yn,color:function(e){const t=e.key,i=e.value,n=On(i);return"string"!==n?[new $n(t,i,`color expected, ${n} found`)]:null===St(i)?[new $n(t,i,`color expected, "${i}" found`)]:[]},enum:er,filter:dr,function:Jn,layer:gr,object:Xn,source:vr,light:br,terrain:wr,fog:Cr,string:_r,formatted:function(e){return 0===_r(e).length?[]:Qn(e)},resolvedImage:function(e){return 0===_r(e).length?[]:Qn(e)},projection:function(e){const t=e.value,i=e.styleSpec,n=i.projection,r=e.style;let s=[];const o=On(t);if("object"===o)for(const a in t)s=s.concat(Er({key:a,value:t[a],valueSpec:n[a],style:r,styleSpec:i}));else"string"!==o&&(s=s.concat([new $n("projection",t,`object or string expected, ${o} found`)]));return s}};function Er(e){const t=e.value,i=e.valueSpec,n=e.styleSpec;return i.expression&&Nn(it(t))?Jn(e):i.expression&&Un(nt(t))?Qn(e):i.type&&Sr[i.type]?Sr[i.type](e):Xn(tt({},e,{valueSpec:i.type?n[i.type]:i}))}function Tr(e){const t=e.value,i=e.key,n=_r(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new $n(i,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new $n(i,t,'"glyphs" url must include a "{range}" token'))),n}function Pr(e,t=et){return Ar(Er({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Tr,"*":()=>[]}}))}const Mr=e=>Ar(mr(e)),kr=e=>Ar(fr(e));function Ar(e){return e.slice().sort((e,t)=>e.line&&t.line?e.line-t.line:0)}function Ir(e,t){let i=!1;if(t&&t.length)for(const n of t)e.fire(new Je(new Error(n.message))),i=!0;return i}var Rr=Or;function Or(e,t,i){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(i=r[2]);for(var s=0;s<this.d*this.d;s++){var o=r[3+s],a=r[3+s+1];n.push(o===a?null:r.subarray(o,a))}var l=r[3+n.length+1];this.keys=r.subarray(r[3+n.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var h=i/t*e;this.min=-h,this.max=e+h}Or.prototype.insert=function(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)},Or.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Or.prototype._insertCell=function(e,t,i,n,r,s){this.cells[r].push(s)},Or.prototype.query=function(e,t,i,n,r){var s=this.min,o=this.max;if(e<=s&&t<=s&&o<=i&&o<=n&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(e,t,i,n,this._queryCell,a,{},r),a},Or.prototype._queryCell=function(e,t,i,n,r,s,o,a){var l=this.cells[r];if(null!==l)for(var c=this.keys,h=this.bboxes,u=0;u<l.length;u++){var d=l[u];if(void 0===o[d]){var p=4*d;(a?a(h[p+0],h[p+1],h[p+2],h[p+3]):e<=h[p+2]&&t<=h[p+3]&&i>=h[p+0]&&n>=h[p+1])?(o[d]=!0,s.push(c[d])):o[d]=!1}}},Or.prototype._forEachCell=function(e,t,i,n,r,s,o,a){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),h=this._convertToCellCoord(i),u=this._convertToCellCoord(n),d=l;d<=h;d++)for(var p=c;p<=u;p++){var m=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&r.call(this,e,t,i,n,m,s,o,a))return}},Or.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Or.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Or.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var r=new Int32Array(t+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var s=t,o=0;o<e.length;o++){var a=e[o];r[3+o]=s,r.set(a,s),s+=a.length}return r[3+e.length]=s,r.set(this.keys,s),r[3+e.length+1]=s+=this.keys.length,r.set(this.bboxes,s),s+=this.bboxes.length,r.buffer};var Nr=d(Rr);const Dr={};function zr(e,t,i={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Dr[t]={klass:e,omit:i.omit||[]}}zr(Object,"Object"),Nr.serialize=function(e,t){const i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Nr.deserialize=function(e){return new Nr(e.buffer)},Object.defineProperty(Nr,"name",{value:"Grid"}),zr(Nr,"Grid"),zr(It,"Color"),zr(Error,"Error"),zr(ce,"AJAXError"),zr(Dt,"ResolvedImage"),zr(Zn,"StylePropertyFunction"),zr(Vn,"StyleExpression",{omit:["_evaluator"]}),zr(Gn,"ZoomDependentExpression"),zr(Hn,"ZoomConstantExpression"),zr(ei,"CompoundExpression",{omit:["_evaluate"]});for(const uf in Pn)Dr[Pn[uf]._classRegistryKey]||zr(Pn[uf],"Expression"+uf);function Lr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Br(e){return t.ImageBitmap&&e instanceof t.ImageBitmap}function Fr(e,i){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Lr(e)||Br(e))return i&&i.push(e),e;if(ArrayBuffer.isView(e)){const t=e;return i&&i.push(t.buffer),t}if(e instanceof t.ImageData)return i&&i.push(e.data.buffer),e;if(Array.isArray(e)){const t=[];for(const n of e)t.push(Fr(n,i));return t}if("object"==typeof e){const t=e.constructor,n=t._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class "+n);const r=t.serialize?t.serialize(e,i):{};if(!t.serialize){for(const t in e)e.hasOwnProperty(t)&&(Dr[n].omit.indexOf(t)>=0||(r[t]=Fr(e[t],i)));e instanceof Error&&(r.message=e.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}throw new Error("can't serialize object of type "+typeof e)}function jr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Lr(e)||Br(e)||ArrayBuffer.isView(e)||e instanceof t.ImageData)return e;if(Array.isArray(e))return e.map(jr);if("object"==typeof e){const t=e.$name||"Object",{klass:i}=Dr[t];if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);const n=Object.create(i.prototype);for(const r of Object.keys(e))"$name"!==r&&(n[r]=jr(e[r]));return n}throw new Error("can't deserialize object of type "+typeof e)}const Vr=e=>e>=1536&&e<=1791,Ur=e=>e>=1872&&e<=1919,qr=e=>e>=2208&&e<=2303,Hr=e=>e>=11904&&e<=12031,Gr=e=>e>=12032&&e<=12255,Wr=e=>e>=12272&&e<=12287,Zr=e=>e>=12288&&e<=12351,$r=e=>e>=12352&&e<=12447,Xr=e=>e>=12448&&e<=12543,Kr=e=>e>=12544&&e<=12591,Yr=e=>e>=12704&&e<=12735,Jr=e=>e>=12736&&e<=12783,Qr=e=>e>=12784&&e<=12799,es=e=>e>=12800&&e<=13055,ts=e=>e>=13056&&e<=13311,is=e=>e>=13312&&e<=19903,ns=e=>e>=19968&&e<=40959,rs=e=>e>=40960&&e<=42127,ss=e=>e>=42128&&e<=42191,os=e=>e>=44032&&e<=55215,as=e=>e>=63744&&e<=64255,ls=e=>e>=64336&&e<=65023,cs=e=>e>=65040&&e<=65055,hs=e=>e>=65072&&e<=65103,us=e=>e>=65104&&e<=65135,ds=e=>e>=65136&&e<=65279,ps=e=>e>=65280&&e<=65519;function ms(e){for(const t of e)if(_s(t.charCodeAt(0)))return!0;return!1}function fs(e){for(const t of e)if(!gs(t.charCodeAt(0)))return!1;return!0}function gs(e){return!(Vr(e)||Ur(e)||qr(e)||ls(e)||ds(e))}function _s(e){return!(746!==e&&747!==e&&(e<4352||!(Yr(e)||Kr(e)||hs(e)&&!(e>=65097&&e<=65103)||as(e)||ts(e)||Hr(e)||Jr(e)||!(!Zr(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||is(e)||ns(e)||es(e)||(e=>e>=12592&&e<=12687)(e)||(e=>e>=43360&&e<=43391)(e)||(e=>e>=55216&&e<=55295)(e)||(e=>e>=4352&&e<=4607)(e)||os(e)||$r(e)||Wr(e)||(e=>e>=12688&&e<=12703)(e)||Gr(e)||Qr(e)||Xr(e)&&12540!==e||!(!ps(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!us(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||(e=>e>=5120&&e<=5759)(e)||(e=>e>=6320&&e<=6399)(e)||cs(e)||(e=>e>=19904&&e<=19967)(e)||rs(e)||ss(e))))}function ys(e){return!(_s(e)||function(e){return!!((e=>e>=128&&e<=255)(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(e=>e>=8192&&e<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(e=>e>=8448&&e<=8527)(e)||(e=>e>=8528&&e<=8591)(e)||(e=>e>=8960&&e<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(e=>e>=9216&&e<=9279)(e)&&9251!==e||(e=>e>=9280&&e<=9311)(e)||(e=>e>=9312&&e<=9471)(e)||(e=>e>=9632&&e<=9727)(e)||(e=>e>=9728&&e<=9983)(e)&&!(e>=9754&&e<=9759)||(e=>e>=11008&&e<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Zr(e)||Xr(e)||(e=>e>=57344&&e<=63743)(e)||hs(e)||us(e)||ps(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function vs(e){return e>=1424&&e<=2303||ls(e)||ds(e)}function xs(e,t){return!(!t&&vs(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||(e=>e>=6016&&e<=6143)(e))}function bs(e){for(const t of e)if(vs(t.charCodeAt(0)))return!0;return!1}const ws="deferred",Cs="loading",Ss="loaded";let Es=null,Ts="unavailable",Ps=null;const Ms=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ts="error"),Es&&Es(e)};function ks(){As.fire(new Ye("pluginStateChange",{pluginStatus:Ts,pluginURL:Ps}))}const As=new Qe,Is=function(){return Ts},Rs=function(){if(Ts!==ws||!Ps)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ts=Cs,ks(),Ps&&de({url:Ps},e=>{e?Ms(e):(Ts=Ss,ks())})},Os={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ts===Ss||null!=Os.applyArabicShaping,isLoading:()=>Ts===Cs,setState(e){Ts=e.pluginStatus,Ps=e.pluginURL},isParsed:()=>null!=Os.applyArabicShaping&&null!=Os.processBidirectionalText&&null!=Os.processStyledBidirectionalText,getPluginURL:()=>Ps};class Ns{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(e,t){for(const i of e)if(!xs(i.charCodeAt(0),t))return!1;return!0}(e,Os.isLoaded())}}class Ds{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Nn(e))return new Zn(e,t);if(Un(e)){const i=Wn(e,t);if("error"===i.result)throw new Error(i.value.map(e=>`${e.key}: ${e.message}`).join(", "));return i.value}{let i=e;return"string"==typeof e&&"color"===t.type&&(i=It.parse(e)),{kind:"constant",evaluate:()=>i}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)}}class zs{constructor(e){this.property=e,this.value=new Ds(e,void 0)}transitioned(e,t){return new Bs(this.property,this.value,t,R({},e.transition,this.transition),e.now)}untransitioned(){return new Bs(this.property,this.value,null,{},0)}}class Ls{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return U(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zs(this._values[e].property)),this._values[e].value=new Ds(this._values[e].property,null===t?void 0:U(t))}getTransition(e){return U(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zs(this._values[e].property)),this._values[e].transition=U(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i);const n=this.getTransition(t);void 0!==n&&(e[t+"-transition"]=n)}return e}transitioned(e,t){const i=new Fs(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(e,t._values[n]);return i}untransitioned(){const e=new Fs(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Bs{constructor(e,t,i,n,r){const s=n.delay||0,o=n.duration||0;r=r||0,this.property=e,this.value=t,this.begin=r+s,this.end=this.begin+o,e.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(e,t,i){const n=e.now||0,r=this.value.possiblyEvaluate(e,t,i),s=this.prior;if(s){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return s.possiblyEvaluate(e,t,i);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(e,t,i),r,S(o))}}return r}}class Fs{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,i){const n=new Us(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class js{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return U(this._values[e].value)}setValue(e,t){this._values[e]=new Ds(this._values[e].property,null===t?void 0:U(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i)}return e}possiblyEvaluate(e,t,i){const n=new Us(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}}class Vs{constructor(e,t,i){this.property=e,this.value=t,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,i,n){return this.property.evaluate(this.value,this.parameters,e,t,i,n)}}class Us{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class qs{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,i){const n=Ii[this.specification.type];return n?n(e,t,i):e}}class Hs{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,i,n){return new Vs(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},i,n)}:e.expression,t)}interpolate(e,t,i){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Vs(this,{kind:"constant",value:void 0},e.parameters);const n=Ii[this.specification.type];return n?new Vs(this,{kind:"constant",value:n(e.value.value,t.value.value,i)},e.parameters):e}evaluate(e,t,i,n,r,s){return"constant"===e.kind?e.value:e.evaluate(t,i,n,r,s)}}class Gs{constructor(e){this.specification=e}possiblyEvaluate(e,t,i,n){return!!e.expression.evaluate(t,null,{},i,n)}interpolate(){return!1}}class Ws{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new Ns(0,{});for(const i in e){const n=e[i];n.specification.overridable&&this.overridableProperties.push(i);const r=this.defaultPropertyValues[i]=new Ds(n,void 0),s=this.defaultTransitionablePropertyValues[i]=new zs(n);this.defaultTransitioningPropertyValues[i]=s.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=r.possiblyEvaluate(t)}}}function Zs(e,t){return 256*(e=P(Math.floor(e),0,255))+P(Math.floor(t),0,255)}zr(Hs,"DataDrivenProperty"),zr(qs,"DataConstantProperty"),zr(Gs,"ColorRampProperty");const $s={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xs{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ks{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ys(e,t=1){let i=0,n=0;return{members:e.map(e=>{const r=$s[e.type].BYTES_PER_ELEMENT,s=i=Js(i,Math.max(t,r)),o=e.components||1;return n=Math.max(n,r),i+=r*o,{name:e.name,type:e.type,components:o,offset:s}}),size:Js(i,Math.max(n,t)),alignment:t}}function Js(e,t){return Math.ceil(e/t)*t}class Qs extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=i,e}}Qs.prototype.bytesPerElement=4,zr(Qs,"StructArrayLayout2i4");class eo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.int16[r+0]=t,this.int16[r+1]=i,this.int16[r+2]=n,e}}eo.prototype.bytesPerElement=6,zr(eo,"StructArrayLayout3i6");class to extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.int16[s+0]=t,this.int16[s+1]=i,this.int16[s+2]=n,this.int16[s+3]=r,e}}to.prototype.bytesPerElement=8,zr(to,"StructArrayLayout4i8");class io extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r,s,o)}emplace(e,t,i,n,r,s,o,a){const l=6*e,c=12*e,h=3*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.uint8[c+4]=n,this.uint8[c+5]=r,this.uint8[c+6]=s,this.uint8[c+7]=o,this.float32[h+2]=a,e}}io.prototype.bytesPerElement=12,zr(io,"StructArrayLayout2i4ub1f12");class no extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.float32[s+0]=t,this.float32[s+1]=i,this.float32[s+2]=n,this.float32[s+3]=r,e}}no.prototype.bytesPerElement=16,zr(no,"StructArrayLayout4f16");class ro extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=6*e,a=3*e;return this.uint16[o+0]=t,this.uint16[o+1]=i,this.uint16[o+2]=n,this.uint16[o+3]=r,this.float32[a+2]=s,e}}ro.prototype.bytesPerElement=12,zr(ro,"StructArrayLayout4ui1f12");class so extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.uint16[s+0]=t,this.uint16[s+1]=i,this.uint16[s+2]=n,this.uint16[s+3]=r,e}}so.prototype.bytesPerElement=8,zr(so,"StructArrayLayout4ui8");class oo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,s)}emplace(e,t,i,n,r,s,o){const a=6*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,this.int16[a+4]=s,this.int16[a+5]=o,e}}oo.prototype.bytesPerElement=12,zr(oo,"StructArrayLayout6i12");class ao extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,h,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,i,n,r,s,o,a,l,c,h,u)}emplace(e,t,i,n,r,s,o,a,l,c,h,u,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=i,this.int16[p+2]=n,this.int16[p+3]=r,this.uint16[p+4]=s,this.uint16[p+5]=o,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=h,this.int16[p+10]=u,this.int16[p+11]=d,e}}ao.prototype.bytesPerElement=24,zr(ao,"StructArrayLayout4i4ui4i24");class lo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,s)}emplace(e,t,i,n,r,s,o){const a=10*e,l=5*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.float32[l+2]=r,this.float32[l+3]=s,this.float32[l+4]=o,e}}lo.prototype.bytesPerElement=20,zr(lo,"StructArrayLayout3i3f20");class co extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}co.prototype.bytesPerElement=4,zr(co,"StructArrayLayout1ul4");class ho extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,h,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,i,n,r,s,o,a,l,c,h,u,d)}emplace(e,t,i,n,r,s,o,a,l,c,h,u,d,p){const m=20*e,f=10*e;return this.int16[m+0]=t,this.int16[m+1]=i,this.int16[m+2]=n,this.int16[m+3]=r,this.int16[m+4]=s,this.float32[f+3]=o,this.float32[f+4]=a,this.float32[f+5]=l,this.float32[f+6]=c,this.int16[m+14]=h,this.uint32[f+8]=u,this.uint16[m+18]=d,this.uint16[m+19]=p,e}}ho.prototype.bytesPerElement=40,zr(ho,"StructArrayLayout5i4f1i1ul2ui40");class uo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r,s,o)}emplace(e,t,i,n,r,s,o,a){const l=8*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.int16[l+2]=n,this.int16[l+4]=r,this.int16[l+5]=s,this.int16[l+6]=o,this.int16[l+7]=a,e}}uo.prototype.bytesPerElement=16,zr(uo,"StructArrayLayout3i2i2i16");class po extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=4*e,a=8*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.int16[a+6]=r,this.int16[a+7]=s,e}}po.prototype.bytesPerElement=16,zr(po,"StructArrayLayout2f1f2i16");class mo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=12*e,o=3*e;return this.uint8[s+0]=t,this.uint8[s+1]=i,this.float32[o+1]=n,this.float32[o+2]=r,e}}mo.prototype.bytesPerElement=12,zr(mo,"StructArrayLayout2ub2f12");class fo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.float32[r+0]=t,this.float32[r+1]=i,this.float32[r+2]=n,e}}fo.prototype.bytesPerElement=12,zr(fo,"StructArrayLayout3f12");class go extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=i,this.uint16[r+2]=n,e}}go.prototype.bytesPerElement=6,zr(go,"StructArrayLayout3ui6");class _o extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x)}emplace(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x,b){const w=30*e,C=15*e,S=60*e;return this.int16[w+0]=t,this.int16[w+1]=i,this.int16[w+2]=n,this.float32[C+2]=r,this.float32[C+3]=s,this.uint16[w+8]=o,this.uint16[w+9]=a,this.uint32[C+5]=l,this.uint32[C+6]=c,this.uint32[C+7]=h,this.uint16[w+16]=u,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[C+10]=m,this.float32[C+11]=f,this.uint8[S+48]=g,this.uint8[S+49]=_,this.uint8[S+50]=y,this.uint32[C+13]=v,this.int16[w+28]=x,this.uint8[S+58]=b,e}}_o.prototype.bytesPerElement=60,zr(_o,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class yo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x,b,w,C,S,E,T,P,M,k){const A=this.length;return this.resize(A+1),this.emplace(A,e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x,b,w,C,S,E,T,P,M,k)}emplace(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x,b,w,C,S,E,T,P,M,k,A){const I=38*e,R=19*e;return this.int16[I+0]=t,this.int16[I+1]=i,this.int16[I+2]=n,this.float32[R+2]=r,this.float32[R+3]=s,this.int16[I+8]=o,this.int16[I+9]=a,this.int16[I+10]=l,this.int16[I+11]=c,this.int16[I+12]=h,this.int16[I+13]=u,this.uint16[I+14]=d,this.uint16[I+15]=p,this.uint16[I+16]=m,this.uint16[I+17]=f,this.uint16[I+18]=g,this.uint16[I+19]=_,this.uint16[I+20]=y,this.uint16[I+21]=v,this.uint16[I+22]=x,this.uint16[I+23]=b,this.uint16[I+24]=w,this.uint16[I+25]=C,this.uint16[I+26]=S,this.uint16[I+27]=E,this.uint16[I+28]=T,this.uint32[R+15]=P,this.float32[R+16]=M,this.float32[R+17]=k,this.float32[R+18]=A,e}}yo.prototype.bytesPerElement=76,zr(yo,"StructArrayLayout3i2f6i15ui1ul3f76");class vo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}vo.prototype.bytesPerElement=4,zr(vo,"StructArrayLayout1f4");class xo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=5*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=r,this.float32[o+4]=s,e}}xo.prototype.bytesPerElement=20,zr(xo,"StructArrayLayout5f20");class bo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=6*e;return this.uint32[3*e+0]=t,this.uint16[s+2]=i,this.uint16[s+3]=n,this.uint16[s+4]=r,e}}bo.prototype.bytesPerElement=12,zr(bo,"StructArrayLayout1ul3ui12");class wo extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=i,e}}wo.prototype.bytesPerElement=4,zr(wo,"StructArrayLayout2ui4");class Co extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Co.prototype.bytesPerElement=2,zr(Co,"StructArrayLayout1ui2");class So extends Ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=i,e}}So.prototype.bytesPerElement=8,zr(So,"StructArrayLayout2f8");class Eo extends Xs{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Eo.prototype.size=40;class To extends ho{get(e){return new Eo(this,e)}}zr(To,"CollisionBoxArray");class Po extends Xs{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Po.prototype.size=60;class Mo extends _o{get(e){return new Po(this,e)}}zr(Mo,"PlacedSymbolArray");class ko extends Xs{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ko.prototype.size=76;class Ao extends yo{get(e){return new ko(this,e)}}zr(Ao,"SymbolInstanceArray");class Io extends vo{getoffsetX(e){return this.float32[1*e+0]}}zr(Io,"GlyphOffsetArray");class Ro extends Qs{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}zr(Ro,"SymbolLineVertexArray");class Oo extends Xs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Oo.prototype.size=12;class No extends bo{get(e){return new Oo(this,e)}}zr(No,"FeatureIndexArray");class Do extends wo{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}zr(Do,"FillExtrusionCentroidArray");const zo=Ys([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Lo=Ys([{name:"a_dash",components:4,type:"Uint16"}]);var Bo={exports:{}},Fo={exports:{}};Fo.exports=function(e,t){var i,n,r,s,o,a,l,c;for(n=e.length-(i=3&e.length),r=t,o=3432918353,a=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(s=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var jo=Fo.exports,Vo={exports:{}};Vo.exports=function(e,t){for(var i,n=e.length,r=t^n,s=0;n>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++s;switch(n){case 3:r^=(255&e.charCodeAt(s+2))<<16;case 2:r^=(255&e.charCodeAt(s+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(s)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var Uo=jo,qo=Vo.exports;Bo.exports=Uo,Bo.exports.murmur3=Uo,Bo.exports.murmur2=qo;var Ho=d(Bo.exports);class Go{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,i,n){this.ids.push(Wo(e)),this.positions.push(t,i,n)}getPositions(e){const t=Wo(e);let i=0,n=this.ids.length-1;for(;i<n;){const e=i+n>>1;this.ids[e]>=t?n=e:i=e+1}const r=[];for(;this.ids[i]===t;)r.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return r}static serialize(e,t){const i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return function e(t,i,n,r){for(;n<r;){const s=t[n+r>>1];let o=n-1,a=r+1;for(;;){do{o++}while(t[o]<s);do{a--}while(t[a]>s);if(o>=a)break;Zo(t,o,a),Zo(i,3*o,3*a),Zo(i,3*o+1,3*a+1),Zo(i,3*o+2,3*a+2)}a-n<r-a?(e(t,i,n,a),n=a+1):(e(t,i,a+1,r),r=a)}}(i,n,0,i.length-1),t&&t.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(e){const t=new Go;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function Wo(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Ho(String(e))}function Zo(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}zr(Go,"FeaturePositionMap");class $o{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}}class Xo extends $o{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Ko extends $o{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3])))}}class Yo extends $o{constructor(e){super(e),this.current=It.transparent}set(e,t,i){this.fetchUniformLocation(e,t)&&(i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a)))}}const Jo=new Float32Array(16),Qo=new Float32Array(9),ea=new Float32Array(4);function ta(e){return[Zs(255*e.r,255*e.g),Zs(255*e.b,255*e.a)]}class ia{constructor(e,t,i){this.value=e,this.uniformNames=t.map(e=>"u_"+e),this.type=i}setUniform(e,t,i,n,r){t.set(e,r,n.constantOr(this.value))}getBinding(e,t){return"color"===this.type?new Yo(e):new Xo(e)}}class na{constructor(e,t){this.uniformNames=t.map(e=>"u_"+e),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,i,n,r){const s="u_pattern"===r||"u_dash"===r?this.pattern:"u_pixel_ratio"===r?this.pixelRatio:null;s&&t.set(e,r,s)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new Ko(e):new Xo(e)}}class ra{constructor(e,t,i,n){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_"+e,type:"Float32",components:"color"===i?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,t,i,n,r,s){const o=this.paintVertexArray.length,a=this.expression.evaluate(new Ns(0),t,{},r,n,s);this.paintVertexArray.resize(e),this._setPaintValue(o,e,a)}updatePaintArray(e,t,i,n,r){const s=this.expression.evaluate({zoom:0},i,n,void 0,r);this._setPaintValue(e,t,s)}_setPaintValue(e,t,i){if("color"===this.type){const n=ta(i);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sa{constructor(e,t,i,n,r,s){this.expression=e,this.uniformNames=t.map(e=>`u_${e}_t`),this.type=i,this.useIntegerZoom=n,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_"+e,type:"Float32",components:"color"===i?4:2,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,t,i,n,r,s){const o=this.expression.evaluate(new Ns(this.zoom),t,{},r,n,s),a=this.expression.evaluate(new Ns(this.zoom+1),t,{},r,n,s),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,a)}updatePaintArray(e,t,i,n,r){const s=this.expression.evaluate({zoom:this.zoom},i,n,void 0,r),o=this.expression.evaluate({zoom:this.zoom+1},i,n,void 0,r);this._setPaintValue(e,t,s,o)}_setPaintValue(e,t,i,n){if("color"===this.type){const r=ta(i),s=ta(n);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r[0],r[1],s[0],s[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,i,n,r){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,o=P(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(e,r,o)}getBinding(e,t){return new Xo(e)}}class oa{constructor(e,t,i,n,r){this.expression=e,this.layerId=r,this.paintVertexAttributes=("array"===i?Lo:zo).members;for(let s=0;s<t.length;++s);this.paintVertexArray=new n}populatePaintArray(e,t,i){const n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],i)}updatePaintArray(e,t,i,n,r,s){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],s)}_setPaintValues(e,t,i,n){if(!n||!i)return;const r=n[i];if(!r)return;const{tl:s,br:o,pixelRatio:a}=r;for(let l=e;l<t;l++)this.paintVertexArray.emplace(l,s[0],s[1],o[0],o[1],a)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class aa{constructor(e,t,i=(()=>!0)){this.binders={},this._buffers=[];const n=[];for(const r in e.paint._values){if(!i(r))continue;const s=e.paint.get(r);if(!(s instanceof Vs&&An(s.property.specification)))continue;const o=ha(r,e.type),a=s.value,l=s.property.specification.type,c=!!s.property.useIntegerZoom,h="line-dasharray"===r||r.endsWith("pattern"),u="line-dasharray"===r&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==a.kind||u)if("source"===a.kind||u||h){const t=pa(r,l,"source");this.binders[r]=h?new oa(a,o,l,t,e.id):new ra(a,o,l,t),n.push("/a_"+r)}else{const e=pa(r,l,"composite");this.binders[r]=new sa(a,o,l,c,t,e),n.push("/z_"+r)}else this.binders[r]=h?new na(a.value,o):new ia(a.value,o,l),n.push("/u_"+r)}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof ra||t instanceof sa?t.maxValue:0}populatePaintArrays(e,t,i,n,r,s){for(const o in this.binders){const a=this.binders[o];(a instanceof ra||a instanceof sa||a instanceof oa)&&a.populatePaintArray(e,t,i,n,r,s)}}setConstantPatternPositions(e){for(const t in this.binders){const i=this.binders[t];i instanceof na&&i.setConstantPatternPositions(e)}}updatePaintArrays(e,t,i,n,r,s){let o=!1;for(const a in e){const l=t.getPositions(a);for(const t of l){const l=i.feature(t.index);for(const i in this.binders){const c=this.binders[i];if((c instanceof ra||c instanceof sa||c instanceof oa)&&!0===c.expression.isStateDependent){const h=n.paint.get(i);c.expression=h.value,c.updatePaintArray(t.start,t.end,l,e[a],r,s),o=!0}}}}return o}defines(){const e=[];for(const t in this.binders){const i=this.binders[t];(i instanceof ia||i instanceof na)&&e.push(...i.uniformNames.map(e=>"#define HAS_UNIFORM_"+e))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof ra||i instanceof sa||i instanceof oa)for(let t=0;t<i.paintVertexAttributes.length;t++)e.push(i.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof ia||i instanceof na||i instanceof sa)for(const t of i.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const i in this.binders){const n=this.binders[i];if(n instanceof ia||n instanceof na||n instanceof sa)for(const r of n.uniformNames)t.push({name:r,property:i,binding:n.getBinding(e,r)})}return t}setUniforms(e,t,i,n,r){for(const{name:s,property:o,binding:a}of i)this.binders[o].setUniform(e,a,r,n.get(o),s)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof ra||t instanceof sa||t instanceof oa)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const i=this.binders[t];(i instanceof ra||i instanceof sa||i instanceof oa)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof ra||t instanceof sa||t instanceof oa)&&t.destroy()}}}class la{constructor(e,t,i=(()=>!0)){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new aa(n,t,i);this.needsUpload=!1,this._featureMap=new Go,this._bufferOffset=0}populatePaintArrays(e,t,i,n,r,s,o){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,n,r,s,o);void 0!==t.id&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,i,n,r){for(const s of i)this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(e,this._featureMap,t,s,n,r)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const ca={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function ha(e,t){return ca[e]||[e.replace(t+"-","").replace(/-/g,"_")]}const ua={"line-pattern":{source:ro,composite:ro},"fill-pattern":{source:ro,composite:ro},"fill-extrusion-pattern":{source:ro,composite:ro},"line-dasharray":{source:so,composite:so}},da={color:{source:So,composite:no},number:{source:vo,composite:So}};function pa(e,t,i){const n=ua[e];return n&&n[i]||da[t][i]}zr(ia,"ConstantBinder"),zr(na,"PatternConstantBinder"),zr(ra,"SourceExpressionBinder"),zr(oa,"PatternCompositeBinder"),zr(sa,"CompositeExpressionBinder"),zr(aa,"ProgramConfiguration",{omit:["_buffers"]}),zr(la,"ProgramConfigurationSet");const ma="-transition";class fa extends Qe{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new js(t.layout)),t.paint)){this._transitionablePaint=new Ls(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Us(t.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,i={}){null!=t&&this._validate(kr,`layers.${this.id}.layout.${e}`,e,t,i)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return F(e,ma)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,i={}){if(null!=t&&this._validate(Mr,`layers.${this.id}.paint.${e}`,e,t,i))return!1;if(F(e,ma))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const i=this._transitionablePaint._values[e],n=i.value.isDataDriven(),r=i.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const s=this._transitionablePaint._values[e].value,o=s.isDataDriven(),a=F(e,"pattern")||"line-dasharray"===e;return o||n||a||this._handleOverridablePaintPropertyUpdate(e,r,s)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,t,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),V(e,(e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length))}_validate(e,t,i,n,r={}){return(!r||!1!==r.validate)&&Ir(this,e.call(Pr,{key:t,layerType:this.type,objectKey:i,value:n,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Vs&&An(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ir(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ga=Ys([{name:"a_pos",components:2,type:"Int16"}],4),_a=Ys([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ya{constructor(e=[]){this.segments=e}prepareSegment(e,t,i,n){let r=this.segments[this.segments.length-1];return e>ya.MAX_VERTEX_ARRAY_LENGTH&&H(`Max vertices per segment is ${ya.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!r||r.vertexLength+e>ya.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==n)&&(r={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(r.sortKey=n),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,i,n){return new ya([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}}ya.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zr(ya,"SegmentVector");var va=8192;class xa{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Xl?new Xl(e.lng,e.lat):Xl.convert(e),this}setSouthWest(e){return this._sw=e instanceof Xl?new Xl(e.lng,e.lat):Xl.convert(e),this}extend(e){const t=this._sw,i=this._ne;let n,r;if(e instanceof Xl)n=e,r=e;else{if(!(e instanceof xa))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(xa.convert(e)):this.extend(Xl.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Xl.convert(e)):this;if(n=e._sw,r=e._ne,!n||!r)return this}return t||i?(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new Xl(n.lng,n.lat),this._ne=new Xl(r.lng,r.lat)),this}getCenter(){return new Xl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Xl(this.getWest(),this.getNorth())}getSouthEast(){return new Xl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:i}=Xl.convert(e);let n=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n}static convert(e){return!e||e instanceof xa?e:new xa(e)}}var ba=1e-6,wa="undefined"!=typeof Float32Array?Float32Array:Array;function Ca(){var e=new wa(9);return wa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Sa(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=i[0],p=i[1],m=i[2],f=i[3],g=i[4],_=i[5],y=i[6],v=i[7],x=i[8];return e[0]=d*n+p*o+m*c,e[1]=d*r+p*a+m*h,e[2]=d*s+p*l+m*u,e[3]=f*n+g*o+_*c,e[4]=f*r+g*a+_*h,e[5]=f*s+g*l+_*u,e[6]=y*n+v*o+x*c,e[7]=y*r+v*a+x*h,e[8]=y*s+v*l+x*u,e}function Ea(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ta(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],y=i*a-n*o,v=i*l-r*o,x=i*c-s*o,b=n*l-r*a,w=n*c-s*a,C=r*c-s*l,S=h*f-u*m,E=h*g-d*m,T=h*_-p*m,P=u*g-d*f,M=u*_-p*f,k=d*_-p*g,A=y*k-v*M+x*P+b*T-w*E+C*S;return A?(e[0]=(a*k-l*M+c*P)*(A=1/A),e[1]=(r*M-n*k-s*P)*A,e[2]=(f*C-g*w+_*b)*A,e[3]=(d*w-u*C-p*b)*A,e[4]=(l*T-o*k-c*E)*A,e[5]=(i*k-r*T+s*E)*A,e[6]=(g*x-m*C-_*v)*A,e[7]=(h*C-d*x+p*v)*A,e[8]=(o*M-a*T+c*S)*A,e[9]=(n*T-i*M-s*S)*A,e[10]=(m*w-f*x+_*y)*A,e[11]=(u*x-h*w-p*y)*A,e[12]=(a*E-o*P-l*S)*A,e[13]=(i*P-n*E+r*S)*A,e[14]=(f*v-m*b-g*y)*A,e[15]=(h*b-u*v+d*y)*A,e):null}function Pa(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],_=t[14],y=t[15],v=i[0],x=i[1],b=i[2],w=i[3];return e[0]=v*n+x*a+b*u+w*f,e[1]=v*r+x*l+b*d+w*g,e[2]=v*s+x*c+b*p+w*_,e[3]=v*o+x*h+b*m+w*y,e[4]=(v=i[4])*n+(x=i[5])*a+(b=i[6])*u+(w=i[7])*f,e[5]=v*r+x*l+b*d+w*g,e[6]=v*s+x*c+b*p+w*_,e[7]=v*o+x*h+b*m+w*y,e[8]=(v=i[8])*n+(x=i[9])*a+(b=i[10])*u+(w=i[11])*f,e[9]=v*r+x*l+b*d+w*g,e[10]=v*s+x*c+b*p+w*_,e[11]=v*o+x*h+b*m+w*y,e[12]=(v=i[12])*n+(x=i[13])*a+(b=i[14])*u+(w=i[15])*f,e[13]=v*r+x*l+b*d+w*g,e[14]=v*s+x*c+b*p+w*_,e[15]=v*o+x*h+b*m+w*y,e}function Ma(e,t,i){var n,r,s,o,a,l,c,h,u,d,p,m,f=i[0],g=i[1],_=i[2];return t===e?(e[12]=t[0]*f+t[4]*g+t[8]*_+t[12],e[13]=t[1]*f+t[5]*g+t[9]*_+t[13],e[14]=t[2]*f+t[6]*g+t[10]*_+t[14],e[15]=t[3]*f+t[7]*g+t[11]*_+t[15]):(r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=t[9],p=t[10],m=t[11],e[0]=n=t[0],e[1]=r,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=h,e[8]=u,e[9]=d,e[10]=p,e[11]=m,e[12]=n*f+a*g+u*_+t[12],e[13]=r*f+l*g+d*_+t[13],e[14]=s*f+c*g+p*_+t[14],e[15]=o*f+h*g+m*_+t[15]),e}function ka(e,t,i){var n=i[0],r=i[1],s=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Aa(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*n,e[5]=o*r+h*n,e[6]=a*r+u*n,e[7]=l*r+d*n,e[8]=c*r-s*n,e[9]=h*r-o*n,e[10]=u*r-a*n,e[11]=d*r-l*n,e}function Ia(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],h=t[9],u=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r-c*n,e[1]=o*r-h*n,e[2]=a*r-u*n,e[3]=l*r-d*n,e[8]=s*n+c*r,e[9]=o*n+h*r,e[10]=a*n+u*r,e[11]=l*n+d*r,e}function Ra(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Oa(e,t,i){var n,r,s,o=i[0],a=i[1],l=i[2],c=Math.hypot(o,a,l);return c<ba?null:(o*=c=1/c,a*=c,l*=c,n=Math.sin(t),r=Math.cos(t),e[0]=o*o*(s=1-r)+r,e[1]=a*o*s+l*n,e[2]=l*o*s-a*n,e[3]=0,e[4]=o*a*s-l*n,e[5]=a*a*s+r,e[6]=l*a*s+o*n,e[7]=0,e[8]=o*l*s+a*n,e[9]=a*l*s-o*n,e[10]=l*l*s+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Na=Pa;function Da(){var e=new wa(3);return wa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function za(e){var t=new wa(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function La(e){return Math.hypot(e[0],e[1],e[2])}function Ba(e,t,i){var n=new wa(3);return n[0]=e,n[1]=t,n[2]=i,n}function Fa(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function ja(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Va(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Ua(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function qa(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function Ha(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ga(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e}function Wa(e,t){var i=t[0],n=t[1],r=t[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function Za(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function $a(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[0],a=i[1],l=i[2];return e[0]=r*l-s*a,e[1]=s*o-n*l,e[2]=n*a-r*o,e}function Xa(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[3]*n+i[7]*r+i[11]*s+i[15];return e[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/(o=o||1),e[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/o,e}function Ka(e,t,i){var n=i[0],r=i[1],s=i[2],o=t[0],a=t[1],l=t[2],c=r*l-s*a,h=s*o-n*l,u=n*a-r*o,d=r*u-s*h,p=s*c-n*u,m=n*h-r*c,f=2*i[3];return h*=f,u*=f,p*=2,m*=2,e[0]=o+(c*=f)+(d*=2),e[1]=a+h+p,e[2]=l+u+m,e}var Ya,Ja=ja,Qa=Va,el=La;function tl(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function il(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i*i+n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=i*o,e[1]=n*o,e[2]=r*o,e[3]=s*o,e}function nl(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,e}function rl(){var e=new wa(4);return wa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function sl(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ol(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l+o*a,e[1]=r*l+s*a,e[2]=s*l-r*a,e[3]=o*l-n*a,e}function al(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l-s*a,e[1]=r*l+o*a,e[2]=s*l+n*a,e[3]=o*l-r*a,e}Da(),Ya=new wa(4),wa!=Float32Array&&(Ya[0]=0,Ya[1]=0,Ya[2]=0,Ya[3]=0);var ll=il;Da(),Ba(1,0,0),Ba(0,1,0),rl(),rl(),Ca();const cl=Ys([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:hl}=cl,ul=Ys([{name:"a_pos_3",components:3,type:"Int16"}]);var dl=Ys([{name:"a_pos",type:"Int16",components:2}]);class pl{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,i){const n=Za(t,this.dir);if(Math.abs(n)<1e-6)return!1;const r=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/n;return i[0]=this.pos[0]+this.dir[0]*r,i[1]=this.pos[1]+this.dir[1]*r,i[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(e,t,i){if(function(e,t){var i=e[0],n=e[1],r=e[2],s=t[0],o=t[1],a=t[2];return Math.abs(i-s)<=ba*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-o)<=ba*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=ba*Math.max(1,Math.abs(r),Math.abs(a))}(this.pos,e)||0===t)return i[0]=i[1]=i[2]=0,!1;const[n,r,s]=this.dir,o=this.pos[0]-e[0],a=this.pos[1]-e[1],l=this.pos[2]-e[2],c=n*n+r*r+s*s,h=2*(o*n+a*r+l*s),u=h*h-4*c*(o*o+a*a+l*l-t*t);if(u<0){const e=Math.max(-h/2,0),c=o+n*e,u=a+r*e,d=l+s*e,p=Math.hypot(c,u,d);return i[0]=c*t/p,i[1]=u*t/p,i[2]=d*t/p,!1}{const e=(-h-Math.sqrt(u))/(2*c);if(e<0){const e=Math.hypot(o,a,l);return i[0]=o*t/e,i[1]=a*t/e,i[2]=l*t/e,!1}return i[0]=o+n*e,i[1]=a+r*e,i[2]=l+s*e,!0}}}class ml{constructor(e,t,i,n,r){this.TL=e,this.TR=t,this.BR=i,this.BL=n,this.horizon=r}static fromInvProjectionMatrix(e,t,i){const n=[-1,1,1],r=[1,1,1],s=[1,-1,1],o=[-1,-1,1],a=Xa(n,n,e),l=Xa(r,r,e),c=Xa(s,s,e),h=Xa(o,o,e);return new ml(a,l,c,h,t/i)}}class fl{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,i,n){const r=Math.pow(2,i),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const s=nl([],i,e),o=1/s[3]/t*r;return function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}(s,s,[o,o,n?1/s[3]:o,o])}),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const t=Wa([],$a([],Ja([],s[e[0]],s[e[1]]),Ja([],s[e[2]],s[e[1]]))),i=-Za(t,s[e[1]]);return t.concat(i)});return new fl(s,o)}}class gl{static fromPoints(e){const t=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const n of e)Ua(t,t,n),qa(i,i,n);return new gl(t,i)}static applyTransform(e,t){const i=e.getCorners();for(let n=0;n<i.length;++n)Xa(i[n],i[n],t);return gl.fromPoints(i)}constructor(e,t){this.min=e,this.max=t,this.center=Ha([],Fa([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],i=za(this.min),n=za(this.max);for(let r=0;r<t.length;r++)i[r]=t[r]?this.min[r]:this.center[r],n[r]=t[r]?this.center[r]:this.max[r];return n[2]=this.max[2],new gl(i,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){const t=this.getCorners();let i=!0;for(let n=0;n<e.planes.length;n++){const r=e.planes[n];let s=0;for(let e=0;e<t.length;e++)s+=Za(r,t[e])+r[3]>=0;if(0===s)return 0;s!==t.length&&(i=!1)}if(i)return 2;for(let n=0;n<3;n++){let t=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const s=e.points[r][n]-this.min[n];t=Math.min(t,s),i=Math.max(i,s)}if(i<0||t>this.max[n]-this.min[n])return 0}return 1}}const _l=va/Math.PI/2,yl=[64,32,16],vl=-_l,xl=_l,bl=[new gl([vl,vl,vl],[xl,xl,xl]),new gl([vl,vl,vl],[0,0,xl]),new gl([0,vl,vl],[xl,0,xl]),new gl([vl,0,vl],[0,xl,xl]),new gl([0,0,vl],[xl,xl,xl])];function wl(e){return e*_l/Wl}function Cl(e,t,i,n=!0){const r=Ha([],e._camera.position,e.worldSize),s=[t,i,1,1];nl(s,s,e.pixelMatrixInverse),tl(s,s,1/s[3]);const o=Wa([],Ja([],s,r)),a=e.globeMatrix,l=[a[12],a[13],a[14]],c=Ja([],l,r),h=La(c),u=Wa([],c),d=e.worldSize/(2*Math.PI),p=Za(u,o),m=Math.asin(d/h);if(m<Math.acos(p)){if(!n)return null;const e=[],t=[];Ha(e,o,h/p),Wa(t,Ja(t,e,c)),Wa(o,Fa(o,c,Ha(o,t,Math.tan(m)*h)))}const f=[];new pl(r,o).closestPointOnSphere(l,d,f);const g=Wa([],J(a,0)),_=Wa([],J(a,1)),y=Wa([],J(a,2)),v=Za(g,f),x=Za(_,f),b=Za(y,f),C=w(Math.asin(-x/d));let S=w(Math.atan2(v,b));S=e.center.lng+function(e,t){const i=(t-e+180)%360-180;return i<-180?i+360:i}(e.center.lng,S);const E=Yl(S),T=P(Jl(C),0,1);return new sc(E,T)}class Sl{constructor(e,t,i){this.a=Ja([],e,i),this.b=Ja([],t,i),this.center=i;const n=Wa([],this.a),r=Wa([],this.b);this.angle=Math.acos(Za(n,r))}}function El(e,t){if(0===e.angle)return null;let i;return i=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),i<0||i>1?null:function(e,t,i,n){const r=Math.sin(i);return e*(Math.sin((1-n)*i)/r)+t*(Math.sin(n*i)/r)}(e.a[t],e.b[t],e.angle,P(i,0,1))+e.center[t]}function Tl(e){if(e.z<=1)return bl[e.z+2*e.y+e.x];const t=Il(Al(e));return gl.fromPoints(t)}function Pl(e,t,i){return Ha(e,e,1-i),Ga(e,e,t,i)}function Ml(e,t){const i=jl(t.zoom);if(0===i)return Tl(e);const n=Al(e),r=Il(n),s=Yl(n.getWest())*t.worldSize,o=Yl(n.getEast())*t.worldSize,a=Jl(n.getNorth())*t.worldSize,l=Jl(n.getSouth())*t.worldSize,c=[s,a,0],h=[o,a,0],u=[s,l,0],d=[o,l,0],p=Ta([],t.globeMatrix);return Xa(c,c,p),Xa(h,h,p),Xa(u,u,p),Xa(d,d,p),r[0]=Pl(r[0],u,i),r[1]=Pl(r[1],d,i),r[2]=Pl(r[2],h,i),r[3]=Pl(r[3],c,i),gl.fromPoints(r)}function kl(e,t,i){for(const n of e)Xa(n,n,t),Ha(n,n,i)}function Al({x:e,y:t,z:i}){const n=1/(1<<i),r=new Xl(ec(e*n),tc((t+1)*n)),s=new Xl(ec((e+1)*n),tc(t*n));return new xa(r,s)}function Il(e){const t=b(e.getNorth()),i=b(e.getSouth()),n=Math.cos(t),r=Math.cos(i),s=Math.sin(t),o=Math.sin(i),a=e.getWest(),l=e.getEast();return[Rl(r,o,a),Rl(r,o,l),Rl(n,s,l),Rl(n,s,a)]}function Rl(e,t,i,n=_l){return i=b(i),[e*Math.sin(i)*n,-t*n,e*Math.cos(i)*n]}function Ol(e,t,i){return Rl(Math.cos(b(e)),Math.sin(b(e)),t,i)}function Nl(e,t,i,n){const r=1<<i.z,s=(e/va+i.x)/r;return Ol(tc((t/va+i.y)/r),ec(s),n)}function Dl({min:e,max:t}){return 16383/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const zl=new Float64Array(16);function Ll(e){const t=Dl(e),i=Ra(zl,[t,t,t]);return Ma(i,i,((n=[])[0]=-(r=e.min)[0],n[1]=-r[1],n[2]=-r[2],n));var n,r}function Bl(e){const t=(n=e.min,(i=zl)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=n[0],i[13]=n[1],i[14]=n[2],i[15]=1,i);var i,n;const r=1/Dl(e);return ka(t,t,[r,r,r])}function Fl(e,t,i,n,r){const s=function(e){const t=va/(2*Math.PI);return e/(2*Math.PI)/t}(i),o=[e,t,-i/(2*Math.PI)],a=Ea(new Float64Array(16));return Ma(a,a,o),ka(a,a,[s,s,s]),Aa(a,a,b(-r)),Ia(a,a,b(-n)),a}function jl(e){return M(5,6,e)}function Vl(e,t){const i=Ol(t.lat,t.lng);return s=(n=ja([],function(e){const t=Ol(e._center.lat,e._center.lng);let i=$a([],Ba(0,1,0),t);const n=Oa([],-e.angle,t);i=Xa(i,i,n),Oa(n,-e._pitch,i);const r=Wa([],t);return Ha(r,r,wl(e.cameraToCenterDistance/e.pixelsPerMeter)),Xa(r,r,n),Fa([],t,r)}(e),i))[0],o=n[1],a=n[2],l=(r=i)[0],c=r[1],h=r[2],d=(u=Math.sqrt(s*s+o*o+a*a)*Math.sqrt(l*l+c*c+h*h))&&Za(n,r)/u,Math.acos(Math.min(Math.max(d,-1),1));var n,r,s,o,a,l,c,h,u,d}function Ul(e,t){return Vl(e,t)>Math.PI/2*1.01}const ql=b(85),Hl=Math.cos(ql),Gl=Math.sin(ql),Wl=6371008.8,Zl=2*Math.PI*Wl;class $l{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $l(k(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,i=this.lat*t,n=e.lat*t,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Wl*Math.acos(Math.min(r,1))}toBounds(e=0){const t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new xa(new $l(this.lng-i,this.lat-t),new $l(this.lng+i,this.lat+t))}toEcef(e){const t=wl(e);return Ol(this.lat,this.lng,_l+t)}static convert(e){if(e instanceof $l)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new $l(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new $l(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Xl=$l;function Kl(e){return Zl*Math.cos(e*Math.PI/180)}function Yl(e){return(180+e)/360}function Jl(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ql(e,t){return e/Kl(t)}function ec(e){return 360*e-180}function tc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function ic(e,t){return e*Kl(tc(t))}const nc=85.051129;function rc(e){return 1/Math.cos(e*Math.PI/180)}class sc{constructor(e,t,i=0){this.x=+e,this.y=+t,this.z=+i}static fromLngLat(e,t=0){const i=Xl.convert(e);return new sc(Yl(i.lng),Jl(i.lat),Ql(t,i.lat))}toLngLat(){return new Xl(ec(this.x),tc(this.y))}toAltitude(){return ic(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Zl*rc(tc(this.y))}}function oc(e,t,i,n,r,s,o,a,l){const c=(t+n)/2,h=(i+r)/2,u=new y(c,h);a(u),function(e,t,i,n,r,s){const o=i-r,a=n-s;return Math.abs((n-t)*o-(i-e)*a)/Math.hypot(o,a)}(u.x,u.y,s.x,s.y,o.x,o.y)>=l?(oc(e,t,i,c,h,s,u,a,l),oc(e,c,h,n,r,u,o,a,l)):e.push(o)}function ac(e,t,i){let n=e[0],r=n.x,s=n.y;t(n);const o=[n];for(let a=1;a<e.length;a++){const l=e[a],{x:c,y:h}=l;t(l),oc(o,r,s,c,h,n,l,t,i),r=c,s=h,n=l}return o}function lc(e,t,i,n){if(n(t,i)){const r=t.add(i)._mult(.5);lc(e,t,r,n),lc(e,r,i,n)}else e.push(i)}function cc(e,t){let i=e[0];const n=[i];for(let r=1;r<e.length;r++){const s=e[r];lc(n,i,s,t),i=s}return n}const hc=Math.pow(2,14)-1,uc=-hc-1;function dc(e,t){const i=Math.round(e.x*t),n=Math.round(e.y*t);return e.x=P(i,uc,hc),e.y=P(n,uc,hc),(i<e.x||i>e.x+1||n<e.y||n>e.y+1)&&H("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function pc(e,t,i){const n=e.loadGeometry(),r=e.extent,s=va/r;if(t&&i&&i.projection.isReprojectedInTileSpace){const s=1<<t.z,{scale:o,x:a,y:l,projection:c}=i,h=e=>{const i=ec((t.x+e.x/r)/s),n=tc((t.y+e.y/r)/s),h=c.project(i,n);e.x=(h.x*o-a)*r,e.y=(h.y*o-l)*r};for(let t=0;t<n.length;t++)if(1!==e.type)n[t]=ac(n[t],h,1);else{const e=[];for(const i of n[t])i.x<0||i.x>=r||i.y<0||i.y>=r||(h(i),e.push(i));n[t]=e}}for(const o of n)for(const e of o)dc(e,s);return n}function mc(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?pc(e):[]}}function fc(e,t,i,n,r){e.emplaceBack(2*t+(n+1)/2,2*i+(r+1)/2)}function gc(e,t,i){const n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}class _c{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Qs,this.indexArray=new go,this.segments=new ya,this.programConfigurations=new la(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,i,n){const r=this.layers[0],s=[];let o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(const{feature:l,id:c,index:h,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,t=mc(l,e);if(!this.layers[0]._featureFilter.filter(new Ns(this.zoom),t,i))continue;const r=o?o.evaluate(t,{},i):void 0,a={id:c,properties:l.properties,type:l.type,sourceLayerIndex:u,index:h,geometry:e?t.geometry:pc(l,i,n),patterns:{},sortKey:r};s.push(a)}o&&s.sort((e,t)=>e.sortKey-t.sortKey);let a=null;"globe"===n.projection.name&&(this.globeExtVertexArray=new oo,a=n.projection);for(const l of s){const{geometry:n,index:r,sourceLayerIndex:s}=l,o=e[r].feature;this.addFeature(l,n,r,t.availableImages,i,a),t.featureIndex.insert(o,n,r,s,this.index)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ga.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,_a.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,i,n,r,s){for(const o of t)for(const t of o){const i=t.x,n=t.y;if(i<0||i>=va||n<0||n>=va)continue;if(s){const e=s.projectTilePoint(i,n,r),t=s.upVector(r,i,n),o=this.globeExtVertexArray;gc(o,e,t),gc(o,e,t),gc(o,e,t),gc(o,e,t)}const o=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=o.vertexLength;fc(this.layoutVertexArray,i,n,-1,-1),fc(this.layoutVertexArray,i,n,1,-1),fc(this.layoutVertexArray,i,n,1,1),fc(this.layoutVertexArray,i,n,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),o.vertexLength+=4,o.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n,r)}}function yc(e,t){for(let i=0;i<e.length;i++)if(Pc(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(Pc(e,t[i]))return!0;return!!wc(e,t)}function vc(e,t,i){return!!Pc(e,t)||!!Sc(t,e,i)}function xc(e,t){if(1===e.length)return Tc(t,e[0]);for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<n.length;t++)if(Pc(e,n[t]))return!0}for(let i=0;i<e.length;i++)if(Tc(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(wc(e,t[i]))return!0;return!1}function bc(e,t,i){if(e.length>1){if(wc(e,t))return!0;for(let n=0;n<t.length;n++)if(Sc(t[n],e,i))return!0}for(let n=0;n<e.length;n++)if(Sc(e[n],t,i))return!0;return!1}function wc(e,t){if(0===e.length||0===t.length)return!1;for(let i=0;i<e.length-1;i++){const n=e[i],r=e[i+1];for(let e=0;e<t.length-1;e++)if(Cc(n,r,t[e],t[e+1]))return!0}return!1}function Cc(e,t,i,n){return G(e,i,n)!==G(t,i,n)&&G(e,t,i)!==G(e,t,n)}function Sc(e,t,i){const n=i*i;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(Ec(e,t[r-1],t[r])<n)return!0;return!1}function Ec(e,t,i){const n=t.distSqr(i);if(0===n)return e.distSqr(t);const r=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/n;return e.distSqr(r<0?t:r>1?i:i.sub(t)._mult(r)._add(t))}function Tc(e,t){let i,n,r,s=!1;for(let o=0;o<e.length;o++){i=e[o];for(let e=0,o=i.length-1;e<i.length;o=e++)n=i[e],r=i[o],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(s=!s)}return s}function Pc(e,t){let i=!1;for(let n=0,r=e.length-1;n<e.length;r=n++){const s=e[n],o=e[r];s.y>t.y!=o.y>t.y&&t.x<(o.x-s.x)*(t.y-s.y)/(o.y-s.y)+s.x&&(i=!i)}return i}function Mc(e,t,i,n,r){for(const o of e)if(t<=o.x&&i<=o.y&&n>=o.x&&r>=o.y)return!0;const s=[new y(t,i),new y(t,r),new y(n,r),new y(n,i)];if(e.length>2)for(const o of s)if(Pc(e,o))return!0;for(let o=0;o<e.length-1;o++)if(kc(e[o],e[o+1],s))return!0;return!1}function kc(e,t,i){const n=i[0],r=i[2];if(e.x<n.x&&t.x<n.x||e.x>r.x&&t.x>r.x||e.y<n.y&&t.y<n.y||e.y>r.y&&t.y>r.y)return!1;const s=G(e,t,i[0]);return s!==G(e,t,i[1])||s!==G(e,t,i[2])||s!==G(e,t,i[3])}function Ac(e,t,i){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ic(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Rc(e,t,i,n,r){if(!t[0]&&!t[1])return e;const s=y.convert(t)._mult(r);"viewport"===i&&s._rotate(-n);const o=[];for(let a=0;a<e.length;a++)o.push(e[a].sub(s));return o}function Oc(e,t,i,n){const r=y.convert(e)._mult(n);return"viewport"===t&&r._rotate(-i),r}zr(_c,"CircleBucket",{omit:["layers"]});const Nc=new Ws({"circle-sort-key":new Hs(et.layout_circle["circle-sort-key"])});var Dc={paint:new Ws({"circle-radius":new Hs(et.paint_circle["circle-radius"]),"circle-color":new Hs(et.paint_circle["circle-color"]),"circle-blur":new Hs(et.paint_circle["circle-blur"]),"circle-opacity":new Hs(et.paint_circle["circle-opacity"]),"circle-translate":new qs(et.paint_circle["circle-translate"]),"circle-translate-anchor":new qs(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qs(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qs(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Hs(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Hs(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Hs(et.paint_circle["circle-stroke-opacity"])}),layout:Nc};function zc(e,t,i,n,r,s,o,a,l){if(s&&e.queryGeometry.isAboveHorizon)return!1;s&&(l*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,h=i.projection.upVectorScale(c,i.center.lat,i.worldSize).metersToTile;for(const u of t)for(const t of u){const u=t.add(a),d=r&&i.elevation?i.elevation.exaggeration()*r.getElevationAt(u.x,u.y,!0):0,p=i.projection.projectTilePoint(u.x,u.y,c);if(d>0){const e=i.projection.upVector(c,u.x,u.y);p.x+=e[0]*h*d,p.y+=e[1]*h*d,p.z+=e[2]*h*d}const m=s?u:Lc(p.x,p.y,p.z,n),f=s?e.tilespaceRays.map(e=>jc(e,d)):e.queryGeometry.screenGeometry,g=nl([],[p.x,p.y,p.z,1],n);if(!o&&s?l*=g[3]/i.cameraToCenterDistance:o&&!s&&(l*=i.cameraToCenterDistance/g[3]),s){const e=tc((t.y/va+c.y)/(1<<c.z));l/=i.projection.pixelsPerMeter(e,1)/Ql(1,e)}if(vc(f,m,l))return!0}return!1}function Lc(e,t,i,n){const r=nl([],[e,t,i,1],n);return new y(r[0]/r[3],r[1]/r[3])}const Bc=Ba(0,0,0),Fc=Ba(0,0,1);function jc(e,t){const i=Da();return Bc[2]=t,e.intersectsPlane(Bc,Fc,i),new y(i[0],i[1])}class Vc extends _c{}function Uc(e,{width:t,height:i},n,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==t*i*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(t*i*n);return e.width=t,e.height=i,e.data=r,e}function qc(e,t,i){const{width:n,height:r}=t;n===e.width&&r===e.height||(Hc(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,r)},i),e.width=n,e.height=r,e.data=t.data)}function Hc(e,t,i,n,r,s){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,a=t.data;for(let l=0;l<r.height;l++){const c=((i.y+l)*e.width+i.x)*s,h=((n.y+l)*t.width+n.x)*s;for(let e=0;e<r.width*s;e++)a[h+e]=o[c+e]}return t}zr(Vc,"HeatmapBucket",{omit:["layers"]});class Gc{constructor(e,t){Uc(this,e,1,t)}resize(e){qc(this,new Gc(e),1)}clone(){return new Gc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Hc(e,t,i,n,r,1)}}class Wc{constructor(e,t){Uc(this,e,4,t)}resize(e){qc(this,new Wc(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Wc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Hc(e,t,i,n,r,4)}}zr(Gc,"AlphaImage"),zr(Wc,"RGBAImage");var Zc={paint:new Ws({"heatmap-radius":new Hs(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Hs(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qs(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gs(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qs(et.paint_heatmap["heatmap-opacity"])})};function $c(e){const t={},i=e.resolution||256,n=e.clips?e.clips.length:1,r=e.image||new Wc({width:i,height:n}),s=(i,n,s)=>{t[e.evaluationKey]=s;const o=e.expression.evaluate(t);r.data[i+n+0]=Math.floor(255*o.r/o.a),r.data[i+n+1]=Math.floor(255*o.g/o.a),r.data[i+n+2]=Math.floor(255*o.b/o.a),r.data[i+n+3]=Math.floor(255*o.a)};if(e.clips)for(let o=0,a=0;o<n;++o,a+=4*i)for(let t=0,n=0;t<i;t++,n+=4){const r=t/(i-1),{start:l,end:c}=e.clips[o];s(a,n,l*(1-r)+c*r)}else for(let o=0,a=0;o<i;o++,a+=4)s(0,a,o/(i-1));return r}var Xc={paint:new Ws({"hillshade-illumination-direction":new qs(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qs(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qs(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qs(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qs(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qs(et.paint_hillshade["hillshade-accent-color"])})};const Kc=Ys([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yc}=Kc;var Jc={exports:{}};function Qc(e,t,i){i=i||2;var n,r,s,o,a,l,c,h=t&&t.length,u=h?t[0]*i:e.length,d=eh(e,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(e,t,i,n){var r,s,o,a=[];for(r=0,s=t.length;r<s;r++)(o=eh(e,t[r]*n,r<s-1?t[r+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),a.push(uh(o));for(a.sort(ah),r=0;r<a.length;r++)i=lh(a[r],i);return i}(e,t,d,i)),e.length>80*i){n=s=e[0],r=o=e[1];for(var m=i;m<u;m+=i)(a=e[m])<n&&(n=a),(l=e[m+1])<r&&(r=l),a>s&&(s=a),l>o&&(o=l);c=0!==(c=Math.max(s-n,o-r))?32767/c:0}return ih(d,p,i,n,r,c,0),p}function eh(e,t,i,n,r){var s,o;if(r===Sh(e,t,i,n)>0)for(s=t;s<i;s+=n)o=bh(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=bh(s,e[s],e[s+1],o);return o&&fh(o,o.next)&&(wh(o),o=o.next),o}function th(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!fh(n,n.next)&&0!==mh(n.prev,n,n.next))n=n.next;else{if(wh(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function ih(e,t,i,n,r,s,o){if(e){!o&&s&&function(e,t,i,n){var r=e;do{0===r.z&&(r.z=hh(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,s,o,a,l,c=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<c&&(a++,n=n.nextZ);t++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1)}(r)}(e,n,r,s);for(var a,l,c=e;e.prev!==e.next;)if(a=e.prev,l=e.next,s?rh(e,n,r,s):nh(e))t.push(a.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),wh(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?ih(e=sh(th(e),t,i),t,i,n,r,s,2):2===o&&oh(e,t,i,n,r,s):ih(th(e),t,i,n,r,s,1);break}}}function nh(e){var t=e.prev,i=e,n=e.next;if(mh(t,i,n)>=0)return!1;for(var r=t.x,s=i.x,o=n.x,a=t.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,m=n.next;m!==t;){if(m.x>=h&&m.x<=d&&m.y>=u&&m.y<=p&&dh(r,a,s,l,o,c,m.x,m.y)&&mh(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function rh(e,t,i,n){var r=e.prev,s=e,o=e.next;if(mh(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,m=h<u?h<d?h:d:u<d?u:d,f=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,_=hh(p,m,t,i,n),y=hh(f,g,t,i,n),v=e.prevZ,x=e.nextZ;v&&v.z>=_&&x&&x.z<=y;){if(v.x>=p&&v.x<=f&&v.y>=m&&v.y<=g&&v!==r&&v!==o&&dh(a,h,l,u,c,d,v.x,v.y)&&mh(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x.x>=p&&x.x<=f&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&dh(a,h,l,u,c,d,x.x,x.y)&&mh(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=_;){if(v.x>=p&&v.x<=f&&v.y>=m&&v.y<=g&&v!==r&&v!==o&&dh(a,h,l,u,c,d,v.x,v.y)&&mh(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=f&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&dh(a,h,l,u,c,d,x.x,x.y)&&mh(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function sh(e,t,i){var n=e;do{var r=n.prev,s=n.next.next;!fh(r,s)&&gh(r,n,n.next,s)&&vh(r,s)&&vh(s,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(s.i/i|0),wh(n),wh(n.next),n=e=s),n=n.next}while(n!==e);return th(n)}function oh(e,t,i,n,r,s){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ph(o,a)){var l=xh(o,a);return o=th(o,o.next),l=th(l,l.next),ih(o,t,i,n,r,s,0),void ih(l,t,i,n,r,s,0)}a=a.next}o=o.next}while(o!==e)}function ah(e,t){return e.x-t.x}function lh(e,t){var i=function(e,t){var i,n=t,r=e.x,s=e.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o&&(o=a,i=n.x<n.next.x?n:n.next,a===r))return i}n=n.next}while(n!==t);if(!i)return null;var l,c=i,h=i.x,u=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=h&&r!==n.x&&dh(s<u?r:o,s,h,u,s<u?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),vh(n,e)&&(l<d||l===d&&(n.x>i.x||n.x===i.x&&ch(i,n)))&&(i=n,d=l)),n=n.next}while(n!==c);return i}(e,t);if(!i)return t;var n=xh(i,e);return th(n,n.next),th(i,i.next)}function ch(e,t){return mh(e.prev,e,t.prev)<0&&mh(t.next,e,e.next)<0}function hh(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function uh(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function dh(e,t,i,n,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(n-a)>=(i-o)*(t-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function ph(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&gh(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(vh(e,t)&&vh(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(mh(e.prev,e,t.prev)||mh(e,t.prev,t))||fh(e,t)&&mh(e.prev,e,e.next)>0&&mh(t.prev,t,t.next)>0)}function mh(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function fh(e,t){return e.x===t.x&&e.y===t.y}function gh(e,t,i,n){var r=yh(mh(e,t,i)),s=yh(mh(e,t,n)),o=yh(mh(i,n,e)),a=yh(mh(i,n,t));return r!==s&&o!==a||!(0!==r||!_h(e,i,t))||!(0!==s||!_h(e,n,t))||!(0!==o||!_h(i,e,n))||!(0!==a||!_h(i,t,n))}function _h(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function yh(e){return e>0?1:e<0?-1:0}function vh(e,t){return mh(e.prev,e,e.next)<0?mh(e,t,e.next)>=0&&mh(e,e.prev,t)>=0:mh(e,t,e.prev)<0||mh(e,e.next,t)<0}function xh(e,t){var i=new Ch(e.i,e.x,e.y),n=new Ch(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function bh(e,t,i,n){var r=new Ch(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function wh(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ch(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sh(e,t,i,n){for(var r=0,s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}Jc.exports=Qc,Jc.exports.default=Qc,Qc.deviation=function(e,t,i,n){var r=t&&t.length,s=Math.abs(Sh(e,0,r?t[0]*i:e.length,i));if(r)for(var o=0,a=t.length;o<a;o++)s-=Math.abs(Sh(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i));var l=0;for(o=0;o<n.length;o+=3){var c=n[o]*i,h=n[o+1]*i,u=n[o+2]*i;l+=Math.abs((e[c]-e[u])*(e[h+1]-e[c+1])-(e[c]-e[h])*(e[u+1]-e[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},Qc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)i.vertices.push(e[r][s][o]);r>0&&i.holes.push(n+=e[r-1].length)}return i};var Eh=d(Jc.exports);function Th(e,t,i,n,r){!function e(t,i,n,r,s){for(;r>n;){if(r-n>600){var o=r-n+1,a=i-n+1,l=Math.log(o),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(o-c)/o)*(a-o/2<0?-1:1);e(t,i,Math.max(n,Math.floor(i-a*c/o+h)),Math.min(r,Math.floor(i+(o-a)*c/o+h)),s)}var u=t[i],d=n,p=r;for(Ph(t,n,i),s(t[r],u)>0&&Ph(t,n,r);d<p;){for(Ph(t,d,p),d++,p--;s(t[d],u)<0;)d++;for(;s(t[p],u)>0;)p--}0===s(t[n],u)?Ph(t,n,p):Ph(t,++p,r),p<=i&&(n=p+1),i<=p&&(r=p-1)}}(e,t,i||0,n||e.length-1,r||Mh)}function Ph(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function Mh(e,t){return e<t?-1:e>t?1:0}function kh(e,t){const i=e.length;if(i<=1)return[e];const n=[];let r,s;for(let o=0;o<i;o++){const t=W(e[o]);0!==t&&(e[o].area=Math.abs(t),void 0===s&&(s=t<0),s===t<0?(r&&n.push(r),r=[e[o]]):r.push(e[o]))}if(r&&n.push(r),t>1)for(let o=0;o<n.length;o++)n[o].length<=t||(Th(n[o],t,1,n[o].length-1,Ah),n[o]=n[o].slice(0,t));return n}function Ah(e,t){return t.area-e.area}function Ih(e,t,i){const n=i.patternDependencies;let r=!1;for(const s of t){const t=s.paint.get(e+"-pattern");t.isConstant()||(r=!0);const i=t.constantOr(null);i&&(r=!0,n[i]=!0)}return r}function Rh(e,t,i,n,r){const s=r.patternDependencies;for(const o of t){const t=o.paint.get(e+"-pattern").value;if("constant"!==t.kind){let e=t.evaluate({zoom:n},i,{},r.availableImages);e=e&&e.name?e.name:e,s[e]=!0,i.patterns[o.id]=e}}return i}class Oh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qs,this.indexArray=new go,this.indexArray2=new wo,this.programConfigurations=new la(e.layers,e.zoom),this.segments=new ya,this.segments2=new ya,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.projection=e.projection}populate(e,t,i,n){this.hasPattern=Ih("fill",this.layers,t);const r=this.layers[0].layout.get("fill-sort-key"),s=[];for(const{feature:o,id:a,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,h=mc(o,e);if(!this.layers[0]._featureFilter.filter(new Ns(this.zoom),h,i))continue;const u=r?r.evaluate(h,{},i,t.availableImages):void 0,d={id:a,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:e?h.geometry:pc(o,i,n),patterns:{},sortKey:u};s.push(d)}r&&s.sort((e,t)=>e.sortKey-t.sortKey);for(const o of s){const{geometry:n,index:r,sourceLayerIndex:s}=o;if(this.hasPattern){const e=Rh("fill",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,n,r,i,{},t.availableImages);t.featureIndex.insert(e[r].feature,n,r,s,this.index)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}addFeatures(e,t,i,n,r){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,i,n,r,s=[]){for(const o of kh(t,500)){let e=0;for(const a of o)e+=a.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=t.vertexLength,n=[],r=[];for(const a of o){if(0===a.length)continue;a!==o[0]&&r.push(n.length/2);const e=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(t+a.length-1,t),n.push(a[0].x),n.push(a[0].y);for(let i=1;i<a.length;i++)this.layoutVertexArray.emplaceBack(a[i].x,a[i].y),this.indexArray2.emplaceBack(t+i-1,t+i),n.push(a[i].x),n.push(a[i].y);e.vertexLength+=a.length,e.primitiveLength+=a.length}const s=Eh(n,r);for(let o=0;o<s.length;o+=3)this.indexArray.emplaceBack(i+s[o],i+s[o+1],i+s[o+2]);t.vertexLength+=e,t.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}}zr(Oh,"FillBucket",{omit:["layers","patternFeatures"]});const Nh=new Ws({"fill-sort-key":new Hs(et.layout_fill["fill-sort-key"])});var Dh={paint:new Ws({"fill-antialias":new qs(et.paint_fill["fill-antialias"]),"fill-opacity":new Hs(et.paint_fill["fill-opacity"]),"fill-color":new Hs(et.paint_fill["fill-color"]),"fill-outline-color":new Hs(et.paint_fill["fill-outline-color"]),"fill-translate":new qs(et.paint_fill["fill-translate"]),"fill-translate-anchor":new qs(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Hs(et.paint_fill["fill-pattern"])}),layout:Nh};const zh=Ys([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Lh=Ys([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Bh=Ys([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Fh}=zh;var jh={},Vh=g,Uh=qh;function qh(e,t,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=r,e.readFields(Hh,this,t)}function Hh(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var n=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[n]=r}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}function Gh(e){for(var t,i,n=0,r=0,s=e.length,o=s-1;r<s;o=r++)n+=((i=e[o]).x-(t=e[r]).x)*(t.y+i.y);return n}qh.types=["Unknown","Point","LineString","Polygon"],qh.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,n=1,r=0,s=0,o=0,a=[];e.pos<i;){if(r<=0){var l=e.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)s+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&a.push(t),t=[]),t.push(new Vh(s,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&a.push(t),a},qh.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,r=0,s=0,o=1/0,a=-1/0,l=1/0,c=-1/0;e.pos<t;){if(n<=0){var h=e.readVarint();i=7&h,n=h>>3}if(n--,1===i||2===i)(r+=e.readSVarint())<o&&(o=r),r>a&&(a=r),(s+=e.readSVarint())<l&&(l=s),s>c&&(c=s);else if(7!==i)throw new Error("unknown command "+i)}return[o,l,a,c]},qh.prototype.toGeoJSON=function(e,t,i){var n,r,s=this.extent*Math.pow(2,i),o=this.extent*e,a=this.extent*t,l=this.loadGeometry(),c=qh.types[this.type];function h(e){for(var t=0;t<e.length;t++){var i=e[t];e[t]=[360*(i.x+o)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+a)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(n=0;n<l.length;n++)u[n]=l[n][0];h(l=u);break;case 2:for(n=0;n<l.length;n++)h(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var i,n,r=[],s=0;s<t;s++){var o=Gh(e[s]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(i&&r.push(i),i=[e[s]]):i.push(e[s]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)h(l[n][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Wh=Uh,Zh=$h;function $h(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Xh,this,t),this.length=this._features.length}function Xh(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(i))}$h.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Wh(this._pbf,t,this.extent,this._keys,this._values)};var Kh=Zh;function Yh(e,t,i){if(3===e){var n=new Kh(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}var Jh=jh.VectorTile=function(e,t){this.layers=e.readFields(Yh,{},t)},Qh=jh.VectorTileFeature=Uh;function eu(e,t,i,n){const r=[],s=0===n?(e,t,i,n,r,s)=>{e.push(new y(s,i+(s-t)/(n-t)*(r-i)))}:(e,t,i,n,r,s)=>{e.push(new y(t+(s-i)/(r-i)*(n-t),s))};for(const o of e){const e=[];for(const r of o){if(r.length<=2)continue;const o=[];for(let e=0;e<r.length-1;e++){const a=r[e].x,l=r[e].y,c=r[e+1].x,h=r[e+1].y,u=0===n?a:l,d=0===n?c:h;u<t?d>t&&s(o,a,l,c,h,t):u>i?d<i&&s(o,a,l,c,h,i):o.push(r[e]),d<t&&u>=t&&s(o,a,l,c,h,t),d>i&&u<=i&&s(o,a,l,c,h,i)}let a=r[r.length-1];const l=0===n?a.x:a.y;l>=t&&l<=i&&o.push(a),o.length&&(a=o[o.length-1],o[0].x===a.x&&o[0].y===a.y||o.push(o[0]),e.push(o))}e.length&&r.push(e)}return r}jh.VectorTileLayer=Zh;const tu=Qh.types,iu=Math.pow(2,13);function nu(e,t,i,n,r,s,o,a){e.emplaceBack((t<<1)+o,(i<<1)+s,(Math.floor(n*iu)<<1)+r,Math.round(a))}function ru(e,t,i){const n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}class su{constructor(){this.acc=new y(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new y(e.x,e.y),this.max=new y(e.x,e.y))}append(e,t){this.currentPolyCount.edges++,this.acc._add(e);const i=this.min,n=this.max;e.x<i.x?i.x=e.x:e.x>n.x&&(n.x=e.x),e.y<i.y?i.y=e.y:e.y>n.y&&(n.y=e.y),((0===e.x||e.x===va)&&e.x===t.x)!=((0===e.y||e.y===va)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,Ai(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>va!=e.x>va&&this.addBorderIntersection(1,Ai(t.y,e.y,(va-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,Ai(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>va!=e.y>va&&this.addBorderIntersection(3,Ai(t.x,e.x,(va-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[e];t<i[0]&&(i[0]=t),t>i[1]&&(i[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const i=0===e.x?0:1;this.addBorderIntersection(i,t.y),this.addBorderIntersection(i,e.y)}else{const i=0===e.y?2:3;this.addBorderIntersection(i,t.x),this.addBorderIntersection(i,e.x)}}centroid(){const e=this.polyCount.reduce((e,t)=>e+t.edges,0);return 0!==e?this.acc.div(e)._round():new y(0,0)}span(){return new y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,t)=>e+ +(t[0]!==Number.MAX_VALUE),0)}}class ou{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new to,this.centroidVertexArray=new Do,this.indexArray=new go,this.programConfigurations=new la(e.layers,e.zoom),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.enableTerrain=e.enableTerrain}populate(e,t,i,n){this.features=[],this.hasPattern=Ih("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){const t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/va/(1<<e.z)}(i),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:r,id:s,index:o,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=mc(r,e);if(!this.layers[0]._featureFilter.filter(new Ns(this.zoom),l,i))continue;const c={id:s,sourceLayerIndex:a,index:o,geometry:e?l.geometry:pc(r,i,n),properties:r.properties,type:r.type,patterns:{}},h=this.layoutVertexArray.length;this.hasPattern?this.features.push(Rh("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,o,i,{},t.availableImages,n),t.featureIndex.insert(r,c.geometry,o,a,this.index,h)}this.sortBorders()}addFeatures(e,t,i,n,r){for(const s of this.features){const{geometry:e}=s;this.addFeature(s,e,s.index,t,i,n,r)}this.sortBorders()}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Bh.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Lh.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,i,n,r,s,o){const a=[new y(0,0),new y(va,va)],l=o.projection,c="globe"===l.name,h=this.enableTerrain&&!c?new su:null,u="Polygon"===tu[e.type];c&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new oo);const d=kh(t,500);for(let g=d.length-1;g>=0;g--){const e=d[g];(0===e.length||(p=e[0]).every(e=>e.x<=0)||p.every(e=>e.x>=va)||p.every(e=>e.y<=0)||p.every(e=>e.y>=va))&&d.splice(g,1)}var p;let m;if(c)m=mu(d,a,n);else{m=[];for(const e of d)m.push({polygon:e,bounds:a})}const f=u?this.edgeRadius:0;for(const{polygon:g,bounds:_}of m){let e=0,t=0;for(const n of g)u&&!n[0].equals(n[n.length-1])&&n.push(n[0]),t+=u?n.length-1:n.length;const i=this.segments.prepareSegment((u?5:4)*t,this.layoutVertexArray,this.indexArray);if(u){const t=[],r=[];e=i.vertexLength;for(const e of g){let s,o;e.length&&e!==g[0]&&r.push(t.length/2),s=e[1].sub(e[0])._perp()._unit();for(let r=1;r<e.length;r++){const a=e[r],h=e[r===e.length-1?1:r+1];let{x:u,y:d}=a;if(f){o=h.sub(a)._perp()._unit();const e=s.add(o)._unit(),t=f*Math.min(4,1/(s.x*e.x+s.y*e.y));u+=t*e.x,d+=t*e.y,s=o}nu(this.layoutVertexArray,u,d,0,0,1,1,0),i.vertexLength++,t.push(a.x,a.y),c&&ru(this.layoutVertexExtArray,l.projectTilePoint(u,d,n),l.upVector(n,u,d))}}const s=Eh(t,r);for(let n=0;n<s.length;n+=3)this.indexArray.emplaceBack(e+s[n],e+s[n+2],e+s[n+1]),i.primitiveLength++}for(const r of g){h&&r.length&&h.startRing(r[0]);let t,s,o,a=r.length>4&&uu(r[r.length-2],r[0],r[1]),d=f?lu(r[r.length-2],r[0],r[1],f):0;s=r[1].sub(r[0])._perp()._unit();let p=!0;for(let m=1,g=0;m<r.length;m++){let y=r[m-1],v=r[m];const x=r[m===r.length-1?1:m+1];if(h&&u&&h.currentPolyCount.top++,hu(v,y,_)){f&&(s=x.sub(v)._perp()._unit(),p=!p);continue}h&&h.append(v,y);const b=v.sub(y)._perp(),w=b.x/(Math.abs(b.x)+Math.abs(b.y)),C=b.y>0?1:0,S=y.dist(v);if(g+S>32768&&(g=0),f){o=x.sub(v)._perp()._unit();let e=cu(y,v,x,au(s,o),f);isNaN(e)&&(e=0);const t=v.sub(y)._unit();y=y.add(t.mult(d))._round(),v=v.add(t.mult(-e))._round(),d=e,s=o}const E=i.vertexLength,T=r.length>4&&uu(y,v,x);let P=du(g,a,p);if(nu(this.layoutVertexArray,y.x,y.y,w,C,0,0,P),nu(this.layoutVertexArray,y.x,y.y,w,C,0,1,P),g+=S,P=du(g,T,!p),a=T,nu(this.layoutVertexArray,v.x,v.y,w,C,0,0,P),nu(this.layoutVertexArray,v.x,v.y,w,C,0,1,P),i.vertexLength+=4,this.indexArray.emplaceBack(E+0,E+1,E+2),this.indexArray.emplaceBack(E+1,E+3,E+2),i.primitiveLength+=2,f){const n=e+(1===m?r.length-2:m-2),s=1===m?e:n+1;if(this.indexArray.emplaceBack(E+1,n,E+3),this.indexArray.emplaceBack(n,s,E+3),i.primitiveLength+=2,void 0===t&&(t=E),!hu(x,r[m],_)){const e=m===r.length-1?t:i.vertexLength;this.indexArray.emplaceBack(E+2,E+3,e),this.indexArray.emplaceBack(E+3,e+1,e),this.indexArray.emplaceBack(E+3,s,e+1),i.primitiveLength+=3}p=!p}if(c){const e=this.layoutVertexExtArray,t=l.projectTilePoint(y.x,y.y,n),i=l.projectTilePoint(v.x,v.y,n),r=l.upVector(n,y.x,y.y),s=l.upVector(n,v.x,v.y);ru(e,t,r),ru(e,t,r),ru(e,i,s),ru(e,i,s)}}u&&(e+=r.length-1)}}if(h&&h.polyCount.length>0){if(h.borders){h.vertexArrayOffset=this.centroidVertexArray.length;const e=h.borders,t=this.featuresOnBorder.push(h)-1;for(let i=0;i<4;i++)e[i][0]!==Number.MAX_VALUE&&this.borders[i].push(t)}this.encodeCentroid(h.borders?void 0:h.centroid(),h)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((t,i)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[i].borders[e][0])}encodeCentroid(e,t,i=!0){let n,r;if(e)if(0!==e.y){const i=t.span()._mult(this.tileToMeter);n=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(i.x/10)),r=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(i.y/10))}else n=Math.ceil(7*(e.x+450)),r=0;else n=0,r=+i;let s=i?this.centroidVertexArray.length:t.vertexArrayOffset;for(const o of t.polyCount){i&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*o.edges+o.top);for(let e=0;e<o.top;e++)this.centroidVertexArray.emplace(s++,n,r);for(let e=0;e<2*o.edges;e++)this.centroidVertexArray.emplace(s++,0,r),this.centroidVertexArray.emplace(s++,n,r)}}}function au(e,t){const i=e.add(t)._unit();return e.x*i.x+e.y*i.y}function lu(e,t,i,n){const r=t.sub(e)._perp()._unit(),s=i.sub(t)._perp()._unit();return cu(e,t,i,au(r,s),n)}function cu(e,t,i,n,r){const s=Math.sqrt(1-n*n);return Math.min(e.dist(t)/3,t.dist(i)/3,r*s/n)}function hu(e,t,i){return e.x<i[0].x&&t.x<i[0].x||e.x>i[1].x&&t.x>i[1].x||e.y<i[0].y&&t.y<i[0].y||e.y>i[1].y&&t.y>i[1].y}function uu(e,t,i){if(e.x<0||e.x>=va||t.x<0||t.x>=va||i.x<0||i.x>=va)return!1;const n=i.sub(t),r=n.perp(),s=e.sub(t);return(n.x*s.x+n.y*s.y)/Math.sqrt((n.x*n.x+n.y*n.y)*(s.x*s.x+s.y*s.y))>-.866&&r.x*s.x+r.y*s.y<0}function du(e,t,i){const n=t?2|e:-3&e;return i?1|n:-2&n}function pu(){const e=Math.PI/32,t=Math.tan(e),i=Wl;return i*Math.sqrt(1+2*t*t)-i}function mu(e,t,i){const n=1<<i.z,r=ec(i.x/n),s=ec((i.x+1)/n),o=tc(i.y/n),a=tc((i.y+1)/n);return function(e,t,i,n,r=0,s){const o=[];if(!e.length||!i||!n)return o;const a=(e,t)=>{for(const i of e)o.push({polygon:i,bounds:t})},l=Math.ceil(Math.log2(i)),c=Math.ceil(Math.log2(n)),h=l-c,u=[];for(let m=0;m<Math.abs(h);m++)u.push(h>0?0:1);for(let m=0;m<Math.min(l,c);m++)u.push(0),u.push(1);let d=e;if(d=eu(d,t[0].y-r,t[1].y+r,1),d=eu(d,t[0].x-r,t[1].x+r,0),!d.length)return o;const p=[];for(u.length?p.push({polygons:d,bounds:t,depth:0}):a(d,t);p.length;){const e=p.pop(),t=e.depth,i=u[t],n=e.bounds[0],o=e.bounds[1],l=0===i?n.x:n.y,c=0===i?o.x:o.y,h=s?s(i,l,c):.5*(l+c),d=eu(e.polygons,l-r,h+r,i),m=eu(e.polygons,h-r,c+r,i);if(d.length){const e=[n,new y(0===i?h:o.x,1===i?h:o.y)];u.length>t+1?p.push({polygons:d,bounds:e,depth:t+1}):a(d,e)}if(m.length){const e=[new y(0===i?h:n.x,1===i?h:n.y),o];u.length>t+1?p.push({polygons:m,bounds:e,depth:t+1}):a(m,e)}}return o}(e,t,Math.ceil((s-r)/11.25),Math.ceil((o-a)/11.25),1,(e,t,r)=>{if(0===e)return.5*(t+r);{const e=tc((i.y+t/va)/n);return(Jl(.5*(tc((i.y+r/va)/n)+e))*n-i.y)*va}})}zr(ou,"FillExtrusionBucket",{omit:["layers","features"]}),zr(su,"PartMetadata");const fu=new Ws({"fill-extrusion-edge-radius":new qs(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var gu={paint:new Ws({"fill-extrusion-opacity":new qs(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Hs(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qs(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qs(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Hs(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Hs(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Hs(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qs(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qs(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qs(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new qs(et["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:fu};function _u(e,t,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class yu{constructor(e,t,i){this.z=e,this.x=t,this.y=i,this.key=bu(0,e,e,t,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const i=function(e,t,i){var n=_u(256*e,256*(t=Math.pow(2,i)-t-1),i),r=_u(256*(e+1),256*(t+1),i);return n[0]+","+n[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),n=function(e,t,i){let n,r="";for(let s=e;s>0;s--)n=1<<s-1,r+=(t&n?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",i)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vu{constructor(e,t){this.wrap=e,this.canonical=t,this.key=bu(e,t.z,t.z,t.x,t.y)}}class xu{constructor(e,t,i,n,r){this.overscaledZ=e,this.wrap=t,this.canonical=new yu(i,+n,+r),this.key=0===t&&e===i?this.canonical.key:bu(t,e,i,n,r)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new xu(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new xu(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t=!0){if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return bu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-e;return bu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new xu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new xu(t,this.wrap,t,i,n),new xu(t,this.wrap,t,i+1,n),new xu(t,this.wrap,t,i,n+1),new xu(t,this.wrap,t,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new xu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new xu(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function bu(e,t,i,n,r){const s=1<<Math.min(i,22);let o=s*(r%s)+n%s;return e&&i<22&&(o+=s*s*((e<0?-2*e-1:2*e)%(1<<2*(22-i)))),16*(32*o+i)+(t-i)}zr(yu,"CanonicalTileID"),zr(xu,"OverscaledTileID",{omit:["projMatrix"]});class wu extends y{constructor(e,t,i){super(e,t),this.z=i}}function Cu(e,t){return e.x*t.x+e.y*t.y}function Su(e,t){if(1===e.length){let i=0;const n=t[i++];let r;for(;!r||n.equals(r);)if(r=t[i++],!r)return 1/0;for(;i<t.length;i++){const s=t[i],o=e[0],a=r.sub(n),l=s.sub(n),c=o.sub(n),h=Cu(a,a),u=Cu(a,l),d=Cu(l,l),p=Cu(c,a),m=Cu(c,l),f=h*d-u*u,g=(d*p-u*m)/f,_=(h*m-u*p)/f,y=n.z*(1-g-_)+r.z*g+s.z*_;if(isFinite(y))return y}return 1/0}{let e=1/0;for(const i of t)e=Math.min(e,i.z);return e}}function Eu(e,t,i,n,r,s,o,a){const l=o*r.getElevationAt(e,t,!0,!0),c=0!==s[0],h=c?0===s[1]?o*(s[0]/7-450):o*function(e,t,i){const n=Math.floor(t[0]/8),r=Math.floor(t[1]/8),s=10*(t[0]-8*n),o=10*(t[1]-8*r),a=e.getElevationAt(n,r,!0,!0),l=e.getMeterToDEM(i),c=Math.floor(.5*(s*l-1)),h=Math.floor(.5*(o*l-1)),u=e.tileCoordToPixel(n,r),d=2*c+1,p=2*h+1,m=function(e,t,i,n,r){return[e.getElevationAtPixel(t,i,!0),e.getElevationAtPixel(t+r,i,!0),e.getElevationAtPixel(t,i+r,!0),e.getElevationAtPixel(t+n,i+r,!0)]}(e,u.x-c,u.y-h,d,p),f=Math.abs(m[0]-m[1]),g=Math.abs(m[2]-m[3]),_=Math.abs(m[0]-m[2])+Math.abs(m[1]-m[3]),y=Math.min(.25,.5*l*(f+g)/d),v=Math.min(.25,.5*l*_/p);return a+Math.max(y*s,v*o)}(r,s,a):l;return{base:l+(0===i)?-1:i,top:c?Math.max(h+n,l+i+2):l+n}}const Tu=Ys([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Pu}=Tu,Mu=Ys([{name:"a_packed",components:4,type:"Float32"}]),{members:ku}=Mu,Au=Qh.types,Iu=Math.cos(Math.PI/180*37.5);class Ru{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(e=>{this.gradients[e.id]={}}),this.layoutVertexArray=new io,this.layoutVertexArray2=new no,this.indexArray=new go,this.programConfigurations=new la(e.layers,e.zoom),this.segments=new ya,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,i,n){this.hasPattern=Ih("line",this.layers,t);const r=this.layers[0].layout.get("line-sort-key"),s=[];for(const{feature:c,id:h,index:u,sourceLayerIndex:d}of e){const e=this.layers[0]._featureFilter.needGeometry,t=mc(c,e);if(!this.layers[0]._featureFilter.filter(new Ns(this.zoom),t,i))continue;const o=r?r.evaluate(t,{},i):void 0,a={id:h,properties:c.properties,type:c.type,sourceLayerIndex:d,index:u,geometry:e?t.geometry:pc(c,i,n),patterns:{},sortKey:o};s.push(a)}r&&s.sort((e,t)=>e.sortKey-t.sortKey);const{lineAtlas:o,featureIndex:a}=t,l=this.addConstantDashes(o);for(const c of s){const{geometry:n,index:r,sourceLayerIndex:s}=c;if(l&&this.addFeatureDashes(c,o),this.hasPattern){const e=Rh("line",this.layers,c,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(c,n,r,i,o.positions,t.availableImages);a.insert(e[r].feature,n,r,s,this.index)}}addConstantDashes(e){let t=!1;for(const i of this.layers){const n=i.paint.get("line-dasharray").value,r=i.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==r.kind)t=!0;else{const t=r.value,i=n.value;if(!i)continue;e.addDash(i,t)}}return t}addFeatureDashes(e,t){const i=this.zoom;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,s=n.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===s.kind)continue;let o,a;if("constant"===r.kind){if(o=r.value,!o)continue}else o=r.evaluate({zoom:i},e);a="constant"===s.kind?s.value:s.evaluate({zoom:i},e),t.addDash(o,a),e.patterns[n.id]=t.getKey(o,a)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}addFeatures(e,t,i,n,r){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ku)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,i,n,r,s){const o=this.layers[0].layout,a=o.get("line-join").evaluate(e,{}),l=o.get("line-cap").evaluate(e,{}),c=o.get("line-miter-limit"),h=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const u of t)this.addLine(u,e,a,l,c,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}addLine(e,t,i,n,r,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Au[t.type];let a=e.length;for(;a>=2&&e[a-1].equals(e[a-2]);)a--;let l=0;for(;l<a-1&&e[l].equals(e[l+1]);)l++;if(a<(o?3:2))return;"bevel"===i&&(r=1.05);const c=this.overscaling<=16?15*va/(512*this.overscaling):0,h=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let u,d,p,m,f;this.e1=this.e2=-1,o&&(u=e[a-2],f=e[l].sub(u)._unit()._perp());for(let g=l;g<a;g++){if(p=g===a-1?o?e[l+1]:void 0:e[g+1],p&&e[g].equals(p))continue;f&&(m=f),u&&(d=u),u=e[g],f=p?p.sub(u)._unit()._perp():m,m=m||f;let t=m.add(f);0===t.x&&0===t.y||t._unit();const _=m.x*f.x+m.y*f.y,y=t.x*f.x+t.y*f.y,v=0!==y?1/y:1/0,x=2*Math.sqrt(2-2*y),b=y<Iu&&d&&p,w=m.x*f.y-m.y*f.x>0;if(b&&g>l){const e=u.dist(d);if(e>2*c){const t=u.sub(u.sub(d)._mult(c/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,m,0,0,h),d=t}}const C=d&&p;let S=C?i:o?"butt":n;if(C&&"round"===S&&(v<s?S="miter":v<=2&&(S="fakeround")),"miter"===S&&v>r&&(S="bevel"),"bevel"===S&&(v>2&&(S="flipbevel"),v<r&&(S="miter")),d&&this.updateDistance(d,u),"miter"===S)t._mult(v),this.addCurrentVertex(u,t,0,0,h);else if("flipbevel"===S){if(v>100)t=f.mult(-1);else{const e=v*m.add(f).mag()/m.sub(f).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(u,t,0,0,h),this.addCurrentVertex(u,t.mult(-1),0,0,h)}else if("bevel"===S||"fakeround"===S){const e=-Math.sqrt(v*v-1),t=w?e:0,i=w?0:e;if(d&&this.addCurrentVertex(u,m,t,i,h),"fakeround"===S){const e=Math.round(180*x/Math.PI/20);for(let t=1;t<e;t++){let i=t/e;if(.5!==i){const e=i-.5;i+=i*e*(i-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*e*e+(.848013+_*(.215638*_-1.06021)))}const n=f.sub(m)._mult(i)._add(m)._unit()._mult(w?-1:1);this.addHalfVertex(u,n.x,n.y,!1,w,0,h)}}p&&this.addCurrentVertex(u,f,-t,-i,h)}else if("butt"===S)this.addCurrentVertex(u,t,0,0,h);else if("square"===S){const e=d?1:-1;d||this.addCurrentVertex(u,t,e,e,h),this.addCurrentVertex(u,t,0,0,h),d&&this.addCurrentVertex(u,t,e,e,h)}else"round"===S&&(d&&(this.addCurrentVertex(u,m,0,0,h),this.addCurrentVertex(u,m,1,1,h,!0)),p&&(this.addCurrentVertex(u,f,-1,-1,h,!0),this.addCurrentVertex(u,f,0,0,h)));if(b&&g<a-1){const e=u.dist(p);if(e>2*c){const t=u.add(p.sub(u)._mult(c/e)._round());this.updateDistance(u,t),this.addCurrentVertex(t,f,0,0,h),u=t}}}}addCurrentVertex(e,t,i,n,r,s=!1){const o=t.y*n-t.x,a=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,s,!1,i,r),this.addHalfVertex(e,o,a,s,!0,-n,r)}addHalfVertex({x:e,y:t},i,n,r,s,o,a){this.layoutVertexArray.emplaceBack((e<<1)+(r?1:0),(t<<1)+(s?1:0),Math.round(63*i)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),s?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}zr(Ru,"LineBucket",{omit:["layers","patternFeatures"]});const Ou=new Ws({"line-cap":new Hs(et.layout_line["line-cap"]),"line-join":new Hs(et.layout_line["line-join"]),"line-miter-limit":new qs(et.layout_line["line-miter-limit"]),"line-round-limit":new qs(et.layout_line["line-round-limit"]),"line-sort-key":new Hs(et.layout_line["line-sort-key"])});var Nu={paint:new Ws({"line-opacity":new Hs(et.paint_line["line-opacity"]),"line-color":new Hs(et.paint_line["line-color"]),"line-translate":new qs(et.paint_line["line-translate"]),"line-translate-anchor":new qs(et.paint_line["line-translate-anchor"]),"line-width":new Hs(et.paint_line["line-width"]),"line-gap-width":new Hs(et.paint_line["line-gap-width"]),"line-offset":new Hs(et.paint_line["line-offset"]),"line-blur":new Hs(et.paint_line["line-blur"]),"line-dasharray":new Hs(et.paint_line["line-dasharray"]),"line-pattern":new Hs(et.paint_line["line-pattern"]),"line-gradient":new Gs(et.paint_line["line-gradient"]),"line-trim-offset":new qs(et.paint_line["line-trim-offset"])}),layout:Ou};const Du=new class extends Hs{possiblyEvaluate(e,t){return t=new Ns(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,i,n){return t=R({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,i,n)}}(Nu.paint.properties["line-width"].specification);function zu(e,t){return t>0?t+2*e:e}Du.useIntegerZoom=!0;const Lu=Ys([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bu=Ys([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Fu=Ys([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ys([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ju=Ys([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Vu=Ys([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ys([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Uu=Ys([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qu=Ys([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ys([{name:"triangle",components:3,type:"Uint16"}]),Ys([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ys([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ys([{type:"Float32",name:"offsetX"}]),Ys([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const Hu=128;function Gu(e,t){const{expression:i}=t;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new Ns(e+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=i;let r=0;for(;r<t.length&&t[r]<=e;)r++;r=Math.max(0,r-1);let s=r;for(;s<t.length&&t[s]<e+1;)s++;s=Math.min(t.length-1,s);const o=t[r],a=t[s];return"composite"===i.kind?{kind:"composite",minZoom:o,maxZoom:a,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:a,minSize:i.evaluate(new Ns(o)),maxSize:i.evaluate(new Ns(a)),interpolationType:n}}}function Wu(e,{uSize:t,uSizeT:i},{lowerSize:n,upperSize:r}){return"source"===e.kind?n/Hu:"composite"===e.kind?Ai(n/Hu,r/Hu,i):t}function Zu(e,t){let i=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:r,minZoom:s,maxZoom:o}=e,a=r?P(Zi.interpolationFactor(r,t,s,o),0,1):0;"camera"===e.kind?n=Ai(e.minSize,e.maxSize,a):i=a}return{uSizeT:i,uSize:n}}var $u=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Hu,evaluateSizeForFeature:Wu,evaluateSizeForZoom:Zu,getSizeData:Gu});function Xu(e,t,i){return e.sections.forEach(e=>{e.text=function(e,t,i){const n=t.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Os.applyArabicShaping&&(e=Os.applyArabicShaping(e)),e}(e.text,t,i)}),e}const Ku={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Yu(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function Ju(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var Qu=id,ed=function(e,t,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,c=l>>1,h=-7,u=i?r-1:0,d=i?-1:1,p=e[t+u];for(u+=d,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+e[t+u],u+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+e[t+u],u+=d,h-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)},td=function(e,t,i,n,r,s){var o,a,l,c=8*s-r-1,h=(1<<c)-1,u=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,m=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(o++,l/=2),o+u>=h?(a=0,o=h):o+u>=1?(a=(t*l-1)*Math.pow(2,r),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;e[i+p]=255&a,p+=m,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[i+p]=255&o,p+=m,o/=256,c-=8);e[i+p-m]|=128*f};function id(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}id.Varint=0,id.Fixed64=1,id.Bytes=2,id.Fixed32=5;var nd=4294967296,rd=1/nd,sd="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function od(e){return e.type===id.Bytes?e.readVarint()+e.pos:e.pos+1}function ad(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ld(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=e;r--)i.buf[r+n]=i.buf[r]}function cd(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function hd(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function ud(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function dd(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function pd(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function md(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function fd(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function gd(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function _d(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function yd(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function vd(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function xd(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}id.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,e(r,t,this),this.pos===s&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=yd(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=xd(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=yd(this.buf,this.pos)+yd(this.buf,this.pos+4)*nd;return this.pos+=8,e},readSFixed64:function(){var e=yd(this.buf,this.pos)+xd(this.buf,this.pos+4)*nd;return this.pos+=8,e},readFloat:function(){var e=ed(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ed(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,n=this.buf;return t=127&(i=n[this.pos++]),i<128?t:(t|=(127&(i=n[this.pos++]))<<7,i<128?t:(t|=(127&(i=n[this.pos++]))<<14,i<128?t:(t|=(127&(i=n[this.pos++]))<<21,i<128?t:function(e,t,i){var n,r,s=i.buf;if(n=(112&(r=s[i.pos++]))>>4,r<128)return ad(e,n,t);if(n|=(127&(r=s[i.pos++]))<<3,r<128)return ad(e,n,t);if(n|=(127&(r=s[i.pos++]))<<10,r<128)return ad(e,n,t);if(n|=(127&(r=s[i.pos++]))<<17,r<128)return ad(e,n,t);if(n|=(127&(r=s[i.pos++]))<<24,r<128)return ad(e,n,t);if(n|=(1&(r=s[i.pos++]))<<31,r<128)return ad(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&sd?function(e,t,i){return sd.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var n="",r=t;r<i;){var s,o,a,l=e[r],c=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h>i)break;1===h?l<128&&(c=l):2===h?128==(192&(s=e[r+1]))&&(c=(31&l)<<6|63&s)<=127&&(c=null):3===h?(o=e[r+2],128==(192&(s=e[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===h&&(o=e[r+2],a=e[r+3],128==(192&(s=e[r+1]))&&128==(192&o)&&128==(192&a)&&((c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,h=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),r+=h}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==id.Bytes)return e.push(this.readVarint(t));var i=od(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==id.Bytes)return e.push(this.readSVarint());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==id.Bytes)return e.push(this.readBoolean());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==id.Bytes)return e.push(this.readFloat());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==id.Bytes)return e.push(this.readDouble());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==id.Bytes)return e.push(this.readFixed32());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==id.Bytes)return e.push(this.readSFixed32());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==id.Bytes)return e.push(this.readFixed64());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==id.Bytes)return e.push(this.readSFixed64());var t=od(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===id.Varint)for(;this.buf[this.pos++]>127;);else if(t===id.Bytes)this.pos=this.readVarint()+this.pos;else if(t===id.Fixed32)this.pos+=4;else{if(t!==id.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),vd(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),vd(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),vd(this.buf,-1&e,this.pos),vd(this.buf,Math.floor(e*rd),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),vd(this.buf,-1&e,this.pos),vd(this.buf,Math.floor(e*rd),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,i.buf[i.pos]=127&(e>>>=7)}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var n,r,s=0;s<t.length;s++){if((n=t.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):r=n;continue}if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(e[i++]=239,e[i++]=191,e[i++]=189,r=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=63&n|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&ld(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),td(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),td(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&ld(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,id.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,cd,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,hd,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,pd,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,ud,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,dd,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,md,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,fd,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,gd,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,_d,t)},writeBytesField:function(e,t){this.writeTag(e,id.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,id.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,id.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,id.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,id.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,id.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,id.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,id.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,id.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,id.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var bd=d(Qu);function wd(e,t,i){t.glyphs=[],1===e&&i.readMessage(Cd,t)}function Cd(e,t,i){if(3===e){const{id:e,bitmap:n,width:r,height:s,left:o,top:a,advance:l}=i.readMessage(Sd,{});t.glyphs.push({id:e,bitmap:new Gc({width:r+6,height:s+6},n),metrics:{width:r,height:s,left:o,top:a,advance:l}})}else 4===e?t.ascender=i.readSVarint():5===e&&(t.descender=i.readSVarint())}function Sd(e,t,i){1===e?t.id=i.readVarint():2===e?t.bitmap=i.readBytes():3===e?t.width=i.readVarint():4===e?t.height=i.readVarint():5===e?t.left=i.readSVarint():6===e?t.top=i.readSVarint():7===e&&(t.advance=i.readVarint())}function Ed(e){let t=0,i=0;for(const o of e)t+=o.w*o.h,i=Math.max(i,o.w);e.sort((e,t)=>t.h-e.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let r=0,s=0;for(const o of e)for(let e=n.length-1;e>=0;e--){const t=n[e];if(!(o.w>t.w||o.h>t.h)){if(o.x=t.x,o.y=t.y,s=Math.max(s,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===t.w&&o.h===t.h){const t=n.pop();e<n.length&&(n[e]=t)}else o.h===t.h?(t.x+=o.w,t.w-=o.w):o.w===t.w?(t.y+=o.h,t.h-=o.h):(n.push({x:t.x+o.w,y:t.y,w:t.w-o.w,h:o.h}),t.y+=o.h,t.h-=o.h);break}}return{w:r,h:s,fill:t/(r*s)||0}}class Td{constructor(e,{pixelRatio:t,version:i,stretchX:n,stretchY:r,content:s}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=r,this.content=s,this.version=i}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Pd{constructor(e,t){const i={},n={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,i,r),this.addImages(t,n,r);const{w:s,h:o}=Ed(r),a=new Wc({width:s||1,height:o||1});for(const l in e){const t=e[l],n=i[l].paddedRect;Wc.copy(t.data,a,{x:0,y:0},{x:n.x+1,y:n.y+1},t.data)}for(const l in t){const e=t[l],i=n[l].paddedRect,r=i.x+1,s=i.y+1,o=e.data.width,c=e.data.height;Wc.copy(e.data,a,{x:0,y:0},{x:r,y:s},e.data),Wc.copy(e.data,a,{x:0,y:c-1},{x:r,y:s-1},{width:o,height:1}),Wc.copy(e.data,a,{x:0,y:0},{x:r,y:s+c},{width:o,height:1}),Wc.copy(e.data,a,{x:o-1,y:0},{x:r-1,y:s},{width:1,height:c}),Wc.copy(e.data,a,{x:0,y:0},{x:r+o,y:s},{width:1,height:c})}this.image=a,this.iconPositions=i,this.patternPositions=n}addImages(e,t,i){for(const n in e){const r=e[n],s={x:0,y:0,w:r.data.width+2,h:r.data.height+2};i.push(s),t[n]=new Td(s,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(t=>e.hasImage(t)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)}patchUpdatedImage(e,t,i){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,r]=e.tl;i.update(t.data,void 0,{x:n,y:r})}}zr(Td,"ImagePosition"),zr(Pd,"ImageAtlas");const Md={horizontal:1,vertical:2,horizontalOnly:3};class kd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const i=new kd;return i.scale=e||1,i.fontStack=t,i}static forImage(e){const t=new kd;return t.imageName=e,t}}class Ad{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const i=new Ad;for(let n=0;n<e.sections.length;n++){const r=e.sections[n];r.image?i.addImageSection(r):i.addTextSection(r,t)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(e,t){let i="";for(let n=0;n<e.length;n++){const r=e.charCodeAt(n+1)||null,s=e.charCodeAt(n-1)||null;i+=!t&&(r&&ys(r)&&!Ku[e[n+1]]||s&&ys(s)&&!Ku[e[n-1]])||!Ku[e[n]]?e[n]:Ku[e[n]]}return i}(this.text,e)}trim(){let e=0;for(let i=0;i<this.text.length&&Rd[this.text.charCodeAt(i)];i++)e++;let t=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&Rd[this.text.charCodeAt(i)];i--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const i=new Ad;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,t)=>Math.max(e,this.sections[t].scale),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(kd.forText(e.scale,e.fontStack||t));const i=this.sections.length-1;for(let n=0;n<e.text.length;++n)this.sectionIndex.push(i)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void H("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(kd.forImage(t)),this.sectionIndex.push(this.sections.length-1)):H("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Id(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m){const f=Ad.fromFeature(e,r);u===Md.vertical&&f.verticalizePunctuation(d);let g=[];const _=function(e,t,i,n,r,s){if(!e)return[];const o=[],a=function(e,t,i,n,r,s){let o=0;for(let a=0;a<e.length();a++){const i=e.getSection(a);o+=Nd(e.getCharCode(a),i,n,r,t,s)}return o/Math.max(1,Math.ceil(o/i))}(e,t,i,n,r,s),l=e.text.indexOf("\u200b")>=0;let c=0;for(let u=0;u<e.length();u++){const i=e.getSection(u),d=e.getCharCode(u);if(Rd[d]||(c+=Nd(d,i,n,r,t,s)),u<e.length()-1){const t=!((h=d)<11904||!(Yr(h)||Kr(h)||hs(h)||as(h)||ts(h)||Hr(h)||Jr(h)||Zr(h)||is(h)||ns(h)||es(h)||ps(h)||$r(h)||Wr(h)||Gr(h)||Qr(h)||Xr(h)||cs(h)||ss(h)||rs(h)));(Od[d]||t||i.imageName)&&o.push(Ld(u+1,c,a,o,zd(d,e.getCharCode(u+1),t&&l),!1))}}var h;return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(Ld(e.length(),c,a,o,0,!0))}(f,c,s,t,n,p),{processBidirectionalText:y,processStyledBidirectionalText:v}=Os;if(y&&1===f.sections.length){const e=y(f.toString(),_);for(const t of e){const e=new Ad;e.text=t,e.sections=f.sections;for(let i=0;i<t.length;i++)e.sectionIndex.push(0);g.push(e)}}else if(v){const e=v(f.text,f.sectionIndex,_);for(const t of e){const e=new Ad;e.text=t[0],e.sectionIndex=t[1],e.sections=f.sections,g.push(e)}}else g=function(e,t){const i=[],n=e.text;let r=0;for(const s of t)i.push(e.substring(r,s)),r=s;return r<n.length&&i.push(e.substring(r,n.length)),i}(f,_);const x=[],b={positionedLines:x,text:f.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:u,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,i,n,r,s,o,a,l,c,h,u){let d=0,p=0,m=0;const f="right"===a?1:"left"===a?0:.5;let g=!1;for(const w of r){const e=w.getSections();for(const i of e){if(i.imageName)continue;const e=t[i.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let _=0;for(const w of r){w.trim();const r=w.getMaxScale(),o=24*(r-1),a={positionedGlyphs:[],lineOffset:0};e.positionedLines[_]=a;const v=a.positionedGlyphs;let x=0;if(!w.length()){p+=s,++_;continue}let b=0,C=0;for(let s=0;s<w.length();s++){const o=w.getSection(s),a=w.getSectionIndex(s),m=w.getCharCode(s);let f=o.scale,_=null,S=null,E=null,T=24,P=0;const M=!(l===Md.horizontal||!h&&!_s(m)||h&&(Rd[m]||(y=m,Vr(y)||Ur(y)||qr(y)||ls(y)||ds(y))));if(o.imageName){const t=n[o.imageName];if(!t)continue;E=o.imageName,e.iconsInText=e.iconsInText||!0,S=t.paddedRect;const i=t.displaySize;f=24*f/u,_={width:i[0],height:i[1],left:1,top:-3,advance:M?i[1]:i[0],localGlyph:!1},P=g?-_.height*f:24*r-17-i[1]*f,T=_.advance;const s=(M?i[0]:i[1])*f-24*r;s>0&&s>x&&(x=s)}else{const e=i[o.fontStack];if(!e)continue;e[m]&&(S=e[m]);const n=t[o.fontStack];if(!n)continue;const s=n.glyphs[m];if(!s)continue;if(_=s.metrics,T=8203!==m?24:0,g){const e=void 0!==n.ascender?Math.abs(n.ascender):0,t=void 0!==n.descender?Math.abs(n.descender):0,i=(e+t)*f;b<i&&(b=i,C=(e-t)/2*f),P=-e*f}else P=24*(r-f)-17}M?(e.verticalizable=!0,v.push({glyph:m,imageName:E,x:d,y:p+P,vertical:M,scale:f,localGlyph:_.localGlyph,fontStack:o.fontStack,sectionIndex:a,metrics:_,rect:S}),d+=T*f+c):(v.push({glyph:m,imageName:E,x:d,y:p+P,vertical:M,scale:f,localGlyph:_.localGlyph,fontStack:o.fontStack,sectionIndex:a,metrics:_,rect:S}),d+=_.advance*f+c)}0!==v.length&&(m=Math.max(d-c,m),g?Fd(v,f,x,C,s*r/2):Fd(v,f,x,0,s/2)),d=0;const S=s*r+x;a.lineOffset=Math.max(x,o),p+=S,++_}var y;const v=p,{horizontalAlign:x,verticalAlign:b}=Bd(o);(function(e,t,i,n,r,s){const o=(t-i)*r,a=-s*n;for(const l of e)for(const e of l.positionedGlyphs)e.x+=o,e.y+=a})(e.positionedLines,f,x,b,m,v),e.top+=-b*v,e.bottom=e.top+v,e.left+=-x*m,e.right=e.left+m,e.hasBaseline=g}(b,t,i,n,g,o,a,l,u,c,d,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&b}const Rd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Od={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Nd(e,t,i,n,r,s){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*24/s+r:0}{const n=i[t.fontStack],s=n&&n.glyphs[e];return s?s.metrics.advance*t.scale+r:0}}function Dd(e,t,i,n){const r=Math.pow(e-t,2);return n?e<t?r/2:2*r:r+Math.abs(i)*i}function zd(e,t,i){let n=0;return 10===e&&(n-=1e4),i&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function Ld(e,t,i,n,r,s){let o=null,a=Dd(t,i,r,s);for(const l of n){const e=Dd(t-l.x,i,r,s)+l.badness;e<=a&&(o=l,a=e)}return{index:e,x:t,priorBreak:o,badness:a}}function Bd(e){let t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Fd(e,t,i,n,r){if(!(t||i||n||r))return;const s=e.length-1,o=e[s],a=(o.x+o.metrics.advance*o.scale)*t;for(let l=0;l<=s;l++)e[l].x-=a,e[l].y+=i+n+r}function jd(e,t,i){const{horizontalAlign:n,verticalAlign:r}=Bd(i),s=t[0]-e.displaySize[0]*n,o=t[1]-e.displaySize[1]*r;return{image:e,top:o,bottom:o+e.displaySize[1],left:s,right:s+e.displaySize[0]}}function Vd(e,t,i,n,r,s){const o=e.image;let a;if(o.content){const e=o.content,t=o.pixelRatio||1;a=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*s,c=t.right*s;let h,u,d,p;"width"===i||"both"===i?(p=r[0]+l-n[3],u=r[0]+c+n[1]):(p=r[0]+(l+c-o.displaySize[0])/2,u=p+o.displaySize[0]);const m=t.top*s,f=t.bottom*s;return"height"===i||"both"===i?(h=r[1]+m-n[0],d=r[1]+f+n[2]):(h=r[1]+(m+f-o.displaySize[1])/2,d=h+o.displaySize[1]),{image:o,top:h,right:u,bottom:d,left:p,collisionPadding:a}}class Ud extends y{constructor(e,t,i,n,r){super(e,t),this.angle=n,this.z=i,void 0!==r&&(this.segment=r)}clone(){return new Ud(this.x,this.y,this.z,this.angle,this.segment)}}function qd(e,t,i,n,r){if(void 0===t.segment)return!0;let s=t,o=t.segment+1,a=0;for(;a>-i/2;){if(o--,o<0)return!1;a-=e[o].dist(s),s=e[o]}a+=e[o].dist(e[o+1]),o++;const l=[];let c=0;for(;a<i/2;){const t=e[o],i=e[o+1];if(!i)return!1;let s=e[o-1].angleTo(t)-t.angleTo(i);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:s}),c+=s;a-l[0].distance>n;)c-=l.shift().angleDelta;if(c>r)return!1;o++,a+=t.dist(i)}return!0}function Hd(e){let t=0;for(let i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Gd(e,t,i){return e?.6*t*i:0}function Wd(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Zd(e,t,i,n,r,s){const o=Gd(i,r,s),a=Wd(i,n)*s;let l=0;const c=Hd(e)/2;for(let h=0;h<e.length-1;h++){const i=e[h],n=e[h+1],r=i.dist(n);if(l+r>c){const s=(c-l)/r,u=Ai(i.x,n.x,s),d=Ai(i.y,n.y,s),p=new Ud(u,d,0,n.angleTo(i),h);return!o||qd(e,p,a,o,t)?p:void 0}l+=r}}function $d(e,t,i,n,r,s,o,a,l){const c=Gd(n,s,o),h=Wd(n,r),u=h*o,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-u<t/4&&(t=u+t/4),function e(t,i,n,r,s,o,a,l,c){const h=o/2,u=Hd(t);let d=0,p=i-n,m=[];for(let f=0;f<t.length-1;f++){const e=t[f],i=t[f+1],a=e.dist(i),l=i.angleTo(e);for(;p+n<d+a;){p+=n;const g=(p-d)/a,_=Ai(e.x,i.x,g),y=Ai(e.y,i.y,g);if(_>=0&&_<c&&y>=0&&y<c&&p-h>=0&&p+h<=u){const e=new Ud(_,y,0,l,f);e._round(),r&&!qd(t,e,o,r,s)||m.push(e)}}d+=a}return l||m.length||a||(m=e(t,d/2,n,r,s,o,a,!0,c)),m}(e,d?t/2*a%t:(h/2+2*s)*o*a%t,t,c,i,u,d,!1,l)}function Xd(e,t,i,n,r){const s=[];for(let o=0;o<e.length;o++){const a=e[o];let l;for(let e=0;e<a.length-1;e++){let o=a[e],c=a[e+1];o.x<t&&c.x<t||(o.x<t?o=new y(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x<t&&(c=new y(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y<i&&c.y<i||(o.y<i?o=new y(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round():c.y<i&&(c=new y(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round()),o.x>=n&&c.x>=n||(o.x>=n?o=new y(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x>=n&&(c=new y(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y>=r&&c.y>=r||(o.y>=r?o=new y(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round():c.y>=r&&(c=new y(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round()),l&&o.equals(l[l.length-1])||(l=[o],s.push(l)),l.push(c)))))}}return s}zr(Ud,"Anchor");const Kd=1e20;function Yd(e,t,i,n,r,s,o,a,l){for(let c=t;c<t+n;c++)Jd(e,i*s+c,s,r,o,a,l);for(let c=i;c<i+r;c++)Jd(e,c*s+t,1,n,o,a,l)}function Jd(e,t,i,n,r,s,o){s[0]=0,o[0]=-Kd,o[1]=Kd,r[0]=e[t];for(let a=1,l=0,c=0;a<n;a++){r[a]=e[t+a*i];const n=a*a;do{const e=s[l];c=(r[a]-r[e]+n-e*e)/(a-e)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=Kd}for(let a=0,l=0;a<n;a++){for(;o[l+1]<a;)l++;const n=s[l],c=a-n;e[t+a*i]=r[n]+c*c}}const Qd={none:0,ideographs:1,all:2};class ep{constructor(e,t,i){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=i,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,t){const i=[];for(const n in e)for(const t of e[n])i.push({stack:n,id:t});A(i,({stack:e,id:t},i)=>{let n=this.entries[e];n||(n=this.entries[e]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let r=n.glyphs[t];if(void 0!==r)return void i(null,{stack:e,id:t,glyph:r});if(r=this._tinySDF(n,e,t),r)return n.glyphs[t]=r,void i(null,{stack:e,id:t,glyph:r});const s=Math.floor(t/256);if(256*s>65535)return void i(new Error("glyphs > 65535 not supported"));if(n.ranges[s])return void i(null,{stack:e,id:t,glyph:r});let o=n.requests[s];o||(o=n.requests[s]=[],ep.loadGlyphRange(e,s,this.url,this.requestManager,(e,t)=>{if(t){n.ascender=t.ascender,n.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(n.glyphs[+e]=t.glyphs[+e]);n.ranges[s]=!0}for(const i of o)i(e,t);delete n.requests[s]})),o.push((n,r)=>{n?i(n):r&&i(null,{stack:e,id:t,glyph:r.glyphs[t]||null})})},(e,i)=>{if(e)t(e);else if(i){const e={};for(const{stack:t,id:n,glyph:r}of i)void 0===e[t]&&(e[t]={}),void 0===e[t].glyphs&&(e[t].glyphs={}),e[t].glyphs[n]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics},e[t].ascender=this.entries[t].ascender,e[t].descender=this.entries[t].descender;t(null,e)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Qd.none&&(this.localGlyphMode===Qd.all?!!this.localFontFamily:!!this.localFontFamily&&(ns(e)||os(e)||$r(e)||Xr(e)||Zr(e)))}_tinySDF(e,t,i){const n=this.localFontFamily;if(!n||!this._doesCharSupportLocalGlyph(i))return;let r=e.tinySDF;if(!r){let i="400";/bold/i.test(t)?i="900":/medium/i.test(t)?i="500":/light/i.test(t)&&(i="200"),r=e.tinySDF=new ep.TinySDF({fontFamily:n,fontWeight:i,fontSize:48,buffer:6,radius:16}),r.fontWeight=i}if(this.localGlyphs[r.fontWeight][i])return this.localGlyphs[r.fontWeight][i];const s=String.fromCharCode(i),{data:o,width:a,height:l,glyphWidth:c,glyphHeight:h,glyphLeft:u,glyphTop:d,glyphAdvance:p}=r.draw(s);return this.localGlyphs[r.fontWeight][i]={id:i,bitmap:new Gc({width:a,height:l},o),metrics:{width:c/2,height:h/2,left:u/2,top:d/2-27,advance:p/2,localGlyph:!0}}}}function tp(e,t,i,n){const r=[],s=e.image,o=s.pixelRatio,a=s.paddedRect.w-2,l=s.paddedRect.h-2,c=e.right-e.left,h=e.bottom-e.top,u=s.stretchX||[[0,a]],d=s.stretchY||[[0,l]],p=(e,t)=>e+t[1]-t[0],m=u.reduce(p,0),f=d.reduce(p,0),g=a-m,_=l-f;let v=0,x=m,b=0,w=f,C=0,S=g,E=0,T=_;if(s.content&&n){const e=s.content;v=ip(u,0,e[0]),b=ip(d,0,e[1]),x=ip(u,e[0],e[2]),w=ip(d,e[1],e[3]),C=e[0]-v,E=e[1]-b,S=e[2]-e[0]-x,T=e[3]-e[1]-w}const P=(n,r,a,l)=>{const u=rp(n.stretch-v,x,c,e.left),d=sp(n.fixed-C,S,n.stretch,m),p=rp(r.stretch-b,w,h,e.top),g=sp(r.fixed-E,T,r.stretch,f),_=rp(a.stretch-v,x,c,e.left),P=sp(a.fixed-C,S,a.stretch,m),M=rp(l.stretch-b,w,h,e.top),k=sp(l.fixed-E,T,l.stretch,f),A=new y(u,p),I=new y(_,p),R=new y(_,M),O=new y(u,M),N=new y(d/o,g/o),D=new y(P/o,k/o),z=t*Math.PI/180;if(z){const e=Math.sin(z),t=Math.cos(z),i=[t,-e,e,t];A._matMult(i),I._matMult(i),O._matMult(i),R._matMult(i)}const L=n.stretch+n.fixed,B=r.stretch+r.fixed;return{tl:A,tr:I,bl:O,br:R,tex:{x:s.paddedRect.x+1+L,y:s.paddedRect.y+1+B,w:a.stretch+a.fixed-L,h:l.stretch+l.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:N,pixelOffsetBR:D,minFontScaleX:S/o/c,minFontScaleY:T/o/h,isSDF:i}};if(n&&(s.stretchX||s.stretchY)){const e=np(u,g,m),t=np(d,_,f);for(let i=0;i<e.length-1;i++){const n=e[i],s=e[i+1];for(let e=0;e<t.length-1;e++)r.push(P(n,t[e],s,t[e+1]))}}else r.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return r}function ip(e,t,i){let n=0;for(const r of e)n+=Math.max(t,Math.min(i,r[1]))-Math.max(t,Math.min(i,r[0]));return n}function np(e,t,i){const n=[{fixed:-1,stretch:0}];for(const[r,s]of e){const e=n[n.length-1];n.push({fixed:r-e.stretch,stretch:e.stretch}),n.push({fixed:r-e.stretch,stretch:e.stretch+(s-r)})}return n.push({fixed:t+1,stretch:i}),n}function rp(e,t,i,n){return e/t*i+n}function sp(e,t,i,n){return e-t*i/n}function op(e,t,i,n){const r=t+e.positionedLines[n].lineOffset;return 0===n?i+r/2:i+(r+(t+e.positionedLines[n-1].lineOffset))/2}ep.loadGlyphRange=function(e,t,i,n,r){const s=256*t,o=s+255,a=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}",`${s}-${o}`),le.Glyphs);de(a,(e,t)=>{if(e)r(e);else if(t){const e={},i=function(e){return new bd(e).readFields(wd,{})}(t);for(const t of i.glyphs)e[t.id]=t;r(null,{glyphs:e,ascender:i.ascender,descender:i.descender})}})},ep.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:i=8,cutoff:n=.25,fontFamily:r="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=i;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${s} ${e}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(i),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),c=a+2*this.buffer,h=l+2*this.buffer,u=Math.max(c*h,0),d=new Uint8ClampedArray(u),p={data:d,width:c,height:h,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return p;const{ctx:m,buffer:f,gridInner:g,gridOuter:_}=this;m.clearRect(f,f,a,l),m.fillText(e,f,f+o);const y=m.getImageData(f,f,a,l);_.fill(Kd,0,u),g.fill(0,0,u);for(let v=0;v<l;v++)for(let e=0;e<a;e++){const t=y.data[4*(v*a+e)+3]/255;if(0===t)continue;const i=(v+f)*c+e+f;if(1===t)_[i]=0,g[i]=Kd;else{const e=.5-t;_[i]=e>0?e*e:0,g[i]=e<0?e*e:0}}Yd(_,0,0,c,h,c,this.f,this.v,this.z),Yd(g,f,f,a,l,c,this.f,this.v,this.z);for(let v=0;v<u;v++){const e=Math.sqrt(_[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class ap{constructor(e=[],t=lp){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,n=t[e];for(;e>0;){const r=e-1>>1,s=t[r];if(i(n,s)>=0)break;t[e]=s,e=r}t[e]=n}_down(e){const{data:t,compare:i}=this,n=this.length>>1,r=t[e];for(;e<n;){let n=1+(e<<1),s=t[n];const o=n+1;if(o<this.length&&i(t[o],s)<0&&(n=o,s=t[o]),i(s,r)>=0)break;t[e]=s,e=n}t[e]=r}}function lp(e,t){return e<t?-1:e>t?1:0}function cp(e,t=1,i=!1){let n=1/0,r=1/0,s=-1/0,o=-1/0;const a=e[0];for(let p=0;p<a.length;p++){const e=a[p];(!p||e.x<n)&&(n=e.x),(!p||e.y<r)&&(r=e.y),(!p||e.x>s)&&(s=e.x),(!p||e.y>o)&&(o=e.y)}const l=Math.min(s-n,o-r);let c=l/2;const h=new ap([],hp);if(0===l)return new y(n,r);for(let p=n;p<s;p+=l)for(let t=r;t<o;t+=l)h.push(new up(p+c,t+c,c,e));let u=function(e){let t=0,i=0,n=0;const r=e[0];for(let s=0,o=r.length,a=o-1;s<o;a=s++){const e=r[s],o=r[a],l=e.x*o.y-o.x*e.y;i+=(e.x+o.x)*l,n+=(e.y+o.y)*l,t+=3*l}return new up(i/t,n/t,0,e)}(e),d=h.length;for(;h.length;){const n=h.pop();(n.d>u.d||!u.d)&&(u=n,i&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,d)),n.max-u.d<=t||(c=n.h/2,h.push(new up(n.p.x-c,n.p.y-c,c,e)),h.push(new up(n.p.x+c,n.p.y-c,c,e)),h.push(new up(n.p.x-c,n.p.y+c,c,e)),h.push(new up(n.p.x+c,n.p.y+c,c,e)),d+=4)}return i&&(console.log("num probes: "+d),console.log("best distance: "+u.d)),u.p}function hp(e,t){return t.max-e.max}class up{constructor(e,t,i,n){this.p=new y(e,t),this.h=i,this.d=function(e,t){let i=!1,n=1/0;for(let r=0;r<t.length;r++){const s=t[r];for(let t=0,r=s.length,o=r-1;t<r;o=t++){const r=s[t],a=s[o];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(i=!i),n=Math.min(n,Ec(e,r,a))}}return(i?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}}const dp=Number.POSITIVE_INFINITY,pp=Math.sqrt(2);function mp(e,[t,i]){let n=0,r=0;if(i===dp){t<0&&(t=0);const i=t/pp;switch(e){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-t;break;case"top":r=t-7}switch(e){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=t;break;case"right":n=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),e){case"top-right":case"top-left":case"top":r=i-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-i}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}}return[n,r]}function fp(e,t,i,n,r,s,o,a,l,c){e.createArrays(),e.tilePixelRatio=va/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const h=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,d={};if("composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:i}=e.textSizeData;d.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Ns(t),a),u["text-size"].possiblyEvaluate(new Ns(i),a)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:i}=e.iconSizeData;d.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Ns(t),a),u["icon-size"].possiblyEvaluate(new Ns(i),a)]}d.layoutTextSize=u["text-size"].possiblyEvaluate(new Ns(l+1),a),d.layoutIconSize=u["icon-size"].possiblyEvaluate(new Ns(l+1),a),d.textMaxSize=u["text-size"].possiblyEvaluate(new Ns(18),a);const p="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement"),m=h.get("text-size");for(const f of e.features){const s=h.get("text-font").evaluate(f,{},a).join(","),l=m.evaluate(f,{},a),u=d.layoutTextSize.evaluate(f,{},a),g=(d.layoutIconSize.evaluate(f,{},a),{horizontal:{},vertical:void 0}),_=f.text;let y,v=[0,0];if(_){const n=_.toString(),o=24*h.get("text-letter-spacing").evaluate(f,{},a),c=24*h.get("text-line-height").evaluate(f,{},a),d=fs(n)?o:0,m=h.get("text-anchor").evaluate(f,{},a),y=h.get("text-variable-anchor");if(!y){const e=h.get("text-radial-offset").evaluate(f,{},a);v=e?mp(m,[24*e,dp]):h.get("text-offset").evaluate(f,{},a).map(e=>24*e)}let x=p?"center":h.get("text-justify").evaluate(f,{},a);const b="point"===h.get("symbol-placement"),w=b?24*h.get("text-max-width").evaluate(f,{},a):1/0,C=o=>{e.allowVerticalPlacement&&ms(n)&&(g.vertical=Id(_,t,i,r,s,w,c,m,o,d,v,Md.vertical,!0,u,l))};if(!p&&y){const e="auto"===x?y.map(e=>gp(e)):[x];let n=!1;for(let o=0;o<e.length;o++){const a=e[o];if(!g.horizontal[a])if(n)g.horizontal[a]=g.horizontal[0];else{const e=Id(_,t,i,r,s,w,c,"center",a,d,v,Md.horizontal,!1,u,l);e&&(g.horizontal[a]=e,n=1===e.positionedLines.length)}}C("left")}else{if("auto"===x&&(x=gp(m)),b||h.get("text-writing-mode").indexOf("horizontal")>=0||!ms(n)){const e=Id(_,t,i,r,s,w,c,m,x,d,v,Md.horizontal,!1,u,l);e&&(g.horizontal[x]=e)}C(b?"left":x)}}let x=!1;if(f.icon&&f.icon.name){const t=n[f.icon.name];t&&(y=jd(r[f.icon.name],h.get("icon-offset").evaluate(f,{},a),h.get("icon-anchor").evaluate(f,{},a)),x=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&H("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==h.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const b=bp(g.horizontal)||g.vertical;e.iconsInText||(e.iconsInText=!!b&&b.iconsInText),(b||y)&&_p(e,f,g,y,n,d,u,0,v,x,o,a,c)}s&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray)}function gp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _p(e,t,i,n,r,s,o,a,l,c,h,u,d){let p=s.textMaxSize.evaluate(t,{},u);void 0===p&&(p=o);const m=e.layers[0].layout,f=m.get("icon-offset").evaluate(t,{},u),g=bp(i.horizontal)||i.vertical,_="globe"===d.name,y=o/24,v=e.tilePixelRatio*p/24,x=(k=e.overscaling,e.zoom>18&&k>2&&(k>>=1),Math.max(va/(512*k),1)*m.get("symbol-spacing")),w=m.get("text-padding")*e.tilePixelRatio,C=m.get("icon-padding")*e.tilePixelRatio,S=b(m.get("text-max-angle")),E="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement"),T="map"===m.get("icon-rotation-alignment")&&"point"!==m.get("symbol-placement"),P=m.get("symbol-placement"),M=x/2;var k;const A=m.get("icon-text-fit");let I;n&&"none"!==A&&(e.allowVerticalPlacement&&i.vertical&&(I=Vd(n,i.vertical,A,m.get("icon-text-fit-padding"),f,y)),g&&(n=Vd(n,g,A,m.get("icon-text-fit-padding"),f,y)));const R=(o,a,p)=>{if(a.x<0||a.x>=va||a.y<0||a.y>=va)return;let m=null;if(_){const{x:e,y:t,z:i}=d.projectTilePoint(a.x,a.y,p);m={anchor:new Ud(e,t,i,0,void 0),up:d.upVector(p,a.x,a.y)}}!function(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v,x,b,w,C,S){const E=e.addToLineVertexArray(t,n);let T,P,M,k,A,I,R,O=0,N=0,D=0,z=0,L=-1,B=-1;const F={};let j=Ho("");const V=i?i.anchor:t;let U=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[U,q]=l.layout.get("text-offset").evaluate(x,{},S).map(e=>24*e):(U=24*l.layout.get("text-radial-offset").evaluate(x,{},S),q=dp),e.allowVerticalPlacement&&r.vertical){const e=r.vertical;if(m)I=Cp(e),a&&(R=Cp(a));else{const i=l.layout.get("text-rotate").evaluate(x,{},S)+90;M=wp(c,V,t,h,u,d,e,p,i,f),a&&(k=wp(c,V,t,h,u,d,a,_,i))}}if(s){const n=l.layout.get("icon-rotate").evaluate(x,{},S),r="none"!==l.layout.get("icon-text-fit"),o=tp(s,n,w,r),p=a?tp(a,n,w,r):void 0;P=wp(c,V,t,h,u,d,s,_,n),O=4*o.length;const m=e.iconSizeData;let f=null;"source"===m.kind?(f=[Hu*l.layout.get("icon-size").evaluate(x,{},S)],f[0]>vp&&H(`${e.layerIds[0]}: Value for "icon-size" is >= ${yp}. Reduce your "icon-size".`)):"composite"===m.kind&&(f=[Hu*b.compositeIconSizes[0].evaluate(x,{},S),Hu*b.compositeIconSizes[1].evaluate(x,{},S)],(f[0]>vp||f[1]>vp)&&H(`${e.layerIds[0]}: Value for "icon-size" is >= ${yp}. Reduce your "icon-size".`)),e.addSymbols(e.icon,o,f,v,y,x,!1,i,t,E.lineStartIndex,E.lineLength,-1,C,S),L=e.icon.placedSymbolArray.length-1,p&&(N=4*p.length,e.addSymbols(e.icon,p,f,v,y,x,Md.vertical,i,t,E.lineStartIndex,E.lineLength,-1,C,S),B=e.icon.placedSymbolArray.length-1)}for(const H in r.horizontal){const n=r.horizontal[H];T||(j=Ho(n.text),m?A=Cp(n):T=wp(c,V,t,h,u,d,n,p,l.layout.get("text-rotate").evaluate(x,{},S),f));const s=1===n.positionedLines.length;if(D+=xp(e,i,t,n,o,l,m,x,f,E,r.vertical?Md.horizontal:Md.horizontalOnly,s?Object.keys(r.horizontal):[H],F,L,b,C,S),s)break}r.vertical&&(z+=xp(e,i,t,r.vertical,o,l,m,x,f,E,Md.vertical,["vertical"],F,B,b,C,S));let G=-1;const W=(e,t)=>e?Math.max(e,t):t;G=W(A,G),G=W(I,G),G=W(R,G);const Z=G>-1?1:0;e.glyphOffsetArray.length>=im.MAX_GLYPHS&&H("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(V.x,V.y,V.z,t.x,t.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical>=0?F.vertical:-1,L,B,j,void 0!==T?T:e.collisionBoxArray.length,void 0!==T?T+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,void 0!==P?P:e.collisionBoxArray.length,void 0!==P?P+1:e.collisionBoxArray.length,k||e.collisionBoxArray.length,k?k+1:e.collisionBoxArray.length,h,D,z,O,N,Z,0,U,q,G)}(e,a,m,o,i,n,r,I,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,w,E,l,0,C,T,f,t,s,c,h,u)};if("line"===P)for(const b of Xd(t.geometry,0,0,va,va)){const t=$d(b,x,S,i.vertical||g,n,24,v,e.overscaling,va);for(const i of t)g&&Sp(e,g.text,M,i)||R(b,i,u)}else if("line-center"===P){for(const e of t.geometry)if(e.length>1){const t=Zd(e,S,i.vertical||g,n,24,v);t&&R(e,t,u)}}else if("Polygon"===t.type)for(const b of kh(t.geometry,0)){const e=cp(b,16);R(b[0],new Ud(e.x,e.y,0,0,void 0),u)}else if("LineString"===t.type)for(const b of t.geometry)R(b,new Ud(b[0].x,b[0].y,0,0,void 0),u);else if("Point"===t.type)for(const b of t.geometry)for(const e of b)R([e],new Ud(e.x,e.y,0,0,void 0),u)}const yp=255,vp=yp*Hu;function xp(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g){const _=function(e,t,i,n,r,s,o,a){const l=[];if(0===t.positionedLines.length)return l;const c=n.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,h=function(e){const t=e[0],i=e[1],n=t*i;return n>0?[t,-i]:n<0?[-t,i]:0===t?[i,t]:[i,-t]}(i);let u=Math.abs(t.top-t.bottom);for(const f of t.positionedLines)u-=f.lineOffset;const d=t.positionedLines.length,p=u/d;let m=t.top-i[1];for(let f=0;f<d;++f){const e=t.positionedLines[f];m=op(t,p,m,f);for(const n of e.positionedGlyphs){if(!n.rect)continue;const e=n.rect||{};let s=4,u=!0,d=1,p=0;if(n.imageName){const e=o[n.imageName];if(!e)continue;if(e.sdf){H("SDF images are not supported in formatted text and will be ignored.");continue}u=!1,d=e.pixelRatio,s=1/d}const f=(r||a)&&n.vertical,g=n.metrics.advance*n.scale/2,_=n.metrics,v=n.rect;if(null===v)continue;a&&t.verticalizable&&(p=n.imageName?g-n.metrics.width*n.scale/2:0);const x=r?[n.x+g,n.y]:[0,0];let b=[0,0],w=[0,0],C=!1;r||(f?(w=[n.x+g+h[0],n.y+h[1]-p],C=!0):b=[n.x+g+i[0],n.y+i[1]-p]);const S=v.w*n.scale/(d*(n.localGlyph?2:1)),E=v.h*n.scale/(d*(n.localGlyph?2:1));let T,P,M,k;if(f){const e=n.y-m,t=new y(-g,g-e),i=-Math.PI/2,r=new y(...w);T=new y(-g+b[0],b[1]),T._rotateAround(i,t)._add(r),T.x+=-e+g,T.y-=(_.left-s)*n.scale;const o=n.imageName?_.advance*n.scale:24*n.scale,a=String.fromCharCode(n.glyph);Yu(a)?T.x+=(1-s)*n.scale:Ju(a)?T.x+=o-_.height*n.scale+(-s-1)*n.scale:T.x+=n.imageName||_.width+2*s===v.w&&_.height+2*s===v.h?(o-E)/2:(o-(_.height+2*s)*n.scale)/2,P=new y(T.x,T.y-S),M=new y(T.x+E,T.y),k=new y(T.x+E,T.y-S)}else{const e=(_.left-s)*n.scale-g+b[0],t=(-_.top-s)*n.scale+b[1],i=e+S,r=t+E;T=new y(e,t),P=new y(i,t),M=new y(e,r),k=new y(i,r)}if(c){let e;e=r?new y(0,0):C?new y(h[0],h[1]):new y(i[0],i[1]),T._rotateAround(c,e),P._rotateAround(c,e),M._rotateAround(c,e),k._rotateAround(c,e)}const A=new y(0,0),I=new y(0,0);l.push({tl:T,tr:P,bl:M,br:k,tex:e,writingMode:t.writingMode,glyphOffset:x,sectionIndex:n.sectionIndex,isSDF:u,pixelOffsetTL:A,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}}return l}(0,n,l,s,o,a,r,e.allowVerticalPlacement),v=e.textSizeData;let x=null;"source"===v.kind?(x=[Hu*s.layout.get("text-size").evaluate(a,{},g)],x[0]>vp&&H(`${e.layerIds[0]}: Value for "text-size" is >= ${yp}. Reduce your "text-size".`)):"composite"===v.kind&&(x=[Hu*m.compositeTextSizes[0].evaluate(a,{},g),Hu*m.compositeTextSizes[1].evaluate(a,{},g)],(x[0]>vp||x[1]>vp)&&H(`${e.layerIds[0]}: Value for "text-size" is >= ${yp}. Reduce your "text-size".`)),e.addSymbols(e.text,_,x,l,o,a,h,t,i,c.lineStartIndex,c.lineLength,p,f,g);for(const y of u)d[y]=e.text.placedSymbolArray.length-1;return 4*_.length}function bp(e){for(const t in e)return e[t];return null}function wp(e,t,i,n,r,s,o,a,l,c){let h=o.top,u=o.bottom,d=o.left,p=o.right;const m=o.collisionPadding;if(m&&(d-=m[0],h-=m[1],p+=m[2],u+=m[3]),l){const e=new y(d,h),t=new y(p,h),i=new y(d,u),n=new y(p,u),r=b(l);let s=new y(0,0);c&&(s=new y(c[0],c[1])),e._rotateAround(r,s),t._rotateAround(r,s),i._rotateAround(r,s),n._rotateAround(r,s),d=Math.min(e.x,t.x,i.x,n.x),p=Math.max(e.x,t.x,i.x,n.x),h=Math.min(e.y,t.y,i.y,n.y),u=Math.max(e.y,t.y,i.y,n.y)}return e.emplaceBack(t.x,t.y,t.z,i.x,i.y,d,h,p,u,a,n,r,s),e.length-1}function Cp(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Sp(e,t,i,n){const r=e.compareText;if(t in r){const e=r[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<i)return!0}else r[t]=[];return r[t].push(n),!1}function Ep(e,t){const i=e.fovAboveCenter,n=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,r=(e._camera.position[2]*e.worldSize-n)/Math.cos(e._pitch),s=Math.sin(i)*r/Math.sin(Math.max(Math.PI/2-e._pitch-i,.01)),o=Math.sin(e._pitch)*s+r;return Math.min(1.01*o,r*(1/e._horizonShift))}function Tp(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const i=Math.pow(2,-e.z),n=e.x*i,r=(e.x+1)*i,s=e.y*i,o=(e.y+1)*i,a=ec(n),l=ec(r),c=tc(s),h=tc(o),u=t.project(a,c),d=t.project(l,c),p=t.project(l,h),m=t.project(a,h);let f=Math.min(u.x,d.x,p.x,m.x),g=Math.min(u.y,d.y,p.y,m.y),_=Math.max(u.x,d.x,p.x,m.x),y=Math.max(u.y,d.y,p.y,m.y);const v=i/16;function x(e,i,n,r,s,o){const a=(n+s)/2,l=(r+o)/2,c=t.project(ec(a),tc(l)),h=Math.max(0,f-c.x,g-c.y,c.x-_,c.y-y);f=Math.min(f,c.x),_=Math.max(_,c.x),g=Math.min(g,c.y),y=Math.max(y,c.y),h>v&&(x(e,c,n,r,a,l),x(c,i,a,l,s,o))}x(u,d,n,s,r,s),x(d,p,r,s,r,o),x(p,m,r,o,n,o),x(m,u,n,o,n,s),f-=v,g-=v,_+=v,y+=v;const b=1/Math.max(_-f,y-g);return{scale:b,x:f*b,y:g*b,x2:_*b,y2:y*b,projection:t}}const Pp=Ea(new Float32Array(16));class Mp{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new Xl(0,0)}projectTilePoint(e,t,i){return{x:e,y:t,z:0}}locationPoint(e,t,i=!0){return e._coordinatePoint(e.locationCoordinate(t),i)}pixelsPerMeter(e,t){return Ql(1,e)*t}pixelSpaceConversion(e,t,i){return 1}farthestPixelDistance(e){return Ep(e,e.pixelsPerMeter)}pointCoordinate(e,t,i,n){const r=e.horizonLineFromTop(!1),s=new y(t,Math.max(r,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(s,n))}pointCoordinate3D(e,t,i){const n=new y(t,i);if(e.elevation)return e.elevation.pointCoordinate(n);{const t=this.pointCoordinate(e,n.x,n.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);const i=e.horizonLineFromTop();return t.y<i}createInversionMatrix(e,t){return Pp}createTileMatrix(e,t,i){let n,r,s;const o=i.canonical,a=Ea(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=Tp(o,this);n=1,r=l.x+i.wrap*l.scale,s=l.y,ka(a,a,[n/l.scale,n/l.scale,e.pixelsPerMeter/t])}else n=t/e.zoomScale(o.z),r=(o.x+Math.pow(2,o.z)*i.wrap)*n,s=o.y*n;return Ma(a,a,[r,s,0]),ka(a,a,[n/va,n/va,1]),a}upVector(e,t,i){return[0,0,1]}upVectorScale(e,t,i){return{metersToTile:1}}}class kp extends Mp{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,i]=this.parallels=e.parallels||[29.5,45.5],n=Math.sin(b(t));this.n=(n+Math.sin(b(i)))/2,this.c=1+n*(2*this.n-n),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:i,c:n,r0:r}=this,s=b(e-this.center[0]),o=b(t),a=Math.sqrt(n-2*i*Math.sin(o))/i;return{x:a*Math.sin(s*i),y:a*Math.cos(s*i)-r,z:0}}unproject(e,t){const{n:i,c:n,r0:r}=this,s=r+t;let o=Math.atan2(e,Math.abs(s))*Math.sign(s);s*i<0&&(o-=Math.PI*Math.sign(e)*Math.sign(s));const a=b(this.center[0])*i;o=k(o,-Math.PI-a,Math.PI-a);const l=P(w(o/i)+this.center[0],-180,180),c=Math.asin(P((n-(e*e+s*s)*i*i)/(2*i),-1,1)),h=P(w(c),-nc,nc);return new Xl(l,h)}}const Ap=1.340264,Ip=-.081106,Rp=893e-6,Op=.003796,Np=Math.sqrt(3)/2;class Dp extends Mp{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const i=Math.asin(Np*Math.sin(t)),n=i*i,r=n*n*n;return{x:.5*(e*Math.cos(i)/(Np*(Ap+3*Ip*n+r*(7*Rp+9*Op*n)))/Math.PI+.5),y:1-.5*(i*(Ap+Ip*n+r*(Rp+Op*n))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,n=i*i,r=n*n*n;for(let c,h,u,d=0;d<12&&(h=i*(Ap+Ip*n+r*(Rp+Op*n))-t,u=Ap+3*Ip*n+r*(7*Rp+9*Op*n),c=h/u,i=P(i-c,-Math.PI/3,Math.PI/3),n=i*i,r=n*n*n,!(Math.abs(c)<1e-12));++d);const s=Np*e*(Ap+3*Ip*n+r*(7*Rp+9*Op*n))/Math.cos(i),o=Math.asin(Math.sin(i)/Np),a=P(180*s/Math.PI,-180,180),l=P(180*o/Math.PI,-nc,nc);return new Xl(a,l)}}class zp extends Mp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const i=360*(e-.5),n=P(360*(.5-t),-nc,nc);return new Xl(i,n)}}const Lp=Math.PI/2;function Bp(e){return Math.tan((Lp+e)/2)}class Fp extends Mp{constructor(e){super(e),this.center=e.center||[0,30];const[t,i]=this.parallels=e.parallels||[30,30];let n=b(t),r=b(i);this.southernCenter=n+r<0,this.southernCenter&&(n=-n,r=-r);const s=Math.cos(n),o=Bp(n);this.n=n===r?Math.sin(n):Math.log(s/Math.cos(r))/Math.log(Bp(r)/o),this.f=s*Math.pow(Bp(n),this.n)/this.n}project(e,t){t=b(t),this.southernCenter&&(t=-t),e=b(e-this.center[0]);const i=1e-6,{n,f:r}=this;r>0?t<-Lp+i&&(t=-Lp+i):t>Lp-i&&(t=Lp-i);const s=r/Math.pow(Bp(t),n);let o=s*Math.sin(n*e),a=r-s*Math.cos(n*e);return o=.5*(o/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:o,y:this.southernCenter?a:1-a,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:i,f:n}=this,r=n-t,s=Math.sign(r),o=Math.sign(i)*Math.sqrt(e*e+r*r);let a=Math.atan2(e,Math.abs(r))*s;r*i<0&&(a-=Math.PI*Math.sign(e)*s);const l=P(w(a/i)+this.center[0],-180,180),c=P(w(2*Math.atan(Math.pow(n/o,1/i))-Lp),-nc,nc);return new Xl(l,this.southernCenter?-c:c)}}class jp extends Mp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:Yl(e),y:Jl(t),z:0}}unproject(e,t){const i=ec(e),n=tc(t);return new Xl(i,n)}}const Vp=b(nc);class Up extends Mp{project(e,t){const i=(t=b(t))*t,n=i*i;return{x:.5*((e=b(e))*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,n=25,r=0,s=i*i;do{s=i*i;const e=s*s;r=(i*(1.007226+s*(.015085+e*(.028874*s-.044475-.005916*e)))-t)/(1.007226+s*(.045255+e*(.259866*s-.311325-.005916*11*e))),i=P(i-r,-Vp,Vp)}while(Math.abs(r)>1e-6&&--n>0);s=i*i;const o=P(w(e/(.8707+s*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979))),-180,180),a=w(i);return new Xl(o,a)}}const qp=b(nc);class Hp extends Mp{project(e,t){t=b(t),e=b(e);const i=Math.cos(t),n=2/Math.PI,r=Math.acos(i*Math.cos(e/2)),s=Math.sin(r)/r,o=.5*(e*n+2*i*Math.sin(e/2)/s)||0,a=.5*(t+Math.sin(t)/s)||0;return{x:.5*(o/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(e,t){let i=e=(2*e-.5)*Math.PI,n=t=(2*(1-t)-1)*Math.PI,r=25;const s=1e-6;let o=0,a=0;do{const r=Math.cos(n),s=Math.sin(n),l=2*s*r,c=s*s,h=r*r,u=Math.cos(i/2),d=Math.sin(i/2),p=2*u*d,m=d*d,f=1-h*u*u,g=f?1/f:0,_=f?Math.acos(r*u)*Math.sqrt(1/f):0,y=.5*(2*_*r*d+2*i/Math.PI)-e,v=.5*(_*s+n)-t,x=.5*g*(h*m+_*r*u*c)+1/Math.PI,b=g*(p*l/4-_*s*d),w=.125*g*(l*d-_*s*h*p),C=.5*g*(c*u+_*m*r)+.5,S=b*w-C*x;o=(v*b-y*C)/S,a=(y*w-v*x)/S,i=P(i-o,-Math.PI,Math.PI),n=P(n-a,-qp,qp)}while((Math.abs(o)>s||Math.abs(a)>s)&&--r>0);return new Xl(w(i),w(n))}}class Gp extends Mp{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(b(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:i,cosPhi:n}=this;return{x:b(e)*n*i+.5,y:-Math.sin(b(t))/n*i+.5,z:0}}unproject(e,t){const{scale:i,cosPhi:n}=this,r=-(t-.5)/i,s=P(w((e-.5)/i)/n,-180,180),o=Math.asin(P(r*n,-1,1)),a=P(w(o),-nc,nc);return new Xl(s,a)}}class Wp extends jp{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,i){const n=Nl(e,t,i);return Xa(n,n,Ll(Tl(i))),{x:n[0],y:n[1],z:n[2]}}locationPoint(e,t){const i=Ol(t.lat,t.lng),n=Wa([],i),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;Ga(i,i,n,Ql(1,0)*va*r);const s=Ea(new Float64Array(16));return Pa(s,e.pixelMatrix,e.globeMatrix),Xa(i,i,s),new y(i[0],i[1])}pixelsPerMeter(e,t){return Ql(1,0)*t}pixelSpaceConversion(e,t,i){const n=Ql(1,e)*t,r=Ai(Ql(1,45)*t,n,i);return this.pixelsPerMeter(e,t)/r}createTileMatrix(e,t,i){const n=Bl(Tl(i.canonical));return Pa(new Float64Array(16),e.globeMatrix,n)}createInversionMatrix(e,t){const{center:i}=e,n=Ll(Tl(t));return Ia(n,n,b(i.lng)),Aa(n,n,b(i.lat)),ka(n,n,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(n)}pointCoordinate(e,t,i,n){return Cl(e,t,i,!0)||new sc(0,0)}pointCoordinate3D(e,t,i){const n=this.pointCoordinate(e,t,i,0);return[n.x,n.y,n.z]}isPointAboveHorizon(e,t){return!Cl(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const i=e.cameraToCenterDistance,n=e._centerAltitude*t,r=e._camera,s=e._camera.forward(),o=Fa([],Ha([],s,-i),[0,0,n]),a=e.worldSize/(2*Math.PI),l=[0,0,-a],c=e.width/e.height,h=Math.tan(e.fovAboveCenter),u=Ha([],r.up(),h),d=Ha([],r.right(),h*c),p=Wa([],Fa([],Fa([],s,u),d)),m=[];let f;if(new pl(o,p).closestPointOnSphere(l,a,m)){const t=Fa([],m,l),i=Ja([],t,o);f=Math.cos(e.fovAboveCenter)*La(i)}else{const e=Ja([],o,l),t=Ja([],l,o);Wa(t,t);const i=La(e)-a;f=Math.sqrt(i*(i+2*a));const n=Math.acos(f/(a+i))-Math.acos(Za(s,t));f*=Math.cos(n)}return 1.01*f}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=jl(e.zoom);if(i>0){const n=Ep(e,Ql(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),s=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Ai(t,n+r*(1-Math.cos(s)),Math.pow(i,10))}return t}upVector(e,t,i){return Nl(t,i,e,1)}upVectorScale(e){return{metersToTile:wl(Dl(Tl(e)))}}}function Zp(e){const t=e.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new jp(e);case"equirectangular":return new zp(e);case"naturalEarth":return new Up(e);case"equalEarth":return new Dp(e);case"winkelTripel":return new Hp(e);case"albers":return i?new Gp(e):new kp(e);case"lambertConformalConic":return i?new Gp(e):new Fp(e);case"globe":return new Wp(e)}throw new Error("Invalid projection name: "+e.name)}const $p=Qh.types,Xp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kp(e,t,i,n,r,s,o,a,l,c,h,u,d){const p=a?Math.min(vp,Math.round(a[0])):0,m=a?Math.min(vp,Math.round(a[1])):0;e.emplaceBack(t,i,Math.round(32*n),Math.round(32*r),s,o,(p<<1)+(l?1:0),m,16*c,16*h,256*u,256*d)}function Yp(e,t,i,n,r,s,o){e.emplaceBack(t,i,n,r,s,o)}function Jp(e,t,i,n,r){e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r)}function Qp(e){for(const t of e.sections)if(bs(t.text))return!0;return!1}class em{constructor(e){this.layoutVertexArray=new ao,this.indexArray=new go,this.programConfigurations=e,this.segments=new ya,this.dynamicLayoutVertexArray=new no,this.opacityVertexArray=new co,this.placedSymbolArray=new Mo,this.globeExtVertexArray=new lo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Lu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Fu.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Xp,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Bu.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}zr(em,"SymbolBuffers");class tm{constructor(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new ya,this.collisionVertexArray=new mo,this.collisionVertexArrayExt=new fo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ju.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Vu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}zr(tm,"CollisionBuffers");class im{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ea([]),this.placementViewportMatrix=Ea([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gu(this.zoom,t["text-size"]),this.iconSizeData=Gu(this.zoom,t["icon-size"]);const i=this.layers[0].layout,n=i.get("symbol-sort-key"),r=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map(e=>Md[e]),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new em(new la(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new em(new la(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Io,this.lineVertexArray=new Ro,this.symbolInstances=new Ao}calculateGlyphDependencies(e,t,i,n,r){for(let s=0;s<e.length;s++)if(t[e.charCodeAt(s)]=!0,n&&r){const i=Ku[e.charAt(s)];i&&(t[i.charCodeAt(0)]=!0)}}populate(e,t,i,n){const r=this.layers[0],s=r.layout,o="globe"===this.projection.name,a=s.get("text-font"),l=s.get("text-field"),c=s.get("icon-image"),h=("constant"!==l.value.kind||l.value.value instanceof Nt&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),u="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,d=s.get("symbol-sort-key");if(this.features=[],!h&&!u)return;const p=t.iconDependencies,m=t.glyphDependencies,f=t.availableImages,g=new Ns(this.zoom);for(const{feature:_,id:y,index:v,sourceLayerIndex:x}of e){const e=r._featureFilter.needGeometry,t=mc(_,e);if(!r._featureFilter.filter(g,t,i))continue;if(e||(t.geometry=pc(_,i,n)),o&&1!==_.type&&i.z<=5){const e=t.geometry,n=.98078528056,r=(e,t)=>Za(Nl(e.x,e.y,i,1),Nl(t.x,t.y,i,1))<n;for(let t=0;t<e.length;t++)e[t]=cc(e[t],r)}let l,c;if(h){const e=r.getValueAndResolveTokens("text-field",t,i,f),n=Nt.factory(e);Qp(n)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Is()||this.hasRTLText&&Os.isParsed())&&(l=Xu(n,r,t))}if(u){const e=r.getValueAndResolveTokens("icon-image",t,i,f);c=e instanceof Dt?e:Dt.fromString(e)}if(!l&&!c)continue;const b=this.sortFeaturesByKey?d.evaluate(t,{},i):void 0;if(this.features.push({id:y,text:l,icon:c,index:v,sourceLayerIndex:x,geometry:t.geometry,properties:_.properties,type:$p[_.type],sortKey:b}),c&&(p[c.name]=!0),l){const e=a.evaluate(t,{},i).join(","),n="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Md.vertical)>=0;for(const t of l.sections)if(t.image)p[t.image.name]=!0;else{const i=ms(l.toString()),r=t.fontStack||e,s=m[r]=m[r]||{};this.calculateGlyphDependencies(t.text,s,n,this.allowVerticalPlacement,i)}}}"line"===s.get("symbol-placement")&&(this.features=function(e){const t={},i={},n=[];let r=0;function s(t){n.push(e[t]),r++}function o(e,t,r){const s=i[e];return delete i[e],i[t]=s,n[s].geometry[0].pop(),n[s].geometry[0]=n[s].geometry[0].concat(r[0]),s}function a(e,i,r){const s=t[i];return delete t[i],t[e]=s,n[s].geometry[0].shift(),n[s].geometry[0]=r[0].concat(n[s].geometry[0]),s}function l(e,t,i){const n=i?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let c=0;c<e.length;c++){const h=e[c],u=h.geometry,d=h.text?h.text.toString():null;if(!d){s(c);continue}const p=l(d,u),m=l(d,u,!0);if(p in i&&m in t&&i[p]!==t[m]){const e=a(p,m,u),r=o(p,m,n[e].geometry);delete t[p],delete i[m],i[l(d,n[r].geometry,!0)]=r,n[e].geometry=null}else p in i?o(p,m,u):m in t?a(p,m,u):(s(c),t[p]=r-1,i[m]=r-1)}return n.filter(e=>e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((e,t)=>e.sortKey-t.sortKey)}update(e,t,i,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Zp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const i=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:n,y:r}of t)this.lineVertexArray.emplaceBack(n,r);return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,t,i,n,r,s,o,a,l,c,h,u,d,p){const m=e.indexArray,f=e.layoutVertexArray,g=e.globeExtVertexArray,_=e.segments.prepareSegment(4*t.length,f,m,this.canOverlap?s.sortKey:void 0),y=this.glyphOffsetArray.length,v=_.vertexLength,x=this.allowVerticalPlacement&&o===Md.vertical?Math.PI/2:0,b=s.text&&s.text.sections;for(let C=0;C<t.length;C++){const{tl:n,tr:r,bl:o,br:c,tex:h,pixelOffsetTL:u,pixelOffsetBR:y,minFontScaleX:v,minFontScaleY:w,glyphOffset:S,isSDF:E,sectionIndex:T}=t[C],P=_.vertexLength,M=S[1];if(Kp(f,l.x,l.y,n.x,M+n.y,h.x,h.y,i,E,u.x,u.y,v,w),Kp(f,l.x,l.y,r.x,M+r.y,h.x+h.w,h.y,i,E,y.x,u.y,v,w),Kp(f,l.x,l.y,o.x,M+o.y,h.x,h.y+h.h,i,E,u.x,y.y,v,w),Kp(f,l.x,l.y,c.x,M+c.y,h.x+h.w,h.y+h.h,i,E,y.x,y.y,v,w),a){const{x:t,y:i,z:n}=a.anchor,[r,s,o]=a.up;Yp(g,t,i,n,r,s,o),Yp(g,t,i,n,r,s,o),Yp(g,t,i,n,r,s,o),Yp(g,t,i,n,r,s,o),Jp(e.dynamicLayoutVertexArray,t,i,n,x)}else Jp(e.dynamicLayoutVertexArray,l.x,l.y,l.z,x);m.emplaceBack(P,P+1,P+2),m.emplaceBack(P+1,P+2,P+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(S[0]),C!==t.length-1&&T===t[C+1].sectionIndex||e.programConfigurations.populatePaintArrays(f.length,s,s.index,{},d,p,b&&b[T])}const w=a?a.anchor:l;e.placedSymbolArray.emplaceBack(w.x,w.y,w.z,l.x,l.y,y,this.glyphOffsetArray.length-y,v,c,h,l.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],o,0,!1,0,u,0)}_commitLayoutVertex(e,t,i,n,r,s,o){e.emplaceBack(t,i,n,r,s,Math.round(o.x),Math.round(o.y))}_addCollisionDebugVertices(e,t,i,n,r,s,o){const a=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=a.vertexLength,c=o.tileAnchorX,h=o.tileAnchorY;for(let d=0;d<4;d++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),i.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,h,new y(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,h,new y(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,h,new y(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,h,new y(e.x1,e.y2)),a.vertexLength+=4;const u=i.indexArray;u.emplaceBack(l,l+1),u.emplaceBack(l+1,l+2),u.emplaceBack(l+2,l+3),u.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceTextSize(e,s,t,o);this._addCollisionDebugVertices(n,r,this.textCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s)}}_addIconDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceIconSize(e,t,s.placedIconSymbolIndex);this._addCollisionDebugVertices(n,r,this.iconCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s)}}generateCollisionDebugBuffers(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new tm(uo,Uu.members,wo),this.iconCollisionBox=new tm(uo,Uu.members,wo);const i=Zu(this.iconSizeData,e),n=Zu(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(n,e,t,s.textBoxStartIndex,s.textBoxEndIndex,s),this._addTextDebugCollisionBoxes(n,e,t,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._addIconDebugCollisionBoxes(i,e,t,s.iconBoxStartIndex,s.iconBoxEndIndex,s),this._addIconDebugCollisionBoxes(i,e,t,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s)}}getSymbolInstanceTextSize(e,t,i,n){const r=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n),s=Wu(this.textSizeData,e,r)/24;return this.tilePixelRatio*s}getSymbolInstanceIconSize(e,t,i){const n=this.icon.placedSymbolArray.get(i),r=Wu(this.iconSizeData,e,n);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(e,t,i){e.emplaceBack(t,-i,-i),e.emplaceBack(t,i,-i),e.emplaceBack(t,i,i),e.emplaceBack(t,-i,i)}_updateTextDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceTextSize(e,s,t,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,n.padding)}}_updateIconDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceIconSize(e,t,s);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,n.padding)}}updateCollisionDebugBuffers(e,t){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=Zu(this.iconSizeData,e),n=Zu(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(n,e,t,s.textBoxStartIndex,s.textBoxEndIndex,s),this._updateTextDebugCollisionBoxes(n,e,t,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._updateIconDebugCollisionBoxes(i,e,t,s.iconBoxStartIndex,s.iconBoxEndIndex,s.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(i,e,t,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,i,n,r,s,o,a,l){const c={};if(t<i){const{x1:i,y1:n,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d,featureIndex:p}=e.get(t);c.textBox={x1:i,y1:n,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d},c.textFeatureIndex=p}if(n<r){const{x1:t,y1:i,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d,featureIndex:p}=e.get(n);c.verticalTextBox={x1:t,y1:i,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(s<o){const{x1:t,y1:i,x2:n,y2:r,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d,featureIndex:p}=e.get(s);c.iconBox={x1:t,y1:i,x2:n,y2:r,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d},c.iconFeatureIndex=p}if(a<l){const{x1:t,y1:i,x2:n,y2:r,padding:s,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d,featureIndex:p}=e.get(a);c.verticalIconBox={x1:t,y1:i,x2:n,y2:r,padding:s,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:h,tileAnchorX:u,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const i=e.placedSymbolArray.get(t),n=i.vertexStartIndex+4*i.numGlyphs;for(let r=i.vertexStartIndex;r<n;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),i=Math.cos(e),n=[],r=[],s=[];for(let o=0;o<this.symbolInstances.length;++o){s.push(o);const e=this.symbolInstances.get(o);n.push(0|Math.round(t*e.tileAnchorX+i*e.tileAnchorY)),r.push(e.featureIndex)}return s.sort((e,t)=>n[e]-n[t]||r[t]-r[e]),s}addToSortKeyRanges(e,t){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:n,leftJustifiedTextSymbolIndex:r,verticalPlacedTextSymbolIndex:s,placedIconSymbolIndex:o,verticalPlacedIconSymbolIndex:a}=t;i>=0&&this.addIndicesForPlacedSymbol(this.text,i),n>=0&&n!==i&&this.addIndicesForPlacedSymbol(this.text,n),r>=0&&r!==n&&r!==i&&this.addIndicesForPlacedSymbol(this.text,r),s>=0&&this.addIndicesForPlacedSymbol(this.text,s),o>=0&&this.addIndicesForPlacedSymbol(this.icon,o),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}zr(im,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),im.MAX_GLYPHS=65535,im.addDynamicAttributes=Jp;const nm=new Ws({"symbol-placement":new qs(et.layout_symbol["symbol-placement"]),"symbol-spacing":new qs(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qs(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Hs(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qs(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qs(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qs(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new qs(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qs(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Hs(et.layout_symbol["icon-size"]),"icon-text-fit":new qs(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qs(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Hs(et.layout_symbol["icon-image"]),"icon-rotate":new Hs(et.layout_symbol["icon-rotate"]),"icon-padding":new qs(et.layout_symbol["icon-padding"]),"icon-keep-upright":new qs(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Hs(et.layout_symbol["icon-offset"]),"icon-anchor":new Hs(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qs(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qs(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qs(et.layout_symbol["text-rotation-alignment"]),"text-field":new Hs(et.layout_symbol["text-field"]),"text-font":new Hs(et.layout_symbol["text-font"]),"text-size":new Hs(et.layout_symbol["text-size"]),"text-max-width":new Hs(et.layout_symbol["text-max-width"]),"text-line-height":new Hs(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Hs(et.layout_symbol["text-letter-spacing"]),"text-justify":new Hs(et.layout_symbol["text-justify"]),"text-radial-offset":new Hs(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qs(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Hs(et.layout_symbol["text-anchor"]),"text-max-angle":new qs(et.layout_symbol["text-max-angle"]),"text-writing-mode":new qs(et.layout_symbol["text-writing-mode"]),"text-rotate":new Hs(et.layout_symbol["text-rotate"]),"text-padding":new qs(et.layout_symbol["text-padding"]),"text-keep-upright":new qs(et.layout_symbol["text-keep-upright"]),"text-transform":new Hs(et.layout_symbol["text-transform"]),"text-offset":new Hs(et.layout_symbol["text-offset"]),"text-allow-overlap":new qs(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qs(et.layout_symbol["text-ignore-placement"]),"text-optional":new qs(et.layout_symbol["text-optional"])});var rm={paint:new Ws({"icon-opacity":new Hs(et.paint_symbol["icon-opacity"]),"icon-color":new Hs(et.paint_symbol["icon-color"]),"icon-halo-color":new Hs(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Hs(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Hs(et.paint_symbol["icon-halo-blur"]),"icon-translate":new qs(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new qs(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Hs(et.paint_symbol["text-opacity"]),"text-color":new Hs(et.paint_symbol["text-color"],{runtimeType:dt,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Hs(et.paint_symbol["text-halo-color"]),"text-halo-width":new Hs(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Hs(et.paint_symbol["text-halo-blur"]),"text-translate":new qs(et.paint_symbol["text-translate"]),"text-translate-anchor":new qs(et.paint_symbol["text-translate-anchor"])}),layout:nm};class sm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:lt,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zr(sm,"FormatSectionOverride",{omit:["defaultValue"]});class om extends fa{constructor(e){super(e,rm)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const i=this.layout.get("text-writing-mode");if(i){const e=[];for(const t of i)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,i,n){const r=this.layout.get(e).evaluate(t,{},i,n),s=this._unevaluatedLayout._values[e];return s.isDataDriven()||Un(s.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,(t,i)=>i in e?String(e[i]):"")}(t.properties,r)}createBucket(e){return new im(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of rm.paint.overridableProperties){if(!om.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),i=new sm(t),n=new Vn(i,t.property.specification);let r=null;r="constant"===t.value.kind||"source"===t.value.kind?new Hn("source",n):new Gn("composite",n,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new Vs(t.property,r,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven())&&om.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const i=e.get("text-field"),n=rm.paint.properties[t];let r=!1;const s=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(r=!0)};if("constant"===i.value.kind&&i.value.value instanceof Nt)s(i.value.value.sections);else if("source"===i.value.kind){const e=t=>{r||(t instanceof Vt&&Bt(t.value)===gt?s(t.value.sections):t instanceof Wt?s(t.sections):t.eachChild(e))},t=i.value;t._styleExpression&&e(t._styleExpression.expression)}return r}getProgramConfiguration(e){return new aa(this,e)}}var am={paint:new Ws({"background-color":new qs(et.paint_background["background-color"]),"background-pattern":new qs(et.paint_background["background-pattern"]),"background-opacity":new qs(et.paint_background["background-opacity"])})},lm={paint:new Ws({"raster-opacity":new qs(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new qs(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qs(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qs(et.paint_raster["raster-brightness-max"]),"raster-saturation":new qs(et.paint_raster["raster-saturation"]),"raster-contrast":new qs(et.paint_raster["raster-contrast"]),"raster-resampling":new qs(et.paint_raster["raster-resampling"]),"raster-fade-duration":new qs(et.paint_raster["raster-fade-duration"])})};class cm extends fa{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var hm={paint:new Ws({"sky-type":new qs(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new qs(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qs(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qs(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qs(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gs(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qs(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qs(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qs(et.paint_sky["sky-opacity"])})};function um(e,t,i){const n=[0,0,1],r=sl([]);return al(r,r,i?-b(e)+Math.PI:b(e)),ol(r,r,-b(t)),Ka(n,n,r),Wa(n,n)}const dm={circle:class extends fa{constructor(e){super(e,Dc)}createBucket(e){return new _c(e)}queryRadius(e){const t=e;return Ac("circle-radius",this,t)+Ac("circle-stroke-width",this,t)+Ic(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,i,n,r,s,o,a){const l=Oc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return zc(e,n,s,o,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getProgramConfiguration(e){return new aa(this,e)}},heatmap:class extends fa{createBucket(e){return new Vc(e)}constructor(e){super(e,Zc),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$c({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return Ac("heatmap-radius",this,e)}queryIntersectsFeature(e,t,i,n,r,s,o,a){const l=this.paint.get("heatmap-radius").evaluate(t,i);return zc(e,n,s,o,a,!0,!0,new y(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(e){return new aa(this,e)}},hillshade:class extends fa{constructor(e){super(e,Xc)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends fa{constructor(e){super(e,Dh)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(e){return new aa(this,e)}recalculate(e,t){super.recalculate(e,t);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Oh(e)}queryRadius(){return Ic(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,i,n,r,s){return!e.queryGeometry.isAboveHorizon&&xc(Rc(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends fa{constructor(e){super(e,gu)}createBucket(e){return new ou(e)}queryRadius(){return Ic(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(e){return new aa(this,e)}queryIntersectsFeature(e,t,i,n,r,s,o,a,l){const c=Oc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(t,i),u=this.paint.get("fill-extrusion-base").evaluate(t,i),d=[0,0],p=a&&s.elevation,m=s.elevation?s.elevation.exaggeration():1,f=e.tile.getBucket(this);if(p&&f instanceof ou){const e=f.centroidVertexArray,t=l+1;t<e.length&&(d[0]=e.geta_centroid_pos0(t),d[1]=e.geta_centroid_pos1(t))}if(0===d[0]&&1===d[1])return!1;"globe"===s.projection.name&&(n=mu([n],[new y(0,0),new y(va,va)],e.tileID.canonical).map(e=>e.polygon).flat());const g=p?a:null,[_,v]=function(e,t,i,n,r,s,o,a,l,c,h){return"globe"===e.projection.name?function(e,t,i,n,r,s,o,a,l,c,h){const u=[],d=[],p=e.projection.upVectorScale(h,e.center.lat,e.worldSize).metersToTile,m=[0,0,0,1],f=[0,0,0,1],g=(e,t,i,n)=>{e[0]=t,e[1]=i,e[2]=n,e[3]=1},_=pu();i>0&&(i+=_),n+=_;for(const y of t){const t=[],_=[];for(const u of y){const d=u.x+r.x,y=u.y+r.y,v=e.projection.projectTilePoint(d,y,h),x=e.projection.upVector(h,u.x,u.y);let b=i,w=n;if(o){const e=Eu(d,y,i,n,o,a,l,c);b+=e.base,w+=e.top}0!==i?g(m,v.x+x[0]*p*b,v.y+x[1]*p*b,v.z+x[2]*p*b):g(m,v.x,v.y,v.z),g(f,v.x+x[0]*p*w,v.y+x[1]*p*w,v.z+x[2]*p*w),Xa(m,m,s),Xa(f,f,s),t.push(new wu(m[0],m[1],m[2])),_.push(new wu(f[0],f[1],f[2]))}u.push(t),d.push(_)}return[u,d]}(e,t,i,n,r,s,o,a,l,c,h):o?function(e,t,i,n,r,s,o,a,l){const c=[],h=[],u=[0,0,0,1];for(const d of e){const e=[],p=[];for(const c of d){const h=c.x+n.x,d=c.y+n.y,m=Eu(h,d,t,i,s,o,a,l);u[0]=h,u[1]=d,u[2]=m.base,u[3]=1,nl(u,u,r),u[3]=Math.max(u[3],1e-5);const f=new wu(u[0]/u[3],u[1]/u[3],u[2]/u[3]);u[0]=h,u[1]=d,u[2]=m.top,u[3]=1,nl(u,u,r),u[3]=Math.max(u[3],1e-5);const g=new wu(u[0]/u[3],u[1]/u[3],u[2]/u[3]);e.push(f),p.push(g)}c.push(e),h.push(p)}return[c,h]}(t,i,n,r,s,o,a,l,c):function(e,t,i,n,r){const s=[],o=[],a=r[8]*t,l=r[9]*t,c=r[10]*t,h=r[11]*t,u=r[8]*i,d=r[9]*i,p=r[10]*i,m=r[11]*i;for(const f of e){const e=[],t=[];for(const i of f){const s=i.x+n.x,o=i.y+n.y,f=r[0]*s+r[4]*o+r[12],g=r[1]*s+r[5]*o+r[13],_=r[2]*s+r[6]*o+r[14],y=r[3]*s+r[7]*o+r[15],v=f+a,x=g+l,b=_+c,w=Math.max(y+h,1e-5),C=f+u,S=g+d,E=_+p,T=Math.max(y+m,1e-5);e.push(new wu(v/w,x/w,b/w)),t.push(new wu(C/T,S/T,E/T))}s.push(e),o.push(t)}return[s,o]}(t,i,n,r,s)}(s,n,u,h,c,o,g,d,m,s.center.lat,e.tileID.canonical),x=e.queryGeometry;return function(e,t,i){let n=1/0;xc(i,t)&&(n=Su(i,t[0]));for(let r=0;r<t.length;r++){const s=t[r],o=e[r];for(let e=0;e<s.length-1;e++){const t=s[e],r=[t,s[e+1],o[e+1],o[e],t];yc(i,r)&&(n=Math.min(n,Su(i,r)))}}return n!==1/0&&n}(_,v,x.isPointQuery()?x.screenBounds:x.screenGeometry)}},line:class extends fa{constructor(e){super(e,Nu),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ki,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Du.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Ru(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(e){return new aa(this,e)}queryRadius(e){const t=e,i=zu(Ac("line-width",this,t),Ac("line-gap-width",this,t)),n=Ac("line-offset",this,t);return i/2+Math.abs(n)+Ic(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,i,n,r,s){if(e.queryGeometry.isAboveHorizon)return!1;const o=Rc(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),a=e.pixelToTileUnitsFactor/2*zu(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),l=this.paint.get("line-offset").evaluate(t,i);return l&&(n=function(e,t){const i=[],n=new y(0,0);for(let r=0;r<e.length;r++){const s=e[r],o=[];for(let e=0;e<s.length;e++){const i=s[e],r=s[e+1],a=0===e?n:i.sub(s[e-1])._unit()._perp(),l=e===s.length-1?n:r.sub(i)._unit()._perp(),c=a._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),o.push(c._mult(t)._add(i))}i.push(o)}return i}(n,l*e.pixelToTileUnitsFactor)),function(e,t,i){for(let n=0;n<t.length;n++){const r=t[n];if(e.length>=3)for(let t=0;t<r.length;t++)if(Pc(e,r[t]))return!0;if(bc(e,r,i))return!0}return!1}(o,n,a)}isTileClipped(){return!0}},symbol:om,background:class extends fa{constructor(e){super(e,am)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends fa{constructor(e){super(e,lm)}getProgramIds(){return["raster"]}},sky:class extends fa{constructor(e){super(e,hm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=$c({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const i=this.paint.get("sky-atmosphere-sun"),n=!i,r=e.style.light,s=r.properties.get("position");return n&&"viewport"===r.properties.get("anchor")&&H("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?um(s.azimuthal,90-s.polar,t):um(i[0],90-i[1],t)}const i=this.paint.get("sky-gradient-center");return um(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}};class pm{constructor(e,t,i,n){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,i,n){const{width:r,height:s}=e,{context:o}=this,{gl:a}=o,{HTMLImageElement:l,HTMLCanvasElement:c,HTMLVideoElement:h,ImageData:u,ImageBitmap:d}=t;if(a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!i||!1!==i.premultiply)),n||this.size&&this.size[0]===r&&this.size[1]===s){const{x:t,y:i}=n||{x:0,y:0};e instanceof l||e instanceof c||e instanceof h||e instanceof u||d&&e instanceof d?a.texSubImage2D(a.TEXTURE_2D,0,t,i,a.RGBA,a.UNSIGNED_BYTE,e):a.texSubImage2D(a.TEXTURE_2D,0,t,i,r,s,a.RGBA,a.UNSIGNED_BYTE,e.data)}else this.size=[r,s],e instanceof l||e instanceof c||e instanceof h||e instanceof u||d&&e instanceof d?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,e):a.texImage2D(a.TEXTURE_2D,0,this.format,r,s,0,this.format,a.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D)}bind(e,t){const{context:i}=this,{gl:n}=i;n.bindTexture(n.TEXTURE_2D,this.texture),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap?e===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class mm{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class fm{constructor(){this.tasks={},this.taskQueue=[],B(["process"],this),this.invoker=new mm(this.process),this.nextId=0}add(e,t){const i=this.nextId++,n=function({type:e,isSymbolTile:t,zoom:i}){return i=i||0,"message"===e?0:"maybePrepare"!==e||t?"parseTile"!==e||t?"parseTile"===e&&t?300-i:"maybePrepare"===e&&t?400-i:500:200-i:100-i}(t);if(0===n){Z();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[i]={fn:e,metadata:t,priority:n,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){Z();try{if(this.taskQueue=this.taskQueue.filter(e=>!!this.tasks[e]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let n=0;n<this.taskQueue.length;n++){const i=this.tasks[this.taskQueue[n]];i.priority<t&&(t=i.priority,e=n)}if(null===e)return null;const i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}remove(){this.invoker.remove()}}class gm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const _m=["tile","layer","source","sourceLayer","state"];class ym{constructor(e,t,i,n,r){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=i,this._y=n,this.properties=e.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const t of _m)void 0!==this[t]&&(e[t]=this[t]);return e}}const vm=new Uint16Array(8184);for(let uf=0;uf<2046;uf++){let e=uf+2,t=0,i=0,n=0,r=0,s=0,o=0;for(1&e?n=r=s=32:t=i=o=32;(e>>=1)>1;){const a=t+n>>1,l=i+r>>1;1&e?(n=t,r=i,t=s,i=o):(t=n,i=r,n=s,r=o),s=a,o=l}const a=4*uf;vm[a+0]=t,vm[a+1]=i,vm[a+2]=n,vm[a+3]=r}const xm=new Uint16Array(2178),bm=new Uint8Array(1089),wm=new Uint16Array(1089);function Cm(e){return 0===e?-.03125:32===e?.03125:0}var Sm=Ys([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Em={type:2,extent:va,loadGeometry:()=>[[new y(0,0),new y(8193,0),new y(8193,8193),new y(0,8193),new y(0,0)]]};class Tm{constructor(e,t,i,n,r){this.tileID=e,this.uid=N(),this.uses=0,this.tileSize=t,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=r,this.expiredRequestCount=0,this.state="loading",n&&n.transform&&(this.projection=n.transform.projection)}registerFadeDuration(e){const t=e+this.timeAdded;t<$e.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Tp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,t,i){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const i={};if(!t)return i;for(const n of e){const e=n.layerIds.map(e=>t.getLayer(e)).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(t=>e.filter(e=>e.id===t)[0]));for(const t of e)i[t.id]=n}}return i}(e.buckets,t.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const t=this.buckets[e];if(t instanceof im){if(this.hasSymbolBuckets=!0,!i)break;t.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const t=this.buckets[e];if(t instanceof im&&t.hasRTLText){this.hasRTLText=!0,Os.isLoading()||Os.isLoaded()||"deferred"!==Is()||Rs();break}}this.queryPadding=0;for(const e in this.buckets){const i=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(e).queryRadius(i))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new To}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const i in this.buckets){const t=this.buckets[i];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pm(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pm(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new pm(e,this.lineAtlas.image,t.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,i,n,r,s,o,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:o,transform:s,params:r,tileTransform:this.tileTransform},e,t,i):{}}querySourceFeatures(e,t){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const n=i.loadVTLayers(),r=t?t.sourceLayer:"",s=n._geojsonTileLayer||n[r];if(!s)return;const o=ir(t&&t.filter),{z:a,x:l,y:c}=this.tileID.canonical,h={z:a,x:l,y:c};for(let u=0;u<s.length;u++){const t=s.feature(u);if(o.needGeometry){const e=mc(t,!0);if(!o.filter(new Ns(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!o.filter(new Ns(this.tileID.overscaledZ),t))continue;const n=i.getId(t,r),d=new ym(t,a,l,c,n);d.tile=h,e.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const t=this.expirationTime;if(e.cacheControl){const t=$(e.cacheControl);t["max-age"]&&(this.expirationTime=Date.now()+1e3*t["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let i=!1;if(this.expirationTime>e)i=!1;else if(t)if(this.expirationTime<t)i=!0;else{const n=this.expirationTime-t;n?this.expirationTime=e+Math.max(n,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!t)return;const i=this.latestFeatureIndex.loadVTLayers(),n=t.style.listImages();for(const r in this.buckets){if(!t.style.hasLayer(r))continue;const s=this.buckets[r],o=s.layers[0].sourceLayer||"_geojsonTileLayer",a=i[o],l=e[o];if(!a||!l||0===Object.keys(l).length)continue;if(s.update(l,a,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),s instanceof Ru||s instanceof Oh){const e=t.style._getSourceCache(s.layers[0].source);t._terrain&&t._terrain.enabled&&e&&s.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(e.id,this.tileID)}const c=t&&t.style&&t.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(s)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<$e.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=$e.now()+e}setTexture(e,t){const i=t.context,n=i.gl;this.texture=this.texture||t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new pm(i,e,n.RGBA,{useMipmap:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE))}setDependencies(e,t){const i={};for(const n of t)i[n]=!0;this.dependencies[e]=i}hasDependency(e,t){for(const i of e){const e=this.dependencies[i];if(e)for(const i of t)if(e[i])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,t){if(!t||"mercator"===t.name||this._tileDebugBuffer)return;const i=pc(Em,this.tileID.canonical,this.tileTransform)[0],n=new Qs,r=new Co;for(let s=0;s<i.length;s++){const{x:e,y:t}=i[s];n.emplaceBack(e,t),r.emplaceBack(s)}r.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(n,dl.members),this._tileDebugSegments=ya.simpleSegment(0,0,n.length,r.length)}_makeTileBoundsBuffers(e,t){if(this._tileBoundsBuffer||!t||"mercator"===t.name)return;const i=pc(Em,this.tileID.canonical,this.tileTransform)[0];let n,r;if(this.isRaster){const e=function(e,t){const i=Tp(e,t),n=Math.pow(2,e.z);for(let c=0;c<33;c++)for(let r=0;r<33;r++){const s=ec((e.x+(r+Cm(r))/32)/n),o=tc((e.y+(c+Cm(c))/32)/n),a=t.project(s,o),l=33*c+r;xm[2*l+0]=Math.round((a.x*i.scale-i.x)*va),xm[2*l+1]=Math.round((a.y*i.scale-i.y)*va)}bm.fill(0),wm.fill(0);for(let c=2045;c>=0;c--){const e=4*c,t=vm[e+0],i=vm[e+1],n=vm[e+2],r=vm[e+3],s=t+n>>1,o=i+r>>1,a=s+o-i,l=o+t-s,h=33*i+t,u=33*r+n,d=33*o+s,p=Math.hypot((xm[2*h+0]+xm[2*u+0])/2-xm[2*d+0],(xm[2*h+1]+xm[2*u+1])/2-xm[2*d+1])>=16;bm[d]=bm[d]||(p?1:0),c<1022&&(bm[d]=bm[d]||bm[33*(i+l>>1)+(t+a>>1)]||bm[33*(r+l>>1)+(n+a>>1)])}const r=new to,s=new go;let o=0;function a(e,t){const i=33*t+e;return 0===wm[i]&&(r.emplaceBack(xm[2*i+0],xm[2*i+1],e*va/32,t*va/32),wm[i]=++o),wm[i]-1}function l(e,t,i,n,r,o){const c=e+i>>1,h=t+n>>1;if(Math.abs(e-r)+Math.abs(t-o)>1&&bm[33*h+c])l(r,o,e,t,c,h),l(i,n,r,o,c,h);else{const l=a(e,t),c=a(i,n),h=a(r,o);s.emplaceBack(l,c,h)}}return l(0,0,32,32,32,0),l(32,32,0,0,0,32),{vertices:r,indices:s}}(this.tileID.canonical,t);n=e.vertices,r=e.indices}else{n=new to,r=new go;for(const{x:t,y:r}of i)n.emplaceBack(t,r,0,0);const e=Eh(n.int16,void 0,4);for(let t=0;t<e.length;t+=3)r.emplaceBack(e[t],e[t+1],e[t+2])}this._tileBoundsBuffer=e.createVertexBuffer(n,Sm.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(r),this._tileBoundsSegments=ya.simpleSegment(0,0,n.length,r.length)}_makeGlobeTileDebugBuffers(e,t){const i=t.projection;if(!i||"globe"!==i.name||t.freezeTileCoverage)return;const n=this.tileID.canonical,r=Ll(Ml(n,t)),s=jl(t.zoom);let o;s>0&&(o=Ta(new Float64Array(16),t.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,n,t,r,o,s),this._makeGlobeTileDebugTextBuffer(e,n,t,r,o,s)}_globePoint(e,t,i,n,r,s,o){let a=Nl(e,t,i);if(s){const r=1<<i.z,l=Yl(n.center.lng),c=Jl(n.center.lat),h=(i.x+.5)/r-l;let u=0;h>.5?u=-1:h<-.5&&(u=1);let d=(e/va+i.x)/r+u,p=(t/va+i.y)/r;d=(d-l)*n._pixelsPerMercatorPixel+l,p=(p-c)*n._pixelsPerMercatorPixel+c;const m=[d*n.worldSize,p*n.worldSize,0];Xa(m,m,s),a=Pl(a,m,o)}return Xa(a,a,r)}_makeGlobeTileDebugBorderBuffer(e,t,i,n,r,s){const o=new Qs,a=new Co,l=new eo,c=(e,c,h,u,d)=>{const p=(h-e)/(d-1),m=(u-c)/(d-1),f=o.length;for(let g=0;g<d;g++){const h=e+g*p,u=c+g*m;o.emplaceBack(h,u);const d=this._globePoint(h,u,t,i,n,r,s);l.emplaceBack(d[0],d[1],d[2]),a.emplaceBack(f+g)}},h=va;c(0,0,h,0,16),c(h,0,h,h,16),c(h,h,0,h,16),c(0,h,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(a),this._tileDebugBuffer=e.createVertexBuffer(o,dl.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(l,ul.members),this._tileDebugSegments=ya.simpleSegment(0,0,o.length,a.length)}_makeGlobeTileDebugTextBuffer(e,t,i,n,r,s){const o=new Qs,a=new go,l=new eo,c=25;a.reserve(32),o.reserve(c),l.reserve(c);const h=(e,t)=>c*e+t;for(let u=0;u<c;u++){const e=2048*u;for(let a=0;a<c;a++){const c=2048*a;o.emplaceBack(c,e);const h=this._globePoint(c,e,t,i,n,r,s);l.emplaceBack(h[0],h[1],h[2])}}for(let u=0;u<4;u++)for(let e=0;e<4;e++){const t=h(u,e),i=h(u,e+1),n=h(u+1,e),r=h(u+1,e+1);a.emplaceBack(t,i,n),a.emplaceBack(n,i,r)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(a),this._tileDebugTextBuffer=e.createVertexBuffer(o,dl.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(l,ul.members),this._tileDebugTextSegments=ya.simpleSegment(0,0,c,32)}}class Pm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,i){const n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},R(this.stateChanges[e][n],i),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==n&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][n]){this.deletedStates[e][n]={};for(const t in this.state[e][n])i[t]||(this.deletedStates[e][n][t]=null)}else for(const r in i)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][r]&&delete this.deletedStates[e][n][r]}removeFeatureState(e,t,i){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(i in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][i]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,t){const i=String(t),n=R({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const i=this.deletedStates[e][t];if(null===i)return{};for(const e in i)delete n[e]}return n}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){const i={};for(const n in this.stateChanges){this.state[n]=this.state[n]||{};const e={};for(const t in this.stateChanges[n])this.state[n][t]||(this.state[n][t]={}),R(this.state[n][t],this.stateChanges[n][t]),e[t]=this.state[n][t];i[n]=e}for(const n in this.deletedStates){this.state[n]=this.state[n]||{};const e={};if(null===this.deletedStates[n])for(const t in this.state[n])e[t]={},this.state[n][t]={};else for(const t in this.deletedStates[n]){if(null===this.deletedStates[n][t])this.state[n][t]={};else if(this.state[n][t])for(const e of Object.keys(this.deletedStates[n][t]))delete this.state[n][t][e];e[t]=this.state[n][t]}i[n]=i[n]||{},R(i[n],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const n in e)e[n].setFeatureState(i,t)}}class Mm{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const i=this.toIdx(e,t);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function km(e,t,i,n){let r=0,s=Number.MAX_VALUE;for(let o=0;o<3;o++)if(Math.abs(n[o])<1e-15){if(i[o]<e[o]||i[o]>t[o])return null}else{const a=1/n[o];let l=(e[o]-i[o])*a,c=(t[o]-i[o])*a;if(l>c){const e=l;l=c,c=e}if(l>r&&(r=l),c<s&&(s=c),r>s)return null}return r}function Am(e,t,i,n,r,s,o,a,l,c,h){const u=n-e,d=r-t,p=s-i,m=o-e,f=a-t,g=l-i,_=h[1]*g-h[2]*f,y=h[2]*m-h[0]*g,v=h[0]*f-h[1]*m,x=u*_+d*y+p*v;if(Math.abs(x)<1e-15)return null;const b=1/x,w=c[0]-e,C=c[1]-t,S=c[2]-i,E=(w*_+C*y+S*v)*b;if(E<0||E>1)return null;const T=C*p-S*d,P=S*u-w*p,M=w*d-C*u,k=(h[0]*T+h[1]*P+h[2]*M)*b;return k<0||E+k>1?null:(m*T+f*P+g*M)*b}function Im(e,t,i){return(e-t)/(i-t)}function Rm(e,t,i,n,r,s,o,a,l){const c=1<<i,h=s-n,u=o-r,d=(e+1)/c*h+n,p=(t+0)/c*u+r,m=(t+1)/c*u+r;a[0]=(e+0)/c*h+n,a[1]=p,l[0]=d,l[1]=m}class Om{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),i=[];let n=Math.ceil(Math.pow(2,t));const r=1/n,s=(e,t,i,n,r)=>{const s=n?1:0,o=(e+1)*i-s,a=t*i,l=(t+1)*i-s;r[0]=e*i,r[1]=a,r[2]=o,r[3]=l};let o=new Mm(n);const a=[];for(let l=0;l<n*n;l++){s(l%n,Math.floor(l/n),r,!1,a);const t=Dm(a[0],a[1],e),i=Dm(a[2],a[1],e),c=Dm(a[2],a[3],e),h=Dm(a[0],a[3],e);o.minimums.push(Math.min(t,i,c,h)),o.maximums.push(Math.max(t,i,c,h)),o.leaves.push(1)}for(i.push(o),n/=2;n>=1;n/=2){const e=i[i.length-1];o=new Mm(n);for(let t=0;t<n*n;t++){s(t%n,Math.floor(t/n),2,!0,a);const i=e.getElevation(a[0],a[1]),r=e.getElevation(a[2],a[1]),l=e.getElevation(a[2],a[3]),c=e.getElevation(a[0],a[3]),h=e.isLeaf(a[0],a[1]),u=e.isLeaf(a[2],a[1]),d=e.isLeaf(a[2],a[3]),p=e.isLeaf(a[0],a[3]),m=Math.min(i.min,r.min,l.min,c.min),f=Math.max(i.max,r.max,l.max,c.max),g=h&&u&&d&&p;o.maximums.push(f),o.minimums.push(m),o.leaves.push(f-m<=5&&g?1:0)}i.push(o)}return i}(this.dem),i=t.length-1,n=t[i];this._addNode(n.minimums[0],n.maximums[0],n.leaves[0]),this._construct(t,0,0,i,0)}raycastRoot(e,t,i,n,r,s,o=1){return km([e,t,-100],[i,n,this.maximums[0]*o],r,s)}raycast(e,t,i,n,r,s,o=1){if(!this.nodeCount)return null;const a=this.raycastRoot(e,t,i,n,r,s,o);if(null==a)return null;const l=[],c=[],h=[],u=[],d=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:a,t:p,nodex:m,nodey:f,depth:g}=d.pop();if(this.leaves[a]){Rm(m,f,g,e,t,i,n,h,u);const a=1<<g,l=(m+0)/a,c=(m+1)/a,d=(f+0)/a,_=(f+1)/a,y=Dm(l,d,this.dem)*o,v=Dm(c,d,this.dem)*o,x=Dm(c,_,this.dem)*o,b=Dm(l,_,this.dem)*o,w=Am(h[0],h[1],y,u[0],h[1],v,u[0],u[1],x,r,s),C=Am(u[0],u[1],x,h[0],u[1],b,h[0],h[1],y,r,s),S=Math.min(null!==w?w:Number.MAX_VALUE,null!==C?C:Number.MAX_VALUE);if(S!==Number.MAX_VALUE)return S;{const e=Ga([],r,s,p);if(Nm(y,v,b,x,Im(e[0],h[0],u[0]),Im(e[1],h[1],u[1]))>=e[2])return p}continue}let _=0;for(let d=0;d<this._siblingOffset.length;d++){Rm((m<<1)+this._siblingOffset[d][0],(f<<1)+this._siblingOffset[d][1],g+1,e,t,i,n,h,u),h[2]=-100,u[2]=this.maximums[this.childOffsets[a]+d]*o;const p=km(h,u,r,s);if(null!=p){const e=p;l[d]=e;let t=!1;for(let i=0;i<_&&!t;i++)e>=l[c[i]]&&(c.splice(i,0,d),t=!0);t||(c[_]=d),_++}}for(let e=0;e<_;e++){const t=c[e];d.push({idx:this.childOffsets[a]+t,t:l[t],nodex:(m<<1)+this._siblingOffset[t][0],nodey:(f<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,i){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,i,n,r){if(1===e[n].isLeaf(t,i))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const s=n-1,o=e[s];let a=0,l=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],n=2*i+this._siblingOffset[c][1],r=o.getElevation(e,n),s=o.isLeaf(e,n),h=this._addNode(r.min,r.max,s);s&&(a|=1<<c),l||(l=h)}for(let c=0;c<this._siblingOffset.length;c++)a&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*i+this._siblingOffset[c][1],s,l+c)}}function Nm(e,t,i,n,r,s){return Ai(Ai(e,i,s),Ai(t,n,s),r)}function Dm(e,t,i){const n=i.dim,r=P(e*n-.5,0,n-1),s=P(t*n-.5,0,n-1),o=Math.floor(r),a=Math.floor(s),l=Math.min(o+1,n-1),c=Math.min(a+1,n-1);return Nm(i.get(o,a),i.get(l,a),i.get(o,c),i.get(l,c),r-o,s-a)}const zm={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Lm(e,t,i){return(256*e*256+256*t+i)/10-1e4}function Bm(e,t,i){return 256*e+t+i/256-32768}class Fm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,i,n=!1,r=!1){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return H(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=t.height;const s=this.dim=t.height-2,o=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.encoding=i||"mapbox",this.borderReady=n,!n){for(let e=0;e<s;e++)o[this._idx(-1,e)]=o[this._idx(0,e)],o[this._idx(s,e)]=o[this._idx(s-1,e)],o[this._idx(e,-1)]=o[this._idx(e,0)],o[this._idx(e,s)]=o[this._idx(e,s-1)];o[this._idx(-1,-1)]=o[this._idx(0,0)],o[this._idx(s,-1)]=o[this._idx(s-1,0)],o[this._idx(-1,s)]=o[this._idx(0,s-1)],o[this._idx(s,s)]=o[this._idx(s-1,s-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Om(this)}get(e,t,i=!1){i&&(e=P(e,-1,this.dim),t=P(t,-1,this.dim));const n=4*this._idx(e,t);return("terrarium"===this.encoding?Bm:Lm)(this.pixels[n],this.pixels[n+1],this.pixels[n+2])}static getUnpackVector(e){return zm[e]}get unpackVector(){return zm[this.encoding]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}static pack(e,t){const i=[0,0,0,0],n=Fm.getUnpackVector(t);let r=Math.floor((e+n[3])/n[2]);return i[2]=r%256,r=Math.floor(r/256),i[1]=r%256,r=Math.floor(r/256),i[0]=r,i}getPixels(){return new Wc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,r=t*this.dim+this.dim,s=i*this.dim,o=i*this.dim+this.dim;switch(t){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:s=o-1;break;case 1:o=s+1}const a=-t*this.dim,l=-i*this.dim;for(let c=s;c<o;c++)for(let t=n;t<r;t++){const i=4*this._idx(t,c),n=4*this._idx(t+a,c+l);this.pixels[i+0]=e.pixels[n+0],this.pixels[i+1]=e.pixels[n+1],this.pixels[i+2]=e.pixels[n+2],this.pixels[i+3]=e.pixels[n+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}zr(Fm,"DEMData"),zr(Om,"DemMinMaxQuadTree",{omit:["dem"]});class jm{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,i){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const r={value:t,timeout:void 0};if(void 0!==i&&(r.timeout=setTimeout(()=>{this.remove(e,r)},i)),this.data[n].push(r),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const i=e.wrapped().key,n=void 0===t?0:this.data[i].indexOf(t),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const i in this.data)for(const n of this.data[i])e(n.value)||t.push(n);for(const i of t)this.remove(i.value.tileID,i)}}class Vm{constructor(e,t,i){this.func=e,this.mask=t,this.range=i}}Vm.ReadOnly=!1,Vm.ReadWrite=!0,Vm.disabled=new Vm(519,Vm.ReadOnly,[0,1]);class Um{constructor(e,t,i,n,r,s){this.test=e,this.ref=t,this.mask=i,this.fail=n,this.depthFail=r,this.pass=s}}Um.disabled=new Um({func:519,mask:0},0,0,7680,7680,7680);class qm{constructor(e,t,i){this.blendFunction=e,this.blendColor=t,this.mask=i}}qm.Replace=[1,0],qm.disabled=new qm(qm.Replace,It.transparent,[!1,!1,!1,!1]),qm.unblended=new qm(qm.Replace,It.transparent,[!0,!0,!0,!0]),qm.alphaBlended=new qm([1,771],It.transparent,[!0,!0,!0,!0]);class Hm{constructor(e,t,i){this.enable=e,this.mode=t,this.frontFace=i}}Hm.disabled=new Hm(!1,1029,2305),Hm.backCCW=new Hm(!0,1029,2305),Hm.backCW=new Hm(!0,1029,2304),Hm.frontCW=new Hm(!0,1028,2304),Hm.frontCCW=new Hm(!0,1028,2305);class Gm extends Qe{constructor(e,t,i){super(),this.id=e,this._onlySymbols=i,t.on("data",e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),t.on("error",()=>{this._sourceErrored=!0}),this._source=t,this._tiles={},this._cache=new jm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Pm,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const i=this._tiles[t];i.upload(e),i.prepare(this.map.style.imageManager)}}getIds(){return I(this._tiles).map(e=>e.tileID).sort(Wm).map(e=>e.key)}getRenderableIds(e){const t=[];for(const i in this._tiles)this._isIdRenderable(+i,e)&&t.push(this._tiles[i]);return e?t.sort((e,t)=>{const i=e.tileID,n=t.tileID,r=new y(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),s=new y(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-n.overscaledZ||s.y-r.y||s.x-r.x}).map(e=>e.tileID.key):t.map(e=>e.tileID).sort(Wm).map(e=>e.key)}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))}_tileLoaded(e,t,i,n){if(n)if(e.state="errored",404!==n.status)this._source.fire(new Je(n,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=$e.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ye("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const r=t[n];if(e.neighboringTiles&&e.neighboringTiles[r]){const t=this.getTileByID(r);i(e,t),i(t,e)}}function i(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let i=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),s=t.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,n),e.neighboringTiles&&e.neighboringTiles[s]&&(e.neighboringTiles[s].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,i,n){for(const r in this._tiles){let s=this._tiles[r];if(n[r]||!s.hasData()||s.tileID.overscaledZ<=t||s.tileID.overscaledZ>i)continue;let o=s.tileID;for(;s&&s.tileID.overscaledZ>t+1;){const e=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[e.key],s&&s.hasData()&&(o=e)}let a=o;for(;a.overscaledZ>t;)if(a=a.scaledTo(a.overscaledZ-1),e[a.key]){n[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=t?i:null}for(let i=e.overscaledZ-1;i>=t;i--){const t=e.scaledTo(i),n=this._getLoadedTile(t);if(n)return n}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const i=Math.ceil(e.width/t)+1,n=Math.ceil(e.height/t)+1,r=Math.floor(i*n*5),s="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,s):s;this._cache.setMaxSize(o)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const i in this._tiles){const n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(e,t,i){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!i)return;let n;this.updateCacheSize(e,t),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(e=>new xu(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)):(n=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(n=n.filter(e=>this._source.hasTile(e)))):n=[];const r=this._updateRetainedTiles(n);if(Zm(this._source.type)&&0!==n.length){const e={},t={},i=Object.keys(r);for(const n of i){const i=r[n],s=this._tiles[n];if(!s||s.fadeEndTime&&s.fadeEndTime<=$e.now())continue;const o=this.findLoadedParent(i,Math.max(i.overscaledZ-Gm.maxOverzooming,this._source.minzoom));o&&(this._addTile(o.tileID),e[o.tileID.key]=o.tileID),t[n]=i}const s=n[n.length-1].overscaledZ;for(const n in this._tiles){const e=this._tiles[n];if(r[n]||!e.hasData())continue;let i=e.tileID;for(;i.overscaledZ>s;){i=i.scaledTo(i.overscaledZ-1);const s=this._tiles[i.key];if(s&&s.hasData()&&t[i.key]){r[n]=e.tileID;break}}}for(const n in e)r[n]||(this._coveredTiles[n]=!0,r[n]=e[n])}for(const o in r)this._tiles[o].clearFadeHold();const s=function(e,t){const i=[];for(const n in e)n in t||i.push(n);return i}(this._tiles,r);for(const o of s){const e=this._tiles[o];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+o)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const i={},n=e.reduce((e,t)=>Math.min(e,t.overscaledZ),1/0),r=e[0].overscaledZ,s=Math.max(r-Gm.maxOverzooming,this._source.minzoom),o=Math.max(r+Gm.maxUnderzooming,this._source.minzoom),a={};for(const l of e){const e=this._addTile(l);t[l.key]=l,e.hasData()||n<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,n,o,t);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],i=this.getTile(e);if(i&&i.hasData()){t[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let n=e.wasRequested();for(let r=l.overscaledZ-1;r>=s;--r){const s=l.scaledTo(r);if(i[s.key])break;if(i[s.key]=!0,e=this.getTile(s),!e&&n&&(e=this._addTile(s)),e&&(t[s.key]=s,n=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let i,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(e),i)break;n=e}for(const e of t)this._loadedParentTiles[e]=i}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));const i=Boolean(t);if(!i){const i=this.map?this.map.painter:null;t=new Tm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,i,this._isRaster),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,i||this._source.fire(new Ye("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,t,i){const n=[],r=this.transform;if(!r)return n;const s="globe"===r.projection.name,o=Yl(r.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(i&&l.clearQueryDebugViz(),l.holdingForFade())continue;let c;if(s){const e=l.tileID.canonical;if(0===e.z){const t=[Math.abs(P(o,...$m(e,-1))-o),Math.abs(P(o,...$m(e,1))-o)];c=[0,2*t.indexOf(Math.min(...t))-1]}else{const t=[Math.abs(P(o,...$m(e,-1))-o),Math.abs(P(o,...$m(e,0))-o),Math.abs(P(o,...$m(e,1))-o)];c=[t.indexOf(Math.min(...t))-1]}}else c=[0];for(const i of c){const s=e.containsTile(l,r,t,i);s&&n.push(s)}}return n}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map(e=>this._tiles[e].tileID);for(const i of t)i.projMatrix=this.transform.calculateProjMatrix(i.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(Zm(this._source.type))for(const e in this._tiles){const t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=$e.now())return!0}return!1}setFeatureState(e,t,i){this._state.updateState(e=e||"_geojsonTileLayer",t,i)}removeFeatureState(e,t,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,i)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,i){const n=this._tiles[e];n&&n.setDependencies(t,i)}reloadTilesForDependencies(e,t){for(const i in this._tiles)this._tiles[i].hasDependency(e,t)&&this._reloadTile(+i,"reloading");this._cache.filter(i=>!i.hasDependency(e,t))}_preloadTiles(e,t){if(!this._sourceLoaded){const i=()=>{this._sourceLoaded&&(this._source.off("data",i),this._preloadTiles(e,t))};return void this._source.on("data",i)}const i=new Map,n=Array.isArray(e)?e:[e],r=this.map.painter.terrain,s=this.usedForTerrain&&r?r.getScaledDemTileSize():this._source.tileSize;for(const o of n){const e=o.coveringTiles({tileSize:s,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)i.set(t.key,t);this.usedForTerrain&&o.updateElevation(!1)}A(Array.from(i.values()),(e,t)=>{const i=new Tm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(i,e=>{"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),t(e,i)})},t)}}function Wm(e,t){const i=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-i||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Zm(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function $m(e,t){const i=1<<e.z;return[e.x/i+t,(e.x+1)/i+t]}Gm.maxOverzooming=10,Gm.maxUnderzooming=3;class Xm{constructor(e,t,i){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=i}static create(e,t,i){const n=i||e.findDEMTileFor(t);if(!n||!n.dem)return;const r=n.dem,s=n.tileID,o=1<<t.canonical.z-s.canonical.z;return new Xm(n,n.tileSize/va/o,[(t.canonical.x/o-s.canonical.x)*r.dim,(t.canonical.y/o-s.canonical.y)*r.dim])}tileCoordToPixel(e,t){const i=t*this._scale+this._offset[1],n=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(i);return new y(n,r)}getElevationAt(e,t,i,n){const r=e*this._scale+this._offset[0],s=t*this._scale+this._offset[1],o=Math.floor(r),a=Math.floor(s),l=this._dem;return n=!!n,i?Ai(Ai(l.get(o,a,n),l.get(o,a+1,n),s-a),Ai(l.get(o+1,a,n),l.get(o+1,a+1,n),s-a),r-o):l.get(o,a,n)}getElevationAtPixel(e,t,i){return this._dem.get(e,t,!!i)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ql(1,e)*this._dem.stride}}class Km{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Nr(va,16,0),this.featureIndexArray=new No,this.promoteId=t}insert(e,t,i,n,r,s=0){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r,s);const a=this.grid;for(let l=0;l<t.length;l++){const e=t[l],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const n=e[t];i[0]=Math.min(i[0],n.x),i[1]=Math.min(i[1],n.y),i[2]=Math.max(i[2],n.x),i[3]=Math.max(i[3],n.y)}i[0]<va&&i[1]<va&&i[2]>=0&&i[3]>=0&&a.insert(o,i[0],i[1],i[2],i[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Jh(new bd(this.rawTileData)).layers,this.sourceLayerCoder=new gm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,i,n){this.loadVTLayers();const r=e.params||{},s=ir(r.filter),o=e.tileResult,a=e.transform,l=o.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,(e,t,i,n)=>Mc(o.bufferedTilespaceGeometry,e,t,i,n));c.sort(Jm);let h=null;a.elevation&&c.length>0&&(h=Xm.create(a.elevation,this.tileID));const u={};let d;for(let p=0;p<c.length;p++){const a=c[p];if(a===d)continue;d=a;const l=this.featureIndexArray.get(a);let m=null;this.loadMatchingFeature(u,l,s,r.layers,r.availableImages,t,i,n,(t,i,n,r=0)=>(m||(m=pc(t,this.tileID.canonical,e.tileTransform)),i.queryIntersectsFeature(o,t,n,m,this.z,e.transform,e.pixelPosMatrix,h,r)))}return u}loadMatchingFeature(e,t,i,n,r,s,o,a,l){const{featureIndex:c,bucketIndex:h,sourceLayerIndex:u,layoutVertexArrayOffset:d}=t,p=this.bucketLayerIDs[h];if(n&&!function(e,t){for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!0;return!1}(n,p))return;const m=this.sourceLayerCoder.decode(u),f=this.vtLayers[m].feature(c);if(i.needGeometry){const e=mc(f,!0);if(!i.filter(new Ns(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new Ns(this.tileID.overscaledZ),f))return;const g=this.getId(f,m);for(let _=0;_<p.length;_++){const t=p[_];if(n&&n.indexOf(t)<0)continue;const i=s[t];if(!i)continue;let h={};void 0!==g&&a&&(h=a.getState(i.sourceLayer||"_geojsonTileLayer",g));const u=R({},o[t]);u.paint=Ym(u.paint,i.paint,f,h,r),u.layout=Ym(u.layout,i.layout,f,h,r);const m=!l||l(f,i,h,d);if(!m)continue;const y=new ym(f,this.z,this.x,this.y,g);y.layer=u;let v=e[t];void 0===v&&(v=e[t]=[]),v.push({featureIndex:c,feature:y,intersectionZ:m})}}lookupSymbolFeatures(e,t,i,n,r,s,o,a){const l={};this.loadVTLayers();const c=ir(r);for(const h of e)this.loadMatchingFeature(l,{bucketIndex:i,sourceLayerIndex:n,featureIndex:h,layoutVertexArrayOffset:0},c,s,o,a,t);return l}loadFeature(e){const{featureIndex:t,sourceLayerIndex:i}=e;this.loadVTLayers();const n=this.sourceLayerCoder.decode(i),r=this.vtFeatures[n];if(r[t])return r[t];const s=this.vtLayers[n].feature(t);return r[t]=s,s}hasLayer(e){for(const t of this.bucketLayerIDs)for(const i of t)if(e===i)return!0;return!1}getId(e,t){let i=e.id;if(this.promoteId){const n="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=n&&(i=e.properties[n]),"boolean"==typeof i&&(i=Number(i))}return i}}function Ym(e,t,i,n,r){return j(e,(e,s)=>{const o=t instanceof Us?t.get(s):null;return o&&o.evaluate?o.evaluate(i,n,r):o})}function Jm(e,t){return t-e}zr(Km,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Qm{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new Gc({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const i=this.getKey(e,t);return this.positions[i]}trim(){const e=this.width,t=this.height=z(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,i){const n=[];let r=e.length%2==1?-e[e.length-1]*i:0,s=e[0]*i,o=!0;n.push({left:r,right:s,isDash:o,zeroLength:0===e[0]});let a=e[0];for(let l=1;l<e.length;l++){o=!o;const t=e[l];r=a*i,a+=t,s=a*i,n.push({left:r,right:s,isDash:o,zeroLength:0===t})}return n}addRoundDash(e,t,i){const n=t/2;for(let r=-i;r<=i;r++){const t=this.width*(this.nextRow+i+r);let s=0,o=e[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=e[++s]);const l=Math.abs(a-o.left),c=Math.abs(a-o.right),h=Math.min(l,c);let u;const d=r/i*(n+1);if(o.isDash){const e=n-Math.abs(d);u=Math.sqrt(h*h+e*e)}else u=n-Math.sqrt(h*h+d*d);this.image.data[t+a]=Math.max(0,Math.min(255,u+128))}}}addRegularDash(e,t){for(let a=e.length-1;a>=0;--a){const t=e[a],i=e[a+1];t.zeroLength?e.splice(a,1):i&&i.isDash===t.isDash&&(i.left=t.left,e.splice(a,1))}const i=e[0],n=e[e.length-1];i.isDash===n.isDash&&(i.left=n.left-this.width,n.right=i.right+this.width);const r=this.width*this.nextRow;let s=0,o=e[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=e[++s]);const i=Math.abs(a-o.left),n=Math.abs(a-o.right),l=Math.min(i,n);this.image.data[r+a]=Math.max(0,Math.min(255,(o.isDash?l:-l)+t+128))}}addDash(e,t){const i=this.getKey(e,t);if(this.positions[i])return this.positions[i];const n="round"===t,r=n?7:0,s=2*r+1;if(this.nextRow+s>this.height)return H("LineAtlas out of space"),null;0===e.length&&e.push(1);let o=0;for(let c=0;c<e.length;c++)e[c]<0&&(H("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),o+=e[c];if(0!==o){const i=this.width/o,s=this.getDashRanges(e,this.width,i);n?this.addRoundDash(s,i,r):this.addRegularDash(s,"square"===t?.5*i:0)}const a=this.nextRow+r;this.nextRow+=s;const l={tl:[a,r],br:[o,0]};return this.positions[i]=l,l}}zr(Qm,"LineAtlas");class ef{constructor(e){const t={},i=[];for(const o in e){const n=e[o],r=t[o]={};for(const e in n.glyphs){const t=n.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const s=t.metrics.localGlyph?2:1,o={x:0,y:0,w:t.bitmap.width+2*s,h:t.bitmap.height+2*s};i.push(o),r[e]=o}}const{w:n,h:r}=Ed(i),s=new Gc({width:n||1,height:r||1});for(const o in e){const i=e[o];for(const e in i.glyphs){const n=i.glyphs[+e];if(!n||0===n.bitmap.width||0===n.bitmap.height)continue;const r=t[o][e],a=n.metrics.localGlyph?2:1;Gc.copy(n.bitmap,s,{x:0,y:0},{x:r.x+a,y:r.y+a},n.bitmap)}}this.image=s,this.positions=t}}zr(ef,"GlyphAtlas");class tf{constructor(e){this.tileID=new xu(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Tp(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,t,i,n,r){this.status="parsing",this.data=e,this.collisionBoxArray=new To;const s=new gm(Object.keys(e.layers).sort()),o=new Km(this.tileID,this.promoteId);o.bucketLayerIDs=[];const a={},l=new Qm(256,256),c={featureIndex:o,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:i},h=t.familiesBySource[this.source];for(const x in h){const t=e.layers[x];if(!t)continue;let n=!1,r=!1;for(const e of h[x])"symbol"===e[0].type?n=!0:r=!0;if(!0===this.isSymbolTile&&!n)continue;if(!1===this.isSymbolTile&&!r)continue;1===t.version&&H(`Vector tile source "${this.source}" layer "${x}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const l=s.encode(x),u=[];for(let e=0;e<t.length;e++){const i=t.feature(e),n=o.getId(i,x);u.push({feature:i,id:n,index:e,sourceLayerIndex:l})}for(const e of h[x]){const t=e[0];void 0!==this.isSymbolTile&&"symbol"===t.type!==this.isSymbolTile||t.minzoom&&this.zoom<Math.floor(t.minzoom)||t.maxzoom&&this.zoom>=t.maxzoom||"none"!==t.visibility&&(nf(e,this.zoom,i),(a[t.id]=t.createBucket({index:o.bucketLayerIDs.length,layers:e,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:i})).populate(u,c,this.tileID.canonical,this.tileTransform),o.bucketLayerIDs.push(e.map(e=>e.id)))}}let u,d,p,m;l.trim();const f={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=()=>{if(u)return r(u);if(d&&p&&m){const e=new ef(d),t=new Pd(p,m);for(const n in a){const r=a[n];r instanceof im?(nf(r.layers,this.zoom,i),fp(r,d,e.positions,p,t.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection)):r.hasPattern&&(r instanceof Ru||r instanceof Oh||r instanceof ou)&&(nf(r.layers,this.zoom,i),r.addFeatures(c,this.tileID.canonical,t.patternPositions,i,this.tileTransform))}this.status="done",r(null,{buckets:I(a).filter(e=>!e.isEmpty()),featureIndex:o,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:l,imageAtlas:t,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?e.positions:null})}},_=j(c.glyphDependencies,e=>Object.keys(e).map(Number));Object.keys(_).length?n.send("getGlyphs",{uid:this.uid,stacks:_},(e,t)=>{u||(u=e,d=t,g())},void 0,!1,f):d={};const y=Object.keys(c.iconDependencies);y.length?n.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},(e,t)=>{u||(u=e,p=t,g())},void 0,!1,f):p={};const v=Object.keys(c.patternDependencies);v.length?n.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"patterns"},(e,t)=>{u||(u=e,m=t,g())},void 0,!1,f):m={},g()}}function nf(e,t,i){const n=new Ns(t);for(const r of e)r.recalculate(n,i)}class rf{constructor(e){this.entries={},this.scheduler=e}request(e,t,i,n){const r=this.entries[e]=this.entries[e]||{callbacks:[]};if(r.result){const[e,i]=r.result;return this.scheduler?this.scheduler.add(()=>{n(e,i)},t):n(e,i),()=>{}}return r.callbacks.push(n),r.cancel||(r.cancel=i((i,n)=>{r.result=[i,n];for(const e of r.callbacks)this.scheduler?this.scheduler.add(()=>{e(i,n)},t):e(i,n);setTimeout(()=>delete this.entries[e],3e3)})),()=>{r.result||(r.callbacks=r.callbacks.filter(e=>e!==n),r.callbacks.length||(r.cancel(),delete this.entries[e]))}}}function sf(e,t,i){const n=JSON.stringify(e.request);return e.data&&(this.deduped.entries[n]={result:[null,e.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},t=>{const n=de(e.request,(e,n,r,s)=>{e?t(e):n&&t(null,{vectorTile:i?void 0:new Jh(new bd(n)),rawData:n,cacheControl:r,expires:s})});return()=>{n.cancel(),t()}},t)}const of=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class af{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,i]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=i>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const r=of[15&i];if(!r)throw new Error("Unrecognized array type.");const[s]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new af(o,s,r,e)}constructor(e,t=64,i=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=of.indexOf(this.ArrayType),s=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-o%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+s+o+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=t,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return function e(t,i,n,r,s,o){if(s-r<=n)return;const a=r+s>>1;(function e(t,i,n,r,s,o){for(;s>r;){if(s-r>600){const a=s-r+1,l=n-r+1,c=Math.log(a),h=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*h*(a-h)/a)*(l-a/2<0?-1:1);e(t,i,n,Math.max(r,Math.floor(n-l*h/a+u)),Math.min(s,Math.floor(n+(a-l)*h/a+u)),o)}const a=i[2*n+o];let l=r,c=s;for(lf(t,i,r,n),i[2*s+o]>a&&lf(t,i,r,s);l<c;){for(lf(t,i,l,c),l++,c--;i[2*l+o]<a;)l++;for(;i[2*c+o]>a;)c--}i[2*r+o]===a?lf(t,i,r,c):(c++,lf(t,i,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}})(t,i,a,r,s,o),e(t,i,n,r,a-1,1-o),e(t,i,n,a+1,s,1-o)}(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:s,nodeSize:o}=this,a=[0,r.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,h=a.pop()||0,u=a.pop()||0;if(h-u<=o){for(let o=u;o<=h;o++){const a=s[2*o],c=s[2*o+1];a>=e&&a<=i&&c>=t&&c<=n&&l.push(r[o])}continue}const d=u+h>>1,p=s[2*d],m=s[2*d+1];p>=e&&p<=i&&m>=t&&m<=n&&l.push(r[d]),(0===c?e<=p:t<=m)&&(a.push(u),a.push(d-1),a.push(1-c)),(0===c?i>=p:n>=m)&&(a.push(d+1),a.push(h),a.push(1-c))}return l}within(e,t,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:r,nodeSize:s}=this,o=[0,n.length-1,0],a=[],l=i*i;for(;o.length;){const c=o.pop()||0,h=o.pop()||0,u=o.pop()||0;if(h-u<=s){for(let i=u;i<=h;i++)hf(r[2*i],r[2*i+1],e,t)<=l&&a.push(n[i]);continue}const d=u+h>>1,p=r[2*d],m=r[2*d+1];hf(p,m,e,t)<=l&&a.push(n[d]),(0===c?e-i<=p:t-i<=m)&&(o.push(u),o.push(d-1),o.push(1-c)),(0===c?e+i>=p:t+i>=m)&&(o.push(d+1),o.push(h),o.push(1-c))}return a}}function lf(e,t,i,n){cf(e,i,n),cf(t,2*i,2*n),cf(t,2*i+1,2*n+1)}function cf(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}function hf(e,t,i,n){const r=e-i,s=t-n;return r*r+s*s}e.ARRAY_TYPE=wa,e.AUTH_ERR_MSG=ye,e.Aabb=gl,e.Actor=class{constructor(e,i,n){this.target=e,this.parent=i,this.mapId=n,this.callbacks={},this.cancelCallbacks={},B(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Z()?e:t,this.scheduler=new fm}send(e,t,i,n,r=!1,s){const o=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=s,this.callbacks[o]=i);const a=K(this.globalScope)?void 0:[];return this.target.postMessage({id:o,type:e,hasCallback:!!i,targetMapId:n,mustQueue:r,sourceMapId:this.mapId,data:Fr(t,a)},a),{cancel:()=>{i&&delete this.callbacks[o],this.target.postMessage({id:o,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(e){const t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[i];delete this.cancelCallbacks[i],e&&e.cancel()}else if(t.mustQueue||Z()){const e=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),e&&e.metadata||{type:"message"})}else this.processTask(i,t)}processTask(e,t){if("<response>"===t.type){const i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(jr(t.error)):i(null,jr(t.data)))}else{const i=K(this.globalScope)?void 0:[],n=t.hasCallback?(t,n)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?Fr(t):null,data:Fr(n,i)},i)}:e=>{},r=jr(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,r,n);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],r.source)[e[1]](r,n)}else n(new Error("Could not find function "+t.type))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.CanonicalTileID=yu,e.Color=It,e.ColorMode=qm,e.CullFaceMode=Hm,e.DEMData=Fm,e.DataConstantProperty=qs,e.DedupedRequest=rf,e.DepthMode=Vm,e.EXTENT=va,e.Elevation=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const i=t.getSource().maxzoom,n=1<<i,r=Math.floor(e.x),s=Math.floor((e.x-r)*n),o=Math.floor(e.y*n),a=this.findDEMTileFor(new xu(i,r,i,s,o));return!(!a||!a.dem)}getAtPointOrZero(e,t=0){return this.getAtPoint(e,t)||0}getAtPoint(e,t,i=!0){if(this.isUsingMockSource())return null;null==t&&(t=null);const n=this._source();if(!n)return t;if(e.y<0||e.y>1)return t;const r=n.getSource().maxzoom,s=1<<r,o=Math.floor(e.x),a=e.x-o,l=new xu(r,o,r,Math.floor(a*s),Math.floor(e.y*s)),c=this.findDEMTileFor(l);if(!c||!c.dem)return t;const h=c.dem,u=1<<c.tileID.canonical.z,d=(a*u-c.tileID.canonical.x)*h.dim,p=(e.y*u-c.tileID.canonical.y)*h.dim,m=Math.floor(d),f=Math.floor(p);return(i?this.exaggeration():1)*Ai(Ai(h.get(m,f),h.get(m,f+1),p-f),Ai(h.get(m+1,f),h.get(m+1,f+1),p-f),d-m)}getAtTileOffset(e,t,i){const n=1<<e.canonical.z;return this.getAtPointOrZero(new sc(e.wrap+(e.canonical.x+t/va)/n,(e.canonical.y+i/va)/n))}getAtTileOffsetFunc(e,t,i,n){return r=>{const s=this.getAtTileOffset(e,r.x,r.y),o=n.upVector(e.canonical,r.x,r.y);return Ha(o,o,s*n.upVectorScale(e.canonical,t,i).metersToTile),o}}getForTilePoints(e,t,i,n){if(this.isUsingMockSource())return!1;const r=Xm.create(this,e,n);return!!r&&(t.forEach(e=>{e[2]=this.exaggeration()*r.getElevationAt(e[0],e[1],i)}),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const i=t.dem.tree,n=t.tileID,r=1<<e.canonical.z-n.canonical.z;let s=e.canonical.x/r-n.canonical.x,o=e.canonical.y/r-n.canonical.y,a=0;for(let l=0;l<e.canonical.z-n.canonical.z&&!i.leaves[a];l++){s*=2,o*=2;const e=2*Math.floor(o)+Math.floor(s);a=i.childOffsets[a]+e,s%=1,o%=1}return{min:this.exaggeration()*i.minimums[a],max:this.exaggeration()*i.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},e.ErrorEvent=Je,e.EvaluationParameters=Ns,e.Event=Ye,e.Evented=Qe,e.FillExtrusionBucket=ou,e.Frustum=fl,e.FrustumCorners=ml,e.GLOBE_RADIUS=_l,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=6,e.GLOBE_ZOOM_THRESHOLD_MIN=5,e.GlobeSharedBuffers=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const e of this._wireframeSegments)e.destroy()}}_fillGridMeshWithLods(e,t){const i=new Qs,n=new go,r=[],s=e+1+2,o=t[0]+1,a=t[0]+1+(1+t.length),l=(e,t,i)=>{let n=e===s-1?e-2:0===e?e:e-1;return n+=i?24575:0,[n,t]};for(let c=0;c<s;++c)i.emplaceBack(...l(c,0,!0));for(let c=0;c<o;++c)for(let e=0;e<s;++e)i.emplaceBack(...l(e,c,(0===e||e===s-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<s;++t)i.emplaceBack(...l(t,e,!0))}for(let c=0;c<t.length;++c){const e=n.length,o=t[c]+1+2,l=new go;for(let i=0;i<o-1;i++){const e=i===o-2,r=e?s*(a-t.length+c-i):s;for(let t=0;t<s-1;t++){const o=i*s+t;0===i||e||0===t||t===s-2?(l.emplaceBack(o+1,o,o+r),l.emplaceBack(o+r,o+r+1,o+1)):(n.emplaceBack(o+1,o,o+r),n.emplaceBack(o+r,o+r+1,o+1))}}const h=ya.simpleSegment(0,e,i.length,n.length-e);for(let t=0;t<l.uint16.length;t+=3)n.emplaceBack(l.uint16[t],l.uint16[t+1],l.uint16[t+2]);const u=ya.simpleSegment(0,e,i.length,n.length-e);r.push({withoutSkirts:h,withSkirts:u})}return{vertices:i,indices:n,segments:r}}_createGrid(e){const t=this._fillGridMeshWithLods(64,yl);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,dl.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new go;for(let r=0;r<=64;r++)t.emplaceBack(0,r+1,r+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const i=new xo,n=new xo;this._poleSegments=[];for(let r=0,s=0;r<5;r++){const e=360/(1<<r);i.emplaceBack(0,-_l,0,.5,0),n.emplaceBack(0,-_l,0,.5,1);for(let t=0;t<=64;t++){const r=t/64,s=Ai(0,e,r),[o,a,l]=Rl(Hl,Gl,s,_l);i.emplaceBack(o,a,l,r,0),n.emplaceBack(o,a,l,r,1)}this._poleSegments.push(ya.simpleSegment(s,0,66,64)),s+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,hl,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(n,hl,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}getWirefameBuffers(e,t){if(!this._wireframeSegments){const t=new wo,i=64,n=i+1+2,r=1;this._wireframeSegments=[];for(let e=0,s=0;e<yl.length;e++){const o=yl[e];for(let e=r;e<o+r;e++)for(let s=r;s<i+r;s++){const i=e*n+s;t.emplaceBack(i,i+1),t.emplaceBack(i,i+n),t.emplaceBack(i,i+n+1)}const a=o*i*3;this._wireframeSegments.push(ya.simpleSegment(0,s,(o+1)*n,a)),s+=a}this._wireframeIndexBuffer=e.createIndexBuffer(t)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},e.GlyphManager=ep,e.ImagePosition=Td,e.KDBush=af,e.LivePerformanceUtils=je,e.LngLat=Xl,e.LngLatBounds=xa,e.LocalGlyphMode=Qd,e.MAX_MERCATOR_LATITUDE=nc,e.MercatorCoordinate=sc,e.ONE_EM=24,e.OverscaledTileID=xu,e.PerformanceMarkers=Fe,e.Point=y,e.Properties=Ws,e.RGBAImage=Wc,e.Ray=pl,e.RequestManager=class{constructor(e,t,i){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",u,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(e,t){if(!ve(e))return e;const i=Ee(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(e,t){if(!ve(e))return e;const i=Ee(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(e,t,i,n){if(!ve(e))return e;const r=Ee(e);return r.path=`/v4/${r.authority}.json`,r.params.push("secure"),i&&r.params.push("language="+i),n&&r.params.push("worldview="+n),this._makeAPIURL(r,this._customAccessToken||t)}normalizeSpriteURL(e,t,i,n){const r=Ee(e);return ve(e)?(r.path=`/styles/v1${r.path}/sprite${t}${i}`,this._makeAPIURL(r,this._customAccessToken||n)):(r.path+=`${t}${i}`,Te(r))}normalizeTileURL(e,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!ve(e))return e;const n=Ee(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&"raster"!==n.authority&&512===i?"@2x":""}${s.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${r.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${r.TILE_URL_VERSION}${n.path}`);const o=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(n.params)||r.ACCESS_TOKEN;return r.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,o)}canonicalizeTileURL(e,t){const i=Ee(e);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return e;let n="mapbox://";i.path.match(/^\/raster\/v1\//)?n+="raster/"+i.path.replace(`/${r.RASTER_URL_PREFIX}/`,""):n+="tiles/"+i.path.replace(`/${r.TILE_URL_VERSION}/`,"");let s=i.params;return t&&(s=s.filter(e=>!e.match(/^access_token=/))),s.length&&(n+="?"+s.join("&")),n}canonicalizeTileset(e,t){const i=!!t&&ve(t),n=[];for(const r of e.tiles||[])xe(r)?n.push(this.canonicalizeTileURL(r,i)):n.push(r);return n}_makeAPIURL(e,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=Ee(r.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){const t=e.params.indexOf("secure");t>=0&&e.params.splice(t,1)}if("/"!==n.path&&(e.path=`${n.path}${e.path}`),!r.REQUIRE_ACCESS_TOKEN)return Te(e);if(t=t||r.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error("An API access token is required to use Mapbox GL. "+i);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i)}return e.params=e.params.filter(e=>-1===e.indexOf("access_token")),e.params.push("access_token="+(t||"")),Te(e)}},e.ResourceType=le,e.SegmentVector=ya,e.SourceCache=Gm,e.StencilMode=Um,e.StructArrayLayout1ui2=Co,e.StructArrayLayout2f1f2i16=po,e.StructArrayLayout2i4=Qs,e.StructArrayLayout2ui4=wo,e.StructArrayLayout3f12=fo,e.StructArrayLayout3ui6=go,e.StructArrayLayout4i8=to,e.StructArrayLayout5f20=xo,e.Texture=pm,e.Tile=Tm,e.Transitionable=Ls,e.Uniform1f=Xo,e.Uniform1i=class extends $o{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},e.Uniform2f=class extends $o{constructor(e){super(e),this.current=[0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},e.Uniform3f=class extends $o{constructor(e){super(e),this.current=[0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},e.Uniform4f=Ko,e.UniformColor=Yo,e.UniformMatrix2f=class extends $o{constructor(e){super(e),this.current=ea}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let n=0;n<4;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},e.UniformMatrix3f=class extends $o{constructor(e){super(e),this.current=Qo}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let n=0;n<9;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},e.UniformMatrix4f=class extends $o{constructor(e){super(e),this.current=Jo}set(e,t,i){if(this.fetchUniformLocation(e,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},e.UnwrappedTileID=vu,e.ValidationError=$n,e.VectorTileFeature=Qh,e.VectorTileWorkerSource=class extends Qe{constructor(e,t,i,n,r){super(),this.actor=e,this.layerIndex=t,this.availableImages=i,this.loadVectorData=r||sf,this.loading={},this.loaded={},this.deduped=new rf(e.scheduler),this.isSpriteLoaded=n,this.scheduler=e.scheduler}loadTile(e,t){const i=e.uid,n=e&&e.request,r=n&&n.collectResourceTiming,s=this.loading[i]=new tf(e);s.abort=this.loadVectorData(e,(o,a)=>{const l=!this.loading[i];if(delete this.loading[i],l||o||!a)return s.status="done",l||(this.loaded[i]=s),t(o);const c=a.rawData,h={};a.expires&&(h.expires=a.expires),a.cacheControl&&(h.cacheControl=a.cacheControl),s.vectorTile=a.vectorTile||new Jh(new bd(c));const u=()=>{s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,(e,i)=>{if(e||!i)return t(e);const s={};if(r){const e=qe(n);e.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(e)))}t(null,R({rawTileData:c.slice(0)},i,h,s))})};this.isSpriteLoaded?u():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(u,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):u()}),this.loaded=this.loaded||{},this.loaded[i]=s})}reloadTile(e,t){const i=this.loaded,n=e.uid,r=this;if(i&&i[n]){const s=i[n];s.showCollisionBoxes=e.showCollisionBoxes,s.enableTerrain=!!e.enableTerrain,s.projection=e.projection,s.tileTransform=Tp(e.tileID.canonical,e.projection);const o=(e,i)=>{const n=s.reloadCallback;n&&(delete s.reloadCallback,s.parse(s.vectorTile,r.layerIndex,this.availableImages,r.actor,n)),t(e,i)};"parsing"===s.status?s.reloadCallback=o:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}}abortTile(e,t){const i=e.uid,n=this.loading[i];n&&(n.abort&&n.abort(),delete this.loading[i]),t()}removeTile(e,t){const i=this.loaded,n=e.uid;i&&i[n]&&delete i[n],t()}},e.WritingMode=Md,e.ZoomDependentExpression=Gn,e.add=Fa,e.addDynamicAttributes=Jp,e.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8];return e[0]=o*h-a*c,e[1]=r*c-n*h,e[2]=n*a-r*o,e[3]=a*l-s*h,e[4]=i*h-r*l,e[5]=r*s-i*a,e[6]=s*c-o*l,e[7]=n*l-i*c,e[8]=i*o-n*s,e},e.asyncAll=A,e.bezier=E,e.bindAll=B,e.boundsAttributes=Sm,e.bufferConvexPolygon=function(e,t){const i=[];for(let n=0;n<e.length;n++){const r=k(n-1,-1,e.length-1),s=k(n+1,-1,e.length-1),o=e[n],a=e[s],l=e[r].sub(o).unit(),c=a.sub(o).unit(),h=c.angleWithSep(l.x,l.y),u=l.add(c).unit().mult(-1*t/Math.sin(h/2));i.push(o.add(u))}return i},e.cacheEntryPossiblyAdded=function(e){ae++,ae>ne&&(e.getActor().send("enforceCacheSizeLimit",ie),ae=0)},e.calculateGlobeLabelMatrix=function(e,t){const{x:i,y:n}=e.point,r=Fl(i,n,e.worldSize/e._pixelsPerMercatorPixel,0,0);return Pa(r,r,Bl(Tl(t)))},e.calculateGlobeMatrix=function(e){const{x:t,y:i}=e.point,{lng:n,lat:r}=e._center;return Fl(t,i,e.worldSize,n,r)},e.calculateGlobeMercatorMatrix=function(e){const t=e.pixelsPerMeter,i=t/Ql(1,e.center.lat),n=Ea(new Float64Array(16));return Ma(n,n,[e.point.x,e.point.y,0]),ka(n,n,[i,i,t]),Float32Array.from(n)},e.circumferenceAtLatitude=Kl,e.clamp=P,e.clearTileCache=function(e){if(!re())return;const i=t.caches.delete(Q);e&&i.catch(e).then(()=>e())},e.clipLine=Xd,e.clone=function(e){var t=new wa(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=U,e.collisionCircleLayout=qu,e.config=r,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new wa(16);return wa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=Ca,e.createExpression=qn,e.createLayout=Ys,e.createStyleLayer=function(e){return"custom"===e.type?new cm(e):new dm[e.type](e)},e.cross=$a,e.degToRad=b,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},e.dot=Za,e.earthRadius=Wl,e.ease=T,e.easeCubicInOut=S,e.ecefToLatLng=function([e,t,i]){const n=Math.hypot(e,t,i),r=Math.atan2(e,i),s=.5*Math.PI-Math.acos(-t/n);return new Xl(w(r),w(s))},e.emitValidationErrors=Ir,e.endsWith=F,e.enforceCacheSizeLimit=function(e){se(),ee&&ee.then(t=>{t.keys().then(i=>{for(let n=0;n<i.length-e;n++)t.delete(i[n])})})},e.evaluateSizeForFeature=Wu,e.evaluateSizeForZoom=Zu,e.evaluateVariableOffset=mp,e.evented=As,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=$e,e.exported$1=s,e.extend=R,e.extend$1=tt,e.fillExtrusionHeightLift=pu,e.filterObject=V,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,l=r+r,c=i*o,h=n*o,u=n*a,d=r*o,p=r*a,m=r*l,f=s*o,g=s*a,_=s*l;return e[0]=1-u-m,e[1]=h+_,e[2]=d-g,e[3]=0,e[4]=h-_,e[5]=1-c-m,e[6]=p+f,e[7]=0,e[8]=d+g,e[9]=p-f,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=Ra,e.furthestTileCorner=function(e){const t=Math.round((e+45+360)%360/90)%4;return C[t]},e.getAABBPointSquareDist=function(e,t,i){let n=0;for(let r=0;r<2;++r){const s=i?i[r]:0;e[r]>s&&(n+=(e[r]-s)*(e[r]-s)),t[r]<s&&(n+=(s-t[r])*(s-t[r]))}return n},e.getAnchorAlignment=Bd,e.getAnchorJustification=gp,e.getBounds=function(e){let t=1/0,i=1/0,n=-1/0,r=-1/0;for(const s of e)t=Math.min(t,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),r=Math.max(r,s.y);return{min:new y(t,i),max:new y(n,r)}},e.getColumn=J,e.getDefaultExportFromCjs=d,e.getGridMatrix=function(e,t,i,n){const r=t.getNorth(),s=t.getSouth(),o=t.getWest(),a=t.getEast(),l=1<<e.z,c=a-o,h=r-s,u=c/64,d=-h/yl[i],p=[0,u,0,d,0,0,r,o,0];if(e.z>0){const e=180/n;Sa(p,p,[e/c+1,0,0,0,e/h+1,0,-.5*e/u,.5*e/d,1])}return p[2]=l,p[5]=e.x,p[8]=e.y,p},e.getImage=_e,e.getJSON=function(e,t){return ue(R(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){const t=nc-5;e=P(e,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(b(e))),3);return Math.round(i*(yl.length-1))},e.getMapSessionAPI=Le,e.getPerformanceMeasurement=qe,e.getProjection=Zp,e.getRTLTextPluginStatus=Is,e.getReferrer=he,e.getTilePoint=function(e,{x:t,y:i},n=0){return new y(((t-n)*e.scale-e.x)*va,(i*e.scale-e.y)*va)},e.getTileVec3=function(e,t,i=0){return Ba(((t.x-i)*e.scale-e.x)*va,(t.y*e.scale-e.y)*va,ic(t.z,t.y))},e.getVideo=function(e,i){const n=t.document.createElement("video");n.muted=!0,n.onloadstart=function(){i(null,n)};for(let r=0;r<e.length;r++){const i=t.document.createElement("source");pe(e[r])||(n.crossOrigin="Anonymous"),i.src=e[r],n.appendChild(i)}return{cancel:()=>{}}},e.globeCenterToScreenPoint=function(e){const t=[0,0,0],i=Ea(new Float64Array(16));return Pa(i,e.pixelMatrix,e.globeMatrix),Xa(t,t,i),new y(t[0],t[1])},e.globeDenormalizeECEF=Bl,e.globeECEFOrigin=function(e,t){const i=[0,0,0];return Xa(i,i,Ll(Tl(t.canonical))),Xa(i,i,e),i},e.globeMetersToEcef=wl,e.globeNormalizeECEF=Ll,e.globePixelsToTileUnits=function(e,t){return va/(512*Math.pow(2,e))*Dl(Tl(t))},e.globePoleMatrixForTile=function(e,t,i){const n=Ea(new Float64Array(16)),r=(t/(1<<e)-.5)*Math.PI*2;return Ia(n,i.globeMatrix,r),Float32Array.from(n)},e.globeTileBounds=Tl,e.globeTiltAtLngLat=Vl,e.globeToMercatorTransition=jl,e.globeUseCustomAntiAliasing=function(e,t,i){const n=jl(i.zoom),r=e.style.map._antialias,s=!!t.extStandardDerivatives,o=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===n&&!r&&!o&&s},e.identity=Ea,e.identity$1=sl,e.invert=Ta,e.isFullscreen=function(){return!!t.document.fullscreenElement||!!t.document.webkitFullscreenElement},e.isLngLatBehindGlobe=Ul,e.isMapAuthenticated=function(e){return Be.has(e)},e.isMapboxURL=ve,e.isSafariWithAntialiasingBug=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!K(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=tc,e.latLngToECEF=Ol,e.len=el,e.length=La,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.lngFromMercatorX=ec,e.loadVectorTile=sf,e.makeRequest=ue,e.mapValue=function(e,t,i,n,r){return P((e-t)/(i-t)*(r-n)+n,n,r)},e.mercatorScale=rc,e.mercatorXfromLng=Yl,e.mercatorYfromLat=Jl,e.mercatorZfromAltitude=Ql,e.mul=Na,e.mul$1=Qa,e.multiply=Pa,e.multiply$1=Sa,e.multiply$2=Va,e.nextPowerOfTwo=z,e.normalize=Wa,e.normalize$1=ll,e.normalize$2=il,e.number=Ai,e.ortho=function(e,t,i,n,r,s,o){var a=1/(t-i),l=1/(n-r),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(r+n)*l,e[14]=(o+s)*c,e[15]=1,e},e.pbf=Qu,e.perspective=function(e,t,i,n,r){var s,o=1/Math.tan(t/2);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+n)*(s=1/(n-r)),e[14]=2*r*n*s):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){const i={};for(let n=0;n<t.length;n++){const r=t[n];r in e&&(i[r]=e[r])}return i},e.plugin=Os,e.pointGeometry=g,e.polesInViewport=function(e){const t=Ea(new Float64Array(16));Pa(t,e.pixelMatrix,e.globeMatrix);const i=[0,vl,0],n=[0,xl,0];return Xa(i,i,t),Xa(n,n,t),[i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!Ul(e,new Xl(e.center.lat,90)),n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!Ul(e,new Xl(e.center.lat,-90))]},e.polygonContainsPoint=Pc,e.polygonIntersectsBox=Mc,e.polygonIntersectsPolygon=yc,e.polygonizeBounds=function(e,t,i=0,n=!0){const r=new y(i,i),s=e.sub(r),o=t.add(r),a=[s,new y(o.x,s.y),o,new y(s.x,o.y)];return n&&a.push(s.clone()),a},e.posAttributes=dl,e.postMapLoadEvent=Oe,e.postPerformanceEvent=De,e.postTurnstileEvent=Ie,e.potpack=Ed,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=w,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:Ts,pluginURL:Ps}),As.on("pluginStateChange",e),e},e.removeAuthState=function(e){Be.delete(e)},e.renderColorRamp=$c,e.resample=ac,e.rotateX=Aa,e.rotateX$1=ol,e.rotateY=Ia,e.rotateY$1=al,e.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],h=t[5],u=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*n,e[1]=o*r+h*n,e[2]=a*r+u*n,e[3]=l*r+d*n,e[4]=c*r-s*n,e[5]=h*r-o*n,e[6]=u*r-a*n,e[7]=d*r-l*n,e},e.rotateZ$1=function(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l+r*a,e[1]=r*l-n*a,e[2]=s*l+o*a,e[3]=o*l-s*a,e},e.scale=ka,e.scale$1=tl,e.scale$2=Ha,e.scaleAndAdd=Ga,e.set=function(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e},e.setCacheLimits=function(e,t){ie=e,ne=t},e.setColumn=function(e,t,i){e[4*t+0]=i[0],e[4*t+1]=i[1],e[4*t+2]=i[2],e[4*t+3]=i[3]},e.setRTLTextPlugin=function(e,t,i=!1){if(Ts===ws||Ts===Cs||Ts===Ss)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ps=$e.resolveURL(e),Ts=ws,Es=t,ks(),i||Rs()},e.smoothstep=M,e.spec=et,e.squaredLength=function(e){var t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n},e.storeAuthState=function(e,t){t?Be.add(e):Be.delete(e)},e.sub=Ja,e.subtract=ja,e.symbolSize=$u,e.tileAABB=function(e,t,i,n,r,s,o,a,l){if("globe"===l.name)return function(e,t,i){const n=t/e.worldSize,r=e.globeMatrix;if(i.z<=1){const e=Tl(i).getCorners();return kl(e,r,n),gl.fromPoints(e)}const s=Al(i),o=Il(s);kl(o,r,n);const a=Number.MAX_VALUE,l=[-a,-a,-a],c=[a,a,a];if(s.contains(e.center)){for(const e of o)Ua(c,c,e),qa(l,l,e);l[2]=0;const t=e.point,i=[t.x*n,t.y*n,0];return Ua(c,c,i),qa(l,l,i),new gl(c,l)}const h=[r[12]*n,r[13]*n,r[14]*n],u=s.getCenter(),d=P(e.center.lat,-nc,nc),p=P(u.lat,-nc,nc),m=Yl(e.center.lng),f=Jl(d);let g=m-Yl(u.lng);const _=f-Jl(p);g>.5?g-=1:g<-.5&&(g+=1);let y=0;Math.abs(g)>Math.abs(_)?y=g>=0?1:3:(y=_>=0?0:2,Ga(h,h,[r[4]*n,r[5]*n,r[6]*n],-Math.sin(b(_>=0?s.getSouth():s.getNorth()))*_l));const v=o[y],x=o[(y+1)%4],w=new Sl(v,x,h),C=[El(w,0)||v[0],El(w,1)||v[1],El(w,2)||v[2]],S=jl(e.zoom);if(S>0){const n=function({x:e,y:t,z:i},n,r,s,o){const a=1/(1<<i);let l=e*a,c=l+a,h=t*a,u=h+a,d=0;const p=(l+c)/2-s;return p>.5?d=-1:p<-.5&&(d=1),l=((l+d)*n-(s*=n))*r+s,c=((c+d)*n-s)*r+s,h=(h*n-(o*=n))*r+o,u=(u*n-o)*r+o,[[l,u,0],[c,u,0],[c,h,0],[l,h,0]]}(i,t,e._pixelsPerMercatorPixel,m,f);for(let e=0;e<o.length;e++)Pl(o[e],n[e],S);const r=Fa([],n[y],n[(y+1)%4]);Ha(r,r,.5),Pl(C,r,S)}for(const b of o)Ua(c,c,b),qa(l,l,b);return c[2]=Math.min(v[2],x[2]),Ua(c,c,C),qa(l,l,C),new gl(c,l)}(e,t,new yu(i,n,r));const c=Tp({z:i,x:n,y:r},l);return new gl([(s+c.x/c.scale)*t,t*(c.y/c.scale),o],[(s+c.x2/c.scale)*t,t*(c.y2/c.scale),a])},e.tileCornersToBounds=Al,e.tileTransform=Tp,e.transformMat3=function(e,t,i){var n=t[0],r=t[1],s=t[2];return e[0]=n*i[0]+r*i[3]+s*i[6],e[1]=n*i[1]+r*i[4]+s*i[7],e[2]=n*i[2]+r*i[5]+s*i[8],e},e.transformMat4=Xa,e.transformMat4$1=nl,e.transformQuat=Ka,e.transitionTileAABBinECEF=Ml,e.translate=Ma,e.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=Ms,e.uniqueId=N,e.updateGlobeVertexNormal=function(e,t,i,n,r){const s=5*t+2;e.float32[s+0]=i,e.float32[s+1]=n,e.float32[s+2]=r},e.validateCustomStyleLayer=function(e){const t=[],i=e.id;return void 0===i&&t.push({message:`layers.${i}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${i}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},e.validateFilter=e=>Ar(dr(e)),e.validateFog=e=>Ar(Cr(e)),e.validateLayer=e=>Ar(gr(e)),e.validateLight=e=>Ar(br(e)),e.validateSource=e=>Ar(vr(e)),e.validateStyle=Pr,e.validateTerrain=e=>Ar(wr(e)),e.values=I,e.vectorTile=jh,e.version=i,e.warnOnce=H,e.window=t,e.wrap=k})),n(0,(function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let i="[";for(const n of e)i+=t(n)+",";return i+"]"}let i="{";for(const n of Object.keys(e).sort())i+=`${n}:${t(e[n])},`;return i+"}"}function i(i){let n="";for(const r of e.refProperties)n+="/"+t(i[r]);return n}class n{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const i of t)this._layerConfigs[i.id]=i,(this._layers[i.id]=e.createStyleLayer(i)).compileFilter(),this.keyCache[i.id]&&delete this.keyCache[i.id];for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const r=function(e,t){const n={};for(let s=0;s<e.length;s++){const r=t&&t[e[s].id]||i(e[s]);t&&(t[e[s].id]=r);let o=n[r];o||(o=n[r]=[]),o.push(e[s])}const r=[];for(const i in n)r.push(n[i]);return r}(e.values(this._layerConfigs),this.keyCache);for(const e of r){const t=e.map(e=>this._layers[e.id]),i=t[0];if("none"===i.visibility)continue;const n=i.source||"";let r=this.familiesBySource[n];r||(r=this.familiesBySource[n]={});const s=i.sourceLayer||"_geojsonTileLayer";let o=r[s];o||(o=r[s]=[]),o.push(t)}}}class r{loadTile(t,i){const{uid:n,encoding:r,rawImageData:s,padding:o,buildQuadTree:a}=t,l=e.window.ImageBitmap&&s instanceof e.window.ImageBitmap?this.getImageData(s,o):s;i(null,new e.DEMData(n,l,r,o<1,a))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const i=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),i}}function s(e,t){if(0!==e.length){o(e[0],t);for(var i=1;i<e.length;i++)o(e[i],!t)}}function o(e,t){for(var i=0,n=0,r=0,s=e.length,o=s-1;r<s;o=r++){var a=(e[r][0]-e[o][0])*(e[o][1]+e[r][1]),l=i+a;n+=Math.abs(i)>=Math.abs(a)?i-l+a:a-l+i,i=l}i+n>=0!=!!t&&e.reverse()}var a=e.getDefaultExportFromCjs((function e(t,i){var n,r=t&&t.type;if("FeatureCollection"===r)for(n=0;n<t.features.length;n++)e(t.features[n],i);else if("GeometryCollection"===r)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],i);else if("Feature"===r)e(t.geometry,i);else if("Polygon"===r)s(t.coordinates,i);else if("MultiPolygon"===r)for(n=0;n<t.coordinates.length;n++)s(t.coordinates[n],i);return t}));const l=e.VectorTileFeature.prototype.toGeoJSON;var c={exports:{}},h=e.pointGeometry,u=e.vectorTile.VectorTileFeature,d=p;function p(e,t){this.options=t||{},this.features=e,this.length=e.length}function m(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}p.prototype.feature=function(e){return new m(this.features[e],this.options.extent)},m.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var i=e[t],n=[],r=0;r<i.length;r++)n.push(new h(i[r][0],i[r][1]));this.geometry.push(n)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,i=-1/0,n=1/0,r=-1/0,s=0;s<e.length;s++)for(var o=e[s],a=0;a<o.length;a++){var l=o[a];t=Math.min(t,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),r=Math.max(r,l.y)}return[t,n,i,r]},m.prototype.toGeoJSON=u.prototype.toGeoJSON;var f=e.pbf,g=d;function _(e){var t=new f;return function(e,t){for(var i in e.layers)t.writeMessage(3,y,e.layers[i])}(e,t),t.finish()}function y(e,t){var i;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<e.length;i++)n.feature=e.feature(i),t.writeMessage(2,v,n);var r=n.keys;for(i=0;i<r.length;i++)t.writeStringField(3,r[i]);var s=n.values;for(i=0;i<s.length;i++)t.writeMessage(4,S,s[i])}function v(e,t){var i=e.feature;void 0!==i.id&&t.writeVarintField(1,i.id),t.writeMessage(2,x,e),t.writeVarintField(3,i.type),t.writeMessage(4,C,i)}function x(e,t){var i=e.feature,n=e.keys,r=e.values,s=e.keycache,o=e.valuecache;for(var a in i.properties){var l=i.properties[a],c=s[a];if(null!==l){void 0===c&&(n.push(a),s[a]=c=n.length-1),t.writeVarint(c);var h=typeof l;"string"!==h&&"boolean"!==h&&"number"!==h&&(l=JSON.stringify(l));var u=h+":"+l,d=o[u];void 0===d&&(r.push(l),o[u]=d=r.length-1),t.writeVarint(d)}}}function b(e,t){return(t<<3)+(7&e)}function w(e){return e<<1^e>>31}function C(e,t){for(var i=e.loadGeometry(),n=e.type,r=0,s=0,o=i.length,a=0;a<o;a++){var l=i[a],c=1;1===n&&(c=l.length),t.writeVarint(b(1,c));for(var h=3===n?l.length-1:l.length,u=0;u<h;u++){1===u&&1!==n&&t.writeVarint(b(2,h-1));var d=l[u].x-r,p=l[u].y-s;t.writeVarint(w(d)),t.writeVarint(w(p)),r+=d,s+=p}3===n&&t.writeVarint(b(7,1))}}function S(e,t){var i=typeof e;"string"===i?t.writeStringField(1,e):"boolean"===i?t.writeBooleanField(7,e):"number"===i&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}c.exports=_,c.exports.fromVectorTileJs=_,c.exports.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var n in e)i[n]=new g(e[n].features,t),i[n].name=n,i[n].version=t.version,i[n].extent=t.extent;return _({layers:i})},c.exports.GeoJSONWrapper=g;var E=e.getDefaultExportFromCjs(c.exports);const T={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},P=Math.fround||(M=new Float32Array(1),e=>(M[0]=+e,M[0]));var M;class k{constructor(e){this.options=Object.assign(Object.create(T),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:i,maxZoom:n}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const s=[];for(let a=0;a<e.length;a++){const t=e[a];if(!t.geometry)continue;const[i,n]=t.geometry.coordinates,r=P(R(i)),o=P(O(n));s.push(r,o,1/0,a,-1,1),this.options.reduce&&s.push(0)}let o=this.trees[n+1]=this._createTree(s);t&&console.timeEnd(r);for(let a=n;a>=i;a--){const e=+Date.now();o=this.trees[a]=this._createTree(this._cluster(o,a)),t&&console.log("z%d: %d clusters in %dms",a,o.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let i=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,r=180;else if(i>r){const e=this.getClusters([i,n,180,s],t),o=this.getClusters([-180,n,r,s],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],a=o.range(R(i),O(s),R(r),O(n)),l=o.data,c=[];for(const h of a){const e=this.stride*h;c.push(l[e+5]>1?A(l,e,this.clusterProps):this.points[l[e+3]])}return c}getChildren(e){const t=this._getOriginId(e),i=this._getOriginZoom(e),n="No cluster with the specified id.",r=this.trees[i];if(!r)throw new Error(n);const s=r.data;if(t*this.stride>=s.length)throw new Error(n);const o=this.options.radius/(this.options.extent*Math.pow(2,i-1)),a=r.within(s[t*this.stride],s[t*this.stride+1],o),l=[];for(const c of a){const t=c*this.stride;s[t+4]===e&&l.push(s[t+5]>1?A(s,t,this.clusterProps):this.points[s[t+3]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,i){const n=[];return this._appendLeaves(n,e,t=t||10,i=i||0,0),n}getTile(e,t,i){const n=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:s,radius:o}=this.options,a=o/s,l=(i-a)/r,c=(i+1+a)/r,h={features:[]};return this._addTileFeatures(n.range((t-a)/r,l,(t+1+a)/r,c),n.data,t,i,r,h),0===t&&this._addTileFeatures(n.range(1-a/r,l,1,c),n.data,r,i,r,h),t===r-1&&this._addTileFeatures(n.range(0,l,a/r,c),n.data,-1,i,r,h),h.features.length?h:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}_appendLeaves(e,t,i,n,r){const s=this.getChildren(t);for(const o of s){const t=o.properties;if(t&&t.cluster?r+t.point_count<=n?r+=t.point_count:r=this._appendLeaves(e,t.cluster_id,i,n,r):r<n?r++:e.push(o),e.length===i)break}return r}_createTree(t){const i=new e.KDBush(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)i.add(t[e],t[e+1]);return i.finish(),i.data=t,i}_addTileFeatures(e,t,i,n,r,s){for(const o of e){const e=o*this.stride,a=t[e+5]>1;let l,c,h;if(a)l=I(t,e,this.clusterProps),c=t[e],h=t[e+1];else{const i=this.points[t[e+3]];l=i.properties;const[n,r]=i.geometry.coordinates;c=R(n),h=O(r)}const u={type:1,geometry:[[Math.round(this.options.extent*(c*r-i)),Math.round(this.options.extent*(h*r-n))]],tags:l};let d;d=a||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==d&&(u.id=d),s.features.push(u)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:i,extent:n,reduce:r,minPoints:s}=this.options,o=i/(n*Math.pow(2,t)),a=e.data,l=[],c=this.stride;for(let h=0;h<a.length;h+=c){if(a[h+2]<=t)continue;a[h+2]=t;const i=a[h],n=a[h+1],u=e.within(a[h],a[h+1],o),d=a[h+5];let p=d;for(const e of u){const i=e*c;a[i+2]>t&&(p+=a[i+5])}if(p>d&&p>=s){let e,s=i*d,o=n*d,m=-1;const f=((h/c|0)<<5)+(t+1)+this.points.length;for(const i of u){const n=i*c;if(a[n+2]<=t)continue;a[n+2]=t;const l=a[n+5];s+=a[n]*l,o+=a[n+1]*l,a[n+4]=f,r&&(e||(e=this._map(a,h,!0),m=this.clusterProps.length,this.clusterProps.push(e)),r(e,this._map(a,n)))}a[h+4]=f,l.push(s/p,o/p,1/0,f,-1,p),r&&l.push(m)}else{for(let e=0;e<c;e++)l.push(a[h+e]);if(p>1)for(const e of u){const i=e*c;if(!(a[i+2]<=t)){a[i+2]=t;for(let e=0;e<c;e++)l.push(a[i+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,i){if(e[t+5]>1){const n=this.clusterProps[e[t+6]];return i?Object.assign({},n):n}const n=this.points[e[t+3]].properties,r=this.options.map(n);return i&&r===n?Object.assign({},r):r}}function A(e,t,i){return{type:"Feature",id:e[t+3],properties:I(e,t,i),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),N(e[t+1])]}};var n}function I(e,t,i){const n=e[t+5],r=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n,s=e[t+6],o=-1===s?{}:Object.assign({},i[s]);return Object.assign(o,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:r})}function R(e){return e/360+.5}function O(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function N(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function D(e,t,i,n,r,s){var o=r-i,a=s-n;if(0!==o||0!==a){var l=((e-i)*o+(t-n)*a)/(o*o+a*a);l>1?(i=r,n=s):l>0&&(i+=o*l,n+=a*l)}return(o=e-i)*o+(a=t-n)*a}function z(e,t,i,n){var r={id:void 0===e?null:e,type:t,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)L(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<t.length;n++)L(e,t[n]);else if("MultiPolygon"===i)for(n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)L(e,t[n][r])}(r),r}function L(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function B(e,t,i,n){if(t.geometry){var r=t.geometry.coordinates,s=t.geometry.type,o=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),a=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=n||0),"Point"===s)F(r,a);else if("MultiPoint"===s)for(var c=0;c<r.length;c++)F(r[c],a);else if("LineString"===s)j(r,a,o,!1);else if("MultiLineString"===s){if(i.lineMetrics){for(c=0;c<r.length;c++)j(r[c],a=[],o,!1),e.push(z(l,"LineString",a,t.properties));return}V(r,a,o,!1)}else if("Polygon"===s)V(r,a,o,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(c=0;c<t.geometry.geometries.length;c++)B(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var h=[];V(r[c],h,o,!0),a.push(h)}}e.push(z(l,s,a,t.properties))}}function F(e,t){t.push(U(e[0])),t.push(q(e[1])),t.push(0)}function j(e,t,i,n){for(var r,s,o=0,a=0;a<e.length;a++){var l=U(e[a][0]),c=q(e[a][1]);t.push(l),t.push(c),t.push(0),a>0&&(o+=n?(r*c-l*s)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-s,2))),r=l,s=c}var h=t.length-3;t[2]=1,function e(t,i,n,r){for(var s,o=r,a=n-i>>1,l=n-i,c=t[i],h=t[i+1],u=t[n],d=t[n+1],p=i+3;p<n;p+=3){var m=D(t[p],t[p+1],c,h,u,d);if(m>o)s=p,o=m;else if(m===o){var f=Math.abs(p-a);f<l&&(s=p,l=f)}}o>r&&(s-i>3&&e(t,i,s,r),t[s+2]=o,n-s>3&&e(t,s,n,r))}(t,0,h,i),t[h+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function V(e,t,i,n){for(var r=0;r<e.length;r++){var s=[];j(e[r],s,i,n),t.push(s)}}function U(e){return e/360+.5}function q(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function H(e,t,i,n,r,s,o,a){if(n/=t,s>=(i/=t)&&o<n)return e;if(o<i||s>=n)return null;for(var l=[],c=0;c<e.length;c++){var h=e[c],u=h.geometry,d=h.type,p=0===r?h.minX:h.minY,m=0===r?h.maxX:h.maxY;if(p>=i&&m<n)l.push(h);else if(!(m<i||p>=n)){var f=[];if("Point"===d||"MultiPoint"===d)G(u,f,i,n,r);else if("LineString"===d)W(u,f,i,n,r,!1,a.lineMetrics);else if("MultiLineString"===d)$(u,f,i,n,r,!1);else if("Polygon"===d)$(u,f,i,n,r,!0);else if("MultiPolygon"===d)for(var g=0;g<u.length;g++){var _=[];$(u[g],_,i,n,r,!0),_.length&&f.push(_)}if(f.length){if(a.lineMetrics&&"LineString"===d){for(g=0;g<f.length;g++)l.push(z(h.id,d,f[g],h.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===f.length?(d="LineString",f=f[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===f.length?"Point":"MultiPoint"),l.push(z(h.id,d,f,h.tags))}}}return l.length?l:null}function G(e,t,i,n,r){for(var s=0;s<e.length;s+=3){var o=e[s+r];o>=i&&o<=n&&(t.push(e[s]),t.push(e[s+1]),t.push(e[s+2]))}}function W(e,t,i,n,r,s,o){for(var a,l,c=Z(e),h=0===r?K:Y,u=e.start,d=0;d<e.length-3;d+=3){var p=e[d],m=e[d+1],f=e[d+2],g=e[d+3],_=e[d+4],y=0===r?p:m,v=0===r?g:_,x=!1;o&&(a=Math.sqrt(Math.pow(p-g,2)+Math.pow(m-_,2))),y<i?v>i&&(l=h(c,p,m,g,_,i),o&&(c.start=u+a*l)):y>n?v<n&&(l=h(c,p,m,g,_,n),o&&(c.start=u+a*l)):X(c,p,m,f),v<i&&y>=i&&(l=h(c,p,m,g,_,i),x=!0),v>n&&y<=n&&(l=h(c,p,m,g,_,n),x=!0),!s&&x&&(o&&(c.end=u+a*l),t.push(c),c=Z(e)),o&&(u+=a)}var b=e.length-3;p=e[b],m=e[b+1],f=e[b+2],(y=0===r?p:m)>=i&&y<=n&&X(c,p,m,f),b=c.length-3,s&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&X(c,c[0],c[1],c[2]),c.length&&t.push(c)}function Z(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function $(e,t,i,n,r,s){for(var o=0;o<e.length;o++)W(e[o],t,i,n,r,s,!1)}function X(e,t,i,n){e.push(t),e.push(i),e.push(n)}function K(e,t,i,n,r,s){var o=(s-t)/(n-t);return e.push(s),e.push(i+(r-i)*o),e.push(1),o}function Y(e,t,i,n,r,s){var o=(s-i)/(r-i);return e.push(t+(n-t)*o),e.push(s),e.push(1),o}function J(e,t){for(var i=[],n=0;n<e.length;n++){var r,s=e[n],o=s.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=Q(s.geometry,t);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var a=0;a<s.geometry.length;a++)r.push(Q(s.geometry[a],t))}else if("MultiPolygon"===o)for(r=[],a=0;a<s.geometry.length;a++){for(var l=[],c=0;c<s.geometry[a].length;c++)l.push(Q(s.geometry[a][c],t));r.push(l)}i.push(z(s.id,o,r,s.tags))}return i}function Q(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var n=0;n<e.length;n+=3)i.push(e[n]+t,e[n+1],e[n+2]);return i}function ee(e,t){if(e.transformed)return e;var i,n,r,s=1<<e.z,o=e.x,a=e.y;for(i=0;i<e.features.length;i++){var l=e.features[i],c=l.geometry,h=l.type;if(l.geometry=[],1===h)for(n=0;n<c.length;n+=2)l.geometry.push(te(c[n],c[n+1],t,s,o,a));else for(n=0;n<c.length;n++){var u=[];for(r=0;r<c[n].length;r+=2)u.push(te(c[n][r],c[n][r+1],t,s,o,a));l.geometry.push(u)}}return e.transformed=!0,e}function te(e,t,i,n,r,s){return[Math.round(i*(e*n-r)),Math.round(i*(t*n-s))]}function ie(e,t,i,n,r){for(var s=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){o.numFeatures++,ne(o,e[a],s,r);var l=e[a].minX,c=e[a].minY,h=e[a].maxX,u=e[a].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),h>o.maxX&&(o.maxX=h),u>o.maxY&&(o.maxY=u)}return o}function ne(e,t,i,n){var r=t.geometry,s=t.type,o=[];if("Point"===s||"MultiPoint"===s)for(var a=0;a<r.length;a+=3)o.push(r[a]),o.push(r[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===s)re(o,r,e,i,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(a=0;a<r.length;a++)re(o,r[a],e,i,"Polygon"===s,0===a);else if("MultiPolygon"===s)for(var l=0;l<r.length;l++){var c=r[l];for(a=0;a<c.length;a++)re(o,c[a],e,i,!0,0===a)}if(o.length){var h=t.tags||null;if("LineString"===s&&n.lineMetrics){for(var u in h={},t.tags)h[u]=t.tags[u];h.mapbox_clip_start=r.start/r.size,h.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:h};null!==t.id&&(d.id=t.id),e.features.push(d)}}function re(e,t,i,n,r,s){var o=n*n;if(n>0&&t.size<(r?o:n))i.numPoints+=t.length/3;else{for(var a=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>o)&&(i.numSimplified++,a.push(t[l]),a.push(t[l+1])),i.numPoints++;r&&function(e,t){for(var i=0,n=0,r=e.length,s=r-2;n<r;s=n,n+=2)i+=(e[n]-e[s])*(e[n+1]+e[s+1]);if(i>0===t)for(n=0,r=e.length;n<r/2;n+=2){var o=e[n],a=e[n+1];e[n]=e[r-2-n],e[n+1]=e[r-1-n],e[r-2-n]=o,e[r-1-n]=a}}(a,s),e.push(a)}}function se(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var i=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)B(i,e.features[n],t,n);else B(i,"Feature"===e.type?e:{geometry:e},t);return i}(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var i=t.buffer/t.extent,n=e,r=H(e,1,-1-i,i,0,-1,2,t),s=H(e,1,1-i,2+i,0,-1,2,t);return(r||s)&&(n=H(e,1,-i,1+i,0,-1,2,t)||[],r&&(n=J(r,1).concat(n)),s&&(n=n.concat(J(s,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oe(e,t,i){return 32*((1<<e)*i+t)+e}function ae(t,i){const n=t.tileID.canonical;if(!this._geoJSONIndex)return i(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return i(null,null);const s=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const i of this._feature.geometry)t.push([new e.Point(i[0],i[1])]);return t}{const t=[];for(const i of this._feature.geometry){const n=[];for(const t of i)n.push(new e.Point(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,i){return l.call(this,e,t,i)}}(this._features[t])}}(r.features);let o=E(s);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),i(null,{vectorTile:s,rawData:o.buffer})}se.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},se.prototype.splitTile=function(e,t,i,n,r,s,o){for(var a=[e,t,i,n],l=this.options,c=l.debug;a.length;){n=a.pop(),i=a.pop(),t=a.pop(),e=a.pop();var h=1<<t,u=oe(t,i,n),d=this.tiles[u];if(!d&&(c>1&&console.time("creation"),d=this.tiles[u]=ie(e,t,i,n,l),this.tileCoords.push({z:t,x:i,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,r){if(t===l.maxZoom||t===r)continue;var m=1<<r-t;if(i!==Math.floor(s/m)||n!==Math.floor(o/m))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){c>1&&console.time("clipping");var f,g,_,y,v,x,b=.5*l.buffer/l.extent,w=.5-b,C=.5+b,S=1+b;f=g=_=y=null,v=H(e,h,i-b,i+C,0,d.minX,d.maxX,l),x=H(e,h,i+w,i+S,0,d.minX,d.maxX,l),e=null,v&&(f=H(v,h,n-b,n+C,1,d.minY,d.maxY,l),g=H(v,h,n+w,n+S,1,d.minY,d.maxY,l),v=null),x&&(_=H(x,h,n-b,n+C,1,d.minY,d.maxY,l),y=H(x,h,n+w,n+S,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),a.push(f||[],t+1,2*i,2*n),a.push(g||[],t+1,2*i,2*n+1),a.push(_||[],t+1,2*i+1,2*n),a.push(y||[],t+1,2*i+1,2*n+1)}}},se.prototype.getTile=function(e,t,i){var n=this.options,r=n.extent,s=n.debug;if(e<0||e>24)return null;var o=1<<e,a=oe(e,t=(t%o+o)%o,i);if(this.tiles[a])return ee(this.tiles[a],r);s>1&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var l,c=e,h=t,u=i;!l&&c>0;)c--,h=Math.floor(h/2),u=Math.floor(u/2),l=this.tiles[oe(c,h,u)];return l&&l.source?(s>1&&console.log("found parent tile z%d-%d-%d",c,h,u),s>1&&console.time("drilling down"),this.splitTile(l.source,c,h,u,e,t,i),s>1&&console.timeEnd("drilling down"),this.tiles[a]?ee(this.tiles[a],r):null):null};class le extends e.VectorTileWorkerSource{constructor(e,t,i,n,r){super(e,t,i,n,ae),r&&(this.loadGeoJSON=r)}loadData(t,i){const n=t&&t.request,r=n&&n.collectResourceTiming;this.loadGeoJSON(t,(s,o)=>{if(s||!o)return i(s);if("object"!=typeof o)return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{a(o,!0);try{if(t.filter){const i=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw new Error(i.value.map(e=>`${e.key}: ${e.message}`).join(", "));const n=o.features.filter(e=>i.value.evaluate({zoom:0},e));o={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new k(function({superclusterOptions:t,clusterProperties:i}){if(!i||!t)return t;const n={},r={},s={accumulated:null,zoom:0},o={properties:null},a=Object.keys(i);for(const l of a){const[t,s]=i[l],o=e.createExpression(s),a=e.createExpression("string"==typeof t?[t,["accumulated"],["get",l]]:t);n[l]=o.value,r[l]=a.value}return t.map=e=>{o.properties=e;const t={};for(const i of a)t[i]=n[i].evaluate(s,o);return t},t.reduce=(e,t)=>{o.properties=t;for(const i of a)s.accumulated=e[i],e[i]=r[i].evaluate(s,o)},t}(t)).load(o.features):function(e,t){return new se(e,t)}(o,t.geojsonVtOptions)}catch(s){return i(s)}this.loaded={};const l={};if(r){const i=e.getPerformanceMeasurement(n);i&&(l.resourceTiming={},l.resourceTiming[t.source]=JSON.parse(JSON.stringify(i)))}i(null,l)}})}reloadTile(e,t){const i=this.loaded;return i&&i[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,i){if(t.request)e.getJSON(t.request,i);else{if("string"!=typeof t.data)return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));try{return i(null,JSON.parse(t.data))}catch(e){return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class ce{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:le},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,i){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],i()}checkIfReady(e,t,i){i()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,i){this.isSpriteLoaded[t]=i;for(const n in this.workerSources[t]){const r=this.workerSources[t][n];for(const t in r)r[t]instanceof e.VectorTileWorkerSource&&(r[t].isSpriteLoaded=i,r[t].fire(new e.Event("isSpriteLoaded")))}}setImages(e,t,i){this.availableImages[e]=t;for(const n in this.workerSources[e]){const i=this.workerSources[e][n];for(const e in i)i[e].availableImages=t}i()}enableTerrain(e,t,i){this.terrain=t,i()}setProjection(t,i){this.projections[t]=e.getProjection(i)}setLayers(e,t,i){this.getLayerIndex(e).replace(t),i()}updateLayers(e,t,i){this.getLayerIndex(e).update(t.layers,t.removedIds),i()}loadTile(t,i,n){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).loadTile(r,n)}loadDEMTile(t,i,n){const r=this.enableTerrain?e.extend({buildQuadTree:this.terrain},i):i;this.getDEMWorkerSource(t,i.source).loadTile(r,n)}reloadTile(t,i,n){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).reloadTile(r,n)}abortTile(e,t,i){this.getWorkerSource(e,t.type,t.source).abortTile(t,i)}removeTile(e,t,i){this.getWorkerSource(e,t.type,t.source).removeTile(t,i)}removeSource(e,t,i){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,i):i()}loadWorkerSource(e,t,i){try{this.self.importScripts(t.url),i()}catch(e){i(e.toString())}}syncRTLPluginState(t,i,n){try{e.plugin.setState(i);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const i=e.plugin.isParsed();n(i?void 0:new Error("RTL Text Plugin failed to import scripts from "+t),i)}}catch(e){n(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}getWorkerSource(e,t,i){return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][i]||(this.workerSources[e][t][i]=new this.workerSourceTypes[t]({send:(t,i,n,r,s,o)=>{this.actor.send(t,i,n,e,s,o)},scheduler:this.actor.scheduler},this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])),this.workerSources[e][t][i]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new r),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,i){e.enforceCacheSizeLimit(i)}getWorkerPerformanceMetrics(e,t,i){i(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ce(self)),ce})),n(0,(function(e){function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let n=0;n<e.length;n++)if(!t(e[n],i[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const n in e)if(!t(e[n],i[n]))return!1;return!0}return e===i}var i=n;function n(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,i=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(i);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var i=t.getImageData(0,0,1,1);return i&&i.width===e.width}()?(void 0===r[t=e&&e.failIfMajorPerformanceCaveat]&&(r[t]=function(e){var t,i=function(e){var t=document.createElement("canvas"),i=Object.create(n.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=e,t.getContext("webgl",i)||t.getContext("experimental-webgl",i)}(e);if(!i)return!1;try{t=i.createShader(i.VERTEX_SHADER)}catch(e){return!1}return!(!t||i.isContextLost())&&(i.shaderSource(t,"void main() {}"),i.compileShader(t),!0===i.getShaderParameter(t,i.COMPILE_STATUS))}(t)),r[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var r={};function s(t,i,n){const r=e.window.document.createElement(t);return void 0!==i&&(r.className=i),n&&n.appendChild(r),r}function o(t,i,n){const r=e.window.document.createElementNS("http://www.w3.org/2000/svg",t);for(const e of Object.keys(i))r.setAttributeNS(null,e,i[e]);return n&&n.appendChild(r),r}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const a=e.window.document&&e.window.document.documentElement.style,l=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let c;function h(){a&&l&&(c=a[l],a[l]="none")}function u(){a&&l&&(a[l]=c)}function d(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",d,!0)}function p(){e.window.addEventListener("click",d,!0),e.window.setTimeout(()=>{e.window.removeEventListener("click",d,!0)},0)}function m(e,t){const i=e.getBoundingClientRect();return _(e,i,t)}function f(e,t){const i=e.getBoundingClientRect(),n=[];for(let r=0;r<t.length;r++)n.push(_(e,i,t[r]));return n}function g(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function _(t,i,n){const r=t.offsetWidth===i.width?1:t.offsetWidth/i.width;return new e.Point((n.clientX-i.left)*r,(n.clientY-i.top)*r)}function y(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i*s-r*n;return o?(e[0]=s*(o=1/o),e[1]=-n*o,e[2]=-r*o,e[3]=i*o,e):null}function v(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class x extends e.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}hasImage(e){return!!this.getImage(e)}getImage(e){return this.images[e]}addImage(e,t){this._validate(e,t)&&(this.images[e]=t)}_validate(t,i){let n=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),n=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),n=!1),this._validateContent(i.content,i)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let i=0;for(const n of e){if(n[0]<i||n[1]<n[0]||t<n[1])return!1;i=n[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let i=!0;if(!this.isLoaded())for(const n of e)this.images[n]||(i=!1);this.isLoaded()||i?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,i){const n={};for(const r of t){this.images[r]||this.fire(new e.Event("styleimagemissing",{id:r}));const t=this.images[r];t?n[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.warnOnce(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,n)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const i=this.patterns[t],n=this.getImage(t);if(!n)return null;if(i&&i.position.version===n.version)return i.position;if(i)i.position.version=n.version;else{const i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},r=new e.ImagePosition(i,n);this.patterns[t]={bin:i,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const i=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,i.RGBA),this.atlasTexture&&this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:i,h:n}=e.potpack(t),r=this.atlasImage;r.resize({width:i||1,height:n||1});for(const s in this.patterns){const{bin:t}=this.patterns[s],i=t.x+1,n=t.y+1,o=this.images[s].data,a=o.width,l=o.height;e.RGBAImage.copy(o,r,{x:0,y:0},{x:i,y:n},{width:a,height:l}),e.RGBAImage.copy(o,r,{x:0,y:l-1},{x:i,y:n-1},{width:a,height:1}),e.RGBAImage.copy(o,r,{x:0,y:0},{x:i,y:n+l},{width:a,height:1}),e.RGBAImage.copy(o,r,{x:a-1,y:0},{x:i-1,y:n},{width:1,height:l}),e.RGBAImage.copy(o,r,{x:0,y:0},{x:i+a,y:n},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;const e=this.images[t];v(e)&&this.updateImage(t,e)}}}const b=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new class{constructor(){this.specification=e.spec.light.position}possiblyEvaluate(t,i){return function([t,i,n]){const r=e.degToRad(i+90),s=e.degToRad(n);return{x:t*Math.cos(r)*Math.sin(s),y:t*Math.sin(r)*Math.sin(s),z:t*Math.cos(s),azimuthal:i,polar:n}}(t.expression.evaluate(i))}interpolate(t,i,n){return{x:e.number(t.x,i.x,n),y:e.number(t.y,i.y,n),z:e.number(t.z,i.z,n),azimuthal:e.number(t.azimuthal,i.azimuthal,n),polar:e.number(t.polar,i.polar,n)}}},color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)});class w extends e.Evented{constructor(t){super(),this._transitionable=new e.Transitionable(b),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,i={}){if(!this._validate(e.validateLight,t,i))for(const n in t){const i=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),i):this._transitionable.setValue(n,i)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}const C=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)});let S=class extends e.Evented{constructor(t,i){super(),this._transitionable=new e.Transitionable(C),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(t){for(const i in t){const n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),n):this._transitionable.setValue(i,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}};function E(t,i,n,r){const s=e.smoothstep(45,65,n),[o,a]=T(t,r),l=e.length(i);let c=1-Math.min(1,Math.exp((l-o)/(a-o)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*s*t.alpha}function T(e,t){const i=.5/Math.tan(.5*t);return[e.range[0]+i,e.range[1]+i]}const P=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])});class M extends e.Evented{constructor(t,i){super(),this._transitionable=new e.Transitionable(P),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=i}get state(){const t=this._transform,i="globe"===t.projection.name,n=e.globeToMercatorTransition(t.zoom),r=this.properties.get("range"),s=[.5,3];return{range:i?[e.number(s[0],r[0],n),e.number(s[1],r[1],n)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,i={}){if(!this._validate(e.validateFog,t,i)){for(const i of Object.keys(e.spec.fog))t&&void 0===t[i]&&(t[i]=e.spec.fog[i].default);for(const i in t){const n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),n):this._transitionable.setValue(i,n)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const i=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*i.a}getOpacityAtLatLng(t,i){return this._transform.projection.supportsFog?function(t,i,n){const r=e.MercatorCoordinate.fromLngLat(i),s=n.elevation?n.elevation.getAtPointOrZero(r):0,o=[r.x,r.y,s];return e.transformMat4(o,o,n.mercatorFogMatrix),E(t,o,n.pitch,n._fov)}(this.state,t,i):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?T(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}class k{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();const n=this.workerPool.acquire(this.id);for(let e=0;e<n.length;e++){const t=new k.Actor(n[e],i,this.id);t.name="Worker "+e,this.actors.push(t)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,i,n){e.asyncAll(this.actors,(e,n)=>{e.send(t,i,n)},n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}function A(t,i,n){return i*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}k.Actor=e.Actor;class I{constructor(e,t,i,n){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,n)}static createFromScreenPoints(t,i){let n,r;if(t instanceof e.Point||"number"==typeof t[0]){const s=e.Point.convert(t);n=[s],r=i.isPointAboveHorizon(s)}else{const s=e.Point.convert(t[0]),o=e.Point.convert(t[1]);n=[s,o],r=e.polygonizeBounds(s,o).every(e=>i.isPointAboveHorizon(e))}return new I(n,i.getCameraPoint(),r,i)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<n.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?r[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(r[3]=this.cameraPoint)),e.bufferConvexPolygon(r,t)}bufferedCameraGeometryGlobe(t){const i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,t),s=this.cameraPoint.clone();switch(3*((s.y>i.y)+(s.y>n.y))+((s.x>i.x)+(s.x>n.x))){case 0:r[0]=s,r[4]=s.clone();break;case 1:r.splice(1,0,s);break;case 2:r[1]=s;break;case 3:r.splice(4,0,s);break;case 5:r.splice(2,0,s);break;case 6:r[3]=s;break;case 7:r.splice(3,0,s);break;case 8:r[2]=s}return r}containsTile(t,i,n,r=0){const s=t.queryPadding/i._pixelsPerMercatorPixel+1,o=n?this._bufferedCameraMercator(s,i):this._bufferedScreenMercator(s,i);let a=t.tileID.wrap+(o.unwrapped?r:0);const l=o.polygon.map(i=>e.getTilePoint(t.tileTransform,i,a));if(!e.polygonIntersectsBox(l,0,0,e.EXTENT,e.EXTENT))return;a=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);const c=this.screenGeometryMercator.polygon.map(i=>e.getTileVec3(t.tileTransform,i,a)),h=c.map(t=>new e.Point(t[0],t[1])),u=i.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),d=e.getTileVec3(t.tileTransform,u,a),p=c.map(t=>{const i=e.sub(t,t,d);return e.normalize(i,i),new e.Ray(d,i)}),m=A(t,1,i.zoom)*i._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:h,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(f=e.getBounds(l),f.min.x=e.clamp(f.min.x,0,e.EXTENT),f.min.y=e.clamp(f.min.y,0,e.EXTENT),f.max.x=e.clamp(f.max.x,0,e.EXTENT),f.max.y=e.clamp(f.max.y,0,e.EXTENT),f),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:m};var f}_bufferedScreenMercator(e,t){const i=N(e);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map(e=>t.pointCoordinate3D(e)),unwrapped:!0},this._screenRaycastCache[i]=n,n}}_bufferedCameraMercator(e,t){const i=N(e);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map(e=>t.pointCoordinate3D(e)),unwrapped:!0},this._cameraRaycastCache[i]=n,n}}_projectAndResample(t,i){const n=function(t,i){const n=e.multiply([],i.pixelMatrix,i.globeMatrix),r=[0,-e.GLOBE_RADIUS,0,1],s=[0,e.GLOBE_RADIUS,0,1],o=[0,0,0,1];e.transformMat4$1(r,r,n),e.transformMat4$1(s,s,n),e.transformMat4$1(o,o,n);const a=new e.Point(r[0]/r[3],r[1]/r[3]),l=new e.Point(s[0]/s[3],s[1]/s[3]),c=e.polygonContainsPoint(t,a)&&r[3]<o[3],h=e.polygonContainsPoint(t,l)&&s[3]<o[3];if(!c&&!h)return null;const u=function(e,t,i){for(let n=1;n<e.length;n++){const r=O(t.pointCoordinate3D(e[n-1]).x),s=O(t.pointCoordinate3D(e[n]).x);if(i<0){if(r<s)return{idx:n,t:-r/(s-1-r)}}else if(s<r)return{idx:n,t:(1-r)/(s+1-r)}}return null}(t,i,c?-1:1);if(!u)return null;const{idx:d,t:p}=u;let m=d>1?R(t.slice(0,d),i):[],f=d<t.length?R(t.slice(d),i):[];m=m.map(t=>new e.Point(O(t.x),t.y)),f=f.map(t=>new e.Point(O(t.x),t.y));const g=[...m];0===g.length&&g.push(f[f.length-1]);const _=e.number(g[g.length-1].y,(0===f.length?m[0]:f[0]).y,p);let y;return y=c?[new e.Point(0,_),new e.Point(0,0),new e.Point(1,0),new e.Point(1,_)]:[new e.Point(1,_),new e.Point(1,1),new e.Point(0,1),new e.Point(0,_)],g.push(...y),0===f.length?g.push(m[0]):g.push(...f),{polygon:g.map(t=>new e.MercatorCoordinate(t.x,t.y)),unwrapped:!1}}(t,i);if(n)return n;const r=function(t,i){let n=!1,r=-1/0,s=0;for(let e=0;e<t.length-1;e++)t[e].x>r&&(r=t[e].x,s=e);for(let e=0;e<t.length-1;e++){const i=(s+e)%(t.length-1),r=t[i],o=t[i+1];Math.abs(r.x-o.x)>.5&&(r.x<o.x?(r.x+=1,0===i&&(t[t.length-1].x+=1)):(o.x+=1,i+1===t.length-1&&(t[0].x+=1)),n=!0)}const o=e.mercatorXfromLng(i.center.lng);return n&&o<Math.abs(o-1)&&t.forEach(e=>{e.x-=1}),{polygon:t,unwrapped:n}}(R(t,i).map(t=>new e.Point(O(t.x),t.y)),i);return{polygon:r.polygon.map(t=>new e.MercatorCoordinate(t.x,t.y)),unwrapped:r.unwrapped}}}function R(t,i){return e.resample(t,e=>{const t=i.pointCoordinate3D(e);e.x=t.x,e.y=t.y},1/256)}function O(e){return e<0?1+e%1:e%1}function N(e){return 100*e|0}function D(t,i,n,r,s){const o=function(n,r){if(n)return s(n);if(r){t.url&&r.tiles&&t.tiles&&delete t.tiles;const n=e.pick(e.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(n.vectorLayers=r.vector_layers,n.vectorLayerIds=n.vectorLayers.map(e=>e.id)),n.tiles=i.canonicalizeTileset(n,t.url),s(null,n)}};return t.url?e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url,null,n,r),e.ResourceType.Source),o):e.exported.frame(()=>o(null,t))}class z{constructor(t,i,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=i||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*i),r=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*i),s=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*i),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*i);return t.x>=n&&t.x<s&&t.y>=r&&t.y<o}}class L{constructor(e,t,i){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const B={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class F{constructor(e,t,i,n){this.length=t.length,this.attributes=i,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const r=e.gl;this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let i=0;i<this.attributes.length;i++){const n=t.attributes[this.attributes[i].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,i){for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n],s=t.attributes[r.name];void 0!==s&&e.vertexAttribPointer(s,r.components,e[B[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class j{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class V extends j{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class U extends j{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class q extends j{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class H extends j{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class G extends j{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class W extends j{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Z extends j{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class $ extends j{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class X extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class K extends j{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Y extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class J extends j{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Q extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ee extends j{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class te extends j{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ie extends j{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ne extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class re extends j{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class se extends j{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let oe,ae=class extends j{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class le extends j{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ce extends j{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class he extends j{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ue extends j{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class de extends j{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class pe extends j{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class me extends j{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fe extends j{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class ge extends j{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class _e extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ye extends j{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ve extends j{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class xe extends ve{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class be extends ve{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class we extends be{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ce{constructor(e,t,i,n){this.context=e,this.width=t,this.height=i;const r=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new xe(e,r),n&&(this.depthAttachment=new be(e,r))}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Se{constructor(e,t=!1){if(this.gl=e,this.isWebGL2=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),t){const t=e;this.extVertexArrayObject={createVertexArrayOES:t.createVertexArray.bind(e),deleteVertexArrayOES:t.deleteVertexArray.bind(e),bindVertexArrayOES:t.bindVertexArray.bind(e)}}this.clearColor=new V(this),this.clearDepth=new U(this),this.clearStencil=new q(this),this.colorMask=new H(this),this.depthMask=new G(this),this.stencilMask=new W(this),this.stencilFunc=new Z(this),this.stencilOp=new $(this),this.stencilTest=new X(this),this.depthRange=new K(this),this.depthTest=new Y(this),this.depthFunc=new J(this),this.blend=new Q(this),this.blendFunc=new ee(this),this.blendColor=new te(this),this.blendEquation=new ie(this),this.cullFace=new ne(this),this.cullFaceSide=new re(this),this.frontFace=new se(this),this.program=new ae(this),this.activeTexture=new le(this),this.viewport=new ce(this),this.bindFramebuffer=new he(this),this.bindRenderbuffer=new ue(this),this.bindTexture=new de(this),this.bindVertexBuffer=new pe(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fe(this),this.pixelStoreUnpack=new ge(this),this.pixelStoreUnpackPremultiplyAlpha=new _e(this),this.pixelStoreUnpackFlipY=new ye(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),t||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(t||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new L(this,e,t)}createVertexBuffer(e,t,i){return new F(this,e,t,i)}createRenderbuffer(e,t,i){const n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,e,t,i),this.bindRenderbuffer.set(null),r}createFramebuffer(e,t,i){return new Ce(this,e,t,i)}clear({color:e,depth:t,stencil:i}){const n=this.gl;let r=0;e&&(r|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(r|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==i&&(r|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),n.clear(r)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(i){t(i.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ee extends e.Evented{constructor(t,i,n,r){if(super(),this.id=t,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(i,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new e.DedupedRequest}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=D(this._options,this.map._requestManager,i,n,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?(i&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: "+i),n&&2!==n.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: "+n),this.fire(new e.ErrorEvent(r))):s&&(e.extend(this,s),s.bounds&&(this.tileBounds=new z(s.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(s.tiles,this.map._requestManager._customAccessToken),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}loadTile(t,i){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=i:t.request=t.actor.send("reloadTile",r,s.bind(this));else if(t.actor=this._tileWorkers[n]=this._tileWorkers[n]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",r,s.bind(this),void 0,!0);else{const i=e.loadVectorTile.call({deduped:this._deduped},r,(e,i)=>{e||!i?s.call(this,e):(r.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},t.actor&&t.actor.send("loadTile",r,s.bind(this),void 0,!0))},!0);t.request={cancel:i}}function s(n,r){return delete t.request,t.aborted?i(null):n&&404!==n.status?i(n):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Te extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.dispatcher=n,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},i),e.extend(this,e.pick(i,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,null,null,(i,n)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new e.ErrorEvent(i)):n&&(e.extend(this,n),n.bounds&&(this.tileBounds=new z(n.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(n.tiles),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,i){const n=e.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),n,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(r,e.ResourceType.Tile),(n,r,s,o)=>(delete t.request,t.aborted?(t.state="unloaded",i(null)):n?(t.state="errored",i(n)):r?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:s,expires:o}),t.setTexture(r,this.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(this.dispatcher),void i(null)):i(null)))}static loadTileData(e,t,i){e.setTexture(t,i)}static unloadTileData(e,t){e.texture&&t.saveTileTexture(e.texture)}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Pe(t,i,n,r,s,o,a,l){const c=[t,n,s,i,r,o,1,1,1],h=[a,l,1],u=e.adjoint([],c),[d,p,m]=e.transformMat3(h,h,e.transpose(u,u));return e.multiply$1(c,[d,0,0,0,p,0,0,0,m],c)}class Me extends e.Evented{constructor(e,t,i,n){super(),this.id=e,this.dispatcher=i,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t,this._dirty=!1}load(t,i){this._loaded=i||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(i,n)=>{if(this._imageRequest=null,this._loaded=!0,i)this.fire(new e.ErrorEvent(i));else if(n){const{HTMLImageElement:i}=e.window;this.image=n instanceof i?e.exported.getImageData(n):n,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const i=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){let i=1/0,n=1/0,r=-1/0,s=-1/0;for(const e of t)i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),s=Math.max(s,e.y);const o=Math.max(r-i,s-n),a=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,a);return new e.CanonicalTileID(a,Math.floor((i+r)/2*l),Math.floor((n+s)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}if(this._boundsArray)return;const i=e.tileTransform(this.tileID,this.map.transform.projection),[n,r,s,o]=this.coordinates.map(t=>{const n=i.projection.project(t[0],t[1]);return e.getTilePoint(i,n)._round()});this.perspectiveTransform=function(t,i,n,r,s,o,a,l,c,h){const u=Pe(0,0,t,0,0,i,t,i),d=Pe(n,r,s,o,a,l,c,h);return e.multiply$1(d,e.adjoint(u,u),d),[d[6]/d[8]*t/e.EXTENT,d[7]/d[8]*i/e.EXTENT]}(this.width,this.height,n.x,n.y,r.x,r.y,o.x,o.y,s.x,s.y);const a=this._boundsArray=new e.StructArrayLayout4i8;a.emplaceBack(n.x,n.y,0,0),a.emplaceBack(r.x,r.y,e.EXTENT,0),a.emplaceBack(o.x,o.y,0,e.EXTENT),a.emplaceBack(s.x,s.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(a,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,i=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ke={vector:Ee,raster:Te,"raster-dem":class extends Te{constructor(t,i,n,r){super(t,i,n,r),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(t,i){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(e,n){e&&(t.state="errored",i(e)),n&&(t.dem=n,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",i(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),(function(n,s,o,a){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(n)t.state="errored",i(n);else if(s){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:a});const i=e.window.ImageBitmap&&s instanceof e.window.ImageBitmap&&(null==oe&&(oe=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),oe),n=1-(s.width-e.prevPowerOfTwo(s.width))/2;n<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const l=i?s:e.exported.getImageData(s,n),c={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:n};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,r.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(t){const i=t.canonical,n=Math.pow(2,i.z),r=(i.x-1+n)%n,s=0===i.x?t.wrap-1:t.wrap,o=(i.x+1+n)%n,a=i.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y).key]={backfilled:!1},i.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y-1).key]={backfilled:!1}),i.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y+1).key]={backfilled:!1}),l}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}},geojson:class extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(r),this._data=i.data,this._options=e.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const s=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*s,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*s,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*s,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:i},n),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;const t=e.extend({},this.workerOptions),i=this._data;"string"==typeof i?(t.request=this.map._requestManager.transformRequest(e.exported.resolveURL(i),e.ResourceType.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(i),this._pendingLoad=this.actor.send(this.type+".loadData",t,(t,i)=>{if(this._loaded=!0,this._pendingLoad=null,t)this.fire(new e.ErrorEvent(t));else{const t={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(t.resourceTiming=i.resourceTiming[this.id]),this.fire(new e.Event("data",t)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(t,i){const n=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(n,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(e,r)=>(delete t.request,t.unloadVectorData(),t.aborted?i(null):e?i(e):(t.loadVectorData(r,this.map.painter,"reloadTile"===n),i(null))),void 0,"loadTile"===n)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Me{constructor(e,t,i,n){super(e,t,i,n),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const i of t.urls)this.urls.push(this.map._requestManager.transformRequest(i,e.ResourceType.Source).url);e.getVideo(this.urls,(t,i)=>{this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,i=t.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Me,canvas:class extends Me{constructor(t,i,n,r){super(t,i,n,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(e=>!Array.isArray(e)||2!==e.length||e.some(e=>"number"!=typeof e))||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=i,this.setEventedParent(r),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new e.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new z(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),e.extend(this,e.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:i,z:n}=e.canonical;return this._implementation.hasTile({x:t,y:i,z:n})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,i){const{x:n,y:r,z:s}=t.tileID.canonical,o=new e.window.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:n,y:r,z:s},{signal:o.signal})).then((function(n){return delete t.request,t.aborted?(t.state="unloaded",i(null)):void 0===n?(t.state="errored",i(null)):null===n?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",i(null)):function(t){return t instanceof e.window.ImageData||t instanceof e.window.HTMLCanvasElement||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLImageElement}(n)?(this.loadTileData(t,n),t.state="loaded",void i(null)):(t.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(e=>{20!==e.code&&(t.state="errored",i(e))}),t.request.cancel=()=>o.abort()}loadTileData(e,t){Te.loadTileData(e,t,this._map.painter)}unloadTileData(e){Te.unloadTileData(e,this._map.painter)}unloadTile(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){const{x:t,y:i,z:n}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:i,z:n})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ae=function(t,i,n,r){const s=new ke[i.type](t,i,n,r);if(s.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${s.id}`);return e.bindAll(["load","abort","unload","serialize","prepare"],s),s};function Ie(t,i){const n=e.identity([]);return e.scale(n,n,[.5*t.width,.5*-t.height,1]),e.translate(n,n,[1,-1,0]),e.multiply(n,n,t.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(n)}function Re(e,t,i,n,r,s,o,a=!1){const l=e.tilesIn(n,o,a);l.sort(Ne);const c=[];for(const u of l)c.push({wrappedTileID:u.tile.tileID.wrapped().key,queryResults:u.tile.queryRenderedFeatures(t,i,e._state,u,r,s,Ie(e.transform,u.tile.tileID),a)});const h=function(e){const t={},i={};for(const n of e){const e=n.queryResults,r=n.wrappedTileID,s=i[r]=i[r]||{};for(const i in e){const n=e[i],r=s[i]=s[i]||{},o=t[i]=t[i]||[];for(const e of n)r[e.featureIndex]||(r[e.featureIndex]=!0,o.push(e))}}return t}(c);for(const u in h)h[u].forEach(t=>{const i=t.feature,n=i.layer;n&&"background"!==n.type&&"sky"!==n.type&&(i.source=n.source,n["source-layer"]&&(i.sourceLayer=n["source-layer"]),i.state=void 0!==i.id?e.getFeatureState(n["source-layer"],i.id):{})});return h}function Oe(e,t){const i=e.getRenderableIds().map(t=>e.getTileByID(t)),n=[],r={};for(let s=0;s<i.length;s++){const e=i[s],o=e.tileID.canonical.key;r[o]||(r[o]=!0,e.querySourceFeatures(n,t))}return n}function Ne(e,t){const i=e.tileID,n=t.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}function De(){return null!=us.workerClass?new us.workerClass:new e.window.Worker(us.workerUrl)}const ze="mapboxgl_preloaded_worker_pool";class Le{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Le.workerCount;)this.workers.push(new De);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(e=>{e.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ze]}numActive(){return Object.keys(this.active).length}}let Be;function Fe(){return Be||(Be=new Le),Be}function je(t,i){const n={};for(const e in t)"ref"!==e&&(n[e]=t[e]);return e.refProperties.forEach(e=>{e in i&&(n[e]=i[e])}),n}function Ve(e){e=e.slice();const t=Object.create(null);for(let i=0;i<e.length;i++)t[e[i].id]=e[i];for(let i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=je(e[i],t[e[i].ref]));return e}Le.workerCount=2;const Ue={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function qe(e,t,i){i.push({command:Ue.addSource,args:[e,t[e]]})}function He(e,t,i){t.push({command:Ue.removeSource,args:[e]}),i[e]=!0}function Ge(e,t,i,n){He(e,i,n),qe(e,t,i)}function We(e,i,n){let r;for(r in e[n])if(e[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;for(r in i[n])if(i[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;return!0}function Ze(e,i,n,r,s,o){let a;for(a in i=i||{},e=e||{})e.hasOwnProperty(a)&&(t(e[a],i[a])||n.push({command:o,args:[r,a,i[a],s]}));for(a in i)i.hasOwnProperty(a)&&!e.hasOwnProperty(a)&&(t(e[a],i[a])||n.push({command:o,args:[r,a,i[a],s]}))}function $e(e){return e.id}function Xe(e,t){return e[t.id]=t,e}class Ke{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);let i=1,n=this._distances[i];const r=t*this.paddedLength+this.padding;for(;n<r&&i<this._distances.length;)n=this._distances[++i];const s=i-1,o=this._distances[s],a=n-o,l=a>0?(r-o)/a:0;return this.points[s].mult(1-l).add(this.points[i].mult(l))}}class Ye{constructor(e,t,i){const n=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(let s=0;s<this.xCellCount*this.yCellCount;s++)n.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}insertCircle(e,t,i,n){this._forEachCell(t-n,i-n,t+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(n)}_insertBoxCell(e,t,i,n,r,s){this.boxCells[r].push(s)}_insertCircleCell(e,t,i,n,r,s){this.circleCells[r].push(s)}_query(e,t,i,n,r,s){if(i<0||e>this.width||n<0||t>this.height)return!r&&[];const o=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=n){if(r)return!0;for(let e=0;e<this.boxKeys.length;e++)o.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],i=this.circles[3*e+1],n=this.circles[3*e+2];o.push({key:this.circleKeys[e],x1:t-n,y1:i-n,x2:t+n,y2:i+n})}return s?o.filter(s):o}return this._forEachCell(e,t,i,n,this._queryCell,o,{hitTest:r,seenUids:{box:{},circle:{}}},s),r?o.length>0:o}_queryCircle(e,t,i,n,r){const s=e-i,o=e+i,a=t-i,l=t+i;if(o<0||s>this.width||l<0||a>this.height)return!n&&[];const c=[];return this._forEachCell(s,a,o,l,this._queryCellCircle,c,{hitTest:n,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}},r),n?c.length>0:c}query(e,t,i,n,r){return this._query(e,t,i,n,!1,r)}hitTest(e,t,i,n,r){return this._query(e,t,i,n,!0,r)}hitTestCircle(e,t,i,n){return this._queryCircle(e,t,i,!0,n)}_queryCell(e,t,i,n,r,s,o,a){const l=o.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const h of c)if(!l.box[h]){l.box[h]=!0;const c=4*h;if(e<=r[c+2]&&t<=r[c+3]&&i>=r[c+0]&&n>=r[c+1]&&(!a||a(this.boxKeys[h]))){if(o.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[h],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]})}}}const h=this.circleCells[r];if(null!==h){const r=this.circles;for(const c of h)if(!l.circle[c]){l.circle[c]=!0;const h=3*c;if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],e,t,i,n)&&(!a||a(this.circleKeys[c]))){if(o.hitTest)return s.push(!0),!0;{const e=r[h],t=r[h+1],i=r[h+2];s.push({key:this.circleKeys[c],x1:e-i,y1:t-i,x2:e+i,y2:t+i})}}}}}_queryCellCircle(e,t,i,n,r,s,o,a){const l=o.circle,c=o.seenUids,h=this.boxCells[r];if(null!==h){const e=this.bboxes;for(const t of h)if(!c.box[t]){c.box[t]=!0;const i=4*t;if(this._circleAndRectCollide(l.x,l.y,l.radius,e[i+0],e[i+1],e[i+2],e[i+3])&&(!a||a(this.boxKeys[t])))return s.push(!0),!0}}const u=this.circleCells[r];if(null!==u){const e=this.circles;for(const t of u)if(!c.circle[t]){c.circle[t]=!0;const i=3*t;if(this._circlesCollide(e[i],e[i+1],e[i+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[t])))return s.push(!0),!0}}}_forEachCell(e,t,i,n,r,s,o,a){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),h=this._convertToXCellCoord(i),u=this._convertToYCellCoord(n);for(let d=l;d<=h;d++)for(let l=c;l<=u;l++)if(r.call(this,e,t,i,n,this.xCellCount*l+d,s,o,a))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,i,n,r,s){const o=n-e,a=r-t,l=i+s;return l*l>o*o+a*a}_circleAndRectCollide(e,t,i,n,r,s,o){const a=(s-n)/2,l=Math.abs(e-(n+a));if(l>a+i)return!1;const c=(o-r)/2,h=Math.abs(t-(r+c));if(h>c+i)return!1;if(l<=a||h<=c)return!0;const u=l-a,d=h-c;return u*u+d*d<=i*i}}const Je=Math.tan(85*Math.PI/180);function Qe(t,i,n,r,s,o,a){const l=e.create();if(n)if("globe"===o.name){const t=e.calculateGlobeLabelMatrix(s,i);e.multiply(l,l,t)}else{const t=y([],a);l[0]=t[0],l[1]=t[1],l[4]=t[2],l[5]=t[3],r||e.rotateZ(l,l,s.angle)}else e.multiply(l,s.labelPlaneMatrix,t);return l}function et(e,t,i,n,r,s,o){const a=Qe(e,t,i,n,r,s,o);return"globe"===s.name&&i||(a[2]=a[6]=a[10]=a[14]=0),a}function tt(t,i,n,r,s,o,a){if(n){if("globe"===o.name){const l=Qe(t,i,n,r,s,o,a);return e.invert(l,l),e.multiply(l,t,l),l}{const i=e.clone(t),n=e.identity([]);return n[0]=a[0],n[1]=a[1],n[4]=a[2],n[5]=a[3],e.multiply(i,i,n),r||e.rotateZ(i,i,-s.angle),i}}return s.glCoordMatrix}function it(t,i,n,r){const s=[t,i,n,1];n?e.transformMat4$1(s,s,r):pt(s,s,r);const o=s[3];return s[0]/=o,s[1]/=o,s[2]/=o,s}function nt(e,t){return Math.min(.5+e/t*.5,1.5)}function rt(e,t){const i=e[0]/e[3],n=e[1]/e[3];return i>=-t[0]&&i<=t[0]&&n>=-t[1]&&n<=t[1]}function st(t,i,n,r,s,o,a,l,c,h){const u=n.transform,d=r?t.textSizeData:t.iconSizeData,p=e.evaluateSizeForZoom(d,n.transform.zoom),m="globe"===u.projection.name,f=[256/n.width*2+1,256/n.height*2+1],g=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let _=null;m&&(_=r?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const y=t.lineVertexArray,v=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,x=n.transform.width/n.transform.height;let b,w=!1;for(let C=0;C<v.length;C++){const r=v.get(C),{numGlyphs:m,writingMode:S}=r;if(S!==e.WritingMode.vertical||w||b===e.WritingMode.horizontal||(w=!0),b=S,(r.hidden||S===e.WritingMode.vertical)&&!w){dt(m,g);continue}w=!1;const E=new e.Point(r.tileAnchorX,r.tileAnchorY);let{x:T,y:P,z:M}=u.projection.projectTilePoint(E.x,E.y,h.canonical);if(c){const[e,t,i]=c(E);T+=e,P+=t,M+=i}const k=[T,P,M,1];if(e.transformMat4$1(k,k,i),!rt(k,f)){dt(m,g);continue}const A=nt(n.transform.cameraToCenterDistance,k[3]),I=e.evaluateSizeForFeature(d,p,r),R=a?I/A:I*A,O=it(T,P,M,s);if(O[3]<=0){dt(m,g);continue}let N={};const D=a?null:c,z=lt(r,R,!1,l,i,s,o,t.glyphOffsetArray,y,g,_,O,E,N,x,D,u.projection,h,a);w=z.useVertical,D&&z.needsFlipping&&(N={}),(z.notEnoughRoom||w||z.needsFlipping&&lt(r,R,!0,l,i,s,o,t.glyphOffsetArray,y,g,_,O,E,N,x,D,u.projection,h,a).notEnoughRoom)&&dt(m,g)}r?(t.text.dynamicLayoutVertexBuffer.updateData(g),_&&t.text.globeExtVertexBuffer.updateData(_)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),_&&t.icon.globeExtVertexBuffer.updateData(_))}function ot(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f){const{lineStartIndex:g,glyphStartIndex:_,segment:y}=a,v=_+a.numGlyphs,x=g+a.lineLength,b=t.getoffsetX(_),w=t.getoffsetX(v-1),C=ut(e*b,i,n,r,s,o,y,g,x,l,c,h,u,d,!0,p,m,f);if(!C)return null;const S=ut(e*w,i,n,r,s,o,y,g,x,l,c,h,u,d,!0,p,m,f);return S?{first:C,last:S}:null}function at(t,i,n,r){return t===e.WritingMode.horizontal&&Math.abs(r)>Math.abs(n)?{useVertical:!0}:t===e.WritingMode.vertical?r>0?{needsFlipping:!0}:null:0!==i&&function(e,t){return 0===e||Math.abs(t/e)>Je}(n,r)?1===i?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function lt(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v){const x=i/24,b=t.lineOffsetX*x,w=t.lineOffsetY*x,{lineStartIndex:C,glyphStartIndex:S,numGlyphs:E,segment:T,writingMode:P,flipState:M}=t,k=C+t.lineLength,A=t=>{if(u){const[i,n,r]=t.up,s=h.length;e.updateGlobeVertexNormal(u,s+0,i,n,r),e.updateGlobeVertexNormal(u,s+1,i,n,r),e.updateGlobeVertexNormal(u,s+2,i,n,r),e.updateGlobeVertexNormal(u,s+3,i,n,r)}const[i,n,r]=t.point;e.addDynamicAttributes(h,i,n,r,t.angle)};if(E>1){const e=ot(x,l,b,w,n,d,p,t,c,o,m,g,!1,_,y,v);if(!e)return{notEnoughRoom:!0};if(r&&!n){let[i,n,r]=e.first.point,[s,o,l]=e.last.point;[i,n]=it(i,n,r,a),[s,o]=it(s,o,l,a);const c=at(P,M,(s-i)*f,o-n);if(t.flipState=c&&c.needsFlipping?1:2,c)return c}A(e.first);for(let t=S+1;t<S+E-1;t++){const e=ut(x*l.getoffsetX(t),b,w,n,d,p,T,C,k,c,o,m,g,!1,!1,_,y,v);if(!e)return h.length-=4*(t-S),{notEnoughRoom:!0};A(e)}A(e.last)}else{if(r&&!n){const i=it(p.x,p.y,0,s),n=C+T+1,r=new e.Point(c.getx(n),c.gety(n)),o=it(r.x,r.y,0,s),a=o[3]>0?o:ht(p,r,i,1,s,void 0,_,y.canonical),l=at(P,M,(a[0]-i[0])*f,a[1]-i[1]);if(t.flipState=l&&l.needsFlipping?1:2,l)return l}const i=ut(x*l.getoffsetX(S),b,w,n,d,p,T,C,k,c,o,m,g,!1,!1,_,y,v);if(!i)return{notEnoughRoom:!0};A(i)}return{}}function ct(e,t,i,n,r){const{x:s,y:o,z:a}=n.projectTilePoint(e.x,e.y,t);if(!r)return it(s,o,a,i);const[l,c,h]=r(e);return it(s+l,o+c,a+h,i)}function ht(t,i,n,r,s,o,a,l){const c=ct(t.sub(i)._unit()._add(t),l,s,a,o);return e.sub(c,n,c),e.normalize(c,c),e.scaleAndAdd(c,n,c,r)}function ut(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y){const v=r?t-i:t+i;let x=v>0?1:-1,b=0;r&&(x*=-1,b=Math.PI),x<0&&(b+=Math.PI);let w=l+a+(x>0?0:1)|0,C=s,S=s,E=0,T=0;const P=Math.abs(v),M=[],k=[];let A=o,I=A;const R=()=>ht(I,A,S,P-E+1,u,p,g,_.canonical);for(;E+T<=P;){if(w+=x,w<l||w>=c)return null;if(S=C,I=A,M.push(S),m&&k.push(I),A=new e.Point(h.getx(w),h.gety(w)),C=d[w],!C){const e=ct(A,_.canonical,u,g,p);C=e[3]>0?d[w]=e:R()}E+=T,T=e.distance(S,C)}f&&p&&(d[w]&&(C=R(),T=e.distance(S,C)),d[w]=C);const O=(P-E)/T,N=A.sub(I)._mult(O)._add(I),D=e.sub([],C,S),z=e.scaleAndAdd([],S,D,O);let L=[0,0,1],B=D[0],F=D[1];if(y&&(L=g.upVector(_.canonical,N.x,N.y),0!==L[0]||0!==L[1]||1!==L[2])){const t=[L[2],0,-L[0]],i=e.cross([],L,t);e.normalize(t,t),e.normalize(i,i),B=e.dot(D,t),F=e.dot(D,i)}if(n){const t=e.cross([],L,D);e.normalize(t,t),e.scaleAndAdd(z,z,t,n*x)}const j=b+Math.atan2(F,B);return M.push(z),m&&k.push(N),{point:z,angle:j,path:M,tilePath:k,up:L}}function dt(e,t){const i=t.length,n=i+4*e;t.resize(n),t.float32.fill(-1/0,4*i,4*n)}function pt(e,t,i){const n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e[3]=i[3]*n+i[7]*r+i[15],e}const mt=100;class ft{constructor(e,t,i=new Ye(e.width+200,e.height+200,25),n=new Ye(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=n,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+mt,this.screenBottomBoundary=e.height+mt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,i,n,r,s,o,a){let l=i.projectedAnchorX,c=i.projectedAnchorY,h=i.projectedAnchorZ;const u=i.elevation,d=i.tileID,p=e.getProjection();if(u&&d){const[e,t,n]=p.upVector(d.canonical,i.tileAnchorX,i.tileAnchorY),r=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=e*u*r,c+=t*u*r,h+=n*u*r}const m=this.projectAndGetPerspectiveRatio(o,l,c,h,i.tileID,"globe"===p.name||!!u||this.transform.pitch>0,p),f=s*m.perspectiveRatio,g=(i.x1*t+n.x-i.padding)*f+m.point.x,_=(i.y1*t+n.y-i.padding)*f+m.point.y,y=(i.x2*t+n.x+i.padding)*f+m.point.x,v=(i.y2*t+n.y+i.padding)*f+m.point.y,x=m.perspectiveRatio<=.55||m.occluded;return!this.isInsideGrid(g,_,y,v)||!r&&this.grid.hitTest(g,_,y,v,a)||x?{box:[],offscreen:!1,occluded:m.occluded}:{box:[g,_,y,v],offscreen:this.isOffscreen(g,_,y,v),occluded:!1}}placeCollisionCircles(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f){const g=[],_=this.transform.elevation,y=t.getProjection(),v=_?_.getAtTileOffsetFunc(f,this.transform.center.lat,this.transform.worldSize,y):null,x=new e.Point(n.tileAnchorX,n.tileAnchorY);let{x:b,y:w,z:C}=y.projectTilePoint(x.x,x.y,f.canonical);if(v){const[e,t,i]=v(x);b+=e,w+=t,C+=i}const S="globe"===y.name,E=this.projectAndGetPerspectiveRatio(a,b,w,C,f,S||!!_||this.transform.pitch>0,y),{perspectiveRatio:T}=E,P=(u?o/T:o*T)/e.ONE_EM,M=it(b,w,C,l),k=E.signedDistanceFromCamera>0?ot(P,s,n.lineOffsetX*P,n.lineOffsetY*P,!1,M,x,n,r,l,{},_&&!u?v:null,u&&!!_,y,f,u):null;let A=!1,I=!1,R=!0;if(k&&!E.occluded){const t=.5*p*T+m,n=new e.Point(-100,-100),r=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),s=new Ke,{first:o,last:a}=k,l=o.path.length;let u=[];for(let e=l-1;e>=1;e--)u.push(o.path[e]);for(let e=1;e<a.path.length;e++)u.push(a.path[e]);const f=2.5*t;c&&(u=u.map(([e,t,i],n)=>(v&&!S&&(i=v(n<l-1?o.tilePath[l-1-n]:a.tilePath[n-l+2])[2]),it(e,t,i,c))),u.some(e=>e[3]<=0)&&(u=[]));let _=[];if(u.length>0){let t=1/0,i=-1/0,s=1/0,o=-1/0;for(const e of u)t=Math.min(t,e[0]),s=Math.min(s,e[1]),i=Math.max(i,e[0]),o=Math.max(o,e[1]);i>=n.x&&t<=r.x&&o>=n.y&&s<=r.y&&(_=[u.map(t=>new e.Point(t[0],t[1]))],(t<n.x||i>r.x||s<n.y||o>r.y)&&(_=e.clipLine(_,n.x,n.y,r.x,r.y)))}for(const e of _){s.reset(e,.25*t);let n=0;n=s.length<=.5*t?1:Math.ceil(s.paddedLength/f)+1;for(let e=0;e<n;e++){const r=e/Math.max(n-1,1),o=s.lerp(r),a=o.x+mt,l=o.y+mt;g.push(a,l,t,0);const c=a-t,u=l-t,p=a+t,m=l+t;if(R=R&&this.isOffscreen(c,u,p,m),I=I||this.isInsideGrid(c,u,p,m),!i&&this.grid.hitTestCircle(a,l,t,d)&&(A=!0,!h))return{circles:[],offscreen:!1,collisionDetected:A,occluded:!1}}}}return{circles:!h&&A||!I?[]:g,offscreen:R,collisionDetected:A,occluded:E.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let n=1/0,r=1/0,s=-1/0,o=-1/0;for(const h of t){const t=new e.Point(h.x+mt,h.y+mt);n=Math.min(n,t.x),r=Math.min(r,t.y),s=Math.max(s,t.x),o=Math.max(o,t.y),i.push(t)}const a=this.grid.query(n,r,s,o).concat(this.ignoredGrid.query(n,r,s,o)),l={},c={};for(const h of a){const t=h.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const n=[new e.Point(h.x1,h.y1),new e.Point(h.x2,h.y1),new e.Point(h.x2,h.y2),new e.Point(h.x1,h.y2)];e.polygonIntersectsPolygon(i,n)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,i,n,r){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:n,collisionGroupID:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,i,n,r){const s=t?this.ignoredGrid:this.grid,o={bucketInstanceId:i,featureIndex:n,collisionGroupID:r};for(let a=0;a<e.length;a+=4)s.insertCircle(o,e[a],e[a+1],e[a+2])}projectAndGetPerspectiveRatio(t,i,n,r,s,o,a){const l=[i,n,r,1];let c=!1;r||this.transform.pitch>0?(e.transformMat4$1(l,l,t),this.fogState&&s&&"globe"!==a.name&&(c=function(t,i,n,r,s,o){const a=o.calculateFogTileMatrix(s),l=[i,n,r];return e.transformMat4(l,l,a),E(t,l,o.pitch,o._fov)}(this.fogState,i,n,r,s.toUnwrapped(),this.transform)>.9)):pt(l,l,t);const h=l[3];return{point:new e.Point((l[0]/h+1)/2*this.transform.width+mt,(-l[1]/h+1)/2*this.transform.height+mt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/h*.5,1.5),signedDistanceFromCamera:h,occluded:o&&l[2]>h||c}}isOffscreen(e,t,i,n){return i<mt||e>=this.screenRightBoundary||n<mt||t>this.screenBottomBoundary}isInsideGrid(e,t,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}function gt(t,i,n){const r=i.createTileMatrix(t,t.worldSize,n.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,r)}function _t(e,t,i){if(t.projection.name===i.projection.name)return e.projMatrix;const n=i.clone();return n.setProjection(t.projection),gt(n,t.getProjection(),e)}function yt(e,t,i){return t.name===i.projection.name?e.projMatrix:gt(i,t,e)}class vt{constructor(e,t,i,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class xt{constructor(e,t,i,n,r,s=!1){this.text=new vt(e?e.text:null,t,i,r),this.icon=new vt(e?e.icon:null,t,n,r),this.clipped=s}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bt{constructor(e,t,i,n=!1){this.text=e,this.icon=t,this.skipFade=i,this.clipped=n}}class wt{constructor(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}}class Ct{constructor(e,t,i,n,r){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=r}}class St{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Et(t,i,n,r,s){const{horizontalAlign:o,verticalAlign:a}=e.getAnchorAlignment(t),l=-(o-.5)*i,c=-(a-.5)*n,h=e.evaluateVariableOffset(t,r);return new e.Point(l+h[0]*s,c+h[1]*s)}function Tt(t,i,n,r,s){const o=new e.Point(t,i);return n&&o._rotate(r?s:-s),o}class Pt{constructor(e,t,i,n,r){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new ft(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new St(i),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,i,n,r){const s=n.getBucket(i),o=n.latestFeatureIndex;if(!s||!o||i.id!==s.layerIds[0])return;const a=s.layers[0].layout,l=n.collisionBoxArray,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),h=n.tileSize/e.EXTENT,u=n.tileID.toUnwrapped();this.transform.setProjection(s.projection);const d=(p=n.tileID,m=s.getProjection(),f=this.transform,m.name===this.projection?f.calculateProjMatrix(p.toUnwrapped()):gt(f,m,p));var p,m,f;const g="map"===a.get("text-pitch-alignment"),_="map"===a.get("text-rotation-alignment");i.compileFilter();const y=i.dynamicFilter(),v=i.dynamicFilterNeedsFeature(),x=this.transform.calculatePixelsToTileUnitsMatrix(n),b=et(d,n.tileID.canonical,g,_,this.transform,s.getProjection(),x);let w=null;if(g){const t=tt(d,n.tileID.canonical,g,_,this.transform,s.getProjection(),x);w=e.multiply([],this.transform.labelPlaneMatrix,t)}let C=null;y&&n.latestFeatureIndex&&(C={unwrappedTileID:u,dynamicFilter:y,dynamicFilterNeedsFeature:v,featureIndex:n.latestFeatureIndex}),this.retainedQueryData[s.bucketInstanceId]=new Ct(s.bucketInstanceId,o,s.sourceLayerIndex,s.index,n.tileID);const S={bucket:s,layout:a,posMatrix:d,textLabelPlaneMatrix:b,labelToScreenMatrix:w,clippingData:C,scale:c,textPixelRatio:h,holdingForFade:n.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(s.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(r)for(const e of s.sortKeyRanges){const{sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r}=e;t.push({sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r,parameters:S})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:S})}attemptAnchorPlacement(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_){const{textOffset0:y,textOffset1:v,crossTileID:x}=u,b=[y,v],w=Et(e,i,n,b,r),C=this.collisionIndex.placeCollisionBox(p,r,t,Tt(w.x,w.y,s,o,this.transform.angle),h,a,l,c.predicate);if(f){const e=p.getSymbolInstanceIconSize(_,this.transform.zoom,u.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,e,f,Tt(w.x,w.y,s,o,this.transform.angle),h,a,l,c.predicate).box.length)return}if(C.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[x]&&this.prevPlacement.placements[x]&&this.prevPlacement.placements[x].text&&(t=this.prevPlacement.variableOffsets[x].anchor),this.variableOffsets[x]={textOffset:b,width:i,height:n,anchor:e,textScale:r,prevAnchor:t},this.markUsedJustification(p,e,u,m),p.allowVerticalPlacement&&(this.markUsedOrientation(p,m,u),this.placedOrientations[x]=m),{shift:w,placedGlyphBoxes:C}}}placeLayerBucketPart(t,i,n,r){const{bucket:s,layout:o,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:h,textPixelRatio:u,holdingForFade:d,collisionBoxArray:p,partiallyEvaluatedTextSize:m,partiallyEvaluatedIconSize:f,collisionGroup:g}=t.parameters,_=o.get("text-optional"),y=o.get("icon-optional"),v=o.get("text-allow-overlap"),x=o.get("icon-allow-overlap"),b="map"===o.get("text-rotation-alignment"),w="map"===o.get("text-pitch-alignment"),C="none"!==o.get("icon-text-fit"),S="viewport-y"===o.get("symbol-z-order");this.transform.setProjection(s.projection);let E=v&&(x||!s.hasIconData()||y),T=x&&(v||!s.hasTextData()||_);!s.collisionArrays&&p&&s.deserializeCollisionBoxes(p),n&&r&&s.updateCollisionDebugBuffers(this.transform.zoom,p);const P=(t,r,p)=>{const{crossTileID:S,numVerticalGlyphVertices:P}=t;if(h){const n={zoom:this.transform.zoom,pitch:this.transform.pitch};let r=null;if(h.dynamicFilterNeedsFeature){const e=this.retainedQueryData[s.bucketInstanceId];r=h.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,h.dynamicFilter)(n,r,this.retainedQueryData[s.bucketInstanceId].tileID.canonical,new e.Point(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(h.unwrappedTileID)))return this.placements[S]=new bt(!1,!1,!1,!0),void i.add(S)}if(i.has(S))return;if(d)return void(this.placements[S]=new bt(!1,!1,!1));let M=!1,k=!1,A=!0,I=!1,R=!1,O=null,N={box:null,offscreen:null,occluded:null},D={box:null,offscreen:null,occluded:null},z=null,L=null,B=null,F=0,j=0,V=0;p.textFeatureIndex?F=p.textFeatureIndex:t.useRuntimeCollisionCircles&&(F=t.featureIndex),p.verticalTextFeatureIndex&&(j=p.verticalTextFeatureIndex);const U=e=>{e.tileID=this.retainedQueryData[s.bucketInstanceId].tileID;const t=this.transform.elevation;(t||e.elevation)&&(e.elevation=t?t.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0)},q=p.textBox;if(q){U(q);const i=i=>{let n=e.WritingMode.horizontal;if(s.allowVerticalPlacement&&!i&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[S];e&&(this.placedOrientations[S]=e,n=e,this.markUsedOrientation(s,n,t))}return n},n=(t,i)=>{if(s.allowVerticalPlacement&&P>0&&p.verticalTextBox){for(const n of s.writingModes)if(n===e.WritingMode.vertical?(N=i(),D=N):N=t(),N&&N.box&&N.box.length)break}else N=t()};if(o.get("text-variable-anchor")){let l=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[S]){const e=this.prevPlacement.variableOffsets[S];l.indexOf(e.anchor)>0&&(l=l.filter(t=>t!==e.anchor),l.unshift(e.anchor))}const c=(e,i,n)=>{const o=s.getSymbolInstanceTextSize(m,t,this.transform.zoom,r),c=(e.x2-e.x1)*o+2*e.padding,h=(e.y2-e.y1)*o+2*e.padding,d=C&&!x?i:null;d&&U(d);let p={box:[],offscreen:!1,occluded:!1};const _=v?2*l.length:l.length;for(let y=0;y<_;++y){const i=this.attemptAnchorPlacement(l[y%l.length],e,c,h,o,b,w,u,a,g,y>=l.length,t,r,s,n,d,m,f);if(i&&(p=i.placedGlyphBoxes,p&&p.box&&p.box.length)){M=!0,O=i.shift;break}}return p};n(()=>c(q,p.iconBox,e.WritingMode.horizontal),()=>{const t=p.verticalTextBox;return t&&U(t),s.allowVerticalPlacement&&!(N&&N.box&&N.box.length)&&P>0&&t?c(t,p.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),N&&(M=N.box,A=N.offscreen,I=N.occluded);const h=i(!(!N||!N.box));if(!M&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[S];e&&(this.variableOffsets[S]=e,this.markUsedJustification(s,e.anchor,t,h))}}else{const o=(i,n)=>{const o=s.getSymbolInstanceTextSize(m,t,this.transform.zoom,r),l=this.collisionIndex.placeCollisionBox(s,o,i,new e.Point(0,0),v,u,a,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(s,n,t),this.placedOrientations[S]=n),l};n(()=>o(q,e.WritingMode.horizontal),()=>{const t=p.verticalTextBox;return s.allowVerticalPlacement&&P>0&&t?(U(t),o(t,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),i(!!(N&&N.box&&N.box.length))}}if(z=N,M=z&&z.box&&z.box.length>0,A=z&&z.offscreen,I=z&&z.occluded,t.useRuntimeCollisionCircles){const i=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),r=e.evaluateSizeForFeature(s.textSizeData,m,i),h=o.get("text-padding");L=this.collisionIndex.placeCollisionCircles(s,v,i,s.lineVertexArray,s.glyphOffsetArray,r,a,l,c,n,w,g.predicate,t.collisionCircleDiameter*r/e.ONE_EM,h,this.retainedQueryData[s.bucketInstanceId].tileID),M=v||L.circles.length>0&&!L.collisionDetected,A=A&&L.offscreen,I=L.occluded}if(p.iconFeatureIndex&&(V=p.iconFeatureIndex),p.iconBox){const i=i=>{U(i);const n=C&&O?Tt(O.x,O.y,b,w,this.transform.angle):new e.Point(0,0),r=s.getSymbolInstanceIconSize(f,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(s,r,i,n,x,u,a,g.predicate)};D&&D.box&&D.box.length&&p.verticalIconBox?(B=i(p.verticalIconBox),k=B.box.length>0):(B=i(p.iconBox),k=B.box.length>0),A=A&&B.offscreen,R=B.occluded}const H=_||0===t.numHorizontalGlyphVertices&&0===P,G=y||0===t.numIconVertices;if(H||G?G?H||(k=k&&M):M=k&&M:k=M=k&&M,M&&z&&z.box&&this.collisionIndex.insertCollisionBox(z.box,o.get("text-ignore-placement"),s.bucketInstanceId,D&&D.box&&j?j:F,g.ID),k&&B&&this.collisionIndex.insertCollisionBox(B.box,o.get("icon-ignore-placement"),s.bucketInstanceId,V,g.ID),L&&(M&&this.collisionIndex.insertCollisionCircles(L.circles,o.get("text-ignore-placement"),s.bucketInstanceId,F,g.ID),n)){const e=s.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new wt);for(let i=0;i<L.circles.length;i+=4)t.circles.push(L.circles[i+0]),t.circles.push(L.circles[i+1]),t.circles.push(L.circles[i+2]),t.circles.push(L.collisionDetected?1:0)}const W="globe"!==s.projection.name;E=E&&(W||!I),T=T&&(W||!R),this.placements[S]=new bt(M||E,k||T,A||s.justReloaded),i.add(S)};if(S){const e=s.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];P(s.symbolInstances.get(i),i,s.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)P(s.symbolInstances.get(e),e,s.collisionArrays[e]);if(n&&s.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[s.bucketInstanceId];e.invert(t.invProjMatrix,a),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}markUsedJustification(t,i,n,r){const{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:c}=n,h=e.getAnchorJustification(i),u=r===e.WritingMode.vertical?l:"left"===h?s:"center"===h?o:"right"===h?a:-1;s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=u>=0&&s!==u?0:c),o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=u>=0&&o!==u?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=u>=0&&a!==u?0:c),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=u>=0&&l!==u?0:c)}markUsedOrientation(t,i,n){const r=i===e.WritingMode.horizontal||i===e.WritingMode.horizontalOnly?i:0,s=i===e.WritingMode.vertical?i:0,{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=n,h=t.text.placedSymbolArray;o>=0&&(h.get(o).placedOrientation=r),a>=0&&(h.get(a).placedOrientation=r),l>=0&&(h.get(l).placedOrientation=r),c>=0&&(h.get(c).placedOrientation=s)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let i=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},s=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const a in this.placements){const e=this.placements[a],t=r[a];t?(this.opacities[a]=new xt(t,n,e.text,e.icon,null,e.clipped),i=i||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[a]=new xt(null,n,e.text,e.icon,e.skipFade,e.clipped),i=i||e.text||e.icon)}for(const a in r){const e=r[a];if(!this.opacities[a]){const t=new xt(e,n,!1,!1);t.isHidden()||(this.opacities[a]=t,i=i||e.text.placed||e.icon.placed)}}for(const a in s)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=s[a]);for(const a in o)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=o[a]);i?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const i=new Set;for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,i,n.collisionBoxArray)}}updateBucketOpacities(t,i,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const r=t.layers[0].layout,s=!!t.layers[0].dynamicFilter(),o=new xt(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=r.get("text-variable-anchor"),h="map"===r.get("text-rotation-alignment"),u="map"===r.get("text-pitch-alignment"),d="none"!==r.get("icon-text-fit"),p=new xt(null,0,a&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(a||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const m=(e,t,i)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(i)};let f=0;for(let g=0;g<t.symbolInstances.length;g++){const n=t.symbolInstances.get(g),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:l,numIconVertices:_}=n,y=i.has(l);let v=this.opacities[l];y?v=o:v||(v=p,this.opacities[l]=v),i.add(l);const x=r>0||a>0,b=_>0,w=this.placedOrientations[l],C=w===e.WritingMode.vertical,S=w===e.WritingMode.horizontal||w===e.WritingMode.horizontalOnly;if(!x&&!b||v.isHidden()||f++,x){const e=zt(v.text);m(t.text,r,C?Lt:e),m(t.text,a,S?Lt:e);const i=v.text.isHidden(),{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:h}=n,u=t.text.placedSymbolArray,d=i||C?1:0;s>=0&&(u.get(s).hidden=d),o>=0&&(u.get(o).hidden=d),c>=0&&(u.get(c).hidden=d),h>=0&&(u.get(h).hidden=i||S?1:0);const p=this.variableOffsets[l];p&&this.markUsedJustification(t,p.anchor,n,w);const f=this.placedOrientations[l];f&&(this.markUsedJustification(t,"left",n,f),this.markUsedOrientation(t,f,n))}if(b){const e=zt(v.icon),{placedIconSymbolIndex:i,verticalPlacedIconSymbolIndex:r}=n,s=t.icon.placedSymbolArray,o=v.icon.isHidden()?1:0;i>=0&&(m(t.icon,_,C?Lt:e),s.get(i).hidden=o),r>=0&&(m(t.icon,n.numVerticalIconVertices,S?Lt:e),s.get(r).hidden=o)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const i=t.collisionArrays[g];if(i){let n=new e.Point(0,0),r=!0;if(i.textBox||i.verticalTextBox){if(c){const e=this.variableOffsets[l];e?(n=Et(e.anchor,e.width,e.height,e.textOffset,e.textScale),h&&n._rotate(u?this.transform.angle:-this.transform.angle)):r=!1}s&&(r=!v.clipped),i.textBox&&Mt(t.textCollisionBox.collisionVertexArray,v.text.placed,!r||C,n.x,n.y),i.verticalTextBox&&Mt(t.textCollisionBox.collisionVertexArray,v.text.placed,!r||S,n.x,n.y)}const o=r&&Boolean(!S&&i.verticalIconBox);i.iconBox&&Mt(t.iconCollisionBox.collisionVertexArray,v.icon.placed,o,d?n.x:0,d?n.y:0),i.verticalIconBox&&Mt(t.iconCollisionBox.collisionVertexArray,v.icon.placed,!o,d?n.x:0,d?n.y:0)}}}if(t.fullyClipped=0===f,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const i=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function Mt(e,t,i,n,r){e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0)}const kt=Math.pow(2,25),At=Math.pow(2,24),It=Math.pow(2,17),Rt=Math.pow(2,16),Ot=Math.pow(2,9),Nt=Math.pow(2,8),Dt=Math.pow(2,1);function zt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*kt+t*At+i*It+t*Rt+i*Ot+t*Nt+i*Dt+t}const Lt=0;class Bt{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,t,i,n,r){const s=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(s,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((e,t)=>e.sortKey-t.sortKey));this._currentPartIndex<s.length;){const e=s[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,i,0===e.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}class Ft{constructor(e,t,i,n,r,s,o,a){this.placement=new Pt(e,r,s,o,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(t,i,n){const r=e.exported.now(),s=()=>{const t=e.exported.now()-r;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const e=i[t[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=r)&&(!e.maxzoom||e.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Bt(e)),this._inProgressLayer.continuePlacement(n[e.source],this.placement,this._showCollisionBoxes,e,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const jt=512/e.EXTENT/2;class Vt{constructor(t,i,n){this.tileID=t,this.bucketInstanceId=n,this.index=new e.KDBush(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const r=t.canonical.x*e.EXTENT,s=t.canonical.y*e.EXTENT;for(let e=0;e<i.length;e++){const{key:t,crossTileID:n,tileAnchorX:o,tileAnchorY:a}=i.get(e),l=Math.floor((r+o)*jt),c=Math.floor((s+a)*jt);this.index.add(l,c),this.keys.push(t),this.crossTileIDs.push(n)}this.index.finish()}findMatches(t,i,n){const r=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),s=jt/Math.pow(2,i.canonical.z-this.tileID.canonical.z),o=i.canonical.x*e.EXTENT,a=i.canonical.y*e.EXTENT;for(let e=0;e<t.length;e++){const i=t.get(e);if(i.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:h}=i,u=Math.floor((o+c)*s),d=Math.floor((a+h)*s),p=this.index.range(u-r,d-r,u+r,d+r);for(const e of p){const t=this.crossTileIDs[e];if(this.keys[e]===l&&!n.has(t)){n.add(t),i.crossTileID=t;break}}}}}class Ut{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const i in this.indexes){const e=this.indexes[i],n={};for(const i in e){const r=e[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),n[r.tileID.key]=r}this.indexes[i]=n}this.lng=e}addBucket(e,t,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const s=i[r];s.tileID.isChildOf(e)&&s.findMatches(t.symbolInstances,e,n)}else{const s=i[e.scaledTo(Number(r)).key];s&&s.findMatches(t.symbolInstances,e,n)}}for(let r=0;r<t.symbolInstances.length;r++){const e=t.symbolInstances.get(r);e.crossTileID||(e.crossTileID=i.generate(),n.add(e.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Vt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const i of t.crossTileIDs)this.usedCrossTileIDs[e].delete(i)}removeStaleBuckets(e){let t=!1;for(const i in this.indexes){const n=this.indexes[i];for(const r in n)e[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],t=!0)}return t}}class Ht{constructor(){this.layerIndexes={},this.crossTileIDs=new Ut,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,i,n){let r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new qt);let s=!1;const o={};"globe"!==n.name&&r.handleWrapJump(i);for(const a of t){const t=a.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(a.tileID,t,this.crossTileIDs)&&(s=!0),o[t.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(s=!0),s}pruneUnusedLayers(e){const t={};e.forEach(e=>{t[e]=!0});for(const i in this.layerIndexes)t[i]||delete this.layerIndexes[i]}}const Gt=(t,i)=>e.emitValidationErrors(t,i&&i.filter(e=>"source.canvas"!==e.identifier)),Wt=e.pick(Ue,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zt=e.pick(Ue,["setCenter","setZoom","setBearing","setPitch"]),$t={version:8,layers:[],sources:{}},Xt={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Kt extends e.Evented{constructor(t,i={}){super(),this.map=t,this.dispatcher=new k(Fe(),this),this.imageManager=new x,this.imageManager.setEventedParent(this),this.glyphManager=new e.GlyphManager(t._requestManager,i.localFontFamily?e.LocalGlyphMode.all:i.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,i.localFontFamily||i.localIdeographFontFamily),this.crossTileSymbolIndex=new Ht,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());const n=this;this._rtlTextPluginCallback=Kt.registerForPluginStateChange(t=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(t,i)=>{if(e.triggerPluginCompletionEvent(t),i&&i.every(e=>e))for(const e in n._sourceCaches){const t=n._sourceCaches[e],i=t.getSource().type;"vector"!==i&&"geojson"!==i||t.reload()}})}),this.on("data",e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(const i in this._layers){const e=this._layers[i];e.source===t.id&&this._validateLayer(e)}})}loadURL(t,i={}){this.fire(new e.Event("dataloading",{dataType:"style"}));const n="boolean"==typeof i.validate?i.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,i.accessToken);const r=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(r,(t,i)=>{this._request=null,t?this.fire(new e.ErrorEvent(t)):i&&this._load(i,n)})}loadJSON(t,i={}){this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame(()=>{this._request=null,this._load(t,!1!==i.validate)})}loadEmpty(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load($t,!1)}_updateLayerCount(e,t){const i=t?1:-1;e.is3D()&&(this._num3DLayers+=i),"circle"===e.type&&(this._numCircleLayers+=i),"symbol"===e.type&&(this._numSymbolLayers+=i)}_load(t,i){if(i&&Gt(this,e.validateStyle(t)))return;this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection();for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const n=Ve(this.stylesheet.layers);this._order=n.map(e=>e.id),this._layers={},this._serializedLayers={};for(const r of n){const t=e.createStyleLayer(r);t.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=t,this._serializedLayers[t.id]=t.serialize(),this._updateLayerCount(t,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(t,i,n){let r,s,o;const a=e.exported.devicePixelRatio>1?"@2x":"";let l=e.getJSON(i.transformRequest(i.normalizeSpriteURL(t,a,".json"),e.ResourceType.SpriteJSON),(e,t)=>{l=null,o||(o=e,r=t,h())}),c=e.getImage(i.transformRequest(i.normalizeSpriteURL(t,a,".png"),e.ResourceType.SpriteImage),(e,t)=>{c=null,o||(o=e,s=t,h())});function h(){if(o)n(o);else if(r&&s){const t=e.exported.getImageData(s),i={};for(const n in r){const{width:s,height:o,x:a,y:l,sdf:c,pixelRatio:h,stretchX:u,stretchY:d,content:p}=r[n],m=new e.RGBAImage({width:s,height:o});e.RGBAImage.copy(t,m,{x:a,y:l},{x:0,y:0},{width:s,height:o}),i[n]={data:m,pixelRatio:h,sdf:c,stretchX:u,stretchY:d,content:p}}n(null,i)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,(t,i)=>{if(this._spriteRequest=null,t)this.fire(new e.ErrorEvent(t));else if(i)for(const e in i)this.imageManager.addImage(e,i[e]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new e.Event("data",{dataType:"style"}))})}_validateLayer(t){const i=this.getSource(t.source);if(!i)return;const n=t.sourceLayer;n&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(e){const t=[];for(const i of e){const e=this._layers[i];"custom"!==e.type&&t.push(e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&("function"==typeof e.isLayerDraped?e.isLayerDraped():Xt[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const i=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const n in this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const n={};for(const e in this._sourceCaches){const t=this._sourceCaches[e];n[e]=t.used,t.used=!1}for(const e of this._order){const i=this._layers[e];if(i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)){const e=this._getLayerSourceCache(i);e&&(e.used=!0)}const n=this.map.painter;if(n){const e=i.getProgramIds();if(!e)continue;const r=i.getProgramConfiguration(t.zoom);for(const t of e)n.useProgram(t,r)}}for(const r in n){const t=this._sourceCaches[r];n[r]!==t.used&&t.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new e.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Gt(this,e.validateStyle(i)))return!1;(i=e.clone$1(i)).layers=Ve(i.layers);const n=function(e,i){if(!e)return[{command:Ue.setStyle,args:[i]}];let n=[];try{if(!t(e.version,i.version))return[{command:Ue.setStyle,args:[i]}];t(e.center,i.center)||n.push({command:Ue.setCenter,args:[i.center]}),t(e.zoom,i.zoom)||n.push({command:Ue.setZoom,args:[i.zoom]}),t(e.bearing,i.bearing)||n.push({command:Ue.setBearing,args:[i.bearing]}),t(e.pitch,i.pitch)||n.push({command:Ue.setPitch,args:[i.pitch]}),t(e.sprite,i.sprite)||n.push({command:Ue.setSprite,args:[i.sprite]}),t(e.glyphs,i.glyphs)||n.push({command:Ue.setGlyphs,args:[i.glyphs]}),t(e.transition,i.transition)||n.push({command:Ue.setTransition,args:[i.transition]}),t(e.light,i.light)||n.push({command:Ue.setLight,args:[i.light]}),t(e.fog,i.fog)||n.push({command:Ue.setFog,args:[i.fog]}),t(e.projection,i.projection)||n.push({command:Ue.setProjection,args:[i.projection]});const r={},s=[];!function(e,i,n,r){let s;for(s in i=i||{},e=e||{})e.hasOwnProperty(s)&&(i.hasOwnProperty(s)||He(s,n,r));for(s in i){if(!i.hasOwnProperty(s))continue;const o=i[s];e.hasOwnProperty(s)?t(e[s],o)||("geojson"===e[s].type&&"geojson"===o.type&&We(e,i,s)?n.push({command:Ue.setGeoJSONSourceData,args:[s,o.data]}):Ge(s,i,n,r)):qe(s,i,n)}}(e.sources,i.sources,s,r);const o=[];e.layers&&e.layers.forEach(e=>{e.source&&r[e.source]?n.push({command:Ue.removeLayer,args:[e.id]}):o.push(e)});let a=e.terrain;a&&r[a.source]&&(n.push({command:Ue.setTerrain,args:[void 0]}),a=void 0),n=n.concat(s),t(a,i.terrain)||n.push({command:Ue.setTerrain,args:[i.terrain]}),function(e,i,n){i=i||[];const r=(e=e||[]).map($e),s=i.map($e),o=e.reduce(Xe,{}),a=i.reduce(Xe,{}),l=r.slice(),c=Object.create(null);let h,u,d,p,m,f,g;for(h=0,u=0;h<r.length;h++)d=r[h],a.hasOwnProperty(d)?u++:(n.push({command:Ue.removeLayer,args:[d]}),l.splice(l.indexOf(d,u),1));for(h=0,u=0;h<s.length;h++)d=s[s.length-1-h],l[l.length-1-h]!==d&&(o.hasOwnProperty(d)?(n.push({command:Ue.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-u),1)):u++,f=l[l.length-h],n.push({command:Ue.addLayer,args:[a[d],f]}),l.splice(l.length-h,0,d),c[d]=!0);for(h=0;h<s.length;h++)if(d=s[h],p=o[d],m=a[d],!c[d]&&!t(p,m))if(t(p.source,m.source)&&t(p["source-layer"],m["source-layer"])&&t(p.type,m.type)){for(g in Ze(p.layout,m.layout,n,d,null,Ue.setLayoutProperty),Ze(p.paint,m.paint,n,d,null,Ue.setPaintProperty),t(p.filter,m.filter)||n.push({command:Ue.setFilter,args:[d,m.filter]}),t(p.minzoom,m.minzoom)&&t(p.maxzoom,m.maxzoom)||n.push({command:Ue.setLayerZoomRange,args:[d,m.minzoom,m.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Ze(p[g],m[g],n,d,g.slice(6),Ue.setPaintProperty):t(p[g],m[g])||n.push({command:Ue.setLayerProperty,args:[d,g,m[g]]}));for(g in m)m.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Ze(p[g],m[g],n,d,g.slice(6),Ue.setPaintProperty):t(p[g],m[g])||n.push({command:Ue.setLayerProperty,args:[d,g,m[g]]}))}else n.push({command:Ue.removeLayer,args:[d]}),f=l[l.lastIndexOf(d)+1],n.push({command:Ue.addLayer,args:[m,f]})}(o,i.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:Ue.setStyle,args:[i]}]}return n}(this.serialize(),i).filter(e=>!(e.command in Zt));if(0===n.length)return!1;const r=n.filter(e=>!(e.command in Wt));if(r.length>0)throw new Error(`Unimplemented: ${r.map(e=>e.command).join(", ")}.`);return n.forEach(e=>{"setTransition"!==e.command&&"setProjection"!==e.command&&this[e.command].apply(this,e.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(t,i){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,i),this._afterImageUpdated(t),this)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,i,n={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(e.validateSource,"sources."+t,i,null,n))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const r=Ae(t,i,this.dispatcher,this);r.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:r.serialize(),sourceId:t}));const s=i=>{const n=(i?"symbol:":"other:")+t,s=this._sourceCaches[n]=new e.SourceCache(n,r,i);(i?this._symbolSourceCaches:this._otherSourceCaches)[t]=s,s.style=this,s.onAdd(this.map)};s(!1),"vector"!==i.type&&"geojson"!==i.type||s(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const i=this.getSource(t);if(!i)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${r}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const n=this._getSourceCaches(t);for(const r of n)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}getSource(e){const t=this._getSourceCache(e);return t&&t.getSource()}_getSources(){const e=[];for(const t in this._otherSourceCaches){const i=this._getSourceCache(t);i&&e.push(i.getSource())}return e}addLayer(t,i,n={}){this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${r}" already exists on this map`)));let s;if("custom"===t.type){if(Gt(this,e.validateCustomStyleLayer(t)))return;s=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=e.clone$1(t),t=e.extend(t,{source:r})),this._validate(e.validateLayer,"layers."+r,t,{arrayIndex:-1},n))return;s=e.createStyleLayer(t),this._validateLayer(s),s.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}const o=i?this._order.indexOf(i):this._order.length;if(i&&-1===o)return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${i}" does not exist on this map.`)));this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=s;const a=this._getLayerSourceCache(s);if(this._removedLayers[r]&&s.source&&a&&"custom"!==s.type){const e=this._removedLayers[r];delete this._removedLayers[r],e.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",a.pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,i){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===i)return;const n=this._order.indexOf(t);this._order.splice(n,1);const r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new e.ErrorEvent(new Error(`Layer with id "${i}" does not exist on this map.`))):(this._order.splice(r,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const i=this._layers[t];if(!i)return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));i.setEventedParent(null),this._updateLayerCount(i,!1);const n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=i,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],i.onRemove&&i.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(e){return this._layers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(t,i,n){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===i&&r.maxzoom===n||(null!=i&&(r.minzoom=i),null!=n&&(r.maxzoom=n),this._updateLayer(r)):this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,n,r={}){this._checkLoaded();const s=this.getLayer(i);if(s){if(!t(s.filter,n))return null==n?(s.filter=void 0,void this._updateLayer(s)):void(this._validate(e.validateFilter,`layers.${s.id}.filter`,n,{layerType:s.type},r)||(s.filter=e.clone$1(n),this._updateLayer(s)))}else this.fire(new e.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const i=this.getLayer(t);return i&&e.clone$1(i.filter)}setLayoutProperty(i,n,r,s={}){this._checkLoaded();const o=this.getLayer(i);o?t(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,s),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,i){const n=this.getLayer(t);if(n)return n.getLayoutProperty(i);this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(i,n,r,s={}){this._checkLoaded();const o=this.getLayer(i);o?t(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,s)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new e.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(e,t){const i=this.getLayer(e);return i&&i.getPaintProperty(t)}setFeatureState(t,i){this._checkLoaded();const n=t.source,r=t.sourceLayer,s=this.getSource(n);if(!s)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const o=s.type;if("geojson"===o&&r)return void this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===o&&!r)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(n);for(const e of a)e.setFeatureState(r,t.id,i)}removeFeatureState(t,i){this._checkLoaded();const n=t.source,r=this.getSource(n);if(!r)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const s=r.type,o="vector"===s?t.sourceLayer:void 0;if("vector"===s&&!o)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(n);for(const e of a)e.removeFeatureState(o,t.id,i)}getFeatureState(t){this._checkLoaded();const i=t.source,n=t.sourceLayer,r=this.getSource(i);if(r){if("vector"!==r.type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(i)[0].getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const e in this._sourceCaches){const i=this._sourceCaches[e].getSource();t[i.id]||(t[i.id]=i.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},e=>void 0!==e)}_updateLayer(e){this._updatedLayers[e.id]=!0;const t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,i={},n=[];for(let s=this._order.length-1;s>=0;s--){const r=this._order[s];if(t(r)){i[r]=s;for(const t of e){const e=t[r];if(e)for(const t of e)n.push(t)}}}n.sort((e,t)=>t.intersectionZ-e.intersectionZ);const r=[];for(let s=this._order.length-1;s>=0;s--){const o=this._order[s];if(t(o))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(i[t.layer.id]<s)break;r.push(t),n.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)r.push(t.feature)}}return r}queryRenderedFeatures(t,i,n){i&&i.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",i.filter,null,i);const r={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const t of i.layers){const i=this._layers[t];if(!i)return this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];r[i.source]=!0}}const s=[];i.availableImages=this._availableImages;const o=i&&i.layers?i.layers.some(e=>{const t=this.getLayer(e);return t&&t.is3D()}):this.has3DLayers(),a=I.createFromScreenPoints(t,n);for(const e in this._sourceCaches){const t=this._sourceCaches[e].getSource().id;i.layers&&!r[t]||s.push(Re(this._sourceCaches[e],this._layers,this._serializedLayers,a,i,n,o,!!this.map._showQueryGeometry))}return this.placement&&s.push(function(e,t,i,n,r,s,o){const a={},l=s.queryRenderedSymbols(n),c=[];for(const h of Object.keys(l).map(Number))c.push(o[h]);c.sort(Ne);for(const h of c){const i=h.featureIndex.lookupSymbolFeatures(l[h.bucketInstanceId],t,h.bucketIndex,h.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(const e in i){const t=a[e]=a[e]||[],n=i[e];n.sort((e,t)=>{const i=h.featureSortOrder;if(i){const n=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex});for(const e of n)t.push(e)}}for(const h in a)a[h].forEach(t=>{const n=t.feature,r=i(e[h]);if(!r)return;const s=r.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=s});return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(t,i){i&&i.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",i.filter,null,i);const n=this._getSourceCaches(t);let r=[];for(const e of n)r=r.concat(Oe(e,i));return r}addSourceType(e,t,i){return Kt.getSourceType(e)?i(new Error(`A source type called "${e}" already exists.`)):(Kt.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const n=this.light.getLight();let r=!1;for(const o in e)if(!t(e[o],n[o])){r=!0;break}if(!r)return;const s=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,i),this.light.updateTransitions(s)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,n=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let r=i;if(1===n){if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.clone$1(r),r=e.extend(r,{source:t})}if(this._validate(e.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&n!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,n)}else{const i=this.terrain,n=i.get();for(const t of Object.keys(e.spec.terrain))!r.hasOwnProperty(t)&&e.spec.terrain[t].default&&(r[t]=e.spec.terrain[t].default);for(const e in r)if(!t(r[e],n[e])){i.set(r),this.stylesheet.terrain=r;const e=this._setTransitionParameters({duration:0});i.updateTransitions(e);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new M(e,this.map.transform);this.stylesheet.fog=e;const i=this._setTransitionParameters({duration:0});t.updateTransitions(i)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const e of this.map._markers)e._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog,n=i.get();0===Object.keys(e).length&&i.set(e);for(const r in e)if(!t(e[r],n[r])){i.set(e),this.stylesheet.fog=e;const t=this._setTransitionParameters({duration:0});i.updateTransitions(t);break}}else this._createFog(e);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=this._order.filter(e=>this.isLayerDraped(this._layers[e])),t=this._order.filter(e=>!this.isLayerDraped(this._layers[e]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const i=this.terrain=new S(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const n=this._setTransitionParameters({duration:0});i.updateTransitions(n)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,i,n,r,s={}){return(!s||!1!==s.validate)&&Gt(this,t.call(e.validateStyle,e.extend({key:i,style:this.serialize(),value:n,styleSpec:e.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const t=this._getSourceCaches(e);for(const i of t)i.clearTiles()}_reloadSource(e){const t=this._getSourceCaches(e);for(const i of t)i.resume(),i.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const t in this._sourceCaches)this._sourceCaches[t].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,i,n,r,s=!1){let o=!1,a=!1;const l={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!l[i.source]){const e=this._getLayerSourceCache(i);if(!e)continue;l[i.source]=e.getRenderableIds(!0).map(t=>e.getTileByID(t)).sort((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(i,l[i.source],t.center.lng,t.projection);o=o||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new Ft(t,this._order,s,i,n,r,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,i){this.imageManager.getImages(t.icons,i),this._updateTilesForChangedImages();const n=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};n(this._otherSourceCaches[t.source]),n(this._symbolSourceCaches[t.source])}getGlyphs(e,t,i){this.glyphManager.getGlyphs(t.stacks,i)}getResource(t,i,n){return e.makeRequest(i,n)}_getSourceCache(e){return this._otherSourceCaches[e]}_getLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const i=this._getSourceCaches(t);return 0===i.length?(this.fire(new e.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):i.every(e=>e.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Kt.getSourceType=function(e){return ke[e]},Kt.setSourceType=function(e,t){ke[e]=t},Kt.registerForPluginStateChange=e.registerForPluginStateChange;var Yt="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Jt="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Qt="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",ei="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ti="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let ii={},ni={};const ri=[];ci(Yt,ri),ci(Qt,ri),ci(ei,ri),ci(ti,ri),ii=hi("",Qt),ni=hi(ti,ei);const si=hi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),oi=Yt,ai="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var li={background:hi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Jt),skyboxGradient:hi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Jt),skyboxCapture:hi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ci(e,t){const i=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let n of i)if(n=n.trim(),"#"===n[0]&&n.includes("if")&&!n.includes("endif")){n=n.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=n.split(" ");for(const i of e)t.includes(i)||t.push(i)}}function hi(e,t){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),r={},s=[...ri];return ci(e,s),ci(t,s),{fragmentSource:e=e.replace(i,(e,t,i,n,s)=>(r[s]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${s}\nvarying ${i} ${n} ${s};\n#else\nuniform ${i} ${n} u_${s};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${s}\n    ${i} ${n} ${s} = u_${s};\n#endif\n`)),vertexSource:t=t.replace(i,(e,t,i,n,s)=>{const o="float"===n?"vec2":"vec4",a=s.match(/color/)?"color":o;return r[s]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${s}\nuniform lowp float u_${s}_t;\nattribute ${i} ${o} a_${s};\nvarying ${i} ${n} ${s};\n#else\nuniform ${i} ${n} u_${s};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${s}\n    ${s} = a_${s};\n#else\n    ${i} ${n} ${s} = u_${s};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${s}\n    ${s} = unpack_mix_${a}(a_${s}, u_${s}_t);\n#else\n    ${i} ${n} ${s} = u_${s};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${s}\nuniform lowp float u_${s}_t;\nattribute ${i} ${o} a_${s};\n#else\nuniform ${i} ${n} u_${s};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${s}\n    ${i} ${n} ${s} = a_${s};\n#else\n    ${i} ${n} ${s} = u_${s};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${s}\n    ${i} ${n} ${s} = unpack_mix_${a}(a_${s}, u_${s}_t);\n#else\n    ${i} ${n} ${s} = u_${s};\n#endif\n`}),staticAttributes:n,usedDefines:s}}class ui{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,i,n,r,s,o){this.context=e;let a=this.boundPaintVertexBuffers.length!==n.length;for(let c=0;!a&&c<n.length;c++)this.boundPaintVertexBuffers[c]!==n[c]&&(a=!0);let l=this.boundDynamicVertexBuffers.length!==o.length;for(let c=0;!l&&c<o.length;c++)this.boundDynamicVertexBuffers[c]!==o[c]&&(l=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==i||a||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==s)this.freshBind(t,i,n,r,s,o);else{e.bindVertexArrayOES.set(this.vao);for(const e of o)e&&e.bind();r&&r.dynamicDraw&&r.bind()}}freshBind(e,t,i,n,r,s){let o;const a=e.numAttributes,l=this.context,c=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),o=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffers=s;else{o=l.currentNumAttributes||0;for(let e=a;e<o;e++)c.disableVertexAttribArray(e)}t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,r);for(const h of i)h.enableAttributes(c,e),h.bind(),h.setVertexAttribPointers(c,e,r);for(const h of s)h&&(h.enableAttributes(c,e),h.bind(),h.setVertexAttribPointers(c,e,r));n&&n.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function di(t,i){const n=Math.pow(2,i.canonical.z),r=i.canonical.y;return[new e.MercatorCoordinate(0,r/n).toLngLat().lat,new e.MercatorCoordinate(0,(r+1)/n).toLngLat().lat]}function pi(t,i,n,r,s,o,a){const l=t.context,c=l.gl,h=n.fbo;if(!h)return;t.prepareDrawTile();const u=t.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,h.colorAttachment.get());const d=((e,t,i,n)=>{const r=i.paint.get("hillshade-shadow-color"),s=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color");let a=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(a-=e.transform.angle);const l=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:di(0,t.tileID),u_light:[i.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:s,u_accent:o}})(t,n,r,t.terrain?i.projMatrix:null);t.prepareDrawProgram(l,u,i.toUnwrapped());const{tileBoundsBuffer:p,tileBoundsIndexBuffer:m,tileBoundsSegments:f}=t.getTileBoundsBuffers(n);u.draw(l,c.TRIANGLES,s,o,a,e.CullFaceMode.disabled,d,r.id,p,m,f)}function mi(t,i,n){if(!i.needsDEMTextureUpload)return;const r=t.context,s=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(n.stride);const o=n.getPixels();i.demTexture?i.demTexture.update(o,{premultiply:!1}):i.demTexture=new e.Texture(r,o,s.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function fi(t,i,n,r,s,o){const a=t.context,l=a.gl;if(!i.dem)return;const c=i.dem;if(a.activeTexture.set(l.TEXTURE1),mi(t,i,c),!i.demTexture)return;i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const h=c.dim;a.activeTexture.set(l.TEXTURE0);let u=i.fbo;if(!u){const t=new e.Texture(a,{width:h,height:h,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),u=i.fbo=a.createFramebuffer(h,h,!0),u.colorAttachment.set(t.texture)}a.bindFramebuffer.set(u.framebuffer),a.viewport.set([0,0,h,h]);const{tileBoundsBuffer:d,tileBoundsIndexBuffer:p,tileBoundsSegments:m}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,s,o,e.CullFaceMode.disabled,((t,i)=>{const n=i.stride,r=e.create();return e.ortho(r,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(r,r,[0,-e.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:i.unpackVector}})(i.tileID,c),n.id,d,p,m),i.needsHillshadePrepare=!1}const gi=t=>({u_matrix:new e.UniformMatrix4f(t),u_image0:new e.Uniform1i(t),u_skirt_height:new e.Uniform1f(t)}),_i=(e,t)=>({u_matrix:e,u_image0:0,u_skirt_height:t}),yi=(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(n),u_merc_matrix:i,u_zoom_transition:r,u_merc_center:s,u_image0:0,u_frustum_tl:o,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:h,u_globe_radius:u,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p});function vi(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const xi=new class{constructor(){this.operations={}}newMorphing(e,t,i,n,r){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==i.tileID.key&&(t.queued=i)}else this.operations[e]={startTime:n,phase:0,duration:r,from:t,to:i,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const i=this.operations[t];for(i.phase=(e-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},bi={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function wi(e){return 6*Math.pow(1.5,22-e)}function Ci(e,t){const i=1<<e.z;return!t&&(0===e.x||e.x===i-1)||0===e.y||e.y===i-1}const Si=e=>({u_matrix:e});function Ei(t,i,n,r,s){if(s>0){const o=e.exported.now(),a=(o-t.timeAdded)/s,l=i?(o-i.timeAdded)/s:-1,c=n.getSource(),h=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),u=!i||Math.abs(i.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),d=u&&t.refreshedUponExpiration?1:e.clamp(u?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class Ti extends e.SourceCache{constructor(e){const t={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new k(Fe(),null),n=Ae("mock-dem",t,i,e.style);super("mock-dem",n,!1),n.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class Pi extends e.SourceCache{constructor(e){const t=Ae("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new k(Fe(),null),e.style);super("proxy",t,!1),t.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,i,n){if(t.freezeTileCoverage)return;this.transform=t;const r=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((i,n)=>{if(i[n.key]="",!this._tiles[n.key]){const i=new e.Tile(n,this._source.tileSize*n.overscaleFactor(),t.tileZoom);i.state="loaded",this._tiles[n.key]=i}return i},{});for(const e in this._tiles)e in r||(this.freeFBO(e),this._tiles[e].unloadVectorData(),delete this._tiles[e])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const i=Object.values(t);this.renderCachePool.push(...i),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach(e=>e.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mi extends e.OverscaledTileID{constructor(e,t,i){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=i}}class ki extends e.Elevation{constructor(t,i){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[n,r,s]=function(t){const i=new e.StructArrayLayout2i4,n=new e.StructArrayLayout3ui6,r=131;i.reserve(17161),n.reserve(33800);const s=e.EXTENT/128,o=e.EXTENT+s/2,a=o+s;for(let c=-s;c<a;c+=s)for(let t=-s;t<a;t+=s){const n=t<0||t>o||c<0||c>o?24575:0,r=e.clamp(Math.round(t),0,e.EXTENT),s=e.clamp(Math.round(c),0,e.EXTENT);i.emplaceBack(r+n,s)}const l=(e,t)=>{const i=t*r+e;n.emplaceBack(i+1,i,i+r),n.emplaceBack(i+r,i+r+1,i+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)l(t,e);return[0,129].forEach(e=>{for(let t=0;t<130;t++)l(t,e),l(e,t)}),[i,n,32768]}(),o=t.context;this.gridBuffer=o.createVertexBuffer(n,e.posAttributes.members),this.gridIndexBuffer=o.createIndexBuffer(r),this.gridSegments=e.SegmentVector.simpleSegment(0,0,n.length,r.length),this.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,n.length,s),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Pi(i.map),this.orthoMatrix=e.create(),e.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.EXTENT,0,e.EXTENT,0,1);const a=o.gl;this._overlapStencilMode=new e.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ti(i.map)}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,i,n){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const r=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const s=()=>{this.sourceCache.used&&e.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const t=this.getScaledDemTileSize();this.sourceCache.update(i,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,s(),this._initializing=!0),s(),i.updateElevation(!0,n),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(e=>e.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,n=this.painter.transform;this._initializing&&(this._initializing=0===n._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(n.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=i.getIds().map(e=>{const t=i.getTileByID(e).tileID;return t.projMatrix=n.calculateProjMatrix(t.toUnwrapped()),t});!function(t,i){const n=i.transform.pointCoordinate(i.transform.getCameraPoint()),r=new e.Point(n.x,n.y);t.sort((t,i)=>{if(i.overscaledZ-t.overscaledZ)return i.overscaledZ-t.overscaledZ;const n=new e.Point(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),s=new e.Point(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),o=r.mult(1<<t.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(n)-o.distSqr(s)})}(r,this.painter),this._previousZoom=n.zoom;const s=this.proxyToSource||{};this.proxyToSource={},r.forEach(e=>{this.proxyToSource[e.key]={}}),this.terrainTileForTile={};const o=this._style._sourceCaches;for(const e in o){const i=o[e];if(!i.used)continue;if(i!==this.sourceCache&&this.resetTileLookupCache(i.id),this._setupProxiedCoordsForOrtho(i,t[e],s),i.usedForTerrain)continue;const n=t[e];i.getSource().reparseOverscaled&&this._assignTerrainTiles(n)}this.proxiedCoords[i.id]=r.map(e=>new Mi(e,e.key,this.orthoMatrix)),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(s),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();const a={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const i=t.tileID.key;i in a||(this._visibleDemTiles.push(t),a[i]=i)}}_assignTerrainTiles(e){this._initializing||e.forEach(e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)})}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const i in this.terrainTileForTile){const n=this.terrainTileForTile[i],r=n.dem;!r||n.demTexture&&!n.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),mi(this.painter,n,r))}}_prepareDemTileUniforms(e,t,i,n){if(!t||null==t.demTexture)return!1;const r=e.tileID.canonical,s=Math.pow(2,t.tileID.canonical.z-r.z),o=n||"";return i["u_dem_tl"+o]=[r.x*s%1,r.y*s%1],i["u_dem_scale"+o]=s,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,i=t.gl;if(!this._emptyDepthBufferTexture){const n=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,n,i.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const t=this._visibleDemTiles.reduce((t,i)=>{if(!i.dem)return t;const n=i.dem.tree.minimums[0];return n>0&&e++,t+n},0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,i=t.gl;t.activeTexture.set(i.TEXTURE2);const n=this._getLoadedAreaMinimum(),r=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(n,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let s=this._emptyDEMTexture;return s?s.update(r,{premultiply:!1}):s=this._emptyDEMTexture=new e.Texture(t,r,i.RGBA,{premultiply:!1}),s}setupElevationDraw(t,i,n){const r=this.painter.context,s=r.gl,o=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;o.u_dem_size=this.sourceCache.getSource().tileSize,o.u_exaggeration=this.exaggeration();let l=null,c=null,h=1;if(n&&n.morphing&&this._useVertexMorphing){const e=n.morphing.srcDemTile,i=n.morphing.dstDemTile;h=n.morphing.phase,e&&i&&(this._prepareDemTileUniforms(t,e,o,"_prev")&&(c=e),this._prepareDemTileUniforms(t,i,o)&&(l=i))}if(c&&l?(r.activeTexture.set(s.TEXTURE2),l.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),r.activeTexture.set(s.TEXTURE4),c.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),o.u_dem_lerp=h):(l=this.terrainTileForTile[t.tileID.key],r.activeTexture.set(s.TEXTURE2),(this._prepareDemTileUniforms(t,l,o)?l.demTexture:this.emptyDEMTexture).bind(s.NEAREST,s.CLAMP_TO_EDGE)),r.activeTexture.set(s.TEXTURE3),n&&n.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),this._depthFBO&&(o.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),o.u_depth_size_inv=[1,1]),n&&n.useMeterToDem&&l){const t=(1<<l.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;o.u_meter_to_dem=t}if(n&&n.labelPlaneMatrixInv&&(o.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),i.setTerrainUniformValues(r,o),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,n&&n.useDenormalizedUpVectorScale);i.setGlobeUniformValues(r,e)}}globeUniformValues(t,i,n){const r=t.projection;return{u_tile_tl_up:r.upVector(i,0,0),u_tile_tr_up:r.upVector(i,e.EXTENT,0),u_tile_br_up:r.upVector(i,e.EXTENT,e.EXTENT),u_tile_bl_up:r.upVector(i,0,e.EXTENT),u_tile_up_scale:n?e.globeMetersToEcef(1):r.upVectorScale(i,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const i=this.painter,n=this.painter.context;0!==t.length&&(n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,i,n,r,s){if("globe"===t.transform.projection.name)!function(t,i,n,r,s){const o=t.context,a=o.gl;let l,c;const h=t.options.showTerrainWireframe?2:0,u=t.transform,d=e.globeUseCustomAntiAliasing(t,o,u),p=(e,i)=>{if(c===e)return;const n=[bi[e],"PROJECTION_GLOBE_VIEW"];d&&n.push("CUSTOM_ANTIALIASING"),i&&n.push(bi[h]),l=t.useProgram("globeRaster",null,n),c=e},m=t.colorModeForRenderPass(),f=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);xi.update(s);const g=e.calculateGlobeMercatorMatrix(u),_=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],y=h?[!1,!0]:[!1],v=t.globeSharedBuffers,x=[u.width*e.exported.devicePixelRatio,u.height*e.exported.devicePixelRatio],b=Float32Array.from(u.globeMatrix),w={useDenormalizedUpVectorScale:!0};if(y.forEach(h=>{const u=t.transform,d=wi(u.zoom)*i.exaggeration();c=-1;const y=h?a.LINES:a.TRIANGLES;for(const c of r){const r=n.getTile(c),C=e.StencilMode.disabled,S=i.prevTerrainTileForTile[c.key],E=i.terrainTileForTile[c.key];vi(S,E)&&xi.newMorphing(c.key,S,E,s,250),o.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const T=xi.getMorphValuesForProxy(c.key),P=T?1:0;T&&e.extend$1(w,{morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:e.easeCubicInOut(T.phase)}});const M=e.tileCornersToBounds(c.canonical),k=e.getLatitudinalLod(M.getCenter().lat),A=e.getGridMatrix(c.canonical,M,k,u.worldSize/u._pixelsPerMercatorPixel),I=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),R=yi(u.projMatrix,b,g,I,e.globeToMercatorTransition(u.zoom),_,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,x,d,A);if(p(P,h),i.setupElevationDraw(r,l,w),t.prepareDrawProgram(o,l,c.toUnwrapped()),v){const[i,n,r]=h?v.getWirefameBuffers(t.context,k):v.getGridBuffers(k,0!==d);l.draw(o,y,f,C,m,e.CullFaceMode.backCCW,R,"globe_raster",i,n,r)}}}),v){const s=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];d&&s.push("CUSTOM_ANTIALIASING"),l=t.useProgram("globeRaster",null,s);for(const c of r){const{x:r,y:s,z:h}=c.canonical,d=0===s,p=s===(1<<h)-1,[g,y,b,C]=v.getPoleBuffers(h);if(C&&(d||p)){const s=n.getTile(c);o.activeTexture.set(a.TEXTURE0),s.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let v=e.globePoleMatrixForTile(h,r,u);const S=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),E=(t,i)=>t.draw(o,a.TRIANGLES,f,e.StencilMode.disabled,m,e.CullFaceMode.disabled,yi(u.projMatrix,v,v,S,0,_,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,x,0),"globe_pole_raster",i,b,C);i.setupElevationDraw(s,l,w),t.prepareDrawProgram(o,l,c.toUnwrapped()),d&&E(l,g),p&&(v=e.scale(e.create(),v,[1,-1,1]),E(l,y))}}}}(t,i,n,r,s);else{const o=t.context,a=o.gl;let l,c;const h=t.options.showTerrainWireframe?2:0,u=(e,i)=>{if(c===e)return;const n=[bi[e]];i&&n.push(bi[h]),l=t.useProgram("terrainRaster",null,n),c=e},d=t.colorModeForRenderPass(),p=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);xi.update(s);const m=t.transform,f=wi(m.zoom)*i.exaggeration();(h?[!1,!0]:[!1]).forEach(h=>{c=-1;const g=h?a.LINES:a.TRIANGLES,[_,y]=h?i.getWirefameBuffer():[i.gridIndexBuffer,i.gridSegments];for(const c of r){const r=n.getTile(c),v=e.StencilMode.disabled,x=i.prevTerrainTileForTile[c.key],b=i.terrainTileForTile[c.key];vi(x,b)&&xi.newMorphing(c.key,x,b,s,250),o.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const w=xi.getMorphValuesForProxy(c.key),C=w?1:0;let S;w&&(S={morphing:{srcDemTile:w.from,dstDemTile:w.to,phase:e.easeCubicInOut(w.phase)}});const E=_i(c.projMatrix,Ci(c.canonical,m.renderWorldCopies)?f/10:f);u(C,h),i.setupElevationDraw(r,l,S),t.prepareDrawProgram(o,l,c.toUnwrapped()),l.draw(o,g,p,v,d,e.CullFaceMode.backCCW,E,"terrain_raster",i.gridBuffer,_,y)}})}}(i,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const i=this.painter,n=this.painter.context,r=this.proxySourceCache,s=this.proxiedCoords[r.id],o=this._drapedRenderBatches.shift(),a=[],l=i.style.order;let c=0;for(const h of s){const s=r.getTileByID(h.proxyTileKey),u=r.proxyCachedFBO[h.key]?r.proxyCachedFBO[h.key][t]:void 0,d=void 0!==u?r.renderCache[u]:this.pool[c++],p=void 0!==u;if(s.texture=d.tex,p&&!d.dirty){a.push(s.tileID);continue}let m;n.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(n.clear({color:e.Color.transparent,stencil:0}),d.dirty=!1);for(let e=o.start;e<=o.end;++e){const t=i.style._layers[l[e]];if(t.isHidden(i.transform.zoom))continue;const r=i.style._getLayerSourceCache(t),s=r?this.proxyToSource[h.key][r.id]:[h];if(!s)continue;const o=s;n.viewport.set([0,0,d.fb.width,d.fb.height]),m!==(r?r.id:null)&&(this._setupStencil(d,s,t,r),m=r?r.id:null),i.renderLayer(i,r,t,o)}this.renderedToTile?(d.dirty=!0,a.push(s.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),o.end+1}postRender(){}renderCacheEfficiency(e){const t=e.order.length;if(0===t)return{efficiency:100};let i,n=0,r=0,s=!1;for(let o=0;o<t;++o){const t=e._layers[e.order[o]];this._style.isLayerDraped(t)?(s&&++n,++r):s||(s=!0,i=t.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-n/r),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter(e=>e.dem).forEach(t=>{e=Math.min(e,t.dem.tree.minimums[0])}),0===e?e:(e-30)*this._exaggeration}raycast(e,t,i){if(!this._visibleDemTiles)return null;const n=this._visibleDemTiles.filter(e=>e.dem).map(n=>{const r=n.tileID,s=1<<r.overscaledZ,{x:o,y:a}=r.canonical,l=o/s,c=(o+1)/s,h=a/s,u=(a+1)/s;return{minx:l,miny:h,maxx:c,maxy:u,t:n.dem.tree.raycastRoot(l,h,c,u,e,t,i),tile:n}});n.sort((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE));for(const r of n){if(null==r.t)return null;const n=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,e,t,i);if(null!=n)return n}return null}_createFBO(){const t=this.painter.context,i=t.gl,n=this.drapeBufferSize;t.activeTexture.set(i.TEXTURE0);const r=new e.Texture(t,{width:n[0],height:n[1],data:null},i.RGBA);r.bind(i.LINEAR,i.CLAMP_TO_EDGE);const s=t.createFramebuffer(n[0],n[1],!1);return s.colorAttachment.set(r.texture),s.depthAttachment=new we(t,s.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,s.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):s.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:s,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some(e=>{const t=this._style._layers[e],i=t.isHidden(this.painter.transform.zoom);return"custom"===t.type?!i&&t.shouldRedrape():!i&&t.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style._getSources())if(e instanceof Ee){t=!0;break}if(!t)return;const i={};for(let n=0;n<this._style.order.length;++n){const t=this._style._layers[this._style.order[n]],r=this._style._getLayerSourceCache(t);if(r&&!i[r.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.ZoomDependentExpression){i[r.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][r.id];if(t)for(const e of t)this._clearRenderCacheForTile(r.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i]._source instanceof Te){e=!0;break}if(!e)return;const t={};for(let i=0;i<this._style.order.length;++i){const e=this._style._layers[this._style.order[i]],n=this._style._getLayerSourceCache(e);if(!n||t[n.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const r=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][n.id];if(e)for(const t of e){const e=Ei(n.getTile(t),n.findLoadedParent(t,0),n,this.painter.transform,r);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(n.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,t=e.length;if(0===t)return;const i=[];let n,r=0,s=this._style._layers[e[r]];for(;!this._style.isLayerDraped(s)&&s.isHidden(this.painter.transform.zoom)&&++r<t;)s=this._style._layers[e[r]];for(;r<t;++r){const t=this._style._layers[e[r]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===n&&(n=r):void 0!==n&&(i.push({start:n,end:r-1}),n=void 0))}void 0!==n&&i.push({start:n,end:r-1}),this._drapedRenderBatches=i}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let i=0;i<e.length;++i){const n=Object.values(e[i]);t.renderCachePool.push(...n)}}return}this._clearRasterLayersFromRenderCache();const i=this.proxyCoords,n=this._tilesDirty;for(let s=i.length-1;s>=0;s--){const r=i[s];if(t.getTileByID(r.key),void 0!==t.proxyCachedFBO[r.key]){const i=e[r.key],s=this.proxyToSource[r.key];let o=0;for(const e in s){const t=s[e],r=i[e];if(!r||r.length!==t.length||t.some((t,i)=>t!==r[i]||n[e]&&n[e].hasOwnProperty(t.key))){o=-1;break}++o}for(const e in t.proxyCachedFBO[r.key])t.renderCache[t.proxyCachedFBO[r.key][e]].dirty=o<0||o!==Object.values(i).length}}const r=[...this._drapedRenderBatches];r.sort((e,t)=>t.end-t.start-(e.end-e.start));for(const s of r)for(const e of i){if(t.proxyCachedFBO[e.key])continue;let i=t.renderCachePool.pop();void 0===i&&t.renderCache.length<50&&(i=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==i&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][s.start]=i,t.renderCache[i].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,i,n){if(!n||!this._sourceTilesOverlap[n.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const r=this.painter.context,s=r.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let o;if(i.isTileClipped())o=t.length,this._overlapStencilMode.test={func:s.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:s.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}_renderTileClippingMasks(t,i){const n=this.painter,r=this.painter.context,s=r.gl;n._tileClippingMaskIDs={},r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const o=n.useProgram("clippingMask");for(const a of t){const t=n._tileClippingMaskIDs[a.key]=--i;o.draw(r,s.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:s.ALWAYS,mask:0},t,255,s.KEEP,s.KEEP,s.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Si(a.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}pointCoordinate(t){const i=this.painter.transform;if(t.x<0||t.x>i.width||t.y<0||t.y>i.height)return null;const n=[t.x,t.y,1,1];e.transformMat4$1(n,n,i.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),n[0]/=i.worldSize,n[1]/=i.worldSize;const r=i._camera.position,s=e.mercatorZfromAltitude(1,i.center.lat),o=[r[0],r[1],r[2]/s,0],a=e.subtract([],n.slice(0,3),o);e.normalize(a,a);const l=this.raycast(o,a,this._exaggeration);return null!==l&&l?(e.scaleAndAdd(o,o,a,l),o[3]=o[2],o[2]*=s,o):null}drawDepth(){const t=this.painter,i=t.context,n=this.proxySourceCache,r=Math.ceil(t.width),s=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===s||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const t=i.gl,n=i.createFramebuffer(r,s,!0);i.activeTexture.set(t.TEXTURE0);const o=new e.Texture(i,{width:r,height:s,data:null},t.RGBA);o.bind(t.NEAREST,t.CLAMP_TO_EDGE),n.colorAttachment.set(o.texture);const a=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,r,s);n.depthAttachment.set(a),this._depthFBO=n,this._depthTexture=o}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,r,s]),function(t,i,n,r){if("globe"===t.transform.projection.name)return;const s=t.context,o=s.gl;s.clear({depth:1});const a=t.useProgram("terrainDepth"),l=new e.DepthMode(o.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D);for(const c of r){const t=n.getTile(c),r=_i(c.projMatrix,0);i.setupElevationDraw(t,a),a.draw(s,o.TRIANGLES,l,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,r,"terrain_depth",i.gridBuffer,i.gridIndexBuffer,i.gridNoSkirtSegments)}}(t,this,n,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,t,i){if(e.getSource()instanceof Me)return this._setupProxiedCoordsForImageSource(e,t,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const n=this.proxiedCoords[e.id]=[],r=this.proxyCoords;for(let o=0;o<r.length;o++){const t=r[o],s=this._findTileCoveringTileID(t,e);if(s){const r=this._createProxiedId(t,s,i[t.key]&&i[t.key][e.id]);n.push(r),this.proxyToSource[t.key][e.id]=[r]}}let s=!1;for(let o=0;o<t.length;o++){const r=e.getTile(t[o]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const t=this.proxyToSource[a.tileID.key][e.id],o=this._createProxiedId(a.tileID,r,i[a.tileID.key]&&i[a.tileID.key][e.id]);t?t.splice(t.length-1,0,o):this.proxyToSource[a.tileID.key][e.id]=[o],n.push(o),s=!0}}this._sourceTilesOverlap[e.id]=s}_setupProxiedCoordsForImageSource(t,i,n){if(!t.getSource().loaded())return;const r=this.proxiedCoords[t.id]=[],s=this.proxyCoords,o=t.getSource(),a=new e.Point(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),l=o.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce((e,t)=>(e.min.x=Math.min(e.min.x,t.x-a.x),e.min.y=Math.min(e.min.y,t.y-a.y),e.max.x=Math.max(e.max.x,t.x-a.x),e.max.y=Math.max(e.max.y,t.y-a.y),e),{min:new e.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(t,i)=>{const n=t.wrap+t.canonical.x/(1<<t.canonical.z),r=t.canonical.y/(1<<t.canonical.z),s=e.EXTENT/(1<<t.canonical.z),o=i.wrap+i.canonical.x/(1<<i.canonical.z),a=i.canonical.y/(1<<i.canonical.z);return n+s<o+l.min.x||n>o+l.max.x||r+s<a+l.min.y||r>a+l.max.y};for(let e=0;e<s.length;e++){const o=s[e];for(let e=0;e<i.length;e++){const s=t.getTile(i[e]);if(!s||!s.hasData())continue;if(c(o,s.tileID))continue;const a=this._createProxiedId(o,s,n[o.key]&&n[o.key][t.id]),l=this.proxyToSource[o.key][t.id];l?l.push(a):this.proxyToSource[o.key][t.id]=[a],r.push(a)}}}_createProxiedId(t,i,n){let r=this.orthoMatrix;if(n){const e=n.find(e=>e.key===i.tileID.key);if(e)return e}if(i.tileID.key!==t.key){const n=t.canonical.z-i.tileID.canonical.z;let s,o,a;r=e.create();const l=i.tileID.wrap-t.wrap<<t.overscaledZ;n>0?(s=e.EXTENT>>n,o=s*((i.tileID.canonical.x<<n)-t.canonical.x+l),a=s*((i.tileID.canonical.y<<n)-t.canonical.y)):(s=e.EXTENT<<-n,o=e.EXTENT*(i.tileID.canonical.x-(t.canonical.x+l<<-n)),a=e.EXTENT*(i.tileID.canonical.y-(t.canonical.y<<-n))),e.ortho(r,0,s,0,s,0,1),e.translate(r,r,[o,a,0])}return new Mi(i.tileID,t.key,r)}_findTileCoveringTileID(t,i){let n=i.getTile(t);if(n&&n.hasData())return n;const r=this._findCoveringTileCache[i.id],s=r[t.key];if(n=s?i.getTileByID(s):null,n&&n.hasData()||null===s)return n;let o=n?n.tileID:t,a=o.overscaledZ;const l=i.getSource().minzoom,c=[];if(!s){const r=i.getSource().maxzoom;if(t.canonical.z>=r){const n=t.canonical.z-r;i.getSource().reparseOverscaled?(a=Math.max(t.canonical.z+2,i.transform.tileZoom),o=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>n,t.canonical.y>>n)):0!==n&&(a=r,o=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>n,t.canonical.y>>n))}o.key!==t.key&&(c.push(o.key),n=i.getTile(o))}const h=e=>{c.forEach(t=>{r[t]=e}),c.length=0};for(a-=1;a>=l&&(!n||!n.hasData());a--){n&&h(n.tileID.key);const e=o.calculateScaledKey(a);if(n=i.getTileByID(e),n&&n.hasData())break;const t=r[e];if(null===t)break;void 0===t?c.push(e):n=i.getTileByID(t)}return h(n?n.tileID.key:null),n&&n.hasData()?n:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[t.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(t){let i=0;const n=new e.StructArrayLayout2ui4,r=131;for(let e=1;e<129;e++){for(let t=1;t<129;t++)i=e*r+t,n.emplaceBack(i,i+1),n.emplaceBack(i,i+r),n.emplaceBack(i+1,i+r),128===e&&n.emplaceBack(i+r,i+r+1);n.emplaceBack(i+1,i+1+r)}return n}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ai{static cacheKey(e,t,i,n){let r=`${t}${n?n.cacheKey:""}`;for(const s of i)e.usedDefines.includes(s)&&(r+="/"+s);return r}constructor(t,i,n,r,s,o){const a=t.gl;this.program=a.createProgram();const l=function(e){const t=[];for(let i=0;i<e.length;i++){if(null===e[i])continue;const n=e[i].split(" ");t.push(n.pop())}return t}(n.staticAttributes),c=r?r.getBinderAttributes():[],h=l.concat(c);let u=r?r.defines():[];u=u.concat(o.map(e=>"#define "+e));const d=t.isWebGL2?"#version 300 es\n":"",p=d+u.concat(t.extStandardDerivatives&&0===d.length?"#extension GL_OES_standard_derivatives : enable\n".concat(ai):ai,ai,oi,si.fragmentSource,ni.fragmentSource,n.fragmentSource).join("\n"),m=d+u.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",oi,si.vertexSource,ni.vertexSource,ii.vertexSource,n.vertexSource).join("\n"),f=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(f,p),a.compileShader(f),a.attachShader(this.program,f);const g=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(g,m),a.compileShader(g),a.attachShader(this.program,g),this.attributes={},this.numAttributes=h.length;for(let e=0;e<this.numAttributes;e++)h[e]&&(a.bindAttribLocation(this.program,e,h[e]),this.attributes[h[e]]=e);a.linkProgram(this.program),a.deleteShader(g),a.deleteShader(f),this.fixedUniforms=s(t),this.binderUniforms=r?r.getUniforms(t):[],o.includes("TERRAIN")&&(this.terrainUniforms=(t=>({u_dem:new e.Uniform1i(t),u_dem_prev:new e.Uniform1i(t),u_dem_unpack:new e.Uniform4f(t),u_dem_tl:new e.Uniform2f(t),u_dem_scale:new e.Uniform1f(t),u_dem_tl_prev:new e.Uniform2f(t),u_dem_scale_prev:new e.Uniform1f(t),u_dem_size:new e.Uniform1f(t),u_dem_lerp:new e.Uniform1f(t),u_exaggeration:new e.Uniform1f(t),u_depth:new e.Uniform1i(t),u_depth_size_inv:new e.Uniform2f(t),u_meter_to_dem:new e.Uniform1f(t),u_label_plane_matrix_inv:new e.UniformMatrix4f(t)}))(t)),o.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.Uniform3f(t),u_tile_tr_up:new e.Uniform3f(t),u_tile_br_up:new e.Uniform3f(t),u_tile_bl_up:new e.Uniform3f(t),u_tile_up_scale:new e.Uniform1f(t)}))(t)),o.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.UniformMatrix4f(t),u_fog_range:new e.Uniform2f(t),u_fog_color:new e.Uniform4f(t),u_fog_horizon_blend:new e.Uniform1f(t),u_fog_temporal_offset:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_globe_transition:new e.Uniform1f(t),u_is_globe:new e.Uniform1i(t),u_viewport:new e.Uniform2f(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const i=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e].set(this.program,e,t[e])}}draw(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m){const f=e.gl;if(this.failedToCreate)return;e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(n),e.setColorMode(r),e.setCullFace(s);for(const _ of Object.keys(this.fixedUniforms))this.fixedUniforms[_].set(this.program,_,o[_]);p&&p.setUniforms(this.program,e,this.binderUniforms,u,{zoom:d});const g={[f.LINES]:2,[f.TRIANGLES]:3,[f.LINE_STRIP]:1}[t];for(const _ of h.get()){const i=_.vaos||(_.vaos={});(i[a]||(i[a]=new ui)).bind(e,this,l,p?p.getPaintVertexBuffers():[],c,_.vertexOffset,m||[]),f.drawElements(t,_.primitiveLength*g,f.UNSIGNED_SHORT,_.primitiveOffset*g*2)}}}function Ii(e,t){const i=Math.pow(2,t.tileID.overscaledZ),n=t.tileSize*Math.pow(2,e.transform.tileZoom)/i,r=n*(t.tileID.canonical.x+t.tileID.wrap*i),s=n*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/A(t,1,e.transform.tileZoom),u_pixel_coord_upper:[r>>16,s>>16],u_pixel_coord_lower:[65535&r,65535&s]}}const Ri=e.create(),Oi=(t,i,n,r,s,o,a,l,c,h,u)=>{const d=i.style.light,p=d.properties.get("position"),m=[p.x,p.y,p.z],f=e.create$1();"viewport"===d.properties.get("anchor")&&(e.fromRotation(f,-i.transform.angle),e.transformMat3(m,m,f));const g=d.properties.get("color"),_=i.transform,y={u_matrix:t,u_lightpos:m,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+n,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ri,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:s,u_edge_radius:o};return"globe"===_.projection.name&&(y.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],y.u_zoom_transition=c,y.u_inv_rot_matrix=u,y.u_merc_center=h,y.u_up_dir=_.projection.upVector(new e.CanonicalTileID(0,0,0),h[0]*e.EXTENT,h[1]*e.EXTENT),y.u_height_lift=l),y},Ni=(t,i,n,r,s,o,a,l,c,h,u,d)=>{const p=Oi(t,i,n,r,s,o,a,c,h,u,d),m={u_height_factor:-Math.pow(2,a.overscaledZ)/l.tileSize/8};return e.extend(p,Ii(i,l),m)},Di=e=>({u_matrix:e}),zi=(t,i,n)=>e.extend(Di(t),Ii(i,n)),Li=(e,t)=>({u_matrix:e,u_world:t}),Bi=(t,i,n,r)=>e.extend(zi(t,i,n),{u_world:r}),Fi=e.create(),ji=(t,i,n,r,s,o)=>{const a=t.transform,l="globe"===a.projection.name;let c;if("map"===o.paint.get("circle-pitch-alignment"))if(l){const t=e.globePixelsToTileUnits(a.zoom,i.canonical)*a._pixelsPerMercatorPixel;c=Float32Array.from([t,0,0,t])}else c=a.calculatePixelsToTileUnitsMatrix(n);else c=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const h={u_camera_to_center_distance:a.cameraToCenterDistance,u_matrix:t.translatePosMatrix(i.projMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:c,u_inv_rot_matrix:Fi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(l){h.u_inv_rot_matrix=r,h.u_merc_center=s,h.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(a.zoom);const t=s[0]*e.EXTENT,n=s[1]*e.EXTENT;h.u_up_dir=a.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return h},Vi=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},Ui=(t,i,n,r)=>{const s=e.EXTENT/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:i.getCameraToCenterDistance(r),u_extrude_scale:[i.pixelsToGLUnits[0]/s,i.pixelsToGLUnits[1]/s]}},qi=(e,t,i=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:i}),Hi=e.create(),Gi=(t,i,n,r,s,o,a)=>{const l=t.transform,c="globe"===l.projection.name,h=c?e.globePixelsToTileUnits(l.zoom,i.canonical)*l._pixelsPerMercatorPixel:A(n,1,o),u={u_matrix:i.projMatrix,u_extrude_scale:h,u_intensity:a,u_inv_rot_matrix:Hi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){u.u_inv_rot_matrix=r,u.u_merc_center=s,u.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],u.u_zoom_transition=e.globeToMercatorTransition(l.zoom);const t=s[0]*e.EXTENT,n=s[1]*e.EXTENT;u.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return u},Wi=(e,t,i,n,r,s,o)=>{const a=e.transform,l=a.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:Xi(e,t,i,n),u_pixels_to_tile_units:l,u_device_pixel_ratio:s,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:r,u_texsize:Ki(i)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:$i(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:o}},Zi=(e,t,i,n,r)=>{const s=e.transform;return{u_matrix:Xi(e,t,i,n),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:s.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:r,u_image:0,u_tile_units_to_pixels:$i(t,s),u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function $i(e,t){return 1/A(e,1,t.tileZoom)}function Xi(e,t,i,n){return e.translatePosMatrix(n||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}function Ki(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const Yi=(e,t,i,n,r,s)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:i,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Ji(r.paint.get("raster-hue-rotate")),u_perspective_transform:s};var o,a};function Ji(e){e*=Math.PI/180;const t=Math.sin(e),i=Math.cos(e);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}const Qi=e.create(),en=(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g)=>{const _=s.transform,y={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:_.cameraToCenterDistance,u_rotate_symbol:+n,u_aspect_ratio:_.width/_.height,u_fade_change:s.options.fadeDuration?s.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+r,u_texsize:h,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Qi,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Qi,u_up_vector:[0,-1,0]};return"globe"===g.name&&(y.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],y.u_zoom_transition=d,y.u_inv_rot_matrix=m,y.u_merc_center=p,y.u_camera_forward=_._camera.forward(),y.u_ecef_origin=e.globeECEFOrigin(_.globeMatrix,u.toUnwrapped()),y.u_tile_matrix=Float32Array.from(_.globeMatrix),y.u_up_vector=f),y},tn=(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_)=>e.extend(en(t,i,n,r,s,o,a,l,c,h,d,p,m,f,g,_),{u_gamma_scale:r?s.transform.cameraToCenterDistance*Math.cos(s.terrain?0:s.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+u}),nn=(t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g)=>e.extend(tn(t,i,n,r,s,o,a,l,!0,c,!0,u,d,p,m,f,g),{u_texsize_icon:h,u_texture_icon:1}),rn=(e,t,i)=>({u_matrix:e,u_opacity:t,u_color:i}),sn=(t,i,n,r,s)=>e.extend(function(e,t,i){const n=t.imageManager.getPattern(e.toString()),{width:r,height:s}=t.imageManager.getPixelSize(),o=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,t.transform.tileZoom)/o,l=a*(i.tileID.canonical.x+i.tileID.wrap*o),c=a*i.tileID.canonical.y;return{u_image:0,u_pattern_tl:n.tl,u_pattern_br:n.br,u_texsize:[r,s],u_pattern_size:n.displaySize,u_tile_units_to_pixels:1/A(i,1,t.transform.tileZoom),u_pixel_coord_upper:[l>>16,c>>16],u_pixel_coord_lower:[65535&l,65535&c]}}(r,n,s),{u_matrix:t,u_opacity:i}),on={fillExtrusion:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t)}),fillExtrusionPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_height_factor:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t)}),fill:t=>({u_matrix:new e.UniformMatrix4f(t)}),fillPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),fillOutline:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t)}),fillOutlinePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),circle:t=>({u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),collisionBox:t=>({u_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.Uniform2f(t)}),collisionCircle:t=>({u_matrix:new e.UniformMatrix4f(t),u_inv_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_viewport_size:new e.Uniform2f(t)}),debug:t=>({u_color:new e.UniformColor(t),u_matrix:new e.UniformMatrix4f(t),u_overlay:new e.Uniform1i(t),u_overlay_scale:new e.Uniform1f(t)}),clippingMask:t=>({u_matrix:new e.UniformMatrix4f(t)}),heatmap:t=>({u_extrude_scale:new e.Uniform1f(t),u_intensity:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),heatmapTexture:t=>({u_image:new e.Uniform1i(t),u_color_ramp:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t)}),hillshade:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_latrange:new e.Uniform2f(t),u_light:new e.Uniform2f(t),u_shadow:new e.UniformColor(t),u_highlight:new e.UniformColor(t),u_accent:new e.UniformColor(t)}),hillshadePrepare:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_dimension:new e.Uniform2f(t),u_zoom:new e.Uniform1f(t),u_unpack:new e.Uniform4f(t)}),line:t=>({u_matrix:new e.UniformMatrix4f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_units_to_pixels:new e.Uniform2f(t),u_dash_image:new e.Uniform1i(t),u_gradient_image:new e.Uniform1i(t),u_image_height:new e.Uniform1f(t),u_texsize:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t),u_trim_offset:new e.Uniform2f(t)}),linePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_texsize:new e.Uniform2f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_units_to_pixels:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t)}),raster:t=>({u_matrix:new e.UniformMatrix4f(t),u_tl_parent:new e.Uniform2f(t),u_scale_parent:new e.Uniform1f(t),u_fade_t:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_image0:new e.Uniform1i(t),u_image1:new e.Uniform1i(t),u_brightness_low:new e.Uniform1f(t),u_brightness_high:new e.Uniform1f(t),u_saturation_factor:new e.Uniform1f(t),u_contrast_factor:new e.Uniform1f(t),u_spin_weights:new e.Uniform3f(t),u_perspective_transform:new e.Uniform2f(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_texture:new e.Uniform1i(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_is_halo:new e.Uniform1i(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texsize_icon:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_texture_icon:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_is_halo:new e.Uniform1i(t)}),background:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_color:new e.UniformColor(t)}),backgroundPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_pattern_tl:new e.Uniform2f(t),u_pattern_br:new e.Uniform2f(t),u_texsize:new e.Uniform2f(t),u_pattern_size:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),terrainRaster:gi,terrainDepth:gi,skybox:t=>({u_matrix:new e.UniformMatrix4f(t),u_sun_direction:new e.Uniform3f(t),u_cubemap:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxGradient:t=>({u_matrix:new e.UniformMatrix4f(t),u_color_ramp:new e.Uniform1i(t),u_center_direction:new e.Uniform3f(t),u_radius:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxCapture:t=>({u_matrix_3f:new e.UniformMatrix3f(t),u_sun_direction:new e.Uniform3f(t),u_sun_intensity:new e.Uniform1f(t),u_color_tint_r:new e.Uniform4f(t),u_color_tint_m:new e.Uniform4f(t),u_luminance:new e.Uniform1f(t)}),globeRaster:t=>({u_proj_matrix:new e.UniformMatrix4f(t),u_globe_matrix:new e.UniformMatrix4f(t),u_normalize_matrix:new e.UniformMatrix4f(t),u_merc_matrix:new e.UniformMatrix4f(t),u_zoom_transition:new e.Uniform1f(t),u_merc_center:new e.Uniform2f(t),u_image0:new e.Uniform1i(t),u_grid_matrix:new e.UniformMatrix3f(t),u_skirt_height:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_viewport:new e.Uniform2f(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_horizon:new e.Uniform1f(t),u_transition:new e.Uniform1f(t),u_fadeout_range:new e.Uniform1f(t),u_color:new e.Uniform4f(t),u_high_color:new e.Uniform4f(t),u_space_color:new e.Uniform4f(t),u_star_intensity:new e.Uniform1f(t),u_star_density:new e.Uniform1f(t),u_star_size:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t),u_horizon_angle:new e.Uniform1f(t),u_rotation_matrix:new e.UniformMatrix4f(t)})};let an;function ln(t,i,n,r,s,o,a){const l=t.context,c=l.gl,h=t.transform,u=t.useProgram("collisionBox"),d=[];let p=0,m=0;for(let b=0;b<r.length;b++){const f=r[b],g=i.getTile(f),_=g.getBucket(n);if(!_)continue;const y=_t(f,_,h);let v=y;0===s[0]&&0===s[1]||(v=t.translatePosMatrix(y,g,s,o));const x=a?_.textCollisionBox:_.iconCollisionBox,w=_.collisionCircleArray;if(w.length>0){const t=e.create(),i=v;e.mul(t,_.placementInvProjMatrix,h.glCoordMatrix),e.mul(t,t,_.placementViewportMatrix),d.push({circleArray:w,circleOffset:m,transform:i,invTransform:t,projection:_.getProjection()}),p+=w.length/4,m=p}x&&(t.terrain&&t.terrain.setupElevationDraw(g,u),u.draw(l,c.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,Ui(v,h,g,_.getProjection()),n.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,h.zoom,null,[x.collisionVertexBuffer,x.collisionVertexBufferExt]))}if(!a||!d.length)return;const f=t.useProgram("collisionCircle"),g=new e.StructArrayLayout2f1f2i16;g.resize(4*p),g._trim();let _=0;for(const e of d)for(let t=0;t<e.circleArray.length/4;t++){const i=4*t,n=e.circleArray[i+0],r=e.circleArray[i+1],s=e.circleArray[i+2],o=e.circleArray[i+3];g.emplace(_++,n,r,s,o,0),g.emplace(_++,n,r,s,o,1),g.emplace(_++,n,r,s,o,2),g.emplace(_++,n,r,s,o,3)}(!an||an.length<2*p)&&(an=function(t){const i=2*t,n=new e.StructArrayLayout3ui6;n.resize(i),n._trim();for(let e=0;e<i;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(p));const y=l.createIndexBuffer(an,!0),v=l.createVertexBuffer(g,e.collisionCircleLayout.members,!0);for(const b of d){const i={u_matrix:b.transform,u_inv_matrix:b.invTransform,u_camera_to_center_distance:(x=h).getCameraToCenterDistance(b.projection),u_viewport_size:[x.width,x.height]};f.draw(l,c.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,i,n.id,v,y,e.SegmentVector.simpleSegment(0,2*b.circleOffset,b.circleArray.length,b.circleArray.length/2),null,h.zoom)}var x;v.destroy(),y.destroy()}const cn=e.create();function hn({width:t,height:i,anchor:n,textOffset:r,textScale:s},o){const{horizontalAlign:a,verticalAlign:l}=e.getAnchorAlignment(n),c=-(a-.5)*t,h=-(l-.5)*i,u=e.evaluateVariableOffset(n,r);return new e.Point((c/s+u[0])*o,(h/s+u[1])*o)}function un(t,i,n,r,s,o,a,l,c,h,u){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,m=t.icon.dynamicLayoutVertexArray,f={},g=t.getProjection(),_=yt(l,g,o),y=o.elevation,v=g.upVectorScale(l.canonical,o.center.lat,o.worldSize).metersToTile;p.clear();for(let x=0;x<d.length;x++){const m=d.get(x),{tileAnchorX:b,tileAnchorY:w,numGlyphs:C}=m,S=m.hidden||!m.crossTileID||t.allowVerticalPlacement&&!m.placedOrientation?null:r[m.crossTileID];if(S){let r=0,d=0,x=0;if(y){const e=y?y.getAtTileOffset(l,b,w):0,[t,i,n]=g.upVector(l.canonical,b,w);r=e*t*v,d=e*i*v,x=e*n*v}let[E,T,P,M]=it(m.projectedAnchorX+r,m.projectedAnchorY+d,m.projectedAnchorZ+x,n?_:a);const k=nt(o.getCameraToCenterDistance(g),M);let A=s.evaluateSizeForFeature(t.textSizeData,h,m)*k/e.ONE_EM;n&&(A*=t.tilePixelRatio/c);const I=hn(S,A);n?(({x:E,y:T,z:P}=g.projectTilePoint(b+I.x,w+I.y,l.canonical)),[E,T,P]=it(E+r,T+d,P+x,a)):(i&&I._rotate(-o.angle),E+=I.x,T+=I.y,P=0);const R=t.allowVerticalPlacement&&m.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(let t=0;t<C;t++)e.addDynamicAttributes(p,E,T,P,R);u&&m.associatedIconIndex>=0&&(f[m.associatedIconIndex]={x:E,y:T,z:P,angle:R})}else dt(C,p)}if(u){m.clear();const i=t.icon.placedSymbolArray;for(let t=0;t<i.length;t++){const n=i.get(t),{numGlyphs:r}=n,s=f[t];if(n.hidden||!s)dt(r,m);else{const{x:t,y:i,z:n,angle:o}=s;for(let s=0;s<r;s++)e.addDynamicAttributes(m,t,i,n,o)}}t.icon.dynamicLayoutVertexBuffer.updateData(m)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function dn(e,t,i){return i.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function pn(t,i,n,r,s,o,a,l,c,h,u,d){const p=t.context,m=p.gl,f=t.transform,g="map"===l,_="map"===c,y=g&&"point"!==n.layout.get("symbol-placement"),v=g&&!_&&!y,x=void 0!==n.layout.get("symbol-sort-key").constantOr(1);let b=!1;const w=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),C=[e.mercatorXfromLng(f.center.lng),e.mercatorYfromLat(f.center.lat)],S=n.layout.get("text-variable-anchor"),E="globe"===f.projection.name,T=[],P=[0,-1,0];let M=P;!E&&!f.mercatorFromTransition||g||(M=function(t){const i=t._camera.getWorldToCamera(t.worldSize,1),n=e.multiply([],i,t.globeMatrix);e.invert(n,n);const r=[0,0,0],s=[0,1,0,0];return e.transformMat4$1(s,s,n),r[0]=s[0],r[1]=s[1],r[2]=s[2],e.normalize(r,r),r}(f));for(const k of r){const r=i.getTile(k),l=r.getBucket(n);if(!l)continue;if("mercator"===l.projection.name&&E)continue;const c=s?l.text:l.icon;if(!c||l.fullyClipped||!c.segments.get().length)continue;const u=c.programConfigurations.get(n.id),d=s||l.sdfIcons,p=s?l.textSizeData:l.iconSizeData,w=_||0!==f.pitch,A=e.evaluateSizeForZoom(p,f.zoom);let I,R,O,N,D=[0,0],z=null;if(s)R=r.glyphAtlasTexture,O=m.LINEAR,I=r.glyphAtlasTexture.size,l.iconsInText&&(D=r.imageAtlasTexture.size,z=r.imageAtlasTexture,N=w||t.options.rotating||t.options.zooming||"composite"===p.kind||"camera"===p.kind?m.LINEAR:m.NEAREST);else{const e=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;R=r.imageAtlasTexture,O=d||t.options.rotating||t.options.zooming||e||w?m.LINEAR:m.NEAREST,I=r.imageAtlasTexture.size}const L="globe"===l.projection.name,B=L?M:P,F=L?e.globeToMercatorTransition(f.zoom):0,j=yt(k,l.getProjection(),f),V=f.calculatePixelsToTileUnitsMatrix(r),U=Qe(j,r.tileID.canonical,_,g,f,l.getProjection(),V),q=t.terrain&&_&&y?e.invert(e.create(),U):cn,H=tt(j,r.tileID.canonical,_,g,f,l.getProjection(),V),G=S&&l.hasTextData(),W="none"!==n.layout.get("icon-text-fit")&&G&&l.hasIconData();if(y){const e=f.elevation,i=e?e.getAtTileOffsetFunc(k,f.center.lat,f.worldSize,l.getProjection()):null,n=et(j,r.tileID.canonical,_,g,f,l.getProjection(),V);st(l,j,t,s,n,H,_,h,i,k)}const Z=y||s&&S||W,$=t.translatePosMatrix(j,r,o,a),X=Z?cn:U,K=t.translatePosMatrix(H,r,o,a,!0),Y=l.getProjection().createInversionMatrix(f,k.canonical),J=[];t.terrainRenderModeElevated()&&_&&J.push("PITCH_WITH_MAP_TERRAIN"),L&&J.push("PROJECTION_GLOBE_VIEW"),Z&&J.push("PROJECTED_POS_ON_VIEWPORT");const Q=d&&0!==n.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1);let ee;ee=d?l.iconsInText?nn(p.kind,A,v,_,t,$,X,K,I,D,k,F,C,Y,B,l.getProjection()):tn(p.kind,A,v,_,t,$,X,K,s,I,!0,k,F,C,Y,B,l.getProjection()):en(p.kind,A,v,_,t,$,X,K,s,I,k,F,C,Y,B,l.getProjection());const te={program:t.useProgram(dn(d,s,l),u,J),buffers:c,uniformValues:ee,atlasTexture:R,atlasTextureIcon:z,atlasInterpolation:O,atlasInterpolationIcon:N,isSDF:d,hasHalo:Q,tile:r,labelPlaneMatrixInv:q};if(x&&l.canOverlap){b=!0;const t=c.segments.get();for(const i of t)T.push({segments:new e.SegmentVector([i]),sortKey:i.sortKey,state:te})}else T.push({segments:c.segments,sortKey:0,state:te})}b&&T.sort((e,t)=>e.sortKey-t.sortKey);for(const e of T){const i=e.state;if(t.terrain&&t.terrain.setupElevationDraw(i.tile,i.program,{useDepthForOcclusion:!E,labelPlaneMatrixInv:i.labelPlaneMatrixInv}),p.activeTexture.set(m.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,m.CLAMP_TO_EDGE),i.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),i.isSDF){const r=i.uniformValues;i.hasHalo&&(r.u_is_halo=1,mn(i.buffers,e.segments,n,t,i.program,w,u,d,r)),r.u_is_halo=0}mn(i.buffers,e.segments,n,t,i.program,w,u,d,i.uniformValues)}}function mn(t,i,n,r,s,o,a,l,c){const h=r.context,u=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer];s.draw(h,h.gl.TRIANGLES,o,a,l,e.CullFaceMode.disabled,c,n.id,t.layoutVertexBuffer,t.indexBuffer,i,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),u)}function fn(t,i,n,r,s,o,a){const l=t.context.gl,c=n.paint.get("fill-pattern"),h=c&&c.constantOr(1);let u,d,p,m,f;a?(d=h&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",u=l.LINES):(d=h?"fillPattern":"fill",u=l.TRIANGLES);for(const g of r){const r=i.getTile(g);if(h&&!r.patternsLoaded())continue;const _=r.getBucket(n);if(!_)continue;t.prepareDrawTile();const y=_.programConfigurations.get(n.id),v=t.useProgram(d,y);h&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers());const x=c.constantOr(null);if(x&&r.imageAtlas){const e=r.imageAtlas.patternPositions[x.toString()];e&&y.setConstantPatternPositions(e)}const b=t.translatePosMatrix(g.projMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){m=_.indexBuffer2,f=_.segments2;const e=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];p="fillOutlinePattern"===d&&h?Bi(b,t,r,e):Li(b,e)}else m=_.indexBuffer,f=_.segments,p=h?zi(b,t,r):Di(b);t.prepareDrawProgram(t.context,v,g.toUnwrapped()),v.draw(t.context,u,s,t.stencilModeForClipping(g),o,e.CullFaceMode.disabled,p,n.id,_.layoutVertexBuffer,m,f,n.paint,t.transform.zoom,y)}}function gn(t,i,n,r,s,o,a){const l=t.context,c=l.gl,h=t.transform,u=n.paint.get("fill-extrusion-pattern"),d=u.constantOr(1),p=n.paint.get("fill-extrusion-opacity"),m=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),n.paint.get("fill-extrusion-ambient-occlusion-radius")],f=n.layout.get("fill-extrusion-edge-radius"),g=f>0&&!n.paint.get("fill-extrusion-rounded-roof"),_=g?0:f,y="globe"===h.projection.name?e.fillExtrusionHeightLift():0,v="globe"===h.projection.name,x=v?e.globeToMercatorTransition(h.zoom):0,b=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],w=[];v&&w.push("PROJECTION_GLOBE_VIEW"),m[0]>0&&w.push("FAUX_AO"),g&&w.push("ZERO_ROOF_RADIUS");for(const C of r){const r=i.getTile(C),f=r.getBucket(n);if(!f||f.projection.name!==h.projection.name)continue;const g=f.programConfigurations.get(n.id),S=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",g,w);if(t.terrain){const e=t.terrain;if(t.style.terrainSetForDrapingOnly())e.setupElevationDraw(r,S,{useMeterToDem:!0});else{if(!f.enableTerrain)continue;if(e.setupElevationDraw(r,S,{useMeterToDem:!0}),_n(l,i,C,f,n,e),!f.centroidVertexBuffer){const e=S.attributes.a_centroid_pos;void 0!==e&&c.vertexAttrib2f(e,0,0)}}}d&&(t.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),g.updatePaintBuffers());const E=u.constantOr(null);if(E&&r.imageAtlas){const e=r.imageAtlas.patternPositions[E.toString()];e&&g.setConstantPatternPositions(e)}const T=t.translatePosMatrix(C.projMatrix,r,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),P=h.projection.createInversionMatrix(h,C.canonical),M=n.paint.get("fill-extrusion-vertical-gradient"),k=d?Ni(T,t,M,p,m,_,C,r,y,x,b,P):Oi(T,t,M,p,m,_,C,y,x,b,P);t.prepareDrawProgram(l,S,C.toUnwrapped());const A=[];t.terrain&&A.push(f.centroidVertexBuffer),v&&A.push(f.layoutVertexExtBuffer),S.draw(l,l.gl.TRIANGLES,s,o,a,e.CullFaceMode.backCCW,k,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,n.paint,t.transform.zoom,g,A)}}function _n(t,i,n,r,s,o){const a=[t=>{let i=t.canonical.x-1,n=t.wrap;return i<0&&(i=(1<<t.canonical.z)-1,n--),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},t=>{let i=t.canonical.x+1,n=t.wrap;return i===1<<t.canonical.z&&(i=0,n++),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)],l=e=>{const t=i.getSource().minzoom,n=e=>{const t=i.getTileByID(e);if(t&&t.hasData())return t.getBucket(s)},r=[0,-1,1];for(const i of r){if(e.overscaledZ+i<t)continue;const r=n(e.calculateScaledKey(e.overscaledZ+i));if(r)return r}},c=[0,0,0],h=(t,i)=>(c[0]=Math.min(t.min.y,i.min.y),c[1]=Math.max(t.max.y,i.max.y),c[2]=e.EXTENT-i.min.x>t.max.x?i.min.x-e.EXTENT:t.max.x,c),u=(t,i)=>(c[0]=Math.min(t.min.x,i.min.x),c[1]=Math.max(t.max.x,i.max.x),c[2]=e.EXTENT-i.min.y>t.max.y?i.min.y-e.EXTENT:t.max.y,c),d=[(e,t)=>h(e,t),(e,t)=>h(t,e),(e,t)=>u(e,t),(e,t)=>u(t,e)],p=new e.Point(0,0);let m,f,g;const _=(t,i,r,s,a)=>{const l=[[s?r:t,s?t:r,0],[s?r:i,s?i:r,0]],c=a<0?e.EXTENT+a:a,h=[s?c:(t+i)/2,s?(t+i)/2:c,0];return 0===r&&a<0||0!==r&&a>0?o.getForTilePoints(g,[h],!0,f):l.push(h),o.getForTilePoints(n,l,!0,m),Math.max(l[0][2],l[1][2],h[2])/o.exaggeration()};for(let y=0;y<4;y++){const t=(y<2?1:5)-y,i=r.borders[y];if(0===i.length)continue;const s=g=a[y](n),c=l(s);if(!(c&&c instanceof e.FillExtrusionBucket&&c.enableTerrain))continue;if(r.borderDoneWithNeighborZ[y]===c.canonical.z&&c.borderDoneWithNeighborZ[t]===r.canonical.z)continue;if(f=o.findDEMTileFor(s),!f||!f.dem)continue;if(!m){const e=o.findDEMTileFor(n);if(!e||!e.dem)return;m=e}const h=c.borders[t];let u=0;const v=c.borderDoneWithNeighborZ[t]!==r.canonical.z;if(r.canonical.z===c.canonical.z){for(let n=0;n<i.length;n++){const s=r.featuresOnBorder[i[n]],o=s.borders[y];let a;for(;u<h.length&&(a=c.featuresOnBorder[h[u]],!(a.borders[t][1]>o[0]+3));)v&&c.encodeCentroid(void 0,a,!1),u++;if(a&&u<h.length){const i=u;let n=0;for(;!(a.borders[t][0]>o[1]-3)&&(n++,++u!==h.length);)a=c.featuresOnBorder[h[u]];if(a=c.featuresOnBorder[h[i]],s.intersectsCount()>1||a.intersectsCount()>1||1!==n){1!==n&&(u=i),r.encodeCentroid(void 0,s,!1),v&&c.encodeCentroid(void 0,a,!1);continue}const l=d[y](s,a),m=y%2?e.EXTENT-1:0;p.x=_(l[0],Math.min(e.EXTENT-1,l[1]),m,y<2,l[2]),p.y=0,r.encodeCentroid(p,s,!1),v&&c.encodeCentroid(p,a,!1)}else r.encodeCentroid(void 0,s,!1)}r.borderDoneWithNeighborZ[y]=c.canonical.z,r.needsCentroidUpdate=!0,v&&(c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0)}else{for(const e of i)r.encodeCentroid(void 0,r.featuresOnBorder[e],!1);if(v){for(const e of h)c.encodeCentroid(void 0,c.featuresOnBorder[e],!1);c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[y]=c.canonical.z,r.needsCentroidUpdate=!0}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(t)}const yn=new e.Color(1,0,0,1),vn=new e.Color(0,1,0,1),xn=new e.Color(0,0,1,1),bn=new e.Color(1,0,1,1),wn=new e.Color(0,1,1,1);function Cn(t,i,n){const r=t.context,s=t.transform,o=r.gl,a="globe"===s.projection.name,l=a?["PROJECTION_GLOBE_VIEW"]:null;let c=n.projMatrix;if(a&&e.globeToMercatorTransition(s.zoom)>0){const t=e.transitionTileAABBinECEF(n.canonical,s),i=e.globeDenormalizeECEF(t);c=e.multiply(new Float32Array(16),s.globeMatrix,i),e.multiply(c,s.projMatrix,c)}const h=t.useProgram("debug",null,l),u=i.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(u,h);const d=e.DepthMode.disabled,p=e.StencilMode.disabled,m=t.colorModeForRenderPass(),f="$debug";r.activeTexture.set(o.TEXTURE0),t.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),a?u._makeGlobeTileDebugBuffers(t.context,s):u._makeDebugTileBoundsBuffers(t.context,s.projection);const g=u._tileDebugBuffer||t.debugBuffer,_=u._tileDebugIndexBuffer||t.debugIndexBuffer,y=u._tileDebugSegments||t.debugSegments;h.draw(r,o.LINE_STRIP,d,p,m,e.CullFaceMode.disabled,qi(c,e.Color.red),f,g,_,y,null,null,null,[u._globeTileDebugBorderBuffer]);const v=u.latestRawTileData,x=Math.floor((v&&v.byteLength||0)/1024),b=i.getTile(n).tileSize,w=512/Math.min(b,512)*(n.overscaledZ/s.zoom)*.5;let C=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(C+=" => "+n.overscaledZ),C+=` ${x}kb`,function(e,t){e.initDebugOverlayCanvas();const i=e.debugOverlayCanvas,n=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(i),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,C);const S=u._tileDebugTextBuffer||t.debugBuffer,E=u._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,T=u._tileDebugTextSegments||t.debugSegments;h.draw(r,o.TRIANGLES,d,p,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,qi(c,e.Color.transparent,w),f,S,E,T,null,null,null,[u._globeTileDebugTextBuffer])}function Sn(e,t,i,n){Tn(e,0,t+i/2,e.transform.width,i,n)}function En(e,t,i,n){Tn(e,t-i/2,0,i,e.transform.height,n)}function Tn(t,i,n,r,s,o){const a=t.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*e.exported.devicePixelRatio,n*e.exported.devicePixelRatio,r*e.exported.devicePixelRatio,s*e.exported.devicePixelRatio),a.clear({color:o}),l.disable(l.SCISSOR_TEST)}const Pn=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Mn}=Pn;function kn(e,t,i,n){e.emplaceBack(t,i,n)}class An{constructor(t){this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,kn(this.vertexArray,-1,-1,1),kn(this.vertexArray,1,-1,1),kn(this.vertexArray,-1,1,1),kn(this.vertexArray,1,1,1),kn(this.vertexArray,-1,-1,-1),kn(this.vertexArray,1,-1,-1),kn(this.vertexArray,-1,1,-1),kn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Mn),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}}function In(t,i,n,r,s,o){const a=t.gl,l=i.paint.get("sky-atmosphere-color"),c=i.paint.get("sky-atmosphere-halo-color"),h=i.paint.get("sky-atmosphere-sun-intensity"),u=((e,t,i,n,r)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:i,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(e.fromMat4(e.create$1(),r),s,h,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+o,i.skyboxTexture,0),n.draw(t,a.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,u,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Rn=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class On{constructor(t){const i=new e.StructArrayLayout5f20;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);const n=new e.StructArrayLayout3ui6;n.emplaceBack(0,1,2),n.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(i,Rn.members),this.indexBuffer=t.createIndexBuffer(n),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Nn={symbol:function(t,i,n,r,s){if("translucent"!==t.renderPass)return;const o=e.StencilMode.disabled,a=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,i,n,r,s,o,a){const l=i.transform,c="map"===s,h="map"===o;for(const u of t){const t=r.getTile(u),i=t.getBucket(n);if(!i||!i.text||!i.text.segments.get().length)continue;const s=e.evaluateSizeForZoom(i.textSizeData,l.zoom),o=yt(u,i.getProjection(),l),d=l.calculatePixelsToTileUnitsMatrix(t),p=Qe(o,t.tileID.canonical,h,c,l,i.getProjection(),d),m="none"!==n.layout.get("icon-text-fit")&&i.hasIconData();if(s){const n=Math.pow(2,l.zoom-t.tileID.overscaledZ);un(i,c,h,a,e.symbolSize,l,p,u,n,s,m)}}}(r,t,n,i,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),s),0!==n.paint.get("icon-opacity").constantOr(1)&&pn(t,i,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,a),0!==n.paint.get("text-opacity").constantOr(1)&&pn(t,i,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,a),i.map.showCollisionBoxes&&(ln(t,i,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),ln(t,i,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(t,i,n,r){if("translucent"!==t.renderPass)return;const s=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0===s.constantOr(1)&&(0===o.constantOr(1)||0===a.constantOr(1)))return;const c=t.context,h=c.gl,u=t.transform,d=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),p=e.StencilMode.disabled,m=t.colorModeForRenderPass(),f="globe"===u.projection.name,g=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],_=[];for(let v=0;v<r.length;v++){const s=r[v],o=i.getTile(s),a=o.getBucket(n);if(!a||a.projection.name!==u.projection.name)continue;const c=a.programConfigurations.get(n.id),h=Vi(n);f&&h.push("PROJECTION_GLOBE_VIEW");const d=t.useProgram("circle",c,h),p=a.layoutVertexBuffer,m=a.globeExtVertexBuffer,y=a.indexBuffer,x=u.projection.createInversionMatrix(u,s.canonical),b={programConfiguration:c,program:d,layoutVertexBuffer:p,globeExtVertexBuffer:m,indexBuffer:y,uniformValues:ji(t,s,o,x,g,n),tile:o};if(l){const t=a.segments.get();for(const i of t)_.push({segments:new e.SegmentVector([i]),sortKey:i.sortKey,state:b})}else _.push({segments:a.segments,sortKey:0,state:b})}l&&_.sort((e,t)=>e.sortKey-t.sortKey);const y={useDepthForOcclusion:!f};for(const v of _){const{programConfiguration:i,program:r,layoutVertexBuffer:s,globeExtVertexBuffer:o,indexBuffer:a,uniformValues:l,tile:f}=v.state,g=v.segments;t.terrain&&t.terrain.setupElevationDraw(f,r,y),t.prepareDrawProgram(c,r,f.tileID.toUnwrapped()),r.draw(c,h.TRIANGLES,d,p,m,e.CullFaceMode.disabled,l,n.id,s,a,g,n.paint,u.zoom,i,[o])}},heatmap:function(t,i,n,r){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const s=t.context,o=s.gl,a=e.StencilMode.disabled,l=new e.ColorMode([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,i,n){const r=e.gl,s=t.width*n,o=t.height*n;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,s,o]);let a=i.heatmapFbo;if(!a||a&&(a.width!==s||a.height!==o)){a&&a.destroy();const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),a=i.heatmapFbo=e.createFramebuffer(s,o,!1),function(e,t,i,n,r,s){const o=e.gl;o.texImage2D(o.TEXTURE_2D,0,e.isWebGL2&&e.extRenderToTextureHalfFloat?o.RGBA16F:o.RGBA,r,s,0,o.RGBA,e.extRenderToTextureHalfFloat?e.isWebGL2?o.HALF_FLOAT:e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(i)}(e,0,t,a,s,o)}else r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)}(s,t,n,"globe"===t.transform.projection.name?.5:.25),s.clear({color:e.Color.transparent});const c=t.transform,h="globe"===c.projection.name,u=h?["PROJECTION_GLOBE_VIEW"]:null,d=h?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,p=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)];for(let m=0;m<r.length;m++){const f=r[m];if(i.hasRenderableParent(f))continue;const g=i.getTile(f),_=g.getBucket(n);if(!_||_.projection.name!==c.projection.name)continue;const y=_.programConfigurations.get(n.id),v=t.useProgram("heatmap",y,u),{zoom:x}=t.transform;t.terrain&&t.terrain.setupElevationDraw(g,v),t.prepareDrawProgram(s,v,f.toUnwrapped());const b=c.projection.createInversionMatrix(c,f.canonical);v.draw(s,o.TRIANGLES,e.DepthMode.disabled,a,l,d,Gi(t,f,g,b,p,x,n.paint.get("heatmap-intensity")),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,n.paint,t.transform.zoom,y,h?[_.globeExtVertexBuffer]:null)}s.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){const n=t.context,r=n.gl,s=i.heatmapFbo;if(!s)return;n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),n.activeTexture.set(r.TEXTURE1);let o=i.colorRampTexture;o||(o=i.colorRampTexture=new e.Texture(n,i.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,r.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,((e,t,i,n)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,i),i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}(t,n))},line:function(t,i,n,r){if("translucent"!==t.renderPass)return;const s=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0===s.constantOr(1)||0===o.constantOr(1))return;const a=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),c=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,h=n.paint.get("line-dasharray"),u=h.constantOr(1),d=n.layout.get("line-cap"),p=n.paint.get("line-pattern"),m=p.constantOr(1),f=n.paint.get("line-gradient"),g=m?"linePattern":"line",_=t.context,y=_.gl,v=(e=>{const t=[];Ki(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=e.paint.get("line-trim-offset");0===i[0]&&0===i[1]||t.push("RENDER_LINE_TRIM_OFFSET");const n=e.paint.get("line-pattern").constantOr(1),r=1!==e.paint.get("line-opacity").constantOr(1);return!n&&r&&t.push("RENDER_LINE_ALPHA_DISCARD"),t})(n);let x=v.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(x=!1);for(const b of r){const r=i.getTile(b);if(m&&!r.patternsLoaded())continue;const s=r.getBucket(n);if(!s)continue;t.prepareDrawTile();const o=s.programConfigurations.get(n.id),w=t.useProgram(g,o,v),C=p.constantOr(null);if(C&&r.imageAtlas){const e=r.imageAtlas.patternPositions[C.toString()];e&&o.setConstantPatternPositions(e)}const S=h.constantOr(null),E=d.constantOr(null);if(!m&&S&&E&&r.lineAtlas){const e=r.lineAtlas.getDash(S,E);e&&o.setConstantPatternPositions(e)}let[T,P]=n.paint.get("line-trim-offset");if("round"===E||"square"===E){const e=1;T!==P&&(0===T&&(T-=e),1===P&&(P+=e))}const M=t.terrain?b.projMatrix:null,k=m?Zi(t,r,n,M,c):Wi(t,r,n,M,s.lineClipsArray.length,c,[T,P]);if(f){const r=s.gradients[n.id];let o=r.texture;if(n.gradientVersion!==r.version){let a=256;if(n.stepInterpolant){const n=i.getSource().maxzoom,r=b.canonical.z===n?Math.ceil(1<<t.transform.maxZoom-b.canonical.z):1;a=e.clamp(e.nextPowerOfTwo(s.maxLineLength/e.EXTENT*1024*r),256,_.maxTextureSize)}r.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:s.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new e.Texture(_,r.gradient,y.RGBA),r.version=n.gradientVersion,o=r.texture}_.activeTexture.set(y.TEXTURE1),o.bind(n.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}u&&(_.activeTexture.set(y.TEXTURE0),r.lineAtlasTexture.bind(y.LINEAR,y.REPEAT),o.updatePaintBuffers()),m&&(_.activeTexture.set(y.TEXTURE0),r.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),o.updatePaintBuffers()),t.prepareDrawProgram(_,w,b.toUnwrapped());const A=i=>{w.draw(_,y.TRIANGLES,a,i,l,e.CullFaceMode.disabled,k,n.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,n.paint,t.transform.zoom,o,[s.layoutVertexBuffer2])};if(x){const i=t.stencilModeForClipping(b).ref;0===i&&t.terrain&&_.clear({stencil:0});const n={func:y.EQUAL,mask:255};k.u_alpha_discard_threshold=.8,A(new e.StencilMode(n,i,255,y.KEEP,y.KEEP,y.INVERT)),k.u_alpha_discard_threshold=0,A(new e.StencilMode(n,i,255,y.KEEP,y.KEEP,y.KEEP))}else A(t.stencilModeForClipping(b))}x&&(t.resetStencilClippingMasks(),t.terrain&&_.clear({stencil:0}))},fill:function(t,i,n,r){const s=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0===o.constantOr(1))return;const a=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===s.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const s=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);fn(t,i,n,r,s,a,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){const s=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);fn(t,i,n,r,s,a,!0)}},"fill-extrusion":function(t,i,n,r){const s=n.paint.get("fill-extrusion-opacity");if(0!==s&&"translucent"===t.renderPass){const o=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==s||n.paint.get("fill-extrusion-pattern").constantOr(1))gn(t,i,n,r,o,e.StencilMode.disabled,e.ColorMode.disabled),gn(t,i,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{const s=t.colorModeForRenderPass();gn(t,i,n,r,o,e.StencilMode.disabled,s)}}},hillshade:function(t,i,n,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const s=t.context,o=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),a=t.colorModeForRenderPass(),l=t.terrain&&t.terrain.renderingToTexture,[c,h]="translucent"!==t.renderPass||l?[{},r]:t.stencilConfigForOverlap(r);for(const u of h){const r=i.getTile(u);if(r.needsHillshadePrepare&&"offscreen"===t.renderPass)fi(t,r,n,o,e.StencilMode.disabled,a);else if("translucent"===t.renderPass){const e=l&&t.terrain?t.terrain.stencilModeForRTTOverlap(u):c[u.overscaledZ];pi(t,u,r,n,o,e,a)}}s.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,i,n,r,s,o){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!r.length)return;const a=t.context,l=a.gl,c=i.getSource(),h=t.useProgram("raster"),u=t.colorModeForRenderPass(),d=t.terrain&&t.terrain.renderingToTexture,[p,m]=c instanceof Me||d?[{},r]:t.stencilConfigForOverlap(r),f=m[m.length-1].overscaledZ,g=!t.options.moving;for(const _ of m){const r=d?e.DepthMode.disabled:t.depthModeForSublayer(_.overscaledZ-f,1===n.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,l.LESS),s=_.toUnwrapped(),m=i.getTile(_);if(d&&(!m||!m.hasData()))continue;const y=d?_.projMatrix:t.transform.calculateProjMatrix(s,g),v=t.terrain&&d?t.terrain.stencilModeForRTTOverlap(_):p[_.overscaledZ],x=o?0:n.paint.get("raster-fade-duration");m.registerFadeDuration(x);const b=i.findLoadedParent(_,0),w=Ei(m,b,i,t.transform,x);let C,S;t.terrain&&t.terrain.prepareDrawTile();const E="nearest"===n.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),m.texture.bind(E,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),b?(b.texture.bind(E,l.CLAMP_TO_EDGE),C=Math.pow(2,b.tileID.overscaledZ-m.tileID.overscaledZ),S=[m.tileID.canonical.x*C%1,m.tileID.canonical.y*C%1]):m.texture.bind(E,l.CLAMP_TO_EDGE),m.texture.useMipmap&&a.extTextureFilterAnisotropic&&t.transform.pitch>20&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);const T=Yi(y,S||[0,0],C||1,w,n,c instanceof Me?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(a,h,s),c instanceof Me)c.boundsBuffer&&c.boundsSegments&&h.draw(a,l.TRIANGLES,r,e.StencilMode.disabled,u,e.CullFaceMode.disabled,T,n.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{const{tileBoundsBuffer:i,tileBoundsIndexBuffer:s,tileBoundsSegments:o}=t.getTileBoundsBuffers(m);h.draw(a,l.TRIANGLES,r,v,u,e.CullFaceMode.disabled,T,n.id,i,s,o)}}t.resetStencilClippingMasks()},background:function(t,i,n,r){const s=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0===o)return;const a=t.context,l=a.gl,c=t.transform,h=c.tileSize,u=n.paint.get("background-pattern");if(t.isPatternMissing(u))return;const d=!u&&1===s.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==d)return;const p=e.StencilMode.disabled,m=t.depthModeForSublayer(0,"opaque"===d?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),f=t.colorModeForRenderPass(),g=t.useProgram(u?"backgroundPattern":"background");let _,y=r;y||(_=t.getBackgroundTiles(),y=Object.values(_).map(e=>e.tileID)),u&&(a.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));for(const v of y){const d=v.toUnwrapped(),y=r?v.projMatrix:t.transform.calculateProjMatrix(d);t.prepareDrawTile();const x=i?i.getTile(v):_?_[v.key]:new e.Tile(v,h,c.zoom,t),b=u?sn(y,o,t,u,{tileID:v,tileSize:h}):rn(y,o,s);t.prepareDrawProgram(a,g,d);const{tileBoundsBuffer:w,tileBoundsIndexBuffer:C,tileBoundsSegments:S}=t.getTileBoundsBuffers(x);g.draw(a,l.TRIANGLES,m,p,f,e.CullFaceMode.disabled,b,n.id,w,C,S)}},sky:function(t,i,n){const r=t.transform,s="mercator"===r.projection.name||"globe"===r.projection.name?1:e.smoothstep(7,8,r.zoom),o=n.paint.get("sky-opacity")*s;if(0===o)return;const a=t.context,l=n.paint.get("sky-type"),c=new e.DepthMode(a.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),h=t.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===t.renderPass?n.needsSkyboxCapture(t)&&(function(t,i,n,r){const s=t.context,o=s.gl;let a=i.skyboxFbo;if(!a){a=i.skyboxFbo=s.createFramebuffer(32,32,!1),i.skyboxGeometry=new An(s),i.skyboxTexture=s.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,i.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(let e=0;e<6;++e)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}s.bindFramebuffer.set(a.framebuffer),s.viewport.set([0,0,32,32]);const l=i.getCenter(t,!0),c=t.useProgram("skyboxCapture"),h=new Float64Array(16);e.identity(h),e.rotateY(h,h,.5*-Math.PI),In(s,i,c,h,l,0),e.identity(h),e.rotateY(h,h,.5*Math.PI),In(s,i,c,h,l,1),e.identity(h),e.rotateX(h,h,.5*-Math.PI),In(s,i,c,h,l,2),e.identity(h),e.rotateX(h,h,.5*Math.PI),In(s,i,c,h,l,3),e.identity(h),In(s,i,c,h,l,4),e.identity(h),e.rotateY(h,h,Math.PI),In(s,i,c,h,l,5),s.viewport.set([0,0,t.width,t.height])}(t,n),n.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,i,n,r,s){const o=t.context,a=o.gl,l=t.transform,c=t.useProgram("skybox");o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,i.skyboxTexture);const h=((e,t,i,n,r)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:n,u_temporal_offset:r}))(l.skyboxMatrix,i.getCenter(t,!1),0,r,s);t.prepareDrawProgram(o,c),c.draw(o,a.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skybox",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,c,o,h):"gradient"===l&&"sky"===t.renderPass&&function(t,i,n,r,s){const o=t.context,a=o.gl,l=t.transform,c=t.useProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new An(o)),o.activeTexture.set(a.TEXTURE0);let h=i.colorRampTexture;h||(h=i.colorRampTexture=new e.Texture(o,i.colorRamp,a.RGBA)),h.bind(a.LINEAR,a.CLAMP_TO_EDGE);const u=((t,i,n,r,s)=>({u_matrix:t,u_color_ramp:0,u_center_direction:i,u_radius:e.degToRad(n),u_opacity:r,u_temporal_offset:s}))(l.skyboxMatrix,i.getCenter(t,!1),i.paint.get("sky-gradient-radius"),r,s);t.prepareDrawProgram(o,c),c.draw(o,a.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,u,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,c,o,h)},debug:function(e,t,i){for(let n=0;n<i.length;n++)Cn(e,t,i[n])},custom:function(t,i,n,r){const s=t.context,o=n.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&n.isLayerDraped()){if("offscreen"===t.renderPass){const i=o.prerender;if(i){if(t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const n=t.transform.pointMerc;i.call(o,s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[n.x,n.y],t.transform.pixelsPerMeterRatio)}else i.call(o,s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const i=o.renderToTile;if(i){const n=r[0].canonical,a=new e.MercatorCoordinate(n.x+r[0].wrap*(1<<n.z),n.y,n.z);s.setDepthMode(e.DepthMode.disabled),s.setStencilMode(e.StencilMode.disabled),s.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),i.call(o,s.gl,a),s.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),s.setStencilMode(e.StencilMode.disabled);const i="3d"===o.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);if(s.setDepthMode(i),"globe"===t.transform.projection.name){const i=t.transform.pointMerc;o.render(s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[i.x,i.y],t.transform.pixelsPerMeterRatio)}else o.render(s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState(),s.bindFramebuffer.set(null)}}else e.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Dn{constructor(t,i,n=!1){this.context=new Se(t,n),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(e,t){const i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ki(this,e));const n=this._terrain;this.transform.elevation=i?n:null,n.update(e,this.transform,t)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,n]=t.getFovAdjustedRange(this.transform._fov);if(i>n)return void(this.transform.fogCullDistSq=null);const r=i+.78*(n-i);this.transform.fogCullDistSq=r*r}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,i){if(this.width=t*e.exported.devicePixelRatio,this.height=i*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._layers[e].resize()}setup(){const t=this.context,i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);const n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);const r=new e.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);const s=new e.StructArrayLayout4i8;s.emplaceBack(0,0,0,0),s.emplaceBack(e.EXTENT,0,e.EXTENT,0),s.emplaceBack(0,e.EXTENT,0,e.EXTENT),s.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(s,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);const o=new e.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const a=new e.StructArrayLayout1ui2;for(const e of[0,1,3,2,0])a.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(a),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();const l=this.context.gl;this.stencilClearMode=new e.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new On(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,i=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,i.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,Si(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,i,n){if(!i||this.currentStencilSource===i.id||!t.isTileClipped()||!n||0===n.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of n)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=i.id;const r=this.context,s=r.gl;this.nextStencilID+n.length>256&&this.clearStencil(),r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of n){const t=i.getTile(a),n=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:c,tileBoundsSegments:h}=this.getTileBoundsBuffers(t);o.draw(r,s.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:s.ALWAYS,mask:0},n,255,s.KEEP,s.KEEP,s.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Si(a.projMatrix),"$clipping",l,c,h)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,i=this.context.gl;return new e.StencilMode({func:i.NOTEQUAL,mask:255},t,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const i=this.context.gl;return new e.StencilMode({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(t){const i=this.context.gl,n=t.sort((e,t)=>t.overscaledZ-e.overscaledZ),r=n[n.length-1].overscaledZ,s=n[0].overscaledZ-r+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();const t={};for(let n=0;n<s;n++)t[n+r]=new e.StencilMode({func:i.GEQUAL,mask:255},n+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=s,[t,n]}return[{[r]:e.StencilMode.disabled},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}depthModeForSublayer(t,i,n){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(n||this.context.gl.LEQUAL,i,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,i){this.style=t,this.options=i,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();const n=this.style.order,r=this.style._sourceCaches;for(const e in r){const t=r[e];t.used&&t.prepare(this.context)}const s={},o={},a={};for(const e in r){const t=r[e];s[e]=t.getVisibleCoordinates(),o[e]=s[e].slice().reverse(),a[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<n.length;e++)if(this.style._layers[n[e]].is3D()){this.opaquePassCutoff=e;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),!e.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const e of n){const i=this.style._layers[e],n=t._getLayerSourceCache(i);if(!i.hasOffscreenPass()||i.isHidden(this.transform.zoom))continue;const r=n?o[n.id]:void 0;("custom"===i.type||i.isSky()||r&&r.length)&&this.renderLayer(this,n,i,r)}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon];const l=this.terrain;if(l&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&l.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:i.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);if(e.isSky())continue;const r=i?o[i.id]:void 0;this._renderTileClippingMasks(e,i,r),this.renderLayer(this,i,e,r)}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,i){const n=t.context,r=n.gl,s=t.transform,o=new e.DepthMode(r.LEQUAL,e.DepthMode.ReadOnly,[0,1]),a=t.useProgram("globeAtmosphere",null,"globe"===s.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=e.globeToMercatorTransition(s.zoom),c=i.properties.get("color").toArray01(),h=i.properties.get("high-color").toArray01(),u=i.properties.get("space-color").toArray01PremultipliedAlpha(),d=e.identity$1([]);e.rotateY$1(d,d,-e.degToRad(s._center.lng)),e.rotateX$1(d,d,e.degToRad(s._center.lat)),e.rotateZ$1(d,d,s.angle),e.rotateX$1(d,d,-s._pitch);const p=e.fromQuat(new Float32Array(16),d),m=e.mapValue(i.properties.get("star-intensity"),0,1,0,.25),f=5e-4,g=e.mapValue(i.properties.get("horizon-blend"),0,1,f,.25),_=e.globeUseCustomAntiAliasing(t,n,s)&&g===f?s.worldSize/(2*Math.PI*1.025)-1:s.globeRadius,y=t.frameCounter/1e3%1,v=e.length(s.globeCenterInViewSpace),x=Math.sqrt(Math.pow(v,2)-Math.pow(_,2)),b=Math.acos(x/v),w=((t,i,n,r,s,o,a,l,c,h,u,d,p,m)=>({u_frustum_tl:t,u_frustum_tr:i,u_frustum_br:n,u_frustum_bl:r,u_horizon:s,u_transition:o,u_fadeout_range:a,u_color:l,u_high_color:c,u_space_color:h,u_star_intensity:u,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:d,u_horizon_angle:p,u_rotation_matrix:m}))(s.frustumCorners.TL,s.frustumCorners.TR,s.frustumCorners.BR,s.frustumCorners.BL,s.frustumCorners.horizon,l,g,c,h,u,m,y,b,p);t.prepareDrawProgram(n,a);const C=t.atmosphereBuffer;C&&a.draw(n,r.TRIANGLES,o,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",C.vertexBuffer,C.indexBuffer,C.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,i,e,i?o[i.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);if(e.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=i?("symbol"===e.type?a:o)[i.id]:void 0;this._renderTileClippingMasks(e,i,i?s[i.id]:void 0),this.renderLayer(this,i,e,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let i=null;e.values(this.style._layers).forEach(e=>{const n=t._getLayerSourceCache(e);n&&!e.isHidden(this.transform.zoom)&&(!i||i.getSource().maxzoom<n.getSource().maxzoom)&&(i=n)}),i&&this.options.showTileBoundaries&&Nn.debug(this,i,i.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Sn(e,e.transform.height-(t.top||0),3,yn),Sn(e,t.bottom||0,3,vn),En(e,t.left||0,3,xn),En(e,e.transform.width-(t.right||0),3,bn);const i=e.transform.centerPoint;!function(e,t,i,n){Tn(e,t-1,i-10,2,20,n),Tn(e,t-10,i-1,20,2,n)}(e,i.x,e.transform.height-i.y,wn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}renderLayer(e,t,i,n){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||n&&n.length)&&(this.id=i.id,this.gpuTimingStart(i),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(i.type)||e.terrain&&"custom"===i.type)&&Nn[i.type](e,t,i,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;let i=this.gpuTimers[e.id];i||(i=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),i.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const i in e){const n=e[i],r=this.context.extTimerQuery,s=r.getQueryObjectEXT(n.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n.query),t[i]=s}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.extTimerQuery;let i=0;for(const n of e)i+=t.getQueryObjectEXT(n,t.QUERY_RESULT_EXT)/1e6,t.deleteQueryEXT(n);return i}translatePosMatrix(t,i,n,r,s){if(!n[0]&&!n[1])return t;const o=s?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){const e=Math.sin(o),t=Math.cos(o);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}const a=[s?n[0]:A(i,n[0],this.transform.zoom),s?n[1]:A(i,n[1],this.transform.zoom),0],l=new Float32Array(16);return e.translate(l,t,a),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){return null===e||void 0!==e&&!this.imageManager.getPattern(e.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const e=this.terrain&&this.terrain.renderingToTexture,t=this.terrain&&0===this.terrain.exaggeration(),i=this.style&&this.style.fog,n=[];return this.terrainRenderModeElevated()&&n.push("TERRAIN"),"globe"===this.transform.projection.name&&n.push("GLOBE"),t&&n.push("ZERO_EXAGGERATION"),i&&!e&&0!==i.getOpacity(this.transform.pitch)&&n.push("FOG"),e&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}useProgram(e,t,i){this.cache=this.cache||{};const n=i||[],r=this.currentGlobalDefines().concat(n),s=Ai.cacheKey(li[e],e,r,t);return this.cache[s]||(this.cache[s]=new Ai(this.context,e,li[e],t,on[e],r)),this.cache[s]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,i,n){if(this.terrain&&this.terrain.renderingToTexture)return;const r=this.style.fog;if(r){const s=r.getOpacity(this.transform.pitch),o=((t,i,n,r,s,o,a,l,c,h,u)=>{const d=t.transform,p=i.properties.get("color").toArray01();p[3]=r;const m=t.frameCounter/1e3%1;return{u_fog_matrix:n?d.calculateFogTileMatrix(n):t.identityMat,u_fog_range:i.getFovAdjustedRange(d._fov),u_fog_color:p,u_fog_horizon_blend:i.properties.get("horizon-blend"),u_fog_temporal_offset:m,u_frustum_tl:s,u_frustum_tr:o,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:h,u_viewport:u,u_globe_transition:e.globeToMercatorTransition(d.zoom),u_is_globe:+("globe"===d.projection.name)}})(this,r,n,s,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);i.setFogUniformValues(t,o)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,i=this._backgroundTiles={},n=this.transform.coveringTiles({tileSize:512});for(const r of n)i[r.key]=t[r.key]||new e.Tile(r,512,this.transform.tileZoom,this);return i}clearBackgroundTiles(){this._backgroundTiles={}}}class zn{constructor(e=0,t=0,i=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=i,this.right=n}interpolate(t,i,n){return null!=i.top&&null!=t.top&&(this.top=e.number(t.top,i.top,n)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,i.bottom,n)),null!=i.left&&null!=t.left&&(this.left=e.number(t.left,i.left,n)),null!=i.right&&null!=t.right&&(this.right=e.number(t.right,i.right,n)),this}getCenter(t,i){const n=e.clamp((this.left+t-this.right)/2,0,t),r=e.clamp((this.top+i-this.bottom)/2,0,i);return new e.Point(n,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new zn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ln(t,i){const n=e.getColumn(t,3);e.fromQuat(t,i),e.setColumn(t,3,n)}function Bn(t,i){const n=e.identity$1([]);return e.rotateZ$1(n,n,-i),e.rotateX$1(n,n,-t),n}function Fn(t,i){const n=[t[0],t[1],0],r=[i[0],i[1],0];if(e.length(n)>=1e-15){const t=e.normalize([],n);e.scale$2(r,t,e.dot(r,t)),i[0]=r[0],i[1]=r[1]}const s=e.cross([],i,t);if(e.len(s)<1e-15)return null;const o=Math.atan2(-s[1],s[0]);return Bn(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),o)}class jn{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const i=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(i.x=e.wrap(i.x,0,1)),this._position=i}else this._position=null}lookAtPoint(t,i){if(this.orientation=null,!this.position)return;const n=this.position,r=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,s=e.MercatorCoordinate.fromLngLat(t,r),o=[s.x-n.x,s.y-n.y,s.z-n.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=Fn(o,i)}setPitchBearing(t,i){this.orientation=Bn(e.degToRad(t),e.degToRad(-i))}}class Vn{constructor(t,i){this._transform=e.identity([]),this.orientation=i,this.position=t}get mercatorPosition(){const t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var i;t&&e.setColumn(this._transform,3,[(i=t)[0],i[1],i[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.identity$1([]),t&&Ln(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Bn(e,t),Ln(this._transform,this._orientation)}forward(){const t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,i){const n=new Float64Array(16);return e.invert(n,this.getWorldToCamera(t,i)),n}getWorldToCameraPosition(t,i,n){const r=this.position;e.scale$2(r,r,-t);const s=new Float64Array(16);return e.fromScaling(s,[n,n,n]),e.translate(s,s,r),s[10]*=i,s}getWorldToCamera(t,i){const n=new Float64Array(16),r=new Float64Array(4),s=this.position;return e.conjugate(r,this._orientation),e.scale$2(s,s,-t),e.fromQuat(n,r),e.translate(n,n,s),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i,n}getCameraToClipPerspective(t,i,n,r){const s=new Float64Array(16);return e.perspective(s,t,i,n,r),s}getDistanceToElevation(t,i=!1){const n=0===t?0:e.mercatorZfromAltitude(t,i?e.latFromMercatorY(this.position[1]):this.position[1]),r=this.forward();return(n-this.position[2])/r[2]}clone(){return new Vn([...this.position],[...this.orientation])}}function Un(t,i){const n=Hn(t.projection,t.zoom,t.width,t.height),r=function(t,i,n,r,s){const o=new e.LngLat(n.lng-180*Gn,n.lat),a=new e.LngLat(n.lng+180*Gn,n.lat),l=t.project(o.lng,o.lat),c=t.project(a.lng,a.lat),h=-Math.atan2(c.y-l.y,c.x-l.x),u=e.MercatorCoordinate.fromLngLat(n);u.y=e.clamp(u.y,-1+Gn,1-Gn);const d=u.toLngLat(),p=t.project(d.lng,d.lat),m=e.MercatorCoordinate.fromLngLat(d);m.x+=Gn;const f=m.toLngLat(),g=t.project(f.lng,f.lat),_=Zn(g.x-p.x,g.y-p.y,h),y=e.MercatorCoordinate.fromLngLat(d);y.y+=Gn;const v=y.toLngLat(),x=t.project(v.lng,v.lat),b=Zn(x.x-p.x,x.y-p.y,h),w=Math.abs(_.x)/Math.abs(b.y),C=e.identity([]);e.rotateZ(C,C,-h*(1-(s?0:r)));const S=e.identity([]);return e.scale(S,S,[1,1-(1-w)*r,1]),S[4]=-b.x/b.y*r,e.rotateZ(S,S,h),e.multiply(S,C,S),S}(t.projection,0,t.center,n,i),s=qn(t);return e.scale(r,r,[s,s,1]),r}function qn(t){const i=t.projection,n=Hn(t.projection,t.zoom,t.width,t.height),r=Wn(i,t.center),s=Wn(i,e.LngLat.convert(i.center));return Math.pow(2,r*n+(1-n)*s)}function Hn(t,i,n,r,s=1/0){const o=t.range;if(!o)return 0;const a=Math.min(s,Math.max(n,r)),l=Math.log(a/1024)/Math.LN2;return e.smoothstep(o[0]+l,o[1]+l,i)}const Gn=1/4e4;function Wn(t,i){const n=e.clamp(i.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),r=new e.LngLat(i.lng-180*Gn,n),s=new e.LngLat(i.lng+180*Gn,n),o=t.project(r.lng,n),a=t.project(s.lng,n),l=e.MercatorCoordinate.fromLngLat(r),c=e.MercatorCoordinate.fromLngLat(s),h=a.x-o.x,u=a.y-o.y,d=c.x-l.x,p=c.y-l.y,m=Math.sqrt((d*d+p*p)/(h*h+u*u));return Math.log(m)/Math.LN2}function Zn(e,t,i){const n=Math.cos(i),r=Math.sin(i);return{x:e*n-t*r,y:e*r+t*n}}class $n{constructor(t,i,n,r,s,o,a){this.tileSize=512,this._renderWorldCopies=void 0===s||s,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=null==n?0:n,this._maxPitch=null==r?60:r,this.setProjection(o),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new zn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Vn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const e=new $n(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e,t=!1){const i=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||i)&&this._updateCameraOnTerrain(),(e||i)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);const r=!t(n,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.getProjection({name:"mercator"});const i=t!==this.projection.name;return i&&this._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.Point(this.width,this.height)}get bearing(){return e.wrap(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const i=-t*Math.PI/180;var n;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=(n=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);e[0]=n*l+s*a,e[1]=r*l+o*a,e[2]=n*-a+s*l,e[3]=r*-a+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop();let r=0,s=0;for(let o=0;o<i.length;o++){const a=new e.Point(i[o][0]*this.width,n+i[o][1]*(this.height-n)),l=t.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*c,s+=c}return 0===s?NaN:r/s}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*t,n=this._mercatorZfromZoom(e),r=this._mercatorZfromZoom(this._maxZoom),s=Math.max(n-i,r);this._setZoom(this._zoomFromMercatorZ(s))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let n;n=t.z<this._camera.position[2]?[i.x,i.y,i.z]:[t.x,t.y,t.z];const r=e.length(e.sub([],this._camera.position,n));return e.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let i=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(t.orientation)),t.position){const n=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,i=new jn;return i.position=new e.MercatorCoordinate(t[0],t[1],t[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);const i=e.transformQuat([],[0,0,-1],t),n=e.transformQuat([],[0,-1,0],t);if(n[2]<0)return!1;const r=Fn(i,n);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(t){const i=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;t[2]=e.clamp(t[2],r/n,r/i),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,i){this._unmodified=!1,this._edgeInsets.interpolate(e,t,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const i=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const n=this.pointCoordinate(new e.Point(0,0)),r=this.pointCoordinate(new e.Point(this.width,0)),s=this.pointCoordinate(new e.Point(this.width,this.height)),o=this.pointCoordinate(new e.Point(0,this.height)),a=Math.floor(Math.min(n.x,r.x,s.x,o.x)),l=Math.floor(Math.max(n.x,r.x,s.x,o.x)),c=1;for(let h=a-c;h<=l+c;h++)0!==h&&i.push(new e.UnwrappedTileID(h,t))}return i}coveringTiles(t){let i=this.coveringZoomLevel(t);const n=i,r=this.elevation&&!t.isTerrainDEM,s="mercator"===this.projection.name;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);const o=this.locationCoordinate(this.center),a=this.center.lat,l=1<<i,c=[l*o.x,l*o.y,0],h="globe"===this.projection.name,u=!h,d=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,u),p=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=l*e.mercatorZfromAltitude(1,this.center.lat),f=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),g=[l*p.x,l*p.y,f*(u?1:m)],_=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),y=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?i:0,v=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,x=t.isTerrainDEM?-v:this._elevation?this._elevation.getMinElevationBelowMSL():0,b=this.projection.isReprojectedInTileSpace?qn(this):1,w=t=>{const i=1/4e4,n=new e.MercatorCoordinate(t.x+i,t.y,t.z),r=new e.MercatorCoordinate(t.x,t.y+i,t.z),s=t.toLngLat(),o=n.toLngLat(),a=r.toLngLat(),l=this.locationCoordinate(s),c=this.locationCoordinate(o),h=this.locationCoordinate(a),u=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(h.x-l.x,h.y-l.y);return Math.sqrt(u*d)*b/i},C=t=>{const i=v,n=x;return{aabb:e.tileAABB(this,l,0,0,0,t,n,i,this.projection),zoom:0,x:0,y:0,minZ:n,maxZ:i,wrap:t,fullyVisible:!1}},S=[];let E=[];const T=i,P=t.reparseOverscaled?n:i,M=e=>e*e,k=M((f-this._centerAltitude)*m),A=e=>{if(!this._elevation||!e.tileID||!s)return;const t=this._elevation.getMinMaxForTile(e.tileID),i=e.aabb;t?(i.min[2]=t.min,i.max[2]=t.max,i.center[2]=(i.min[2]+i.max[2])/2):(e.shouldSplit=I(e),e.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=this._centerAltitude))},I=t=>{if(t.zoom<y)return!0;if(t.zoom===T)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const i=t.aabb.distanceX(g),s=t.aabb.distanceY(g);let o=k,l=1;if(h){o=M(t.aabb.distanceZ(g));const i=Math.pow(2,t.zoom),n=e.latFromMercatorY((t.y+1)/i),r=e.latFromMercatorY(t.y/i),s=Math.min(Math.max(a,n),r),c=e.circumferenceAtLatitude(s)/e.circumferenceAtLatitude(a);if(l=s===a?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,c/this._mercatorScaleRatio),this.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===T-1&&c>=.9)return!0}else if(r&&(o=M(t.aabb.distanceZ(g)*m)),this.projection.isReprojectedInTileSpace&&n<=5){const i=Math.pow(2,t.zoom),n=w(new e.MercatorCoordinate((t.x+.5)/i,(t.y+.5)/i));l=n>.85?1:n}const c=i*i+s*s+o;return c<M((1<<T-t.zoom)*_*l*((e,t)=>{if(t*M(.707)<e)return 1;const i=Math.sqrt(t/e);return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(o,k),c))};if(this.renderWorldCopies)for(let e=1;e<=3;e++)S.push(C(-e)),S.push(C(e));for(S.push(C(0));S.length>0;){const n=S.pop(),o=n.x,a=n.y;let u=n.fullyVisible;if(!u){const e=n.aabb.intersects(d);if(0===e)continue;u=2===e}if(n.zoom!==T&&I(n))for(let t=0;t<4;t++){const i=(o<<1)+t%2,c=(a<<1)+(t>>1),d={aabb:s?n.aabb.quadrant(t):e.tileAABB(this,l,n.zoom+1,i,c,n.wrap,n.minZ,n.maxZ,this.projection),zoom:n.zoom+1,x:i,y:c,wrap:n.wrap,fullyVisible:u,tileID:void 0,shouldSplit:void 0,minZ:n.minZ,maxZ:n.maxZ};r&&!h&&(d.tileID=new e.OverscaledTileID(n.zoom+1===T?P:n.zoom+1,n.wrap,n.zoom+1,i,c),A(d)),S.push(d)}else{const r=n.zoom===T?P:n.zoom;if(t.minzoom&&t.minzoom>r)continue;const s=c[0]-(.5+o+(n.wrap<<n.zoom))*(1<<i-n.zoom),l=c[1]-.5-a,h=n.tileID?n.tileID:new e.OverscaledTileID(r,n.wrap,n.zoom,o,a);E.push({tileID:h,distanceSq:s*s+l*l})}}if(this.fogCullDistSq){const i=this.fogCullDistSq,n=this.horizonLineFromTop();E=E.filter(r=>{const s=[0,0,0,1],o=[e.EXTENT,e.EXTENT,0,1],a=this.calculateFogTileMatrix(r.tileID.toUnwrapped());e.transformMat4$1(s,s,a),e.transformMat4$1(o,o,a);const l=e.getAABBPointSquareDist(s,o);if(0===l)return!0;let c=!1;const h=this._elevation;if(h&&l>i&&0!==n){const i=this.calculateProjMatrix(r.tileID.toUnwrapped());let s;t.isTerrainDEM||(s=h.getMinMaxForTile(r.tileID)),s||(s={min:x,max:v});const o=e.furthestTileCorner(this.rotation),a=[o[0]*e.EXTENT,o[1]*e.EXTENT,s.max];e.transformMat4(a,a,i),c=(1-a[1])*this.height*.5<n}return l<i||c})}return E.sort((e,t)=>e.distanceSq-t.distanceSq).map(e=>e.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const i=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),n=this.projection.project(t.lng,i);return new e.Point(n.x*this.worldSize,n.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,i){let n,r;const s=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;n=(i.x-s.x)/e,r=(i.y-s.y)/e}else{const e=this.pointCoordinate(i),t=this.pointCoordinate(s);n=e.x-t.x,r=e.y-t.y}const o=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(o.x-n,o.y-r))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,i){const n=i?e.mercatorZfromAltitude(i,t.lat):void 0,r=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(r.x,r.y,n)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,i){const n=null!=i?i:this._centerAltitude,r=[t.x,t.y,0,1],s=[t.x,t.y,1,1];e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(s,s,this.pixelMatrixInverse);const o=s[3];e.scale$1(r,r,1/r[3]),e.scale$1(s,s,1/o);const a=r[2],l=s[2];return{p0:r,p1:s,t:a===l?0:(n-a)/(l-a)}}screenPointToMercatorRay(t){const i=[t.x,t.y,0,1],n=[t.x,t.y,1,1];return e.transformMat4$1(i,i,this.pixelMatrixInverse),e.transformMat4$1(n,n,this.pixelMatrixInverse),e.scale$1(i,i,1/i[3]),e.scale$1(n,n,1/n[3]),i[2]=e.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,e.scale$1(i,i,1/this.worldSize),e.scale$1(n,n,1/this.worldSize),new e.Ray([i[0],i[1],i[2]],e.normalize([],e.sub([],n,i)))}rayIntersectionCoordinate(t){const{p0:i,p1:n,t:r}=t,s=e.mercatorZfromAltitude(i[2],this._center.lat),o=e.mercatorZfromAltitude(n[2],this._center.lat);return new e.MercatorCoordinate(e.number(i[0],n[0],r)/this.worldSize,e.number(i[1],n[1],r)/this.worldSize,e.number(s,o,r))}pointCoordinate(e,t=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let i=this.projection.pointCoordinate3D(this,t.x,t.y);if(i)return new e.MercatorCoordinate(i[0],i[1],i[2]);let n=0,r=this.horizonLineFromTop();if(t.y>r)return this.pointCoordinate(t);const s=.02*r,o=t.clone();for(let a=0;a<10&&r-n>s;a++){o.y=e.number(n,r,.66);const t=this.projection.pointCoordinate3D(this,o.x,o.y);t?(r=o.y,i=t):n=o.y}return i?new e.MercatorCoordinate(i[0],i[1],i[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(t);const i=this.pointCoordinate(t);return i.y>=0&&i.y<=1}_coordinatePoint(t,i){const n=i&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,r=[t.x*this.worldSize,t.y*this.worldSize,n+t.toAltitude(),1];return e.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new e.Point(r[0]/r[3],r[1]/r[3]):new e.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:i}=this._edgeInsets,n=this.height-this._edgeInsets.bottom,r=this.width-this._edgeInsets.right,s=this.pointLocation3D(new e.Point(i,t)),o=this.pointLocation3D(new e.Point(r,t)),a=this.pointLocation3D(new e.Point(r,n)),l=this.pointLocation3D(new e.Point(i,n));let c=Math.min(s.lng,o.lng,a.lng,l.lng),h=Math.max(s.lng,o.lng,a.lng,l.lng),u=Math.min(s.lat,o.lat,a.lat,l.lat),d=Math.max(s.lat,o.lat,a.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,m="globe"===this.projection.name?1:4,f=(t,i,n,r,s)=>{const o=(t+n)/2,a=(i+r)/2,l=new e.Point(o,a),{lng:g,lat:_}=this.pointLocation3D(l),y=Math.max(0,c-g,u-_,g-h,_-d);c=Math.min(c,g),h=Math.max(h,g),u=Math.min(u,_),d=Math.max(d,_),(s<m||y>p)&&(f(t,i,o,a,s+1),f(o,a,n,r,s+1))};if(f(i,t,r,t,1),f(r,t,r,n,1),f(r,n,i,n,1),f(i,n,i,t,1),"globe"===this.projection.name){const[t,i]=e.polesInViewport(this);t?(d=90,h=180,c=-180):i&&(u=-90,h=180,c=-180)}return new e.LngLatBounds(new e.LngLat(c,u),new e.LngLat(h,d))}_getBoundsRectangular(t,i){const{top:n,left:r}=this._edgeInsets,s=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,a=new e.Point(r,n),l=new e.Point(o,n),c=new e.Point(o,s),h=new e.Point(r,s);let u=this.pointCoordinate(a,t),d=this.pointCoordinate(l,t);const p=this.pointCoordinate(c,i),m=this.pointCoordinate(h,i),f=(e,t)=>(t.y-e.y)/(t.x-e.x);return u.y>1&&d.y>=0?u=new e.MercatorCoordinate((1-m.y)/f(m,u)+m.x,1):u.y<0&&d.y<=1&&(u=new e.MercatorCoordinate(-m.y/f(m,u)+m.x,0)),d.y>1&&u.y>=0?d=new e.MercatorCoordinate((1-p.y)/f(p,d)+p.x,1):d.y<0&&u.y<=1&&(d=new e.MercatorCoordinate(-p.y/f(p,d)+p.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(u)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(m)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce((e,t)=>{if(t.dem){const i=t.dem.tree;e.min=Math.min(e.min,i.minimums[0]),e.max=Math.max(e.max,i.maximums[0])}return e},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const i=t.key,n=this._distanceTileDataCache;if(n[i])return n[i];const r=t.canonical,s=1/this.height,o=this.cameraWorldSize,a=o/this.zoomScale(r.z),l=(r.x+Math.pow(2,r.z)*t.wrap)*a,c=r.y*a,h=this.point;h.x*=o/this.worldSize,h.y*=o/this.worldSize;const u=this.angle,d=Math.sin(-u),p=-Math.cos(-u);return n[i]={bearing:[d,p],center:[(h.x-l)*s,(h.y-c)*s],scale:a/e.EXTENT*s},n[i]}calculateFogTileMatrix(t){const i=t.key,n=this._fogTileMatrixCache;if(n[i])return n[i];const r=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.multiply(r,this.worldToFogMatrix,r),n[i]=new Float32Array(r),n[i]}calculateProjMatrix(t,i=!1){const n=t.key,r=i?this._alignedProjMatrixCache:this._projMatrixCache;if(r[n])return r[n];const s=this.calculatePosMatrix(t,this.worldSize);return e.multiply(s,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.alignedProjMatrix:this.projMatrix,s),r[n]=new Float32Array(s),r[n]}calculatePixelsToTileUnitsMatrix(t){const i=t.tileID.key,n=this._pixelsToTileUnitsCache;if(n[i])return n[i];const r=function(t,i){const{scale:n}=t.tileTransform,r=n*e.EXTENT/(t.tileSize*Math.pow(2,i.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return s=new Float32Array(4),l=(o=i.inverseAdjustmentMatrix)[1],c=o[2],h=o[3],d=(a=[r,r])[1],s[0]=o[0]*(u=a[0]),s[1]=l*u,s[2]=c*d,s[3]=h*d,s;var s,o,a,l,c,h,u,d}(t,this);return n[i]=r,n[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,i=e.fromScaling([],[t,t,t]);return e.multiply(i,i,this.globeMatrix),i}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(i),r=this._camera.forward(),s=e.mercatorZfromAltitude(1,this._center.lat);n[2]/=s,r[2]/=s,e.normalize(r,r);const o=t.raycast(n,r,t.exaggeration());if(o){const t=e.scaleAndAdd([],n,r,o),i=new e.MercatorCoordinate(t[0],t[1],e.mercatorZfromAltitude(t[2],e.latFromMercatorY(t[1]))),a=(i.z+e.length([i.x-n[0],i.y-n[1],i.z-n[2]*s]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=i.toAltitude(),this._center=this.coordinateLocation(i),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const i=this._elevation,n=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(n),s=i.getAtPointOrZero(new e.MercatorCoordinate(...r)),o=this.pixelsPerMeter/this.worldSize*s,a=this._minimumHeightOverTerrain(),l=r[2]-o;if(l<=a)if(l<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),i=[r[0],r[1],t.z-r[2]],n=e.length(i);i[2]-=(a-l)/this._pixelsPerMercatorPixel;const s=e.length(i);if(0===s)return;e.scale$2(i,i,n/s*this._pixelsPerMercatorPixel),this._camera.position=[r[0],r[1],t.z*this._pixelsPerMercatorPixel-i[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const i=this.center;return i.lat=e.clamp(i.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(i.lng=e.clamp(i.lng,this.minLng,this.maxLng)),this.center=i,void(this._constraining=!1)}const i=this._unmodified,{x:n,y:r}=this.point;let s=0,o=n,a=r;const l=this.width/2,c=this.height/2,h=this.worldMinY*this.scale,u=this.worldMaxY*this.scale;if(r-c<h&&(a=h+c),r+c>u&&(a=u-c),u-h<this.height&&(s=Math.max(s,this.height/(u-h)),a=(u+h)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,i=this.worldSize/2-(e+t)/2;o=(n+i+this.worldSize)%this.worldSize-i,o-l<e&&(o=e+l),o+l>t&&(o=t-l),t-e<this.width&&(s=Math.max(s,this.width/(t-e)),o=(t+e)/2)}o===n&&a===r||(this.center=this.unproject(new e.Point(o,a))),s&&(this.zoom+=this.scaleZoom(s)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.mercatorZfromAltitude(1,this.center.lat)/e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE));const n=Hn(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,n),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const r="meters"===this.projection.zAxisUnit?i:1,s=this._camera.getWorldToCamera(this.worldSize,r),o=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);o[8]=2*-t.x/this.width,o[9]=2*t.y/this.height;let a=e.mul([],o,s);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),i=e.identity([]);e.translate(i,i,[t.x*this.worldSize,t.y*this.worldSize,0]),e.multiply(i,i,Un(this)),e.translate(i,i,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.multiply(a,a,i),this.inverseAdjustmentMatrix=function(e){const t=Un(e,!0);return y([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],a,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=a,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);const l=e.invert([],o);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(l,this.horizonLineFromTop(),this.height);const c=new Float32Array(16);e.identity(c),e.scale(c,c,[1,-1,1]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle);const h=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),u=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;h[8]=2*-t.x/this.width,h[9]=2*(t.y+u)/this.height,this.skyboxMatrix=e.multiply(c,h,c);const d=this.point,p=d.x,m=d.y,f=this.width%2/2,g=this.height%2/2,_=Math.cos(this.angle),v=Math.sin(this.angle),x=p-Math.round(p)+_*f+v*g,b=m-Math.round(m)+_*g+v*f,w=new Float64Array(a);if(e.translate(w,w,[x>.5?x-1:x,b>.5?b-1:b,0]),this.alignedProjMatrix=w,a=e.create(),e.scale(a,a,[this.width/2,-this.height/2,1]),e.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=e.create(),e.scale(a,a,[1,-1,1]),e.translate(a,a,[-1,-1,0]),e.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},a=e.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=a,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(t,t,s),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=a;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,i=this.cameraPixelsPerMeter,n=this._camera.position,r=1/this.height/this._pixelsPerMercatorPixel,s=[t,t,i];e.scale$2(s,s,r),e.scale$2(n,n,-1),e.multiply$2(n,n,s);const o=e.create();e.translate(o,o,n),e.scale(o,o,s),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,i,r)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),n=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[n.x/this.worldSize-i[0]*r,n.y/this.worldSize-i[1]*r,e/this.worldSize*this._centerAltitude-i[2]*r]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=this._camera.position[2],r=t[2];let s=1;this.projection.wrap&&(this.center=this.center.wrap()),r>0&&(s=Math.min((i-n)/r,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,s),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,i=this._camera.forward(),{pitch:n,bearing:r}=this._camera.getPitchBearing(),s=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,o=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),a=Math.max((t[2]-s)/Math.cos(n),o),l=this._zoomFromMercatorZ(a);e.scaleAndAdd(t,t,i,a),this._pitch=e.clamp(n,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(r,-Math.PI,Math.PI),this._setZoom(e.clamp(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let i=0,n=e.GLOBE_ZOOM_THRESHOLD_MAX,r=0,s=1/0;for(;n-i>1e-6&&n>i;){const e=i+.5*(n-i),o=this.tileSize*Math.pow(2,e),a=this.getCameraToCenterDistance(this.projection,e,o),l=this.scaleZoom(a/(t*this.tileSize)),c=Math.abs(e-l);c<s&&(s=c,r=e),e<l?i=e:n=e}return r}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,i){const n=Math.min(t.x,i.x),r=Math.max(t.x,i.x),s=Math.min(t.y,i.y),o=Math.max(t.y,i.y);if(s<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new e.Point(n,s),new e.Point(r,o),new e.Point(n,o),new e.Point(r,s)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of a){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const i=this.rayIntersectionCoordinate(t);if(i.x<l||i.y<0||i.x>c||i.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.Point(0,0),new e.Point(this.width,this.height))}zoomDeltaToMovement(t,i){const n=e.length(e.sub([],this._camera.position,t)),r=this._zoomFromMercatorZ(n)+i;return n-this._mercatorZfromZoom(r)}getCameraPoint(){if("globe"===this.projection.name){const t=function([t,i,n],r){const s=[t,i,n,1];e.transformMat4$1(s,s,r);const o=s[3]=Math.max(s[3],1e-6);return s[0]/=o,s[1]/=o,s[2]/=o,s}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.Point(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))}}getCameraToCenterDistance(e,t=this.zoom,i=this.worldSize){const n=Hn(e,t,this.width,this.height,1024),r=e.pixelSpaceConversion(this.center.lat,i,n);return.5/Math.tan(.5*this._fov)*this.height*r}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.multiply(t,t,this.globeMatrix),t}}function Xn(e,t){let i=!1,n=null;const r=()=>{n=null,i&&(e(),n=setTimeout(r,t),i=!1)};return()=>(i=!0,n||r(),n)}class Kn{constructor(t){this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Xn(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const i=Yn(t);if(this._hashName){const t=this._hashName;let n=!1;const r=e.window.location.hash.slice(1).split("&").map(e=>{const r=e.split("=")[0];return r===t?(n=!0,`${r}=${i}`):e}).filter(e=>e);return n||r.push(`${t}=${i}`),"#"+r.join("&")}return"#"+i}_getCurrentHash(){const t=e.window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map(e=>e.split("=")).forEach(t=>{t[0]===this._hashName&&(e=t)}),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some(e=>isNaN(e))){const i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:i,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}function Yn(e,t){const i=e.getCenter(),n=Math.round(100*e.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,r),o=Math.round(i.lng*s)/s,a=Math.round(i.lat*s)/s,l=e.getBearing(),c=e.getPitch();let h=t?`/${o}/${a}/${n}`:`${n}/${a}/${o}`;return(l||c)&&(h+="/"+Math.round(10*l)/10),c&&(h+="/"+Math.round(c)),h}const Jn={linearity:.3,easing:e.bezier(0,0,.3,1)},Qn=e.extend({deceleration:2500,maxSpeed:1400},Jn),er=e.extend({deceleration:20,maxSpeed:1400},Jn),tr=e.extend({deceleration:1e3,maxSpeed:360},Jn),ir=e.extend({deceleration:1e3,maxSpeed:90},Jn);class nr{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,i=e.exported.now();for(;t.length>0&&i-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)i.zoom+=e.zoomDelta||0,i.bearing+=e.bearingDelta||0,i.pitch+=e.pitchDelta||0,e.panDelta&&i.pan._add(e.panDelta),e.around&&(i.around=e.around),e.pinchAround&&(i.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(i.pan.mag()){const s=sr(i.pan.mag(),n,e.extend({},Qn,t||{}));r.offset=i.pan.mult(s.amount/i.pan.mag()),r.center=this._map.transform.center,rr(r,s)}if(i.zoom){const e=sr(i.zoom,n,er);r.zoom=this._map.transform.zoom+e.amount,rr(r,e)}if(i.bearing){const t=sr(i.bearing,n,tr);r.bearing=this._map.transform.bearing+e.clamp(t.amount,-179,179),rr(r,t)}if(i.pitch){const e=sr(i.pitch,n,ir);r.pitch=this._map.transform.pitch+e.amount,rr(r,e)}if(r.zoom||r.bearing){const e=void 0===i.pinchAround?i.around:i.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),r.noMoveStart=!0,r}}function rr(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function sr(t,i,n){const{maxSpeed:r,linearity:s,deceleration:o}=n,a=e.clamp(t*s/(i/1e3),-r,r),l=Math.abs(a)/(o*s);return{easing:n.easing,duration:1e3*l,amount:a*(l/2)}}class or extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,n,r={}){const s=m(i.getCanvasContainer(),n),o=i.unproject(s);super(t,e.extend({point:s,lngLat:o,originalEvent:n},r)),this._defaultPrevented=!1,this.target=i}}class ar extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,n){const r="touchend"===t?n.changedTouches:n.touches,s=f(i.getCanvasContainer(),r),o=s.map(e=>i.unproject(e)),a=s.reduce((e,t,i,n)=>e.add(t.div(n.length)),new e.Point(0,0));super(t,{points:s,point:a,lngLats:o,lngLat:i.unproject(a),originalEvent:n}),this._defaultPrevented=!1}}class lr extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}}class cr{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new lr(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new or(e.type,this._map,e))}mouseup(e){this._map.fire(new or(e.type,this._map,e))}preclick(t){const i=e.extend({},t);i.type="preclick",this._map.fire(new or(i.type,this._map,i))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new or(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new or(e.type,this._map,e))}mouseover(e){this._map.fire(new or(e.type,this._map,e))}mouseout(e){this._map.fire(new or(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ar(e.type,this._map,e))}touchmove(e){this._map.fire(new ar(e.type,this._map,e))}touchend(e){this._map.fire(new ar(e.type,this._map,e))}touchcancel(e){this._map.fire(new ar(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new or(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new or("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new or(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ur{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(h(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const i=t,n=this._startPos,r=this._lastPos;if(!n||!r||r.equals(i)||!this._box&&i.dist(n)<this._clickTolerance)return;this._lastPos=i,this._box||(this._box=s("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const o=Math.min(n.x,i.x),a=Math.max(n.x,i.x),l=Math.min(n.y,i.y),c=Math.max(n.y,i.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${o}px,${l}px)`,this._box.style.width=a-o+"px",this._box.style.height=c-l+"px")})}mouseupWindow(t,i){if(!this._active)return;const n=this._startPos,r=i;if(n&&0===t.button){if(this.reset(),p(),n.x!==r.x||n.y!==r.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(n,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),u(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new e.Event(t,{originalEvent:i}))}}function dr(e,t){const i={};for(let n=0;n<e.length;n++)i[e[n].identifier]=t[n];return i}class pr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){const i=new e.Point(0,0);for(const e of t)i._add(e);return i.div(t.length)}(i),this.touches=dr(n,i)))}touchmove(e,t,i){if(this.aborted||!this.centroid)return;const n=dr(i,t);for(const r in this.touches){const e=n[r];(!e||e.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(e,t,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class mr{constructor(e){this.singleTap=new pr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,i){this.singleTap.touchstart(e,t,i)}touchmove(e,t,i){this.singleTap.touchmove(e,t,i)}touchend(e,t,i){const n=this.singleTap.touchend(e,t,i);if(n){const t=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(t&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class fr{constructor(){this._zoomIn=new mr({numTouches:1,numTaps:2}),this._zoomOut=new mr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,i){this._zoomIn.touchstart(e,t,i),this._zoomOut.touchstart(e,t,i)}touchmove(e,t,i){this._zoomIn.touchmove(e,t,i),this._zoomOut.touchmove(e,t,i)}touchend(e,t,i){const n=this._zoomIn.touchend(e,t,i),r=this._zoomOut.touchend(e,t,i);return n?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}):r?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(r)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const gr={0:1,2:2};class _r{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const i=g(e);this._correctButton(e,i)&&(this._lastPoint=t,this._eventButton=i)}mousemoveWindow(e,t){const i=this._lastPoint;if(i)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const i=gr[t];return void 0===e.buttons||(e.buttons&i)!==i}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(i,t)}mouseupWindow(e){this._lastPoint&&g(e)===this._eventButton&&(this._moved&&p(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yr extends _r{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class vr extends _r{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=.8*(t.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(e){e.preventDefault()}}class xr extends _r{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=-.5*(t.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(e){e.preventDefault()}}class br{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)}touchstart(e,t,i){return this._calculateTransform(e,t,i)}touchmove(t,i,n){if(this._active&&!(n.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===n.length&&!e.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,i,n)}}touchend(e,t,i){this._calculateTransform(e,t,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,n){n.length>0&&(this._active=!0);const r=dr(n,i),s=new e.Point(0,0),o=new e.Point(0,0);let a=0;for(const e in r){const t=r[e],i=this._touches[e];i&&(s._add(t),o._add(t.sub(i)),a++,r[e]=t)}if(this._touches=r,a<this._minTouches||!o.mag())return;const l=o.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=s("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))+"px")}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class wr{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,i){return{}}touchstart(e,t,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,i){const n=this._firstTwoTouches;if(!n)return;e.preventDefault();const[r,s]=n,o=Cr(i,t,r),a=Cr(i,t,s);if(!o||!a)return;const l=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],l,e)}touchend(e,t,i){if(!this._firstTwoTouches)return;const[n,r]=this._firstTwoTouches,s=Cr(i,t,n),o=Cr(i,t,r);s&&o||(this._active&&p(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Cr(e,t,i){for(let n=0;n<e.length;n++)if(e[n].identifier===i)return t[n]}function Sr(e,t){return Math.log(e/t)/Math.LN2}class Er extends wr{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Sr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sr(this._distance,i),pinchAround:t}}}function Tr(e,t){return 180*e.angleWith(t)/Math.PI}class Pr extends wr{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const i=this._vector;if(this._vector=e[0].sub(e[1]),i&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Tr(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,i=this._startVector;if(!i)return!1;const n=Tr(e,i);return Math.abs(n)<t}}function Mr(e){return Math.abs(e.y)>Math.abs(e.x)}class kr extends wr{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,Mr(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,i,n){const r=this._lastPoints;if(!r)return;const s=t[0].sub(r[0]),o=t[1].sub(r[1]);return this._map._cooperativeGestures&&!e.isFullscreen()&&n.touches.length<3||(this._valid=this.gestureBeginsVertically(s,o,n.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(s.y+o.y)/2*-.5})}gestureBeginsVertically(e,t,i){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,r=t.mag()>=2;if(!n&&!r)return;if(!n||!r)return null==this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const s=e.y>0==t.y>0;return Mr(e)&&Mr(t)&&s}}const Ar={panStep:100,bearingStep:15,pitchStep:10};class Ir{constructor(){const e=Ar;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,i=0,n=0,r=0,s=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),s=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:o=>{const a=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:Rr,zoom:t?Math.round(a)+t*(e.shiftKey?2:1):a,bearing:o.getBearing()+i*this._bearingStep,pitch:o.getPitch()+n*this._pitchStep,offset:[-r*this._panStep,-s*this._panStep],center:o.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Rr(e){return e*(2-e)}const Or=4.000244140625;class Nr{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let i=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=e.exported.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==i&&i%Or==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=m(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Or?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);const r=i(),s=Math.pow(2,r),o="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(o*n))),"wheel"===this._type&&(this._startZoom=r,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:i(),r=this._startZoom,s=this._easing;let o,a=!1;if("wheel"===this._type&&r&&s){const t=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),i=s(t);o=e.number(r,n,i),t<1?this._frameId||(this._frameId=!0):a=!0}else o=n,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-i(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=e.ease;if(this._prevEase){const t=this._prevEase,n=(e.exported.now()-t.start)/t.duration,r=t.easing(n+.01)-t.easing(n),s=.27/Math.sqrt(r*r+1e-4)*.01,o=Math.sqrt(.0729-s*s);i=e.bezier(s,o,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:i},i}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=s("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))+"px")}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Dr{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class zr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lr{constructor(){this._tap=new mr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=t[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,t,i))}touchmove(e,t,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const n=t[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,i)}touchend(e,t,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(e,t,i)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Br{constructor(e,t,i){this._el=e,this._mousePan=t,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fr{constructor(e,t,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jr{constructor(e,t,i,n){this._el=e,this._touchZoom=t,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vr=e=>e.zoom||e.drag||e.pitch||e.rotate;class Ur extends e.Event{}class qr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,i){const n=e.sub([],i,t);this.radius=e.length(n[2]<0?e.div([],n,this.constants):[n[0],n[1],0])}projectRay(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);const i=e.scale$2([],t,this.radius);if(i[2]>0){const t=e.scale$2([],[0,0,1],e.dot(i,[0,0,1])),n=e.scale$2([],e.normalize([],[i[0],i[1],0]),this.radius),r=e.add([],i,e.scale$2([],e.sub([],e.add([],n,t),i),2));i[0]=r[0],i[1]=r[1]}return i}}function Hr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Gr{constructor(t,i){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nr(t),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),e.bindAll(["handleEvent","handleWindowEvent"],this);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[e.window,"blur",void 0]];for(const[r,s,o]of this._listeners)r.addEventListener(s,r===e.window.document?this.handleWindowEvent:this.handleEvent,o)}destroy(){for(const[t,i,n]of this._listeners)t.removeEventListener(i,t===e.window.document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,i=t.getCanvasContainer();this._add("mapEvent",new cr(t,e));const n=t.boxZoom=new ur(t,e);this._add("boxZoom",n);const r=new fr,s=new zr;t.doubleClickZoom=new Dr(s,r),this._add("tapZoom",r),this._add("clickZoom",s);const o=new Lr;this._add("tapDragZoom",o);const a=t.touchPitch=new kr(t);this._add("touchPitch",a);const l=new vr(e),c=new xr(e);t.dragRotate=new Fr(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const h=new yr(e),u=new br(t,e);t.dragPan=new Br(i,h,u),this._add("mousePan",h),this._add("touchPan",u,["touchZoom","touchRotate"]);const d=new Pr,p=new Er;t.touchZoomRotate=new jr(i,p,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hr(t));const m=t.scrollZoom=new Nr(t,this);this._add("scrollZoom",m,["mousePan"]);const f=t.keyboard=new Ir;this._add("keyboard",f);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,i){this._handlers.push({handlerName:e,handler:t,allowed:i}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,i){for(const n in e)if(n!==i&&(!t||t.indexOf(n)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,e.type+"Window")}_getMapTouches(e){const t=[];for(const i of e)this._el.contains(i.target)&&t.push(i);return t}handleEvent(e,t){this._updatingCamera=!0;const i="renderFrame"===e.type,n=i?void 0:e,r={needsRenderFrame:!1},s={},o={},a=e.touches?this._getMapTouches(e.touches):void 0,l=a?f(this._el,a):i?void 0:m(this._el,e);for(const{handlerName:u,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let i;this._blockedByActive(o,p,u)?d.reset():d[t||e.type]&&(i=d[t||e.type](e,l,a),this.mergeHandlerResult(r,s,i,u,n),i&&i.needsRenderFrame&&this._triggerRenderFrame()),(i||d.isActive())&&(o[u]=d)}const c={};for(const u in this._previousActiveHandlers)o[u]||(c[u]=n);this._previousActiveHandlers=o,(Object.keys(c).length||Hr(r))&&(this._changes.push([r,s,c]),this._triggerRenderFrame()),(Object.keys(o).length||Hr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(t,i,n,r,s){if(!n)return;e.extend(t,n);const o={handlerName:r,originalEvent:n.originalEvent||s};void 0!==n.zoomDelta&&(i.zoom=o),void 0!==n.panDelta&&(i.drag=o),void 0!==n.pitchDelta&&(i.pitch=o),void 0!==n.bearingDelta&&(i.rotate=o)}_applyChanges(){const t={},i={},n={};for(const[r,s,o]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.aroundCoord&&(t.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.extend(i,s),e.extend(n,o);this._updateMapTransform(t,i,n),this._changes=[]}_updateMapTransform(t,i,n){const r=this._map,s=r.transform,o=e=>[e.x,e.y,e.z];if((e=>{const t=this._eventsInProgress.drag;return t&&!this._handlersById[t.handlerName].isActive()})()&&!Hr(t)){const e=s.zoom;s.cameraElevationReference="sea",s.recenterOnTerrain(),s.cameraElevationReference="ground",e!==s.zoom&&this._map._update(!0)}if(s._isCameraConstrained&&r._stop(!0),!Hr(t))return void this._fireEvents(i,n,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:h,around:u,aroundCoord:d,pinchAround:p}=t;s._isCameraConstrained&&(l>0&&(l=0),s._isCameraConstrained=!1),void 0!==p&&(u=p),(l||(e=>i[e]&&!this._eventsInProgress[e])("drag"))&&u&&(this._dragOrigin=o(s.pointCoordinate3D(u)),this._trackingEllipsoid.setup(s._camera.position,this._dragOrigin)),s.cameraElevationReference="sea",r._stop(!0),u=u||r.transform.centerPoint,c&&(s.bearing+=c),h&&(s.pitch+=h),s._updateCameraState();const m=[0,0,0];if(a)if("mercator"===s.projection.name){const e=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(u).dir),t=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(u.sub(a)).dir);m[0]=t[0]-e[0],m[1]=t[1]-e[1]}else{const t=s.pointCoordinate(u);if("globe"===s.projection.name){a=a.rotate(-s.angle);const i=s._pixelsPerMercatorPixel/s.worldSize;m[0]=-a.x*e.mercatorScale(e.latFromMercatorY(t.y))*i,m[1]=-a.y*e.mercatorScale(s.center.lat)*i}else{const e=s.pointCoordinate(u.sub(a));t&&e&&(m[0]=e.x-t.x,m[1]=e.y-t.y)}}const f=s.zoom,g=[0,0,0];if(l){const t=o(d||s.pointCoordinate3D(u)),i={dir:e.normalize([],e.sub([],t,s._camera.position))};if(i.dir[2]<0){const n=s.zoomDeltaToMovement(t,l);e.scale$2(g,i.dir,n)}}const _=e.add(m,m,g);s._translateCameraConstrained(_),l&&Math.abs(s.zoom-f)>1e-4&&s.recenterOnTerrain(),s.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(i,n,!0)}_fireEvents(t,i,n){const r=Vr(this._eventsInProgress),s=Vr(t),o={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(o[e+"start"]=i),this._eventsInProgress[e]=t[e]}!r&&s&&this._fireEvent("movestart",s.originalEvent);for(const e in o)this._fireEvent(e,o[e]);s&&this._fireEvent("move",s.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const a={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=i[t]||n,a[e+"end"]=l)}for(const e in a)this._fireEvent(e,a[e]);const c=Vr(this._eventsInProgress);if(n&&(r||s)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(i(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new e.Event("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new e.Event(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{this._frameId=void 0,this.handleEvent(new Ur("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Wr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zr extends e.Evented{constructor(t,i){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=i.bearingSnap,this._respectPrefersReducedMotion=!1!==i.respectPrefersReducedMotion,e.bindAll(["_renderFrameCallback"],this)}getCenter(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,i,n){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},i),n)}panTo(t,i,n){return this.easeTo(e.extend({center:t},i),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,i,n){return this.easeTo(e.extend({zoom:t},i),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,i,n){return this.easeTo(e.extend({bearing:t},i),n)}resetNorth(t,i){return this.rotateTo(0,e.extend({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,i){t=e.LngLatBounds.convert(t);const n=i&&i.bearing||0,r=i&&i.pitch||0,s=t.getNorthWest(),o=t.getSouthEast();return this._cameraForBounds(this.transform,s,o,n,r,i)}_extendCameraOptions(t){const i={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const e=t.padding;t.padding={top:e,bottom:e,right:e,left:e}}return t.padding=e.extend(i,t.padding),t}_minimumAABBFrustumDistance(e,t){const i=t.max[0]-t.min[0],n=t.max[1]-t.min[1];return i/n>e.aspect?i/(2*Math.tan(.5*e.fovX)*e.aspect):n/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,i,n,r,s,o){const a=t.clone(),l=this._extendCameraOptions(o);a.bearing=r,a.pitch=s;const c=e.LngLat.convert(i),h=e.LngLat.convert(n),u=.5*(c.lat+h.lat),d=.5*(c.lng+h.lng),p=e.latLngToECEF(u,d),m=e.normalize([],p),f=e.normalize([],e.cross([],m,[0,1,0])),g=e.cross([],f,m),_=[f[0],f[1],f[2],0,g[0],g[1],g[2],0,m[0],m[1],m[2],0,0,0,0,1],y=[p,e.latLngToECEF(c.lat,c.lng),e.latLngToECEF(h.lat,c.lng),e.latLngToECEF(h.lat,h.lng),e.latLngToECEF(c.lat,h.lng),e.latLngToECEF(u,c.lng),e.latLngToECEF(u,h.lng),e.latLngToECEF(c.lat,d),e.latLngToECEF(h.lat,d)];let v=e.Aabb.fromPoints(y.map(t=>[e.dot(f,t),e.dot(g,t),e.dot(m,t)]));const x=e.transformMat4([],v.center,_);0===e.squaredLength(x)&&e.set(x,0,0,1),e.normalize(x,x),e.scale$2(x,x,e.GLOBE_RADIUS),a.center=e.ecefToLatLng(x);const b=a.getWorldToCameraMatrix(),w=e.invert(new Float64Array(16),b);v=e.Aabb.applyTransform(v,e.multiply([],b,_)),e.transformMat4(x,x,b);const C=.5*(v.max[2]-v.min[2]),S=this._minimumAABBFrustumDistance(a,v),E=e.scale$2([],[0,0,1],C),T=e.add(E,x,E),P=S+(0===a.pitch?0:e.distance(x,T)),M=a.globeCenterInViewSpace,k=e.sub([],x,[M[0],M[1],M[2]]);e.normalize(k,k),e.scale$2(k,k,P);const A=e.add([],x,k);e.transformMat4(A,A,w);const I=e.earthRadius/e.GLOBE_RADIUS,R=e.length(A),O=e.mercatorZfromAltitude(Math.max(R*I-e.earthRadius,Number.EPSILON),0),N=Math.min(a.zoomFromMercatorZAdjusted(O),l.maxZoom);return N>.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"mercator"}),a.zoom=N,this._cameraForBounds(a,i,n,r,s,o)):{center:a.center,zoom:N,bearing:r,pitch:s}}queryTerrainElevation(t,i){const n=this.transform.elevation;return n?(i=e.extend({},{exaggerated:!0},i),n.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,i.exaggerated)):null}_cameraForBounds(t,i,n,r,s,o){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,i,n,r,s,o);const a=t.clone(),l=this._extendCameraOptions(o),c=a.padding;a.bearing=r,a.pitch=s;const h=e.LngLat.convert(i),u=e.LngLat.convert(n),d=new e.LngLat(h.lng,u.lat),p=new e.LngLat(u.lng,h.lat),m=a.project(h),f=a.project(u),g=this.queryTerrainElevation(h),_=this.queryTerrainElevation(u),y=this.queryTerrainElevation(d),v=this.queryTerrainElevation(p),x=[[m.x,m.y,Math.min(g||0,_||0,y||0,v||0)],[f.x,f.y,Math.max(g||0,_||0,y||0,v||0)]];let b=e.Aabb.fromPoints(x);const w=a.getWorldToCameraMatrix(),C=e.invert(new Float64Array(16),w);b=e.Aabb.applyTransform(b,w);const S=e.sub([],b.max,b.min),E=c.left||0,T=c.right||0,P=c.bottom||0,M=c.top||0,{left:k,right:A,top:I,bottom:R}=l.padding,O=.5*(E+T),N=.5*(M+P),D=Math.min(a.scaleZoom(a.scale*Math.min((a.width-(E+T+k+A))/S[0],(a.height-(P+M+R+I))/S[1])),l.maxZoom),z=a.scale/a.zoomScale(D);b=new e.Aabb([b.min[0]-(k+O)*z,b.min[1]-(R+N)*z,b.min[2]],[b.max[0]+(A+O)*z,b.max[1]+(I+N)*z,b.max[2]]);const L=.5*S[2],B=this._minimumAABBFrustumDistance(a,b),F=[0,0,1,0];e.transformMat4$1(F,F,w),e.normalize$2(F,F);const j=e.scale$2([],F,B+L),V=e.add([],b.center,j),U=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new e.Point(l.offset.x,l.offset.y):e.Point.convert(l.offset)).rotate(-e.degToRad(r));b.center[0]-=U.x*z,b.center[1]+=U.y*z,e.transformMat4(b.center,b.center,C),e.transformMat4(V,V,C);const q=[b.center[0],b.center[1],V[2]*a.pixelsPerMeter];e.scale$2(q,q,1/a.worldSize);const H=e.lngFromMercatorX(q[0]),G=e.latFromMercatorY(q[1]),W=Math.min(a._zoomFromMercatorZ(q[2]),l.maxZoom),Z=new e.LngLat(H,G);return a.mercatorFromTransition&&W<.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"globe"}),a.zoom=W,this._cameraForBounds(a,i,n,r,s,o)):{center:Z,zoom:W,bearing:r,pitch:s}}fitBounds(e,t,i){const n=this.cameraForBounds(e,t);return this._fitInternal(n,t,i)}fitScreenCoordinates(t,i,n,r,s){const o=e.Point.convert(t),a=e.Point.convert(i),l=new e.Point(Math.min(o.x,a.x),Math.min(o.y,a.y)),c=new e.Point(Math.max(o.x,a.x),Math.max(o.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(o,a))return this;const h=this.transform.pointLocation3D(l),u=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new e.Point(l.x,c.y)),p=this.transform.pointLocation3D(new e.Point(c.x,l.y)),m=[Math.min(h.lng,u.lng,d.lng,p.lng),Math.min(h.lat,u.lat,d.lat,p.lat)],f=[Math.max(h.lng,u.lng,d.lng,p.lng),Math.max(h.lat,u.lat,d.lat,p.lat)],g=r&&r.pitch?r.pitch:this.getPitch(),_=this._cameraForBounds(this.transform,m,f,n,g,r);return this._fitInternal(_,r,s)}_fitInternal(t,i,n){return t?(delete(i=e.extend(t,i)).padding,i.linear?this.easeTo(i,n):this.flyTo(i,n)):this}jumpTo(t,i){this.stop();const n=t.preloadOnly?this.transform.clone():this.transform;let r=!1,s=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(r=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(s=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),t.preloadOnly?(this._preloadTiles(n),this):(this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),r&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),s&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),o&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.warnOnce(Wr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,i){const n=this.transform;if(!n.projection.supportsFreeCamera)return e.warnOnce(Wr),this;this.stop();const r=n.zoom,s=n.pitch,o=n.bearing;n.setFreeCameraOptions(t);const a=r!==n.zoom,l=s!==n.pitch,c=o!==n.bearing;return this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),a&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),c&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),l&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)),this}easeTo(t,i){this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const n=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?+t.zoom:r,c="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:o,u="padding"in t?t.padding:n.padding,d=e.Point.convert(t.offset);let p,m,f;if("globe"===n.projection.name){const i=e.MercatorCoordinate.fromLngLat(n.center),r=d.rotate(-n.angle);i.x+=r.x/n.worldSize,i.y+=r.y/n.worldSize;const s=i.toLngLat(),o=e.LngLat.convert(t.center||s);this._normalizeCenter(o),p=n.centerPoint.add(r),m=new e.Point(i.x,i.y).mult(n.worldSize),f=new e.Point(e.mercatorXfromLng(o.lng),e.mercatorYfromLat(o.lat)).mult(n.worldSize).sub(m)}else{p=n.centerPoint.add(d);const i=n.pointLocation(p),r=e.LngLat.convert(t.center||i);this._normalizeCenter(r),m=n.project(i),f=n.project(r).sub(m)}const g=n.zoomScale(l-r);let _,y;t.around&&(_=e.LngLat.convert(t.around),y=n.locationPoint(_));const v=this._zooming||l!==r,x=this._rotating||s!==c,b=this._pitching||h!==o,w=!n.isPaddingEqual(u),C=n=>C=>{if(v&&(n.zoom=e.number(r,l,C)),x&&(n.bearing=e.number(s,c,C)),b&&(n.pitch=e.number(o,h,C)),w&&(n.interpolatePadding(a,u,C),p=n.centerPoint.add(d)),_)n.setLocationAtPoint(_,y);else{const e=n.zoomScale(n.zoom-r),t=l>r?Math.min(2,g):Math.max(.5,g),i=Math.pow(t,1-C),s=n.unproject(m.add(f.mult(C*i)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?s.wrap():s,p)}return t.preloadOnly||this._fireMoveEvents(i),n};if(t.preloadOnly){const e=this._emulate(C,t.duration,n);return this._preloadTiles(e),this}const S={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=v,this._rotating=x,this._pitching=b,this._padding=w,this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,S),this._ease(C(n),e=>{n.recenterOnTerrain(),this._afterEase(i,e)},t),this}_prepareEase(t,i,n={}){this._moving=!0,this.transform.cameraElevationReference="sea",i||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const n=this._zooming,r=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),s&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}flyTo(t,i){if(this._prefersReducedMotion(t)){const n=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,i)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);const n=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?e.clamp(+t.zoom,n.minZoom,n.maxZoom):r,c="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:o,u="padding"in t?t.padding:n.padding,d=n.zoomScale(l-r),p=e.Point.convert(t.offset);let m=n.centerPoint.add(p);const f=n.pointLocation(m),g=e.LngLat.convert(t.center||f);this._normalizeCenter(g);const _=n.project(f),y=n.project(g).sub(_);let v=t.curve;const x=Math.max(n.width,n.height),b=x/d,w=y.mag();if("minZoom"in t){const i=e.clamp(Math.min(t.minZoom,r,l),n.minZoom,n.maxZoom),s=x/n.zoomScale(i-r);v=Math.sqrt(s/w*2)}const C=v*v;function S(e){const t=(b*b-x*x+(e?-1:1)*C*C*w*w)/(2*(e?b:x)*C*w);return Math.log(Math.sqrt(t*t+1)-t)}function E(e){return(Math.exp(e)-Math.exp(-e))/2}function T(e){return(Math.exp(e)+Math.exp(-e))/2}const P=S(0);let M=function(e){return T(P)/T(P+v*e)},k=function(e){return x*((T(P)*(E(t=P+v*e)/T(t))-E(P))/C)/w;var t},A=(S(1)-P)/v;if(Math.abs(w)<1e-6||!isFinite(A)){if(Math.abs(x-b)<1e-6)return this.easeTo(t,i);const e=b<x?-1:1;A=Math.abs(Math.log(b/x))/v,k=function(){return 0},M=function(t){return Math.exp(e*v*t)}}t.duration="duration"in t?+t.duration:1e3*A/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const I=s!==c,R=h!==o,O=!n.isPaddingEqual(u),N=n=>d=>{const f=d*A,v=1/M(f);n.zoom=1===d?l:r+n.scaleZoom(v),I&&(n.bearing=e.number(s,c,d)),R&&(n.pitch=e.number(o,h,d)),O&&(n.interpolatePadding(a,u,d),m=n.centerPoint.add(p));const x=1===d?g:n.unproject(_.add(y.mult(k(f))).mult(v));return n.setLocationAtPoint(n.renderWorldCopies?x.wrap():x,m),n._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(i),n};if(t.preloadOnly){const e=this._emulate(N,t.duration,n);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=I,this._pitching=R,this._padding=O,this._prepareEase(i,!1),this._ease(N(n),()=>this._afterEase(i),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,i,n){!1===n.animate||0===n.duration?(t(1),i()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,i){t=e.wrap(t,-180,180);const n=Math.abs(t-i);return Math.abs(t-360-i)<n&&(t-=360),Math.abs(t+360-i)<n&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.maxBounds)return;const i=e.lng-t.center.lng;e.lng+=i>180?-360:i<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&e.exported.prefersReducedMotion&&!(t&&t.essential)}_emulate(e,t,i){const n=Math.ceil(15*t/1e3),r=[],s=e(i.clone());for(let o=0;o<=n;o++){const e=s(o/n);r.push(e.clone())}return r}}class $r{constructor(t={}){this.options=t,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact;return this._map=e,this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=s("button","mapboxgl-ctrl-attrib-button",this._container),s("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const i=this._map._getUIString("AttributionControl."+t);e.setAttribute("aria-label",i),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){const n=i.reduce((e,t,n)=>(t.value&&(e+=`${t.key}=${t.value}${n<i.length-1?"&":""}`),e),"?");t.href=`${e.config.FEEDBACK_URL}/${n}#${Yn(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._sourceCaches;for(const n in t){const i=t[n];if(i.used){const t=i.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort((e,t)=>e.length-t.length),e=e.filter((t,i)=>{for(let n=i+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Xr{constructor(){e.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=s("div","mapboxgl-ctrl");const t=s("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const i=e[t].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class Kr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,i=t?this._queue.concat(t):this._queue;for(const n of i)if(n.id===e)return void(n.cancelled=!0)}run(e=0){const t=this._currentlyRunning=this._queue;this._queue=[];for(const i of t)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Yr(t,i,n){if(t=new e.LngLat(t.lng,t.lat),i){const r=new e.LngLat(t.lng-360,t.lat),s=new e.LngLat(t.lng+360,t.lat),o=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),a=n.locationPoint(t).distSqr(i),l=i.x<0||i.y<0||i.x>n.width||i.y>n.height;n.locationPoint(r).distSqr(i)<a&&(l||Math.abs(r.lng-n.center.lng)<o)?t=r:n.locationPoint(s).distSqr(i)<a&&(l||Math.abs(s.lng-n.center.lng)<o)&&(t=s)}for(;Math.abs(t.lng-n.center.lng)>180;){const e=n.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=n.width&&e.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const Jr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Qr extends e.Evented{constructor(t,i){if(super(),(t instanceof e.window.HTMLElement||i)&&(t=e.extend({element:t},i)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=s("div");const i=41,n=27,r=o("svg",{display:"block",height:i*this._scale+"px",width:n*this._scale+"px",viewBox:`0 0 ${n} ${i}`},this._element),a=o("radialGradient",{id:"shadowGradient"},o("defs",{},r));o("stop",{offset:"10%","stop-opacity":.4},a),o("stop",{offset:"100%","stop-opacity":.05},a),o("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},r),o("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},r),o("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},r),o("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},r),this._offset=e.Point.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",e=>{e.preventDefault()}),this._element.addEventListener("mousedown",e=>{e.preventDefault()});const n=this._element.classList;for(const e in Jr)n.remove("mapboxgl-marker-anchor-"+e);n.add("mapboxgl-marker-anchor-"+this._anchor),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,i=13.5,n=Math.sqrt(Math.pow(i,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-i+n)],"bottom-right":[-n,-1*(t-i+n)],left:[i,-1*(t-i)],right:[-i,-1*(t-i)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,i=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==i&&13!==i||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,i=this._element;this._popup&&(t===i||i.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const i=e.unproject(t),n=e.getFreeCameraOptions();if(!n.position)return!1;const r=n.position.toLngLat();return r.distanceTo(i)<.9*r.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const i=this._pos;if(!i||i.x<0||i.x>t.transform.width||i.y<0||i.y>t.transform.height)return void this._clearFadeTimer();const n=t.unproject(i);let r;t._showingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?r=0:(r=1-t._queryFogOpacity(n),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(r*=this._occludedOpacity)),this._element.style.opacity=""+r,this._element.style.pointerEvents=r>0?"auto":"none",this._popup&&this._popup._setOpacity(r),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${e.x}px,${e.y}px)\n            ${Jr[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${t.x}px,${t.y}px)\n        `}_calculateXYTransform(){const t=this._pos,i=this._map,n=this.getPitchAlignment();if(!i||!t||"map"!==n)return"";if(!i._showingGlobe()){const e=i.getPitch();return e?`rotateX(${e}deg)`:""}const r=e.radToDeg(e.globeTiltAtLngLat(i.transform,this._lngLat)),s=t.sub(e.globeCenterToScreenPoint(i.transform)),o=Math.abs(s.x)+Math.abs(s.y);if(0===o)return"";const a=r/o;return`rotateX(${-s.y*a}deg) rotateY(${s.x*a}deg)`}_calculateZTransform(){const t=this._pos,i=this._map;if(!i||!t)return"";let n=0;const r=this.getRotationAlignment();if("map"===r)if(i._showingGlobe()){const t=i.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),r=i.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);n=e.radToDeg(Math.atan2(r.y,r.x))-90}else n=-i.getBearing();else if("horizon"===r){const r=e.smoothstep(4,6,i.getZoom()),s=e.globeCenterToScreenPoint(i.transform);s.y+=r*i.transform.height;const o=t.sub(s),a=e.radToDeg(Math.atan2(o.y,o.x));n=(a>90?a-270:a+90)*(1-r)}return n+=this._rotation,n?`rotateZ(${n}deg)`:""}_update(t){e.window.cancelAnimationFrame(this._updateFrameId);const i=this._map;i&&(i.transform.renderWorldCopies&&(this._lngLat=Yr(this._lngLat,this._pos,i.transform)),this._pos=i.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),i._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(i._showingGlobe()||i.getTerrain()||i.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=e.Point.convert(t),this._update(),this}_onMove(t){const i=this._map;if(!i)return;const n=this._pointerdownPos,r=this._positionDelta;if(n&&r){if(!this._isDragging){const e=this._clickTolerance||i._clickTolerance;if(t.point.dist(n)<e)return;this._isDragging=!0}this._pos=t.point.sub(r),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,i=this._pos;t&&i&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(i),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const es={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ts=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function is(t=new e.Point(0,0),i="bottom"){if("number"==typeof t){const n=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(i){case"top":return new e.Point(0,t);case"top-left":return new e.Point(n,n);case"top-right":return new e.Point(-n,n);case"bottom":return new e.Point(0,-t);case"bottom-left":return new e.Point(n,-n);case"bottom-right":return new e.Point(-n,-n);case"left":return new e.Point(t,0);case"right":return new e.Point(-t,0)}return new e.Point(0,0)}return t instanceof e.Point||Array.isArray(t)?e.Point.convert(t):e.Point.convert(t[i]||[0,0])}class ns{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const i=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,i){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+i}}const rs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ss={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},os={showCompass:!0,showZoom:!0,visualizePitch:!1};class as{constructor(t,i,n=!1){this._clickTolerance=10,this.element=i,this.mouseRotate=new vr({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,n&&(this.mousePitch=new xr({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),h()}move(e,t){const i=this.map,n=this.mouseRotate.mousemoveWindow(e,t),r=n&&n.bearingDelta;if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){const n=this.mousePitch.mousemoveWindow(e,t),r=n&&n.pitchDelta;r&&i.setPitch(i.getPitch()+r)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){u(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),m(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,m(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=f(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=f(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ls={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},cs={maxWidth:100,unit:"metric"},hs={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},us={version:e.version,supported:i,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:class extends Zr{constructor(t){if(e.LivePerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},ss,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new $n(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new Kr,this._domRenderTaskQueue=new Kr,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.uniqueId(),this._locale=e.extend({},rs,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ns(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1),e.window.addEventListener("orientationchange",this._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Gr(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),this._hash=t.hash&&new Kn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),t.attributionControl&&this.addControl(new $r({customAttribution:t.customAttribution})),this._logoControl=new Xr,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new e.Event(t.dataType+"data",t))}),this.on("dataloading",t=>{this.fire(new e.Event(t.dataType+"dataloading",t))})}_getMapId(){return this._mapId}addControl(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[i];return-1!==i.indexOf("bottom")?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),i&&this.fire(new e.Event("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?e.window.navigator.language:Array.isArray(t)?0===t.length?void 0:t.map(t=>"auto"===t?e.window.navigator.language:t):t}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,i=t.projection.name;let n;"globe"===i&&t.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(t.setMercatorFromTransition(),n=!0):"mercator"===i&&t.zoom<e.GLOBE_ZOOM_THRESHOLD_MAX&&(t.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let i;if(i="globe"===t.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const e in this.style._sourceCaches)this.style._sourceCaches[e].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}unproject(t){return this.transform.pointLocation3D(e.Point.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,i){if("mouseenter"===e||"mouseover"===e){let n=!1;const r=r=>{const s=t.filter(e=>this.getLayer(e)),o=s.length?this.queryRenderedFeatures(r.point,{layers:s}):[];o.length?n||(n=!0,i.call(this,new or(e,this,r.originalEvent,{features:o}))):n=!1},s=()=>{n=!1};return{layers:new Set(t),listener:i,delegates:{mousemove:r,mouseout:s}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const r=r=>{const s=t.filter(e=>this.getLayer(e));(s.length?this.queryRenderedFeatures(r.point,{layers:s}):[]).length?n=!0:n&&(n=!1,i.call(this,new or(e,this,r.originalEvent)))},s=t=>{n&&(n=!1,i.call(this,new or(e,this,t.originalEvent)))};return{layers:new Set(t),listener:i,delegates:{mousemove:r,mouseout:s}}}{const n=e=>{const n=t.filter(e=>this.getLayer(e)),r=n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];r.length&&(e.features=r,i.call(this,e),delete e.features)};return{layers:new Set(t),listener:i,delegates:{[e]:n}}}}on(e,t,i){if(void 0===i)return super.on(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const r in n.delegates)this.on(r,n.delegates[r]);return this}once(e,t,i){if(void 0===i)return super.once(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,i);for(const r in n.delegates)this.once(r,n.delegates[r]);return this}off(e,t,i){if(void 0===i)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);const n=(e,t)=>{if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0},r=this._delegatedListeners?this._delegatedListeners[e]:void 0;return r&&(e=>{for(let r=0;r<e.length;r++){const s=e[r];if(s.listener===i&&n(s.layers,t)){for(const e in s.delegates)this.off(e,s.delegates[e]);return e.splice(r,1),this}}})(r),this}queryRenderedFeatures(t,i){return this.style?(void 0!==i||void 0===t||t instanceof e.Point||Array.isArray(t)||(i=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}isPointOnSurface(t){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&e.warnOnce(i+" projection does not support isPointOnSurface, this API may behave unexpectedly."),this.transform.isPointOnSurface(e.Point.convert(t))}setStyle(t,i){return!1!==(i=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(t,i))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new Kt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Kt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,i){if("string"==typeof t){const n=this._requestManager.normalizeStyleURL(t),r=this._requestManager.transformRequest(n,e.ResourceType.Style);e.getJSON(r,(t,n)=>{t?this.fire(new e.ErrorEvent(t)):n&&this._updateDiff(n,i)})}else"object"==typeof t&&this._updateDiff(t,i)}_updateDiff(t,i){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(t,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const i=e[t]._tiles;for(const e in i){const t=i[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,i){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,i)}removeSource(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,i,{pixelRatio:n=1,sdf:r=!1,stretchX:s,stretchY:o,content:a}={}){if(this._lazyInitEmptyStyle(),i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap){const{width:l,height:c,data:h}=e.exported.getImageData(i);this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},h),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=i,h=i;this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},new Uint8Array(h.data)),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0,userImage:h}),h.onAdd&&h.onAdd(this,t)}}updateImage(t,i){const n=this.style.getImage(t);if(!n)return void this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap?e.exported.getImageData(i):i,{width:s,height:o}=r;void 0!==s&&void 0!==o?s===n.data.width&&o===n.data.height?(n.data.replace(r.data,!(i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap)),this.style.updateImage(t,n)):this.fire(new e.ErrorEvent(new Error(`The width and height of the updated image (${s}, ${o})\n                must be that same as the previous version of the image\n                (${n.data.width}, ${n.data.height})`))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,i){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),(t,n)=>{i(t,n instanceof e.window.HTMLImageElement?e.exported.getImageData(n):n)})}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}setLayerZoomRange(e,t,i){return this.style.setLayerZoomRange(e,t,i),this._update(!0)}setFilter(e,t,i={}){return this.style.setFilter(e,t,i),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,i,n={}){return this.style.setPaintProperty(e,t,i,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,i,n={}){return this.style.setLayoutProperty(e,t,i,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let n,r,s,o=this._container;for(;o&&(!r||!s);){const t=e.window.getComputedStyle(o).transform;t&&"none"!==t&&(n=t.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&"0"!==n[0]&&"1"!==n[0]&&(r=n[0]),n[3]&&"0"!==n[3]&&"1"!==n[3]&&(s=n[3])),o=o.parentElement}this._containerWidth=r?Math.abs(t/r):t,this._containerHeight=s?Math.abs(i/s):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=s("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=s("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=s("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const i=this._controlContainer=s("div","mapboxgl-control-container",e),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(e=>{n[e]=s("div","mapboxgl-ctrl-"+e,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,i){const n=e.exported.devicePixelRatio||1;this._canvas.width=n*Math.ceil(t),this._canvas.height=n*Math.ceil(i),this._canvas.style.width=t+"px",this._canvas.style.height=i+"px"}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.extend({},i.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",t),r=n||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);r?(this._useWebGL2&&!n&&e.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),e.storeAuthState(r,!0),this.painter=new Dn(r,this.transform,!!n),this.on("data",e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)}),e.exported$1.testSupport(r)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let i;const n=this.painter.context.extTimerQuery,r=e.exported.now();if(this.listens("gpu-timing-frame")&&(i=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],e.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],e.window.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,i=this.transform.pitch,n=e.exported.now(),r=new e.EvaluationParameters(t,{now:n,fadeDuration:s,pitch:i,transition:this.style.getTransition()});this.style.update(r)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let o=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),o=this._updateAverageElevation(r),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):o=this._updateAverageElevation(r),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const t=e.exported.now()-r;n.endQueryEXT(n.TIME_ELAPSED_EXT,i),setTimeout(()=>{const s=n.getQueryObjectEXT(i,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(i),this.fire(new e.Event("gpu-timing-frame",{cpuTime:t,gpuTime:s})),e.window.performance.mark("frame-gpu",{startTime:r,detail:{gpuTime:s}})},50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout(()=>{const i=this.painter.queryGpuTimers(t);this.fire(new e.Event("gpu-timing-layer",{layerTimes:i}))},50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const i=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:i}))},50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(a||this._repaint)this.triggerRepaint();else{const t=!this.isMoving()&&this.loaded();if(t&&(o=this._updateAverageElevation(r,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&e.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const i=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);if((t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let n=this.transform.sampleAverageElevation(),r=!1;this.transform.elevation&&(r=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(n)?n=0:this._averageElevationLastSampledAt=e;const s=Math.abs(t-n);if(s>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(n),i(n);this._averageElevation.easeTo(n,e,300)}else if(s>1e-4)return this._averageElevation.jumpTo(n),i(n)}return!!this._averageElevation.isEasing(e)&&i(this._averageElevation.getValue(e))}_authenticate(){e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,t=>{if(t&&(t.message===e.AUTH_ERR_MSG||401===t.status)){const t=this.painter.context.gl;e.storeAuthState(t,!1),this._logoControl instanceof Xr&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const i=this.painter.context.gl,n=i.createFramebuffer();function r(e){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0);const t=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,t),t}return i.bindFramebuffer(i.FRAMEBUFFER,n),this._canvasPixelComparison(r(e),t.canvasCopies.map(r),t.timeStamps)}_canvasPixelComparison(e,t,i){let n=i[1]-i[0];const r=e.length/4;for(let s=0;s<t.length;s++){const o=t[s];let a=0;for(let t=0;t<o.length;t+=4)o[t]===e[t]&&o[t+1]===e[t+1]&&o[t+2]===e[t+2]&&o[t+3]===e[t+3]&&(a+=1);n+=(i[s+2]-i[s+1])*(1-a/r)}return n}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1),e.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame(e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)}))}_preloadTiles(t){const i=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(i,(e,i)=>e._preloadTiles(t,i),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===e.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(t,i){e.setCacheLimits(t,i)}get version(){return e.version}},NavigationControl:class{constructor(t){this.options=e.extend({},os,t),this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",e=>{this._map&&this._map.zoomIn({},{originalEvent:e})}),s("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",e=>{this._map&&this._map.zoomOut({},{originalEvent:e})}),s("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))}),this._compassIcon=s("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),i=t===e.getMaxZoom(),n=t===e.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new as(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const i=s("button",e,this._container);return i.type="button",i.addEventListener("click",t),i}_setButtonTitle(e,t){if(!this._map)return;const i=this._map._getUIString("NavigationControl."+t);e.setAttribute("aria-label",i),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}},GeolocateControl:class extends e.Evented{constructor(t){super(),this.options=e.extend({geolocation:e.window.navigator.geolocation},ls,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Xn(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const i=(e=!!this.options.geolocation)=>{this._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(e=>i("denied"!==e.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),i=e.coords;return!!t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}_updateCamera(t){const i=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=this._map.getBearing(),s=e.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(n),s,{geolocateSource:!0})}_updateMarker(t){if(t){const i=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,i=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,n=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=n+"px",this._circleElement.style.height=n+"px"}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=s("button","mapboxgl-ctrl-geolocate",this._container),s("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s("div","mapboxgl-user-location"),this._dotElement.appendChild(s("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(s("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Qr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=s("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.Event("trackuserlocationend")))})}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(e=>{"granted"===e&&t()}).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$r,ScaleControl:class{constructor(t){this.options=e.extend({},cs,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,i=t._containerHeight/2,n=t._containerWidth/2-e/2,r=t.unproject([n,i]),s=t.unproject([n+e,i]),o=r.distanceTo(s);if("imperial"===this.options.unit){const t=3.2808*o;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,o/1852,"nautical-mile"):o>=1e3?this._setScale(e,o/1e3,"kilometer"):this._setScale(e,o,"meter")}_setScale(e,t,i){this._map._requestDomTask(()=>{const n=function(e){const t=Math.pow(10,(""+Math.floor(e)).length-1);let i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(i),t*i}(t),r=n/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==i?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:i}).format(n):`${n}&nbsp;${hs[i]}`,this._container.style.width=e*r+"px"})}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=s("button","mapboxgl-ctrl-fullscreen",this._controlContainer);s("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.Evented{constructor(t){super(),this.options=e.extend(Object.create(es),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(e.window.document.createTextNode(t))}setHTML(t){const i=e.window.document.createDocumentFragment(),n=e.window.document.createElement("body");let r;for(n.innerHTML=t;r=n.firstChild,r;)i.appendChild(r);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=s("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=s("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.setAttribute("aria-hidden","true"),e.innerHTML="&#215;",e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,i=this._container,n=this._pos;if(!t||!i||!n)return"bottom";const r=i.offsetWidth,s=i.offsetHeight,o=n.x<r/2,a=n.x>t.transform.width-r/2;if(n.y+e<s)return o?"top-left":a?"top-right":"top";if(n.y>t.transform.height-s){if(o)return"bottom-left";if(a)return"bottom-right"}return o?"left":a?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push("mapboxgl-popup-anchor-"+this._anchor),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const i=this._map,n=this._content;if(!i||!this._lngLat&&!this._trackPointer||!n)return;let r=this._container;if(r||(r=this._container=s("div","mapboxgl-popup",i.getContainer()),this._tip=s("div","mapboxgl-popup-tip",r),r.appendChild(n)),this.options.maxWidth&&r.style.maxWidth!==this.options.maxWidth&&(r.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yr(this._lngLat,this._pos,i.transform)),!this._trackPointer||t){const e=this._pos=this._trackPointer&&t?t:i.project(this._lngLat),n=is(this.options.offset),r=this._anchor=this._getAnchor(n.y),s=is(this.options.offset,r),o=e.add(s).round();i._requestDomTask(()=>{this._container&&r&&(this._container.style.transform=`${Jr[r]} translate(${o.x}px,${o.y}px)`)})}if(!this._marker&&i._showingGlobe()){const t=e.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(ts);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=""+e),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:Qr,Style:Kt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:jn,Evented:e.Evented,config:e.config,prewarm:function(){Fe().acquire(ze)},clearPrewarmedResources:function(){const e=Be;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(ze),Be=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Le.workerCount},set workerCount(e){Le.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return us})),i}()},"4b23":function(e,t,i){"use strict";i.r(t),i.d(t,"nanoid",(function(){return a})),i.d(t,"customAlphabet",(function(){return o})),i.d(t,"customRandom",(function(){return s})),i.d(t,"urlAlphabet",(function(){return n})),i.d(t,"random",(function(){return r}));let n="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",r=e=>crypto.getRandomValues(new Uint8Array(e)),s=(e,t,i)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,r=-~(1.6*n*t/e.length);return(s=t)=>{let o="";for(;;){let t=i(r),a=r;for(;a--;)if(o+=e[t[a]&n]||"",o.length===s)return o}}},o=(e,t=21)=>s(e,t,r),a=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"")},"5K5J":function(e,t,i){var n;n=function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function t(t){return t.match(e)||[]}function i(e){return{language:(e=t(e))[1]||"",extlang:e[2]||"",script:e[3]||"",region:e[4]||""}}function n(e,t,i){Object.defineProperty(e,t,{value:i,enumerable:!0})}function r(e,r,s){function o(i){return t(i)[e]||""}n(o,"pattern",r),n(i,s,o)}return r(1,/^[a-zA-Z]{2,3}$/,"language"),r(2,/^[a-zA-Z]{3}$/,"extlang"),r(3,/^[a-zA-Z]{4}$/,"script"),r(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),n(i,"split",(function(e){return t(e).filter((function(e,t){return e&&t}))})),i},e.exports?e.exports=n():this.subtag=n()},"5k+i":function(e,t){function i(){}i.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const e={enableHighAccuracy:!0};return new Promise((function(t,i){window.navigator.geolocation.getCurrentPosition(t,i,e)}))}},e.exports=i},"73jG":function(e,t,i){"use strict";var n=i("jLWS");e.exports=function(e){var t,i=e.type||n.ERROR_HTTP;if(e.body)try{t=JSON.parse(e.body)}catch(s){t=e.body}else t=null;var r=e.message||null;r||("string"==typeof t?r=t:t&&"string"==typeof t.message?r=t.message:i===n.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=i,this.statusCode=e.statusCode||null,this.request=e.request,this.body=t}},"7fnu":function(e,t){function i(e){const t=e.address||"",i=e.text||"",n=e.place_name||"",r={address:n.split(",")[0],houseNumber:t,street:i,placeName:n};return e.context.forEach((function(e){const t=e.id.split(".")[0];r[t]=e.text})),r}e.exports={transformFeatureToGeolocationText:function(e,t){const n=i(e),r=["address","street","place","country"];if("function"==typeof t)return t(n);const s=r.indexOf(t);return(-1===s?r:r.slice(s)).reduce((function(e,t){return n[t]?(""!==e&&(e+=", "),e+n[t]):e}),"")},getAddressInfo:i,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},"9/5/":function(e,t){var i=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt,a="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,c=a||l||Function("return this")(),h=Object.prototype.toString,u=Math.max,d=Math.min,p=function(){return c.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function f(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var a=r.test(e);return a||s.test(e)?o(e.slice(2),a?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,i){var n,r,s,o,a,l,c=0,h=!1,g=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var i=n,s=r;return n=r=void 0,c=t,o=e.apply(s,i)}function v(e){return c=e,a=setTimeout(b,t),h?y(e):o}function x(e){var i=e-l;return void 0===l||i>=t||i<0||g&&e-c>=s}function b(){var e=p();if(x(e))return w(e);a=setTimeout(b,function(e){var i=t-(e-l);return g?d(i,s-(e-c)):i}(e))}function w(e){return a=void 0,_&&n?y(e):(n=r=void 0,o)}function C(){var e=p(),i=x(e);if(n=arguments,r=this,l=e,i){if(void 0===a)return v(l);if(g)return a=setTimeout(b,t),y(l)}return void 0===a&&(a=setTimeout(b,t)),o}return t=f(t)||0,m(i)&&(h=!!i.leading,s=(g="maxWait"in i)?u(f(i.maxWait)||0,t):s,_="trailing"in i?!!i.trailing:_),C.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=r=a=void 0},C.flush=function(){return void 0===a?o:w(p())},C}},"A1R+":function(e,t,i){"use strict";e.exports=r,e.exports.default=r;var n=i("U3f8");function r(e,t){if(!(this instanceof r))return new r(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function s(e,t,i){if(!i)return t.indexOf(e);for(var n=0;n<t.length;n++)if(i(e,t[n]))return n;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,i,n,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=t;o<i;o++)s=e.children[o],l(r,e.leaf?n(s):s);return r}function l(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function h(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,t,i,r,s){for(var o,a=[t,i];a.length;)(i=a.pop())-(t=a.pop())<=r||(o=t+Math.ceil((i-t)/r/2)*r,n(e,o,t,i,s),a.push(t,o,o,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],n=this.toBBox;if(!m(e,t))return i;for(var r,s,o,a,l=[];t;){for(r=0,s=t.children.length;r<s;r++)o=t.children[r],m(e,a=t.leaf?n(o):o)&&(t.leaf?i.push(o):p(e,a)?this._all(o,i):l.push(o));t=l.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!m(e,t))return!1;for(var n,r,s,o,a=[];t;){for(n=0,r=t.children.length;n<r;n++)if(s=t.children[n],m(e,o=t.leaf?i(s):s)){if(t.leaf||p(e,o))return!0;a.push(s)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=f([]),this},remove:function(e,t){if(!e)return this;for(var i,n,r,o,a=this.data,l=this.toBBox(e),c=[],h=[];a||c.length;){if(a||(a=c.pop(),n=c[c.length-1],i=h.pop(),o=!0),a.leaf&&-1!==(r=s(e,a.children,t)))return a.children.splice(r,1),c.push(a),this._condense(c),this;o||a.leaf||!p(a,l)?n?(i++,a=n.children[i],o=!1):a=null:(c.push(a),h.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:c,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,n){var r,s=i-t+1,a=this._maxEntries;if(s<=a)return o(r=f(e.slice(t,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(r=f([])).leaf=!1,r.height=n;var l,c,h,u,d=Math.ceil(s/a),p=d*Math.ceil(Math.sqrt(a));for(g(e,t,i,p,this.compareMinX),l=t;l<=i;l+=p)for(g(e,l,h=Math.min(l+p-1,i),d,this.compareMinY),c=l;c<=h;c+=d)u=Math.min(c+d-1,h),r.children.push(this._build(e,c,u,n-1));return o(r,this.toBBox),r},_chooseSubtree:function(e,t,i,n){for(var r,s,o,a,l,c,h,d,p,m;n.push(t),!t.leaf&&n.length-1!==i;){for(h=d=1/0,r=0,s=t.children.length;r<s;r++)l=u(o=t.children[r]),p=e,m=o,(c=(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-l)<d?(d=c,h=l<h?l:h,a=o):c===d&&l<h&&(h=l,a=o);t=a||t.children[0]}return t},_insert:function(e,t,i){var n=i?e:(0,this.toBBox)(e),r=[],s=this._chooseSubtree(n,this.data,t,r);for(s.children.push(e),l(s,n);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(n,r,t)},_split:function(e,t){var i=e[t],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),a=f(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,o(i,this.toBBox),o(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var n,r,s,o,l,c,h,d,p,m,f,g,_,y;for(c=h=1/0,n=t;n<=i-t;n++)p=r=a(e,0,n,this.toBBox),m=s=a(e,n,i,this.toBBox),f=Math.max(p.minX,m.minX),g=Math.max(p.minY,m.minY),_=Math.min(p.maxX,m.maxX),y=Math.min(p.maxY,m.maxY),o=Math.max(0,_-f)*Math.max(0,y-g),l=u(r)+u(s),o<c?(c=o,d=n,h=l<h?l:h):o===c&&l<h&&(h=l,d=n);return d},_chooseSplitAxis:function(e,t,i){var n=e.leaf?this.compareMinX:c,r=e.leaf?this.compareMinY:h;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)},_allDistMargin:function(e,t,i,n){e.children.sort(n);var r,s,o=this.toBBox,c=a(e,0,t,o),h=a(e,i-t,i,o),u=d(c)+d(h);for(r=t;r<i-t;r++)s=e.children[r],l(c,e.leaf?o(s):s),u+=d(c);for(r=i-t-1;r>=t;r--)s=e.children[r],l(h,e.leaf?o(s):s),u+=d(h);return u},_adjustParentBBoxes:function(e,t,i){for(var n=i;n>=0;n--)l(t[n],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():o(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},AxvH:function(e,t,i){"use strict";e.exports=function(e){return e?e.split(/,\s*</).reduce((function(e,t){var i=function(e){var t=e.match(/<?([^>]*)>(.*)/);if(!t)return null;var i=t[1],n=t[2].split(";"),r=null,s=n.reduce((function(e,t){var i=function(e){var t=e.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return t?{key:t[1],value:t[2]}:null}(t);return i?"rel"===i.key?(r||(r=i.value),e):(e[i.key]=i.value,e):e}),{});return r?{url:i,rel:r,params:s}:null}(t);return i?(i.rel.split(/\s+/).forEach((function(t){e[t]||(e[t]={url:i.url,params:i.params})})),e):e}),{}):{}}},Bi8L:function(e,t,i){"use strict";var n=i("R/WN");e.exports=n,"undefined"!=typeof window&&(window.Suggestions=n)},Cu2R:function(e,t,i){"use strict";var n=i("ncV3"),r=i("KXza");e.exports=function(e){return function(t){var i;i=n.prototype.isPrototypeOf(t)?t:r(t);var s=Object.create(e);return s.client=i,s}}},KXza:function(e,t,i){"use strict";var n=i("oGbY"),r=i("ncV3");function s(e){r.call(this,e)}(s.prototype=Object.create(r.prototype)).constructor=s,s.prototype.sendRequest=n.browserSend,s.prototype.abortRequest=n.browserAbort,e.exports=function(e){return new s(e)}},KtRk:function(e,t,i){"use strict";var n=i("U6jy"),r=i("pit/");e.exports=n(r,{file:function(e){if("undefined"!=typeof window){if(e instanceof global.Blob||e instanceof global.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof e&&void 0===e.pipe)return"Filename or Readable stream"},date:function(e){if("boolean"==typeof e)return"date";try{var t=new Date(e);if(t.getTime&&isNaN(t.getTime()))return"date"}catch(i){return"date"}},coordinates:function(e){return r.tuple(r.number,r.number)(e)},assertShape:function(e,t){return r.assert(r.strictShape(e),t)}})},LFDd:function(e,t,i){"use strict";var n=i("U6jy"),r=i("KtRk"),s=i("baNz"),o=i("eFQn"),a=i("Cu2R"),l={},c=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];l.forwardGeocode=function(e){r.assertShape({query:r.required(r.string),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),proximity:r.oneOf(r.coordinates,"ip"),types:r.arrayOf(r.oneOf(c)),autocomplete:r.boolean,bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),routing:r.boolean,fuzzyMatch:r.boolean,worldview:r.string})(e),e.mode=e.mode||"mapbox.places";var t=o(n({country:e.countries},s(e,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(e,["mode","query"]),query:t})},l.reverseGeocode=function(e){r.assertShape({query:r.required(r.coordinates),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),types:r.arrayOf(r.oneOf(c)),bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),reverseMode:r.oneOf("distance","score"),routing:r.boolean,worldview:r.string})(e),e.mode=e.mode||"mapbox.places";var t=o(n({country:e.countries},s(e,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(e,["mode","query"]),query:t})},e.exports=a(l)},"NkL+":function(e,t,i){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t;return"[object Object]"===n.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))}},"P8+q":function(e,t,i){var n;e.exports=n={},n.simpleFilter=function(e,t){return t.filter((function(t){return n.test(e,t)}))},n.test=function(e,t){return null!==n.match(e,t)},n.match=function(e,t,i){var n,r=0,s=[],o=t.length,a=0,l=0,c=(i=i||{}).pre||"",h=i.post||"",u=i.caseSensitive&&t||t.toLowerCase();e=i.caseSensitive&&e||e.toLowerCase();for(var d=0;d<o;d++)n=t[d],u[d]===e[r]?(n=c+n+h,r+=1,l+=1+l):l=0,a+=l,s[s.length]=n;return r===e.length?(a=u===e?1/0:a,{rendered:s.join(""),score:a}):null},n.filter=function(e,t,i){return t&&0!==t.length?"string"!=typeof e?t:(i=i||{},t.reduce((function(t,r,s,o){var a=r;i.extract&&(a=i.extract(r));var l=n.match(e,a,i);return null!=l&&(t[t.length]={string:l.rendered,score:l.score,index:s,original:r}),t}),[]).sort((function(e,t){return t.score-e.score||e.index-t.index}))):[]}},"R/WN":function(e,t,i){"use strict";var n=i("U6jy"),r=i("P8+q"),s=i("SX8C"),o=function(e,t,i){return this.options=n({minLength:2,limit:5,filter:!0,hideOnBlur:!0},i=i||{}),this.el=e,this.data=t||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(e){this.handleKeyUp(e.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(e){this.handleKeyDown(e)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(e){this.handlePaste(e)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};o.prototype.handleKeyUp=function(e){40!==e&&38!==e&&27!==e&&13!==e&&9!==e&&this.handleInputChange(this.el.value)},o.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},o.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},o.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout((function(){t.handleInputChange(e.target.value)}),100)}},o.prototype.handleInputChange=function(e){this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates((function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}).bind(this))},o.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},o.prototype.update=function(e){this.data=e,this.handleKeyUp()},o.prototype.clear=function(){this.data=[],this.list.clear()},o.prototype.normalize=function(e){return e.toLowerCase()},o.prototype.match=function(e,t){return e.indexOf(t)>-1},o.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},o.prototype.getCandidates=function(e){var t={pre:"<strong>",post:"</strong>",extract:(function(e){return this.getItemValue(e)}).bind(this)};e(this.options.filter?r.filter(this.query,this.data,t).map((function(e){return{original:e.original,string:this.render(e.original,e.string)}}).bind(this)):this.data.map((function(e){return{original:e,string:this.render(e)}}).bind(this)))},o.prototype.getItemValue=function(e){return e},o.prototype.render=function(e,t){if(t)return t;for(var i=this.getItemValue(e.original?e.original:e),n=this.normalize(i),r=n.lastIndexOf(this.query);r>-1;){var s=r+this.query.length;i=i.slice(0,r)+"<strong>"+i.slice(r,s)+"</strong>"+i.slice(s),r=n.slice(0,r).lastIndexOf(this.query)}return i},o.prototype.renderError=function(e){this.list.drawError(e)},e.exports=o},SX8C:function(e,t,i){"use strict";var n=function(e){return this.component=e,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};n.prototype.show=function(){this.element.style.display="block"},n.prototype.hide=function(){this.element.style.display="none"},n.prototype.add=function(e){this.items.push(e)},n.prototype.clear=function(){this.items=[],this.active=0},n.prototype.isEmpty=function(){return!this.items.length},n.prototype.isVisible=function(){return"block"===this.element.style.display},n.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()}else this.hide()},n.prototype.drawItem=function(e,t){var i=document.createElement("li"),n=document.createElement("a");t&&(i.className+=" active"),n.innerHTML=e.string,i.appendChild(n),this.element.appendChild(i),i.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),i.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,e)}).bind(this))},n.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()},n.prototype.move=function(e){this.active=e,this.draw()},n.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},n.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},n.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()},e.exports=n},"Smn/":function(e,t,i){"use strict";e.exports=function(e,t){return Object.keys(e).reduce((function(i,n){return i[n]=t(n,e[n]),i}),{})}},SsYf:function(e,t){e.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},U3f8:function(e,t,i){e.exports=function(){"use strict";function e(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function t(e,t){return e<t?-1:e>t?1:0}return function(i,n,r,s,o){!function t(i,n,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=n-r+1,c=Math.log(a),h=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*h*(a-h)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*h/a+u)),Math.min(s,Math.floor(n+(a-l)*h/a+u)),o)}var d=i[n],p=r,m=s;for(e(i,r,n),o(i[s],d)>0&&e(i,r,s);p<m;){for(e(i,p,m),p++,m--;o(i[p],d)<0;)p++;for(;o(i[m],d)>0;)m--}0===o(i[r],d)?e(i,r,m):e(i,++m,s),m<=n&&(r=m+1),n<=m&&(s=m-1)}}(i,n,r||0,s||i.length-1,o||t)}}()},U6jy:function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)i.call(n,r)&&(e[r]=n[r])}return e};var i=Object.prototype.hasOwnProperty},Vfn7:function(e,t,i){var n;!function(){"use strict";function r(e,t,i){var n=t.x,r=t.y,s=i.x-n,o=i.y-r;if(0!==s||0!==o){var a=((e.x-n)*s+(e.y-r)*o)/(s*s+o*o);a>1?(n=i.x,r=i.y):a>0&&(n+=s*a,r+=o*a)}return(s=e.x-n)*s+(o=e.y-r)*o}function s(e,t,i){if(e.length<=2)return e;var n=void 0!==t?t*t:1;return function(e,t){var i=e.length-1,n=[e[0]];return function e(t,i,n,s,o){for(var a,l=s,c=i+1;c<n;c++){var h=r(t[c],t[i],t[n]);h>l&&(a=c,l=h)}l>s&&(a-i>1&&e(t,i,a,s,o),o.push(t[a]),n-a>1&&e(t,a,n,s,o))}(e,0,i,t,n),n.push(e[i]),n}(e=i?e:function(e,t){for(var i,n,r,s,o,a=e[0],l=[a],c=1,h=e.length;c<h;c++)(s=(n=i=e[c]).x-(r=a).x)*s+(o=n.y-r.y)*o>t&&(l.push(i),a=i);return a!==i&&l.push(i),l}(e,n),n)}void 0===(n=(function(){return s}).call(t,i,t,e))||(e.exports=n)}()},WpKc:function(e,t,i){"use strict";var n=i("4b23").nanoid;function r(e){this.origin=e.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=e.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=e,this.send=this.send.bind(this),this.countries=e.countries?e.countries.split(","):null,this.types=e.types?e.types.split(","):null,this.bbox=e.bbox?e.bbox:null,this.language=e.language?e.language.split(","):null,this.limit=e.limit?+e.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(e),this.eventQueue=new Array,this.flushInterval=e.flushInterval||1e3,this.maxQueueSize=e.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}r.prototype={select:function(e,t){var i=this.getSelectedIndex(e,t),n=this.getEventPayload("search.select",t);if(n.resultIndex=i,n.resultPlaceName=e.place_name,n.resultId=e.id,(i!==this.lastSentIndex||n.queryString!==this.lastSentInput)&&-1!=i&&(this.lastSentIndex=i,this.lastSentInput=n.queryString,n.queryString))return this.push(n)},start:function(e){var t=this.getEventPayload("search.start",e);if(t.queryString)return this.push(t)},keyevent:function(e,t){if(e.key&&!e.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(e.keyCode)){var i=this.getEventPayload("search.keystroke",t);if(i.lastAction=e.key,i.queryString)return this.push(i)}},send:function(e,t){if(!this.enableEventLogging)return t?t():void 0;var i=this.getRequestOptions(e);this.request(i,(function(e){return e?this.handleError(e,t):t?t():void 0}).bind(this))},getRequestOptions:function(e){return Array.isArray(e)||(e=[e]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}},getEventPayload:function(e,t){var i;i=t.options.proximity?"object"==typeof t.options.proximity?[t.options.proximity.longitude,t.options.proximity.latitude]:"ip"===t.options.proximity?[999,999]:t.options.proximity:null;var n=t._map?t._map.getZoom():void 0,r={event:e,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:t.options.autocomplete,fuzzyMatch:t.options.fuzzyMatch,proximity:i,limit:t.options.limit,routing:t.options.routing,worldview:t.options.worldview,mapZoom:n,keyboardLocale:this.locale};return r.queryString="search.select"===e?t.inputString:"search.select"!=e&&t._inputEl?t._inputEl.value:t.inputString,r},request:function(e,t){var i=new XMLHttpRequest;for(var n in i.onreadystatechange=function(){if(4==this.readyState)return t(204==this.status?null:this.statusText)},i.open(e.method,e.host+"/"+e.path,!0),e.headers)i.setRequestHeader(n,e.headers[n]);i.send(e.body)},handleError:function(e,t){if(t)return t(e)},generateSessionID:function(){return n()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(e,t){if(t._typeahead){var i=e.id;return t._typeahead.data.map((function(e){return e.id})).indexOf(i)}},shouldEnableLogging:function(e){return!(!1===e.enableEventLogging||e.origin&&"https://api.mapbox.com"!==e.origin||e.localGeocoder||e.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(e,t){this.eventQueue.push(e),(this.eventQueue.length>=this.maxQueueSize||t)&&this.flush()},remove:function(){this.flush()}},e.exports=r},YI60:function(e,t,i){"use strict";var n=i("aqBw"),r={};function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){if(r[e])return r[e];var t=e.split("."),i=t[0],o=t[1];if(!o)throw new Error("Invalid token");var a=function(e){try{return JSON.parse(n.decode(e))}catch(t){throw new Error("Invalid token")}}(o),l={usage:i,user:a.u};return s(a,"a")&&(l.authorization=a.a),s(a,"exp")&&(l.expires=1e3*a.exp),s(a,"iat")&&(l.created=1e3*a.iat),s(a,"scopes")&&(l.scopes=a.scopes),s(a,"client")&&(l.client=a.client),s(a,"ll")&&(l.lastLogin=a.ll),s(a,"iu")&&(l.impersonator=a.iu),r[e]=l,l}},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},aqBw:function(e,t,i){(function(e){var n;!function(r){"object"==typeof global&&global;var s=function(e){this.message=e};(s.prototype=new Error).name="InvalidCharacterError";var o=function(e){throw new s(e)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=/[\t\n\f\r ]/g,c={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&o("The string to be encoded contains characters outside of the Latin1 range.");for(var t,i,n,r,s=e.length%3,l="",c=-1,h=e.length-s;++c<h;)t=e.charCodeAt(c)<<16,i=e.charCodeAt(++c)<<8,n=e.charCodeAt(++c),l+=a.charAt((r=t+i+n)>>18&63)+a.charAt(r>>12&63)+a.charAt(r>>6&63)+a.charAt(63&r);return 2==s?(t=e.charCodeAt(c)<<8,i=e.charCodeAt(++c),l+=a.charAt((r=t+i)>>10)+a.charAt(r>>4&63)+a.charAt(r<<2&63)+"="):1==s&&(r=e.charCodeAt(c),l+=a.charAt(r>>2)+a.charAt(r<<4&63)+"=="),l},decode:function(e){var t=(e=String(e).replace(l,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&o("Invalid character: the string to be decoded is not correctly encoded.");for(var i,n,r=0,s="",c=-1;++c<t;)n=a.indexOf(e.charAt(c)),i=r%4?64*i+n:n,r++%4&&(s+=String.fromCharCode(255&i>>(-2*r&6)));return s},version:"0.1.0"};void 0===(n=(function(){return c}).call(t,i,t,e))||(e.exports=n)}()}).call(this,i("YuTi")(e))},baNz:function(e,t,i){"use strict";e.exports=function(e,t){var i=function(e,i){return-1!==t.indexOf(e)&&void 0!==i};return"function"==typeof t&&(i=t),Object.keys(e).filter((function(t){return i(t,e[t])})).reduce((function(t,i){return t[i]=e[i],t}),{})}},cRm7:function(e,t,i){"use strict";var n=i("AxvH");function r(e,t){this.request=e,this.headers=t.headers,this.rawBody=t.body,this.statusCode=t.statusCode;try{this.body=JSON.parse(t.body||"{}")}catch(i){this.body=t.body}this.links=n(this.headers.link)}r.prototype.hasNextPage=function(){return!!this.links.next},r.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},e.exports=r},cryX:function(e,t,i){"use strict";e.exports=function(e){var t={};return e?(e.trim().split(/[\r|\n]+/).forEach((function(e){var i=function(e){var t=e.indexOf(":");return{name:e.substring(0,t).trim().toLowerCase(),value:e.substring(t+1).trim()}}(e);t[i.name]=i.value})),t):t}},d0rS:function(e,t,i){"use strict";function n(e){return Array.isArray(e)?e.map(encodeURIComponent).join(","):encodeURIComponent(String(e))}function r(e,t,i){if(!1===i||null===i)return e;var r=/\?/.test(e)?"&":"?",s=encodeURIComponent(t);return void 0!==i&&""!==i&&!0!==i&&(s+="="+n(i)),""+e+r+s}e.exports={appendQueryObject:function(e,t){if(!t)return e;var i=e;return Object.keys(t).forEach((function(e){var n=t[e];void 0!==n&&(Array.isArray(n)&&(n=n.filter((function(e){return null!=e})).join(",")),i=r(i,e,n))})),i},appendQueryParam:r,prependOrigin:function(e,t){if(!t)return e;if("http"===e.slice(0,4))return e;var i="/"===e[0]?"":"/";return""+t.replace(/\/$/,"")+i+e},interpolateRouteParams:function(e,t){return t?e.replace(/\/:([a-zA-Z0-9]+)/g,(function(e,i){var r=t[i];if(void 0===r)throw new Error("Unspecified route parameter "+i);return"/"+n(r)})):e}}},eFQn:function(e,t,i){"use strict";var n=i("Smn/");e.exports=function(e){return n(e,(function(e,t){return"boolean"==typeof t?JSON.stringify(t):t}))}},iFvi:function(e,t,i){"use strict";var n=i("Bi8L"),r=i("9/5/"),s=i("U6jy"),o=i("+qE3").EventEmitter,a=i("SsYf"),l=i("0KjW"),c=i("LFDd"),h=i("WpKc"),u=i("/5w7"),d=i("5K5J"),p=i("5k+i"),m=i("7fnu");function f(e){this._eventEmitter=new o,this.options=s({},this.options,e),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new p}f.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(e){return e.place_name},render:function(e){var t=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"}},addTo:function(e){function t(e,t){if(!document.body.contains(t))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const i=e.onAdd();t.appendChild(i)}if(e._controlContainer)e.addControl(this);else if(e instanceof HTMLElement)t(this,e);else{if("string"!=typeof e)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const i=document.querySelectorAll(e);if(0===i.length)throw new Error("Element ",e,"not found.");if(i.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,i[0])}}},onAdd:function(e){if(e&&"string"!=typeof e&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=c(l({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new h(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var i=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",r(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(e){this.eventManager.keyevent(e,this)}).bind(this));var s=document.createElement("div");s.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),s.appendChild(this._clearEl),s.appendChild(this._loadingEl),t.appendChild(i),t.appendChild(this._inputEl),t.appendChild(s),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var a=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(a),s.appendChild(this._geolocateEl),this._showGeolocateButton()}var u=this._typeahead=new n(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),u.getItemValue=this.options.getItemValue;var d,p=u.list.draw,m=this._footerNode=((d=document.createElement("div")).className="mapboxgl-ctrl-geocoder--powered-by",d.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',d);return u.list.draw=function(){p.call(this),m.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),m.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(m)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),t},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(e){this._hideLoadingIcon();const t={geometry:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]}};this._handleMarker(t),this._fly(t),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(t),this._showClearButton(),this.fresh=!1;const i={limit:1,language:[this.options.language],query:t.geometry.coordinates,types:["address"]};this.options.localGeocoderOnly?(this._setInputValue(t.geometry.coordinates[0]+","+t.geometry.coordinates[1]),this._eventEmitter.emit("result",{result:t})):this.geocoderService.reverseGeocode(i).send().then((function(e){const i=e.body.features[0];if(i){const e=m.transformFeatureToGeolocationText(i,this.options.addressAccuracy);this._setInputValue(e),i.user_coordinates=t.geometry.coordinates,this._eventEmitter.emit("result",{result:i})}else this._eventEmitter.emit("result",{result:{user_coordinates:t.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(e){1===e.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+e),i.setAttribute("viewBox","0 0 18 18"),i.setAttribute("xml:space","preserve"),i.setAttribute("width",18),i.setAttribute("height",18),i.innerHTML=t,i},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(e){this._inputEl.value=e,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this._geocode(t)},_onKeyDown:function(e){var t=27,i=9;if(e.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(e),this._inputEl.blur();var n=e.target&&e.target.shadowRoot?e.target.shadowRoot.activeElement:e.target;if(!n||!n.value)return this.fresh=!0,e.keyCode!==i&&this.clear(e),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),e.metaKey||-1!==[i,t,37,39,13,38,40].indexOf(e.keyCode)||n.value.length>=this.options.minLength&&this._geocode(n.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()},_onChange:function(){var e=this._typeahead.selected;e&&JSON.stringify(e)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(e),this.options.marker&&this._mapboxgl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._eventEmitter.emit("result",{result:e}),this.eventManager.select(e,this))},_fly:function(e){var t;if(e.properties&&a[e.properties.short_code])t=s({},this.options.flyTo),this._map&&this._map.fitBounds(a[e.properties.short_code].bbox,t);else if(e.bbox){var i=e.bbox;t=s({},this.options.flyTo),this._map&&this._map.fitBounds([[i[0],i[1]],[i[2],i[3]]],t)}else t=s({},{zoom:this.options.zoom},this.options.flyTo),e.center?t.center=e.center:e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&(t.center=e.geometry.coordinates),this._map&&this._map.flyTo(t)},_requestType:function(e,t){return e.localGeocoderOnly?1:e.reverseGeocode&&m.REVERSE_GEOCODE_COORD_RGX.test(t)?2:0},_setupConfig:function(e,t){const i=/[\s,]+/;var n=this,r=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce((function(e,t){return null==n.options[t]||(e[t]=["countries","types","language"].indexOf(t)>-1?n.options[t].split(i):n.options[t],"proximity"===t&&"number"==typeof n.options[t].longitude&&"number"==typeof n.options[t].latitude&&(e[t]=[n.options[t].longitude,n.options[t].latitude])),e}),{});switch(e){case 2:var o=t.split(i).map((function(e){return parseFloat(e,10)}));n.options.flipCoordinates||o.reverse(),r=s(r,{query:o,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach((function(e){e in r&&delete r[e]}));break;case 0:{const e=t.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(e)&&(t=t.replace(/,/g," ")),r=s(r,{query:t})}}return r},_geocode:function(e){this.inputString=e,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:e});const t=this._requestType(this.options,e),i=this._setupConfig(t,e);var n;switch(t){case 1:n=Promise.resolve();break;case 0:n=this.geocoderService.forwardGeocode(i).send();break;case 2:n=this.geocoderService.reverseGeocode(i).send()}var r=this.options.localGeocoder&&this.options.localGeocoder(e)||[],s=[],o=null;return n.catch((function(e){o=e}).bind(this)).then((function(t){this._hideLoadingIcon();var n={};return t?"200"==t.statusCode&&((n=t.body).request=t.request,n.headers=t.headers):n={type:"FeatureCollection",features:[]},n.config=i,this.fresh&&(this.eventManager.start(this),this.fresh=!1),n.features=n.features?r.concat(n.features):r,this.options.externalGeocoder?(s=this.options.externalGeocoder(e,n.features)||Promise.resolve([])).then((function(e){return n.features=n.features?e.concat(n.features):e,n}),(function(){return n})):n}).bind(this)).then((function(e){if(o)throw o;this.options.filter&&e.features.length&&(e.features=e.features.filter(this.options.filter)),e.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",e),this._typeahead.update(e.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",e))}).bind(this)).catch((function(e){this._hideLoadingIcon(),this._hideAttribution(),r.length&&this.options.localGeocoder||s.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(r)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:r}),this._eventEmitter.emit("error",{error:e})}).bind(this)),n},_clear:function(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(e){this._clear(e),this._inputEl.focus()},_clearOnBlur:function(e){e.relatedTarget&&this._clear(e)},_onQueryResult:function(e){var t=e.body;if(t.features.length){var i=t.features[0];this._typeahead.selected=i,this._inputEl.value=i.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity)if(this._map.getZoom()>9){var e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(e){return this._geocode(e).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var e=this.options.language.split(",")[0],t=d.language(e),i=u.placeholder[t];if(i)return i}return"Search"},setInput:function(e,t){return void 0===t&&(t=!1),this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&(t?this._geocode(e):this._onChange()),this},setProximity:function(e,t=!0){return this.options.proximity=e,t&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(e){return e&&"function"==typeof e&&(this._typeahead.render=e),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(e){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=e||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(e){return this.options.zoom=e,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(e){return this.options.flyTo=e,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(e){return this.options.placeholder=e||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(e){return this.options.bbox=e,this},getCountries:function(){return this.options.countries},setCountries:function(e){return this.options.countries=e,this},getTypes:function(){return this.options.types},setTypes:function(e){return this.options.types=e,this},getMinLength:function(){return this.options.minLength},setMinLength:function(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this},getLimit:function(){return this.options.limit},setLimit:function(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this},getFilter:function(){return this.options.filter},setFilter:function(e){return this.options.filter=e,this},setOrigin:function(e){return this.options.origin=e,this.geocoderService=c(l({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(e){return this.options.accessToken=e,this.geocoderService=c(l({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(e){return this.options.autocomplete=e,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(e){return this.options.fuzzyMatch=e,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(e){return this.options.routing=e,this},getRouting:function(){return this.options.routing},setWorldview:function(e){return this.options.worldview=e,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(e){if(this._map){this._removeMarker();var t=s({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(t),e.center?this.mapMarker.setLngLat(e.center).addTo(this._map):e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(e,t){return this._eventEmitter.on(e,t),this},off:function(e,t){return this._eventEmitter.removeListener(e,t),this.eventManager.remove(),this}},e.exports=f},jLWS:function(e,t,i){"use strict";e.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},ncV3:function(e,t,i){"use strict";var n=i("YI60"),r=i("2+Hy"),s=i("jLWS");function o(e){if(!e||!e.accessToken)throw new Error("Cannot create a client without an access token");n(e.accessToken),this.accessToken=e.accessToken,this.origin=e.origin||s.API_ORIGIN}o.prototype.createRequest=function(e){return new r(this,e)},e.exports=o},oGbY:function(e,t,i){"use strict";var n=i("cRm7"),r=i("73jG"),s=i("jLWS"),o=i("cryX"),a={};function l(e){var t=e.total,i=e.loaded;return{total:t,transferred:i,percent:100*i/t}}function c(e,t){return new Promise((function(i,n){t.onprogress=function(t){e.emitter.emit(s.EVENT_PROGRESS_DOWNLOAD,l(t))};var o=e.file;o&&(t.upload.onprogress=function(t){e.emitter.emit(s.EVENT_PROGRESS_UPLOAD,l(t))}),t.onerror=function(e){n(e)},t.onabort=function(){var t=new r({request:e,type:s.ERROR_REQUEST_ABORTED});n(t)},t.onload=function(){if(delete a[e.id],t.status<200||t.status>=400){var s=new r({request:e,body:t.response,statusCode:t.status});n(s)}else i(t)};var c=e.body;"string"==typeof c?t.send(c):c?t.send(JSON.stringify(c)):o?t.send(o):t.send(),a[e.id]=t})).then((function(t){return function(e,t){return new n(e,{body:t.response,headers:o(t.getAllResponseHeaders()),statusCode:t.status})}(e,t)}))}function h(e,t){var i=e.url(t),n=new window.XMLHttpRequest;return n.open(e.method,i),Object.keys(e.headers).forEach((function(t){n.setRequestHeader(t,e.headers[t])})),n}e.exports={browserAbort:function(e){var t=a[e.id];t&&(t.abort(),delete a[e.id])},sendRequestXhr:c,browserSend:function(e){return Promise.resolve().then((function(){var t=h(e,e.client.accessToken);return c(e,t)}))},createRequestXhr:h}},"pit/":function(e,t,i){"use strict";var n=i("NkL+"),r=i("U6jy"),s={};function o(e){var t=Array.isArray(e);return function(i){var n=a(s.plainArray,i);if(n)return n;if(t&&i.length!==e.length)return"an array with "+e.length+" items";for(var r=0;r<i.length;r++)if(n=a(t?e[r]:e,i[r]))return[r].concat(n)}}function a(e,t){if(null!=t||e.hasOwnProperty("__required")){var i=e(t);return i?Array.isArray(i)?i:[i]:void 0}}function l(e,t){var i=e.length,n=e[i-1],s=e.slice(0,i-1);return 0===s.length&&(s=["value"]),t=r(t,{path:s}),"function"==typeof n?n(t):h(t,function(e){return"must be "+(/^an? /.test(t=e)?t:/^[aeiou]/i.test(t)?"an "+t:/^[a-z]/i.test(t)?"a "+t:t)+".";var t}(n))}function c(e){return e.length<2?e[0]:2===e.length?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e.slice(-1)}function h(e,t){return(u(e.path)?"Item at position ":"")+e.path.join(".")+" "+t}function u(e){return"number"==typeof e[e.length-1]||"number"==typeof e[0]}s.assert=function(e,t){return t=t||{},function(i){var n=a(e,i);if(n){var r=l(n,t);throw t.apiName&&(r=t.apiName+": "+r),new Error(r)}}},s.shape=function(e){var t,i=(t=e,Object.keys(t||{}).map((function(e){return{key:e,value:t[e]}})));return function(e){var t,n=a(s.plainObject,e);if(n)return n;for(var r=[],o=0;o<i.length;o++)(n=a(i[o].value,e[t=i[o].key]))&&r.push([t].concat(n));return r.length<2?r[0]:function(e){r=r.map((function(t){return"- "+t[0]+": "+l(t,e).split("\n").join("\n  ")}));var t=e.path.join(".");return"The following properties"+("value"===t?"":" of "+t)+" have invalid values:\n  "+r.join("\n  ")}}},s.strictShape=function(e){var t=s.shape(e);return function(i){var n=t(i);if(n)return n;var r=Object.keys(i).reduce((function(t,i){return void 0===e[i]&&t.push(i),t}),[]);return 0!==r.length?function(){return"The following keys are invalid: "+r.join(", ")}:void 0}},s.arrayOf=function(e){return o(e)},s.tuple=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return o(e)},s.required=function(e){function t(t){return null==t?function(e){return h(e,u(e.path)?"cannot be undefined/null.":"is required.")}:e.apply(this,arguments)}return t.__required=!0,t},s.oneOfType=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(t){var i=e.map((function(e){return a(e,t)})).filter(Boolean);if(i.length===e.length)return i.every((function(e){return 1===e.length&&"string"==typeof e[0]}))?c(i.map((function(e){return e[0]}))):i.reduce((function(e,t){return t.length>e.length?t:e}))}},s.equal=function(e){return function(t){if(t!==e)return JSON.stringify(e)}},s.oneOf=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),t=e.map((function(e){return s.equal(e)}));return s.oneOfType.apply(this,t)},s.range=function(e){var t=e[0],i=e[1];return function(e){if(a(s.number,e)||e<t||e>i)return"number between "+t+" & "+i+" (inclusive)"}},s.any=function(){},s.boolean=function(e){if("boolean"!=typeof e)return"boolean"},s.number=function(e){if("number"!=typeof e)return"number"},s.plainArray=function(e){if(!Array.isArray(e))return"array"},s.plainObject=function(e){if(!n(e))return"object"},s.string=function(e){if("string"!=typeof e)return"string"},s.func=function(e){if("function"!=typeof e)return"function"},s.validate=a,s.processMessage=l,e.exports=s},uhBA:function(e,t,i){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function s(){}function o(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function a(e,t,i,n,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new o(i,n||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),c.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)n.call(e,t)&&i.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},c.prototype.listeners=function(e){var t=this._events[r?r+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var i=0,n=t.length,s=new Array(n);i<n;i++)s[i]=t[i].fn;return s},c.prototype.listenerCount=function(e){var t=this._events[r?r+e:e];return t?t.fn?1:t.length:0},c.prototype.emit=function(e,t,i,n,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,h=this._events[a],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,n),!0;case 5:return h.fn.call(h.context,t,i,n,s),!0;case 6:return h.fn.call(h.context,t,i,n,s,o),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];h.fn.apply(h.context,l)}else{var d,p=h.length;for(c=0;c<p;c++)switch(h[c].once&&this.removeListener(e,h[c].fn,void 0,!0),u){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,t);break;case 3:h[c].fn.call(h[c].context,t,i);break;case 4:h[c].fn.call(h[c].context,t,i,n);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];h[c].fn.apply(h[c].context,l)}}return!0},c.prototype.on=function(e,t,i){return a(this,e,t,i,!1)},c.prototype.once=function(e,t,i){return a(this,e,t,i,!0)},c.prototype.removeListener=function(e,t,i,n){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return l(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||n&&!o.once||i&&o.context!==i||l(this,s);else{for(var a=0,c=[],h=o.length;a<h;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=1===c.length?c[0]:c:l(this,s)}return this},c.prototype.removeAllListeners=function(e){var t;return e?this._events[t=r?r+e:e]&&l(this,t):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c},zUnb:function(e,t,i){"use strict";i.r(t);var n={};function r(e){return"function"==typeof e}i.r(n),i.d(n,"BlobServiceProperties",(function(){return bj})),i.d(n,"Logging",(function(){return wj})),i.d(n,"RetentionPolicy",(function(){return Cj})),i.d(n,"Metrics",(function(){return Sj})),i.d(n,"CorsRule",(function(){return Ej})),i.d(n,"StaticWebsite",(function(){return Tj})),i.d(n,"StorageError",(function(){return Pj})),i.d(n,"BlobServiceStatistics",(function(){return Mj})),i.d(n,"GeoReplication",(function(){return kj})),i.d(n,"ListContainersSegmentResponse",(function(){return Aj})),i.d(n,"ContainerItem",(function(){return Ij})),i.d(n,"ContainerProperties",(function(){return Rj})),i.d(n,"KeyInfo",(function(){return Oj})),i.d(n,"UserDelegationKey",(function(){return Nj})),i.d(n,"FilterBlobSegment",(function(){return Dj})),i.d(n,"FilterBlobItem",(function(){return zj})),i.d(n,"BlobTags",(function(){return Lj})),i.d(n,"BlobTag",(function(){return Bj})),i.d(n,"SignedIdentifier",(function(){return Fj})),i.d(n,"AccessPolicy",(function(){return jj})),i.d(n,"ListBlobsFlatSegmentResponse",(function(){return Vj})),i.d(n,"BlobFlatListSegment",(function(){return Uj})),i.d(n,"BlobItemInternal",(function(){return qj})),i.d(n,"BlobName",(function(){return Hj})),i.d(n,"BlobPropertiesInternal",(function(){return Gj})),i.d(n,"ListBlobsHierarchySegmentResponse",(function(){return Wj})),i.d(n,"BlobHierarchyListSegment",(function(){return Zj})),i.d(n,"BlobPrefix",(function(){return $j})),i.d(n,"BlockLookupList",(function(){return Xj})),i.d(n,"BlockList",(function(){return Kj})),i.d(n,"Block",(function(){return Yj})),i.d(n,"PageList",(function(){return Jj})),i.d(n,"PageRange",(function(){return Qj})),i.d(n,"ClearRange",(function(){return eV})),i.d(n,"QueryRequest",(function(){return tV})),i.d(n,"QuerySerialization",(function(){return iV})),i.d(n,"QueryFormat",(function(){return nV})),i.d(n,"DelimitedTextConfiguration",(function(){return rV})),i.d(n,"JsonTextConfiguration",(function(){return sV})),i.d(n,"ArrowConfiguration",(function(){return oV})),i.d(n,"ArrowField",(function(){return aV})),i.d(n,"ServiceSetPropertiesHeaders",(function(){return lV})),i.d(n,"ServiceSetPropertiesExceptionHeaders",(function(){return cV})),i.d(n,"ServiceGetPropertiesHeaders",(function(){return hV})),i.d(n,"ServiceGetPropertiesExceptionHeaders",(function(){return uV})),i.d(n,"ServiceGetStatisticsHeaders",(function(){return dV})),i.d(n,"ServiceGetStatisticsExceptionHeaders",(function(){return pV})),i.d(n,"ServiceListContainersSegmentHeaders",(function(){return mV})),i.d(n,"ServiceListContainersSegmentExceptionHeaders",(function(){return fV})),i.d(n,"ServiceGetUserDelegationKeyHeaders",(function(){return gV})),i.d(n,"ServiceGetUserDelegationKeyExceptionHeaders",(function(){return _V})),i.d(n,"ServiceGetAccountInfoHeaders",(function(){return yV})),i.d(n,"ServiceGetAccountInfoExceptionHeaders",(function(){return vV})),i.d(n,"ServiceSubmitBatchHeaders",(function(){return xV})),i.d(n,"ServiceSubmitBatchExceptionHeaders",(function(){return bV})),i.d(n,"ServiceFilterBlobsHeaders",(function(){return wV})),i.d(n,"ServiceFilterBlobsExceptionHeaders",(function(){return CV})),i.d(n,"ContainerCreateHeaders",(function(){return SV})),i.d(n,"ContainerCreateExceptionHeaders",(function(){return EV})),i.d(n,"ContainerGetPropertiesHeaders",(function(){return TV})),i.d(n,"ContainerGetPropertiesExceptionHeaders",(function(){return PV})),i.d(n,"ContainerDeleteHeaders",(function(){return MV})),i.d(n,"ContainerDeleteExceptionHeaders",(function(){return kV})),i.d(n,"ContainerSetMetadataHeaders",(function(){return AV})),i.d(n,"ContainerSetMetadataExceptionHeaders",(function(){return IV})),i.d(n,"ContainerGetAccessPolicyHeaders",(function(){return RV})),i.d(n,"ContainerGetAccessPolicyExceptionHeaders",(function(){return OV})),i.d(n,"ContainerSetAccessPolicyHeaders",(function(){return NV})),i.d(n,"ContainerSetAccessPolicyExceptionHeaders",(function(){return DV})),i.d(n,"ContainerRestoreHeaders",(function(){return zV})),i.d(n,"ContainerRestoreExceptionHeaders",(function(){return LV})),i.d(n,"ContainerRenameHeaders",(function(){return BV})),i.d(n,"ContainerRenameExceptionHeaders",(function(){return FV})),i.d(n,"ContainerSubmitBatchHeaders",(function(){return jV})),i.d(n,"ContainerSubmitBatchExceptionHeaders",(function(){return VV})),i.d(n,"ContainerFilterBlobsHeaders",(function(){return UV})),i.d(n,"ContainerFilterBlobsExceptionHeaders",(function(){return qV})),i.d(n,"ContainerAcquireLeaseHeaders",(function(){return HV})),i.d(n,"ContainerAcquireLeaseExceptionHeaders",(function(){return GV})),i.d(n,"ContainerReleaseLeaseHeaders",(function(){return WV})),i.d(n,"ContainerReleaseLeaseExceptionHeaders",(function(){return ZV})),i.d(n,"ContainerRenewLeaseHeaders",(function(){return $V})),i.d(n,"ContainerRenewLeaseExceptionHeaders",(function(){return XV})),i.d(n,"ContainerBreakLeaseHeaders",(function(){return KV})),i.d(n,"ContainerBreakLeaseExceptionHeaders",(function(){return YV})),i.d(n,"ContainerChangeLeaseHeaders",(function(){return JV})),i.d(n,"ContainerChangeLeaseExceptionHeaders",(function(){return QV})),i.d(n,"ContainerListBlobFlatSegmentHeaders",(function(){return eU})),i.d(n,"ContainerListBlobFlatSegmentExceptionHeaders",(function(){return tU})),i.d(n,"ContainerListBlobHierarchySegmentHeaders",(function(){return iU})),i.d(n,"ContainerListBlobHierarchySegmentExceptionHeaders",(function(){return nU})),i.d(n,"ContainerGetAccountInfoHeaders",(function(){return rU})),i.d(n,"ContainerGetAccountInfoExceptionHeaders",(function(){return sU})),i.d(n,"BlobDownloadHeaders",(function(){return oU})),i.d(n,"BlobDownloadExceptionHeaders",(function(){return aU})),i.d(n,"BlobGetPropertiesHeaders",(function(){return lU})),i.d(n,"BlobGetPropertiesExceptionHeaders",(function(){return cU})),i.d(n,"BlobDeleteHeaders",(function(){return hU})),i.d(n,"BlobDeleteExceptionHeaders",(function(){return uU})),i.d(n,"BlobUndeleteHeaders",(function(){return dU})),i.d(n,"BlobUndeleteExceptionHeaders",(function(){return pU})),i.d(n,"BlobSetExpiryHeaders",(function(){return mU})),i.d(n,"BlobSetExpiryExceptionHeaders",(function(){return fU})),i.d(n,"BlobSetHttpHeadersHeaders",(function(){return gU})),i.d(n,"BlobSetHttpHeadersExceptionHeaders",(function(){return _U})),i.d(n,"BlobSetImmutabilityPolicyHeaders",(function(){return yU})),i.d(n,"BlobSetImmutabilityPolicyExceptionHeaders",(function(){return vU})),i.d(n,"BlobDeleteImmutabilityPolicyHeaders",(function(){return xU})),i.d(n,"BlobDeleteImmutabilityPolicyExceptionHeaders",(function(){return bU})),i.d(n,"BlobSetLegalHoldHeaders",(function(){return wU})),i.d(n,"BlobSetLegalHoldExceptionHeaders",(function(){return CU})),i.d(n,"BlobSetMetadataHeaders",(function(){return SU})),i.d(n,"BlobSetMetadataExceptionHeaders",(function(){return EU})),i.d(n,"BlobAcquireLeaseHeaders",(function(){return TU})),i.d(n,"BlobAcquireLeaseExceptionHeaders",(function(){return PU})),i.d(n,"BlobReleaseLeaseHeaders",(function(){return MU})),i.d(n,"BlobReleaseLeaseExceptionHeaders",(function(){return kU})),i.d(n,"BlobRenewLeaseHeaders",(function(){return AU})),i.d(n,"BlobRenewLeaseExceptionHeaders",(function(){return IU})),i.d(n,"BlobChangeLeaseHeaders",(function(){return RU})),i.d(n,"BlobChangeLeaseExceptionHeaders",(function(){return OU})),i.d(n,"BlobBreakLeaseHeaders",(function(){return NU})),i.d(n,"BlobBreakLeaseExceptionHeaders",(function(){return DU})),i.d(n,"BlobCreateSnapshotHeaders",(function(){return zU})),i.d(n,"BlobCreateSnapshotExceptionHeaders",(function(){return LU})),i.d(n,"BlobStartCopyFromURLHeaders",(function(){return BU})),i.d(n,"BlobStartCopyFromURLExceptionHeaders",(function(){return FU})),i.d(n,"BlobCopyFromURLHeaders",(function(){return jU})),i.d(n,"BlobCopyFromURLExceptionHeaders",(function(){return VU})),i.d(n,"BlobAbortCopyFromURLHeaders",(function(){return UU})),i.d(n,"BlobAbortCopyFromURLExceptionHeaders",(function(){return qU})),i.d(n,"BlobSetTierHeaders",(function(){return HU})),i.d(n,"BlobSetTierExceptionHeaders",(function(){return GU})),i.d(n,"BlobGetAccountInfoHeaders",(function(){return WU})),i.d(n,"BlobGetAccountInfoExceptionHeaders",(function(){return ZU})),i.d(n,"BlobQueryHeaders",(function(){return $U})),i.d(n,"BlobQueryExceptionHeaders",(function(){return XU})),i.d(n,"BlobGetTagsHeaders",(function(){return KU})),i.d(n,"BlobGetTagsExceptionHeaders",(function(){return YU})),i.d(n,"BlobSetTagsHeaders",(function(){return JU})),i.d(n,"BlobSetTagsExceptionHeaders",(function(){return QU})),i.d(n,"PageBlobCreateHeaders",(function(){return eq})),i.d(n,"PageBlobCreateExceptionHeaders",(function(){return tq})),i.d(n,"PageBlobUploadPagesHeaders",(function(){return iq})),i.d(n,"PageBlobUploadPagesExceptionHeaders",(function(){return nq})),i.d(n,"PageBlobClearPagesHeaders",(function(){return rq})),i.d(n,"PageBlobClearPagesExceptionHeaders",(function(){return sq})),i.d(n,"PageBlobUploadPagesFromURLHeaders",(function(){return oq})),i.d(n,"PageBlobUploadPagesFromURLExceptionHeaders",(function(){return aq})),i.d(n,"PageBlobGetPageRangesHeaders",(function(){return lq})),i.d(n,"PageBlobGetPageRangesExceptionHeaders",(function(){return cq})),i.d(n,"PageBlobGetPageRangesDiffHeaders",(function(){return hq})),i.d(n,"PageBlobGetPageRangesDiffExceptionHeaders",(function(){return uq})),i.d(n,"PageBlobResizeHeaders",(function(){return dq})),i.d(n,"PageBlobResizeExceptionHeaders",(function(){return pq})),i.d(n,"PageBlobUpdateSequenceNumberHeaders",(function(){return mq})),i.d(n,"PageBlobUpdateSequenceNumberExceptionHeaders",(function(){return fq})),i.d(n,"PageBlobCopyIncrementalHeaders",(function(){return gq})),i.d(n,"PageBlobCopyIncrementalExceptionHeaders",(function(){return _q})),i.d(n,"AppendBlobCreateHeaders",(function(){return yq})),i.d(n,"AppendBlobCreateExceptionHeaders",(function(){return vq})),i.d(n,"AppendBlobAppendBlockHeaders",(function(){return xq})),i.d(n,"AppendBlobAppendBlockExceptionHeaders",(function(){return bq})),i.d(n,"AppendBlobAppendBlockFromUrlHeaders",(function(){return wq})),i.d(n,"AppendBlobAppendBlockFromUrlExceptionHeaders",(function(){return Cq})),i.d(n,"AppendBlobSealHeaders",(function(){return Sq})),i.d(n,"AppendBlobSealExceptionHeaders",(function(){return Eq})),i.d(n,"BlockBlobUploadHeaders",(function(){return Tq})),i.d(n,"BlockBlobUploadExceptionHeaders",(function(){return Pq})),i.d(n,"BlockBlobPutBlobFromUrlHeaders",(function(){return Mq})),i.d(n,"BlockBlobPutBlobFromUrlExceptionHeaders",(function(){return kq})),i.d(n,"BlockBlobStageBlockHeaders",(function(){return Aq})),i.d(n,"BlockBlobStageBlockExceptionHeaders",(function(){return Iq})),i.d(n,"BlockBlobStageBlockFromURLHeaders",(function(){return Rq})),i.d(n,"BlockBlobStageBlockFromURLExceptionHeaders",(function(){return Oq})),i.d(n,"BlockBlobCommitBlockListHeaders",(function(){return Nq})),i.d(n,"BlockBlobCommitBlockListExceptionHeaders",(function(){return Dq})),i.d(n,"BlockBlobGetBlockListHeaders",(function(){return zq})),i.d(n,"BlockBlobGetBlockListExceptionHeaders",(function(){return Lq}));let s=!1;const o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else s&&console.log("RxJS: Back to a better error behavior. Thank you. <3");s=e},get useDeprecatedSynchronousErrorHandling(){return s}};function a(e){setTimeout(()=>{throw e},0)}const l={closed:!0,next(e){},error(e){if(o.useDeprecatedSynchronousErrorHandling)throw e;a(e)},complete(){}},c=(()=>Array.isArray||(e=>e&&"number"==typeof e.length))();function h(e){return null!==e&&"object"==typeof e}const u=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();let d=(()=>{class e{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:i,_unsubscribe:n,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(let e=0;e<i.length;++e)i[e].remove(this);if(r(n))try{n.call(this)}catch(o){t=o instanceof u?p(o.errors):[o]}if(c(s)){let e=-1,i=s.length;for(;++e<i;){const i=s[e];if(h(i))try{i.unsubscribe()}catch(o){t=t||[],o instanceof u?t=t.concat(p(o.errors)):t.push(o)}}}if(t)throw new u(t)}add(t){let i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){const t=i;i=new e,i._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof e){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[i]:r.push(i),i}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}return e.EMPTY=function(e){return e.closed=!0,e}(new e),e})();function p(e){return e.reduce((e,t)=>e.concat(t instanceof u?t.errors:t),[])}const m=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class f extends d{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=l;break;case 1:if(!e){this.destination=l;break}if("object"==typeof e){e instanceof f?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new g(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new g(this,e,t,i)}}[m](){return this}static create(e,t,i){const n=new f(e,t,i);return n.syncErrorThrowable=!1,n}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class g extends f{constructor(e,t,i,n){let s;super(),this._parentSubscriber=e;let o=this;r(t)?s=t:t&&(s=t.next,i=t.error,n=t.complete,t!==l&&(o=Object.create(t),r(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=n}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=o;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):a(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;a(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw i;a(i)}}__tryOrSetError(e,t,i){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(n){return o.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(a(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const _=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function y(e){return e}function v(...e){return x(e)}function x(e){return 0===e.length?y:1===e.length?e[0]:function(t){return e.reduce((e,t)=>t(e),t)}}let b=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(e,t,i){const{operator:n}=this,r=function(e,t,i){if(e){if(e instanceof f)return e;if(e[m])return e[m]()}return e||t||i?new f(e,t,i):new f(l)}(e,t,i);if(r.add(n?n.call(r,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),o.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(e){try{return this._subscribe(e)}catch(t){o.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:i,isStopped:n}=e;if(t||n)return!1;e=i&&i instanceof f?i:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=w(t))((t,i)=>{let n;n=this.subscribe(t=>{try{e(t)}catch(r){i(r),n&&n.unsubscribe()}},i,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[_](){return this}pipe(...e){return 0===e.length?this:x(e)(this)}toPromise(e){return new(e=w(e))((e,t)=>{let i;this.subscribe(e=>i=e,e=>t(e),()=>e(i))})}}return e.create=t=>new e(t),e})();function w(e){if(e||(e=o.Promise||Promise),!e)throw new Error("no Promise impl found");return e}const C=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})();class S extends d{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class E extends f{constructor(e){super(e),this.destination=e}}let T=(()=>{class e extends b{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[m](){return new E(this)}lift(e){const t=new P(this,this);return t.operator=e,t}next(e){if(this.closed)throw new C;if(!this.isStopped){const{observers:t}=this,i=t.length,n=t.slice();for(let r=0;r<i;r++)n[r].next(e)}}error(e){if(this.closed)throw new C;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,i=t.length,n=t.slice();for(let r=0;r<i;r++)n[r].error(e);this.observers.length=0}complete(){if(this.closed)throw new C;this.isStopped=!0;const{observers:e}=this,t=e.length,i=e.slice();for(let n=0;n<t;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new C;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new C;return this.hasError?(e.error(this.thrownError),d.EMPTY):this.isStopped?(e.complete(),d.EMPTY):(this.observers.push(e),new S(this,e))}asObservable(){const e=new b;return e.source=this,e}}return e.create=(e,t)=>new P(e,t),e})();class P extends T{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):d.EMPTY}}function M(e){return e&&"function"==typeof e.schedule}class k extends f{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const A=e=>t=>{for(let i=0,n=e.length;i<n&&!t.closed;i++)t.next(e[i]);t.complete()};function I(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const R=I(),O=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function N(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const D=e=>{if(e&&"function"==typeof e[_])return n=e,e=>{const t=n[_]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(O(e))return A(e);if(N(e))return i=e,e=>(i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,a),e);if(e&&"function"==typeof e[R])return t=e,e=>{const i=t[R]();for(;;){const t=i.next();if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof i.return&&e.add(()=>{i.return&&i.return()}),e};{const t=h(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,i,n};function z(e,t,i,n,r=new k(e,i,n)){if(!r.closed)return t instanceof b?t.subscribe(r):D(t)(r)}class L extends f{notifyNext(e,t,i,n,r){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}function B(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new F(e,t))}}class F{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new j(e,this.project,this.thisArg))}}class j extends f{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function V(e,t){return new b(i=>{const n=new d;let r=0;return n.add(t.schedule((function(){r!==e.length?(i.next(e[r++]),i.closed||n.add(this.schedule())):i.complete()}))),n})}function U(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[_]}(e))return function(e,t){return new b(i=>{const n=new d;return n.add(t.schedule(()=>{const r=e[_]();n.add(r.subscribe({next(e){n.add(t.schedule(()=>i.next(e)))},error(e){n.add(t.schedule(()=>i.error(e)))},complete(){n.add(t.schedule(()=>i.complete()))}}))})),n})}(e,t);if(N(e))return function(e,t){return new b(i=>{const n=new d;return n.add(t.schedule(()=>e.then(e=>{n.add(t.schedule(()=>{i.next(e),n.add(t.schedule(()=>i.complete()))}))},e=>{n.add(t.schedule(()=>i.error(e)))}))),n})}(e,t);if(O(e))return V(e,t);if(function(e){return e&&"function"==typeof e[R]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new b(i=>{const n=new d;let r;return n.add(()=>{r&&"function"==typeof r.return&&r.return()}),n.add(t.schedule(()=>{r=e[R](),n.add(t.schedule((function(){if(i.closed)return;let e,t;try{const i=r.next();e=i.value,t=i.done}catch(n){return void i.error(n)}t?i.complete():(i.next(e),this.schedule())})))})),n})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof b?e:new b(D(e))}function q(e,t,i=Number.POSITIVE_INFINITY){return"function"==typeof t?n=>n.pipe(q((i,n)=>U(e(i,n)).pipe(B((e,r)=>t(i,e,n,r))),i)):("number"==typeof t&&(i=t),t=>t.lift(new H(e,i)))}class H{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new G(e,this.project,this.concurrent))}}class G extends L{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t,e,i)}_innerSub(e,t,i){const n=new k(this,t,i),r=this.destination;r.add(n);const s=z(this,e,void 0,void 0,n);s!==n&&r.add(s)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e,t,i,n,r){this.destination.next(t)}notifyComplete(e){const t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function W(e=Number.POSITIVE_INFINITY){return q(y,e)}function Z(e,t){return t?V(e,t):new b(A(e))}function $(...e){let t=Number.POSITIVE_INFINITY,i=null,n=e[e.length-1];return M(n)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof n&&(t=e.pop()),null===i&&1===e.length&&e[0]instanceof b?e[0]:W(t)(Z(e,i))}function X(){return function(e){return e.lift(new K(e))}}class K{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const n=new Y(e,i),r=t.subscribe(n);return n.closed||(n.connection=i.connect()),r}}class Y extends f{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,n=e._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class J extends b{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new d,e.add(this.source.subscribe(new ee(this.getSubject(),this))),e.closed&&(this._connection=null,e=d.EMPTY)),e}refCount(){return X()(this)}}const Q=(()=>{const e=J.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class ee extends E{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function te(){return new T}function ie(){return e=>{return X()((t=te,function(e){let i;i="function"==typeof t?t:function(){return t};const n=Object.create(e,Q);return n.source=e,n.subjectFactory=i,n})(e));var t}}function ne(e){return{toString:e}.toString()}function re(e,t,i){return ne(()=>{const n=function(e){return function(...t){if(e){const i=e(...t);for(const e in i)this[e]=i[e]}}}(t);function r(...e){if(this instanceof r)return n.apply(this,e),this;const t=new r(...e);return i.annotation=t,i;function i(e,i,n){const r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;for(;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(t),e}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}const se=re("Inject",e=>({token:e})),oe=re("Optional"),ae=re("Self"),le=re("SkipSelf");var ce=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function he(e){for(let t in e)if(e[t]===he)return t;throw Error("Could not find renamed property on target object.")}function ue(e,t){for(const i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function de(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function pe(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function me(e){return fe(e,e[_e])||fe(e,e[xe])}function fe(e,t){return t&&t.token===e?t:null}function ge(e){return e&&(e.hasOwnProperty(ye)||e.hasOwnProperty(be))?e[ye]:null}const _e=he({"\u0275prov":he}),ye=he({"\u0275inj":he}),ve=he({"\u0275provFallback":he}),xe=he({ngInjectableDef:he}),be=he({ngInjectorDef:he});function we(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(we).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return""+e.overriddenName;if(e.name)return""+e.name;const t=e.toString();if(null==t)return""+t;const i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function Ce(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Se=he({__forward_ref__:he});function Ee(e){return e.__forward_ref__=Ee,e.toString=function(){return we(this())},e}function Te(e){return Pe(e)?e():e}function Pe(e){return"function"==typeof e&&e.hasOwnProperty(Se)&&e.__forward_ref__===Ee}const Me="undefined"!=typeof globalThis&&globalThis,ke="undefined"!=typeof window&&window,Ae="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ie="undefined"!=typeof global&&global,Re=Me||Ie||ke||Ae,Oe=he({"\u0275cmp":he}),Ne=he({"\u0275dir":he}),De=he({"\u0275pipe":he}),ze=he({"\u0275mod":he}),Le=he({"\u0275loc":he}),Be=he({"\u0275fac":he}),Fe=he({__NG_ELEMENT_ID__:he});class je{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=de({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return"InjectionToken "+this._desc}}const Ve=new je("INJECTOR",-1),Ue={},qe=/\n/gm,He=he({provide:String,useValue:he});let Ge,We=void 0;function Ze(e){const t=We;return We=e,t}function $e(e){const t=Ge;return Ge=e,t}function Xe(e,t=ce.Default){if(void 0===We)throw new Error("inject() must be called from an injection context");return null===We?Je(e,void 0,t):We.get(e,t&ce.Optional?null:void 0,t)}function Ke(e,t=ce.Default){return(Ge||Xe)(Te(e),t)}const Ye=Ke;function Je(e,t,i){const n=me(e);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(i&ce.Optional)return null;if(void 0!==t)return t;throw new Error(`Injector: NOT_FOUND [${we(e)}]`)}function Qe(e){const t=[];for(let i=0;i<e.length;i++){const n=Te(e[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let e=void 0,i=ce.Default;for(let t=0;t<n.length;t++){const r=n[t];r instanceof oe||"Optional"===r.ngMetadataName||r===oe?i|=ce.Optional:r instanceof le||"SkipSelf"===r.ngMetadataName||r===le?i|=ce.SkipSelf:r instanceof ae||"Self"===r.ngMetadataName||r===ae?i|=ce.Self:e=r instanceof se||r===se?r.token:r}t.push(Ke(e,i))}else t.push(Ke(n))}return t}class et{get(e,t=Ue){if(t===Ue){const t=new Error(`NullInjectorError: No provider for ${we(e)}!`);throw t.name="NullInjectorError",t}return t}}class tt{}class it{}function nt(e,t){e.forEach(e=>Array.isArray(e)?nt(e,t):t(e))}function rt(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function st(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ot(e,t){const i=[];for(let n=0;n<e;n++)i.push(t);return i}function at(e,t,i){let n=ct(e,t);return n>=0?e[1|n]=i:(n=~n,function(e,t,i,n){let r=e.length;if(r==t)e.push(i,n);else if(1===r)e.push(n,e[0]),e[0]=i;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=i,e[t+1]=n}}(e,n,t,i)),n}function lt(e,t){const i=ct(e,t);if(i>=0)return e[1|i]}function ct(e,t){return function(e,t,i){let n=0,r=e.length>>1;for(;r!==n;){const i=n+(r-n>>1),s=e[i<<1];if(t===s)return i<<1;s>t?r=i:n=i+1}return~(r<<1)}(e,t)}const ht=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),ut=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),dt={},pt=[];let mt=0;function ft(e){return ne(()=>{const t=e.type,i=t.prototype,n={},r={type:t,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onChanges:null,onInit:i.ngOnInit||null,doCheck:i.ngDoCheck||null,afterContentInit:i.ngAfterContentInit||null,afterContentChecked:i.ngAfterContentChecked||null,afterViewInit:i.ngAfterViewInit||null,afterViewChecked:i.ngAfterViewChecked||null,onDestroy:i.ngOnDestroy||null,onPush:e.changeDetection===ht.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||pt,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||ut.Emulated,id:"c",styles:e.styles||pt,_:null,setInput:null,schemas:e.schemas||null,tView:null},s=e.directives,o=e.features,a=e.pipes;return r.id+=mt++,r.inputs=xt(e.inputs,n),r.outputs=xt(e.outputs),o&&o.forEach(e=>e(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(gt):null,r.pipeDefs=a?()=>("function"==typeof a?a():a).map(_t):null,r})}function gt(e){return Ct(e)||function(e){return e[Ne]||null}(e)}function _t(e){return function(e){return e[De]||null}(e)}const yt={};function vt(e){const t={type:e.type,bootstrap:e.bootstrap||pt,declarations:e.declarations||pt,imports:e.imports||pt,exports:e.exports||pt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&ne(()=>{yt[e.id]=e.type}),t}function xt(e,t){if(null==e)return dt;const i={};for(const n in e)if(e.hasOwnProperty(n)){let r=e[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),i[r]=n,t&&(t[r]=s)}return i}const bt=ft;function wt(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Ct(e){return e[Oe]||null}function St(e,t){return e.hasOwnProperty(Be)?e[Be]:null}function Et(e,t){const i=e[ze]||null;if(!i&&!0===t)throw new Error(`Type ${we(e)} does not have '\u0275mod' property.`);return i}function Tt(e){return Array.isArray(e)&&"object"==typeof e[1]}function Pt(e){return Array.isArray(e)&&!0===e[1]}function Mt(e){return 0!=(8&e.flags)}function kt(e){return 2==(2&e.flags)}function At(e){return 1==(1&e.flags)}function It(e){return null!==e.template}function Rt(e){return 0!=(512&e[2])}let Ot=void 0;function Nt(e){return!!e.listen}const Dt={createRenderer:(e,t)=>void 0!==Ot?Ot:"undefined"!=typeof document?document:void 0};function zt(e){for(;Array.isArray(e);)e=e[0];return e}function Lt(e,t){return zt(t[e+20])}function Bt(e,t){return zt(t[e.index])}function Ft(e,t){return e.data[t+20]}function jt(e,t){return e[t+20]}function Vt(e,t){const i=t[e];return Tt(i)?i:i[0]}function Ut(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function qt(e){return 4==(4&e[2])}function Ht(e){return 128==(128&e[2])}function Gt(e,t){return null===e||null==t?null:e[t]}function Wt(e){e[18]=0}function Zt(e,t){e[5]+=t;let i=e,n=e[3];for(;null!==n&&(1===t&&1===i[5]||-1===t&&0===i[5]);)n[5]+=t,i=n,n=n[3]}const $t={lFrame:gi(null),bindingsEnabled:!0,checkNoChangesMode:!1};function Xt(){return $t.bindingsEnabled}function Kt(){return $t.lFrame.lView}function Yt(){return $t.lFrame.tView}function Jt(e){$t.lFrame.contextLView=e}function Qt(){return $t.lFrame.previousOrParentTNode}function ei(e,t){$t.lFrame.previousOrParentTNode=e,$t.lFrame.isParent=t}function ti(){return $t.lFrame.isParent}function ii(){$t.lFrame.isParent=!1}function ni(){return $t.checkNoChangesMode}function ri(e){$t.checkNoChangesMode=e}function si(){const e=$t.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function oi(){return $t.lFrame.bindingIndex++}function ai(e){const t=$t.lFrame,i=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,i}function li(e,t){const i=$t.lFrame;i.bindingIndex=i.bindingRootIndex=e,ci(t)}function ci(e){$t.lFrame.currentDirectiveIndex=e}function hi(e){const t=$t.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}function ui(){return $t.lFrame.currentQueryIndex}function di(e){$t.lFrame.currentQueryIndex=e}function pi(e,t){const i=fi();$t.lFrame=i,i.previousOrParentTNode=t,i.lView=e}function mi(e,t){const i=fi(),n=e[1];$t.lFrame=i,i.previousOrParentTNode=t,i.lView=e,i.tView=n,i.contextLView=e,i.bindingIndex=n.bindingStartIndex}function fi(){const e=$t.lFrame,t=null===e?null:e.child;return null===t?gi(e):t}function gi(e){const t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function _i(){const e=$t.lFrame;return $t.lFrame=e.parent,e.previousOrParentTNode=null,e.lView=null,e}const yi=_i;function vi(){const e=_i();e.isParent=!0,e.tView=null,e.selectedIndex=0,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.currentSanitizer=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function xi(){return $t.lFrame.selectedIndex}function bi(e){$t.lFrame.selectedIndex=e}function wi(){const e=$t.lFrame;return Ft(e.tView,e.selectedIndex)}function Ci(){$t.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function Si(e,t){for(let i=t.directiveStart,n=t.directiveEnd;i<n;i++){const t=e.data[i];t.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-i,t.afterContentInit),t.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(i,t.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(i,t.afterContentChecked)),t.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-i,t.afterViewInit),t.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(i,t.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(i,t.afterViewChecked)),null!=t.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(i,t.onDestroy)}}function Ei(e,t,i){Mi(e,t,3,i)}function Ti(e,t,i,n){(3&e[2])===i&&Mi(e,t,i,n)}function Pi(e,t){let i=e[2];(3&i)===t&&(i&=2047,i+=1,e[2]=i)}function Mi(e,t,i,n){const r=null!=n?n:-1;let s=0;for(let o=void 0!==n?65535&e[18]:0;o<t.length;o++)if("number"==typeof t[o+1]){if(s=t[o],null!=n&&s>=n)break}else t[o]<0&&(e[18]+=65536),(s<r||-1==r)&&(ki(e,i,t,o),e[18]=(4294901760&e[18])+o+2),o++}function ki(e,t,i,n){const r=i[n]<0,s=i[n+1],o=e[r?-i[n]:i[n]];r?e[2]>>11<e[18]>>16&&(3&e[2])===t&&(e[2]+=2048,s.call(o)):s.call(o)}class Ai{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Ii(e,t,i){const n=Nt(e);let r=0;for(;r<i.length;){const s=i[r];if("number"==typeof s){if(0!==s)break;r++;const o=i[r++],a=i[r++],l=i[r++];n?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=i[++r];Oi(o)?n&&e.setProperty(t,o,a):n?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function Ri(e){return 3===e||4===e||6===e}function Oi(e){return 64===e.charCodeAt(0)}function Ni(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let i=-1;for(let n=0;n<t.length;n++){const r=t[n];"number"==typeof r?i=r:0===i||Di(e,i,r,null,-1===i||2===i?t[++n]:null)}}return e}function Di(e,t,i,n,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const i=e[s++];if("number"==typeof i){if(i===t){o=-1;break}if(i>t){o=s-1;break}}}for(;s<e.length;){const t=e[s];if("number"==typeof t)break;if(t===i){if(null===n)return void(null!==r&&(e[s+1]=r));if(n===e[s+1])return void(e[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,i),null!==n&&e.splice(s++,0,n),null!==r&&e.splice(s++,0,r)}function zi(e){return-1!==e}function Li(e){return 32767&e}function Bi(e){return e>>16}function Fi(e,t){let i=Bi(e),n=t;for(;i>0;)n=n[15],i--;return n}function ji(e){return"string"==typeof e?e:null==e?"":""+e}function Vi(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():ji(e)}const Ui=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Re))();function qi(e){return{name:"body",target:e.ownerDocument.body}}function Hi(e){return e instanceof Function?e():e}let Gi=!0;function Wi(e){const t=Gi;return Gi=e,t}let Zi=0;function $i(e,t){const i=Ki(e,t);if(-1!==i)return i;const n=t[1];n.firstCreatePass&&(e.injectorIndex=t.length,Xi(n.data,e),Xi(t,null),Xi(n.blueprint,null));const r=Yi(e,t),s=e.injectorIndex;if(zi(r)){const e=Li(r),i=Fi(r,t),n=i[1].data;for(let r=0;r<8;r++)t[s+r]=i[e+r]|n[e+r]}return t[s+8]=r,s}function Xi(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Ki(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function Yi(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let i=t[6],n=1;for(;i&&-1===i.injectorIndex;)i=(t=t[15])?t[6]:null,n++;return i?i.injectorIndex|n<<16:-1}function Ji(e,t,i){!function(e,t,i){let n="string"!=typeof i?i[Fe]:i.charCodeAt(0)||0;null==n&&(n=i[Fe]=Zi++);const r=255&n,s=1<<r,o=64&r,a=32&r,l=t.data;128&r?o?a?l[e+7]|=s:l[e+6]|=s:a?l[e+5]|=s:l[e+4]|=s:o?a?l[e+3]|=s:l[e+2]|=s:a?l[e+1]|=s:l[e]|=s}(e,t,i)}function Qi(e,t,i,n=ce.Default,r){if(null!==e){const r=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e[Fe];return"number"==typeof t&&t>0?255&t:t}(i);if("function"==typeof r){pi(t,e);try{const e=r();if(null!=e||n&ce.Optional)return e;throw new Error(`No provider for ${Vi(i)}!`)}finally{yi()}}else if("number"==typeof r){if(-1===r)return new an(e,t);let s=null,o=Ki(e,t),a=-1,l=n&ce.Host?t[16][6]:null;for((-1===o||n&ce.SkipSelf)&&(a=-1===o?Yi(e,t):t[o+8],on(n,!1)?(s=t[1],o=Li(a),t=Fi(a,t)):o=-1);-1!==o;){a=t[o+8];const e=t[1];if(sn(r,o,e.data)){const e=tn(o,t,i,s,n,l);if(e!==en)return e}on(n,t[1].data[o+8]===l)&&sn(r,o,t)?(s=e,o=Li(a),t=Fi(a,t)):o=-1}}}if(n&ce.Optional&&void 0===r&&(r=null),0==(n&(ce.Self|ce.Host))){const e=t[9],s=$e(void 0);try{return e?e.get(i,r,n&ce.Optional):Je(i,r,n&ce.Optional)}finally{$e(s)}}if(n&ce.Optional)return r;throw new Error(`NodeInjector: NOT_FOUND [${Vi(i)}]`)}const en={};function tn(e,t,i,n,r,s){const o=t[1],a=o.data[e+8],l=nn(a,o,i,null==n?kt(a)&&Gi:n!=o&&3===a.type,r&ce.Host&&s===a);return null!==l?rn(t,o,l,a):en}function nn(e,t,i,n,r){const s=e.providerIndexes,o=t.data,a=65535&s,l=e.directiveStart,c=s>>16,h=r?a+c:e.directiveEnd;for(let u=n?a:a+c;u<h;u++){const e=o[u];if(u<l&&i===e||u>=l&&e.type===i)return u}if(r){const e=o[l];if(e&&It(e)&&e.type===i)return l}return null}function rn(e,t,i,n){let r=e[i];const s=t.data;if(r instanceof Ai){const o=r;if(o.resolving)throw new Error("Circular dep for "+Vi(s[i]));const a=Wi(o.canSeeViewProviders);let l;o.resolving=!0,o.injectImpl&&(l=$e(o.injectImpl)),pi(e,n);try{r=e[i]=o.factory(void 0,s,e,n),t.firstCreatePass&&i>=n.directiveStart&&function(e,t,i){const{onChanges:n,onInit:r,doCheck:s}=t;n&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,n)),r&&(i.preOrderHooks||(i.preOrderHooks=[])).push(-e,r),s&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,s),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,s))}(i,s[i],t)}finally{o.injectImpl&&$e(l),Wi(a),o.resolving=!1,yi()}}return r}function sn(e,t,i){const n=64&e,r=32&e;let s;return s=128&e?n?r?i[t+7]:i[t+6]:r?i[t+5]:i[t+4]:n?r?i[t+3]:i[t+2]:r?i[t+1]:i[t],!!(s&1<<e)}function on(e,t){return!(e&ce.Self||e&ce.Host&&t)}class an{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Qi(this._tNode,this._lView,e,void 0,t)}}function ln(e){const t=e;if(Pe(e))return()=>{const e=ln(Te(t));return e?e():null};let i=St(t);if(null===i){const e=ge(t);i=e&&e.factory}return i||null}function cn(e){return ne(()=>{const t=e.prototype.constructor,i=t[Be]||ln(t),n=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==n;){const e=r[Be]||ln(r);if(e&&e!==i)return e;r=Object.getPrototypeOf(r)}return e=>new e})}function hn(e){return e.ngDebugContext}function un(e){return e.ngOriginalError}function dn(e,...t){e.error(...t)}class pn{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),n=function(e){return e.ngErrorLogger||dn}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?hn(e)?hn(e):this._findContext(un(e)):null}_findOriginalError(e){let t=un(e);for(;t&&un(t);)t=un(t);return t}}class mn{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}class fn extends mn{getTypeName(){return"HTML"}}class gn extends mn{getTypeName(){return"Style"}}class _n extends mn{getTypeName(){return"Script"}}class yn extends mn{getTypeName(){return"URL"}}class vn extends mn{getTypeName(){return"ResourceURL"}}function xn(e){return e instanceof mn?e.changingThisBreaksApplicationSecurity:e}function bn(e,t){const i=wn(e);if(null!=i&&i!==t){if("ResourceURL"===i&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${i} (see http://g.co/ng/security#xss)`)}return i===t}function wn(e){return e instanceof mn&&e.getTypeName()||null}let Cn=!0,Sn=!1;function En(){return Sn=!0,Cn}class Tn{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");let t=this.inertDocument.body;if(null==t){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e),t=this.inertDocument.createElement("body"),e.appendChild(t)}t.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!t.querySelector||t.querySelector("svg")?(t.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=t.querySelector&&t.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(n){return null}const t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);const i=t.response.body;return i.removeChild(i.firstChild),i}getInertBodyElement_DOMParser(e){e="<body><remove></remove>"+e+"</body>";try{const t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(t){return null}}getInertBodyElement_InertDocument(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=e,t;const i=this.inertDocument.createElement("body");return i.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let n=t.length-1;0<n;n--){const i=t.item(n).name;"xmlns:ns1"!==i&&0!==i.indexOf("ns1:")||e.removeAttribute(i)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const Pn=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Mn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function kn(e){return(e=String(e)).match(Pn)||e.match(Mn)?e:(En()&&console.warn(`WARNING: sanitizing unsafe URL value ${e} (see http://g.co/ng/security#xss)`),"unsafe:"+e)}function An(e){const t={};for(const i of e.split(","))t[i]=!0;return t}function In(...e){const t={};for(const i of e)for(const e in i)i.hasOwnProperty(e)&&(t[e]=!0);return t}const Rn=An("area,br,col,hr,img,wbr"),On=An("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Nn=An("rp,rt"),Dn=In(Nn,On),zn=In(Rn,In(On,An("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),In(Nn,An("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Dn),Ln=An("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Bn=An("srcset"),Fn=In(Ln,Bn,An("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),An("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),jn=An("script,style,template");class Vn{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!zn.hasOwnProperty(t))return this.sanitizedSomething=!0,!jn.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const e=i.item(r),t=e.name,s=t.toLowerCase();if(!Fn.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=e.value;Ln[s]&&(o=kn(o)),Bn[s]&&(n=o,o=(n=String(n)).split(",").map(e=>kn(e.trim())).join(", ")),this.buf.push(" ",t,'="',Hn(o),'"')}var n;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();zn.hasOwnProperty(t)&&!Rn.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Hn(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+e.outerHTML);return t}}const Un=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,qn=/([^\#-~ |!])/g;function Hn(e){return e.replace(/&/g,"&amp;").replace(Un,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(qn,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Gn;function Wn(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}const Zn=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),$n=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Xn=/^url\(([^)]+)\)$/;function Kn(e){const t=function(){const e=Kt();return e&&e[12]}();return t?t.sanitize(Zn.URL,e)||"":bn(e,"URL")?xn(e):kn(ji(e))}function Yn(e,t){e.__ngContext__=t}function Jn(e){throw new Error("Multiple components match node with tagname "+e.tagName)}function Qn(){throw new Error("Cannot mix multi providers and regular providers")}function er(e,t,i){let n=e.length;for(;;){const r=e.indexOf(t,i);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const i=t.length;if(r+i===n||e.charCodeAt(r+i)<=32)return r}i=r+1}}function tr(e,t,i){let n=0;for(;n<e.length;){let r=e[n++];if(i&&"class"===r){if(r=e[n],-1!==er(r.toLowerCase(),t,0))return!0}else if(1===r){for(;n<e.length&&"string"==typeof(r=e[n++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function ir(e){return 0===e.type&&"ng-template"!==e.tagName}function nr(e,t,i){return t===(0!==e.type||i?e.tagName:"ng-template")}function rr(e,t,i){let n=4;const r=e.attrs||[],s=function(e){for(let t=0;t<e.length;t++)if(Ri(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!nr(e,l,i)||""===l&&1===t.length){if(sr(n))return!1;o=!0}}else{const c=8&n?l:t[++a];if(8&n&&null!==e.attrs){if(!tr(e.attrs,c,i)){if(sr(n))return!1;o=!0}continue}const h=or(8&n?"class":l,r,ir(e),i);if(-1===h){if(sr(n))return!1;o=!0;continue}if(""!==c){let e;e=h>s?"":r[h+1].toLowerCase();const t=8&n?e:null;if(t&&-1!==er(t,c,0)||2&n&&c!==e){if(sr(n))return!1;o=!0}}}}else{if(!o&&!sr(n)&&!sr(l))return!1;if(o&&sr(l))continue;o=!1,n=l|1&n}}return sr(n)||o}function sr(e){return 0==(1&e)}function or(e,t,i,n){if(null===t)return-1;let r=0;if(n||!i){let i=!1;for(;r<t.length;){const n=t[r];if(n===e)return r;if(3===n||6===n)i=!0;else{if(1===n||2===n){let e=t[++r];for(;"string"==typeof e;)e=t[++r];continue}if(4===n)break;if(0===n){r+=4;continue}}r+=i?1:2}return-1}return function(e,t){let i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){const n=e[i];if("number"==typeof n)return-1;if(n===t)return i;i++}return-1}(t,e)}function ar(e,t,i=!1){for(let n=0;n<t.length;n++)if(rr(e,t[n],i))return!0;return!1}function lr(e,t){e:for(let i=0;i<t.length;i++){const n=t[i];if(e.length===n.length){for(let t=0;t<e.length;t++)if(e[t]!==n[t])continue e;return!0}}return!1}function cr(e,t){return e?":not("+t.trim()+")":t}function hr(e){let t=e[0],i=1,n=2,r="",s=!1;for(;i<e.length;){let o=e[i];if("string"==typeof o)if(2&n){const t=e[++i];r+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""===r||sr(o)||(t+=cr(s,r),r=""),n=o,s=s||!sr(n);i++}return""!==r&&(t+=cr(s,r)),t}const ur={};function dr(e){const t=e[3];return Pt(t)?t[3]:t}function pr(e){return fr(e[13])}function mr(e){return fr(e[4])}function fr(e){for(;null!==e&&!Pt(e);)e=e[4];return e}function gr(e){_r(Yt(),Kt(),xi()+e,ni())}function _r(e,t,i,n){if(!n)if(3==(3&t[2])){const n=e.preOrderCheckHooks;null!==n&&Ei(t,n,i)}else{const n=e.preOrderHooks;null!==n&&Ti(t,n,0,i)}bi(i)}function yr(e,t){return e<<17|t<<2}function vr(e){return e>>17&32767}function xr(e){return 2|e}function br(e){return(131068&e)>>2}function wr(e,t){return-131069&e|t<<2}function Cr(e){return 1|e}function Sr(e,t){const i=e.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const r=i[n],s=i[n+1];if(-1!==s){const i=e.data[s];di(r),i.contentQueries(2,t[s],s)}}}function Er(e,t,i){return Nt(t)?t.createElement(e,i):null===i?t.createElement(e):t.createElementNS(i,e)}function Tr(e,t,i,n,r,s,o,a,l,c){const h=t.blueprint.slice();return h[0]=r,h[2]=140|n,Wt(h),h[3]=h[15]=e,h[8]=i,h[10]=o||e&&e[10],h[11]=a||e&&e[11],h[12]=l||e&&e[12]||null,h[9]=c||e&&e[9]||null,h[6]=s,h[16]=2==t.type?e[16]:h,h}function Pr(e,t,i,n,r,s){const o=i+20,a=e.data[o]||function(e,t,i,n,r,s){const o=Qt(),a=ti(),l=a?o:o&&o.parent,c=e.data[i]=Lr(0,l&&l!==t?l:null,n,i,r,s);return null===e.firstChild&&(e.firstChild=c),o&&(!a||null!=o.child||null===c.parent&&2!==o.type?a||(o.next=c):o.child=c),c}(e,t,o,n,r,s);return ei(a,!0),a}function Mr(e,t,i){mi(t,t[6]);try{const n=e.viewQuery;null!==n&&ss(1,n,i);const r=e.template;null!==r&&Ir(e,t,r,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Sr(e,t),e.staticViewQueries&&ss(2,e.viewQuery,i);const s=e.components;null!==s&&function(e,t){for(let i=0;i<t.length;i++)es(e,t[i])}(t,s)}catch(n){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),n}finally{t[2]&=-5,vi()}}function kr(e,t,i,n){const r=t[2];if(256==(256&r))return;mi(t,t[6]);const s=ni();try{Wt(t),$t.lFrame.bindingIndex=e.bindingStartIndex,null!==i&&Ir(e,t,i,2,n);const o=3==(3&r);if(!s)if(o){const i=e.preOrderCheckHooks;null!==i&&Ei(t,i,null)}else{const i=e.preOrderHooks;null!==i&&Ti(t,i,0,null),Pi(t,0)}if(function(e){for(let t=pr(e);null!==t;t=mr(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const i=e[t],n=i[3];0==(1024&i[2])&&Zt(n,1),i[2]|=1024}}}(t),function(e){for(let t=pr(e);null!==t;t=mr(t))for(let e=10;e<t.length;e++){const i=t[e],n=i[1];Ht(i)&&kr(n,i,n.template,i[8])}}(t),null!==e.contentQueries&&Sr(e,t),!s)if(o){const i=e.contentCheckHooks;null!==i&&Ei(t,i)}else{const i=e.contentHooks;null!==i&&Ti(t,i,1),Pi(t,1)}!function(e,t){try{const i=e.expandoInstructions;if(null!==i){let n=e.expandoStartIndex,r=-1,s=-1;for(let e=0;e<i.length;e++){const o=i[e];"number"==typeof o?o<=0?(s=0-o,bi(s),n+=9+i[++e],r=n):n+=o:(null!==o&&(li(n,r),o(2,t[r])),r++)}}}finally{bi(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let i=0;i<t.length;i++)Qr(e,t[i])}(t,a);const l=e.viewQuery;if(null!==l&&ss(2,l,n),!s)if(o){const i=e.viewCheckHooks;null!==i&&Ei(t,i)}else{const i=e.viewHooks;null!==i&&Ti(t,i,2),Pi(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Zt(t[3],-1))}finally{vi()}}function Ar(e,t,i,n){const r=t[10],s=!ni(),o=qt(t);try{s&&!o&&r.begin&&r.begin(),o&&Mr(e,t,n),kr(e,t,i,n)}finally{s&&!o&&r.end&&r.end()}}function Ir(e,t,i,n,r){const s=xi();try{bi(-1),2&n&&t.length>20&&_r(e,t,0,ni()),i(n,r)}finally{bi(s)}}function Rr(e,t,i){if(Mt(t)){const n=t.directiveEnd;for(let r=t.directiveStart;r<n;r++){const t=e.data[r];t.contentQueries&&t.contentQueries(1,i[r],r)}}}function Or(e,t,i){Xt()&&(function(e,t,i,n){const r=i.directiveStart,s=i.directiveEnd;e.firstCreatePass||$i(i,t),Yn(n,t);const o=i.initialInputs;for(let a=r;a<s;a++){const n=e.data[a],s=It(n);s&&Xr(t,i,n);const l=rn(t,e,a,i);Yn(l,t),null!==o&&Kr(0,a-r,l,n,0,o),s&&(Vt(i.index,t)[8]=l)}}(e,t,i,Bt(i,t)),128==(128&i.flags)&&function(e,t,i){const n=i.directiveStart,r=i.directiveEnd,s=e.expandoInstructions,o=e.firstCreatePass,a=i.index-20,l=$t.lFrame.currentDirectiveIndex;try{bi(a);for(let i=n;i<r;i++){const n=e.data[i],r=t[i];ci(i),null!==n.hostBindings||0!==n.hostVars||null!==n.hostAttrs?qr(n,r):o&&s.push(null)}}finally{bi(-1),ci(l)}}(e,t,i))}function Nr(e,t,i=Bt){const n=t.localNames;if(null!==n){let r=t.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?i(t,e):e[o];e[r++]=a}}}function Dr(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=zr(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function zr(e,t,i,n,r,s,o,a,l,c){const h=20+n,u=h+r,d=function(e,t){const i=[];for(let n=0;n<t;n++)i.push(n<e?null:ur);return i}(h,u);return d[1]={type:e,id:t,blueprint:d,template:i,queries:null,viewQuery:a,node:null,data:d.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:u,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:c,incompleteFirstPass:!1}}function Lr(e,t,i,n,r,s){return{type:i,index:n,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Br(e,t,i){for(let n in e)if(e.hasOwnProperty(n)){const r=e[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(t,r):i[n]=[t,r]}return i}function Fr(e,t,i,n,r,s,o,a){const l=Bt(t,i);let c,h=t.inputs;var u;!a&&null!=h&&(c=h[n])?(us(e,i,c,n,r),kt(t)&&function(e,t){const i=Vt(t,e);16&i[2]||(i[2]|=64)}(i,t.index)):3===t.type&&(n="class"===(u=n)?"className":"for"===u?"htmlFor":"formaction"===u?"formAction":"innerHtml"===u?"innerHTML":"readonly"===u?"readOnly":"tabindex"===u?"tabIndex":u,r=null!=o?o(r,t.tagName||"",n):r,Nt(s)?s.setProperty(l,n,r):Oi(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}function jr(e,t,i,n){let r=!1;if(Xt()){const s=function(e,t,i){const n=e.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];ar(i,o.selectors,!1)&&(r||(r=[]),Ji($i(i,t),e,o.type),It(o)?(2&i.flags&&Jn(i),Gr(e,i),r.unshift(o)):r.push(o))}return r}(e,t,i),o=null===n?null:{"":-1};if(null!==s){let n=0;r=!0,Zr(i,e.data.length,s.length);for(let e=0;e<s.length;e++){const t=s[e];t.providersResolver&&t.providersResolver(t)}Hr(e,i,s.length);let a=!1,l=!1;for(let r=0;r<s.length;r++){const c=s[r];i.mergedAttrs=Ni(i.mergedAttrs,c.hostAttrs),$r(e,t,c),Wr(e.data.length-1,c,o),null!==c.contentQueries&&(i.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(i.flags|=128),!a&&(c.onChanges||c.onInit||c.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i.index-20),a=!0),l||!c.onChanges&&!c.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i.index-20),l=!0),Vr(e,c),n+=c.hostVars}!function(e,t){const i=t.directiveEnd,n=e.data,r=t.attrs,s=[];let o=null,a=null;for(let l=t.directiveStart;l<i;l++){const e=n[l],i=e.inputs,c=null===r||ir(t)?null:Yr(i,r);s.push(c),o=Br(i,l,o),a=Br(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=o,t.outputs=a}(e,i),Ur(e,t,n)}o&&function(e,t,i){if(t){const n=e.localNames=[];for(let e=0;e<t.length;e+=2){const r=i[t[e+1]];if(null==r)throw new Error(`Export of name '${t[e+1]}' not found!`);n.push(t[e],r)}}}(i,n,o)}return i.mergedAttrs=Ni(i.mergedAttrs,i.attrs),r}function Vr(e,t){const i=e.expandoInstructions;i.push(t.hostBindings),0!==t.hostVars&&i.push(t.hostVars)}function Ur(e,t,i){for(let n=0;n<i;n++)t.push(ur),e.blueprint.push(ur),e.data.push(null)}function qr(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Hr(e,t,i){const n=20-t.index,r=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(n,r,i)}function Gr(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Wr(e,t,i){if(i){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)i[t.exportAs[n]]=e;It(t)&&(i[""]=e)}}function Zr(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}function $r(e,t,i){e.data.push(i);const n=i.factory||(i.factory=St(i.type)),r=new Ai(n,It(i),null);e.blueprint.push(r),t.push(r)}function Xr(e,t,i){const n=Bt(t,e),r=Dr(i),s=e[10],o=ts(e,Tr(e,r,null,i.onPush?64:16,n,t,s,s.createRenderer(n,i)));e[t.index]=o}function Kr(e,t,i,n,r,s){const o=s[t];if(null!==o){const e=n.setInput;for(let t=0;t<o.length;){const r=o[t++],s=o[t++],a=o[t++];null!==e?n.setInput(i,a,r,s):i[s]=a}}}function Yr(e,t){let i=null,n=0;for(;n<t.length;){const r=t[n];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===i&&(i=[]),i.push(r,e[r],t[n+1])),n+=2}else n+=2;else n+=4}return i}function Jr(e,t,i,n){return new Array(e,!0,!1,t,null,0,n,i,null,null)}function Qr(e,t){const i=Vt(t,e);if(Ht(i)){const e=i[1];80&i[2]?kr(e,i,e.template,i[8]):i[5]>0&&function e(t){for(let n=pr(t);null!==n;n=mr(n))for(let t=10;t<n.length;t++){const i=n[t];if(1024&i[2]){const e=i[1];kr(e,i,e.template,i[8])}else i[5]>0&&e(i)}const i=t[1].components;if(null!==i)for(let n=0;n<i.length;n++){const r=Vt(i[n],t);Ht(r)&&r[5]>0&&e(r)}}(i)}}function es(e,t){const i=Vt(t,e),n=i[1];!function(e,t){for(let i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])}(n,i),Mr(n,i,i[8])}function ts(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function is(e){for(;e;){e[2]|=64;const t=dr(e);if(Rt(e)&&!t)return e;e=t}return null}function ns(e,t,i){const n=t[10];n.begin&&n.begin();try{kr(e,t,e.template,i)}catch(r){throw hs(t,r),r}finally{n.end&&n.end()}}function rs(e){!function(e){for(let t=0;t<e.components.length;t++){const i=e.components[t],n=Ut(i),r=n[1];Ar(r,n,r.template,i)}}(e[8])}function ss(e,t,i){di(0),t(e,i)}const os=(()=>Promise.resolve(null))();function as(e){return e[7]||(e[7]=[])}function ls(e){return e.cleanup||(e.cleanup=[])}function cs(e,t,i){return(null===e||It(e))&&(i=function(e){for(;Array.isArray(e);){if("object"==typeof e[1])return e;e=e[0]}return null}(i[t.index])),i[11]}function hs(e,t){const i=e[9],n=i?i.get(pn,null):null;n&&n.handleError(t)}function us(e,t,i,n,r){for(let s=0;s<i.length;){const o=i[s++],a=i[s++],l=t[o],c=e.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function ds(e,t){const i=t[3];return-1===e.index?Pt(i)?i:null:i}function ps(e,t){const i=ds(e,t);return i?Es(t[11],i[7]):null}function ms(e,t,i,n,r){if(null!=n){let s,o=!1;Pt(n)?s=n:Tt(n)&&(o=!0,n=n[0]);const a=zt(n);0===e&&null!==i?null==r?Cs(t,i,a):ws(t,i,a,r||null):1===e&&null!==i?ws(t,i,a,r||null):2===e?function(e,t,i){const n=Es(e,t);n&&function(e,t,i,n){Nt(e)?e.removeChild(t,i,n):t.removeChild(i)}(e,n,t,i)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function(e,t,i,n,r){const s=i[7];s!==zt(i)&&ms(t,e,n,s,r);for(let o=10;o<i.length;o++){const r=i[o];As(r[1],r,e,t,n,s)}}(t,e,s,i,r)}}function fs(e,t,i,n){const r=ps(e.node,t);r&&As(e,t,t[11],i?1:2,r,n)}function gs(e,t){const i=e[9],n=i.indexOf(t);1024&t[2]&&Zt(t[3],-1),i.splice(n,1)}function _s(e,t){if(e.length<=10)return;const i=10+t,n=e[i];if(n){const r=n[17];null!==r&&r!==e&&gs(r,n),t>0&&(e[i-1][4]=n[4]);const s=st(e,10+t);fs(n[1],n,!1,null);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function ys(e,t){if(!(256&t[2])){const i=t[11];Nt(i)&&i.destroyNode&&As(e,t,i,3,null,null),function(e){let t=e[13];if(!t)return xs(e[1],e);for(;t;){let i=null;if(Tt(t))i=t[13];else{const e=t[10];e&&(i=e)}if(!i){for(;t&&!t[4]&&t!==e;)Tt(t)&&xs(t[1],t),t=vs(t,e);null===t&&(t=e),Tt(t)&&xs(t[1],t),i=t&&t[4]}t=i}}(t)}}function vs(e,t){let i;return Tt(e)&&(i=e[6])&&2===i.type?ds(i,e):e[3]===t?null:e[3]}function xs(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let i;if(null!=e&&null!=(i=e.destroyHooks))for(let n=0;n<i.length;n+=2){const e=t[i[n]];if(!(e instanceof Ai)){const t=i[n+1];if(Array.isArray(t))for(let i=0;i<t.length;i+=2)t[i+1].call(e[t[i]]);else t.call(e)}}}(e,t),function(e,t){const i=e.cleanup;if(null!==i){const e=t[7];for(let n=0;n<i.length-1;n+=2)if("string"==typeof i[n]){const r=i[n+1],s="function"==typeof r?r(t):zt(t[r]),o=e[i[n+2]],a=i[n+3];"boolean"==typeof a?s.removeEventListener(i[n],o,a):a>=0?e[a]():e[-a].unsubscribe(),n+=2}else i[n].call(e[i[n+1]]);t[7]=null}}(e,t);const i=t[6];i&&3===i.type&&Nt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&Pt(t[3])){n!==t[3]&&gs(n,t);const i=t[19];null!==i&&i.detachView(e)}}}function bs(e,t,i){let n=t.parent;for(;null!=n&&(4===n.type||5===n.type);)n=(t=n).parent;if(null==n){const e=i[6];return 2===e.type?ps(e,i):i[0]}if(t&&5===t.type&&4&t.flags)return Bt(t,i).parentNode;if(2&n.flags){const t=e.data,i=t[t[n.index].directiveStart].encapsulation;if(i!==ut.ShadowDom&&i!==ut.Native)return null}return Bt(n,i)}function ws(e,t,i,n){Nt(e)?e.insertBefore(t,i,n):t.insertBefore(i,n,!0)}function Cs(e,t,i){Nt(e)?e.appendChild(t,i):t.appendChild(i)}function Ss(e,t,i,n){null!==n?ws(e,t,i,n):Cs(e,t,i)}function Es(e,t){return Nt(e)?e.parentNode(t):t.parentNode}function Ts(e,t){if(2===e.type){const i=ds(e,t);return null===i?null:Ms(i.indexOf(t,10)-10,i)}return 4===e.type||5===e.type?Bt(e,t):null}function Ps(e,t,i,n){const r=bs(e,n,t);if(null!=r){const e=t[11],s=Ts(n.parent||t[6],t);if(Array.isArray(i))for(let t=0;t<i.length;t++)Ss(e,r,i[t],s);else Ss(e,r,i,s)}}function Ms(e,t){const i=10+e+1;if(i<t.length){const e=t[i],n=e[1].firstChild;if(null!==n)return function e(t,i){if(null!==i){const n=i.type;if(3===n)return Bt(i,t);if(0===n)return Ms(-1,t[i.index]);if(4===n||5===n){const n=i.child;if(null!==n)return e(t,n);{const e=t[i.index];return Pt(e)?Ms(-1,e):zt(e)}}{const n=t[16],r=n[6],s=dr(n),o=r.projection[i.projection];return null!=o?e(s,o):e(t,i.next)}}return null}(e,n)}return t[7]}function ks(e,t,i,n,r,s,o){for(;null!=i;){const a=n[i.index],l=i.type;o&&0===t&&(a&&Yn(zt(a),n),i.flags|=4),64!=(64&i.flags)&&(4===l||5===l?(ks(e,t,i.child,n,r,s,!1),ms(t,e,r,a,s)):1===l?Is(e,t,n,i,r,s):ms(t,e,r,a,s)),i=o?i.projectionNext:i.next}}function As(e,t,i,n,r,s){ks(i,n,e.node.child,t,r,s,!1)}function Is(e,t,i,n,r,s){const o=i[16],a=o[6].projection[n.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)ms(t,e,r,a[l],s);else ks(e,t,a,o[3],r,s,!0)}function Rs(e,t,i){Nt(e)?e.setAttribute(t,"style",i):t.style.cssText=i}function Os(e,t,i){Nt(e)?""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i):t.className=i}class Ns{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const e=this._lView;return null==e[0]?function e(t,i,n,r,s=!1){for(;null!==n;){const o=i[n.index];if(null!==o&&r.push(zt(o)),Pt(o))for(let t=10;t<o.length;t++){const i=o[t],n=i[1].firstChild;null!==n&&e(i[1],i,n,r)}const a=n.type;if(4===a||5===a)e(t,i,n.child,r);else if(1===a){const t=i[16],s=t[6].projection[n.projection];if(Array.isArray(s))r.push(...s);else{const i=dr(t);e(i[1],i,s,r,!0)}}n=s?n.projectionNext:n.next}return r}(e[1],e,e[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}ys(this._lView[1],this._lView)}onDestroy(e){var t,i,n;t=this._lView[1],n=e,as(i=this._lView).push(n),t.firstCreatePass&&ls(t).push(i[7].length-1,null)}markForCheck(){is(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ns(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,i){ri(!0);try{ns(e,t,i)}finally{ri(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}detachFromAppRef(){var e;this._appRef=null,As(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Ds extends Ns{constructor(e){super(e),this._view=e}detectChanges(){rs(this._view)}checkNoChanges(){!function(e){ri(!0);try{rs(e)}finally{ri(!1)}}(this._view)}get context(){return null}}let zs,Ls,Bs;function Fs(e,t,i){return zs||(zs=class extends e{}),new zs(Bt(t,i))}function js(e,t,i,n){return Ls||(Ls=class extends e{constructor(e,t,i){super(),this._declarationView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Tr(this._declarationView,t,e,16,null,t.node);i[17]=this._declarationView[this._declarationTContainer.index];const n=this._declarationView[19];return null!==n&&(i[19]=n.createEmbeddedView(t)),Mr(t,i,e),new Ns(i)}}),0===i.type?new Ls(n,i,Fs(t,i,n)):null}function Vs(e,t,i,n){let r;Bs||(Bs=class extends e{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostView=i}get element(){return Fs(t,this._hostTNode,this._hostView)}get injector(){return new an(this._hostTNode,this._hostView)}get parentInjector(){const e=Yi(this._hostTNode,this._hostView),t=Fi(e,this._hostView),i=function(e,t,i){if(i.parent&&-1!==i.parent.injectorIndex){const e=i.parent.injectorIndex;let t=i.parent;for(;null!=t.parent&&e==t.parent.injectorIndex;)t=t.parent;return t}let n=Bi(e),r=t,s=t[6];for(;n>1;)r=r[15],s=r[6],n--;return s}(e,this._hostView,this._hostTNode);return zi(e)&&null!=i?new an(i,t):new an(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){return null!==this._lContainer[8]&&this._lContainer[8][e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const n=e.createEmbeddedView(t||{});return this.insert(n,i),n}createComponent(e,t,i,n,r){const s=i||this.parentInjector;if(!r&&null==e.ngModule&&s){const e=s.get(tt,null);e&&(r=e)}const o=e.create(s,n,void 0,r);return this.insert(o.hostView,t),o}insert(e,t){const i=e._lView,n=i[1];if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Pt(i[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=i[3],n=new Bs(t,t[6],t[3]);n.detach(n.indexOf(e))}}const r=this._adjustIndex(t);return function(e,t,i,n){const r=10+n,s=i.length;n>0&&(i[r-1][4]=t),n<s-10?(t[4]=i[r],rt(i,10+n,t)):(i.push(t),t[4]=null),t[3]=i;const o=t[17];null!==o&&i!==o&&function(e,t){const i=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===i?e[9]=[t]:i.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(n,i,this._lContainer,r),fs(n,i,!0,Ms(r,this._lContainer)),e.attachToViewContainerRef(this),rt(this._lContainer[8],r,e),e}move(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(e,t)}indexOf(e){const t=this._lContainer[8];return null!==t?t.indexOf(e):-1}remove(e){this.allocateContainerIfNeeded();const t=this._adjustIndex(e,-1);!function(e,t){const i=_s(e,t);i&&ys(i[1],i)}(this._lContainer,t),st(this._lContainer[8],t)}detach(e){this.allocateContainerIfNeeded();const t=this._adjustIndex(e,-1),i=_s(this._lContainer,t);return i&&null!=st(this._lContainer[8],t)?new Ns(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const s=n[i.index];if(Pt(s))r=s;else{let e;if(4===i.type)e=zt(s);else if(e=n[11].createComment(""),Rt(n)){const t=n[11],r=Bt(i,n);ws(t,Es(t,r),e,function(e,t){return Nt(e)?e.nextSibling(t):t.nextSibling}(t,r))}else Ps(n[1],n,e,i);n[i.index]=r=Jr(s,n,e,i),ts(n,r)}return new Bs(r,i,n)}function Us(e=!1){return function(e,t,i){if(!i&&kt(e)){const i=Vt(e.index,t);return new Ns(i,i)}return 3===e.type||0===e.type||4===e.type||5===e.type?new Ns(t[16],t):null}(Qt(),Kt(),e)}let qs=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Hs(),e})();const Hs=Us,Gs=new je("Set Injector scope."),Ws={},Zs={},$s=[];let Xs=void 0;function Ks(){return void 0===Xs&&(Xs=new et),Xs}function Ys(e,t=null,i=null,n){return new Js(e,i,t||Ks(),n)}class Js{constructor(e,t,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];t&&nt(t,i=>this.processProvider(i,e,t)),nt([e],e=>this.processInjectorType(e,[],r)),this.records.set(Ve,to(void 0,this));const s=this.records.get(Gs);this.scope=null!=s?s.value:null,this.source=n||("object"==typeof e?null:we(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Ue,i=ce.Default){this.assertNotDestroyed();const n=Ze(this);try{if(!(i&ce.SkipSelf)){let t=this.records.get(e);if(void 0===t){const i=("function"==typeof(r=e)||"object"==typeof r&&r instanceof je)&&me(e);t=i&&this.injectableDefInScope(i)?to(Qs(e),Ws):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(i&ce.Self?Ks():this.parent).get(e,t=i&ce.Optional&&t===Ue?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(we(e)),n)throw s;return function(e,t,i,n){const r=e.ngTempTokenPath;throw t.__source&&r.unshift(t.__source),e.message=function(e,t,i,n=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=we(t);if(Array.isArray(t))r=t.map(we).join(" -> ");else if("object"==typeof t){let e=[];for(let i in t)if(t.hasOwnProperty(i)){let n=t[i];e.push(i+":"+("string"==typeof n?JSON.stringify(n):we(n)))}r=`{${e.join(", ")}}`}return`${i}${n?"("+n+")":""}[${r}]: ${e.replace(qe,"\n  ")}`}("\n"+e.message,r,i,n),e.ngTokenPath=r,e.ngTempTokenPath=null,e}(s,e,"R3InjectorError",this.source)}throw s}finally{Ze(n)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,i)=>e.push(we(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=Te(e)))return!1;let n=ge(e);const r=null==n&&e.ngModule||void 0,s=void 0===r?e:r,o=-1!==i.indexOf(s);if(void 0!==r&&(n=ge(r)),null==n)return!1;if(null!=n.imports&&!o){let e;i.push(s);try{nt(n.imports,n=>{this.processInjectorType(n,t,i)&&(void 0===e&&(e=[]),e.push(n))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:i,providers:n}=e[t];nt(n,e=>this.processProvider(e,i,n||$s))}}this.injectorDefTypes.add(s),this.records.set(s,to(n.factory,Ws));const a=n.providers;if(null!=a&&!o){const t=e;nt(a,e=>this.processProvider(e,t,a))}return void 0!==r&&void 0!==e.providers}processProvider(e,t,i){let n=no(e=Te(e))?e:Te(e&&e.provide);const r=function(e,t,i){return io(e)?to(void 0,e.useValue):to(eo(e,t,i),Ws)}(e,t,i);if(no(e)||!0!==e.multi){const e=this.records.get(n);e&&void 0!==e.multi&&Qn()}else{let t=this.records.get(n);t?void 0===t.multi&&Qn():(t=to(void 0,Ws,!0),t.factory=()=>Qe(t.multi),this.records.set(n,t)),n=e,t.multi.push(e)}this.records.set(n,r)}hydrate(e,t){var i;return t.value===Zs?function(e){throw new Error("Cannot instantiate cyclic dependency! "+e)}(we(e)):t.value===Ws&&(t.value=Zs,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(i=t.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}function Qs(e){const t=me(e),i=null!==t?t.factory:St(e);if(null!==i)return i;const n=ge(e);if(null!==n)return n.factory;if(e instanceof je)throw new Error(`Token ${we(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const i=ot(t,"?");throw new Error(`Can't resolve all parameters for ${we(e)}: (${i.join(", ")}).`)}const i=function(e){const t=e&&(e[_e]||e[xe]||e[ve]&&e[ve]());if(t){const i=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in v10. Please add @Injectable() to the "${i}" class.`),t}return null}(e);return null!==i?()=>i.factory(e):()=>new e}(e);throw new Error("unreachable")}function eo(e,t,i){let n=void 0;if(no(e)){const t=Te(e);return St(t)||Qs(t)}if(io(e))n=()=>Te(e.useValue);else if((r=e)&&r.useFactory)n=()=>e.useFactory(...Qe(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))n=()=>Ke(Te(e.useExisting));else{const r=Te(e&&(e.useClass||e.provide));if(r||function(e,t,i){let n="";throw e&&t&&(n=` - only instances of Provider and Type are allowed, got: [${t.map(e=>e==i?"?"+i+"?":"...").join(", ")}]`),new Error(`Invalid provider for the NgModule '${we(e)}'`+n)}(t,i,e),!function(e){return!!e.deps}(e))return St(r)||Qs(r);n=()=>new r(...Qe(e.deps))}var r;return n}function to(e,t,i=!1){return{factory:e,value:t,multi:i?[]:void 0}}function io(e){return null!==e&&"object"==typeof e&&He in e}function no(e){return"function"==typeof e}const ro=function(e,t,i){return function(e,t=null,i=null,n){const r=Ys(e,t,i,n);return r._resolveInjectorDefTypes(),r}({name:i},t,e,i)};let so=(()=>{class e{static create(e,t){return Array.isArray(e)?ro(e,t,""):ro(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=Ue,e.NULL=new et,e.\u0275prov=de({token:e,providedIn:"any",factory:()=>Ke(Ve)}),e.__NG_ELEMENT_ID__=-1,e})();const oo=new je("AnalyzeForEntryComponents");let ao=new Map;const lo=new Set;function co(e){return"string"==typeof e?e:e.text()}function ho(e,t,i){let n=i?e.styles:null,r=i?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?s=e:1==s?r=Ce(r,e):2==s&&(n=Ce(n,e+": "+t[++o]+";"))}i?e.styles=n:e.stylesWithoutHost=n,i?e.classes=r:e.classesWithoutHost=r}let uo=null;function po(){if(!uo){const e=Re.Symbol;if(e&&e.iterator)uo=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(uo=i)}}}return uo}function mo(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}class fo{constructor(e){this.wrapped=e}static wrap(e){return new fo(e)}static unwrap(e){return fo.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof fo}}function go(e){return!!_o(e)&&(Array.isArray(e)||!(e instanceof Map)&&po()in e)}function _o(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function yo(e,t,i){return e[t]=i}function vo(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}function xo(e,t,i,n){const r=Kt();return vo(r,oi(),t)&&(Yt(),function(e,t,i,n,r,s){const o=Bt(e,t),a=t[11];if(null==n)Nt(a)?a.removeAttribute(o,i,s):o.removeAttribute(i);else{const t=null==r?ji(n):r(n,e.tagName||"",i);Nt(a)?a.setAttribute(o,i,t,s):s?o.setAttributeNS(s,i,t):o.setAttribute(i,t)}}(wi(),r,e,t,i,n)),xo}function bo(e,t,i,n){return vo(e,oi(),i)?t+ji(i)+n:ur}function wo(e,t,i,n,r,s,o,a){const l=Kt(),c=Yt(),h=e+20,u=c.firstCreatePass?function(e,t,i,n,r,s,o,a,l){const c=t.consts,h=Pr(t,i[6],e,0,o||null,Gt(c,a));jr(t,i,h,Gt(c,l)),Si(t,h);const u=h.tViews=zr(2,-1,n,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c),d=Lr(0,null,2,-1,null,null);return d.injectorIndex=h.injectorIndex,u.node=d,null!==t.queries&&(t.queries.template(t,h),u.queries=t.queries.embeddedTView(h)),h}(e,c,l,t,i,n,r,s,o):c.data[h];ei(u,!1);const d=l[11].createComment("");Ps(c,l,d,u),Yn(d,l),ts(l,l[h]=Jr(d,l,d,u)),At(u)&&Or(c,l,u),null!=o&&Nr(l,u,a)}function Co(e){return jt($t.lFrame.contextLView,e)}function So(e,t=ce.Default){const i=Kt();return null==i?Ke(e,t):Qi(Qt(),i,Te(e),t)}function Eo(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const i=e.attrs;if(i){const e=i.length;let n=0;for(;n<e;){const r=i[n];if(Ri(r))break;if(0===r)n+=2;else if("number"==typeof r)for(n++;n<e&&"string"==typeof i[n];)n++;else{if(r===t)return i[n+1];n+=2}}}return null}(Qt(),e)}function To(){throw new Error("invalid")}function Po(e,t,i){const n=Kt();return vo(n,oi(),t)&&Fr(Yt(),wi(),n,e,t,n[11],i,!1),Po}function Mo(e,t,i,n,r){const s=r?"class":"style";us(e,i,t.inputs[s],s,n)}function ko(e,t,i,n){const r=Kt(),s=Yt(),o=20+e,a=r[11],l=r[o]=Er(t,a,$t.lFrame.currentNamespace),c=s.firstCreatePass?function(e,t,i,n,r,s,o){const a=t.consts,l=Gt(a,s),c=Pr(t,i[6],e,3,r,l);return jr(t,i,c,Gt(a,o)),null!==c.attrs&&ho(c,c.attrs,!1),null!==c.mergedAttrs&&ho(c,c.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,c),c}(e,s,r,0,t,i,n):s.data[o];ei(c,!0);const h=c.mergedAttrs;null!==h&&Ii(a,l,h);const u=c.classes;null!==u&&Os(a,l,u);const d=c.styles;null!==d&&Rs(a,l,d),Ps(s,r,l,c),0===$t.lFrame.elementDepthCount&&Yn(l,r),$t.lFrame.elementDepthCount++,At(c)&&(Or(s,r,c),Rr(s,c,r)),null!==n&&Nr(r,c)}function Ao(){let e=Qt();ti()?ii():(e=e.parent,ei(e,!1));const t=e;$t.lFrame.elementDepthCount--;const i=Yt();i.firstCreatePass&&(Si(i,e),Mt(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Mo(i,t,Kt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Mo(i,t,Kt(),t.stylesWithoutHost,!1)}function Io(e,t,i,n){ko(e,t,i,n),Ao()}function Ro(e,t,i){const n=Kt(),r=Yt(),s=e+20,o=r.firstCreatePass?function(e,t,i,n,r){const s=t.consts,o=Gt(s,n),a=Pr(t,i[6],e,4,"ng-container",o);return null!==o&&ho(a,o,!0),jr(t,i,a,Gt(s,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(e,r,n,t,i):r.data[s];ei(o,!0);const a=n[s]=n[11].createComment("");Ps(r,n,a,o),Yn(a,n),At(o)&&(Or(r,n,o),Rr(r,o,n)),null!=i&&Nr(n,o)}function Oo(){let e=Qt();const t=Yt();ti()?ii():(e=e.parent,ei(e,!1)),t.firstCreatePass&&(Si(t,e),Mt(e)&&t.queries.elementEnd(e))}function No(){return Kt()}function Do(e){return!!e&&"function"==typeof e.then}function zo(e){return!!e&&"function"==typeof e.subscribe}function Lo(e,t,i=!1,n){const r=Kt(),s=Yt(),o=Qt();return Fo(s,r,r[11],o,e,t,i,n),Lo}function Bo(e,t,i=!1,n){const r=Qt(),s=Kt(),o=Yt();return Fo(o,s,cs(hi(o.data),r,s),r,e,t,i,n),Bo}function Fo(e,t,i,n,r,s,o=!1,a){const l=At(n),c=e.firstCreatePass&&(e.cleanup||(e.cleanup=[])),h=as(t);let u=!0;if(3===n.type){const d=Bt(n,t),p=a?a(d):dt,m=p.target||d,f=h.length,g=a?e=>a(zt(e[n.index])).target:n.index;if(Nt(i)){let o=null;if(!a&&l&&(o=function(e,t,i,n){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const e=r[s];if(e===i&&r[s+1]===n){const e=t[7],i=r[s+2];return e.length>i?e[i]:null}"string"==typeof e&&(s+=2)}return null}(e,t,r,n.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,u=!1;else{s=Vo(n,t,s,!1);const e=i.listen(p.name||m,r,s);h.push(s,e),c&&c.push(r,g,f,f+1)}}else s=Vo(n,t,s,!0),m.addEventListener(r,s,o),h.push(s),c&&c.push(r,g,f,o)}const d=n.outputs;let p;if(u&&null!==d&&(p=d[r])){const e=p.length;if(e)for(let i=0;i<e;i+=2){const e=t[p[i]][p[i+1]].subscribe(s),o=h.length;h.push(s,e),c&&c.push(r,n.index,o,-(o+1))}}}function jo(e,t,i){try{return!1!==t(i)}catch(n){return hs(e,n),!1}}function Vo(e,t,i,n){return function r(s){if(s===Function)return i;const o=2&e.flags?Vt(e.index,t):t;0==(32&t[2])&&is(o);let a=jo(t,i,s),l=r.__ngNextListenerFn__;for(;l;)a=jo(t,l,s)&&a,l=l.__ngNextListenerFn__;return n&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Uo(e=1){return function(e){return($t.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,$t.lFrame.contextLView))[8]}(e)}function qo(e,t){let i=null;const n=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===n?ar(e,s,!0):lr(n,s))return r}else i=r}return i}function Ho(e){const t=Kt()[16][6];if(!t.projection){const i=t.projection=ot(e?e.length:1,null),n=i.slice();let r=t.child;for(;null!==r;){const t=e?qo(r,e):0;null!==t&&(n[t]?n[t].projectionNext=r:i[t]=r,n[t]=r),r=r.next}}}function Go(e,t=0,i){const n=Kt(),r=Yt(),s=Pr(r,n[6],e,1,null,i||null);null===s.projection&&(s.projection=t),ii(),function(e,t,i){Is(t[11],0,t,i,bs(e,i,t),Ts(i.parent||t[6],t))}(r,n,s)}function Wo(e,t,i){return Zo(e,"",t,"",i),Wo}function Zo(e,t,i,n,r){const s=Kt(),o=bo(s,t,i,n);return o!==ur&&Fr(Yt(),wi(),s,e,o,s[11],r,!1),Zo}const $o=[];function Xo(e,t,i,n,r){const s=e[i+1],o=null===t;let a=n?vr(s):br(s),l=!1;for(;0!==a&&(!1===l||o);){const i=e[a+1];Ko(e[a],t)&&(l=!0,e[a+1]=n?Cr(i):xr(i)),a=n?vr(i):br(i)}l&&(e[i+1]=n?xr(s):Cr(s))}function Ko(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&ct(e,t)>=0}const Yo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Jo(e){return e.substring(Yo.key,Yo.keyEnd)}function Qo(e,t){const i=Yo.textEnd;return i===t?-1:(t=Yo.keyEnd=function(e,t,i){for(;t<i&&e.charCodeAt(t)>32;)t++;return t}(e,Yo.key=t,i),ea(e,t,i))}function ea(e,t,i){for(;t<i&&e.charCodeAt(t)<=32;)t++;return t}function ta(e,t,i){return ra(e,t,i,!1),ta}function ia(e,t){return ra(e,t,null,!0),ia}function na(e,t){for(let i=function(e){return function(e){Yo.key=0,Yo.keyEnd=0,Yo.value=0,Yo.valueEnd=0,Yo.textEnd=e.length}(e),Qo(e,ea(e,0,Yo.textEnd))}(t);i>=0;i=Qo(t,i))at(e,Jo(t),!0)}function ra(e,t,i,n){const r=Kt(),s=Yt(),o=ai(2);if(s.firstUpdatePass&&oa(s,e,o,n),t!==ur&&vo(r,o,t)){let a;null==i&&(a=function(){const e=$t.lFrame;return null===e?null:e.currentSanitizer}())&&(i=a),ca(s,s.data[xi()+20],r,r[11],e,r[o+1]=function(e,t){return null==e||("function"==typeof t?e=t(e):"string"==typeof t?e+=t:"object"==typeof e&&(e=we(xn(e)))),e}(t,i),n,o)}}function sa(e,t){return t>=e.expandoStartIndex}function oa(e,t,i,n){const r=e.data;if(null===r[i+1]){const s=r[xi()+20],o=sa(e,i);da(s,n)&&null===t&&!o&&(t=!1),t=function(e,t,i,n){const r=hi(e);let s=n?t.residualClasses:t.residualStyles;if(null===r)0===(n?t.classBindings:t.styleBindings)&&(i=la(i=aa(null,e,t,i,n),t.attrs,n),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(i=aa(r,e,t,i,n),null===s){let i=function(e,t,i){const n=i?t.classBindings:t.styleBindings;if(0!==br(n))return e[vr(n)]}(e,t,n);void 0!==i&&Array.isArray(i)&&(i=aa(null,e,t,i[1],n),i=la(i,t.attrs,n),function(e,t,i,n){e[vr(i?t.classBindings:t.styleBindings)]=n}(e,t,n,i))}else s=function(e,t,i){let n=void 0;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)n=la(n,e[s].hostAttrs,i);return la(n,t.attrs,i)}(e,t,n)}return void 0!==s&&(n?t.residualClasses=s:t.residualStyles=s),i}(r,s,t,n),function(e,t,i,n,r,s){let o=s?t.classBindings:t.styleBindings,a=vr(o),l=br(o);e[n]=i;let c,h=!1;if(Array.isArray(i)){const e=i;c=e[1],(null===c||ct(e,c)>0)&&(h=!0)}else c=i;if(r)if(0!==l){const t=vr(e[a+1]);e[n+1]=yr(t,a),0!==t&&(e[t+1]=wr(e[t+1],n)),e[a+1]=131071&e[a+1]|n<<17}else e[n+1]=yr(a,0),0!==a&&(e[a+1]=wr(e[a+1],n)),a=n;else e[n+1]=yr(l,0),0===a?a=n:e[l+1]=wr(e[l+1],n),l=n;h&&(e[n+1]=xr(e[n+1])),Xo(e,c,n,!0),Xo(e,c,n,!1),function(e,t,i,n,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&ct(s,t)>=0&&(i[n+1]=Cr(i[n+1]))}(t,c,e,n,s),o=yr(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,i,o,n)}}function aa(e,t,i,n,r){let s=null;const o=i.directiveEnd;let a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<o&&(s=t[a],n=la(n,s.hostAttrs,r),s!==e);)a++;return null!==e&&(i.directiveStylingLast=a),n}function la(e,t,i){const n=i?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===n&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),at(e,o,!!i||t[++s]))}return void 0===e?null:e}function ca(e,t,i,n,r,s,o,a){if(3!==t.type)return;const l=e.data,c=l[a+1];ua(1==(1&c)?ha(l,t,i,r,br(c),o):void 0)||(ua(s)||function(e){return 2==(2&e)}(c)&&(s=ha(l,null,i,r,a,o)),function(e,t,i,n,r){const s=Nt(e);if(t)r?s?e.addClass(i,n):i.classList.add(n):s?e.removeClass(i,n):i.classList.remove(n);else{const t=-1==n.indexOf("-")?void 0:2;null==r?s?e.removeStyle(i,n,t):i.style.removeProperty(n):s?e.setStyle(i,n,r,t):i.style.setProperty(n,r)}}(n,o,Lt(xi(),i),r,s))}function ha(e,t,i,n,r,s){const o=null===t;let a=void 0;for(;r>0;){const t=e[r],s=Array.isArray(t),l=s?t[1]:t,c=null===l;let h=i[r+1];h===ur&&(h=c?$o:void 0);let u=c?lt(h,n):l===n?h:void 0;if(s&&!ua(u)&&(u=lt(t,n)),ua(u)&&(a=u,o))return a;const d=e[r+1];r=o?vr(d):br(d)}if(null!==t){let e=s?t.residualClasses:t.residualStyles;null!=e&&(a=lt(e,n))}return a}function ua(e){return void 0!==e}function da(e,t){return 0!=(e.flags&(t?16:32))}function pa(e,t=""){const i=Kt(),n=Yt(),r=e+20,s=n.firstCreatePass?Pr(n,i[6],e,3,null,null):n.data[r],o=i[r]=function(e,t){return Nt(t)?t.createText(e):t.createTextNode(e)}(t,i[11]);Ps(n,i,o,s),ei(s,!1)}function ma(e){return fa("",e,""),ma}function fa(e,t,i){const n=Kt(),r=bo(n,e,t,i);return r!==ur&&function(e,t,i){const n=Lt(t,e),r=e[11];Nt(r)?r.setValue(n,i):n.textContent=i}(n,xi(),r),fa}function ga(e,t,i){const n=Kt();return vo(n,oi(),t)&&Fr(Yt(),wi(),n,e,t,n[11],i,!0),ga}function _a(e,t,i){const n=Kt();if(vo(n,oi(),t)){const r=Yt(),s=wi();Fr(r,s,n,e,t,cs(hi(r.data),s,n),i,!0)}return _a}function ya(e,t){const i=Ut(e)[1],n=i.data.length-1;Si(i,{directiveStart:n,directiveEnd:n+1})}function va(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,i=!0;const n=[e];for(;t;){let r=void 0;if(It(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(i){n.push(r);const t=e;t.inputs=xa(e.inputs),t.declaredInputs=xa(e.declaredInputs),t.outputs=xa(e.outputs);const i=r.hostBindings;i&&Ca(e,i);const s=r.viewQuery,o=r.contentQueries;if(s&&ba(e,s),o&&wa(e,o),ue(e.inputs,r.inputs),ue(e.declaredInputs,r.declaredInputs),ue(e.outputs,r.outputs),It(r)&&r.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(r.data.animation)}t.afterContentChecked=t.afterContentChecked||r.afterContentChecked,t.afterContentInit=e.afterContentInit||r.afterContentInit,t.afterViewChecked=e.afterViewChecked||r.afterViewChecked,t.afterViewInit=e.afterViewInit||r.afterViewInit,t.doCheck=e.doCheck||r.doCheck,t.onDestroy=e.onDestroy||r.onDestroy,t.onInit=e.onInit||r.onInit}const t=r.features;if(t)for(let n=0;n<t.length;n++){const r=t[n];r&&r.ngInherit&&r(e),r===va&&(i=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,i=null;for(let n=e.length-1;n>=0;n--){const r=e[n];r.hostVars=t+=r.hostVars,r.hostAttrs=Ni(r.hostAttrs,i=Ni(i,r.hostAttrs))}}(n)}function xa(e){return e===dt?{}:e===pt?[]:e}function ba(e,t){const i=e.viewQuery;e.viewQuery=i?(e,n)=>{t(e,n),i(e,n)}:t}function wa(e,t){const i=e.contentQueries;e.contentQueries=i?(e,n,r)=>{t(e,n,r),i(e,n,r)}:t}function Ca(e,t){const i=e.hostBindings;e.hostBindings=i?(e,n)=>{t(e,n),i(e,n)}:t}class Sa{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ea(e){e.type.prototype.ngOnChanges&&(e.setInput=Ta,e.onChanges=function(){const e=Pa(this),t=e&&e.current;if(t){const i=e.previous;if(i===dt)e.previous=t;else for(let e in t)i[e]=t[e];e.current=null,this.ngOnChanges(t)}})}function Ta(e,t,i,n){const r=Pa(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:dt,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[i],l=o[a];s[a]=new Sa(l&&l.currentValue,t,o===dt),e[n]=t}function Pa(e){return e.__ngSimpleChanges__||null}function Ma(e,t,i,n,r){if(e=Te(e),Array.isArray(e))for(let s=0;s<e.length;s++)Ma(e[s],t,i,n,r);else{const s=Yt(),o=Kt();let a=no(e)?e:Te(e.provide),l=eo(e);const c=Qt(),h=65535&c.providerIndexes,u=c.directiveStart,d=c.providerIndexes>>16;if(no(e)||!e.multi){const n=new Ai(l,r,So),p=Ia(a,t,r?h:h+d,u);-1===p?(Ji($i(c,o),s,a),ka(s,e,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=65536),i.push(n),o.push(n)):(i[p]=n,o[p]=n)}else{const p=Ia(a,t,h+d,u),m=Ia(a,t,h,h+d),f=p>=0&&i[p],g=m>=0&&i[m];if(r&&!g||!r&&!f){Ji($i(c,o),s,a);const h=function(e,t,i,n,r){const s=new Ai(e,i,So);return s.multi=[],s.index=t,s.componentProviders=0,Aa(s,r,n&&!i),s}(r?Oa:Ra,i.length,r,n,l);!r&&g&&(i[m].providerFactory=h),ka(s,e,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=65536),i.push(h),o.push(h)}else ka(s,e,p>-1?p:m,Aa(i[r?m:p],l,!r&&n));!r&&n&&g&&i[m].componentProviders++}}}function ka(e,t,i,n){const r=no(t);if(r||t.useClass){const s=(t.useClass||t).prototype.ngOnDestroy;if(s){const o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const e=o.indexOf(i);-1===e?o.push(i,[n,s]):o[e+1].push(n,s)}else o.push(i,s)}}}function Aa(e,t,i){return i&&e.componentProviders++,e.multi.push(t)-1}function Ia(e,t,i,n){for(let r=i;r<n;r++)if(t[r]===e)return r;return-1}function Ra(e,t,i,n){return Na(this.multi,[])}function Oa(e,t,i,n){const r=this.multi;let s;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=rn(i,i[1],this.providerFactory.index,n);s=t.slice(0,e),Na(r,s);for(let i=e;i<t.length;i++)s.push(t[i])}else s=[],Na(r,s);return s}function Na(e,t){for(let i=0;i<e.length;i++)t.push((0,e[i])());return t}function Da(e,t=[]){return i=>{i.providersResolver=(i,n)=>function(e,t,i){const n=Yt();if(n.firstCreatePass){const r=It(e);Ma(i,n.data,n.blueprint,r,!0),Ma(t,n.data,n.blueprint,r,!1)}}(i,n?n(e):e,t)}}Ea.ngInherit=!0;class za{}class La{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${we(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}let Ba=(()=>{class e{}return e.NULL=new La,e})(),Fa=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=()=>ja(e),e})();const ja=function(e){return Fs(e,Qt(),Kt())};class Va{}const Ua=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}();let qa=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Ha(),e})();const Ha=function(){const e=Kt(),t=Vt(Qt().index,e);return function(e){const t=e[11];if(Nt(t))return t;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Tt(t)?t:e)};let Ga=(()=>{class e{}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>null}),e})();class Wa{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Za=new Wa("9.1.13");class $a{constructor(){}supports(e){return go(e)}create(e){return new Ka(e)}}const Xa=(e,t)=>t;class Ka{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Xa}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,n=0,r=null;for(;t||i;){const s=!i||t&&t.currentIndex<el(i,n,r)?t:i,o=el(s,n,r),a=s.currentIndex;if(s===i)n--,i=i._nextRemoved;else if(t=t._next,null==s.previousIndex)n++;else{r||(r=[]);const e=o-n,t=a-n;if(e!=t){for(let i=0;i<e;i++){const n=i<r.length?r[i]:r[i]=0,s=n+i;t<=s&&s<e&&(r[i]=n+1)}r[s.previousIndex]=t-e}}o!==a&&e(s,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!go(e))throw new Error(`Error trying to diff '${we(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,i,n,r=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)i=e[t],n=this._trackByFn(t,i),null!==r&&mo(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,i,n,t)),mo(r.item,i)||this._addIdentityChange(r,i)):(r=this._mismatch(r,i,n,t),s=!0),r=r._next}else t=0,function(e,t){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(e[i]);else{const i=e[po()]();let n;for(;!(n=i.next()).done;)t(n.value)}}(e,e=>{n=this._trackByFn(t,e),null!==r&&mo(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,e,n,t)),mo(r.item,e)||this._addIdentityChange(r,e)):(r=this._mismatch(r,e,n,t),s=!0),r=r._next,t++}),this.length=t;return this._truncate(r),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,n){let r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(mo(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,n)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(mo(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,n)):e=this._addAfter(new Ya(t,i),r,n),e}_verifyReinsertion(e,t,i,n){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?e=this._reinsertAfter(r,e._prev,n):e.currentIndex!=n&&(e.currentIndex=n,this._addToMoves(e,n)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const n=e._prevRemoved,r=e._nextRemoved;return null===n?this._removalsHead=r:n._nextRemoved=r,null===r?this._removalsTail=n:r._prevRemoved=n,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const n=null===t?this._itHead:t._next;return e._next=n,e._prev=t,null===n?this._itTail=e:n._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Qa),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Qa),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Ya{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ja{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&mo(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class Qa{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Ja,this.map.set(t,i)),i.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function el(e,t,i){const n=e.previousIndex;if(null===n)return n;let r=0;return i&&n<i.length&&(r=i[n]),n+t+r}class tl{constructor(){}supports(e){return e instanceof Map||_o(e)}create(){return new il}}class il{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||_o(e)))throw new Error(`Error trying to diff '${we(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const n=this._getOrCreateRecordForKey(i,e);t=this._insertBeforeOrAppend(t,n)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const n=i._prev,r=i._next;return n&&(n._next=r),r&&(r._prev=n),i._next=null,i._prev=null,i}const i=new nl(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){mo(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class nl{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let rl=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(null!=i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>{if(!i)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,i)},deps:[[e,new le,new oe]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${i=e,i.name||typeof i}'`);var i}}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>new e([new $a])}),e})(),sl=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>{if(!i)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,i)},deps:[[e,new le,new oe]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>new e([new tl])}),e})();const ol=[new tl],al=new rl([new $a]),ll=new sl(ol);let cl=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>hl(e,Fa),e})();const hl=function(e,t){return js(e,t,Qt(),Kt())};let ul=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>dl(e,Fa),e})();const dl=function(e,t){return Vs(e,t,Qt(),Kt())},pl={};class ml extends Ba{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ct(e);return new _l(t,this.ngModule)}}function fl(e){const t=[];for(let i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}const gl=new je("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ui});class _l extends za{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(hr).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return fl(this.componentDef.inputs)}get outputs(){return fl(this.componentDef.outputs)}create(e,t,i,n){const r=(n=n||this.ngModule)?function(e,t){return{get:(i,n,r)=>{const s=e.get(i,pl,r);return s!==pl||n===pl?s:t.get(i,n,r)}}}(e,n.injector):e,s=r.get(Va,Dt),o=r.get(Ga,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=i?function(e,t,i){if(Nt(e))return e.selectRootElement(t,i===ut.ShadowDom);let n="string"==typeof t?e.querySelector(t):t;return n.textContent="",n}(a,i,this.componentDef.encapsulation):Er(l,s.createRenderer(null,this.componentDef),function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,u="string"==typeof i&&/^#root-ng-internal-isolated-\d+/.test(i),d={components:[],scheduler:Ui,clean:os,playerHandler:null,flags:0},p=zr(0,-1,null,1,0,null,null,null,null,null),m=Tr(null,p,d,h,null,null,s,a,o,r);let f,g;mi(m,null);try{const e=function(e,t,i,n,r,s){const o=i[1];i[20]=e;const a=Pr(o,null,0,3,null,null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(ho(a,l,!0),null!==e&&(Ii(r,e,l),null!==a.classes&&Os(r,e,a.classes),null!==a.styles&&Rs(r,e,a.styles)));const c=n.createRenderer(e,t),h=Tr(i,Dr(t),null,t.onPush?64:16,i[20],a,n,c,void 0);return o.firstCreatePass&&(Ji($i(a,i),o,t.type),Gr(o,a),Zr(a,i.length,1)),ts(i,h),i[20]=h}(c,this.componentDef,m,s,a);if(c)if(i)Ii(a,c,["ng-version",Za.full]);else{const{attrs:e,classes:t}=function(e){const t=[],i=[];let n=1,r=2;for(;n<e.length;){let s=e[n];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++n]):8===r&&i.push(s);else{if(!sr(r))break;r=s}n++}return{attrs:t,classes:i}}(this.componentDef.selectors[0]);e&&Ii(a,c,e),t&&t.length>0&&Os(a,c,t.join(" "))}if(g=Ft(p,0),void 0!==t){const e=g.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=t[i];e.push(null!=n?Array.from(n):null)}}f=function(e,t,i,n,r){const s=i[1],o=function(e,t,i){const n=Qt();e.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),Hr(e,n,1),$r(e,t,i));const r=rn(t,e,t.length-1,n);Yn(r,t);const s=Bt(n,t);return s&&Yn(s,t),r}(s,i,t);n.components.push(o),e[8]=o,r&&r.forEach(e=>e(o,t)),t.contentQueries&&t.contentQueries(1,o,i.length-1);const a=Qt();if(s.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){bi(a.index-20);const e=i[1];Vr(e,t),Ur(e,i,t.hostVars),qr(t,o)}return o}(e,this.componentDef,m,d,[ya]),Mr(p,m,null)}finally{vi()}const _=new yl(this.componentType,f,Fs(Fa,g,m),m,g);return i&&!u||(p.node.child=g),_}}class yl extends class{}{constructor(e,t,i,n,r){super(),this.location=i,this._rootLView=n,this._tNode=r,this.destroyCbs=[],this.instance=t,this.hostView=this.changeDetectorRef=new Ds(n),function(e,t,i,n){let r=e.node;null==r&&(e.node=r=Lr(0,null,2,-1,null,null)),n[6]=r}(n[1],0,0,n),this.componentType=e}get injector(){return new an(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(e=>e()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(e){this.destroyCbs&&this.destroyCbs.push(e)}}const vl=void 0;var xl=["en",[["a","p"],["AM","PM"],vl],[["AM","PM"],vl,vl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],vl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],vl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",vl,"{1} 'at' {0}",vl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let bl={};function wl(e){return e in bl||(bl[e]=Re.ng&&Re.ng.common&&Re.ng.common.locales&&Re.ng.common.locales[e]),bl[e]}const Cl=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,Directionality:19,PluralCase:20,ExtraData:21};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.Directionality]="Directionality",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();let Sl="en-US";function El(e){var t,i;i="Expected localeId to be defined",null==(t=e)&&function(e,t,i,n){throw new Error("ASSERTION ERROR: "+e+` [Expected=> null != ${t} <=Actual]`)}(i,t),"string"==typeof e&&(Sl=e.toLowerCase().replace(/_/g,"-"))}const Tl=new Map;class Pl extends tt{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ml(this);const i=Et(e),n=e[Le]||null;n&&El(n),this._bootstrapComponents=Hi(i.bootstrap),this._r3Injector=Ys(e,t,[{provide:tt,useValue:this},{provide:Ba,useValue:this.componentFactoryResolver}],we(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=so.THROW_IF_NOT_FOUND,i=ce.Default){return e===so||e===tt||e===Ve?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Ml extends it{constructor(e){super(),this.moduleType=e,null!==Et(e)&&function e(t){if(null!==t.\u0275mod.id){const e=t.\u0275mod.id;(function(e,t,i){if(t&&t!==i)throw new Error(`Duplicate module registered for ${e} - ${we(t)} vs ${we(t.name)}`)})(e,Tl.get(e),t),Tl.set(e,t)}let i=t.\u0275mod.imports;i instanceof Function&&(i=i()),i&&i.forEach(t=>e(t))}(e)}create(e){return new Pl(this.moduleType,e)}}function kl(e,t,i,n){return Rl(Kt(),si(),e,t,i,n)}function Al(e,t,i,n,r){return function(e,t,i,n,r,s,o){const a=t+i;return function(e,t,i,n){const r=vo(e,t,i);return vo(e,t+1,n)||r}(e,a,r,s)?yo(e,a+2,o?n.call(o,r,s):n(r,s)):Il(e,a+2)}(Kt(),si(),e,t,i,n,r)}function Il(e,t){const i=e[t];return i===ur?void 0:i}function Rl(e,t,i,n,r,s){const o=t+i;return vo(e,o,r)?yo(e,o+1,s?n.call(s,r):n(r)):Il(e,o+1)}class Ol extends T{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let n,r=e=>null,s=()=>null;e&&"object"==typeof e?(n=this.__isAsync?t=>{setTimeout(()=>e.next(t))}:t=>{e.next(t)},e.error&&(r=this.__isAsync?t=>{setTimeout(()=>e.error(t))}:t=>{e.error(t)}),e.complete&&(s=this.__isAsync?()=>{setTimeout(()=>e.complete())}:()=>{e.complete()})):(n=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)},t&&(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)}),i&&(s=this.__isAsync?()=>{setTimeout(()=>i())}:()=>{i()}));const o=super.subscribe(n,r,s);return e instanceof d&&e.add(o),o}}function Nl(){return this._results[po()]()}class Dl{constructor(){this.dirty=!0,this._results=[],this.changes=new Ol,this.length=0;const e=po(),t=Dl.prototype;t[e]||(t[e]=Nl)}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e){this._results=function e(t,i){void 0===i&&(i=t);for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?(i===t&&(i=t.slice(0,n)),e(r,i)):i!==t&&i.push(r)}return i}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class zl{constructor(e){this.queryList=e,this.matches=null}clone(){return new zl(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ll{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,n=[];for(let e=0;e<i;e++){const i=t.getByIndex(e);n.push(this.queries[i.indexInDeclarationView].clone())}return new Ll(n)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==ec(e,t).matches&&this.queries[t].setDirty()}}class Bl{constructor(e,t,i,n=null){this.predicate=e,this.descendants=t,this.isStatic=i,this.read=n}}class Fl{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const n=null!==t?t.length:0,r=this.getByIndex(i).embeddedTView(e,n);r&&(r.indexInDeclarationView=i,null!==t?t.push(r):t=[r])}return null!==t?new Fl(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class jl{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new jl(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&!1===this.metadata.descendants){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&4===i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){if(Array.isArray(this.metadata.predicate)){const i=this.metadata.predicate;for(let n=0;n<i.length;n++)this.matchTNodeWithReadOption(e,t,Vl(t,i[n]))}else{const i=this.metadata.predicate;i===cl?0===t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,nn(t,e,i,!1,!1))}}matchTNodeWithReadOption(e,t,i){if(null!==i){const n=this.metadata.read;if(null!==n)if(n===Fa||n===ul||n===cl&&0===t.type)this.addMatch(t.index,-2);else{const i=nn(t,e,n,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Vl(e,t){const i=e.localNames;if(null!==i)for(let n=0;n<i.length;n+=2)if(i[n]===t)return i[n+1];return null}function Ul(e,t,i,n){return-1===i?function(e,t){return 3===e.type||4===e.type?Fs(Fa,e,t):0===e.type?js(cl,Fa,e,t):null}(t,e):-2===i?function(e,t,i){return i===Fa?Fs(Fa,t,e):i===cl?js(cl,Fa,t,e):i===ul?Vs(ul,Fa,t,e):void 0}(e,t,n):rn(e,e[1],i,t)}function ql(e,t,i,n){const r=t[19].queries[n];if(null===r.matches){const n=e.data,s=i.matches,o=[];for(let e=0;e<s.length;e+=2){const r=s[e];o.push(r<0?null:Ul(t,n[r],s[e+1],i.metadata.read))}r.matches=o}return r.matches}function Hl(e){const t=Kt(),i=Yt(),n=ui();di(n+1);const r=ec(i,n);if(e.dirty&&qt(t)===r.metadata.isStatic){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?function e(t,i,n,r){const s=t.queries.getByIndex(n),o=s.matches;if(null!==o){const a=ql(t,i,s,n);for(let t=0;t<o.length;t+=2){const n=o[t];if(n>0)r.push(a[t/2]);else{const s=o[t+1],a=i[-n];for(let t=10;t<a.length;t++){const i=a[t];i[17]===i[3]&&e(i[1],i,s,r)}if(null!==a[9]){const t=a[9];for(let i=0;i<t.length;i++){const n=t[i];e(n[1],n,s,r)}}}}}return r}(i,t,n,[]):ql(i,t,r,n);e.reset(s),e.notifyOnChanges()}return!0}return!1}function Gl(e,t,i){Zl(Yt(),Kt(),e,t,i,!0)}function Wl(e,t,i){Zl(Yt(),Kt(),e,t,i,!1)}function Zl(e,t,i,n,r,s){e.firstCreatePass&&(Ql(e,new Bl(i,n,s,r),-1),s&&(e.staticViewQueries=!0)),Jl(e,t)}function $l(e,t,i,n){Kl(Yt(),Kt(),t,i,n,!1,Qt(),e)}function Xl(e,t,i,n){Kl(Yt(),Kt(),t,i,n,!0,Qt(),e)}function Kl(e,t,i,n,r,s,o,a){e.firstCreatePass&&(Ql(e,new Bl(i,n,s,r),o.index),function(e,t){const i=e.contentQueries||(e.contentQueries=[]);t!==(e.contentQueries.length?i[i.length-1]:-1)&&i.push(e.queries.length-1,t)}(e,a),s&&(e.staticContentQueries=!0)),Jl(e,t)}function Yl(){return e=Kt(),t=ui(),e[19].queries[t].queryList;var e,t}function Jl(e,t){const i=new Dl;!function(e,t,i,n){const r=as(t);r.push(i),e.firstCreatePass&&ls(e).push(n,r.length-1)}(e,t,i,i.destroy),null===t[19]&&(t[19]=new Ll),t[19].queries.push(new zl(i))}function Ql(e,t,i){null===e.queries&&(e.queries=new Fl),e.queries.track(new jl(t,i))}function ec(e,t){return e.queries.getByIndex(t)}const tc=new je("Application Initializer");let ic=(()=>{class e{constructor(e){this.appInits=e,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const t=this.appInits[i]();Do(t)&&e.push(t)}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Ke(tc,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const nc=new je("AppId"),rc={provide:nc,useFactory:function(){return`${sc()}${sc()}${sc()}`},deps:[]};function sc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const oc=new je("Platform Initializer"),ac=new je("Platform ID"),lc=new je("appBootstrapListener");let cc=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const hc=new je("LocaleId"),uc=new je("DefaultCurrencyCode");class dc{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const pc=function(e){return new Ml(e)},mc=pc,fc=function(e){return Promise.resolve(pc(e))},gc=function(e){const t=pc(e),i=Hi(Et(e).declarations).reduce((e,t)=>{const i=Ct(t);return i&&e.push(new _l(i)),e},[]);return new dc(t,i)},_c=gc,yc=function(e){return Promise.resolve(gc(e))};let vc=(()=>{class e{constructor(){this.compileModuleSync=mc,this.compileModuleAsync=fc,this.compileModuleAndAllComponentsSync=_c,this.compileModuleAndAllComponentsAsync=yc}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const xc=new je("compilerOptions"),bc=(()=>Promise.resolve(0))();function wc(e){"undefined"==typeof Zone?bc.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Cc{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ol(!1),this.onMicrotaskEmpty=new Ol(!1),this.onStable=new Ol(!1),this.onError=new Ol(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=t,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let e=Re.requestAnimationFrame,t=Re.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=!!e.shouldCoalesceEventChangeDetection&&e.nativeRequestAnimationFrame&&(()=>{!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Re,()=>{e.lastRequestAnimationFrameId=-1,Pc(e),Tc(e)}),Pc(e))}(e)});e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:t},onInvokeTask:(i,n,r,s,o,a)=>{try{return Mc(e),i.invokeTask(r,s,o,a)}finally{t&&"eventTask"===s.type&&t(),kc(e)}},onInvoke:(t,i,n,r,s,o,a)=>{try{return Mc(e),t.invoke(n,r,s,o,a)}finally{kc(e)}},onHasTask:(t,i,n,r)=>{t.hasTask(n,r),i===n&&("microTask"==r.change?(e._hasPendingMicrotasks=r.microTask,Pc(e),Tc(e)):"macroTask"==r.change&&(e.hasPendingMacrotasks=r.macroTask))},onHandleError:(t,i,n,r)=>(t.handleError(n,r),e.runOutsideAngular(()=>e.onError.emit(r)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Cc.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Cc.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,n){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+n,e,Ec,Sc,Sc);try{return r.runTask(s,t,i)}finally{r.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}function Sc(){}const Ec={};function Tc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Pc(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function Mc(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function kc(e){e._nesting--,Tc(e)}class Ac{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ol,this.onMicrotaskEmpty=new Ol,this.onStable=new Ol,this.onError=new Ol}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,n){return e.apply(t,i)}}let Ic=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Cc.assertNotInAngularZone(),wc(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())wc(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,i){let n=-1;t&&t>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==n),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:n,updateCb:i})}whenStable(e,t,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,i){return[]}}return e.\u0275fac=function(t){return new(t||e)(Ke(Cc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Rc=(()=>{class e{constructor(){this._applications=new Map,Dc.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Dc.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Oc{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let Nc,Dc=new Oc,zc=function(e,t,i){const n=e.get(xc,[]).concat(t),r=new Ml(i);if(0===ao.size)return Promise.resolve(r);const s=function(e){const t=[];return e.forEach(e=>e&&t.push(...e)),t}(n.map(e=>e.providers));if(0===s.length)return Promise.resolve(r);const o=function(){const e=Re.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),a=so.create({providers:s}).get(o.ResourceLoader);return function(e){const t=[],i=new Map;function n(e){let t=i.get(e);if(!t){const n=(e=>Promise.resolve(a.get(e)))(e);i.set(e,t=n.then(co))}return t}return ao.forEach((e,i)=>{const r=[];e.templateUrl&&r.push(n(e.templateUrl).then(t=>{e.template=t}));const s=e.styleUrls,o=e.styles||(e.styles=[]),a=e.styles.length;s&&s.forEach((t,i)=>{o.push(""),r.push(n(t).then(n=>{o[a+i]=n,s.splice(s.indexOf(t),1),0==s.length&&(e.styleUrls=void 0)}))});const l=Promise.all(r).then(()=>function(e){lo.delete(e)}(i));t.push(l)}),ao=new Map,Promise.all(t).then(()=>{})}().then(()=>r)};const Lc=new je("AllowMultipleToken");class Bc{constructor(e,t){this.name=e,this.token=t}}function Fc(e,t,i=[]){const n="Platform: "+t,r=new je(n);return(t=[])=>{let s=jc();if(!s||s.injector.get(Lc,!1))if(e)e(i.concat(t).concat({provide:r,useValue:!0}));else{const e=i.concat(t).concat({provide:r,useValue:!0},{provide:Gs,useValue:"platform"});!function(e){if(Nc&&!Nc.destroyed&&!Nc.injector.get(Lc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Nc=e.get(Vc);const t=e.get(oc,null);t&&t.forEach(e=>e())}(so.create({providers:e,name:n}))}return function(e){const t=jc();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function jc(){return Nc&&!Nc.destroyed?Nc:null}let Vc=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const i=function(e,t){let i;return i="noop"===e?new Ac:("zone.js"===e?void 0:e)||new Cc({enableLongStackTrace:En(),shouldCoalesceEventChangeDetection:t}),i}(t?t.ngZone:void 0,t&&t.ngZoneEventCoalescing||!1),n=[{provide:Cc,useValue:i}];return i.run(()=>{const t=so.create({providers:n,parent:this.injector,name:e.moduleType.name}),r=e.create(t),s=r.injector.get(pn,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.onDestroy(()=>Hc(this._modules,r)),i.runOutsideAngular(()=>i.onError.subscribe({next:e=>{s.handleError(e)}})),function(e,t,i){try{const n=i();return Do(n)?n.catch(i=>{throw t.runOutsideAngular(()=>e.handleError(i)),i}):n}catch(n){throw t.runOutsideAngular(()=>e.handleError(n)),n}}(s,i,()=>{const e=r.injector.get(ic);return e.runInitializers(),e.donePromise.then(()=>(El(r.injector.get(hc,"en-US")||"en-US"),this._moduleDoBootstrap(r),r))})})}bootstrapModule(e,t=[]){const i=Uc({},t);return zc(this.injector,i,e).then(e=>this.bootstrapModuleFactory(e,i))}_moduleDoBootstrap(e){const t=e.injector.get(qc);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${we(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Ke(so))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Uc(e,t){return Array.isArray(t)?t.reduce(Uc,e):Object.assign(Object.assign({},e),t)}let qc=(()=>{class e{constructor(e,t,i,n,r,s){this._zone=e,this._console=t,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=En(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new b(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),a=new b(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{Cc.assertNotInAngularZone(),wc(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{Cc.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),i.unsubscribe()}});this.isStable=$(o,a.pipe(ie()))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=e instanceof za?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(tt),r=i.create(so.NULL,[],t||i.selector,n);r.onDestroy(()=>{this._unloadComponent(r)});const s=r.injector.get(Ic,null);return s&&r.injector.get(Rc).registerApplication(r.location.nativeElement,s),this._loadComponent(r),En()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges();if(this._enforceNoNewChanges)for(let e of this._views)e.checkNoChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Hc(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(lc,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}_unloadComponent(e){this.detachView(e.hostView),Hc(this.components,e)}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy())}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Ke(Cc),Ke(cc),Ke(so),Ke(pn),Ke(Ba),Ke(ic))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Hc(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class Gc{}class Wc{}const Zc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let $c=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||Zc}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,n]=e.split("#");return void 0===n&&(n="default"),i("zn8P")(t).then(e=>e[n]).then(e=>Xc(e,t,n)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,n]=e.split("#"),r="NgFactory";return void 0===n&&(n="default",r=""),i("zn8P")(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[n+r]).then(e=>Xc(e,t,n))}}return e.\u0275fac=function(t){return new(t||e)(Ke(vc),Ke(Wc,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Xc(e,t,i){if(!e)throw new Error(`Cannot find '${i}' in '${t}'`);return e}const Kc=Fc(null,"core",[{provide:ac,useValue:"unknown"},{provide:Vc,deps:[so]},{provide:Rc,deps:[]},{provide:cc,deps:[]}]),Yc=[{provide:qc,useClass:qc,deps:[Cc,cc,so,pn,Ba,ic]},{provide:gl,deps:[Cc],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:ic,useClass:ic,deps:[[new oe,tc]]},{provide:vc,useClass:vc,deps:[]},rc,{provide:rl,useFactory:function(){return al},deps:[]},{provide:sl,useFactory:function(){return ll},deps:[]},{provide:hc,useFactory:function(e){return El(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new se(hc),new oe,new le]]},{provide:uc,useValue:"USD"}];let Jc=(()=>{class e{constructor(e){}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)(Ke(qc))},providers:Yc}),e})(),Qc=null;function eh(){return Qc}const th=new je("DocumentToken");let ih=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:nh,token:e,providedIn:"platform"}),e})();function nh(){return Ke(sh)}const rh=new je("Location Initialized");let sh=(()=>{class e extends ih{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=eh().getLocation(),this._history=eh().getHistory()}getBaseHrefFromDOM(){return eh().getBaseHref(this._doc)}onPopState(e){eh().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}onHashChange(e){eh().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,i){oh()?this._history.pushState(e,t,i):this.location.hash=i}replaceState(e,t,i){oh()?this._history.replaceState(e,t,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({factory:ah,token:e,providedIn:"platform"}),e})();function oh(){return!!window.history.pushState}function ah(){return new sh(Ke(th))}function lh(e,t){if(0==e.length)return t;if(0==t.length)return e;let i=0;return e.endsWith("/")&&i++,t.startsWith("/")&&i++,2==i?e+t.substring(1):1==i?e+t:e+"/"+t}function ch(e){const t=e.match(/#|\?|$/),i=t&&t.index||e.length;return e.slice(0,i-("/"===e[i-1]?1:0))+e.slice(i)}function hh(e){return e&&"?"!==e[0]?"?"+e:e}let uh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:dh,token:e,providedIn:"root"}),e})();function dh(e){const t=Ke(th).location;return new mh(Ke(ih),t&&t.origin||"")}const ph=new je("appBaseHref");let mh=(()=>{class e extends uh{constructor(e,t){if(super(),this._platformLocation=e,null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return lh(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+hh(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${t}${i}`:t}pushState(e,t,i,n){const r=this.prepareExternalUrl(i+hh(n));this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,n){const r=this.prepareExternalUrl(i+hh(n));this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(Ke(ih),Ke(ph,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),fh=(()=>{class e extends uh{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",null!=t&&(this._baseHref=t)}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=lh(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,i,n){let r=this.prepareExternalUrl(i+hh(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,n){let r=this.prepareExternalUrl(i+hh(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(Ke(ih),Ke(ph,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),gh=(()=>{class e{constructor(e,t){this._subject=new Ol,this._urlChangeListeners=[],this._platformStrategy=e;const i=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=ch(yh(i)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+hh(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,yh(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",i=null){this._platformStrategy.pushState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hh(t)),i)}replaceState(e,t="",i=null){this._platformStrategy.replaceState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hh(t)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(e){this._urlChangeListeners.push(e),this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)})}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(i=>i(e,t))}subscribe(e,t,i){return this._subject.subscribe({next:e,error:t,complete:i})}}return e.\u0275fac=function(t){return new(t||e)(Ke(uh),Ke(ih))},e.normalizeQueryParams=hh,e.joinWithSlash=lh,e.stripTrailingSlash=ch,e.\u0275prov=de({factory:_h,token:e,providedIn:"root"}),e})();function _h(){return new gh(Ke(uh),Ke(ih))}function yh(e){return e.replace(/\/index.html$/,"")}const vh=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}();class xh{}let bh=(()=>{class e extends xh{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(function(e){return function(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let i=wl(t);if(i)return i;const n=t.split("-")[0];if(i=wl(n),i)return i;if("en"===n)return xl;throw new Error(`Missing locale data for the locale "${e}".`)}(e)[Cl.PluralCase]}(t||this.locale)(e)){case vh.Zero:return"zero";case vh.One:return"one";case vh.Two:return"two";case vh.Few:return"few";case vh.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(Ke(hc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function wh(e,t){t=encodeURIComponent(t);for(const i of e.split(";")){const e=i.indexOf("="),[n,r]=-1==e?[i,""]:[i.slice(0,e),i.slice(e+1)];if(n.trim()===t)return decodeURIComponent(r)}return null}let Ch=(()=>{class e{constructor(e,t,i,n){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=i,this._renderer=n,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(go(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+we(e.item));this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(So(rl),So(sl),So(Fa),So(qa))},e.\u0275dir=bt({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Sh{constructor(e,t,i,n){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=n}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Eh=(()=>{class e{constructor(e,t,i){this._viewContainer=e,this._template=t,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){En()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(e)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;if(!this._differ&&i)try{this._differ=this._differs.find(i).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${i}' of type '${e=i,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,i,n)=>{if(null==e.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new Sh(null,this._ngForOf,-1,-1),null===n?void 0:n),r=new Th(e,i);t.push(r)}else if(null==n)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const r=this._viewContainer.get(i);this._viewContainer.move(r,n);const s=new Th(e,r);t.push(s)}});for(let i=0;i<t.length;i++)this._perViewChange(t[i].view,t[i].record);for(let i=0,n=this._viewContainer.length;i<n;i++){const e=this._viewContainer.get(i);e.context.index=i,e.context.count=n,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(So(ul),So(cl),So(rl))},e.\u0275dir=bt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class Th{constructor(e,t){this.record=e,this.view=t}}let Ph=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new Mh,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){kh("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){kh("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(So(ul),So(cl))},e.\u0275dir=bt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class Mh{constructor(){this.$implicit=null,this.ngIf=null}}function kh(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${we(t)}'.`)}class Ah{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Ih=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e})(),Rh=(()=>{class e{constructor(e,t,i){this.ngSwitch=i,i._addCase(),this._view=new Ah(e,t)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(t){return new(t||e)(So(ul),So(cl),So(Ih,1))},e.\u0275dir=bt({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e})(),Oh=(()=>{class e{constructor(e,t,i){i._addDefault(new Ah(e,t))}}return e.\u0275fac=function(t){return new(t||e)(So(ul),So(cl),So(Ih,1))},e.\u0275dir=bt({type:e,selectors:[["","ngSwitchDefault",""]]}),e})();class Nh{createSubscription(e,t){return e.subscribe({next:t,error:e=>{throw e}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class Dh{createSubscription(e,t){return e.then(t,e=>{throw e})}dispose(e){}onDestroy(e){}}const zh=new Dh,Lh=new Nh;let Bh=(()=>{class e{constructor(e){this._ref=e,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):mo(this._latestValue,this._latestReturnedValue)?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,fo.wrap(this._latestValue)):(e&&this._subscribe(e),this._latestReturnedValue=this._latestValue,this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,t=>this._updateLatestValue(e,t))}_selectStrategy(t){if(Do(t))return zh;if(zo(t))return Lh;throw Error(`InvalidPipeArgument: '${t}' for pipe '${we(e)}'`)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())}}return e.\u0275fac=function(t){return new(t||e)(function(e=ce.Default){const t=Us(!0);if(null!=t||e&ce.Optional)return t;throw new Error("No provider for ChangeDetectorRef!")}())},e.\u0275pipe=wt({name:"async",type:e,pure:!1}),e})(),Fh=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[{provide:xh,useClass:bh}]}),e})(),jh=(()=>{class e{}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>new Vh(Ke(th),window,Ke(pn))}),e})();class Vh{constructor(e,t,i){this.document=e,this.window=t,this.errorHandler=i,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const t=this.document.querySelector("#"+e);if(t)return void this.scrollToElement(t);const i=this.document.querySelector(`[name='${e}']`);if(i)return void this.scrollToElement(i)}catch(t){this.errorHandler.handleError(t)}}}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,n=t.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],n-r[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}class Uh extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var e;e=new Uh,Qc||(Qc=e)}getProperty(e,t){return e[t]}log(e){window.console&&window.console.log&&window.console.log(e)}logGroup(e){window.console&&window.console.group&&window.console.group(e)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){return e.parentNode&&e.parentNode.removeChild(e),e}getValue(e){return e.value}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(e){const t=Hh||(Hh=document.querySelector("base"),Hh)?Hh.getAttribute("href"):null;return null==t?null:(i=t,qh||(qh=document.createElement("a")),qh.setAttribute("href",i),"/"===qh.pathname.charAt(0)?qh.pathname:"/"+qh.pathname);var i}resetBaseElement(){Hh=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(e){return wh(document.cookie,e)}}let qh,Hh=null;const Gh=new je("TRANSITION_ID"),Wh=[{provide:tc,useFactory:function(e,t,i){return()=>{i.get(ic).donePromise.then(()=>{const i=eh();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>i.remove(e))})}},deps:[Gh,th,so],multi:!0}];class Zh{static init(){var e;e=new Zh,Dc=e}addToWindow(e){Re.getAngularTestability=(t,i=!0)=>{const n=e.findTestabilityInTree(t,i);if(null==n)throw new Error("Could not find testability for element.");return n},Re.getAllAngularTestabilities=()=>e.getAllTestabilities(),Re.getAllAngularRootElements=()=>e.getAllRootElements(),Re.frameworkStabilizers||(Re.frameworkStabilizers=[]),Re.frameworkStabilizers.push(e=>{const t=Re.getAllAngularTestabilities();let i=t.length,n=!1;const r=function(t){n=n||t,i--,0==i&&e(n)};t.forEach((function(e){e.whenStable(r)}))})}findTestabilityInTree(e,t,i){if(null==t)return null;const n=e.getTestability(t);return null!=n?n:i?eh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}const $h=new je("EventManagerPlugins");let Xh=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,i){return this._findPluginFor(t).addEventListener(e,t,i)}addGlobalEventListener(e,t,i){return this._findPluginFor(t).addGlobalEventListener(e,t,i)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const i=this._plugins;for(let n=0;n<i.length;n++){const t=i[n];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error("No event manager plugin found for event "+e)}}return e.\u0275fac=function(t){return new(t||e)(Ke($h),Ke(Cc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Kh{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const n=eh().getGlobalEventTarget(this._doc,e);if(!n)throw new Error(`Unsupported event target ${n} for event ${t}`);return this.addEventListener(n,t,i)}}let Yh=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Jh=(()=>{class e extends Yh{constructor(e){super(),this._doc=e,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(e.head)}_addStylesToHost(e,t){e.forEach(e=>{const i=this._doc.createElement("style");i.textContent=e,this._styleNodes.add(t.appendChild(i))})}addHost(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}removeHost(e){this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach(t=>this._addStylesToHost(e,t))}ngOnDestroy(){this._styleNodes.forEach(e=>eh().remove(e))}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Qh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},eu=/%COMP%/g;function tu(e,t,i){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?tu(e,r,i):(r=r.replace(eu,e),i.push(r))}return i}function iu(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let nu=(()=>{class e{constructor(e,t,i){this.eventManager=e,this.sharedStylesHost=t,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new ru(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case ut.Emulated:{let i=this.rendererByCompId.get(t.id);return i||(i=new su(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,i)),i.applyToHost(e),i}case ut.Native:case ut.ShadowDom:return new ou(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=tu(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(Ke(Xh),Ke(Jh),Ke(nc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class ru{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Qh[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,n){if(n){t=n+":"+t;const r=Qh[n];r?e.setAttributeNS(r,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const n=Qh[i];n?e.removeAttributeNS(n,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,n){n&Ua.DashCase?e.style.setProperty(t,i,n&Ua.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ua.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,iu(i)):this.eventManager.addEventListener(e,t,iu(i))}}class su extends ru{constructor(e,t,i,n){super(e),this.component=i;const r=tu(n+"-"+i.id,i.styles,[]);t.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(eu,n+"-"+i.id),this.hostAttr=function(e){return"_nghost-%COMP%".replace(eu,e)}(n+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class ou extends ru{constructor(e,t,i,n){super(e),this.sharedStylesHost=t,this.hostEl=i,this.component=n,this.shadowRoot=n.encapsulation===ut.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const r=tu(n.id,n.styles,[]);for(let s=0;s<r.length;s++){const e=document.createElement("style");e.textContent=r[s],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let au=(()=>{class e extends Kh{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,i){return e.addEventListener(t,i,!1),()=>this.removeEventListener(e,t,i)}removeEventListener(e,t,i){return e.removeEventListener(t,i)}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const lu=["alt","control","meta","shift"],cu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hu={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},uu={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let du=(()=>{class e extends Kh{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,n){const r=e.parseEventName(i),s=e.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>eh().onAndCancel(t,r.domEventName,s))}static parseEventName(t){const i=t.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const r=e._normalizeKey(i.pop());let s="";if(lu.forEach(e=>{const t=i.indexOf(e);t>-1&&(i.splice(t,1),s+=e+".")}),s+=r,0!=i.length||0===r.length)return null;const o={};return o.domEventName=n,o.fullKey=s,o}static getEventFullKey(e){let t="",i=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&hu.hasOwnProperty(t)&&(t=hu[t]))}return cu[t]||t}(e);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),lu.forEach(n=>{n!=i&&(0,uu[n])(e)&&(t+=n+".")}),t+=i,t}static eventCallback(t,i,n){return r=>{e.getEventFullKey(r)===t&&n.runGuarded(()=>i(r))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),pu=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return Ke(mu)},token:e,providedIn:"root"}),e})(),mu=(()=>{class e extends pu{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case Zn.NONE:return t;case Zn.HTML:return bn(t,"HTML")?xn(t):function(e,t){let i=null;try{Gn=Gn||new Tn(e);let n=t?String(t):"";i=Gn.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=i.innerHTML,i=Gn.getInertBodyElement(n)}while(n!==s);const o=new Vn,a=o.sanitizeChildren(Wn(i)||i);return En()&&o.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),a}finally{if(i){const e=Wn(i)||i;for(;e.firstChild;)e.removeChild(e.firstChild)}}}(this._doc,String(t));case Zn.STYLE:return bn(t,"Style")?xn(t):function(e){if(!(e=String(e).trim()))return"";const t=e.match(Xn);return t&&kn(t[1])===t[1]||e.match($n)&&function(e){let t=!0,i=!0;for(let n=0;n<e.length;n++){const r=e.charAt(n);"'"===r&&i?t=!t:'"'===r&&t&&(i=!i)}return t&&i}(e)?e:(En()&&console.warn(`WARNING: sanitizing unsafe style value ${e} (see http://g.co/ng/security#xss).`),"unsafe")}(t);case Zn.SCRIPT:if(bn(t,"Script"))return xn(t);throw new Error("unsafe value used in a script context");case Zn.URL:return wn(t),bn(t,"URL")?xn(t):kn(String(t));case Zn.RESOURCE_URL:if(bn(t,"ResourceURL"))return xn(t);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see http://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return new fn(e)}bypassSecurityTrustStyle(e){return new gn(e)}bypassSecurityTrustScript(e){return new _n(e)}bypassSecurityTrustUrl(e){return new yn(e)}bypassSecurityTrustResourceUrl(e){return new vn(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({factory:function(){return e=Ke(Ve),new mu(e.get(th));var e},token:e,providedIn:"root"}),e})();const fu=Fc(Kc,"browser",[{provide:ac,useValue:"browser"},{provide:oc,useValue:function(){Uh.makeCurrent(),Zh.init()},multi:!0},{provide:th,useFactory:function(){return function(e){Ot=e}(document),document},deps:[]}]),gu=[[],{provide:Gs,useValue:"root"},{provide:pn,useFactory:function(){return new pn},deps:[]},{provide:$h,useClass:au,multi:!0,deps:[th,Cc,ac]},{provide:$h,useClass:du,multi:!0,deps:[th]},[],{provide:nu,useClass:nu,deps:[Xh,Jh,nc]},{provide:Va,useExisting:nu},{provide:Yh,useExisting:Jh},{provide:Jh,useClass:Jh,deps:[th]},{provide:Ic,useClass:Ic,deps:[Cc]},{provide:Xh,useClass:Xh,deps:[$h,Cc]},[]];let _u=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:nc,useValue:t.appId},{provide:Gh,useExisting:nc},Wh]}}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)(Ke(e,12))},providers:gu,imports:[Fh,Jc]}),e})();"undefined"!=typeof window&&window;class yu{}function vu(e,t){return{type:7,name:e,definitions:t,options:{}}}function xu(e,t=null){return{type:4,styles:t,timings:e}}function bu(e,t=null){return{type:3,steps:e,options:t}}function wu(e,t=null){return{type:2,steps:e,options:t}}function Cu(e){return{type:6,styles:e,offset:null}}function Su(e,t,i){return{type:0,name:e,styles:t,options:i}}function Eu(e){return{type:5,steps:e}}function Tu(e,t,i=null){return{type:1,expr:e,animation:t,options:i}}function Pu(e=null){return{type:9,options:e}}function Mu(e,t,i=null){return{type:11,selector:e,animation:t,options:i}}function ku(e){Promise.resolve(null).then(e)}class Au{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){ku(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){}setPosition(e){}getPosition(){return 0}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class Iu{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,n=0;const r=this.players.length;0==r?ku(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==r&&this._onFinish()}),e.onDestroy(()=>{++i==r&&this._onDestroy()}),e.onStart(()=>{++n==r&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const i=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(i)})}getPosition(){let e=0;return this.players.forEach(t=>{const i=t.getPosition();e=Math.min(i,e)}),e}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function Ru(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Ou(e){switch(e.length){case 0:return new Au;case 1:return e[0];default:return new Iu(e)}}function Nu(e,t,i,n,r={},s={}){const o=[],a=[];let l=-1,c=null;if(n.forEach(e=>{const i=e.offset,n=i==l,h=n&&c||{};Object.keys(e).forEach(i=>{let n=i,a=e[i];if("offset"!==i)switch(n=t.normalizePropertyName(n,o),a){case"!":a=r[i];break;case"*":a=s[i];break;default:a=t.normalizeStyleValue(i,n,a,o)}h[n]=a}),n||a.push(h),c=h,l=i}),o.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${o.join(e)}`)}return a}function Du(e,t,i,n){switch(t){case"start":e.onStart(()=>n(i&&zu(i,"start",e)));break;case"done":e.onDone(()=>n(i&&zu(i,"done",e)));break;case"destroy":e.onDestroy(()=>n(i&&zu(i,"destroy",e)))}}function zu(e,t,i){const n=i.totalTime,r=Lu(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==n?e.totalTime:n,!!i.disabled),s=e._data;return null!=s&&(r._data=s),r}function Lu(e,t,i,n,r="",s=0,o){return{element:e,triggerName:t,fromState:i,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function Bu(e,t,i){let n;return e instanceof Map?(n=e.get(t),n||e.set(t,n=i)):(n=e[t],n||(n=e[t]=i)),n}function Fu(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let ju=(e,t)=>!1,Vu=(e,t)=>!1,Uu=(e,t,i)=>[];const qu=Ru();(qu||"undefined"!=typeof Element)&&(ju=(e,t)=>e.contains(t),Vu=(()=>{if(qu||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,i)=>t.apply(e,[i]):Vu}})(),Uu=(e,t,i)=>{let n=[];if(i)n.push(...e.querySelectorAll(t));else{const i=e.querySelector(t);i&&n.push(i)}return n});let Hu=null,Gu=!1;function Wu(e){Hu||(Hu=("undefined"!=typeof document?document.body:null)||{},Gu=!!Hu.style&&"WebkitAppearance"in Hu.style);let t=!0;return Hu.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in Hu.style,!t&&Gu)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in Hu.style),t}const Zu=Vu,$u=ju,Xu=Uu;function Ku(e){const t={};return Object.keys(e).forEach(i=>{const n=i.replace(/([a-z])([A-Z])/g,"$1-$2");t[n]=e[i]}),t}let Yu=(()=>{class e{validateStyleProperty(e){return Wu(e)}matchesElement(e,t){return Zu(e,t)}containsElement(e,t){return $u(e,t)}query(e,t,i){return Xu(e,t,i)}computeStyle(e,t,i){return i||""}animate(e,t,i,n,r,s=[],o){return new Au(i,n)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Ju=(()=>{class e{}return e.NOOP=new Yu,e})();function Qu(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:ed(parseFloat(t[1]),t[2])}function ed(e,t){switch(t){case"s":return 1e3*e;default:return e}}function td(e,t,i){return e.hasOwnProperty("duration")?e:function(e,t,i){let n,r=0,s="";if("string"==typeof e){const i=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===i)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};n=ed(parseFloat(i[1]),i[2]);const o=i[3];null!=o&&(r=ed(parseFloat(o),i[4]));const a=i[5];a&&(s=a)}else n=e;if(!i){let i=!1,s=t.length;n<0&&(t.push("Duration values below 0 are not allowed for this animation step."),i=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),i=!0),i&&t.splice(s,0,`The provided timing value "${e}" is invalid.`)}return{duration:n,delay:r,easing:s}}(e,t,i)}function id(e,t={}){return Object.keys(e).forEach(i=>{t[i]=e[i]}),t}function nd(e,t,i={}){if(t)for(let n in e)i[n]=e[n];else id(e,i);return i}function rd(e,t,i){return i?t+":"+i+";":""}function sd(e){let t="";for(let i=0;i<e.style.length;i++){const n=e.style.item(i);t+=rd(0,n,e.style.getPropertyValue(n))}for(const i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=rd(0,i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[i]));e.setAttribute("style",t)}function od(e,t,i){e.style&&(Object.keys(t).forEach(n=>{const r=md(n);i&&!i.hasOwnProperty(n)&&(i[n]=e.style[r]),e.style[r]=t[n]}),Ru()&&sd(e))}function ad(e,t){e.style&&(Object.keys(t).forEach(t=>{const i=md(t);e.style[i]=""}),Ru()&&sd(e))}function ld(e){return Array.isArray(e)?1==e.length?e[0]:wu(e):e}const cd=new RegExp("{{\\s*(.+?)\\s*}}","g");function hd(e){let t=[];if("string"==typeof e){let i;for(;i=cd.exec(e);)t.push(i[1]);cd.lastIndex=0}return t}function ud(e,t,i){const n=e.toString(),r=n.replace(cd,(e,n)=>{let r=t[n];return t.hasOwnProperty(n)||(i.push("Please provide a value for the animation param "+n),r=""),r.toString()});return r==n?e:r}function dd(e){const t=[];let i=e.next();for(;!i.done;)t.push(i.value),i=e.next();return t}const pd=/-+([a-z0-9])/g;function md(e){return e.replace(pd,(...e)=>e[1].toUpperCase())}function fd(e,t){return 0===e||0===t}function gd(e,t,i){const n=Object.keys(i);if(n.length&&t.length){let s=t[0],o=[];if(n.forEach(e=>{s.hasOwnProperty(e)||o.push(e),s[e]=i[e]}),o.length)for(var r=1;r<t.length;r++){let i=t[r];o.forEach((function(t){i[t]=yd(e,t)}))}}return t}function _d(e,t,i){switch(t.type){case 7:return e.visitTrigger(t,i);case 0:return e.visitState(t,i);case 1:return e.visitTransition(t,i);case 2:return e.visitSequence(t,i);case 3:return e.visitGroup(t,i);case 4:return e.visitAnimate(t,i);case 5:return e.visitKeyframes(t,i);case 6:return e.visitStyle(t,i);case 8:return e.visitReference(t,i);case 9:return e.visitAnimateChild(t,i);case 10:return e.visitAnimateRef(t,i);case 11:return e.visitQuery(t,i);case 12:return e.visitStagger(t,i);default:throw new Error("Unable to resolve animation metadata node #"+t.type)}}function yd(e,t){return window.getComputedStyle(e)[t]}function vd(e,t){const i=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,i){if(":"==e[0]){const n=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,i);if("function"==typeof n)return void t.push(n);e=n}const n=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return i.push(`The provided transition expression "${e}" is not supported`),t;const r=n[1],s=n[2],o=n[3];t.push(wd(r,o)),"<"!=s[0]||"*"==r&&"*"==o||t.push(wd(o,r))}(e,i,t)):i.push(e),i}const xd=new Set(["true","1"]),bd=new Set(["false","0"]);function wd(e,t){const i=xd.has(e)||bd.has(e),n=xd.has(t)||bd.has(t);return(r,s)=>{let o="*"==e||e==r,a="*"==t||t==s;return!o&&i&&"boolean"==typeof r&&(o=r?xd.has(e):bd.has(e)),!a&&n&&"boolean"==typeof s&&(a=s?xd.has(t):bd.has(t)),o&&a}}const Cd=new RegExp("s*:selfs*,?","g");function Sd(e,t,i){return new Ed(e).build(t,i)}class Ed{constructor(e){this._driver=e}build(e,t){const i=new Td(t);return this._resetContextStyleTimingState(i),_d(this,ld(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,n=t.depCount=0;const r=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const i=e,n=i.name;n.toString().split(/\s*,\s*/).forEach(e=>{i.name=e,r.push(this.visitState(i,t))}),i.name=n}else if(1==e.type){const r=this.visitTransition(e,t);i+=r.queryCount,n+=r.depCount,s.push(r)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:r,transitions:s,queryCount:i,depCount:n,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),n=e.options&&e.options.params||null;if(i.containsDynamicStyles){const r=new Set,s=n||{};if(i.styles.forEach(e=>{if(Pd(e)){const t=e;Object.keys(t).forEach(e=>{hd(t[e]).forEach(e=>{s.hasOwnProperty(e)||r.add(e)})})}}),r.size){const i=dd(r.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${i.join(", ")}`)}}return{type:0,name:e.name,style:i,options:n?{params:n}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=_d(this,ld(e.animation),t);return{type:1,matchers:vd(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Md(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>_d(this,e,t)),options:Md(e.options)}}visitGroup(e,t){const i=t.currentTime;let n=0;const r=e.steps.map(e=>{t.currentTime=i;const r=_d(this,e,t);return n=Math.max(n,t.currentTime),r});return t.currentTime=n,{type:3,steps:r,options:Md(e.options)}}visitAnimate(e,t){const i=function(e,t){let i=null;if(e.hasOwnProperty("duration"))i=e;else if("number"==typeof e)return kd(td(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=kd(0,0,"");return e.dynamic=!0,e.strValue=n,e}return i=i||td(n,t),kd(i.duration,i.delay,i.easing)}(e.timings,t.errors);let n;t.currentAnimateTimings=i;let r=e.styles?e.styles:Cu({});if(5==r.type)n=this.visitKeyframes(r,t);else{let r=e.styles,s=!1;if(!r){s=!0;const e={};i.easing&&(e.easing=i.easing),r=Cu(e)}t.currentTime+=i.duration+i.delay;const o=this.visitStyle(r,t);o.isEmptyStep=s,n=o}return t.currentAnimateTimings=null,{type:4,timings:i,style:n,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?"*"==e?i.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):i.push(e)}):i.push(e.styles);let n=!1,r=null;return i.forEach(e=>{if(Pd(e)){const t=e,i=t.easing;if(i&&(r=i,delete t.easing),!n)for(let e in t)if(t[e].toString().indexOf("{{")>=0){n=!0;break}}}),{type:6,styles:i,easing:r,offset:e.offset,containsDynamicStyles:n,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let n=t.currentTime,r=t.currentTime;i&&r>0&&(r-=i.duration+i.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(i=>{if(!this._driver.validateStyleProperty(i))return void t.errors.push(`The provided animation property "${i}" is not a supported CSS property for animations`);const s=t.collectedStyles[t.currentQuerySelector],o=s[i];let a=!0;o&&(r!=n&&r>=o.startTime&&n<=o.endTime&&(t.errors.push(`The CSS property "${i}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${r}ms" and "${n}ms"`),a=!1),r=o.startTime),a&&(s[i]={startTime:r,endTime:n}),t.options&&function(e,t,i){const n=t.params||{},r=hd(e);r.length&&r.forEach(e=>{n.hasOwnProperty(e)||i.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[i],t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),i;let n=0;const r=[];let s=!1,o=!1,a=0;const l=e.steps.map(e=>{const i=this._makeStyleAst(e,t);let l=null!=i.offset?i.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if(Pd(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}});else if(Pd(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}return t}(i.styles),c=0;return null!=l&&(n++,c=i.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,r.push(c),i});o&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&t.errors.push("Please ensure that all keyframe offsets are in order");const c=e.steps.length;let h=0;n>0&&n<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==n&&(h=1/(c-1));const u=c-1,d=t.currentTime,p=t.currentAnimateTimings,m=p.duration;return l.forEach((e,n)=>{const s=h>0?n==u?1:h*n:r[n],o=s*m;t.currentTime=d+p.delay+o,p.duration=o,this._validateStyleAst(e,t),e.offset=s,i.styles.push(e)}),i}visitReference(e,t){return{type:8,animation:_d(this,ld(e.animation),t),options:Md(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Md(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Md(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,n=e.options||{};t.queryCount++,t.currentQuery=e;const[r,s]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(Cd,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,e=>".ng-trigger-"+e.substr(1)).replace(/:animating/g,".ng-animating"),t]}(e.selector);t.currentQuerySelector=i.length?i+" "+r:r,Bu(t.collectedStyles,t.currentQuerySelector,{});const o=_d(this,ld(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:r,limit:n.limit||0,optional:!!n.optional,includeSelf:s,animation:o,originalSelector:e.selector,options:Md(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:td(e.timings,t.errors,!0);return{type:12,animation:_d(this,ld(e.animation),t),timings:i,options:null}}}class Td{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Pd(e){return!Array.isArray(e)&&"object"==typeof e}function Md(e){var t;return e?(e=id(e)).params&&(e.params=(t=e.params)?id(t):null):e={},e}function kd(e,t,i){return{duration:e,delay:t,easing:i}}function Ad(e,t,i,n,r,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:i,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Id{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Rd=new RegExp(":enter","g"),Od=new RegExp(":leave","g");function Nd(e,t,i,n,r,s={},o={},a,l,c=[]){return(new Dd).buildKeyframes(e,t,i,n,r,s,o,a,l,c)}class Dd{buildKeyframes(e,t,i,n,r,s,o,a,l,c=[]){l=l||new Id;const h=new Ld(e,t,l,n,r,c,[]);h.options=a,h.currentTimeline.setStyles([s],null,h.errors,a),_d(this,i,h);const u=h.timelines.filter(e=>e.containsAnimation());if(u.length&&Object.keys(o).length){const e=u[u.length-1];e.allowOnlyTimelineStyles()||e.setStyles([o],null,h.errors,a)}return u.length?u.map(e=>e.buildKeyframes()):[Ad(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.consume(t.element);if(i){const n=t.createSubContext(e.options),r=t.currentTimeline.currentTime,s=this._visitSubInstructions(i,n,n.options);r!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,i){let n=t.currentTimeline.currentTime;const r=null!=i.duration?Qu(i.duration):null,s=null!=i.delay?Qu(i.delay):null;return 0!==r&&e.forEach(e=>{const i=t.appendInstructionToTimeline(e,r,s);n=Math.max(n,i.duration+i.delay)}),n}visitReference(e,t){t.updateOptions(e.options,!0),_d(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let n=t;const r=e.options;if(r&&(r.params||r.delay)&&(n=t.createSubContext(r),n.transformIntoNewTimeline(),null!=r.delay)){6==n.previousNode.type&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=zd);const e=Qu(r.delay);n.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>_d(this,e,n)),n.currentTimeline.applyStylesToKeyframe(),n.subContextCount>i&&n.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let n=t.currentTimeline.currentTime;const r=e.options&&e.options.delay?Qu(e.options.delay):0;e.steps.forEach(s=>{const o=t.createSubContext(e.options);r&&o.delayNextStep(r),_d(this,s,o),n=Math.max(n,o.currentTimeline.currentTime),i.push(o.currentTimeline)}),i.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(n),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return td(t.params?ud(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),n=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),n.snapshotCurrentStyles());const r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(i.duration),this.visitStyle(r,t),n.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,n=t.currentAnimateTimings;!n&&i.getCurrentStyleProperties().length&&i.forwardFrame();const r=n&&n.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(r):i.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,n=t.currentTimeline.duration,r=i.duration,s=t.createSubContext().currentTimeline;s.easing=i.easing,e.styles.forEach(e=>{s.forwardTime((e.offset||0)*r),s.setStyles(e.styles,e.easing,t.errors,t.options),s.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(s),t.transformIntoNewTimeline(n+r),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,n=e.options||{},r=n.delay?Qu(n.delay):0;r&&(6===t.previousNode.type||0==i&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=zd);let s=i;const o=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!n.optional,t.errors);t.currentQueryTotal=o.length;let a=null;o.forEach((i,n)=>{t.currentQueryIndex=n;const o=t.createSubContext(e.options,i);r&&o.delayNextStep(r),i===t.element&&(a=o.currentTimeline),_d(this,e.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,n=t.currentTimeline,r=e.timings,s=Math.abs(r.duration),o=s*(t.currentQueryTotal-1);let a=s*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=o-a;break;case"full":a=i.currentStaggerTime}const l=t.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;_d(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=n.currentTime-c+(n.startTime-i.currentTimeline.startTime)}}const zd={};class Ld{constructor(e,t,i,n,r,s,o,a){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=n,this._leaveClassName=r,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=zd,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new Bd(this._driver,t,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let n=this.options;null!=i.duration&&(n.duration=Qu(i.duration)),null!=i.delay&&(n.delay=Qu(i.delay));const r=i.params;if(r){let e=n.params;e||(e=this.options.params={}),Object.keys(r).forEach(i=>{t&&e.hasOwnProperty(i)||(e[i]=ud(r[i],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(e=>{i[e]=t[e]})}}return e}createSubContext(e=null,t,i){const n=t||this.element,r=new Ld(this._driver,n,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(n,i||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(e),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(e){return this.previousNode=zd,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const n={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},r=new Fd(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,n,e.stretchStartingKeyframe);return this.timelines.push(r),n}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,n,r,s){let o=[];if(n&&o.push(this.element),e.length>0){e=(e=e.replace(Rd,"."+this._enterClassName)).replace(Od,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=i);0!==i&&(t=i<0?t.slice(t.length+i,t.length):t.slice(0,i)),o.push(...t)}return r||0!=o.length||s.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),o}}class Bd{constructor(e,t,i,n){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=n,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Bd(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||"*",this._currentKeyframe[e]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,n){t&&(this._previousKeyframe.easing=t);const r=n&&n.params||{},s=function(e,t){const i={};let n;return e.forEach(e=>{"*"===e?(n=n||Object.keys(t),n.forEach(e=>{i[e]="*"})):nd(e,!1,i)}),i}(e,this._globalTimelineStyles);Object.keys(s).forEach(e=>{const t=ud(s[e],r,i);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:"*"),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const i=this._styleSummary[t],n=e._styleSummary[t];(!i||n.time>i.time)&&this._updateStyle(t,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let n=[];this._keyframes.forEach((r,s)=>{const o=nd(r,!0);Object.keys(o).forEach(i=>{const n=o[i];"!"==n?e.add(i):"*"==n&&t.add(i)}),i||(o.offset=s/this.duration),n.push(o)});const r=e.size?dd(e.values()):[],s=t.size?dd(t.values()):[];if(i){const e=n[0],t=id(e);e.offset=0,t.offset=1,n=[e,t]}return Ad(this.element,n,r,s,this.duration,this.startTime,this.easing,!1)}}class Fd extends Bd{constructor(e,t,i,n,r,s,o=!1){super(e,t,s.delay),this.element=t,this.keyframes=i,this.preStyleProps=n,this.postStyleProps=r,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:n}=this.timings;if(this._stretchStartingKeyframe&&t){const r=[],s=i+t,o=t/s,a=nd(e[0],!1);a.offset=0,r.push(a);const l=nd(e[0],!1);l.offset=jd(o),r.push(l);const c=e.length-1;for(let n=1;n<=c;n++){let o=nd(e[n],!1);o.offset=jd((t+o.offset*i)/s),r.push(o)}i=s,t=0,n="",e=r}return Ad(this.element,e,this.preStyleProps,this.postStyleProps,i,t,n,!0)}}function jd(e,t=3){const i=Math.pow(10,t-1);return Math.round(e*i)/i}class Vd{}class Ud extends Vd{normalizePropertyName(e,t){return md(e)}normalizeStyleValue(e,t,i,n){let r="";const s=i.toString().trim();if(qd[t]&&0!==i&&"0"!==i)if("number"==typeof i)r="px";else{const t=i.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&n.push(`Please provide a CSS unit value for ${e}:${i}`)}return s+r}}const qd=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Hd(e,t,i,n,r,s,o,a,l,c,h,u,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:i,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:h,totalTime:u,errors:d}}const Gd={};class Wd{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,n){return function(e,t,i,n,r){return e.some(e=>e(t,i,n,r))}(this.ast.matchers,e,t,i,n)}buildStyles(e,t,i){const n=this._stateStyles["*"],r=this._stateStyles[e],s=n?n.buildStyles(t,i):{};return r?r.buildStyles(t,i):s}build(e,t,i,n,r,s,o,a,l,c){const h=[],u=this.ast.options&&this.ast.options.params||Gd,d=this.buildStyles(i,o&&o.params||Gd,h),p=a&&a.params||Gd,m=this.buildStyles(n,p,h),f=new Set,g=new Map,_=new Map,y="void"===n,v={params:Object.assign(Object.assign({},u),p)},x=c?[]:Nd(e,t,this.ast.animation,r,s,d,m,v,l,h);let b=0;if(x.forEach(e=>{b=Math.max(e.duration+e.delay,b)}),h.length)return Hd(t,this._triggerName,i,n,y,d,m,[],[],g,_,b,h);x.forEach(e=>{const i=e.element,n=Bu(g,i,{});e.preStyleProps.forEach(e=>n[e]=!0);const r=Bu(_,i,{});e.postStyleProps.forEach(e=>r[e]=!0),i!==t&&f.add(i)});const w=dd(f.values());return Hd(t,this._triggerName,i,n,y,d,m,x,w,g,_,b)}}class Zd{constructor(e,t){this.styles=e,this.defaultParams=t}buildStyles(e,t){const i={},n=id(this.defaultParams);return Object.keys(e).forEach(t=>{const i=e[t];null!=i&&(n[t]=i)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const r=e;Object.keys(r).forEach(e=>{let s=r[e];s.length>1&&(s=ud(s,n,t)),i[e]=s})}}),i}}class $d{constructor(e,t){this.name=e,this.ast=t,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new Zd(e.style,e.options&&e.options.params||{})}),Xd(this.states,"true","1"),Xd(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new Wd(e,t,this.states))}),this.fallbackTransition=new Wd(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,n){return this.transitionFactories.find(r=>r.match(e,t,i,n))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function Xd(e,t,i){e.hasOwnProperty(t)?e.hasOwnProperty(i)||(e[i]=e[t]):e.hasOwnProperty(i)&&(e[t]=e[i])}const Kd=new Id;class Yd{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(e,t){const i=[],n=Sd(this._driver,t,i);if(i.length)throw new Error("Unable to build the animation due to the following errors: "+i.join("\n"));this._animations[e]=n}_buildPlayer(e,t,i){const n=e.element,r=Nu(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(n,r,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const n=[],r=this._animations[e];let s;const o=new Map;if(r?(s=Nd(this._driver,t,r,"ng-enter","ng-leave",{},{},i,Kd,n),s.forEach(e=>{const t=Bu(o,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(n.push("The requested animation doesn't exist or has already been destroyed"),s=[]),n.length)throw new Error("Unable to create the animation due to the following errors: "+n.join("\n"));o.forEach((e,t)=>{Object.keys(e).forEach(i=>{e[i]=this._driver.computeStyle(t,i,"*")})});const a=Ou(s.map(e=>{const t=o.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by "+e);return t}listen(e,t,i,n){const r=Lu(t,"","","");return Du(this._getPlayer(e),i,r,n),()=>{}}command(e,t,i,n){if("register"==i)return void this.register(e,n[0]);if("create"==i)return void this.create(e,t,n[0]||{});const r=this._getPlayer(e);switch(i){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(n[0]));break;case"destroy":this.destroy(e)}}}const Jd=[],Qd={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ep={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class tp{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=null!=(n=i?e.value:e)?n:null,i){const t=id(e);delete t.value,this.options=t}else this.options={};var n;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(i=>{null==e[i]&&(e[i]=t[i])})}}}const ip=new tp("void");class np{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,hp(t,this._hostClassName)}listen(e,t,i,n){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${i}" because the animation trigger "${t}" doesn't exist!`);if(null==i||0==i.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if("start"!=(r=i)&&"done"!=r)throw new Error(`The provided animation trigger event "${i}" for the animation trigger "${t}" is not supported!`);var r;const s=Bu(this._elementListeners,e,[]),o={name:t,phase:i,callback:n};s.push(o);const a=Bu(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(hp(e,"ng-trigger"),hp(e,"ng-trigger-"+t),a[t]=ip),()=>{this._engine.afterFlush(()=>{const e=s.indexOf(o);e>=0&&s.splice(e,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,i,n=!0){const r=this._getTrigger(t),s=new sp(this.id,t,e);let o=this._engine.statesByElement.get(e);o||(hp(e,"ng-trigger"),hp(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,o={}));let a=o[t];const l=new tp(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[t]=l,a||(a=ip),"void"!==l.value&&a.value===l.value){if(!function(e,t){const i=Object.keys(e),n=Object.keys(t);if(i.length!=n.length)return!1;for(let r=0;r<i.length;r++){const n=i[r];if(!t.hasOwnProperty(n)||e[n]!==t[n])return!1}return!0}(a.params,l.params)){const t=[],i=r.matchStyles(a.value,a.params,t),n=r.matchStyles(l.value,l.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{ad(e,i),od(e,n)})}return}const c=Bu(this._engine.playersByElement,e,[]);c.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let h=r.matchTransition(a.value,l.value,e,l.params),u=!1;if(!h){if(!n)return;h=r.fallbackTransition,u=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:a,toState:l,player:s,isFallbackTransition:u}),u||(hp(e,"ng-animate-queued"),s.onStart(()=>{up(e,"ng-animate-queued")})),s.onDone(()=>{let t=this.players.indexOf(s);t>=0&&this.players.splice(t,1);const i=this._engine.playersByElement.get(e);if(i){let e=i.indexOf(s);e>=0&&i.splice(e,1)}}),this.players.push(s),c.push(s),s}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,i)=>{delete t[e]}),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,".ng-trigger",!0);i.forEach(e=>{if(e.__ng_removed)return;const i=this._engine.fetchNamespacesByElement(e);i.size?i.forEach(i=>i.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,i,n){const r=this._engine.statesByElement.get(e);if(r){const s=[];if(Object.keys(r).forEach(t=>{if(this._triggers[t]){const i=this.trigger(e,t,"void",n);i&&s.push(i)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),i&&Ou(s).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e);if(t){const i=new Set;t.forEach(t=>{const n=t.name;if(i.has(n))return;i.add(n);const r=this._triggers[n].fallbackTransition,s=this._engine.statesByElement.get(e)[n]||ip,o=new tp("void"),a=new sp(this.id,n,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:r,fromState:s,toState:o,player:a,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let n=!1;if(i.totalAnimations){const t=i.players.length?i.playersByQueriedElement.get(e):[];if(t&&t.length)n=!0;else{let t=e;for(;t=t.parentNode;)if(i.statesByElement.get(t)){n=!0;break}}}if(this.prepareLeaveAnimationListeners(e),n)i.markElementAsRemoved(this.id,e,!1,t);else{const n=e.__ng_removed;n&&n!==Qd||(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){hp(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const n=i.player;if(n.destroyed)return;const r=i.element,s=this._elementListeners.get(r);s&&s.forEach(t=>{if(t.name==i.triggerName){const n=Lu(r,i.triggerName,i.fromState.value,i.toState.value);n._data=e,Du(i.player,t.phase,n,t.callback)}}),n.markedForDestroy?this._engine.afterFlush(()=>{n.destroy()}):t.push(i)}),this._queue=[],t.sort((e,t)=>{const i=e.transition.ast.depCount,n=t.transition.ast.depCount;return 0==i||0==n?i-n:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class rp{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const i=new np(e,t,this);return t.parentNode?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList.length-1;if(i>=0){let n=!1;for(let r=i;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),n=!0;break}n||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let n=this._namespaceLookup[e];n&&n.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(i);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i){const e=Object.keys(i);for(let n=0;n<e.length;n++){const r=i[e[n]].namespaceId;if(r){const e=this._fetchNamespace(r);e&&t.add(e)}}}return t}trigger(e,t,i,n){if(op(t)){const r=this._fetchNamespace(e);if(r)return r.trigger(t,i,n),!0}return!1}insertNode(e,t,i,n){if(!op(t))return;const r=t.__ng_removed;if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const n=this._fetchNamespace(e);n&&n.insertNode(t,i)}n&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),hp(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),up(e,"ng-animate-disabled"))}removeNode(e,t,i,n){if(op(t)){const r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n),i){const i=this.namespacesByHostElement.get(t);i&&i.id!==e&&i.removeNode(t,n)}}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,i,n){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:n,hasAnimation:i,removedBeforeQueried:!1}}listen(e,t,i,n,r){return op(t)?this._fetchNamespace(e).listen(t,i,n,r):()=>{}}_buildInstruction(e,t,i,n,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,n,e.fromState.options,e.toState.options,t,r)}destroyInnerAnimations(e){let t=this.driver.query(e,".ng-trigger",!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,".ng-animating",!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ou(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e.__ng_removed;if(t&&t.setForRemoval){if(e.__ng_removed=Qd,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)hp(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let e=0;e<i.length;e++)i[e]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?Ou(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n "+e.join("\n"))}_flushAnimations(e,t){const i=new Id,n=[],r=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(e=>{c.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let i=0;i<t.length;i++)c.add(t[i])});const h=this.bodyNode,u=Array.from(this.statesByElement.keys()),d=cp(u,this.collectedEnterElements),p=new Map;let m=0;d.forEach((e,t)=>{const i="ng-enter"+m++;p.set(t,i),e.forEach(e=>hp(e,i))});const f=[],g=new Set,_=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){const e=this.collectedLeaveElements[A],t=e.__ng_removed;t&&t.setForRemoval&&(f.push(e),g.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>g.add(e)):_.add(e))}const y=new Map,v=cp(u,Array.from(g));v.forEach((e,t)=>{const i="ng-leave"+m++;y.set(t,i),e.forEach(e=>hp(e,i))}),e.push(()=>{d.forEach((e,t)=>{const i=p.get(t);e.forEach(e=>up(e,i))}),v.forEach((e,t)=>{const i=y.get(t);e.forEach(e=>up(e,i))}),f.forEach(e=>{this.processLeaveNode(e)})});const x=[],b=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(t).forEach(e=>{const t=e.player,r=e.element;if(x.push(t),this.collectedEnterElements.length){const e=r.__ng_removed;if(e&&e.setForMove)return void t.destroy()}const c=!h||!this.driver.containsElement(h,r),u=y.get(r),d=p.get(r),m=this._buildInstruction(e,i,d,u,c);if(m.errors&&m.errors.length)b.push(m);else{if(c)return t.onStart(()=>ad(r,m.fromStyles)),t.onDestroy(()=>od(r,m.toStyles)),void n.push(t);if(e.isFallbackTransition)return t.onStart(()=>ad(r,m.fromStyles)),t.onDestroy(()=>od(r,m.toStyles)),void n.push(t);m.timelines.forEach(e=>e.stretchStartingKeyframe=!0),i.append(r,m.timelines),s.push({instruction:m,player:t,element:r}),m.queriedElements.forEach(e=>Bu(o,e,[]).push(t)),m.preStyleProps.forEach((e,t)=>{const i=Object.keys(e);if(i.length){let e=a.get(t);e||a.set(t,e=new Set),i.forEach(t=>e.add(t))}}),m.postStyleProps.forEach((e,t)=>{const i=Object.keys(e);let n=l.get(t);n||l.set(t,n=new Set),i.forEach(e=>n.add(e))})}});if(b.length){const e=[];b.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),x.forEach(e=>e.destroy()),this.reportError(e)}const w=new Map,C=new Map;s.forEach(e=>{const t=e.element;i.has(t)&&(C.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,w))}),n.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{Bu(w,t,[]).push(e),e.destroy()})});const S=f.filter(e=>pp(e,a,l)),E=new Map;lp(E,this.driver,_,l,"*").forEach(e=>{pp(e,a,l)&&S.push(e)});const T=new Map;d.forEach((e,t)=>{lp(T,this.driver,new Set(e),a,"!")}),S.forEach(e=>{const t=E.get(e),i=T.get(e);E.set(e,Object.assign(Object.assign({},t),i))});const P=[],M=[],k={};s.forEach(e=>{const{element:t,player:s,instruction:o}=e;if(i.has(t)){if(c.has(t))return s.onDestroy(()=>od(t,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void n.push(s);let e=k;if(C.size>1){let i=t;const n=[];for(;i=i.parentNode;){const t=C.get(i);if(t){e=t;break}n.push(i)}n.forEach(t=>C.set(t,e))}const i=this._buildAnimation(s.namespaceId,o,w,r,T,E);if(s.setRealPlayer(i),e===k)P.push(s);else{const t=this.playersByElement.get(e);t&&t.length&&(s.parentPlayer=Ou(t)),n.push(s)}}else ad(t,o.fromStyles),s.onDestroy(()=>od(t,o.toStyles)),M.push(s),c.has(t)&&n.push(s)}),M.forEach(e=>{const t=r.get(e.element);if(t&&t.length){const i=Ou(t);e.setRealPlayer(i)}}),n.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let A=0;A<f.length;A++){const e=f[A],t=e.__ng_removed;if(up(e,"ng-leave"),t&&t.hasAnimation)continue;let i=[];if(o.size){let t=o.get(e);t&&t.length&&i.push(...t);let n=this.driver.query(e,".ng-animating",!0);for(let e=0;e<n.length;e++){let t=o.get(n[e]);t&&t.length&&i.push(...t)}}const n=i.filter(e=>!e.destroyed);n.length?dp(this,e,n):this.processLeaveNode(e)}return f.length=0,P.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),P}elementContainsData(e,t){let i=!1;const n=t.__ng_removed;return n&&n.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,n,r){let s=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(s=t)}else{const t=this.playersByElement.get(e);if(t){const e=!r||"void"==r;t.forEach(t=>{t.queued||(e||t.triggerName==n)&&s.push(t)})}}return(i||n)&&(s=s.filter(e=>!(i&&i!=e.namespaceId||n&&n!=e.triggerName))),s}_beforeAnimationBuild(e,t,i){const n=t.element,r=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName;for(const o of t.timelines){const e=o.element,a=e!==n,l=Bu(i,e,[]);this._getPreviousPlayers(e,a,r,s,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),l.push(e)})}ad(n,t.fromStyles)}_buildAnimation(e,t,i,n,r,s){const o=t.triggerName,a=t.element,l=[],c=new Set,h=new Set,u=t.timelines.map(t=>{const u=t.element;c.add(u);const d=u.__ng_removed;if(d&&d.removedBeforeQueried)return new Au(t.duration,t.delay);const p=u!==a,m=function(e){const t=[];return function e(t,i){for(let n=0;n<t.length;n++){const r=t[n];r instanceof Iu?e(r.players,i):i.push(r)}}(e,t),t}((i.get(u)||Jd).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===u),f=r.get(u),g=s.get(u),_=Nu(0,this._normalizer,0,t.keyframes,f,g),y=this._buildPlayer(t,_,m);if(t.subTimeline&&n&&h.add(u),p){const t=new sp(e,o,u);t.setRealPlayer(y),l.push(t)}return y});l.forEach(e=>{Bu(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,i){let n;if(e instanceof Map){if(n=e.get(t),n){if(n.length){const e=n.indexOf(i);n.splice(e,1)}0==n.length&&e.delete(t)}}else if(n=e[t],n){if(n.length){const e=n.indexOf(i);n.splice(e,1)}0==n.length&&delete e[t]}return n}(this.playersByQueriedElement,e.element,e))}),c.forEach(e=>hp(e,"ng-animating"));const d=Ou(u);return d.onDestroy(()=>{c.forEach(e=>up(e,"ng-animating")),od(a,t.toStyles)}),h.forEach(e=>{Bu(n,e,[]).push(d)}),d}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Au(e.duration,e.delay)}}class sp{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Au,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(i=>Du(e,t,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Bu(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function op(e){return e&&1===e.nodeType}function ap(e,t){const i=e.style.display;return e.style.display=null!=t?t:"none",i}function lp(e,t,i,n,r){const s=[];i.forEach(e=>s.push(ap(e)));const o=[];n.forEach((i,n)=>{const s={};i.forEach(e=>{const i=s[e]=t.computeStyle(n,e,r);i&&0!=i.length||(n.__ng_removed=ep,o.push(n))}),e.set(n,s)});let a=0;return i.forEach(e=>ap(e,s[a++])),o}function cp(e,t){const i=new Map;if(e.forEach(e=>i.set(e,[])),0==t.length)return i;const n=new Set(t),r=new Map;return t.forEach(e=>{const t=function e(t){if(!t)return 1;let s=r.get(t);if(s)return s;const o=t.parentNode;return s=i.has(o)?o:n.has(o)?1:e(o),r.set(t,s),s}(e);1!==t&&i.get(t).push(e)}),i}function hp(e,t){if(e.classList)e.classList.add(t);else{let i=e.$$classes;i||(i=e.$$classes={}),i[t]=!0}}function up(e,t){if(e.classList)e.classList.remove(t);else{let i=e.$$classes;i&&delete i[t]}}function dp(e,t,i){Ou(i).onDone(()=>e.processLeaveNode(t))}function pp(e,t,i){const n=i.get(e);if(!n)return!1;let r=t.get(e);return r?n.forEach(e=>r.add(e)):t.set(e,n),i.delete(e),!0}class mp{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new rp(e,t,i),this._timelineEngine=new Yd(e,t,i),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,i,n,r){const s=e+"-"+n;let o=this._triggerCache[s];if(!o){const e=[],t=Sd(this._driver,r,e);if(e.length)throw new Error(`The animation trigger "${n}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);o=function(e,t){return new $d(e,t)}(n,t),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(t,n,o)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,n){this._transitionEngine.insertNode(e,t,i,n)}onRemove(e,t,i,n){this._transitionEngine.removeNode(e,t,n||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,n){if("@"==i.charAt(0)){const[e,r]=Fu(i);this._timelineEngine.command(e,t,r,n)}else this._transitionEngine.trigger(e,t,i,n)}listen(e,t,i,n,r){if("@"==i.charAt(0)){const[e,n]=Fu(i);return this._timelineEngine.listen(e,t,n,r)}return this._transitionEngine.listen(e,t,i,n,r)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function fp(e,t){let i=null,n=null;return Array.isArray(t)&&t.length?(i=_p(t[0]),t.length>1&&(n=_p(t[t.length-1]))):t&&(i=_p(t)),i||n?new gp(e,i,n):null}let gp=(()=>{class e{constructor(t,i,n){this._element=t,this._startStyles=i,this._endStyles=n,this._state=0;let r=e.initialStylesByElement.get(t);r||e.initialStylesByElement.set(t,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&od(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(od(this._element,this._initialStyles),this._endStyles&&(od(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(ad(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ad(this._element,this._endStyles),this._endStyles=null),od(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function _p(e){let t=null;const i=Object.keys(e);for(let n=0;n<i.length;n++){const r=i[n];yp(r)&&(t=t||{},t[r]=e[r])}return t}function yp(e){return"display"===e||"position"===e}class vp{constructor(e,t,i,n,r,s,o){this._element=e,this._name=t,this._duration=i,this._delay=n,this._easing=r,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){!function(e,t){const i=Ep(e,"").trim();i.length&&(function(e,t){let i=0;for(let n=0;n<e.length;n++)","===e.charAt(n)&&i++}(i),t=`${i}, ${t}`),Sp(e,"",t)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),Cp(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){xp(this._element,this._name,"paused")}resume(){xp(this._element,this._name,"running")}setPosition(e){const t=bp(this._element,this._name);this._position=e*this._duration,Sp(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),i=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&i>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),Cp(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){const i=Ep(e,"").split(","),n=wp(i,t);n>=0&&(i.splice(n,1),Sp(e,"",i.join(",")))}(this._element,this._name))}}function xp(e,t,i){Sp(e,"PlayState",i,bp(e,t))}function bp(e,t){const i=Ep(e,"");return i.indexOf(",")>0?wp(i.split(","),t):wp([i],t)}function wp(e,t){for(let i=0;i<e.length;i++)if(e[i].indexOf(t)>=0)return i;return-1}function Cp(e,t,i){i?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function Sp(e,t,i,n){const r="animation"+t;if(null!=n){const t=e.style[r];if(t.length){const e=t.split(",");e[n]=i,i=e.join(",")}}e.style[r]=i}function Ep(e,t){return e.style["animation"+t]}class Tp{constructor(e,t,i,n,r,s,o,a){this.element=e,this.keyframes=t,this.animationName=i,this._duration=n,this._delay=r,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=n+r,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new vp(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(i=>{"offset"!=i&&(e[i]=t?this._finalStyles[i]:yd(this.element,i))})}this.currentSnapshot=e}}class Pp extends Au{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=Ku(t)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class Mp{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(e){return Wu(e)}matchesElement(e,t){return Zu(e,t)}containsElement(e,t){return $u(e,t)}query(e,t,i){return Xu(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,i){i=i.map(e=>Ku(e));let n=`@keyframes ${t} {\n`,r="";i.forEach(e=>{r=" ";const t=parseFloat(e.offset);n+=`${r}${100*t}% {\n`,r+=" ",Object.keys(e).forEach(t=>{const i=e[t];switch(t){case"offset":return;case"easing":return void(i&&(n+=`${r}animation-timing-function: ${i};\n`));default:return void(n+=`${r}${t}: ${i};\n`)}}),n+=r+"}\n"}),n+="}\n";const s=document.createElement("style");return s.innerHTML=n,s}animate(e,t,i,n,r,s=[],o){o&&this._notifyFaultyScrubber();const a=s.filter(e=>e instanceof Tp),l={};fd(i,n)&&a.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const c=function(e){let t={};return e&&(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(i=>{"offset"!=i&&"easing"!=i&&(t[i]=e[i])})}),t}(t=gd(e,t,l));if(0==i)return new Pp(e,c);const h="gen_css_kf_"+this._count++,u=this.buildKeyframeElement(e,h,t);document.querySelector("head").appendChild(u);const d=fp(e,t),p=new Tp(e,t,h,i,n,r,c,d);return p.onDestroy(()=>{var e;(e=u).parentNode.removeChild(e)}),p}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class kp{constructor(e,t,i,n){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=n,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,i){return e.animate(t,i)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(t=>{"offset"!=t&&(e[t]=this._finished?this._finalKeyframe[t]:yd(this.element,t))}),this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class Ap{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Ip().toString()),this._cssKeyframesDriver=new Mp}validateStyleProperty(e){return Wu(e)}matchesElement(e,t){return Zu(e,t)}containsElement(e,t){return $u(e,t)}query(e,t,i){return Xu(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,i,n,r,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,i,n,r,s);const a={duration:i,delay:n,fill:0==n?"both":"forwards"};r&&(a.easing=r);const l={},c=s.filter(e=>e instanceof kp);fd(i,n)&&c.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const h=fp(e,t=gd(e,t=t.map(e=>nd(e,!1)),l));return new kp(e,t,a,h)}}function Ip(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let Rp=(()=>{class e extends yu{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:ut.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(e)?wu(e):e;return Dp(this._renderer,null,t,"register",[i]),new Op(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(Ke(Va),Ke(th))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Op extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Np(this._id,e,t||{},this._renderer)}}class Np{constructor(e,t,i,n){this.id=e,this.element=t,this._renderer=n,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Dp(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(e){this._command("setPosition",e)}getPosition(){return 0}}function Dp(e,t,i,n,r){return e.setProperty(t,`@@${i}:${n}`,r)}let zp=(()=>{class e{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const i=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(i);return e||(e=new Lp("",i,this.engine),this._rendererCache.set(i,e)),e}const n=t.id,r=t.id+"-"+this._currentId;this._currentId++,this.engine.register(r,e);const s=t=>{Array.isArray(t)?t.forEach(s):this.engine.registerTrigger(n,r,e,t.name,t)};return t.data.animation.forEach(s),new Bp(this,r,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){e>=0&&e<this._microtaskId?this._zone.run(()=>t(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,i]=e;t(i)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(Ke(Va),Ke(mp),Ke(Cc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Lp{constructor(e,t,i){this.namespaceId=e,this.delegate=t,this.engine=i,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,!0)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,n){this.delegate.setAttribute(e,t,i,n)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,n){this.delegate.setStyle(e,t,i,n)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Bp extends Lp{constructor(e,t,i,n){super(t,i,n),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.substr(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const n=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let r=t.substr(1),s="";return"@"!=r.charAt(0)&&([r,s]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(r)),this.engine.listen(this.namespaceId,n,r,s,e=>{this.factory.scheduleListenerCallback(e._data||-1,i,e)})}return this.delegate.listen(e,t,i)}}let Fp=(()=>{class e extends mp{constructor(e,t,i){super(e.body,t,i)}}return e.\u0275fac=function(t){return new(t||e)(Ke(th),Ke(Ju),Ke(Vd))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const jp=new je("AnimationModuleType"),Vp=[{provide:Ju,useFactory:function(){return"function"==typeof Ip()?new Ap:new Mp}},{provide:jp,useValue:"BrowserAnimations"},{provide:yu,useClass:Rp},{provide:Vd,useFactory:function(){return new Ud}},{provide:mp,useClass:Fp},{provide:Va,useFactory:function(e,t,i){return new zp(e,t,i)},deps:[nu,mp,Cc]}];let Up=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:Vp,imports:[_u]}),e})();function qp(...e){let t=e[e.length-1];return M(t)?(e.pop(),V(e,t)):Z(e)}class Hp extends T{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new C;return this._value}next(e){super.next(this._value=e)}}const Gp=(()=>{function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e})(),Wp={};function Zp(...e){let t=null,i=null;return M(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&c(e[0])&&(e=e[0]),Z(e,i).lift(new $p(t))}class $p{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Xp(e,this.resultSelector))}}class Xp extends L{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(Wp),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++){const t=e[i];this.add(z(this,t,t,i))}}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i,n,r){const s=this.values,o=this.toRespond?s[i]===Wp?--this.toRespond:this.toRespond:0;s[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Kp=new b(e=>e.complete());function Yp(e){return e?function(e){return new b(t=>e.schedule(()=>t.complete()))}(e):Kp}function Jp(e){return new b(t=>{let i;try{i=e()}catch(n){return void t.error(n)}return(i?U(i):Yp()).subscribe(t)})}function Qp(){return W(1)}function em(e,t){return function(i){return i.lift(new tm(e,t))}}class tm{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new im(e,this.predicate,this.thisArg))}}class im extends f{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}const nm=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function rm(e){return function(t){return 0===e?Yp():t.lift(new sm(e))}}class sm{constructor(e){if(this.total=e,this.total<0)throw new nm}call(e,t){return t.subscribe(new om(e,this.total))}}class om extends f{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,i=this.total,n=this.count++;t.length<i?t.push(e):t[n%i]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let r=0;r<i;r++){const r=t++%i;e.next(n[r])}}e.complete()}}function am(e=hm){return t=>t.lift(new lm(e))}class lm{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new cm(e,this.errorFactory))}}class cm extends f{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}}function hm(){return new Gp}function um(e=null){return t=>t.lift(new dm(e))}class dm{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new pm(e,this.defaultValue))}}class pm extends f{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function mm(e,t){const i=arguments.length>=2;return n=>n.pipe(e?em((t,i)=>e(t,i,n)):y,rm(1),i?um(t):am(()=>new Gp))}function fm(e){return function(t){const i=new gm(e),n=t.lift(i);return i.caught=n}}class gm{constructor(e){this.selector=e}call(e,t){return t.subscribe(new _m(e,this.selector,this.caught))}}class _m extends L{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let i;try{i=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const n=new k(this,void 0,void 0);this.add(n);const r=z(this,i,void 0,void 0,n);r!==n&&this.add(r)}}}function ym(e){return t=>0===e?Yp():t.lift(new vm(e))}class vm{constructor(e){if(this.total=e,this.total<0)throw new nm}call(e,t){return t.subscribe(new xm(e,this.total))}}class xm extends f{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function bm(e,t){const i=arguments.length>=2;return n=>n.pipe(e?em((t,i)=>e(t,i,n)):y,ym(1),i?um(t):am(()=>new Gp))}class wm{constructor(e,t,i){this.predicate=e,this.thisArg=t,this.source=i}call(e,t){return t.subscribe(new Cm(e,this.predicate,this.thisArg,this.source))}}class Cm extends f{constructor(e,t,i,n){super(e),this.predicate=t,this.thisArg=i,this.source=n,this.index=0,this.thisArg=i||this}notifyComplete(e){this.destination.next(e),this.destination.complete()}_next(e){let t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(i){return void this.destination.error(i)}t||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function Sm(e,t){return"function"==typeof t?i=>i.pipe(Sm((i,n)=>U(e(i,n)).pipe(B((e,r)=>t(i,e,n,r))))):t=>t.lift(new Em(e))}class Em{constructor(e){this.project=e}call(e,t){return t.subscribe(new Tm(e,this.project))}}class Tm extends L{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this._innerSub(t,e,i)}_innerSub(e,t,i){const n=this.innerSubscription;n&&n.unsubscribe();const r=new k(this,t,i),s=this.destination;s.add(r),this.innerSubscription=z(this,e,void 0,void 0,r),this.innerSubscription!==r&&s.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(e,t,i,n,r){this.destination.next(t)}}function Pm(...e){return Qp()(qp(...e))}function Mm(...e){const t=e[e.length-1];return M(t)?(e.pop(),i=>Pm(e,i,t)):t=>Pm(e,t)}function km(e,t){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new Am(e,t,i))}}class Am{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new Im(e,this.accumulator,this.seed,this.hasSeed))}}class Im extends f{constructor(e,t,i,n){super(e),this.accumulator=t,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}function Rm(e,t){return q(e,t,1)}function Om(){}function Nm(e,t,i){return function(n){return n.lift(new Dm(e,t,i))}}class Dm{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new zm(e,this.nextOrObserver,this.error,this.complete))}}class zm extends f{constructor(e,t,i,n){super(e),this._tapNext=Om,this._tapError=Om,this._tapComplete=Om,this._tapError=i||Om,this._tapComplete=n||Om,r(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||Om,this._tapError=t.error||Om,this._tapComplete=t.complete||Om)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function Lm(e){return t=>t.lift(new Bm(e))}class Bm{constructor(e){this.callback=e}call(e,t){return t.subscribe(new Fm(e,this.callback))}}class Fm extends f{constructor(e,t){super(e),this.add(new d(t))}}class jm{constructor(e,t){this.id=e,this.url=t}}class Vm extends jm{constructor(e,t,i="imperative",n=null){super(e,t),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Um extends jm{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class qm extends jm{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Hm extends jm{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Gm extends jm{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wm extends jm{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zm extends jm{constructor(e,t,i,n,r){super(e,t),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class $m extends jm{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xm extends jm{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Km{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ym{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Jm{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qm{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ef{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tf{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nf{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let rf=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ft({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Io(0,"router-outlet")},directives:function(){return[c_]},encapsulation:2}),e})();class sf{constructor(e){this.params=e||{}}has(e){return this.params.hasOwnProperty(e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function of(e){return new sf(e)}function af(e){const t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function lf(e,t,i){const n=i.path.split("/");if(n.length>e.length)return null;if("full"===i.pathMatch&&(t.hasChildren()||n.length<e.length))return null;const r={};for(let s=0;s<n.length;s++){const t=n[s],i=e[s];if(t.startsWith(":"))r[t.substring(1)]=i;else if(t!==i.path)return null}return{consumed:e.slice(0,n.length),posParams:r}}class cf{constructor(e,t){this.routes=e,this.module=t}}function hf(e,t=""){for(let i=0;i<e.length;i++){const n=e[i];uf(n,df(t,n))}}function uf(e,t){if(!e)throw new Error(`\n      Invalid configuration of route '${t}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(e))throw new Error(`Invalid configuration of route '${t}': Array cannot be specified`);if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&"primary"!==e.outlet)throw new Error(`Invalid configuration of route '${t}': a componentless route without children or loadChildren cannot have a named outlet set`);if(e.redirectTo&&e.children)throw new Error(`Invalid configuration of route '${t}': redirectTo and children cannot be used together`);if(e.redirectTo&&e.loadChildren)throw new Error(`Invalid configuration of route '${t}': redirectTo and loadChildren cannot be used together`);if(e.children&&e.loadChildren)throw new Error(`Invalid configuration of route '${t}': children and loadChildren cannot be used together`);if(e.redirectTo&&e.component)throw new Error(`Invalid configuration of route '${t}': redirectTo and component cannot be used together`);if(e.path&&e.matcher)throw new Error(`Invalid configuration of route '${t}': path and matcher cannot be used together`);if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error(`Invalid configuration of route '${t}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===e.path&&void 0===e.matcher)throw new Error(`Invalid configuration of route '${t}': routes must have either a path or a matcher specified`);if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error(`Invalid configuration of route '${t}': path cannot start with a slash`);if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error(`Invalid configuration of route '{path: "${t}", redirectTo: "${e.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error(`Invalid configuration of route '${t}': pathMatch can only be set to 'prefix' or 'full'`);e.children&&hf(e.children,t)}function df(e,t){return t?e||t.path?e&&!t.path?e+"/":!e&&t.path?t.path:`${e}/${t.path}`:"":e}function pf(e){const t=e.children&&e.children.map(pf),i=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!i.component&&(t||i.loadChildren)&&i.outlet&&"primary"!==i.outlet&&(i.component=rf),i}function mf(e,t){const i=Object.keys(e),n=Object.keys(t);if(!i||!n||i.length!=n.length)return!1;let r;for(let s=0;s<i.length;s++)if(r=i[s],!ff(e[r],t[r]))return!1;return!0}function ff(e,t){return Array.isArray(e)&&Array.isArray(t)?e.length==t.length&&e.every(e=>t.indexOf(e)>-1):e===t}function gf(e){return Array.prototype.concat.apply([],e)}function _f(e){return e.length>0?e[e.length-1]:null}function yf(e,t){for(const i in e)e.hasOwnProperty(i)&&t(e[i],i)}function vf(e){return zo(e)?e:Do(e)?U(Promise.resolve(e)):qp(e)}function xf(e,t,i){return i?function(e,t){return mf(e,t)}(e.queryParams,t.queryParams)&&function e(t,i){if(!Sf(t.segments,i.segments))return!1;if(t.numberOfChildren!==i.numberOfChildren)return!1;for(const n in i.children){if(!t.children[n])return!1;if(!e(t.children[n],i.children[n]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>ff(e[i],t[i]))}(e.queryParams,t.queryParams)&&function e(t,i){return function t(i,n,r){if(i.segments.length>r.length)return!!Sf(i.segments.slice(0,r.length),r)&&!n.hasChildren();if(i.segments.length===r.length){if(!Sf(i.segments,r))return!1;for(const t in n.children){if(!i.children[t])return!1;if(!e(i.children[t],n.children[t]))return!1}return!0}{const e=r.slice(0,i.segments.length),s=r.slice(i.segments.length);return!!Sf(i.segments,e)&&!!i.children.primary&&t(i.children.primary,n,s)}}(t,i,i.segments)}(e.root,t.root)}class bf{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=of(this.queryParams)),this._queryParamMap}toString(){return Mf.serialize(this)}}class wf{constructor(e,t){this.segments=e,this.children=t,this.parent=null,yf(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kf(this)}}class Cf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=of(this.parameters)),this._parameterMap}toString(){return Df(this)}}function Sf(e,t){return e.length===t.length&&e.every((e,i)=>e.path===t[i].path)}function Ef(e,t){let i=[];return yf(e.children,(e,n)=>{"primary"===n&&(i=i.concat(t(e,n)))}),yf(e.children,(e,n)=>{"primary"!==n&&(i=i.concat(t(e,n)))}),i}class Tf{}class Pf{parse(e){const t=new jf(e);return new bf(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){return`${"/"+function e(t,i){if(!t.hasChildren())return kf(t);if(i){const i=t.children.primary?e(t.children.primary,!1):"",n=[];return yf(t.children,(t,i)=>{"primary"!==i&&n.push(`${i}:${e(t,!1)}`)}),n.length>0?`${i}(${n.join("//")})`:i}{const i=Ef(t,(i,n)=>"primary"===n?[e(t.children.primary,!1)]:[`${n}:${e(i,!1)}`]);return`${kf(t)}/(${i.join("//")})`}}(e.root,!0)}${function(e){const t=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(e=>`${If(t)}=${If(e)}`).join("&"):`${If(t)}=${If(i)}`});return t.length?"?"+t.join("&"):""}(e.queryParams)}${"string"==typeof e.fragment?"#"+encodeURI(e.fragment):""}`}}const Mf=new Pf;function kf(e){return e.segments.map(e=>Df(e)).join("/")}function Af(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function If(e){return Af(e).replace(/%3B/gi,";")}function Rf(e){return Af(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Of(e){return decodeURIComponent(e)}function Nf(e){return Of(e.replace(/\+/g,"%20"))}function Df(e){return`${Rf(e.path)}${t=e.parameters,Object.keys(t).map(e=>`;${Rf(e)}=${Rf(t[e])}`).join("")}`;var t}const zf=/^[^\/()?;=#]+/;function Lf(e){const t=e.match(zf);return t?t[0]:""}const Bf=/^[^=?&#]+/,Ff=/^[^?&#]+/;class jf{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new wf([],{}):new wf([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i.primary=new wf(e,t)),i}parseSegment(){const e=Lf(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Cf(Of(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Lf(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=Lf(this.remaining);e&&(i=e,this.capture(i))}e[Of(t)]=Of(i)}parseQueryParam(e){const t=function(e){const t=e.match(Bf);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(Ff);return t?t[0]:""}(this.remaining);e&&(i=e,this.capture(i))}const n=Nf(t),r=Nf(i);if(e.hasOwnProperty(n)){let t=e[n];Array.isArray(t)||(t=[t],e[n]=t),t.push(r)}else e[n]=r}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Lf(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let r=void 0;i.indexOf(":")>-1?(r=i.substr(0,i.indexOf(":")),this.capture(r),this.capture(":")):e&&(r="primary");const s=this.parseChildren();t[r]=1===Object.keys(s).length?s.primary:new wf([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Vf{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Uf(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=Uf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=qf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return qf(e,this._root).map(e=>e.value)}}function Uf(e,t){if(e===t.value)return t;for(const i of t.children){const t=Uf(e,i);if(t)return t}return null}function qf(e,t){if(e===t.value)return[t];for(const i of t.children){const n=qf(e,i);if(n.length)return n.unshift(t),n}return[]}class Hf{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Gf(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class Wf extends Vf{constructor(e,t){super(e),this.snapshot=t,Jf(this,e)}toString(){return this.snapshot.toString()}}function Zf(e,t){const i=function(e,t){const i=new Kf([],{},{},"",{},"primary",t,null,e.root,-1,{});return new Yf("",new Hf(i,[]))}(e,t),n=new Hp([new Cf("",{})]),r=new Hp({}),s=new Hp({}),o=new Hp({}),a=new Hp(""),l=new $f(n,r,o,a,s,"primary",t,i.root);return l.snapshot=i.root,new Wf(new Hf(l,[]),i)}class $f{constructor(e,t,i,n,r,s,o,a){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(B(e=>of(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(B(e=>of(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Xf(e,t="emptyOnly"){const i=e.pathFromRoot;let n=0;if("always"!==t)for(n=i.length-1;n>=1;){const e=i[n],t=i[n-1];if(e.routeConfig&&""===e.routeConfig.path)n--;else{if(t.component)break;n--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class Kf{constructor(e,t,i,n,r,s,o,a,l,c,h){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=of(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=of(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Yf extends Vf{constructor(e,t){super(t),this.url=e,Jf(this,t)}toString(){return Qf(this._root)}}function Jf(e,t){t.value._routerState=e,t.children.forEach(t=>Jf(e,t))}function Qf(e){const t=e.children.length>0?` { ${e.children.map(Qf).join(", ")} } `:"";return`${e.value}${t}`}function eg(e){if(e.snapshot){const t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,mf(t.queryParams,i.queryParams)||e.queryParams.next(i.queryParams),t.fragment!==i.fragment&&e.fragment.next(i.fragment),mf(t.params,i.params)||e.params.next(i.params),function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!mf(e[i],t[i]))return!1;return!0}(t.url,i.url)||e.url.next(i.url),mf(t.data,i.data)||e.data.next(i.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function tg(e,t){var i,n;return mf(e.params,t.params)&&Sf(i=e.url,n=t.url)&&i.every((e,t)=>mf(e.parameters,n[t].parameters))&&!(!e.parent!=!t.parent)&&(!e.parent||tg(e.parent,t.parent))}function ig(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function ng(e,t,i,n,r){let s={};return n&&yf(n,(e,t)=>{s[t]=Array.isArray(e)?e.map(e=>""+e):""+e}),new bf(i.root===e?t:function e(t,i,n){const r={};return yf(t.children,(t,s)=>{r[s]=t===i?n:e(t,i,n)}),new wf(t.segments,r)}(i.root,e,t),s,r)}class rg{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&ig(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find(e=>"object"==typeof e&&null!=e&&e.outlets);if(n&&n!==_f(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class sg{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function og(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets.primary:""+e}function ag(e,t,i){if(e||(e=new wf([],{})),0===e.segments.length&&e.hasChildren())return lg(e,t,i);const n=function(e,t,i){let n=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(n>=i.length)return s;const t=e.segments[r],o=og(i[n]),a=n<i.length-1?i[n+1]:null;if(r>0&&void 0===o)break;if(o&&a&&"object"==typeof a&&void 0===a.outlets){if(!dg(o,a,t))return s;n+=2}else{if(!dg(o,{},t))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(e,t,i),r=i.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){const t=new wf(e.segments.slice(0,n.pathIndex),{});return t.children.primary=new wf(e.segments.slice(n.pathIndex),e.children),lg(t,0,r)}return n.match&&0===r.length?new wf(e.segments,{}):n.match&&!e.hasChildren()?cg(e,t,i):n.match?lg(e,0,r):cg(e,t,i)}function lg(e,t,i){if(0===i.length)return new wf(e.segments,{});{const n=function(e){return"object"!=typeof e[0]||void 0===e[0].outlets?{primary:e}:e[0].outlets}(i),r={};return yf(n,(i,n)=>{null!==i&&(r[n]=ag(e.children[n],t,i))}),yf(e.children,(e,t)=>{void 0===n[t]&&(r[t]=e)}),new wf(e.segments,r)}}function cg(e,t,i){const n=e.segments.slice(0,t);let r=0;for(;r<i.length;){if("object"==typeof i[r]&&void 0!==i[r].outlets){const e=hg(i[r].outlets);return new wf(n,e)}if(0===r&&ig(i[0])){n.push(new Cf(e.segments[t].path,i[0])),r++;continue}const s=og(i[r]),o=r<i.length-1?i[r+1]:null;s&&o&&ig(o)?(n.push(new Cf(s,ug(o))),r+=2):(n.push(new Cf(s,{})),r++)}return new wf(n,{})}function hg(e){const t={};return yf(e,(e,i)=>{null!==e&&(t[i]=cg(new wf([],{}),0,e))}),t}function ug(e){const t={};return yf(e,(e,i)=>t[i]=""+e),t}function dg(e,t,i){return e==i.path&&mf(t,i.parameters)}class pg{constructor(e,t,i,n){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=n}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),eg(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const n=Gf(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,n[t],i),delete n[t]}),yf(n,(e,t)=>{this.deactivateRouteAndItsChildren(e,i)})}deactivateRoutes(e,t,i){const n=e.value,r=t?t.value:null;if(n===r)if(n.component){const r=i.getContext(n.outlet);r&&this.deactivateChildRoutes(e,t,r.children)}else this.deactivateChildRoutes(e,t,i);else r&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet);if(i&&i.outlet){const t=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:n})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet);if(i){const n=Gf(e),r=e.value.component?i.children:t;yf(n,(e,t)=>this.deactivateRouteAndItsChildren(e,r)),i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}}activateChildRoutes(e,t,i){const n=Gf(t);e.children.forEach(e=>{this.activateRoutes(e,n[e.value.outlet],i),this.forwardEvent(new tf(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Qm(e.value.snapshot))}activateRoutes(e,t,i){const n=e.value,r=t?t.value:null;if(eg(n),n===r)if(n.component){const r=i.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,r.children)}else this.activateChildRoutes(e,t,i);else if(n.component){const t=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const e=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),mg(e.route)}else{const i=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(n.snapshot),r=i?i.module.componentFactoryResolver:null;t.attachRef=null,t.route=n,t.resolver=r,t.outlet&&t.outlet.activateWith(n,r),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,i)}}function mg(e){eg(e.value),e.children.forEach(mg)}function fg(e){return"function"==typeof e}function gg(e){return e instanceof bf}class _g{constructor(e){this.segmentGroup=e||null}}class yg{constructor(e){this.urlTree=e}}function vg(e){return new b(t=>t.error(new _g(e)))}function xg(e){return new b(t=>t.error(new yg(e)))}function bg(e){return new b(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class wg{constructor(e,t,i,n,r){this.configLoader=t,this.urlSerializer=i,this.urlTree=n,this.config=r,this.allowRedirects=!0,this.ngModule=e.get(tt)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(B(e=>this.createUrlTree(e,this.urlTree.queryParams,this.urlTree.fragment))).pipe(fm(e=>{if(e instanceof yg)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof _g)throw this.noMatchError(e);throw e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(B(t=>this.createUrlTree(t,e.queryParams,e.fragment))).pipe(fm(e=>{if(e instanceof _g)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const n=e.segments.length>0?new wf([],{primary:e}):e;return new bf(n,t,i)}expandSegmentGroup(e,t,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(B(e=>new wf([],e))):this.expandSegment(e,i,t,i.segments,n,!0)}expandChildren(e,t,i){return function(e,t){if(0===Object.keys(e).length)return qp({});const i=[],n=[],r={};return yf(e,(e,s)=>{const o=t(s,e).pipe(B(e=>r[s]=e));"primary"===s?i.push(o):n.push(o)}),qp.apply(null,i.concat(n)).pipe(Qp(),mm(),B(()=>r))}(i.children,(i,n)=>this.expandSegmentGroup(e,t,n,i))}expandSegment(e,t,i,n,r,s){return qp(...i).pipe(B(o=>this.expandSegmentAgainstRoute(e,t,i,o,n,r,s).pipe(fm(e=>{if(e instanceof _g)return qp(null);throw e}))),Qp(),bm(e=>!!e),fm((e,i)=>{if(e instanceof Gp||"EmptyError"===e.name){if(this.noLeftoversInUrl(t,n,r))return qp(new wf([],{}));throw new _g(t)}throw e}))}noLeftoversInUrl(e,t,i){return 0===t.length&&!e.children[i]}expandSegmentAgainstRoute(e,t,i,n,r,s,o){return Tg(n)!==s?vg(t):void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,t,n,r):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s):vg(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,n,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,n){const r=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?xg(r):this.lineralizeSegments(i,r).pipe(q(i=>{const r=new wf(i,{});return this.expandSegment(e,r,t,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Cg(t,n,r);if(!o)return vg(t);const h=this.applyRedirectCommands(a,n.redirectTo,c);return n.redirectTo.startsWith("/")?xg(h):this.lineralizeSegments(n,h).pipe(q(n=>this.expandSegment(e,t,i,n.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(e,t,i,n){if("**"===i.path)return i.loadChildren?this.configLoader.load(e.injector,i).pipe(B(e=>(i._loadedConfig=e,new wf(n,{})))):qp(new wf(n,{}));const{matched:r,consumedSegments:s,lastChild:o}=Cg(t,i,n);if(!r)return vg(t);const a=n.slice(o);return this.getChildConfig(e,i,n).pipe(q(e=>{const i=e.module,n=e.routes,{segmentGroup:r,slicedSegments:o}=function(e,t,i,n){return i.length>0&&function(e,t,i){return i.some(i=>Eg(e,t,i)&&"primary"!==Tg(i))}(e,i,n)?{segmentGroup:Sg(new wf(t,function(e,t){const i={};i.primary=t;for(const n of e)""===n.path&&"primary"!==Tg(n)&&(i[Tg(n)]=new wf([],{}));return i}(n,new wf(i,e.children)))),slicedSegments:[]}:0===i.length&&function(e,t,i){return i.some(i=>Eg(e,t,i))}(e,i,n)?{segmentGroup:Sg(new wf(e.segments,function(e,t,i,n){const r={};for(const s of i)Eg(e,t,s)&&!n[Tg(s)]&&(r[Tg(s)]=new wf([],{}));return Object.assign(Object.assign({},n),r)}(e,i,n,e.children))),slicedSegments:i}:{segmentGroup:e,slicedSegments:i}}(t,s,a,n);return 0===o.length&&r.hasChildren()?this.expandChildren(i,n,r).pipe(B(e=>new wf(s,e))):0===n.length&&0===o.length?qp(new wf(s,{})):this.expandSegment(i,r,n,o,"primary",!0).pipe(B(e=>new wf(s.concat(e.segments),e.children)))}))}getChildConfig(e,t,i){return t.children?qp(new cf(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?qp(t._loadedConfig):function(e,t,i){const n=t.canLoad;return n&&0!==n.length?U(n).pipe(B(n=>{const r=e.get(n);let s;if(function(e){return e&&fg(e.canLoad)}(r))s=r.canLoad(t,i);else{if(!fg(r))throw new Error("Invalid CanLoad guard");s=r(t,i)}return vf(s)})).pipe(Qp(),(r=e=>!0===e,e=>e.lift(new wm(r,void 0,e)))):qp(!0);var r}(e.injector,t,i).pipe(q(i=>i?this.configLoader.load(e.injector,t).pipe(B(e=>(t._loadedConfig=e,e))):function(e){return new b(t=>t.error(af(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`)))}(t))):qp(new cf([],e))}lineralizeSegments(e,t){let i=[],n=t.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return qp(i);if(n.numberOfChildren>1||!n.children.primary)return bg(e.redirectTo);n=n.children.primary}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,n){const r=this.createSegmentGroup(e,t.root,i,n);return new bf(r,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return yf(e,(e,n)=>{if("string"==typeof e&&e.startsWith(":")){const r=e.substring(1);i[n]=t[r]}else i[n]=e}),i}createSegmentGroup(e,t,i,n){const r=this.createSegments(e,t.segments,i,n);let s={};return yf(t.children,(t,r)=>{s[r]=this.createSegmentGroup(e,t,i,n)}),new wf(r,s)}createSegments(e,t,i,n){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,n):this.findOrReturn(t,i))}findPosParam(e,t,i){const n=i[t.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return n}findOrReturn(e,t){let i=0;for(const n of t){if(n.path===e.path)return t.splice(i),n;i++}return e}}function Cg(e,t,i){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||i.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const n=(t.matcher||lf)(i,e,t);return n?{matched:!0,consumedSegments:n.consumed,lastChild:n.consumed.length,positionalParamSegments:n.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Sg(e){if(1===e.numberOfChildren&&e.children.primary){const t=e.children.primary;return new wf(e.segments.concat(t.segments),t.children)}return e}function Eg(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0!==i.redirectTo}function Tg(e){return e.outlet||"primary"}class Pg{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Mg{constructor(e,t){this.component=e,this.route=t}}function kg(e,t,i){const n=e._root;return function e(t,i,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const o=Gf(i);return t.children.forEach(t=>{!function(t,i,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,a=i?i.value:null,l=n?n.getContext(t.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const c=function(e,t,i){if("function"==typeof i)return i(e,t);switch(i){case"pathParamsChange":return!Sf(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Sf(e.url,t.url)||!mf(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tg(e,t)||!mf(e.queryParams,t.queryParams);case"paramsChange":default:return!tg(e,t)}}(a,o,o.routeConfig.runGuardsAndResolvers);c?s.canActivateChecks.push(new Pg(r)):(o.data=a.data,o._resolvedData=a._resolvedData),e(t,i,o.component?l?l.children:null:n,r,s),c&&s.canDeactivateChecks.push(new Mg(l&&l.outlet&&l.outlet.component||null,a))}else a&&Ig(i,l,s),s.canActivateChecks.push(new Pg(r)),e(t,null,o.component?l?l.children:null:n,r,s)}(t,o[t.value.outlet],n,r.concat([t.value]),s),delete o[t.value.outlet]}),yf(o,(e,t)=>Ig(e,n.getContext(t),s)),s}(n,t?t._root:null,i,[n.value])}function Ag(e,t,i){const n=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(n?n.module.injector:i).get(e)}function Ig(e,t,i){const n=Gf(e),r=e.value;yf(n,(e,n)=>{Ig(e,r.component?t?t.children.getContext(n):null:t,i)}),i.canDeactivateChecks.push(new Mg(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}const Rg=Symbol("INITIAL_VALUE");function Og(){return Sm(e=>Zp(...e.map(e=>e.pipe(ym(1),Mm(Rg)))).pipe(km((e,t)=>{let i=!1;return t.reduce((e,n,r)=>{if(e!==Rg)return e;if(n===Rg&&(i=!0),!i){if(!1===n)return n;if(r===t.length-1||gg(n))return n}return e},e)},Rg),em(e=>e!==Rg),B(e=>gg(e)?e:!0===e),ym(1)))}function Ng(e,t){return null!==e&&t&&t(new ef(e)),qp(!0)}function Dg(e,t){return null!==e&&t&&t(new Jm(e)),qp(!0)}function zg(e,t,i){const n=t.routeConfig?t.routeConfig.canActivate:null;return n&&0!==n.length?qp(n.map(n=>Jp(()=>{const r=Ag(n,t,i);let s;if(function(e){return e&&fg(e.canActivate)}(r))s=vf(r.canActivate(t,e));else{if(!fg(r))throw new Error("Invalid CanActivate guard");s=vf(r(t,e))}return s.pipe(bm())}))).pipe(Og()):qp(!0)}function Lg(e,t,i){const n=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>Jp(()=>qp(t.guards.map(r=>{const s=Ag(r,t.node,i);let o;if(function(e){return e&&fg(e.canActivateChild)}(s))o=vf(s.canActivateChild(n,e));else{if(!fg(s))throw new Error("Invalid CanActivateChild guard");o=vf(s(n,e))}return o.pipe(bm())})).pipe(Og())));return qp(r).pipe(Og())}class Bg{}class Fg{constructor(e,t,i,n,r,s){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){try{const e=Ug(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary"),i=new Kf([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),n=new Hf(i,t),r=new Yf(this.url,n);return this.inheritParamsAndData(r._root),qp(r)}catch(e){return new b(t=>t.error(e))}}inheritParamsAndData(e){const t=e.value,i=Xf(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=Ef(t,(t,i)=>this.processSegmentGroup(e,t,i));return function(e){const t={};e.forEach(e=>{const i=t[e.value.outlet];if(i){const t=i.url.map(e=>e.toString()).join("/"),n=e.value.url.map(e=>e.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${t}' and '${n}'.`)}t[e.value.outlet]=e.value})}(i),i.sort((e,t)=>"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)),i}processSegment(e,t,i,n){for(const s of e)try{return this.processSegmentAgainstRoute(s,t,i,n)}catch(r){if(!(r instanceof Bg))throw r}if(this.noLeftoversInUrl(t,i,n))return[];throw new Bg}noLeftoversInUrl(e,t,i){return 0===t.length&&!e.children[i]}processSegmentAgainstRoute(e,t,i,n){if(e.redirectTo)throw new Bg;if((e.outlet||"primary")!==n)throw new Bg;let r,s=[],o=[];if("**"===e.path){const s=i.length>0?_f(i).parameters:{};r=new Kf(i,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Gg(e),n,e.component,e,jg(t),Vg(t)+i.length,Wg(e))}else{const a=function(e,t,i){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||i.length>0))throw new Bg;return{consumedSegments:[],lastChild:0,parameters:{}}}const n=(t.matcher||lf)(i,e,t);if(!n)throw new Bg;const r={};yf(n.posParams,(e,t)=>{r[t]=e.path});const s=n.consumed.length>0?Object.assign(Object.assign({},r),n.consumed[n.consumed.length-1].parameters):r;return{consumedSegments:n.consumed,lastChild:n.consumed.length,parameters:s}}(t,e,i);s=a.consumedSegments,o=i.slice(a.lastChild),r=new Kf(s,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Gg(e),n,e.component,e,jg(t),Vg(t)+s.length,Wg(e))}const a=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),{segmentGroup:l,slicedSegments:c}=Ug(t,s,o,a,this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const e=this.processChildren(a,l);return[new Hf(r,e)]}if(0===a.length&&0===c.length)return[new Hf(r,[])];const h=this.processSegment(a,l,c,"primary");return[new Hf(r,h)]}}function jg(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Vg(e){let t=e,i=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,i+=t._segmentIndexShift?t._segmentIndexShift:0;return i-1}function Ug(e,t,i,n,r){if(i.length>0&&function(e,t,i){return i.some(i=>qg(e,t,i)&&"primary"!==Hg(i))}(e,i,n)){const r=new wf(t,function(e,t,i,n){const r={};r.primary=n,n._sourceSegment=e,n._segmentIndexShift=t.length;for(const s of i)if(""===s.path&&"primary"!==Hg(s)){const i=new wf([],{});i._sourceSegment=e,i._segmentIndexShift=t.length,r[Hg(s)]=i}return r}(e,t,n,new wf(i,e.children)));return r._sourceSegment=e,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:[]}}if(0===i.length&&function(e,t,i){return i.some(i=>qg(e,t,i))}(e,i,n)){const s=new wf(e.segments,function(e,t,i,n,r,s){const o={};for(const a of n)if(qg(e,i,a)&&!r[Hg(a)]){const i=new wf([],{});i._sourceSegment=e,i._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[Hg(a)]=i}return Object.assign(Object.assign({},r),o)}(e,t,i,n,e.children,r));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:i}}const s=new wf(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:i}}function qg(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path&&void 0===i.redirectTo}function Hg(e){return e.outlet||"primary"}function Gg(e){return e.data||{}}function Wg(e){return e.resolve||{}}function Zg(e,t,i,n){const r=Ag(e,t,n);return vf(r.resolve?r.resolve(t,i):r(t,i))}function $g(e){return function(t){return t.pipe(Sm(t=>{const i=e(t);return i?U(i).pipe(B(()=>t)):U([t])}))}}class Xg{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}const Kg=new je("ROUTES");class Yg{constructor(e,t,i,n){this.loader=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=n}load(e,t){return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(B(i=>{this.onLoadEndListener&&this.onLoadEndListener(t);const n=i.create(e);return new cf(gf(n.injector.get(Kg)).map(pf),n)}))}loadModuleFactory(e){return"string"==typeof e?U(this.loader.load(e)):vf(e()).pipe(q(e=>e instanceof it?qp(e):U(this.compiler.compileModuleAsync(e))))}}class Jg{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function Qg(e){throw e}function e_(e,t,i){return t.parse("/")}function t_(e,t){return qp(null)}let i_=(()=>{class e{constructor(e,t,i,n,r,s,o,a){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=i,this.location=n,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new T,this.errorHandler=Qg,this.malformedUriErrorHandler=e_,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:t_,afterPreactivation:t_},this.urlHandlingStrategy=new Jg,this.routeReuseStrategy=new Xg,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=r.get(tt),this.console=r.get(cc);const l=r.get(Cc);this.isNgZoneEnabled=l instanceof Cc,this.resetConfig(a),this.currentUrlTree=new bf(new wf([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Yg(s,o,e=>this.triggerEvent(new Km(e)),e=>this.triggerEvent(new Ym(e))),this.routerState=Zf(this.currentUrlTree,this.rootComponentType),this.transitions=new Hp({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(e){const t=this.events;return e.pipe(em(e=>0!==e.id),B(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),Sm(e=>{let i=!1,n=!1;return qp(e).pipe(Nm(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Sm(e=>{const i=!this.navigated||e.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return qp(e).pipe(Sm(e=>{const i=this.transitions.getValue();return t.next(new Vm(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),i!==this.transitions.getValue()?Kp:[e]}),Sm(e=>Promise.resolve(e)),(n=this.ngModule.injector,r=this.configLoader,s=this.urlSerializer,o=this.config,function(e){return e.pipe(Sm(e=>function(e,t,i,n,r){return new wg(e,t,i,n,r).apply()}(n,r,s,e.extractedUrl,o).pipe(B(t=>Object.assign(Object.assign({},e),{urlAfterRedirects:t})))))}),Nm(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,i,n,r){return function(s){return s.pipe(q(s=>function(e,t,i,n,r="emptyOnly",s="legacy"){return new Fg(e,t,i,n,r,s).recognize()}(e,t,s.urlAfterRedirects,i(s.urlAfterRedirects),n,r).pipe(B(e=>Object.assign(Object.assign({},s),{targetSnapshot:e})))))}}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),Nm(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects)}),Nm(e=>{const i=new Gm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(i)}));var n,r,s,o;if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:r,restoredState:s,extras:o}=e,a=new Vm(i,this.serializeUrl(n),r,s);t.next(a);const l=Zf(n,this.rootComponentType).snapshot;return qp(Object.assign(Object.assign({},e),{targetSnapshot:l,urlAfterRedirects:n,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Kp}),$g(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),Nm(e=>{const t=new Wm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),B(e=>Object.assign(Object.assign({},e),{guards:kg(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return function(i){return i.pipe(q(i=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=i;return 0===o.length&&0===s.length?qp(Object.assign(Object.assign({},i),{guardsResult:!0})):function(e,t,i,n){return U(e).pipe(q(e=>function(e,t,i,n,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?qp(s.map(s=>{const o=Ag(s,t,r);let a;if(function(e){return e&&fg(e.canDeactivate)}(o))a=vf(o.canDeactivate(e,t,i,n));else{if(!fg(o))throw new Error("Invalid CanDeactivate guard");a=vf(o(e,t,i,n))}return a.pipe(bm())})).pipe(Og()):qp(!0)}(e.component,e.route,i,t,n)),bm(e=>!0!==e,!0))}(o,n,r,e).pipe(q(i=>i&&"boolean"==typeof i?function(e,t,i,n){return U(t).pipe(Rm(t=>U([Dg(t.route.parent,n),Ng(t.route,n),Lg(e,t.path,i),zg(e,t.route,i)]).pipe(Qp(),bm(e=>!0!==e,!0))),bm(e=>!0!==e,!0))}(n,s,e,t):qp(i)),B(e=>Object.assign(Object.assign({},i),{guardsResult:e})))}))}}(this.ngModule.injector,e=>this.triggerEvent(e)),Nm(e=>{if(gg(e.guardsResult)){const t=af(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}}),Nm(e=>{const t=new Zm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),em(e=>{if(!e.guardsResult){this.resetUrlToCurrentUrlTree();const i=new qm(e.id,this.serializeUrl(e.extractedUrl),"");return t.next(i),e.resolve(!1),!1}return!0}),$g(e=>{if(e.guards.canActivateChecks.length)return qp(e).pipe(Nm(e=>{const t=new $m(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),(t=this.paramsInheritanceStrategy,i=this.ngModule.injector,function(e){return e.pipe(q(e=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=e;return r.length?U(r).pipe(Rm(e=>function(e,t,i,n){return function(e,t,i,n){const r=Object.keys(e);if(0===r.length)return qp({});if(1===r.length){const s=r[0];return Zg(e[s],t,i,n).pipe(B(e=>({[s]:e})))}const s={};return U(r).pipe(q(r=>Zg(e[r],t,i,n).pipe(B(e=>(s[r]=e,e))))).pipe(mm(),B(()=>s))}(e._resolve,e,t,n).pipe(B(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Xf(e,i).resolve),null)))}(e.route,n,t,i)),function(e,t){return arguments.length>=2?function(i){return v(km(e,t),rm(1),um(t))(i)}:function(t){return v(km((t,i,n)=>e(t,i,n+1)),rm(1))(t)}}((e,t)=>e),B(t=>e)):qp(e)}))}),Nm(e=>{const t=new Xm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}));var t,i}),$g(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),B(e=>{const t=function(e,t,i){const n=function e(t,i,n){if(n&&t.shouldReuseRoute(i.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=i.value;const s=function(t,i,n){return i.children.map(i=>{for(const r of n.children)if(t.shouldReuseRoute(r.value.snapshot,i.value))return e(t,i,r);return e(t,i)})}(t,i,n);return new Hf(r,s)}{const n=t.retrieve(i.value);if(n){const e=n.route;return function e(t,i){if(t.value.routeConfig!==i.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==i.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");i.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)e(t.children[n],i.children[n])}(i,e),e}{const n=new $f(new Hp((r=i.value).url),new Hp(r.params),new Hp(r.queryParams),new Hp(r.fragment),new Hp(r.data),r.outlet,r.component,r),s=i.children.map(i=>e(t,i));return new Hf(n,s)}}var r}(e,t._root,i?i._root:void 0);return new Wf(n,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),Nm(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects)}),(r=this.rootContexts,s=this.routeReuseStrategy,o=e=>this.triggerEvent(e),B(e=>(new pg(s,e.targetRouterState,e.currentRouterState,o).activate(r),e))),Nm({next(){i=!0},complete(){i=!0}}),Lm(()=>{if(!i&&!n){this.resetUrlToCurrentUrlTree();const i=new qm(e.id,this.serializeUrl(e.extractedUrl),`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`);t.next(i),e.resolve(!1)}this.currentNavigation=null}),fm(i=>{if(n=!0,(r=i)&&r.ngNavigationCancelingError){const n=gg(i.url);n||(this.navigated=!0,this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));const r=new qm(e.id,this.serializeUrl(e.extractedUrl),i.message);t.next(r),n?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);return this.scheduleNavigation(t,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);const n=new Hm(e.id,this.serializeUrl(e.extractedUrl),i);t.next(n);try{e.resolve(this.errorHandler(i))}catch(s){e.reject(s)}}var r;return Kp}));var r,s,o}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{let t=this.parseUrl(e.url);const i="popstate"===e.type?"popstate":"hashchange",n=e.state&&e.state.navigationId?e.state:null;setTimeout(()=>{this.scheduleNavigation(t,i,n,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){hf(e),this.config=e.map(pf),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(e,t={}){const{relativeTo:i,queryParams:n,fragment:r,preserveQueryParams:s,queryParamsHandling:o,preserveFragment:a}=t;En()&&s&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=i||this.routerState.root,c=a?this.currentUrlTree.fragment:r;let h=null;if(o)switch(o){case"merge":h=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=n||null}else h=s?this.currentUrlTree.queryParams:n||null;return null!==h&&(h=this.removeEmptyProps(h)),function(e,t,i,n,r){if(0===i.length)return ng(t.root,t.root,t,n,r);const s=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new rg(!0,0,e);let t=0,i=!1;const n=e.reduce((e,n,r)=>{if("object"==typeof n&&null!=n){if(n.outlets){const t={};return yf(n.outlets,(e,i)=>{t[i]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(n.segmentPath)return[...e,n.segmentPath]}return"string"!=typeof n?[...e,n]:0===r?(n.split("/").forEach((n,r)=>{0==r&&"."===n||(0==r&&""===n?i=!0:".."===n?t++:""!=n&&e.push(n))}),e):[...e,n]},[]);return new rg(i,t,n)}(i);if(s.toRoot())return ng(t.root,new wf([],{}),t,n,r);const o=function(e,t,i){if(e.isAbsolute)return new sg(t.root,!0,0);if(-1===i.snapshot._lastPathIndex)return new sg(i.snapshot._urlSegment,!0,0);const n=ig(e.commands[0])?0:1;return function(e,t,i){let n=e,r=t,s=i;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new sg(n,!1,r-s)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?lg(o.segmentGroup,o.index,s.commands):ag(o.segmentGroup,o.index,s.commands);return ng(o.segmentGroup,a,t,n,r)}(l,this.currentUrlTree,e,h,c)}navigateByUrl(e,t={skipLocationChange:!1}){En()&&this.isNgZoneEnabled&&!Cc.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const i=gg(e)?e:this.parseUrl(e),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const i=e[t];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(i){t=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return t}isActive(e,t){if(gg(e))return xf(this.currentUrlTree,e,t);const i=this.parseUrl(e);return xf(this.currentUrlTree,i,t)}removeEmptyProps(e){return Object.keys(e).reduce((t,i)=>{const n=e[i];return null!=n&&(t[i]=n),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.events.next(new Um(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,e.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(e,t,i,n,r){const s=this.getTransition();if(s&&"imperative"!==t&&"imperative"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(s&&"hashchange"==t&&"popstate"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(s&&"popstate"==t&&"hashchange"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);let o,a,l;r?(o=r.resolve,a=r.reject,l=r.promise):l=new Promise((e,t)=>{o=e,a=t});const c=++this.navigationId;return this.setTransition({id:c,source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:n,resolve:o,reject:a,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(e=>Promise.reject(e))}setBrowserUrl(e,t,i,n){const r=this.urlSerializer.serialize(e);n=n||{},this.location.isCurrentPathEqualTo(r)||t?this.location.replaceState(r,"",Object.assign(Object.assign({},n),{navigationId:i})):this.location.go(r,"",Object.assign(Object.assign({},n),{navigationId:i}))}resetStateAndUrl(e,t,i){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return e.\u0275fac=function(e){To()},e.\u0275dir=bt({type:e}),e})(),n_=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.route=t,this.commands=[],null==i&&n.setAttribute(r.nativeElement,"tabindex","0")}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}set preserveQueryParams(e){En()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated!, use queryParamsHandling instead."),this.preserve=e}onClick(){const e={skipLocationChange:s_(this.skipLocationChange),replaceUrl:s_(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:s_(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:s_(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(So(i_),So($f),Eo("tabindex"),So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Lo("click",(function(){return t.onClick()}))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"}}),e})(),r_=(()=>{class e{constructor(e,t,i){this.router=e,this.route=t,this.locationStrategy=i,this.commands=[],this.subscription=e.events.subscribe(e=>{e instanceof Um&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}set preserveQueryParams(e){En()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e}ngOnChanges(e){this.updateTargetUrlAndHref()}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,t,i,n){if(0!==e||t||i||n)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const r={skipLocationChange:s_(this.skipLocationChange),replaceUrl:s_(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,r),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:s_(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:s_(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(So(i_),So($f),So(uh))},e.\u0275dir=bt({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Lo("click",(function(e){return t.onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)})),2&e&&(ga("href",t.href,Kn),xo("target",t.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[Ea]}),e})();function s_(e){return""===e||!!e}let o_=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.element=t,this.renderer=i,this.link=n,this.linkWithHref=r,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.subscription=e.events.subscribe(e=>{e instanceof Um&&this.update()})}ngAfterContentInit(){this.links.changes.subscribe(e=>this.update()),this.linksWithHrefs.changes.subscribe(e=>this.update()),this.update()}set routerLinkActive(e){const t=Array.isArray(e)?e:e.split(" ");this.classes=t.filter(e=>!!e)}ngOnChanges(e){this.update()}ngOnDestroy(){this.subscription.unsubscribe()}update(){this.links&&this.linksWithHrefs&&this.router.navigated&&Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.classes.forEach(t=>{e?this.renderer.addClass(this.element.nativeElement,t):this.renderer.removeClass(this.element.nativeElement,t)}))})}isLinkActive(e){return t=>e.isActive(t.urlTree,this.routerLinkActiveOptions.exact)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}return e.\u0275fac=function(t){return new(t||e)(So(i_),So(Fa),So(qa),So(n_,8),So(r_,8))},e.\u0275dir=bt({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(e,t,i){var n;1&e&&($l(i,n_,!0),$l(i,r_,!0)),2&e&&(Hl(n=Yl())&&(t.links=n),Hl(n=Yl())&&(t.linksWithHrefs=n))},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[Ea]}),e})();class a_{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new l_,this.attachRef=null}}class l_{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new a_,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let c_=(()=>{class e{constructor(e,t,i,n,r){this.parentContexts=e,this.location=t,this.resolver=i,this.changeDetector=r,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ol,this.deactivateEvents=new Ol,this.name=n||"primary",e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const i=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,r=new h_(e,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(So(l_),So(ul),So(Ba),Eo("name"),So(qs))},e.\u0275dir=bt({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class h_{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===$f?this.route:e===l_?this.childContexts:this.parent.get(e,t)}}class u_{}class d_{preload(e,t){return qp(null)}}let p_=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.injector=n,this.preloadingStrategy=r,this.loader=new Yg(t,i,t=>e.triggerEvent(new Km(t)),t=>e.triggerEvent(new Ym(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(em(e=>e instanceof Um),Rm(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(tt);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(e,t){const i=[];for(const n of t)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const e=n._loadedConfig;i.push(this.processRoutes(e.module,e.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(e,n)):n.children&&i.push(this.processRoutes(e,n.children));return U(i).pipe(W(),B(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>this.loader.load(e.injector,t).pipe(q(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(Ke(i_),Ke(Gc),Ke(vc),Ke(so),Ke(u_))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),m_=(()=>{class e{constructor(e,t,i={}){this.router=e,this.viewportScroller=t,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Vm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Um&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof nf&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new nf(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(e){To()},e.\u0275dir=bt({type:e}),e})();const f_=new je("ROUTER_CONFIGURATION"),g_=new je("ROUTER_FORROOT_GUARD"),__=[gh,{provide:Tf,useClass:Pf},{provide:i_,useFactory:function(e,t,i,n,r,s,o,a={},l,c){const h=new i_(null,e,t,i,n,r,s,gf(o));if(l&&(h.urlHandlingStrategy=l),c&&(h.routeReuseStrategy=c),a.errorHandler&&(h.errorHandler=a.errorHandler),a.malformedUriErrorHandler&&(h.malformedUriErrorHandler=a.malformedUriErrorHandler),a.enableTracing){const e=eh();h.events.subscribe(t=>{e.logGroup("Router Event: "+t.constructor.name),e.log(t.toString()),e.log(t),e.logGroupEnd()})}return a.onSameUrlNavigation&&(h.onSameUrlNavigation=a.onSameUrlNavigation),a.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=a.paramsInheritanceStrategy),a.urlUpdateStrategy&&(h.urlUpdateStrategy=a.urlUpdateStrategy),a.relativeLinkResolution&&(h.relativeLinkResolution=a.relativeLinkResolution),h},deps:[Tf,l_,gh,so,Gc,vc,Kg,f_,[class{},new oe],[class{},new oe]]},l_,{provide:$f,useFactory:function(e){return e.routerState.root},deps:[i_]},{provide:Gc,useClass:$c},p_,d_,class{preload(e,t){return t().pipe(fm(()=>qp(null)))}},{provide:f_,useValue:{enableTracing:!1}}];function y_(){return new Bc("Router",i_)}let v_=(()=>{class e{constructor(e,t){}static forRoot(t,i){return{ngModule:e,providers:[__,C_(t),{provide:g_,useFactory:w_,deps:[[i_,new oe,new le]]},{provide:f_,useValue:i||{}},{provide:uh,useFactory:b_,deps:[ih,[new se(ph),new oe],f_]},{provide:m_,useFactory:x_,deps:[i_,jh,f_]},{provide:u_,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:d_},{provide:Bc,multi:!0,useFactory:y_},[S_,{provide:tc,multi:!0,useFactory:E_,deps:[S_]},{provide:P_,useFactory:T_,deps:[S_]},{provide:lc,multi:!0,useExisting:P_}]]}}static forChild(t){return{ngModule:e,providers:[C_(t)]}}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)(Ke(g_,8),Ke(i_,8))}}),e})();function x_(e,t,i){return i.scrollOffset&&t.setOffset(i.scrollOffset),new m_(e,t,i)}function b_(e,t,i={}){return i.useHash?new fh(e,t):new mh(e,t)}function w_(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function C_(e){return[{provide:oo,multi:!0,useValue:e},{provide:Kg,multi:!0,useValue:e}]}let S_=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new T}appInitializer(){return this.injector.get(rh,Promise.resolve(null)).then(()=>{let e=null;const t=new Promise(t=>e=t),i=this.injector.get(i_),n=this.injector.get(f_);if(this.isLegacyDisabled(n)||this.isLegacyEnabled(n))e(!0);else if("disabled"===n.initialNavigation)i.setUpLocationChangeListener(),e(!0);else{if("enabled"!==n.initialNavigation)throw new Error(`Invalid initialNavigation options: '${n.initialNavigation}'`);i.hooks.afterPreactivation=()=>this.initNavigation?qp(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),i.initialNavigation()}return t})}bootstrapListener(e){const t=this.injector.get(f_),i=this.injector.get(p_),n=this.injector.get(m_),r=this.injector.get(i_),s=this.injector.get(qc);e===s.components[0]&&(this.isLegacyEnabled(t)?r.initialNavigation():this.isLegacyDisabled(t)&&r.setUpLocationChangeListener(),i.setUpPreloading(),n.init(),r.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}isLegacyDisabled(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}return e.\u0275fac=function(t){return new(t||e)(Ke(so))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function E_(e){return e.appInitializer.bind(e)}function T_(e){return e.bootstrapListener.bind(e)}const P_=new je("Router Initializer");let M_;try{M_="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(E0){M_=!1}let k_,A_=(()=>{class e{constructor(e){this._platformId=e,this.isBrowser=this._platformId?"browser"===this._platformId:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!M_)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return e.\u0275fac=function(t){return new(t||e)(Ke(ac,8))},e.\u0275prov=de({factory:function(){return new e(Ke(ac,8))},token:e,providedIn:"root"}),e})(),I_=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})();const R_=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function O_(){if(k_)return k_;if("object"!=typeof document||!document)return k_=new Set(R_),k_;let e=document.createElement("input");return k_=new Set(R_.filter(t=>(e.setAttribute("type",t),e.type===t))),k_}let N_,D_,z_;function L_(e){return function(){if(null==N_&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>N_=!0}))}finally{N_=N_||!1}return N_}()?e:!!e.capture}function B_(){if("object"!=typeof document||!document)return 0;if(null==D_){const e=document.createElement("div"),t=e.style;e.dir="rtl",t.height="1px",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const i=document.createElement("div"),n=i.style;n.width="2px",n.height="1px",e.appendChild(i),document.body.appendChild(e),D_=0,0===e.scrollLeft&&(e.scrollLeft=1,D_=0===e.scrollLeft?1:2),e.parentNode.removeChild(e)}return D_}function F_(e){if(function(){if(null==z_){const e="undefined"!=typeof document?document.head:null;z_=!(!e||!e.createShadowRoot&&!e.attachShadow)}return z_}()){const t=e.getRootNode?e.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function j_(e){return null!=e&&""+e!="false"}function V_(e,t=0){return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function U_(e){return Array.isArray(e)?e:[e]}function q_(e){return null==e?"":"string"==typeof e?e:e+"px"}function H_(e){return e instanceof Fa?e.nativeElement:e}function G_(e,t,i,n){return r(i)&&(n=i,i=void 0),n?G_(e,t,i).pipe(B(e=>c(e)?n(...e):n(e))):new b(n=>{!function e(t,i,n,r,s){let o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){const e=t;t.addEventListener(i,n,s),o=()=>e.removeEventListener(i,n,s)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){const e=t;t.on(i,n),o=()=>e.off(i,n)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){const e=t;t.addListener(i,n),o=()=>e.removeListener(i,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let o=0,a=t.length;o<a;o++)e(t[o],i,n,r,s)}r.add(o)}(e,t,(function(e){n.next(arguments.length>1?Array.prototype.slice.call(arguments):e)}),n,i)})}class W_ extends d{constructor(e,t){super()}schedule(e,t=0){return this}}class Z_ extends W_{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,n=void 0;try{this.work(e)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}class $_ extends Z_{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}}let X_=(()=>{class e{constructor(t,i=e.now){this.SchedulerAction=t,this.now=i}schedule(e,t=0,i){return new this.SchedulerAction(this,e).schedule(i,t)}}return e.now=()=>Date.now(),e})();class K_ extends X_{constructor(e,t=X_.now){super(e,()=>K_.delegate&&K_.delegate!==this?K_.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return K_.delegate&&K_.delegate!==this?K_.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}class Y_ extends K_{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,n=-1,r=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++n<r&&(e=t.shift()));if(this.active=!1,i){for(;++n<r&&(e=t.shift());)e.unsubscribe();throw i}}}const J_=new Y_($_);function Q_(e,t){return i=>i.lift(new ey(e,t))}class ey{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new ty(e,this.compare,this.keySelector))}}class ty extends f{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:i}=this;t=i?i(e):e}catch(n){return this.destination.error(n)}let i=!1;if(this.hasKey)try{const{compare:e}=this;i=e(this.key,t)}catch(n){return this.destination.error(n)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const iy=new K_(Z_);class ny{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new ry(e,this.durationSelector))}}class ry extends L{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1}_next(e){if(this.value=e,this.hasValue=!0,!this.throttled){let i;try{const{durationSelector:t}=this;i=t(e)}catch(t){return this.destination.error(t)}const n=z(this,i);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}clearThrottle(){const{value:e,hasValue:t,throttled:i}=this;i&&(this.remove(i),this.throttled=null,i.unsubscribe()),t&&(this.value=null,this.hasValue=!1,this.destination.next(e))}notifyNext(e,t,i,n){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function sy(e){return!c(e)&&e-parseFloat(e)+1>=0}function oy(e=0,t,i){let n=-1;return sy(t)?n=Number(t)<1?1:Number(t):M(t)&&(i=t),M(i)||(i=iy),new b(t=>{const r=sy(e)?e:+e-i.now();return i.schedule(ay,r,{index:0,period:n,subscriber:t})})}function ay(e){const{index:t,period:i,subscriber:n}=e;if(n.next(t),!n.closed){if(-1===i)return n.complete();e.index=t+1,this.schedule(e,i)}}function ly(e,t=iy){return i=()=>oy(e,t),function(e){return e.lift(new ny(i))};var i}function cy(e){return t=>t.lift(new hy(e))}class hy{constructor(e){this.notifier=e}call(e,t){const i=new uy(e),n=z(i,this.notifier);return n&&!i.seenValue?(i.add(n),t.subscribe(i)):i}}class uy extends L{constructor(e){super(e),this.seenValue=!1}notifyNext(e,t,i,n,r){this.seenValue=!0,this.complete()}notifyComplete(){}}const dy=new je("cdk-dir-doc",{providedIn:"root",factory:function(){return Ye(th)}});let py=(()=>{class e{constructor(e){if(this.value="ltr",this.change=new Ol,e){const t=e.documentElement?e.documentElement.dir:null,i=(e.body?e.body.dir:null)||t;this.value="ltr"===i||"rtl"===i?i:"ltr"}}ngOnDestroy(){this.change.complete()}}return e.\u0275fac=function(t){return new(t||e)(Ke(dy,8))},e.\u0275prov=de({factory:function(){return new e(Ke(dy,8))},token:e,providedIn:"root"}),e})(),my=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})();class fy{constructor(e=!1,t,i=!0){this._multiple=e,this._emitChanges=i,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new T,t&&t.length&&(e?t.forEach(e=>this._markSelected(e)):this._markSelected(t[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...e){this._verifyValueAssignment(e),e.forEach(e=>this._markSelected(e)),this._emitChangeEvent()}deselect(...e){this._verifyValueAssignment(e),e.forEach(e=>this._unmarkSelected(e)),this._emitChangeEvent()}toggle(e){this.isSelected(e)?this.deselect(e):this.select(e)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(e){return this._selection.has(e)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){this.isSelected(e)||(this._multiple||this._unmarkAll(),this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){if(e.length>1&&!this._multiple)throw Error("Cannot pass multiple values into SelectionModel with single-value mode.")}}let gy=(()=>{class e{constructor(){this._listeners=[]}notify(e,t){for(let i of this._listeners)i(e,t)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(t=>e!==t)}}ngOnDestroy(){this._listeners=[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})(),_y=(()=>{class e{constructor(e,t,i){this._ngZone=e,this._platform=t,this._scrolled=new T,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new b(t=>{this._globalSubscription||this._addGlobalListener();const i=e>0?this._scrolled.pipe(ly(e)).subscribe(t):this._scrolled.subscribe(t);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):qp()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,t)=>this.deregister(t)),this._scrolled.complete()}ancestorScrolled(e,t){const i=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(em(e=>!e||i.indexOf(e)>-1))}getAncestorScrollContainers(e){const t=[];return this.scrollContainers.forEach((i,n)=>{this._scrollableContainsElement(n,e)&&t.push(n)}),t}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_scrollableContainsElement(e,t){let i=t.nativeElement,n=e.getElementRef().nativeElement;do{if(i==n)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>G_(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return e.\u0275fac=function(t){return new(t||e)(Ke(Cc),Ke(A_),Ke(th,8))},e.\u0275prov=de({factory:function(){return new e(Ke(Cc),Ke(A_),Ke(th,8))},token:e,providedIn:"root"}),e})(),yy=(()=>{class e{constructor(e,t,i,n){this.elementRef=e,this.scrollDispatcher=t,this.ngZone=i,this.dir=n,this._destroyed=new T,this._elementScrolled=new b(e=>this.ngZone.runOutsideAngular(()=>G_(this.elementRef.nativeElement,"scroll").pipe(cy(this._destroyed)).subscribe(e)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const t=this.elementRef.nativeElement,i=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=i?e.end:e.start),null==e.right&&(e.right=i?e.start:e.end),null!=e.bottom&&(e.top=t.scrollHeight-t.clientHeight-e.bottom),i&&0!=B_()?(null!=e.left&&(e.right=t.scrollWidth-t.clientWidth-e.left),2==B_()?e.left=e.right:1==B_()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=t.scrollWidth-t.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const t=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?t.scrollTo(e):(null!=e.top&&(t.scrollTop=e.top),null!=e.left&&(t.scrollLeft=e.left))}measureScrollOffset(e){const t=this.elementRef.nativeElement;if("top"==e)return t.scrollTop;if("bottom"==e)return t.scrollHeight-t.clientHeight-t.scrollTop;const i=this.dir&&"rtl"==this.dir.value;return"start"==e?e=i?"right":"left":"end"==e&&(e=i?"left":"right"),i&&2==B_()?"left"==e?t.scrollWidth-t.clientWidth-t.scrollLeft:t.scrollLeft:i&&1==B_()?"left"==e?t.scrollLeft+t.scrollWidth-t.clientWidth:-t.scrollLeft:"left"==e?t.scrollLeft:t.scrollWidth-t.clientWidth-t.scrollLeft}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(_y),So(Cc),So(py,8))},e.\u0275dir=bt({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),e})(),vy=(()=>{class e{constructor(e,t,i){this._platform=e,this._document=i,t.runOutsideAngular(()=>{const t=this._getWindow();this._change=e.isBrowser?$(G_(t,"resize"),G_(t,"orientationchange")):qp(),this._invalidateCache=this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){this._invalidateCache.unsubscribe()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:t,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+t,height:i,width:t}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._getDocument(),t=this._getWindow(),i=e.documentElement,n=i.getBoundingClientRect();return{top:-n.top||e.body.scrollTop||t.scrollY||i.scrollTop||0,left:-n.left||e.body.scrollLeft||t.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(ly(e)):this._change}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return e.\u0275fac=function(t){return new(t||e)(Ke(A_),Ke(Cc),Ke(th,8))},e.\u0275prov=de({factory:function(){return new e(Ke(A_),Ke(Cc),Ke(th,8))},token:e,providedIn:"root"}),e})(),xy=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})(),by=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[my,I_,xy],my,xy]}),e})();function wy(e,...t){return t.length?t.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function Cy(e,t=iy){return i=>i.lift(new Sy(e,t))}class Sy{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new Ey(e,this.dueTime,this.scheduler))}}class Ey extends f{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Ty,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function Ty(e){e.debouncedNext()}let Py=(()=>{class e{create(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})(),My=(()=>{class e{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,t)=>this._cleanupObserver(t))}observe(e){const t=H_(e);return new b(e=>{const i=this._observeElement(t).subscribe(e);return()=>{i.unsubscribe(),this._unobserveElement(t)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const t=new T,i=this._mutationObserverFactory.create(e=>t.next(e));i&&i.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:i,stream:t,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:t,stream:i}=this._observedElements.get(e);t&&t.disconnect(),i.complete(),this._observedElements.delete(e)}}}return e.\u0275fac=function(t){return new(t||e)(Ke(Py))},e.\u0275prov=de({factory:function(){return new e(Ke(Py))},token:e,providedIn:"root"}),e})(),ky=(()=>{class e{constructor(e,t,i){this._contentObserver=e,this._elementRef=t,this._ngZone=i,this.event=new Ol,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=V_(e),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(Cy(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(So(My),So(Fa),So(Cc))},e.\u0275dir=bt({type:e,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),e})(),Ay=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[Py]}),e})();function Iy(e,t){return(e.getAttribute(t)||"").match(/\S+/g)||[]}let Ry=0;const Oy=new Map;let Ny=null,Dy=(()=>{class e{constructor(e){this._document=e}describe(e,t){this._canBeDescribed(e,t)&&("string"!=typeof t?(this._setMessageId(t),Oy.set(t,{messageElement:t,referenceCount:0})):Oy.has(t)||this._createMessageElement(t),this._isElementDescribedByMessage(e,t)||this._addMessageReference(e,t))}removeDescription(e,t){if(this._isElementNode(e)){if(this._isElementDescribedByMessage(e,t)&&this._removeMessageReference(e,t),"string"==typeof t){const e=Oy.get(t);e&&0===e.referenceCount&&this._deleteMessageElement(t)}Ny&&0===Ny.childNodes.length&&this._deleteMessagesContainer()}}ngOnDestroy(){const e=this._document.querySelectorAll("[cdk-describedby-host]");for(let t=0;t<e.length;t++)this._removeCdkDescribedByReferenceIds(e[t]),e[t].removeAttribute("cdk-describedby-host");Ny&&this._deleteMessagesContainer(),Oy.clear()}_createMessageElement(e){const t=this._document.createElement("div");this._setMessageId(t),t.textContent=e,this._createMessagesContainer(),Ny.appendChild(t),Oy.set(e,{messageElement:t,referenceCount:0})}_setMessageId(e){e.id||(e.id="cdk-describedby-message-"+Ry++)}_deleteMessageElement(e){const t=Oy.get(e),i=t&&t.messageElement;Ny&&i&&Ny.removeChild(i),Oy.delete(e)}_createMessagesContainer(){if(!Ny){const e=this._document.getElementById("cdk-describedby-message-container");e&&e.parentNode.removeChild(e),Ny=this._document.createElement("div"),Ny.id="cdk-describedby-message-container",Ny.setAttribute("aria-hidden","true"),Ny.style.display="none",this._document.body.appendChild(Ny)}}_deleteMessagesContainer(){Ny&&Ny.parentNode&&(Ny.parentNode.removeChild(Ny),Ny=null)}_removeCdkDescribedByReferenceIds(e){const t=Iy(e,"aria-describedby").filter(e=>0!=e.indexOf("cdk-describedby-message"));e.setAttribute("aria-describedby",t.join(" "))}_addMessageReference(e,t){const i=Oy.get(t);!function(e,t,i){const n=Iy(e,t);n.some(e=>e.trim()==i.trim())||(n.push(i.trim()),e.setAttribute(t,n.join(" ")))}(e,"aria-describedby",i.messageElement.id),e.setAttribute("cdk-describedby-host",""),i.referenceCount++}_removeMessageReference(e,t){const i=Oy.get(t);i.referenceCount--,function(e,t,i){const n=Iy(e,t).filter(e=>e!=i.trim());n.length?e.setAttribute(t,n.join(" ")):e.removeAttribute(t)}(e,"aria-describedby",i.messageElement.id),e.removeAttribute("cdk-describedby-host")}_isElementDescribedByMessage(e,t){const i=Iy(e,"aria-describedby"),n=Oy.get(t),r=n&&n.messageElement.id;return!!r&&-1!=i.indexOf(r)}_canBeDescribed(e,t){if(!this._isElementNode(e))return!1;if(t&&"object"==typeof t)return!0;const i=null==t?"":(""+t).trim(),n=e.getAttribute("aria-label");return!(!i||n&&n.trim()===i)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(th))},token:e,providedIn:"root"}),e})();class zy{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new T,this._typeaheadSubscription=d.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new T,this.change=new T,e instanceof Dl&&e.changes.subscribe(e=>{if(this._activeItem){const t=e.toArray().indexOf(this._activeItem);t>-1&&t!==this._activeItemIndex&&(this._activeItemIndex=t)}})}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){if(this._items.length&&this._items.some(e=>"function"!=typeof e.getLabel))throw Error("ListKeyManager items in typeahead mode must implement the `getLabel` method.");return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Nm(e=>this._pressedLetters.push(e)),Cy(e),em(()=>this._pressedLetters.length>0),B(()=>this._pressedLetters.join(""))).subscribe(e=>{const t=this._getItemsArray();for(let i=1;i<t.length+1;i++){const n=(this._activeItemIndex+i)%t.length,r=t[n];if(!this._skipPredicateFn(r)&&0===r.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(n);break}}this._pressedLetters=[]}),this}setActiveItem(e){const t=this._activeItemIndex;this.updateActiveItem(e),this._activeItemIndex!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,i=["altKey","ctrlKey","metaKey","shiftKey"].every(t=>!e[t]||this._allowedModifierKeys.indexOf(t)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&i){this.setNextItemActive();break}return;case 38:if(this._vertical&&i){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&i){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&i){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;default:return void((i||wy(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e),n=t[i];this._activeItem=null==n?null:n,this._activeItemIndex=i}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const n=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[n]))return void this.setActiveItem(n)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof Dl?this._items.toArray():this._items}}class Ly extends zy{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}}class By extends zy{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let Fy=(()=>{class e{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const t=function(e){try{return e.frameElement}catch(E0){return null}}((i=e).ownerDocument&&i.ownerDocument.defaultView||window);var i;if(t){const e=t&&t.nodeName.toLowerCase();if(-1===Vy(t))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===e)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(t))return!1}let n=e.nodeName.toLowerCase(),r=Vy(e);if(e.hasAttribute("contenteditable"))return-1!==r;if("iframe"===n)return!1;if("audio"===n){if(!e.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===n){if(!e.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==n||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(e){let t=e.nodeName.toLowerCase(),i="input"===t&&e.type;return"text"===i||"password"===i||"select"===t||"textarea"===t}(e))&&e.tabIndex>=0}isFocusable(e){return function(e){return!function(e){return function(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function(e){let t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(e)||function(e){return function(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||jy(e))}(e)&&!this.isDisabled(e)&&this.isVisible(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(A_))},e.\u0275prov=de({factory:function(){return new e(Ke(A_))},token:e,providedIn:"root"}),e})();function jy(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;let t=e.getAttribute("tabindex");return"-32768"!=t&&!(!t||isNaN(parseInt(t,10)))}function Vy(e){if(!jy(e))return null;const t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class Uy{constructor(e,t,i,n,r=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=n,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,r||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement()))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let i=0;i<t.length;i++)t[i].hasAttribute("cdk-focus-"+e)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]):t[i].hasAttribute("cdk-focus-region-"+e)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return e?(e.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",e),En()&&!this._checker.isFocusable(e)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",e),e.focus(),!0):this.focusFirstTabbableElement()}focusFirstTabbableElement(){const e=this._getRegionBoundary("start");return e&&e.focus(),!!e}focusLastTabbableElement(){const e=this._getRegionBoundary("end");return e&&e.focus(),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=0;i<t.length;i++){let e=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(e)return e}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=t.length-1;i>=0;i--){let e=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(e)return e}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.asObservable().pipe(ym(1)).subscribe(e)}}let qy=(()=>{class e{constructor(e,t,i){this._checker=e,this._ngZone=t,this._document=i}create(e,t=!1){return new Uy(e,this._checker,this._ngZone,this._document,t)}}return e.\u0275fac=function(t){return new(t||e)(Ke(Fy),Ke(Cc),Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(Fy),Ke(Cc),Ke(th))},token:e,providedIn:"root"}),e})();"undefined"!=typeof Element&&Element;const Hy=new je("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),Gy=new je("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Wy=(()=>{class e{constructor(e,t,i,n){this._ngZone=t,this._defaultOptions=n,this._document=i,this._liveElement=e||this._createLiveElement()}announce(e,...t){const i=this._defaultOptions;let n,r;return 1===t.length&&"number"==typeof t[0]?r=t[0]:[n,r]=t,this.clear(),clearTimeout(this._previousTimeout),n||(n=i&&i.politeness?i.politeness:"polite"),null==r&&i&&(r=i.duration),this._liveElement.setAttribute("aria-live",n),this._ngZone.runOutsideAngular(()=>new Promise(t=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,t(),"number"==typeof r&&(this._previousTimeout=setTimeout(()=>this.clear(),r))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const e=this._document.getElementsByClassName("cdk-live-announcer-element"),t=this._document.createElement("div");for(let i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i]);return t.classList.add("cdk-live-announcer-element"),t.classList.add("cdk-visually-hidden"),t.setAttribute("aria-atomic","true"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),t}}return e.\u0275fac=function(t){return new(t||e)(Ke(Hy,8),Ke(Cc),Ke(th),Ke(Gy,8))},e.\u0275prov=de({factory:function(){return new e(Ke(Hy,8),Ke(Cc),Ke(th),Ke(Gy,8))},token:e,providedIn:"root"}),e})();function Zy(e){return 0===e.buttons}const $y=new je("cdk-focus-monitor-default-options"),Xy=L_({passive:!0,capture:!0});let Ky=(()=>{class e{constructor(e,t,i,n){this._ngZone=e,this._platform=t,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=e=>{if(!this._lastTouchTarget){const t=Zy(e)?"keyboard":"mouse";this._setOriginForCurrentEventQueue(t)}},this._documentTouchstartListener=e=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=Yy(e),this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,650)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._rootNodeFocusAndBlurListener=e=>{const t=Yy(e),i="focus"===e.type?this._onFocus:this._onBlur;for(let n=t;n;n=n.parentElement)i.call(this,e,n)},this._document=i,this._detectionMode=(null==n?void 0:n.detectionMode)||0}monitor(e,t=!1){if(!this._platform.isBrowser)return qp(null);const i=H_(e),n=F_(i)||this._getDocument(),r=this._elementInfo.get(i);if(r)return t&&(r.checkChildren=!0),r.subject.asObservable();const s={checkChildren:t,subject:new T,rootNode:n};return this._elementInfo.set(i,s),this._registerGlobalListeners(s),s.subject.asObservable()}stopMonitoring(e){const t=H_(e),i=this._elementInfo.get(t);i&&(i.subject.complete(),this._setClasses(t),this._elementInfo.delete(t),this._removeGlobalListeners(i))}focusVia(e,t,i){const n=H_(e);this._setOriginForCurrentEventQueue(t),"function"==typeof n.focus&&n.focus(i)}ngOnDestroy(){this._elementInfo.forEach((e,t)=>this.stopMonitoring(t))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(e,t,i){i?e.classList.add(t):e.classList.remove(t)}_getFocusOrigin(e){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(e)?"touch":"program"}_setClasses(e,t){this._toggleClass(e,"cdk-focused",!!t),this._toggleClass(e,"cdk-touch-focused","touch"===t),this._toggleClass(e,"cdk-keyboard-focused","keyboard"===t),this._toggleClass(e,"cdk-mouse-focused","mouse"===t),this._toggleClass(e,"cdk-program-focused","program"===t)}_setOriginForCurrentEventQueue(e){this._ngZone.runOutsideAngular(()=>{this._origin=e,0===this._detectionMode&&(this._originTimeoutId=setTimeout(()=>this._origin=null,1))})}_wasCausedByTouch(e){const t=Yy(e);return this._lastTouchTarget instanceof Node&&t instanceof Node&&(t===this._lastTouchTarget||t.contains(this._lastTouchTarget))}_onFocus(e,t){const i=this._elementInfo.get(t);if(!i||!i.checkChildren&&t!==Yy(e))return;const n=this._getFocusOrigin(e);this._setClasses(t,n),this._emitOrigin(i.subject,n),this._lastFocusOrigin=n}_onBlur(e,t){const i=this._elementInfo.get(t);!i||i.checkChildren&&e.relatedTarget instanceof Node&&t.contains(e.relatedTarget)||(this._setClasses(t),this._emitOrigin(i.subject,null))}_emitOrigin(e,t){this._ngZone.run(()=>e.next(t))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const t=e.rootNode,i=this._rootNodeFocusListenerCount.get(t)||0;i||this._ngZone.runOutsideAngular(()=>{t.addEventListener("focus",this._rootNodeFocusAndBlurListener,Xy),t.addEventListener("blur",this._rootNodeFocusAndBlurListener,Xy)}),this._rootNodeFocusListenerCount.set(t,i+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular(()=>{const e=this._getDocument(),t=this._getWindow();e.addEventListener("keydown",this._documentKeydownListener,Xy),e.addEventListener("mousedown",this._documentMousedownListener,Xy),e.addEventListener("touchstart",this._documentTouchstartListener,Xy),t.addEventListener("focus",this._windowFocusListener)})}_removeGlobalListeners(e){const t=e.rootNode;if(this._rootNodeFocusListenerCount.has(t)){const e=this._rootNodeFocusListenerCount.get(t);e>1?this._rootNodeFocusListenerCount.set(t,e-1):(t.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Xy),t.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Xy),this._rootNodeFocusListenerCount.delete(t))}if(!--this._monitoredElementCount){const e=this._getDocument(),t=this._getWindow();e.removeEventListener("keydown",this._documentKeydownListener,Xy),e.removeEventListener("mousedown",this._documentMousedownListener,Xy),e.removeEventListener("touchstart",this._documentTouchstartListener,Xy),t.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}return e.\u0275fac=function(t){return new(t||e)(Ke(Cc),Ke(A_),Ke(th,8),Ke($y,8))},e.\u0275prov=de({factory:function(){return new e(Ke(Cc),Ke(A_),Ke(th,8),Ke($y,8))},token:e,providedIn:"root"}),e})();function Yy(e){return e.composedPath?e.composedPath()[0]:e.target}let Jy=(()=>{class e{constructor(e,t){this._elementRef=e,this._focusMonitor=t,this.cdkFocusChange=new Ol,this._monitorSubscription=this._focusMonitor.monitor(this._elementRef,this._elementRef.nativeElement.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(e=>this.cdkFocusChange.emit(e))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(Ky))},e.\u0275dir=bt({type:e,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),e})(),Qy=(()=>{class e{constructor(e,t){this._platform=e,this._document=t}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const t=this._document.defaultView||window,i=t&&t.getComputedStyle?t.getComputedStyle(e):null,n=(i&&i.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(e),n){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove("cdk-high-contrast-active"),e.remove("cdk-high-contrast-black-on-white"),e.remove("cdk-high-contrast-white-on-black");const t=this.getHighContrastMode();1===t?(e.add("cdk-high-contrast-active"),e.add("cdk-high-contrast-black-on-white")):2===t&&(e.add("cdk-high-contrast-active"),e.add("cdk-high-contrast-white-on-black"))}}}return e.\u0275fac=function(t){return new(t||e)(Ke(A_),Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(A_),Ke(th))},token:e,providedIn:"root"}),e})(),ev=(()=>{class e{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)(Ke(Qy))},imports:[[I_,Ay]]}),e})();const tv=new Wa("9.2.4"),iv=["*",[["mat-option"],["ng-container"]]],nv=["*","mat-option, ng-container"];function rv(e,t){if(1&e&&Io(0,"mat-pseudo-checkbox",3),2&e){const e=Uo();Po("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}const sv=["*"],ov=new Wa("9.2.4"),av=new je("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let lv=(()=>{class e{constructor(e,t,i){this._hasDoneGlobalChecks=!1,this._document=i,e._applyBodyHighContrastModeCssClasses(),this._sanityChecks=t,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getDocument(){const e=this._document||document;return"object"==typeof e&&e?e:null}_getWindow(){const e=this._getDocument(),t=(null==e?void 0:e.defaultView)||window;return"object"==typeof t&&t?t:null}_checksAreEnabled(){return En()&&!this._isTestEnv()}_isTestEnv(){const e=this._getWindow();return e&&(e.__karma__||e.jasmine)}_checkDoctypeIsDefined(){const e=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),t=this._getDocument();e&&t&&!t.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){const e=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,t=this._getDocument();if(e||!t||!t.body||"function"!=typeof getComputedStyle)return;const i=t.createElement("div");i.classList.add("mat-theme-loaded-marker"),t.body.appendChild(i);const n=getComputedStyle(i);n&&"none"!==n.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),t.body.removeChild(i)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&ov.full!==tv.full&&console.warn("The Angular Material version ("+ov.full+") does not match the Angular CDK version ("+tv.full+").\nPlease ensure the versions of these two packages exactly match.")}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)(Ke(Qy),Ke(av,8),Ke(th,8))},imports:[[my],my]}),e})();function cv(e){return class extends e{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e)}}}function hv(e,t){return class extends e{constructor(...e){super(...e),this.color=t}get color(){return this._color}set color(e){const i=e||t;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-"+this._color),i&&this._elementRef.nativeElement.classList.add("mat-"+i),this._color=i)}}}function uv(e){return class extends e{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=j_(e)}}}function dv(e,t=0){return class extends e{constructor(...e){super(...e),this._tabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?e:t}}}function pv(e){return class extends e{constructor(...e){super(...e),this.errorState=!1,this.stateChanges=new T}updateErrorState(){const e=this.errorState,t=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);t!==e&&(this.errorState=t,this.stateChanges.next())}}}const mv=new je("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return Ye(hc)}});class fv{constructor(){this._localeChanges=new T}get localeChanges(){return this._localeChanges}deserialize(e){return null==e||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}setLocale(e){this.locale=e,this._localeChanges.next()}compareDate(e,t){return this.getYear(e)-this.getYear(t)||this.getMonth(e)-this.getMonth(t)||this.getDate(e)-this.getDate(t)}sameDate(e,t){if(e&&t){let i=this.isValid(e),n=this.isValid(t);return i&&n?!this.compareDate(e,t):i==n}return e==t}clampDate(e,t,i){return t&&this.compareDate(e,t)<0?t:i&&this.compareDate(e,i)>0?i:e}}const gv=new je("mat-date-formats");let _v;try{_v="undefined"!=typeof Intl}catch(E0){_v=!1}const yv={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},vv=wv(31,e=>String(e+1)),xv={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},bv=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function wv(e,t){const i=Array(e);for(let n=0;n<e;n++)i[n]=t(n);return i}let Cv=(()=>{class e extends fv{constructor(e,t){super(),this.useUtcForDisplay=!0,super.setLocale(e),this.useUtcForDisplay=!t.TRIDENT,this._clampDate=t.TRIDENT||t.EDGE}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){if(_v){const t=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return wv(12,e=>this._stripDirectionalityCharacters(this._format(t,new Date(2017,e,1))))}return yv[e]}getDateNames(){if(_v){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return wv(31,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,0,t+1))))}return vv}getDayOfWeekNames(e){if(_v){const t=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return wv(7,e=>this._stripDirectionalityCharacters(this._format(t,new Date(2017,0,e+1))))}return xv[e]}getYearName(e){if(_v){const t=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(t,e))}return String(this.getYear(e))}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,t,i){if(t<0||t>11)throw Error(`Invalid month index "${t}". Month index has to be between 0 and 11.`);if(i<1)throw Error(`Invalid date "${i}". Date has to be greater than 0.`);let n=this._createDateWithOverflow(e,t,i);if(n.getMonth()!=t)throw Error(`Invalid date "${i}" for month with index "${t}".`);return n}today(){return new Date}parse(e){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,t){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");if(_v){this._clampDate&&(e.getFullYear()<1||e.getFullYear()>9999)&&(e=this.clone(e)).setFullYear(Math.max(1,Math.min(9999,e.getFullYear()))),t=Object.assign(Object.assign({},t),{timeZone:"utc"});const i=new Intl.DateTimeFormat(this.locale,t);return this._stripDirectionalityCharacters(this._format(i,e))}return this._stripDirectionalityCharacters(e.toDateString())}addCalendarYears(e,t){return this.addCalendarMonths(e,12*t)}addCalendarMonths(e,t){let i=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+t,this.getDate(e));return this.getMonth(i)!=((this.getMonth(e)+t)%12+12)%12&&(i=this._createDateWithOverflow(this.getYear(i),this.getMonth(i),0)),i}addCalendarDays(e,t){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+t)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(bv.test(e)){let t=new Date(e);if(this.isValid(t))return t}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,t,i){const n=new Date(e,t,i);return e>=0&&e<100&&n.setFullYear(this.getYear(n)-1900),n}_2digit(e){return("00"+e).slice(-2)}_stripDirectionalityCharacters(e){return e.replace(/[\u200e\u200f]/g,"")}_format(e,t){const i=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.format(i)}}return e.\u0275fac=function(t){return new(t||e)(Ke(mv,8),Ke(A_))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Sv=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[{provide:fv,useClass:Cv}],imports:[[I_]]}),e})();const Ev={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let Tv=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[{provide:gv,useValue:Ev}],imports:[[Sv]]}),e})(),Pv=(()=>{class e{isErrorState(e,t){return!!(e&&e.invalid&&(e.touched||t&&t.submitted))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})(),Mv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),e})();function kv(e,t,i){const n=e.nativeElement.classList;i?n.add(t):n.remove(t)}let Av=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv],lv]}),e})();class Iv{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const Rv={enterDuration:450,exitDuration:400},Ov=L_({passive:!0}),Nv=["mousedown","touchstart"],Dv=["mouseup","mouseleave","touchend","touchcancel"];class zv{constructor(e,t,i,n){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,n.isBrowser&&(this._containerElement=H_(i))}fadeInRipple(e,t,i={}){const n=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),r=Object.assign(Object.assign({},Rv),i.animation);i.centered&&(e=n.left+n.width/2,t=n.top+n.height/2);const s=i.radius||function(e,t,i){const n=Math.max(Math.abs(e-i.left),Math.abs(e-i.right)),r=Math.max(Math.abs(t-i.top),Math.abs(t-i.bottom));return Math.sqrt(n*n+r*r)}(e,t,n),o=e-n.left,a=t-n.top,l=r.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=o-s+"px",c.style.top=a-s+"px",c.style.height=2*s+"px",c.style.width=2*s+"px",null!=i.color&&(c.style.backgroundColor=i.color),c.style.transitionDuration=l+"ms",this._containerElement.appendChild(c),window.getComputedStyle(c).getPropertyValue("opacity"),c.style.transform="scale(1)";const h=new Iv(this,c,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone(()=>{const e=h===this._mostRecentTransientRipple;h.state=1,i.persistent||e&&this._isPointerDown||h.fadeOut()},l),h}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,n=Object.assign(Object.assign({},Rv),e.config.animation);i.style.transitionDuration=n.exitDuration+"ms",i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},n.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}setupTriggerEvents(e){const t=H_(e);t&&t!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(Nv))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(Dv),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=Zy(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||t||i||(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let e=0;e<t.length;e++)this.fadeInRipple(t[e].clientX,t[e].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(e=>{this._triggerElement.addEventListener(e,this,Ov)})})}_removeTriggerEvents(){this._triggerElement&&(Nv.forEach(e=>{this._triggerElement.removeEventListener(e,this,Ov)}),this._pointerUpEventsRegistered&&Dv.forEach(e=>{this._triggerElement.removeEventListener(e,this,Ov)}))}}const Lv=new je("mat-ripple-global-options");let Bv=(()=>{class e{constructor(e,t,i,n,r){this._elementRef=e,this._animationMode=r,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=n||{},this._rippleRenderer=new zv(this,t,e,i)}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,t=0,i){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,t,Object.assign(Object.assign({},this.rippleConfig),i)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),e))}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(Cc),So(A_),So(Lv,8),So(jp,8))},e.\u0275dir=bt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,t){2&e&&ia("mat-ripple-unbounded",t.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),e})(),Fv=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv,I_],lv]}),e})(),jv=(()=>{class e{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1}}return e.\u0275fac=function(t){return new(t||e)(So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,t){2&e&&ia("mat-pseudo-checkbox-indeterminate","indeterminate"===t.state)("mat-pseudo-checkbox-checked","checked"===t.state)("mat-pseudo-checkbox-disabled",t.disabled)("_mat-animation-noopable","NoopAnimations"===t._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),e})(),Vv=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})();class Uv{}const qv=cv(Uv);let Hv=0,Gv=(()=>{class e extends qv{constructor(){super(...arguments),this._labelId="mat-optgroup-label-"+Hv++}}return e.\u0275fac=function(t){return Wv(t||e)},e.\u0275cmp=ft({type:e,selectors:[["mat-optgroup"]],hostAttrs:["role","group",1,"mat-optgroup"],hostVars:4,hostBindings:function(e,t){2&e&&(xo("aria-disabled",t.disabled.toString())("aria-labelledby",t._labelId),ia("mat-optgroup-disabled",t.disabled))},inputs:{disabled:"disabled",label:"label"},exportAs:["matOptgroup"],features:[va],ngContentSelectors:nv,decls:4,vars:2,consts:[[1,"mat-optgroup-label",3,"id"]],template:function(e,t){1&e&&(Ho(iv),ko(0,"label",0),pa(1),Go(2),Ao(),Go(3,1)),2&e&&(Po("id",t._labelId),gr(1),fa("",t.label," "))},styles:[".mat-optgroup-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup-label[disabled]{cursor:default}[dir=rtl] .mat-optgroup-label{text-align:right}.mat-optgroup-label .mat-icon{margin-right:16px;vertical-align:middle}.mat-optgroup-label .mat-icon svg{vertical-align:top}[dir=rtl] .mat-optgroup-label .mat-icon{margin-left:16px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),e})();const Wv=cn(Gv);let Zv=0;class $v{constructor(e,t=!1){this.source=e,this.isUserInput=t}}const Xv=new je("MAT_OPTION_PARENT_COMPONENT");let Kv=(()=>{class e{constructor(e,t,i,n){this._element=e,this._changeDetectorRef=t,this._parent=i,this.group=n,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Zv++,this.onSelectionChange=new Ol,this._stateChanges=new T}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=j_(e)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,t){const i=this._getHostElement();"function"==typeof i.focus&&i.focus(t)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){13!==e.keyCode&&32!==e.keyCode||wy(e)||(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new $v(this,e))}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(Xv,8),So(Gv,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,t){1&e&&Lo("click",(function(){return t._selectViaInteraction()}))("keydown",(function(e){return t._handleKeydown(e)})),2&e&&(ga("id",t.id),xo("tabindex",t._getTabIndex())("aria-selected",t._getAriaSelected())("aria-disabled",t.disabled.toString()),ia("mat-selected",t.selected)("mat-option-multiple",t.multiple)("mat-active",t.active)("mat-option-disabled",t.disabled))},inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:sv,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(e,t){1&e&&(Ho(),wo(0,rv,1,2,"mat-pseudo-checkbox",0),ko(1,"span",1),Go(2),Ao(),Io(3,"div",2)),2&e&&(Po("ngIf",t.multiple),gr(3),Po("matRippleTrigger",t._getHostElement())("matRippleDisabled",t.disabled||t.disableRipple))},directives:[Ph,Bv,jv],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),e})();function Yv(e,t,i){if(i.length){let n=t.toArray(),r=i.toArray(),s=0;for(let t=0;t<e+1;t++)n[t].group&&n[t].group===r[s]&&s++;return s}return 0}let Jv=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fv,Fh,Vv]]}),e})();const Qv=new je("mat-label-global-options"),ex=["*"];function tx(e,t){if(1&e){const e=No();ko(0,"div",2),Lo("click",(function(){return Jt(e),Uo()._onBackdropClicked()})),Ao()}2&e&&ia("mat-drawer-shown",Uo()._isShowingBackdrop())}function ix(e,t){1&e&&(ko(0,"mat-drawer-content"),Go(1,2),Ao())}const nx=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],rx=["mat-drawer","mat-drawer-content","*"];function sx(e,t){if(1&e){const e=No();ko(0,"div",2),Lo("click",(function(){return Jt(e),Uo()._onBackdropClicked()})),Ao()}2&e&&ia("mat-drawer-shown",Uo()._isShowingBackdrop())}function ox(e,t){1&e&&(ko(0,"mat-sidenav-content",3),Go(1,2),Ao())}const ax=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],lx=["mat-sidenav","mat-sidenav-content","*"],cx={transformDrawer:vu("transform",[Su("open, open-instant",Cu({transform:"none",visibility:"visible"})),Su("void",Cu({"box-shadow":"none",visibility:"hidden"})),Tu("void => open-instant",xu("0ms")),Tu("void <=> open, open-instant => void",xu("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};function hx(e){throw Error(`A drawer was already declared for 'position="${e}"'`)}const ux=new je("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),dx=new je("MAT_DRAWER_CONTAINER");let px=(()=>{class e extends yy{constructor(e,t,i,n,r){super(i,n,r),this._changeDetectorRef=e,this._container=t}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(So(qs),So(Ee(()=>fx)),So(Fa),So(_y),So(Cc))},e.\u0275cmp=ft({type:e,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,t){2&e&&ta("margin-left",t._container._contentMargins.left,"px")("margin-right",t._container._contentMargins.right,"px")},features:[va],ngContentSelectors:ex,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),Go(0))},encapsulation:2,changeDetection:0}),e})(),mx=(()=>{class e{constructor(e,t,i,n,r,s,o){this._elementRef=e,this._focusTrapFactory=t,this._focusMonitor=i,this._platform=n,this._ngZone=r,this._doc=s,this._container=o,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new T,this._animationEnd=new T,this._animationState="void",this.openedChange=new Ol(!0),this._destroyed=new T,this.onPositionChanged=new Ol,this._modeChanged=new T,this.openedChange.subscribe(e=>{e?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._restoreFocus()}),this._ngZone.runOutsideAngular(()=>{G_(this._elementRef.nativeElement,"keydown").pipe(em(e=>27===e.keyCode&&!this.disableClose&&!wy(e)),cy(this._destroyed)).subscribe(e=>this._ngZone.run(()=>{this.close(),e.stopPropagation(),e.preventDefault()}))}),this._animationEnd.pipe(Q_((e,t)=>e.fromState===t.fromState&&e.toState===t.toState)).subscribe(e=>{const{fromState:t,toState:i}=e;(0===i.indexOf("open")&&"void"===t||"void"===i&&0===t.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(e){(e="end"===e?"end":"start")!=this._position&&(this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=j_(e)}get autoFocus(){const e=this._autoFocus;return null==e?"side"!==this.mode:e}set autoFocus(e){this._autoFocus=j_(e)}get opened(){return this._opened}set opened(e){this.toggle(j_(e))}get _openedStream(){return this.openedChange.pipe(em(e=>e),B(()=>{}))}get openedStart(){return this._animationStarted.pipe(em(e=>e.fromState!==e.toState&&0===e.toState.indexOf("open")),B(()=>{}))}get _closedStream(){return this.openedChange.pipe(em(e=>!e),B(()=>{}))}get closedStart(){return this._animationStarted.pipe(em(e=>e.fromState!==e.toState&&"void"===e.toState),B(()=>{}))}_takeFocus(){this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then(e=>{e||"function"!=typeof this._elementRef.nativeElement.focus||this._elementRef.nativeElement.focus()})}_restoreFocus(){if(!this.autoFocus)return;const e=this._doc&&this._doc.activeElement;e&&this._elementRef.nativeElement.contains(e)&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}toggle(e=!this.opened,t="program"){return this._opened=e,e?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=t):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise(e=>{this.openedChange.pipe(ym(1)).subscribe(t=>e(t?"open":"close"))})}get _width(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(e){this._animationStarted.next(e)}_animationDoneListener(e){this._animationEnd.next(e)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qy),So(Ky),So(A_),So(Cc),So(th,8),So(dx,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,t){1&e&&Bo("@transform.start",(function(e){return t._animationStartListener(e)}))("@transform.done",(function(e){return t._animationDoneListener(e)})),2&e&&(xo("align",null),_a("@transform",t._animationState),ia("mat-drawer-end","end"===t.position)("mat-drawer-over","over"===t.mode)("mat-drawer-push","push"===t.mode)("mat-drawer-side","side"===t.mode)("mat-drawer-opened",t.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",onPositionChanged:"positionChanged",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart"},exportAs:["matDrawer"],ngContentSelectors:ex,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(e,t){1&e&&(Ho(),ko(0,"div",0),Go(1),Ao())},encapsulation:2,data:{animation:[cx.transformDrawer]},changeDetection:0}),e})(),fx=(()=>{class e{constructor(e,t,i,n,r,s=!1,o){this._dir=e,this._element=t,this._ngZone=i,this._changeDetectorRef=n,this._animationMode=o,this._drawers=new Dl,this.backdropClick=new Ol,this._destroyed=new T,this._doCheckSubject=new T,this._contentMargins={left:null,right:null},this._contentMarginChanges=new T,e&&e.change.pipe(cy(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),r.change().pipe(cy(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=s}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=j_(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:j_(e)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(Mm(this._allDrawers),cy(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(e=>!e._container||e._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Mm(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._doCheckSubject.pipe(Cy(10),cy(this._destroyed)).subscribe(()=>this.updateContentMargins())}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,t=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._width;else if("push"==this._left.mode){const i=this._left._width;e+=i,t-=i}if(this._right&&this._right.opened)if("side"==this._right.mode)t+=this._right._width;else if("push"==this._right.mode){const i=this._right._width;t+=i,e-=i}e=e||null,t=t||null,e===this._contentMargins.left&&t===this._contentMargins.right||(this._contentMargins={left:e,right:t},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(em(e=>e.fromState!==e.toState),cy(this._drawers.changes)).subscribe(e=>{"open-instant"!==e.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(cy(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(cy(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.asObservable().pipe(ym(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(cy($(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const t=this._element.nativeElement.classList,i="mat-drawer-container-has-open";e?t.add(i):t.remove(i)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?(null!=this._end&&hx("end"),this._end=e):(null!=this._start&&hx("start"),this._start=e)}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawer()}_closeModalDrawer(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e.close())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return e.\u0275fac=function(t){return new(t||e)(So(py,8),So(Fa),So(Cc),So(qs),So(vy),So(ux),So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-drawer-container"]],contentQueries:function(e,t,i){var n;1&e&&($l(i,px,!0),$l(i,mx,!0)),2&e&&(Hl(n=Yl())&&(t._content=n.first),Hl(n=Yl())&&(t._allDrawers=n))},viewQuery:function(e,t){var i;1&e&&Wl(px,!0),2&e&&Hl(i=Yl())&&(t._userContent=i.first)},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,t){2&e&&ia("mat-drawer-container-explicit-backdrop",t._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Da([{provide:dx,useExisting:e}])],ngContentSelectors:rx,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,t){1&e&&(Ho(nx),wo(0,tx,1,2,"div",0),Go(1),Go(2,1),wo(3,ix,2,0,"mat-drawer-content",1)),2&e&&(Po("ngIf",t.hasBackdrop),gr(3),Po("ngIf",!t._content))},directives:[Ph,px],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),e})(),gx=(()=>{class e extends px{constructor(e,t,i,n,r){super(e,t,i,n,r)}}return e.\u0275fac=function(t){return new(t||e)(So(qs),So(Ee(()=>vx)),So(Fa),So(_y),So(Cc))},e.\u0275cmp=ft({type:e,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,t){2&e&&ta("margin-left",t._container._contentMargins.left,"px")("margin-right",t._container._contentMargins.right,"px")},features:[va],ngContentSelectors:ex,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),Go(0))},encapsulation:2,changeDetection:0}),e})(),_x=(()=>{class e extends mx{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=j_(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=V_(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=V_(e)}}return e.\u0275fac=function(t){return yx(t||e)},e.\u0275cmp=ft({type:e,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,t){2&e&&(xo("align",null),ta("top",t.fixedInViewport?t.fixedTopGap:null,"px")("bottom",t.fixedInViewport?t.fixedBottomGap:null,"px"),ia("mat-drawer-end","end"===t.position)("mat-drawer-over","over"===t.mode)("mat-drawer-push","push"===t.mode)("mat-drawer-side","side"===t.mode)("mat-drawer-opened",t.opened)("mat-sidenav-fixed",t.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[va],ngContentSelectors:ex,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(e,t){1&e&&(Ho(),ko(0,"div",0),Go(1),Ao())},encapsulation:2,data:{animation:[cx.transformDrawer]},changeDetection:0}),e})();const yx=cn(_x);let vx=(()=>{class e extends fx{}return e.\u0275fac=function(t){return xx(t||e)},e.\u0275cmp=ft({type:e,selectors:[["mat-sidenav-container"]],contentQueries:function(e,t,i){var n;1&e&&($l(i,gx,!0),$l(i,_x,!0)),2&e&&(Hl(n=Yl())&&(t._content=n.first),Hl(n=Yl())&&(t._allDrawers=n))},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,t){2&e&&ia("mat-drawer-container-explicit-backdrop",t._backdropOverride)},exportAs:["matSidenavContainer"],features:[Da([{provide:dx,useExisting:e}]),va],ngContentSelectors:lx,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(e,t){1&e&&(Ho(ax),wo(0,sx,1,2,"div",0),Go(1),Go(2,1),wo(3,ox,2,0,"mat-sidenav-content",1)),2&e&&(Po("ngIf",t.hasBackdrop),gr(3),Po("ngIf",!t._content))},directives:[Ph,gx,yy],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),e})();const xx=cn(vx);let bx=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lv,I_,xy],xy,lv]}),e})();function wx(...e){if(1===e.length){const t=e[0];if(c(t))return Cx(t,null);if(h(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return Cx(e.map(e=>t[e]),e)}}if("function"==typeof e[e.length-1]){const t=e.pop();return Cx(e=1===e.length&&c(e[0])?e[0]:e,null).pipe(B(e=>t(...e)))}return Cx(e,null)}function Cx(e,t){return new b(i=>{const n=e.length;if(0===n)return void i.complete();const r=new Array(n);let s=0,o=0;for(let a=0;a<n;a++){const l=U(e[a]);let c=!1;i.add(l.subscribe({next:e=>{c||(c=!0,o++),r[a]=e},error:e=>i.error(e),complete:()=>{s++,s!==n&&c||(o===n&&i.next(t?t.reduce((e,t,i)=>(e[t]=r[i],e),{}):r),i.complete())}}))}})}class Sx{}class Ex{}class Tx{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const i=e.slice(0,t),n=i.toLowerCase(),r=e.slice(t+1).trim();this.maybeSetNormalizedName(i,n),this.headers.has(n)?this.headers.get(n).push(r):this.headers.set(n,[r])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const n=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(n,i),this.maybeSetNormalizedName(t,n))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Tx?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Tx;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Tx?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const n=("a"===e.op?this.headers.get(t):void 0)||[];n.push(...i),this.headers.set(t,n);break;case"d":const r=e.value;if(r){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===r.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Px{encodeKey(e){return Mx(e)}encodeValue(e){return Mx(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function Mx(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class kx{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Px,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const i=new Map;return e.length>0&&e.split("&").forEach(e=>{const n=e.indexOf("="),[r,s]=-1==n?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,n)),t.decodeValue(e.slice(n+1))],o=i.get(r)||[];o.push(s),i.set(r,o)}),i}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new kx({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat([e]),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(e.value),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const i=t.indexOf(e.value);-1!==i&&t.splice(i,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}function Ax(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Ix(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Rx(e){return"undefined"!=typeof FormData&&e instanceof FormData}class Ox{constructor(e,t,i,n){let r;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||n?(this.body=void 0!==i?i:null,r=n):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.params&&(this.params=r.params)),this.headers||(this.headers=new Tx),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const i=t.indexOf("?");this.urlWithParams=t+(-1===i?"?":i<t.length-1?"&":"")+e}}else this.params=new kx,this.urlWithParams=t}serializeBody(){return null===this.body?null:Ax(this.body)||Ix(this.body)||Rx(this.body)||"string"==typeof this.body?this.body:this.body instanceof kx?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Rx(this.body)?null:Ix(this.body)?this.body.type||null:Ax(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof kx?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,n=e.responseType||this.responseType,r=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,o=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let a=e.headers||this.headers,l=e.params||this.params;return void 0!==e.setHeaders&&(a=Object.keys(e.setHeaders).reduce((t,i)=>t.set(i,e.setHeaders[i]),a)),e.setParams&&(l=Object.keys(e.setParams).reduce((t,i)=>t.set(i,e.setParams[i]),l)),new Ox(t,i,r,{params:l,headers:a,reportProgress:o,responseType:n,withCredentials:s})}}const Nx=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}();class Dx{constructor(e,t=200,i="OK"){this.headers=e.headers||new Tx,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class zx extends Dx{constructor(e={}){super(e),this.type=Nx.ResponseHeader}clone(e={}){return new zx({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Lx extends Dx{constructor(e={}){super(e),this.type=Nx.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Lx({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Bx extends Dx{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(e.url||"(unknown url)"):`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Fx(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let jx=(()=>{class e{constructor(e){this.handler=e}request(e,t,i={}){let n;if(e instanceof Ox)n=e;else{let r=void 0;r=i.headers instanceof Tx?i.headers:new Tx(i.headers);let s=void 0;i.params&&(s=i.params instanceof kx?i.params:new kx({fromObject:i.params})),n=new Ox(e,t,void 0!==i.body?i.body:null,{headers:r,params:s,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const r=qp(n).pipe(Rm(e=>this.handler.handle(e)));if(e instanceof Ox||"events"===i.observe)return r;const s=r.pipe(em(e=>e instanceof Lx));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return s.pipe(B(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return s.pipe(B(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return s.pipe(B(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return s.pipe(B(e=>e.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new kx).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,i={}){return this.request("PATCH",e,Fx(i,t))}post(e,t,i={}){return this.request("POST",e,Fx(i,t))}put(e,t,i={}){return this.request("PUT",e,Fx(i,t))}}return e.\u0275fac=function(t){return new(t||e)(Ke(Sx))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Vx{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const Ux=new je("HTTP_INTERCEPTORS");let qx=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Hx=/^\)\]\}',?\n/;class Gx{}let Wx=(()=>{class e{constructor(){}build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Zx=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new b(t=>{const i=this.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((e,t)=>i.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&i.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();i.responseType="json"!==t?t:"text"}const n=e.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const t=1223===i.status?204:i.status,n=i.statusText||"OK",s=new Tx(i.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(i)||e.url;return r=new zx({headers:s,status:t,statusText:n,url:o}),r},o=()=>{let{headers:n,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===i.response?i.responseText:i.response),0===r&&(r=l?200:0);let c=r>=200&&r<300;if("json"===e.responseType&&"string"==typeof l){const e=l;l=l.replace(Hx,"");try{l=""!==l?JSON.parse(l):null}catch(h){l=e,c&&(c=!1,l={error:h,text:l})}}c?(t.next(new Lx({body:l,headers:n,status:r,statusText:o,url:a||void 0})),t.complete()):t.error(new Bx({error:l,headers:n,status:r,statusText:o,url:a||void 0}))},a=e=>{const{url:n}=s(),r=new Bx({error:e,status:i.status||0,statusText:i.statusText||"Unknown Error",url:n||void 0});t.error(r)};let l=!1;const c=n=>{l||(t.next(s()),l=!0);let r={type:Nx.DownloadProgress,loaded:n.loaded};n.lengthComputable&&(r.total=n.total),"text"===e.responseType&&i.responseText&&(r.partialText=i.responseText),t.next(r)},h=e=>{let i={type:Nx.UploadProgress,loaded:e.loaded};e.lengthComputable&&(i.total=e.total),t.next(i)};return i.addEventListener("load",o),i.addEventListener("error",a),e.reportProgress&&(i.addEventListener("progress",c),null!==n&&i.upload&&i.upload.addEventListener("progress",h)),i.send(n),t.next({type:Nx.Sent}),()=>{i.removeEventListener("error",a),i.removeEventListener("load",o),e.reportProgress&&(i.removeEventListener("progress",c),null!==n&&i.upload&&i.upload.removeEventListener("progress",h)),i.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(Ke(Gx))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const $x=new je("XSRF_COOKIE_NAME"),Xx=new je("XSRF_HEADER_NAME");class Kx{}let Yx=(()=>{class e{constructor(e,t,i){this.doc=e,this.platform=t,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=wh(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(Ke(th),Ke(ac),Ke($x))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Jx=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const i=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||i.startsWith("http://")||i.startsWith("https://"))return t.handle(e);const n=this.tokenService.getToken();return null===n||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,n)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(Kx),Ke(Xx))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Qx=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(Ux,[]);this.chain=e.reduceRight((e,t)=>new Vx(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(Ex),Ke(so))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),eb=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:Jx,useClass:qx}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:$x,useValue:t.cookieName}:[],t.headerName?{provide:Xx,useValue:t.headerName}:[]]}}}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[Jx,{provide:Ux,useExisting:Jx,multi:!0},{provide:Kx,useClass:Yx},{provide:$x,useValue:"XSRF-TOKEN"},{provide:Xx,useValue:"X-XSRF-TOKEN"}]}),e})(),tb=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[jx,{provide:Sx,useClass:Qx},Zx,{provide:Ex,useExisting:Zx},Wx,{provide:Gx,useExisting:Wx}],imports:[[eb.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})();const ib=["*"];function nb(e){return Error(`Unable to find icon with the name "${e}"`)}function rb(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function sb(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class ob{constructor(e,t){this.options=t,e.nodeName?this.svgElement=e:this.url=e}}let ab=(()=>{class e{constructor(e,t,i,n){this._httpClient=e,this._sanitizer=t,this._errorHandler=n,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=i}addSvgIcon(e,t,i){return this.addSvgIconInNamespace("",e,t,i)}addSvgIconLiteral(e,t,i){return this.addSvgIconLiteralInNamespace("",e,t,i)}addSvgIconInNamespace(e,t,i,n){return this._addSvgIconConfig(e,t,new ob(i,n))}addSvgIconLiteralInNamespace(e,t,i,n){const r=this._sanitizer.sanitize(Zn.HTML,i);if(!r)throw sb(i);const s=this._createSvgElementForSingleIcon(r,n);return this._addSvgIconConfig(e,t,new ob(s,n))}addSvgIconSet(e,t){return this.addSvgIconSetInNamespace("",e,t)}addSvgIconSetLiteral(e,t){return this.addSvgIconSetLiteralInNamespace("",e,t)}addSvgIconSetInNamespace(e,t,i){return this._addSvgIconSetConfig(e,new ob(t,i))}addSvgIconSetLiteralInNamespace(e,t,i){const n=this._sanitizer.sanitize(Zn.HTML,t);if(!n)throw sb(t);const r=this._svgElementFromString(n);return this._addSvgIconSetConfig(e,new ob(r,i))}registerFontClassAlias(e,t=e){return this._fontCssClassesByAlias.set(e,t),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const t=this._sanitizer.sanitize(Zn.RESOURCE_URL,e);if(!t)throw rb(e);const i=this._cachedIconsByUrl.get(t);return i?qp(lb(i)):this._loadSvgIconFromConfig(new ob(e)).pipe(Nm(e=>this._cachedIconsByUrl.set(t,e)),B(e=>lb(e)))}getNamedSvgIcon(e,t=""){const i=cb(t,e),n=this._svgIconConfigs.get(i);if(n)return this._getSvgFromConfig(n);const r=this._iconSetConfigs.get(t);return r?this._getSvgFromIconSetConfigs(e,r):(s=nb(i),new b(e=>e.error(s)));var s}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgElement?qp(lb(e.svgElement)):this._loadSvgIconFromConfig(e).pipe(Nm(t=>e.svgElement=t),B(e=>lb(e)))}_getSvgFromIconSetConfigs(e,t){const i=this._extractIconWithNameFromAnySet(e,t);return i?qp(i):wx(t.filter(e=>!e.svgElement).map(e=>this._loadSvgIconSetFromConfig(e).pipe(fm(t=>{const i=`Loading icon set URL: ${this._sanitizer.sanitize(Zn.RESOURCE_URL,e.url)} failed: ${t.message}`;return this._errorHandler?this._errorHandler.handleError(new Error(i)):console.error(i),qp(null)})))).pipe(B(()=>{const i=this._extractIconWithNameFromAnySet(e,t);if(!i)throw nb(e);return i}))}_extractIconWithNameFromAnySet(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(n.svgElement){const t=this._extractSvgIconFromSet(n.svgElement,e,n.options);if(t)return t}}return null}_loadSvgIconFromConfig(e){return this._fetchUrl(e.url).pipe(B(t=>this._createSvgElementForSingleIcon(t,e.options)))}_loadSvgIconSetFromConfig(e){return e.svgElement?qp(e.svgElement):this._fetchUrl(e.url).pipe(B(t=>(e.svgElement||(e.svgElement=this._svgElementFromString(t)),e.svgElement)))}_createSvgElementForSingleIcon(e,t){const i=this._svgElementFromString(e);return this._setSvgAttributes(i,t),i}_extractSvgIconFromSet(e,t,i){const n=e.querySelector(`[id="${t}"]`);if(!n)return null;const r=n.cloneNode(!0);if(r.removeAttribute("id"),"svg"===r.nodeName.toLowerCase())return this._setSvgAttributes(r,i);if("symbol"===r.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(r),i);const s=this._svgElementFromString("<svg></svg>");return s.appendChild(r),this._setSvgAttributes(s,i)}_svgElementFromString(e){const t=this._document.createElement("DIV");t.innerHTML=e;const i=t.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(e){const t=this._svgElementFromString("<svg></svg>"),i=e.attributes;for(let n=0;n<i.length;n++){const{name:e,value:r}=i[n];"id"!==e&&t.setAttribute(e,r)}for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===this._document.ELEMENT_NODE&&t.appendChild(e.childNodes[n].cloneNode(!0));return t}_setSvgAttributes(e,t){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),t&&t.viewBox&&e.setAttribute("viewBox",t.viewBox),e}_fetchUrl(e){if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==e)throw Error(`Cannot fetch icon from URL "${e}".`);const t=this._sanitizer.sanitize(Zn.RESOURCE_URL,e);if(!t)throw rb(e);const i=this._inProgressUrlFetches.get(t);if(i)return i;const n=this._httpClient.get(t,{responseType:"text"}).pipe(Lm(()=>this._inProgressUrlFetches.delete(t)),ie());return this._inProgressUrlFetches.set(t,n),n}_addSvgIconConfig(e,t,i){return this._svgIconConfigs.set(cb(e,t),i),this}_addSvgIconSetConfig(e,t){const i=this._iconSetConfigs.get(e);return i?i.push(t):this._iconSetConfigs.set(e,[t]),this}}return e.\u0275fac=function(t){return new(t||e)(Ke(jx,8),Ke(pu),Ke(th,8),Ke(pn,8))},e.\u0275prov=de({factory:function(){return new e(Ke(jx,8),Ke(pu),Ke(th,8),Ke(pn,8))},token:e,providedIn:"root"}),e})();function lb(e){return e.cloneNode(!0)}function cb(e,t){return e+":"+t}class hb{constructor(e){this._elementRef=e}}const ub=hv(hb),db=new je("mat-icon-location",{providedIn:"root",factory:function(){const e=Ye(th),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),pb=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],mb=pb.map(e=>`[${e}]`).join(", "),fb=/^url\(['"]?#(.*?)['"]?\)$/;let gb=(()=>{class e extends ub{constructor(e,t,i,n,r){super(e),this._iconRegistry=t,this._location=n,this._errorHandler=r,this._inline=!1,this._currentIconFetch=d.EMPTY,i||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=j_(e)}get fontSet(){return this._fontSet}set fontSet(e){this._fontSet=this._cleanupFontValue(e)}get fontIcon(){return this._fontIcon}set fontIcon(e){this._fontIcon=this._cleanupFontValue(e)}_splitIconName(e){if(!e)return["",""];const t=e.split(":");switch(t.length){case 1:return["",t[0]];case 2:return t;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnChanges(e){const t=e.svgIcon;if(t)if(this._currentIconFetch.unsubscribe(),this.svgIcon){const[e,t]=this._splitIconName(this.svgIcon);this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(t,e).pipe(ym(1)).subscribe(e=>this._setSvgElement(e),i=>{const n=`Error retrieving icon ${e}:${t}! ${i.message}`;this._errorHandler?this._errorHandler.handleError(new Error(n)):console.error(n)})}else t.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}ngOnInit(){this._usingFontIcon()&&this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&this._location&&e.size){const e=this._location.getPathname();e!==this._previousPath&&(this._previousPath=e,this._prependPathToReferences(e))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const t=e.querySelectorAll("style");for(let i=0;i<t.length;i++)t[i].textContent+=" ";if(this._location){const t=this._location.getPathname();this._previousPath=t,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(t)}this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let t=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();t--;){const i=e.childNodes[t];1===i.nodeType&&"svg"!==i.nodeName.toLowerCase()||e.removeChild(i)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,t=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();t!=this._previousFontSetClass&&(this._previousFontSetClass&&e.classList.remove(this._previousFontSetClass),t&&e.classList.add(t),this._previousFontSetClass=t),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const t=this._elementsWithExternalReferences;t&&t.forEach((t,i)=>{t.forEach(t=>{i.setAttribute(t.name,`url('${e}#${t.value}')`)})})}_cacheChildrenWithExternalReferences(e){const t=e.querySelectorAll(mb),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let n=0;n<t.length;n++)pb.forEach(e=>{const r=t[n],s=r.getAttribute(e),o=s?s.match(fb):null;if(o){let t=i.get(r);t||(t=[],i.set(r,t)),t.push({name:e,value:o[1]})}})}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(ab),Eo("aria-hidden"),So(db,8),So(pn,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(e,t){2&e&&ia("mat-icon-inline",t.inline)("mat-icon-no-color","primary"!==t.color&&"accent"!==t.color&&"warn"!==t.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[va,Ea],ngContentSelectors:ib,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),Go(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),e})(),_b=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv],lv]}),e})();const yb=new je("NgValueAccessor"),vb={provide:yb,useExisting:Ee(()=>xb),multi:!0};let xb=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(e){return t.onChange(e.target.checked)}))("blur",(function(){return t.onTouched()}))},features:[Da([vb])]}),e})();const bb={provide:yb,useExisting:Ee(()=>Cb),multi:!0},wb=new je("CompositionEventMode");let Cb=(()=>{class e{constructor(e,t,i){this._renderer=e,this._elementRef=t,this._compositionMode=i,this.onChange=e=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=eh()?eh().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa),So(wb,8))},e.\u0275dir=bt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Lo("input",(function(e){return t._handleInput(e.target.value)}))("blur",(function(){return t.onTouched()}))("compositionstart",(function(){return t._compositionStart()}))("compositionend",(function(e){return t._compositionEnd(e.target.value)}))},features:[Da([bb])]}),e})(),Sb=(()=>{class e{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e}),e})(),Eb=(()=>{class e extends Sb{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(t){return Tb(t||e)},e.\u0275dir=bt({type:e,features:[va]}),e})();const Tb=cn(Eb);function Pb(){throw new Error("unimplemented")}class Mb extends Sb{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Pb()}get asyncValidator(){return Pb()}}class kb{constructor(e){this._cd=e}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let Ab=(()=>{class e extends kb{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(So(Mb,2))},e.\u0275dir=bt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&ia("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[va]}),e})(),Ib=(()=>{class e extends kb{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(So(Eb,2))},e.\u0275dir=bt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&ia("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[va]}),e})();function Rb(e){return null==e||0===e.length}const Ob=new je("NgValidators"),Nb=new je("NgAsyncValidators"),Db=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class zb{static min(e){return t=>{if(Rb(t.value)||Rb(e))return null;const i=parseFloat(t.value);return!isNaN(i)&&i<e?{min:{min:e,actual:t.value}}:null}}static max(e){return t=>{if(Rb(t.value)||Rb(e))return null;const i=parseFloat(t.value);return!isNaN(i)&&i>e?{max:{max:e,actual:t.value}}:null}}static required(e){return Rb(e.value)?{required:!0}:null}static requiredTrue(e){return!0===e.value?null:{required:!0}}static email(e){return Rb(e.value)||Db.test(e.value)?null:{email:!0}}static minLength(e){return t=>{if(Rb(t.value))return null;const i=t.value?t.value.length:0;return i<e?{minlength:{requiredLength:e,actualLength:i}}:null}}static maxLength(e){return t=>{const i=t.value?t.value.length:0;return i>e?{maxlength:{requiredLength:e,actualLength:i}}:null}}static pattern(e){if(!e)return zb.nullValidator;let t,i;return"string"==typeof e?(i="","^"!==e.charAt(0)&&(i+="^"),i+=e,"$"!==e.charAt(e.length-1)&&(i+="$"),t=new RegExp(i)):(i=e.toString(),t=e),e=>{if(Rb(e.value))return null;const n=e.value;return t.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}static nullValidator(e){return null}static compose(e){if(!e)return null;const t=e.filter(Lb);return 0==t.length?null:function(e){return Fb(function(e,t){return t.map(t=>t(e))}(e,t))}}static composeAsync(e){if(!e)return null;const t=e.filter(Lb);return 0==t.length?null:function(e){return wx(function(e,t){return t.map(t=>t(e))}(e,t).map(Bb)).pipe(B(Fb))}}}function Lb(e){return null!=e}function Bb(e){const t=Do(e)?U(e):e;if(!zo(t))throw new Error("Expected validator to return Promise or Observable.");return t}function Fb(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function jb(e){return e.validate?t=>e.validate(t):e}function Vb(e){return e.validate?t=>e.validate(t):e}const Ub={provide:yb,useExisting:Ee(()=>qb),multi:!0};let qb=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[Da([Ub])]}),e})();const Hb={provide:yb,useExisting:Ee(()=>Wb),multi:!0};let Gb=(()=>{class e{constructor(){this._accessors=[]}add(e,t){this._accessors.push([e,t])}remove(e){for(let t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}select(e){this._accessors.forEach(t=>{this._isSameGroup(t,e)&&t[1]!==e&&t[1].fireUncheck(e.value)})}_isSameGroup(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Wb=(()=>{class e{constructor(e,t,i,n){this._renderer=e,this._elementRef=t,this._registry=i,this._injector=n,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Mb),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa),So(Gb),So(so))},e.\u0275dir=bt({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(){return t.onChange()}))("blur",(function(){return t.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Da([Hb])]}),e})();const Zb={provide:yb,useExisting:Ee(()=>$b),multi:!0};let $b=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[Da([Zb])]}),e})();const Xb='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',Kb='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',Yb='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',Jb={provide:yb,useExisting:Ee(()=>Qb),multi:!0};let Qb=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=mo}set compareWith(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const i=function(e,t){return null==e?""+t:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",i)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Da([Jb])]}),e})();const ew={provide:yb,useExisting:Ee(()=>tw),multi:!0};let tw=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=mo}set compareWith(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const i=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(i.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const i=[];if(t.hasOwnProperty("selectedOptions")){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const n=e.item(t),r=this._getOptionValue(n.value);i.push(r)}}else{const e=t.options;for(let t=0;t<e.length;t++){const n=e.item(t);if(n.selected){const e=this._getOptionValue(n.value);i.push(e)}}}this.value=i,e(i)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(t){return new(t||e)(So(qa),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Lo("change",(function(e){return t.onChange(e.target)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[Da([ew])]}),e})();function iw(e,t){return[...t.path,e]}function nw(e,t){e||aw(t,"Cannot find control with"),t.valueAccessor||aw(t,"No value accessor for form control with"),e.validator=zb.compose([e.validator,t.validator]),e.asyncValidator=zb.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(i=>{e._pendingValue=i,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&rw(e,t)})}(e,t),function(e,t){e.registerOnChange((e,i)=>{t.valueAccessor.writeValue(e),i&&t.viewToModelUpdate(e)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&rw(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange(e=>{t.valueAccessor.setDisabledState(e)}),t._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(()=>e.updateValueAndValidity())}),t._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(()=>e.updateValueAndValidity())})}function rw(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function sw(e,t){null==e&&aw(t,"Cannot find control with"),e.validator=zb.compose([e.validator,t.validator]),e.asyncValidator=zb.composeAsync([e.asyncValidator,t.asyncValidator])}function ow(e){return aw(e,"There is no FormControl instance attached to form control element with")}function aw(e,t){let i;throw i=e.path.length>1?`path: '${e.path.join(" -> ")}'`:e.path[0]?`name: '${e.path}'`:"unspecified name attribute",new Error(`${t} ${i}`)}function lw(e){return null!=e?zb.compose(e.map(jb)):null}function cw(e){return null!=e?zb.composeAsync(e.map(Vb)):null}const hw=[xb,$b,qb,Qb,tw,Wb];function uw(e,t){e._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function dw(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}function pw(e){const t=fw(e)?e.validators:e;return Array.isArray(t)?lw(t):t||null}function mw(e,t){const i=fw(t)?t.asyncValidators:e;return Array.isArray(i)?cw(i):i||null}function fw(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class gw{constructor(e,t){this.validator=e,this.asyncValidator=t,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this.validator=pw(e)}setAsyncValidators(e){this.asyncValidator=mw(e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status="PENDING";const t=Bb(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>this.setErrors(t,{emitEvent:e}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,i){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;let n=e;return t.forEach(e=>{n=n instanceof yw?n.controls.hasOwnProperty(e)?n.controls[e]:null:n instanceof vw&&n.at(e)||null}),n}(this,e)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ol,this.statusChanges=new Ol}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){fw(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class _w extends gw{constructor(e=null,t,i){super(pw(t),mw(i,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class yw extends gw{constructor(e,t,i){super(pw(t),mw(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){Object.keys(e).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}reset(e={},t={}){this._forEachChild((i,n)=>{i.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t instanceof _w?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>e(this.controls[t],t))}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){let t=!1;return this._forEachChild((i,n)=>{t=t||this.contains(n)&&e(i)}),t}_reduceValue(){return this._reduceChildren({},(e,t,i)=>((t.enabled||this.disabled)&&(e[i]=t.value),e))}_reduceChildren(e,t){let i=e;return this._forEachChild((e,n)=>{i=t(i,e,n)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,i)=>{if(void 0===e[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class vw extends gw{constructor(e,t,i){super(pw(t),mw(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(e){return this.controls[e]}push(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}insert(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}removeAt(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e.forEach((e,i)=>{this.at(i)&&this.at(i).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}reset(e=[],t={}){this._forEachChild((i,n)=>{i.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof _w?e.value:e.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index "+e)}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,i)=>{if(void 0===e[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const xw={provide:Eb,useExisting:Ee(()=>ww)},bw=(()=>Promise.resolve(null))();let ww=(()=>{class e extends Eb{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Ol,this.form=new yw({},lw(e),cw(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){bw.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),nw(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){bw.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),dw(this._directives,e)})}addFormGroup(e){bw.then(()=>{const t=this._findContainer(e.path),i=new yw({});sw(i,e),t.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){bw.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){bw.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,uw(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return e.\u0275fac=function(t){return new(t||e)(So(Ob,10),So(Nb,10))},e.\u0275dir=bt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Lo("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Da([xw]),va]}),e})(),Cw=(()=>{class e extends Eb{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return iw(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return lw(this._validators)}get asyncValidator(){return cw(this._asyncValidators)}_checkParentType(){}}return e.\u0275fac=function(t){return Sw(t||e)},e.\u0275dir=bt({type:e,features:[va]}),e})();const Sw=cn(Cw);class Ew{static modelParentException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup's partner directive "formControlName" instead.  Example:\n\n      ${Xb}\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  `)}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${Kb}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${Yb}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${Kb}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${Yb}`)}}const Tw={provide:Eb,useExisting:Ee(()=>Pw)};let Pw=(()=>{class e extends Cw{constructor(e,t,i){super(),this._parent=e,this._validators=t,this._asyncValidators=i}_checkParentType(){this._parent instanceof e||this._parent instanceof ww||Ew.modelGroupParentException()}}return e.\u0275fac=function(t){return new(t||e)(So(Eb,5),So(Ob,10),So(Nb,10))},e.\u0275dir=bt({type:e,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[Da([Tw]),va]}),e})();const Mw={provide:Mb,useExisting:Ee(()=>Aw)},kw=(()=>Promise.resolve(null))();let Aw=(()=>{class e extends Mb{constructor(e,t,i,n){super(),this.control=new _w,this._registered=!1,this.update=new Ol,this._parent=e,this._rawValidators=t||[],this._rawAsyncValidators=i||[],this.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||aw(e,"Value accessor was not provided as an array for form control with");let i=void 0,n=void 0,r=void 0;return t.forEach(t=>{var s;t.constructor===Cb?i=t:(s=t,hw.some(e=>s.constructor===e)?(n&&aw(e,"More than one built-in value accessor matches form control with"),n=t):(r&&aw(e,"More than one custom value accessor matches form control with"),r=t))}),r||n||i||(aw(e,"No valid value accessor for form control with"),null)}(this,n)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;const i=e.model;return!!i.isFirstChange()||!mo(t,i.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?iw(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return lw(this._rawValidators)}get asyncValidator(){return cw(this._rawAsyncValidators)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){nw(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof Pw)&&this._parent instanceof Cw?Ew.formGroupNameException():this._parent instanceof Pw||this._parent instanceof ww||Ew.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Ew.missingNameException()}_updateValue(e){kw.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,i=""===t||t&&"false"!==t;kw.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(So(Eb,9),So(Ob,10),So(Nb,10),So(yb,10))},e.\u0275dir=bt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Da([Mw]),va,Ea]}),e})(),Iw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})();const Rw={provide:Eb,useExisting:Ee(()=>Ow)};let Ow=(()=>{class e extends Eb{constructor(e,t){super(),this._validators=e,this._asyncValidators=t,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new Ol}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const t=this.form.get(e.path);return nw(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}getControl(e){return this.form.get(e.path)}removeControl(e){dw(this.directives,e)}addFormGroup(e){const t=this.form.get(e.path);sw(t,e),t.updateValueAndValidity({emitEvent:!1})}removeFormGroup(e){}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){const t=this.form.get(e.path);sw(t,e),t.updateValueAndValidity({emitEvent:!1})}removeFormArray(e){}getFormArray(e){return this.form.get(e.path)}updateModel(e,t){this.form.get(e.path).setValue(t)}onSubmit(e){return this.submitted=!0,uw(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const t=this.form.get(e.path);e.control!==t&&(function(e,t){t.valueAccessor.registerOnChange(()=>ow(t)),t.valueAccessor.registerOnTouched(()=>ow(t)),t._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(null)}),t._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(null)}),e&&e._clearChangeFns()}(e.control,e),t&&nw(t,e),e.control=t)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const e=lw(this._validators);this.form.validator=zb.compose([this.form.validator,e]);const t=cw(this._asyncValidators);this.form.asyncValidator=zb.composeAsync([this.form.asyncValidator,t])}_checkFormPresent(){this.form||class{static controlParentException(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      "+Xb)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${Kb}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ${Yb}`)}static missingFormException(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       "+Xb)}static groupParentException(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      "+Kb)}static arrayParentException(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}static ngModelWarning(e){console.warn(`\n    It looks like you're using ngModel on the same form field as ${e}. \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/${"formControl"===e?"FormControlDirective":"FormControlName"}#use-with-ngmodel\n    `)}}.missingFormException()}}return e.\u0275fac=function(t){return new(t||e)(So(Ob,10),So(Nb,10))},e.\u0275dir=bt({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&Lo("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Da([Rw]),va,Ea]}),e})();const Nw={provide:Ob,useExisting:Ee(()=>Dw),multi:!0};let Dw=(()=>{class e{get required(){return this._required}set required(e){this._required=null!=e&&!1!==e&&""+e!="false",this._onChange&&this._onChange()}validate(e){return this.required?zb.required(e):null}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&xo("required",t.required?"":null)},inputs:{required:"required"},features:[Da([Nw])]}),e})(),zw=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})(),Lw=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[Gb],imports:[zw]}),e})(),Bw=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv],lv]}),e})();const Fw=["*"],jw=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],Vw=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"];class Uw{}const qw=cv(uv(Uw));class Hw{}const Gw=uv(Hw);let Ww=(()=>{class e extends qw{constructor(){super(...arguments),this._stateChanges=new T}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return e.\u0275fac=function(t){return Zw(t||e)},e.\u0275cmp=ft({type:e,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[va,Ea],ngContentSelectors:Fw,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),Go(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),e})();const Zw=cn(Ww);let $w=(()=>{class e extends qw{constructor(e){super(),this._elementRef=e,this._stateChanges=new T,"action-list"===this._getListType()&&e.nativeElement.classList.add("mat-action-list")}_getListType(){const e=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===e?"list":"mat-action-list"===e?"action-list":null}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa))},e.\u0275cmp=ft({type:e,selectors:[["mat-list"],["mat-action-list"]],hostAttrs:[1,"mat-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matList"],features:[va,Ea],ngContentSelectors:Fw,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),Go(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),e})(),Xw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),e})(),Kw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),e})(),Yw=(()=>{class e extends Gw{constructor(e,t,i,n){super(),this._element=e,this._isInteractiveList=!1,this._destroyed=new T,this._disabled=!1,this._isInteractiveList=!!(i||n&&"action-list"===n._getListType()),this._list=i||n;const r=this._getHostElement();"button"!==r.nodeName.toLowerCase()||r.hasAttribute("type")||r.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(cy(this._destroyed)).subscribe(()=>{t.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(e){this._disabled=j_(e)}ngAfterContentInit(){!function(e,t,i="mat"){e.changes.pipe(Mm(e)).subscribe(({length:e})=>{kv(t,i+"-2-line",!1),kv(t,i+"-3-line",!1),kv(t,i+"-multi-line",!1),2===e||3===e?kv(t,`${i}-${e}-line`,!0):e>3&&kv(t,i+"-multi-line",!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(Ww,8),So($w,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(e,t,i){var n;1&e&&($l(i,Xw,!0),$l(i,Kw,!0),$l(i,Mv,!0)),2&e&&(Hl(n=Yl())&&(t._avatar=n.first),Hl(n=Yl())&&(t._icon=n.first),Hl(n=Yl())&&(t._lines=n))},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(e,t){2&e&&ia("mat-list-item-disabled",t.disabled)("mat-list-item-avatar",t._avatar||t._icon)("mat-list-item-with-avatar",t._avatar||t._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[va],ngContentSelectors:Vw,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(e,t){1&e&&(Ho(jw),ko(0,"div",0),Io(1,"div",1),Go(2),ko(3,"div",2),Go(4,1),Ao(),Go(5,2),Ao()),2&e&&(gr(1),Po("matRippleTrigger",t._getHostElement())("matRippleDisabled",t._isRippleDisabled()))},directives:[Bv],encapsulation:2,changeDetection:0}),e})(),Jw=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Av,Fv,lv,Vv,Fh],Av,lv,Vv,Bw]}),e})();function Qw(){throw Error("Host already has a portal attached")}class eC{attach(e){return null==e&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),e.hasAttached()&&Qw(),this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null==e?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class tC extends eC{constructor(e,t,i,n){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=n}}class iC extends eC{constructor(e,t,i){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class nC extends eC{constructor(e){super(),this.element=e instanceof Fa?e.nativeElement:e}}class rC{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&Qw(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),e instanceof tC?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof iC?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof nC?(this._attachedPortal=e,this.attachDomPortal(e)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class sC extends rC{constructor(e,t,i,n,r){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=n,this.attachDomPortal=e=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const t=e.element;if(!t.parentNode)throw Error("DOM portal content must be attached to a parent node.");const i=this._document.createComment("dom-portal");t.parentNode.insertBefore(i,t),this.outletElement.appendChild(t),super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(t,i)})},this._document=r}attachComponentPortal(e){const t=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let i;return e.viewContainerRef?(i=e.viewContainerRef.createComponent(t,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>i.destroy())):(i=t.create(e.injector||this._defaultInjector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),i}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context);return i.detectChanges(),i.rootNodes.forEach(e=>this.outletElement.appendChild(e)),this.setDisposeFn(()=>{let e=t.indexOf(i);-1!==e&&t.remove(e)}),i}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let oC=(()=>{class e extends iC{constructor(e,t){super(e,t)}}return e.\u0275fac=function(t){return new(t||e)(So(cl),So(ul))},e.\u0275dir=bt({type:e,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[va]}),e})(),aC=(()=>{class e extends rC{constructor(e,t,i){super(),this._componentFactoryResolver=e,this._viewContainerRef=t,this._isInitialized=!1,this.attached=new Ol,this.attachDomPortal=e=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const t=e.element;if(!t.parentNode)throw Error("DOM portal content must be attached to a parent node.");const i=this._document.createComment("dom-portal");e.setAttachedHost(this),t.parentNode.insertBefore(i,t),this._getRootNode().appendChild(t),super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(t,i)})},this._document=i}get portal(){return this._attachedPortal}set portal(e){(!this.hasAttached()||e||this._isInitialized)&&(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const t=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),n=t.createComponent(i,t.length,e.injector||t.injector);return t!==this._viewContainerRef&&this._getRootNode().appendChild(n.hostView.rootNodes[0]),super.setDisposeFn(()=>n.destroy()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}attachTemplatePortal(e){e.setAttachedHost(this);const t=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=t,this.attached.emit(t),t}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return e.\u0275fac=function(t){return new(t||e)(So(Ba),So(ul),So(th))},e.\u0275dir=bt({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[va]}),e})(),lC=(()=>{class e extends aC{}return e.\u0275fac=function(t){return cC(t||e)},e.\u0275dir=bt({type:e,selectors:[["","cdkPortalHost",""],["","portalHost",""]],inputs:{portal:["cdkPortalHost","portal"]},exportAs:["cdkPortalHost"],features:[Da([{provide:aC,useExisting:e}]),va]}),e})();const cC=cn(lC);let hC=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})();class uC{constructor(e,t){this._parentInjector=e,this._customTokens=t}get(e,t){const i=this._customTokens.get(e);return void 0!==i?i:this._parentInjector.get(e,t)}}class dC{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=q_(-this._previousScrollPosition.left),e.style.top=q_(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,t=e.style,i=this._document.body.style,n=t.scrollBehavior||"",r=i.scrollBehavior||"";this._isEnabled=!1,t.left=this._previousHTMLStyles.left,t.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),t.scrollBehavior=i.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),t.scrollBehavior=n,i.scrollBehavior=r}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,t=this._viewportRuler.getViewportSize();return e.scrollHeight>t.height||e.scrollWidth>t.width}}function pC(){return Error("Scroll strategy has already been attached.")}class mC{constructor(e,t,i,n){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){if(this._overlayRef)throw pC();this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class fC{enable(){}disable(){}attach(){}}function gC(e,t){return t.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function _C(e,t){return t.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class yC{constructor(e,t,i,n){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=n,this._scrollSubscription=null}attach(e){if(this._overlayRef)throw pC();this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:t,height:i}=this._viewportRuler.getViewportSize();gC(e,[{width:t,height:i,bottom:i,right:t,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let vC=(()=>{class e{constructor(e,t,i,n){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this.noop=()=>new fC,this.close=e=>new mC(this._scrollDispatcher,this._ngZone,this._viewportRuler,e),this.block=()=>new dC(this._viewportRuler,this._document),this.reposition=e=>new yC(this._scrollDispatcher,this._viewportRuler,this._ngZone,e),this._document=n}}return e.\u0275fac=function(t){return new(t||e)(Ke(_y),Ke(vy),Ke(Cc),Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(_y),Ke(vy),Ke(Cc),Ke(th))},token:e,providedIn:"root"}),e})();class xC{constructor(e){if(this.scrollStrategy=new fC,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class bC{constructor(e,t,i,n,r){this.offsetX=i,this.offsetY=n,this.panelClass=r,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}}class wC{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}function CC(e,t){if("top"!==t&&"bottom"!==t&&"center"!==t)throw Error(`ConnectedPosition: Invalid ${e} "${t}". Expected "top", "bottom" or "center".`)}function SC(e,t){if("start"!==t&&"end"!==t&&"center"!==t)throw Error(`ConnectedPosition: Invalid ${e} "${t}". Expected "start", "end" or "center".`)}let EC=(()=>{class e{constructor(e){this._attachedOverlays=[],this._keydownListener=e=>{const t=this._attachedOverlays;for(let i=t.length-1;i>-1;i--)if(t[i]._keydownEvents.observers.length>0){t[i]._keydownEvents.next(e);break}},this._document=e}ngOnDestroy(){this._detach()}add(e){this.remove(e),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(e)}remove(e){const t=this._attachedOverlays.indexOf(e);t>-1&&this._attachedOverlays.splice(t,1),0===this._attachedOverlays.length&&this._detach()}_detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return e.\u0275fac=function(t){return new(t||e)(Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(th))},token:e,providedIn:"root"}),e})();const TC=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine);let PC=(()=>{class e{constructor(e,t){this._platform=t,this._document=e}ngOnDestroy(){const e=this._containerElement;e&&e.parentNode&&e.parentNode.removeChild(e)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(e||TC){const e=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]');for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])}const t=this._document.createElement("div");t.classList.add("cdk-overlay-container"),TC?t.setAttribute("platform","test"):e||t.setAttribute("platform","server"),this._document.body.appendChild(t),this._containerElement=t}}return e.\u0275fac=function(t){return new(t||e)(Ke(th),Ke(A_))},e.\u0275prov=de({factory:function(){return new e(Ke(th),Ke(A_))},token:e,providedIn:"root"}),e})();class MC{constructor(e,t,i,n,r,s,o,a){this._portalOutlet=e,this._host=t,this._pane=i,this._config=n,this._ngZone=r,this._keyboardDispatcher=s,this._document=o,this._location=a,this._backdropElement=null,this._backdropClick=new T,this._attachments=new T,this._detachments=new T,this._locationChanges=d.EMPTY,this._backdropClickHandler=e=>this._backdropClick.next(e),this._keydownEvents=new T,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){let t=this._portalOutlet.attach(e);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(ym(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEvents.asObservable()}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=q_(this._config.width),e.height=q_(this._config.height),e.minWidth=q_(this._config.minWidth),e.minHeight=q_(this._config.minHeight),e.maxWidth=q_(this._config.maxWidth),e.maxHeight=q_(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e,t=this._backdropElement;if(!t)return;let i=()=>{t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",i),t.parentNode&&t.parentNode.removeChild(t)),this._backdropElement==t&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(t,this._config.backdropClass,!1),clearTimeout(e)};t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",i)}),t.style.pointerEvents="none",e=this._ngZone.runOutsideAngular(()=>setTimeout(i,500))}_toggleClasses(e,t,i){const n=e.classList;U_(t).forEach(e=>{e&&(i?n.add(e):n.remove(e))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.asObservable().pipe(cy($(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}const kC=/([A-Za-z%]+)$/;class AC{constructor(e,t,i,n,r){this._viewportRuler=t,this._document=i,this._platform=n,this._overlayContainer=r,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new T,this._resizeSubscription=d.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){if(this._overlayRef&&e!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),e.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,n=[];let r;for(let s of this._preferredPositions){let o=this._getOriginPoint(e,s),a=this._getOverlayPoint(o,t,s),l=this._getOverlayFit(a,t,i,s);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(s,o);this._canFitWithFlexibleDimensions(l,a,i)?n.push({position:s,origin:o,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(o,s)}):(!r||r.overlayFit.visibleArea<l.visibleArea)&&(r={overlayFit:l,overlayPoint:a,originPoint:o,position:s,overlayRect:t})}if(n.length){let e=null,t=-1;for(const i of n){const n=i.boundingBoxRect.width*i.boundingBoxRect.height*(i.position.weight||1);n>t&&(t=n,e=i)}return this._isPushed=!1,void this._applyPosition(e.position,e.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(r.position,r.originPoint);this._applyPosition(r.position,r.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&IC(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t){let i,n;if("center"==t.originX)i=e.left+e.width/2;else{const n=this._isRtl()?e.right:e.left,r=this._isRtl()?e.left:e.right;i="start"==t.originX?n:r}return n="center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom,{x:i,y:n}}_getOverlayPoint(e,t,i){let n,r;return n="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,r="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+n,y:e.y+r}}_getOverlayFit(e,t,i,n){let{x:r,y:s}=e,o=this._getOffset(n,"x"),a=this._getOffset(n,"y");o&&(r+=o),a&&(s+=a);let l=0-s,c=s+t.height-i.height,h=this._subtractOverflows(t.width,0-r,r+t.width-i.width),u=this._subtractOverflows(t.height,l,c),d=h*u;return{visibleArea:d,isCompletelyWithinViewport:t.width*t.height===d,fitsInViewportVertically:u===t.height,fitsInViewportHorizontally:h==t.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const n=i.bottom-t.y,r=i.right-t.x,s=RC(this._overlayRef.getConfig().minHeight),o=RC(this._overlayRef.getConfig().minWidth),a=e.fitsInViewportHorizontally||null!=o&&o<=r;return(e.fitsInViewportVertically||null!=s&&s<=n)&&a}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const n=this._viewportRect,r=Math.max(e.x+t.width-n.right,0),s=Math.max(e.y+t.height-n.bottom,0),o=Math.max(n.top-i.top-e.y,0),a=Math.max(n.left-i.left-e.x,0);let l=0,c=0;return l=t.width<=n.width?a||-r:e.x<this._viewportMargin?n.left-i.left-e.x:0,c=t.height<=n.height?o||-s:e.y<this._viewportMargin?n.top-i.top-e.y:0,this._previousPushAmount={x:l,y:c},{x:e.x+l,y:e.y+c}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const t=this._getScrollVisibility(),i=new wC(e,t);this._positionChanges.next(i)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,n=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let r=0;r<t.length;r++)t[r].style.transformOrigin=`${i} ${n}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,n=this._isRtl();let r,s,o,a,l,c;if("top"===t.overlayY)s=e.y,r=i.height-s+this._viewportMargin;else if("bottom"===t.overlayY)o=i.height-e.y+2*this._viewportMargin,r=i.height-o+this._viewportMargin;else{const t=Math.min(i.bottom-e.y+i.top,e.y),n=this._lastBoundingBoxSize.height;r=2*t,s=e.y-t,r>n&&!this._isInitialRender&&!this._growAfterOpen&&(s=e.y-n/2)}if("end"===t.overlayX&&!n||"start"===t.overlayX&&n)c=i.width-e.x+this._viewportMargin,a=e.x-this._viewportMargin;else if("start"===t.overlayX&&!n||"end"===t.overlayX&&n)l=e.x,a=i.right-e.x;else{const t=Math.min(i.right-e.x+i.left,e.x),n=this._lastBoundingBoxSize.width;a=2*t,l=e.x-t,a>n&&!this._isInitialRender&&!this._growAfterOpen&&(l=e.x-n/2)}return{top:s,left:l,bottom:o,right:c,width:a,height:r}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);this._isInitialRender||this._growAfterOpen||(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{const e=this._overlayRef.getConfig().maxHeight,r=this._overlayRef.getConfig().maxWidth;n.height=q_(i.height),n.top=q_(i.top),n.bottom=q_(i.bottom),n.width=q_(i.width),n.left=q_(i.left),n.right=q_(i.right),n.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",n.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",e&&(n.maxHeight=q_(e)),r&&(n.maxWidth=q_(r))}this._lastBoundingBoxSize=i,IC(this._boundingBox.style,n)}_resetBoundingBoxStyles(){IC(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){IC(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},n=this._hasExactPosition(),r=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(n){const n=this._viewportRuler.getViewportScrollPosition();IC(i,this._getExactOverlayY(t,e,n)),IC(i,this._getExactOverlayX(t,e,n))}else i.position="static";let o="",a=this._getOffset(t,"x"),l=this._getOffset(t,"y");a&&(o+=`translateX(${a}px) `),l&&(o+=`translateY(${l}px)`),i.transform=o.trim(),s.maxHeight&&(n?i.maxHeight=q_(s.maxHeight):r&&(i.maxHeight="")),s.maxWidth&&(n?i.maxWidth=q_(s.maxWidth):r&&(i.maxWidth="")),IC(this._pane.style,i)}_getExactOverlayY(e,t,i){let n={top:"",bottom:""},r=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,i));let s=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return r.y-=s,"bottom"===e.overlayY?n.bottom=this._document.documentElement.clientHeight-(r.y+this._overlayRect.height)+"px":n.top=q_(r.y),n}_getExactOverlayX(e,t,i){let n,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),n=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===n?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=q_(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(e=>e.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:_C(e,i),isOriginOutsideView:gC(e,i),isOverlayClipped:_C(t,i),isOverlayOutsideView:gC(t,i)}}_subtractOverflows(e,...t){return t.reduce((e,t)=>e-Math.max(t,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(e=>{SC("originX",e.originX),CC("originY",e.originY),SC("overlayX",e.overlayX),CC("overlayY",e.overlayY)})}_addPanelClasses(e){this._pane&&U_(e).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Fa)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function IC(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function RC(e){if("number"!=typeof e&&null!=e){const[t,i]=e.split(kC);return i&&"px"!==i?null:parseFloat(t)}return e||null}class OC{constructor(e,t,i,n,r,s,o){this._preferredPositions=[],this._positionStrategy=new AC(i,n,r,s,o).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(e,t)}get _isRtl(){return"rtl"===this._overlayRef.getDirection()}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(e){this._positionStrategy.withScrollableContainers(e)}withFallbackPosition(e,t,i,n){const r=new bC(e,t,i,n);return this._preferredPositions.push(r),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}withOffsetX(e){return this._positionStrategy.withDefaultOffsetX(e),this}withOffsetY(e){return this._positionStrategy.withDefaultOffsetY(e),this}withLockedPosition(e){return this._positionStrategy.withLockedPosition(e),this}withPositions(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(e){return this._positionStrategy.setOrigin(e),this}}class NC{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._justifyContent="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:n,height:r,maxWidth:s,maxHeight:o}=i,a=!("100%"!==n&&"100vw"!==n||s&&"100%"!==s&&"100vw"!==s),l=!("100%"!==r&&"100vh"!==r||o&&"100%"!==o&&"100vh"!==o);e.position=this._cssPosition,e.marginLeft=a?"0":this._leftOffset,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,a?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove("cdk-global-overlay-wrapper"),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let DC=(()=>{class e{constructor(e,t,i,n){this._viewportRuler=e,this._document=t,this._platform=i,this._overlayContainer=n}global(){return new NC}connectedTo(e,t,i){return new OC(t,i,e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(e){return new AC(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return e.\u0275fac=function(t){return new(t||e)(Ke(vy),Ke(th),Ke(A_),Ke(PC))},e.\u0275prov=de({factory:function(){return new e(Ke(vy),Ke(th),Ke(A_),Ke(PC))},token:e,providedIn:"root"}),e})(),zC=0,LC=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c){this.scrollStrategies=e,this._overlayContainer=t,this._componentFactoryResolver=i,this._positionBuilder=n,this._keyboardDispatcher=r,this._injector=s,this._ngZone=o,this._document=a,this._directionality=l,this._location=c}create(e){const t=this._createHostElement(),i=this._createPaneElement(t),n=this._createPortalOutlet(i),r=new xC(e);return r.direction=r.direction||this._directionality.value,new MC(n,t,i,r,this._ngZone,this._keyboardDispatcher,this._document,this._location)}position(){return this._positionBuilder}_createPaneElement(e){const t=this._document.createElement("div");return t.id="cdk-overlay-"+zC++,t.classList.add("cdk-overlay-pane"),e.appendChild(t),t}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(qc)),new sC(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return e.\u0275fac=function(t){return new(t||e)(Ke(vC),Ke(PC),Ke(Ba),Ke(DC),Ke(EC),Ke(so),Ke(Cc),Ke(th),Ke(py),Ke(gh,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const BC=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],FC=new je("cdk-connected-overlay-scroll-strategy");let jC=(()=>{class e{constructor(e){this.elementRef=e}}return e.\u0275fac=function(t){return new(t||e)(So(Fa))},e.\u0275dir=bt({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),e})(),VC=(()=>{class e{constructor(e,t,i,n,r){this._overlay=e,this._dir=r,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=d.EMPTY,this.viewportMargin=0,this.open=!1,this.backdropClick=new Ol,this.positionChange=new Ol,this.attach=new Ol,this.detach=new Ol,this.overlayKeydown=new Ol,this._templatePortal=new iC(t,i),this._scrollStrategyFactory=n,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=j_(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=j_(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=j_(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=j_(e)}get push(){return this._push}set push(e){this._push=j_(e)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._overlayRef&&this._overlayRef.dispose(),this._backdropSubscription.unsubscribe()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){this.positions&&this.positions.length||(this.positions=BC),this._overlayRef=this._overlay.create(this._buildConfig()),this._overlayRef.keydownEvents().subscribe(e=>{this.overlayKeydown.next(e),27!==e.keyCode||wy(e)||(e.preventDefault(),this._detachOverlay())})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),t=new xC({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(t.width=this.width),(this.height||0===this.height)&&(t.height=this.height),(this.minWidth||0===this.minWidth)&&(t.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(t.minHeight=this.minHeight),this.backdropClass&&(t.backdropClass=this.backdropClass),this.panelClass&&(t.panelClass=this.panelClass),t}_updatePositionStrategy(e){const t=this.positions.map(e=>({originX:e.originX,originY:e.originY,overlayX:e.overlayX,overlayY:e.overlayY,offsetX:e.offsetX||this.offsetX,offsetY:e.offsetY||this.offsetY,panelClass:e.panelClass||void 0}));return e.setOrigin(this.origin.elementRef).withPositions(t).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(e),e.positionChanges.subscribe(e=>this.positionChange.emit(e)),e}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||(this._overlayRef.attach(this._templatePortal),this.attach.emit()),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe()}_detachOverlay(){this._overlayRef&&(this._overlayRef.detach(),this.detach.emit()),this._backdropSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(So(LC),So(cl),So(ul),So(FC),So(py,8))},e.\u0275dir=bt({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown"},exportAs:["cdkConnectedOverlay"],features:[Ea]}),e})();const UC={provide:FC,deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition()}};let qC=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[LC,UC],imports:[[my,hC,by],by]}),e})();class HC{constructor(e){this.total=e}call(e,t){return t.subscribe(new GC(e,this.total))}}class GC extends f{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}const WC=new Set;let ZC,$C=(()=>{class e{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):XC}matchMedia(e){return this._platform.WEBKIT&&function(e){if(!WC.has(e))try{ZC||(ZC=document.createElement("style"),ZC.setAttribute("type","text/css"),document.head.appendChild(ZC)),ZC.sheet&&(ZC.sheet.insertRule(`@media ${e} {.fx-query-test{ }}`,0),WC.add(e))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(A_))},e.\u0275prov=de({factory:function(){return new e(Ke(A_))},token:e,providedIn:"root"}),e})();function XC(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let KC=(()=>{class e{constructor(e,t){this._mediaMatcher=e,this._zone=t,this._queries=new Map,this._destroySubject=new T}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return YC(U_(e)).some(e=>this._registerQuery(e).mql.matches)}observe(e){let t=Zp(YC(U_(e)).map(e=>this._registerQuery(e).observable));return t=Pm(t.pipe(ym(1)),t.pipe(e=>e.lift(new HC(1)),Cy(0))),t.pipe(B(e=>{const t={matches:!1,breakpoints:{}};return e.forEach(e=>{t.matches=t.matches||e.matches,t.breakpoints[e.query]=e.matches}),t}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const t=this._mediaMatcher.matchMedia(e),i={observable:new b(e=>{const i=t=>this._zone.run(()=>e.next(t));return t.addListener(i),()=>{t.removeListener(i)}}).pipe(Mm(t),B(t=>({query:e,matches:t.matches})),cy(this._destroySubject)),mql:t};return this._queries.set(e,i),i}}return e.\u0275fac=function(t){return new(t||e)(Ke($C),Ke(Cc))},e.\u0275prov=de({factory:function(){return new e(Ke($C),Ke(Cc))},token:e,providedIn:"root"}),e})();function YC(e){return e.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const JC={tooltipState:vu("state",[Su("initial, void, hidden",Cu({opacity:0,transform:"scale(0)"})),Su("visible",Cu({transform:"scale(1)"})),Tu("* => visible",xu("200ms cubic-bezier(0, 0, 0.2, 1)",Eu([Cu({opacity:0,transform:"scale(0)",offset:0}),Cu({opacity:.5,transform:"scale(0.99)",offset:.5}),Cu({opacity:1,transform:"scale(1)",offset:1})]))),Tu("* => hidden",xu("100ms cubic-bezier(0, 0, 0.2, 1)",Cu({opacity:0})))])},QC=L_({passive:!0});function eS(e){return Error(`Tooltip position "${e}" is invalid.`)}const tS=new je("mat-tooltip-scroll-strategy"),iS={provide:tS,deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition({scrollThrottle:20})}},nS=new je("mat-tooltip-default-options",{providedIn:"root",factory:function(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let rS=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,h,u){this._overlay=e,this._elementRef=t,this._scrollDispatcher=i,this._viewContainerRef=n,this._ngZone=r,this._platform=s,this._ariaDescriber=o,this._focusMonitor=a,this._dir=c,this._defaultOptions=h,this._position="below",this._disabled=!1,this.showDelay=this._defaultOptions.showDelay,this.hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=new Map,this._destroyed=new T,this._handleKeydown=e=>{this._isTooltipVisible()&&27===e.keyCode&&!wy(e)&&(e.preventDefault(),e.stopPropagation(),this._ngZone.run(()=>this.hide(0)))},this._scrollStrategy=l,h&&(h.position&&(this.position=h.position),h.touchGestures&&(this.touchGestures=h.touchGestures)),a.monitor(t).pipe(cy(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&r.run(()=>this.show()):r.run(()=>this.hide(0))}),r.runOutsideAngular(()=>{t.nativeElement.addEventListener("keydown",this._handleKeydown)})}get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(),this._tooltipInstance&&this._tooltipInstance.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e),this._disabled&&this.hide(0)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message),this._message=null!=e?(""+e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message)})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngOnInit(){this._setupPointerEvents()}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),e.removeEventListener("keydown",this._handleKeydown),this._passiveListeners.forEach((t,i)=>{e.removeEventListener(i,t,QC)}),this._passiveListeners.clear(),this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const t=this._createOverlay();this._detach(),this._portal=this._portal||new tC(sS,this._viewContainerRef),this._tooltipInstance=t.attach(this._portal).instance,this._tooltipInstance.afterHidden().pipe(cy(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),this._tooltipInstance.show(e)}hide(e=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(e)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const e=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),t=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(".mat-tooltip").withFlexibleDimensions(!1).withViewportMargin(8).withScrollableContainers(e);return t.positionChanges.pipe(cy(this._destroyed)).subscribe(e=>{this._tooltipInstance&&e.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:t,panelClass:"mat-tooltip-panel",scrollStrategy:this._scrollStrategy()}),this._updatePosition(),this._overlayRef.detachments().pipe(cy(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(){const e=this._overlayRef.getConfig().positionStrategy,t=this._getOrigin(),i=this._getOverlayPosition();e.withPositions([Object.assign(Object.assign({},t.main),i.main),Object.assign(Object.assign({},t.fallback),i.fallback)])}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,t=this.position;let i;if("above"==t||"below"==t)i={originX:"center",originY:"above"==t?"top":"bottom"};else if("before"==t||"left"==t&&e||"right"==t&&!e)i={originX:"start",originY:"center"};else{if(!("after"==t||"right"==t&&e||"left"==t&&!e))throw eS(t);i={originX:"end",originY:"center"}}const{x:n,y:r}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:n,originY:r}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,t=this.position;let i;if("above"==t)i={overlayX:"center",overlayY:"bottom"};else if("below"==t)i={overlayX:"center",overlayY:"top"};else if("before"==t||"left"==t&&e||"right"==t&&!e)i={overlayX:"end",overlayY:"center"};else{if(!("after"==t||"right"==t&&e||"left"==t&&!e))throw eS(t);i={overlayX:"start",overlayY:"center"}}const{x:n,y:r}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:n,overlayY:r}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.asObservable().pipe(ym(1),cy(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,t){return"above"===this.position||"below"===this.position?"top"===t?t="bottom":"bottom"===t&&(t="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:t}}_setupPointerEvents(){if(this._platform.IOS||this._platform.ANDROID){if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const e=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};this._passiveListeners.set("touchend",e).set("touchcancel",e).set("touchstart",()=>{clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)})}}else this._passiveListeners.set("mouseenter",()=>this.show()).set("mouseleave",()=>this.hide());this._passiveListeners.forEach((e,t)=>{this._elementRef.nativeElement.addEventListener(t,e,QC)})}_disableNativeGesturesIfNecessary(){const e=this._elementRef.nativeElement,t=e.style,i=this.touchGestures;"off"!==i&&(("on"===i||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName)&&(t.userSelect=t.msUserSelect=t.webkitUserSelect=t.MozUserSelect="none"),"on"!==i&&e.draggable||(t.webkitUserDrag="none"),t.touchAction="none",t.webkitTapHighlightColor="transparent")}}return e.\u0275fac=function(t){return new(t||e)(So(LC),So(Fa),So(_y),So(ul),So(Cc),So(A_),So(Dy),So(Ky),So(tS),So(py,8),So(nS,8),So(Fa))},e.\u0275dir=bt({type:e,selectors:[["","matTooltip",""]],inputs:{showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]}),e})(),sS=(()=>{class e{constructor(e,t){this._changeDetectorRef=e,this._breakpointObserver=t,this._visibility="initial",this._closeOnInteraction=!1,this._onHide=new T,this._isHandset=this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)")}show(e){this._hideTimeoutId&&(clearTimeout(this._hideTimeoutId),this._hideTimeoutId=null),this._closeOnInteraction=!0,this._showTimeoutId=setTimeout(()=>{this._visibility="visible",this._showTimeoutId=null,this._markForCheck()},e)}hide(e){this._showTimeoutId&&(clearTimeout(this._showTimeoutId),this._showTimeoutId=null),this._hideTimeoutId=setTimeout(()=>{this._visibility="hidden",this._hideTimeoutId=null,this._markForCheck()},e)}afterHidden(){return this._onHide.asObservable()}isVisible(){return"visible"===this._visibility}ngOnDestroy(){this._onHide.complete()}_animationStart(){this._closeOnInteraction=!1}_animationDone(e){const t=e.toState;"hidden"!==t||this.isVisible()||this._onHide.next(),"visible"!==t&&"hidden"!==t||(this._closeOnInteraction=!0)}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(So(qs),So(KC))},e.\u0275cmp=ft({type:e,selectors:[["mat-tooltip-component"]],hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,t){1&e&&Lo("click",(function(){return t._handleBodyInteraction()}),!1,qi),2&e&&ta("zoom","visible"===t._visibility?1:null)},decls:3,vars:7,consts:[[1,"mat-tooltip",3,"ngClass"]],template:function(e,t){var i;1&e&&(ko(0,"div",0),Lo("@state.start",(function(){return t._animationStart()}))("@state.done",(function(e){return t._animationDone(e)})),function(e,t){const i=Yt();let n;i.firstCreatePass?(n=function(e,t){if(t)for(let i=t.length-1;i>=0;i--){const e=t[i];if("async"===e.name)return e}throw new Error("The pipe 'async' could not be found!")}(0,i.pipeRegistry),i.data[21]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(21,n.onDestroy)):n=i.data[21];const r=n.factory||(n.factory=St(n.type)),s=$e(So),o=Wi(!1),a=r();Wi(o),$e(s),function(e,t,i,n){21>=e.data.length&&(e.data[21]=null,e.blueprint[21]=null),t[21]=n}(i,Kt(),0,a)}(),pa(2),Ao()),2&e&&(ia("mat-tooltip-handset",null==(i=function(e,t,i){const n=Kt(),r=jt(n,e);return function(e,t){return fo.isWrapped(t)&&(t=fo.unwrap(t),e[$t.lFrame.bindingIndex]=ur),t}(n,function(e,t){return e[1].data[t+20].pure}(n,e)?Rl(n,si(),t,r.transform,i,r):r.transform(i))}(1,5,t._isHandset))?null:i.matches),Po("ngClass",t.tooltipClass)("@state",t._visibility),gr(2),ma(t.message))},directives:[Ch],pipes:[Bh],styles:[".mat-tooltip-panel{pointer-events:none !important}.mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}\n"],encapsulation:2,data:{animation:[JC.tooltipState]},changeDetection:0}),e})(),oS=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[iS],imports:[[ev,Fh,qC,lv],lv,xy]}),e})();const aS=["mat-button",""],lS=["*"],cS=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class hS{constructor(e){this._elementRef=e}}const uS=hv(cv(uv(hS)));let dS=(()=>{class e extends uS{constructor(e,t,i){super(e),this._focusMonitor=t,this._animationMode=i,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const n of cS)this._hasHostAttributes(n)&&this._getHostElement().classList.add(n);e.nativeElement.classList.add("mat-button-base"),this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color="accent")}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",t){this._focusMonitor.focusVia(this._getHostElement(),e,t)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(e=>this._getHostElement().hasAttribute(e))}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(Ky),So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,t){var i;1&e&&Wl(Bv,!0),2&e&&Hl(i=Yl())&&(t.ripple=i.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:3,hostBindings:function(e,t){2&e&&(xo("disabled",t.disabled||null),ia("_mat-animation-noopable","NoopAnimations"===t._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[va],attrs:aS,ngContentSelectors:lS,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,t){1&e&&(Ho(),ko(0,"span",0),Go(1),Ao(),Io(2,"div",1),Io(3,"div",2)),2&e&&(gr(2),ia("mat-button-ripple-round",t.isRoundButton||t.isIconButton),Po("matRippleDisabled",t._isRippleDisabled())("matRippleCentered",t.isIconButton)("matRippleTrigger",t._getHostElement()))},directives:[Bv],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),e})(),pS=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fv,lv],lv]}),e})();function mS(e,t){1&e&&Go(0)}const fS=["*"];function gS(e,t){}const _S=function(e){return{animationDuration:e}},yS=function(e,t){return{value:e,params:t}},vS=["tabBodyWrapper"],xS=["tabHeader"];function bS(e,t){}function wS(e,t){1&e&&wo(0,bS,0,0,"ng-template",9),2&e&&Po("cdkPortalOutlet",Uo().$implicit.templateLabel)}function CS(e,t){1&e&&pa(0),2&e&&ma(Uo().$implicit.textLabel)}function SS(e,t){if(1&e){const e=No();ko(0,"div",6),Lo("click",(function(){Jt(e);const i=t.$implicit,n=t.index,r=Uo(),s=Co(1);return r._handleClick(i,s,n)})),ko(1,"div",7),wo(2,wS,1,1,"ng-template",8),wo(3,CS,1,1,"ng-template",8),Ao(),Ao()}if(2&e){const e=t.$implicit,i=t.index,n=Uo();ia("mat-tab-label-active",n.selectedIndex==i),Po("id",n._getTabLabelId(i))("disabled",e.disabled)("matRippleDisabled",e.disabled||n.disableRipple),xo("tabIndex",n._getTabIndex(e,i))("aria-posinset",i+1)("aria-setsize",n._tabs.length)("aria-controls",n._getTabContentId(i))("aria-selected",n.selectedIndex==i)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null),gr(2),Po("ngIf",e.templateLabel),gr(1),Po("ngIf",!e.templateLabel)}}function ES(e,t){if(1&e){const e=No();ko(0,"mat-tab-body",10),Lo("_onCentered",(function(){return Jt(e),Uo()._removeTabBodyWrapperHeight()}))("_onCentering",(function(t){return Jt(e),Uo()._setTabBodyWrapperHeight(t)})),Ao()}if(2&e){const e=t.$implicit,i=t.index,n=Uo();ia("mat-tab-body-active",n.selectedIndex==i),Po("id",n._getTabContentId(i))("content",e.content)("position",e.position)("origin",e.origin)("animationDuration",n.animationDuration),xo("aria-labelledby",n._getTabLabelId(i))}}const TS=["tabListContainer"],PS=["tabList"],MS=["nextPaginator"],kS=["previousPaginator"],AS=new je("MatInkBarPositioner",{providedIn:"root",factory:function(){return e=>({left:e?(e.offsetLeft||0)+"px":"0",width:e?(e.offsetWidth||0)+"px":"0"})}});let IS=(()=>{class e{constructor(e,t,i,n){this._elementRef=e,this._ngZone=t,this._inkBarPositioner=i,this._animationMode=n}alignToElement(e){this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(e))}):this._setStyles(e)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(e){const t=this._inkBarPositioner(e),i=this._elementRef.nativeElement;i.style.left=t.left,i.style.width=t.width}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(Cc),So(AS),So(jp,8))},e.\u0275dir=bt({type:e,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(e,t){2&e&&ia("_mat-animation-noopable","NoopAnimations"===t._animationMode)}}),e})(),RS=(()=>{class e{constructor(e){this.template=e}}return e.\u0275fac=function(t){return new(t||e)(So(cl))},e.\u0275dir=bt({type:e,selectors:[["","matTabContent",""]]}),e})(),OS=(()=>{class e extends oC{}return e.\u0275fac=function(t){return NS(t||e)},e.\u0275dir=bt({type:e,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[va]}),e})();const NS=cn(OS);class DS{}const zS=cv(DS),LS=new je("MAT_TAB_GROUP");let BS=(()=>{class e extends zS{constructor(e,t){super(),this._viewContainerRef=e,this._closestTabGroup=t,this.textLabel="",this._contentPortal=null,this._stateChanges=new T,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(e){e&&(this._templateLabel=e)}get content(){return this._contentPortal}ngOnChanges(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new iC(this._explicitContent||this._implicitContent,this._viewContainerRef)}}return e.\u0275fac=function(t){return new(t||e)(So(ul),So(LS,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-tab"]],contentQueries:function(e,t,i){var n;1&e&&($l(i,OS,!0),Xl(i,RS,!0,cl)),2&e&&(Hl(n=Yl())&&(t.templateLabel=n.first),Hl(n=Yl())&&(t._explicitContent=n.first))},viewQuery:function(e,t){var i;1&e&&Gl(cl,!0),2&e&&Hl(i=Yl())&&(t._implicitContent=i.first)},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[va,Ea],ngContentSelectors:fS,decls:1,vars:0,template:function(e,t){1&e&&(Ho(),wo(0,mS,1,0,"ng-template"))},encapsulation:2}),e})();const FS={translateTab:vu("translateTab",[Su("center, void, left-origin-center, right-origin-center",Cu({transform:"none"})),Su("left",Cu({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),Su("right",Cu({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),Tu("* => left, * => right, left => center, right => center",xu("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Tu("void => left-origin-center",[Cu({transform:"translate3d(-100%, 0, 0)"}),xu("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Tu("void => right-origin-center",[Cu({transform:"translate3d(100%, 0, 0)"}),xu("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let jS=(()=>{class e extends aC{constructor(e,t,i,n){super(e,t,n),this._host=i,this._centeringSub=d.EMPTY,this._leavingSub=d.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Mm(this._host._isCenterPosition(this._host._position))).subscribe(e=>{e&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(So(Ba),So(ul),So(Ee(()=>US)),So(th))},e.\u0275dir=bt({type:e,selectors:[["","matTabBodyHost",""]],features:[va]}),e})(),VS=(()=>{class e{constructor(e,t,i){this._elementRef=e,this._dir=t,this._dirChangeSubscription=d.EMPTY,this._translateTabComplete=new T,this._onCentering=new Ol,this._beforeCentering=new Ol,this._afterLeavingCenter=new Ol,this._onCentered=new Ol(!0),this.animationDuration="500ms",t&&(this._dirChangeSubscription=t.change.subscribe(e=>{this._computePositionAnimationState(e),i.markForCheck()})),this._translateTabComplete.pipe(Q_((e,t)=>e.fromState===t.fromState&&e.toState===t.toState)).subscribe(e=>{this._isCenterPosition(e.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(e.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(e){this._positionIndex=e,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(e){const t=this._isCenterPosition(e.toState);this._beforeCentering.emit(t),t&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}_computePositionAnimationState(e=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}_computePositionFromOrigin(e){const t=this._getLayoutDirection();return"ltr"==t&&e<=0||"rtl"==t&&e>0?"left-origin-center":"right-origin-center"}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(py,8),So(qs))},e.\u0275dir=bt({type:e,inputs:{animationDuration:"animationDuration",position:"position",_content:["content","_content"],origin:"origin"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),e})(),US=(()=>{class e extends VS{constructor(e,t,i){super(e,t,i)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(py,8),So(qs))},e.\u0275cmp=ft({type:e,selectors:[["mat-tab-body"]],viewQuery:function(e,t){var i;1&e&&Wl(lC,!0),2&e&&Hl(i=Yl())&&(t._portalHost=i.first)},hostAttrs:[1,"mat-tab-body"],features:[va],decls:3,vars:6,consts:[[1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(e,t){1&e&&(ko(0,"div",0,1),Lo("@translateTab.start",(function(e){return t._onTranslateTabStarted(e)}))("@translateTab.done",(function(e){return t._translateTabComplete.next(e)})),wo(2,gS,0,0,"ng-template",2),Ao()),2&e&&Po("@translateTab",Al(3,yS,t._position,kl(1,_S,t.animationDuration)))},directives:[jS],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[FS.translateTab]}}),e})();const qS=new je("MAT_TABS_CONFIG");let HS=0;class GS{}class WS{constructor(e){this._elementRef=e}}const ZS=hv(uv(WS),"primary");let $S=(()=>{class e extends ZS{constructor(e,t,i,n){super(e),this._changeDetectorRef=t,this._animationMode=n,this._tabs=new Dl,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=d.EMPTY,this._tabLabelSubscription=d.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new Ol,this.focusChange=new Ol,this.animationDone=new Ol,this.selectedTabChange=new Ol(!0),this._groupId=HS++,this.animationDuration=i&&i.animationDuration?i.animationDuration:"500ms",this.disablePagination=!(!i||null==i.disablePagination)&&i.disablePagination}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(e){this._dynamicHeight=j_(e)}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._indexToSelect=V_(e,null)}get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){const t=this._elementRef.nativeElement;t.classList.remove("mat-background-"+this.backgroundColor),e&&t.classList.add("mat-background-"+e),this._backgroundColor=e}ngAfterContentChecked(){const e=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=e){const t=null==this._selectedIndex;t||this.selectedTabChange.emit(this._createChangeEvent(e)),Promise.resolve().then(()=>{this._tabs.forEach((t,i)=>t.isActive=i===e),t||this.selectedIndexChange.emit(e)})}this._tabs.forEach((t,i)=>{t.position=i-e,null==this._selectedIndex||0!=t.position||t.origin||(t.origin=e-this._selectedIndex)}),this._selectedIndex!==e&&(this._selectedIndex=e,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const e=this._tabs.toArray();for(let t=0;t<e.length;t++)if(e[t].isActive){this._indexToSelect=this._selectedIndex=t;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Mm(this._allTabs)).subscribe(e=>{this._tabs.reset(e.filter(e=>!e._closestTabGroup||e._closestTabGroup===this)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}_focusChanged(e){this.focusChange.emit(this._createChangeEvent(e))}_createChangeEvent(e){const t=new GS;return t.index=e,this._tabs&&this._tabs.length&&(t.tab=this._tabs.toArray()[e]),t}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=$(...this._tabs.map(e=>e._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}_getTabLabelId(e){return`mat-tab-label-${this._groupId}-${e}`}_getTabContentId(e){return`mat-tab-content-${this._groupId}-${e}`}_setTabBodyWrapperHeight(e){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const t=this._tabBodyWrapper.nativeElement;t.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(t.style.height=e+"px")}_removeTabBodyWrapperHeight(){const e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}_handleClick(e,t,i){e.disabled||(this.selectedIndex=t.focusIndex=i)}_getTabIndex(e,t){return e.disabled?null:this.selectedIndex===t?0:-1}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(qS,8),So(jp,8))},e.\u0275dir=bt({type:e,inputs:{headerPosition:"headerPosition",animationDuration:"animationDuration",disablePagination:"disablePagination",dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[va]}),e})(),XS=(()=>{class e extends $S{constructor(e,t,i,n){super(e,t,i,n)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(qS,8),So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-tab-group"]],contentQueries:function(e,t,i){var n;1&e&&$l(i,BS,!0),2&e&&Hl(n=Yl())&&(t._allTabs=n)},viewQuery:function(e,t){var i;1&e&&(Wl(vS,!0),Wl(xS,!0)),2&e&&(Hl(i=Yl())&&(t._tabBodyWrapper=i.first),Hl(i=Yl())&&(t._tabHeader=i.first))},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(e,t){2&e&&ia("mat-tab-group-dynamic-height",t.dynamicHeight)("mat-tab-group-inverted-header","below"===t.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[Da([{provide:LS,useExisting:e}]),va],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(e,t){1&e&&(ko(0,"mat-tab-header",0,1),Lo("indexFocused",(function(e){return t._focusChanged(e)}))("selectFocusedIndex",(function(e){return t.selectedIndex=e})),wo(2,SS,4,14,"div",2),Ao(),ko(3,"div",3,4),wo(5,ES,1,8,"mat-tab-body",5),Ao()),2&e&&(Po("selectedIndex",t.selectedIndex||0)("disableRipple",t.disableRipple)("disablePagination",t.disablePagination),gr(2),Po("ngForOf",t._tabs),gr(1),ia("_mat-animation-noopable","NoopAnimations"===t._animationMode),gr(2),Po("ngForOf",t._tabs))},directives:function(){return[iE,Eh,JS,Bv,Jy,Ph,aC,US]},styles:[".mat-tab-group{display:flex;flex-direction:column}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),e})();class KS{}const YS=cv(KS);let JS=(()=>{class e extends YS{constructor(e){super(),this.elementRef=e}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return e.\u0275fac=function(t){return new(t||e)(So(Fa))},e.\u0275dir=bt({type:e,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(e,t){2&e&&(xo("aria-disabled",!!t.disabled),ia("mat-tab-disabled",t.disabled))},inputs:{disabled:"disabled"},features:[va]}),e})();const QS=L_({passive:!0});let eE=(()=>{class e{constructor(e,t,i,n,r,s,o){this._elementRef=e,this._changeDetectorRef=t,this._viewportRuler=i,this._dir=n,this._ngZone=r,this._platform=s,this._animationMode=o,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new T,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new T,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Ol,this.indexFocused=new Ol,r.runOutsideAngular(()=>{G_(e.nativeElement,"mouseleave").pipe(cy(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){e=V_(e),this._selectedIndex!=e&&(this._selectedIndexChanged=!0,this._selectedIndex=e,this._keyManager&&this._keyManager.updateActiveItem(e))}ngAfterViewInit(){G_(this._previousPaginator.nativeElement,"touchstart",QS).pipe(cy(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),G_(this._nextPaginator.nativeElement,"touchstart",QS).pipe(cy(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const e=this._dir?this._dir.change:qp(null),t=this._viewportRuler.change(150),i=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new By(this._items).withHorizontalOrientation(this._getLayoutDirection()).withWrap(),this._keyManager.updateActiveItem(0),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(i):i(),$(e,t,this._items.changes).pipe(cy(this._destroyed)).subscribe(()=>{Promise.resolve().then(i),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(cy(this._destroyed)).subscribe(e=>{this.indexFocused.emit(e),this._setTabFocus(e)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(e){if(!wy(e))switch(e.keyCode){case 36:this._keyManager.setFirstItemActive(),e.preventDefault();break;case 35:this._keyManager.setLastItemActive(),e.preventDefault();break;case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e));break;default:this._keyManager.onKeydown(e)}}_onContentChanges(){const e=this._elementRef.nativeElement.textContent;e!==this._currentTextContent&&(this._currentTextContent=e||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(e){this._isValidIndex(e)&&this.focusIndex!==e&&this._keyManager&&this._keyManager.setActiveItem(e)}_isValidIndex(e){if(!this._items)return!0;const t=this._items?this._items.toArray()[e]:null;return!!t&&!t.disabled}_setTabFocus(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();const t=this._tabListContainer.nativeElement,i=this._getLayoutDirection();t.scrollLeft="ltr"==i?0:t.scrollWidth-t.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const e=this.scrollDistance,t=this._platform,i="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform=`translateX(${Math.round(i)}px)`,t&&(t.TRIDENT||t.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(e){this._scrollTo(e)}_scrollHeader(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(e){this._stopInterval(),this._scrollHeader(e)}_scrollToLabel(e){if(this.disablePagination)return;const t=this._items?this._items.toArray()[e]:null;if(!t)return;const i=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:n,offsetWidth:r}=t.elementRef.nativeElement;let s,o;"ltr"==this._getLayoutDirection()?(s=n,o=s+r):(o=this._tabList.nativeElement.offsetWidth-n,s=o-r);const a=this.scrollDistance,l=this.scrollDistance+i;s<a?this.scrollDistance-=a-s+60:o>l&&(this.scrollDistance+=o-l+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const e=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;e||(this.scrollDistance=0),e!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=e}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,t=e?e.elementRef.nativeElement:null;t?this._inkBar.alignToElement(t):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(e,t){t&&null!=t.button&&0!==t.button||(this._stopInterval(),oy(650,100).pipe(cy($(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:t,distance:i}=this._scrollHeader(e);(0===i||i>=t)&&this._stopInterval()}))}_scrollTo(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const t=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(t,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:t,distance:this._scrollDistance}}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(vy),So(py,8),So(Cc),So(A_),So(jp,8))},e.\u0275dir=bt({type:e,inputs:{disablePagination:"disablePagination"}}),e})(),tE=(()=>{class e extends eE{constructor(e,t,i,n,r,s,o){super(e,t,i,n,r,s,o),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=j_(e)}_itemSelected(e){e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(vy),So(py,8),So(Cc),So(A_),So(jp,8))},e.\u0275dir=bt({type:e,inputs:{disableRipple:"disableRipple"},features:[va]}),e})(),iE=(()=>{class e extends tE{constructor(e,t,i,n,r,s,o){super(e,t,i,n,r,s,o)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(vy),So(py,8),So(Cc),So(A_),So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-tab-header"]],contentQueries:function(e,t,i){var n;1&e&&$l(i,JS,!1),2&e&&Hl(n=Yl())&&(t._items=n)},viewQuery:function(e,t){var i;1&e&&(Gl(IS,!0),Gl(TS,!0),Gl(PS,!0),Wl(MS,!0),Wl(kS,!0)),2&e&&(Hl(i=Yl())&&(t._inkBar=i.first),Hl(i=Yl())&&(t._tabListContainer=i.first),Hl(i=Yl())&&(t._tabList=i.first),Hl(i=Yl())&&(t._nextPaginator=i.first),Hl(i=Yl())&&(t._previousPaginator=i.first))},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(e,t){2&e&&ia("mat-tab-header-pagination-controls-enabled",t._showPaginationControls)("mat-tab-header-rtl","rtl"==t._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[va],ngContentSelectors:fS,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(e,t){1&e&&(Ho(),ko(0,"div",0,1),Lo("click",(function(){return t._handlePaginatorClick("before")}))("mousedown",(function(e){return t._handlePaginatorPress("before",e)}))("touchend",(function(){return t._stopInterval()})),Io(2,"div",2),Ao(),ko(3,"div",3,4),Lo("keydown",(function(e){return t._handleKeydown(e)})),ko(5,"div",5,6),Lo("cdkObserveContent",(function(){return t._onContentChanges()})),ko(7,"div",7),Go(8),Ao(),Io(9,"mat-ink-bar"),Ao(),Ao(),ko(10,"div",8,9),Lo("mousedown",(function(e){return t._handlePaginatorPress("after",e)}))("click",(function(){return t._handlePaginatorClick("after")}))("touchend",(function(){return t._stopInterval()})),Io(12,"div",2),Ao()),2&e&&(ia("mat-tab-header-pagination-disabled",t._disableScrollBefore),Po("matRippleDisabled",t._disableScrollBefore||t.disableRipple),gr(5),ia("_mat-animation-noopable","NoopAnimations"===t._animationMode),gr(5),ia("mat-tab-header-pagination-disabled",t._disableScrollAfter),Po("matRippleDisabled",t._disableScrollAfter||t.disableRipple))},directives:[Bv,ky,IS],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),e})(),nE=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lv,hC,Fv,Ay,ev],lv]}),e})();const rE=L_({passive:!0});let sE=(()=>{class e{constructor(e,t){this._platform=e,this._ngZone=t,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Kp;const t=H_(e),i=this._monitoredElements.get(t);if(i)return i.subject.asObservable();const n=new T,r="cdk-text-field-autofilled",s=e=>{"cdk-text-field-autofill-start"!==e.animationName||t.classList.contains(r)?"cdk-text-field-autofill-end"===e.animationName&&t.classList.contains(r)&&(t.classList.remove(r),this._ngZone.run(()=>n.next({target:e.target,isAutofilled:!1}))):(t.classList.add(r),this._ngZone.run(()=>n.next({target:e.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{t.addEventListener("animationstart",s,rE),t.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(t,{subject:n,unlisten:()=>{t.removeEventListener("animationstart",s,rE)}}),n.asObservable()}stopMonitoring(e){const t=H_(e),i=this._monitoredElements.get(t);i&&(i.unlisten(),i.subject.complete(),t.classList.remove("cdk-text-field-autofill-monitored"),t.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(t))}ngOnDestroy(){this._monitoredElements.forEach((e,t)=>this.stopMonitoring(t))}}return e.\u0275fac=function(t){return new(t||e)(Ke(A_),Ke(Cc))},e.\u0275prov=de({factory:function(){return new e(Ke(A_),Ke(Cc))},token:e,providedIn:"root"}),e})(),oE=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[I_]]}),e})();const aE=["underline"],lE=["connectionContainer"],cE=["inputContainer"],hE=["label"];function uE(e,t){1&e&&(Ro(0),ko(1,"div",14),Io(2,"div",15),Io(3,"div",16),Io(4,"div",17),Ao(),ko(5,"div",18),Io(6,"div",15),Io(7,"div",16),Io(8,"div",17),Ao(),Oo())}function dE(e,t){1&e&&(ko(0,"div",19),Go(1,1),Ao())}function pE(e,t){if(1&e&&(Ro(0),Go(1,2),ko(2,"span"),pa(3),Ao(),Oo()),2&e){const e=Uo(2);gr(3),ma(e._control.placeholder)}}function mE(e,t){1&e&&Go(0,3,["*ngSwitchCase","true"])}function fE(e,t){1&e&&(ko(0,"span",23),pa(1," *"),Ao())}function gE(e,t){if(1&e){const e=No();ko(0,"label",20,21),Lo("cdkObserveContent",(function(){return Jt(e),Uo().updateOutlineGap()})),wo(2,pE,4,1,"ng-container",12),wo(3,mE,1,0,void 0,12),wo(4,fE,2,0,"span",22),Ao()}if(2&e){const e=Uo();ia("mat-empty",e._control.empty&&!e._shouldAlwaysFloat)("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),Po("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),xo("for",e._control.id)("aria-owns",e._control.id),gr(2),Po("ngSwitchCase",!1),gr(1),Po("ngSwitchCase",!0),gr(1),Po("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function _E(e,t){1&e&&(ko(0,"div",24),Go(1,4),Ao())}function yE(e,t){if(1&e&&(ko(0,"div",25,26),Io(2,"span",27),Ao()),2&e){const e=Uo();gr(2),ia("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function vE(e,t){1&e&&(ko(0,"div"),Go(1,5),Ao()),2&e&&Po("@transitionMessages",Uo()._subscriptAnimationState)}function xE(e,t){if(1&e&&(ko(0,"div",31),pa(1),Ao()),2&e){const e=Uo(2);Po("id",e._hintLabelId),gr(1),ma(e.hintLabel)}}function bE(e,t){if(1&e&&(ko(0,"div",28),wo(1,xE,2,2,"div",29),Go(2,6),Io(3,"div",30),Go(4,7),Ao()),2&e){const e=Uo();Po("@transitionMessages",e._subscriptAnimationState),gr(1),Po("ngIf",e.hintLabel)}}const wE=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],CE=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"];let SE=0,EE=(()=>{class e{constructor(){this.id="mat-error-"+SE++}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-error"]],hostAttrs:["role","alert",1,"mat-error"],hostVars:1,hostBindings:function(e,t){2&e&&xo("id",t.id)},inputs:{id:"id"}}),e})();const TE={transitionMessages:vu("transitionMessages",[Su("enter",Cu({opacity:1,transform:"translateY(0%)"})),Tu("void => enter",[Cu({opacity:0,transform:"translateY(-100%)"}),xu("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let PE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e}),e})();function ME(e){return Error(`A hint was already declared for 'align="${e}"'.`)}let kE=0,AE=(()=>{class e{constructor(){this.align="start",this.id="mat-hint-"+kE++}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(e,t){2&e&&(xo("id",t.id)("align",null),ia("mat-right","end"==t.align))},inputs:{align:"align",id:"id"}}),e})(),IE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-label"]]}),e})(),RE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-placeholder"]]}),e})(),OE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","matPrefix",""]]}),e})(),NE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","matSuffix",""]]}),e})(),DE=0;class zE{constructor(e){this._elementRef=e}}const LE=hv(zE,"primary"),BE=new je("MAT_FORM_FIELD_DEFAULT_OPTIONS"),FE=new je("MatFormField");let jE=(()=>{class e extends LE{constructor(e,t,i,n,r,s,o,a){super(e),this._elementRef=e,this._changeDetectorRef=t,this._dir=n,this._defaults=r,this._platform=s,this._ngZone=o,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new T,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+DE++,this._labelId="mat-form-field-label-"+DE++,this._labelOptions=i||{},this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==a,this.appearance=r&&r.appearance?r.appearance:"legacy",this._hideRequiredMarker=!(!r||null==r.hideRequiredMarker)&&r.hideRequiredMarker}get appearance(){return this._appearance}set appearance(e){const t=this._appearance;this._appearance=e||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&t!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=j_(e)}get _shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}get _canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}get _labelChild(){return this._labelChildNonStatic||this._labelChildStatic}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add("mat-form-field-type-"+e.controlType),e.stateChanges.pipe(Mm(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(cy(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.asObservable().pipe(cy(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),$(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Mm(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Mm(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(cy(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const t=this._control?this._control.ngControl:null;return t&&t[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!!this._labelChild}_shouldLabelFloat(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,G_(this._label.nativeElement,"transitionend").pipe(ym(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){if(this._hintChildren){let e,t;this._hintChildren.forEach(i=>{if("start"===i.align){if(e||this.hintLabel)throw ME("start");e=i}else if("end"===i.align){if(t)throw ME("end");t=i}})}}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if("hint"===this._getDisplayedMessages()){const t=this._hintChildren?this._hintChildren.find(e=>"start"===e.align):null,i=this._hintChildren?this._hintChildren.find(e=>"end"===e.align):null;t?e.push(t.id):this._hintLabel&&e.push(this._hintLabelId),i&&e.push(i.id)}else this._errorChildren&&(e=this._errorChildren.map(e=>e.id));this._control.setDescribedByIds(e)}}_validateControlChild(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}updateOutlineGap(){const e=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!e||!e.children.length||!e.textContent.trim())return;if(!this._platform.isBrowser)return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let t=0,i=0;const n=this._connectionContainerRef.nativeElement,r=n.querySelectorAll(".mat-form-field-outline-start"),s=n.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const r=n.getBoundingClientRect();if(0===r.width&&0===r.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const s=this._getStartEnd(r),o=this._getStartEnd(e.children[0].getBoundingClientRect());let a=0;for(const t of e.children)a+=t.offsetWidth;t=Math.abs(o-s)-5,i=a>0?.75*a+10:0}for(let o=0;o<r.length;o++)r[o].style.width=t+"px";for(let o=0;o<s.length;o++)s[o].style.width=i+"px";this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const t=e.getRootNode();return t&&t!==e}return document.documentElement.contains(e)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qs),So(Qv,8),So(py,8),So(BE,8),So(A_),So(Cc),So(jp,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-form-field"]],contentQueries:function(e,t,i){var n;1&e&&($l(i,PE,!0),Xl(i,PE,!0),$l(i,IE,!0),Xl(i,IE,!0),$l(i,RE,!0),$l(i,EE,!0),$l(i,AE,!0),$l(i,OE,!0),$l(i,NE,!0)),2&e&&(Hl(n=Yl())&&(t._controlNonStatic=n.first),Hl(n=Yl())&&(t._controlStatic=n.first),Hl(n=Yl())&&(t._labelChildNonStatic=n.first),Hl(n=Yl())&&(t._labelChildStatic=n.first),Hl(n=Yl())&&(t._placeholderChild=n.first),Hl(n=Yl())&&(t._errorChildren=n),Hl(n=Yl())&&(t._hintChildren=n),Hl(n=Yl())&&(t._prefixChildren=n),Hl(n=Yl())&&(t._suffixChildren=n))},viewQuery:function(e,t){var i;1&e&&(Wl(aE,!0),Gl(lE,!0),Wl(cE,!0),Wl(hE,!0)),2&e&&(Hl(i=Yl())&&(t.underlineRef=i.first),Hl(i=Yl())&&(t._connectionContainerRef=i.first),Hl(i=Yl())&&(t._inputContainerRef=i.first),Hl(i=Yl())&&(t._label=i.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(e,t){2&e&&ia("mat-form-field-appearance-standard","standard"==t.appearance)("mat-form-field-appearance-fill","fill"==t.appearance)("mat-form-field-appearance-outline","outline"==t.appearance)("mat-form-field-appearance-legacy","legacy"==t.appearance)("mat-form-field-invalid",t._control.errorState)("mat-form-field-can-float",t._canLabelFloat)("mat-form-field-should-float",t._shouldLabelFloat())("mat-form-field-has-label",t._hasFloatingLabel())("mat-form-field-hide-placeholder",t._hideControlPlaceholder())("mat-form-field-disabled",t._control.disabled)("mat-form-field-autofilled",t._control.autofilled)("mat-focused",t._control.focused)("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)("ng-untouched",t._shouldForward("untouched"))("ng-touched",t._shouldForward("touched"))("ng-pristine",t._shouldForward("pristine"))("ng-dirty",t._shouldForward("dirty"))("ng-valid",t._shouldForward("valid"))("ng-invalid",t._shouldForward("invalid"))("ng-pending",t._shouldForward("pending"))("_mat-animation-noopable",!t._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Da([{provide:FE,useExisting:e}]),va],ngContentSelectors:CE,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,t){1&e&&(Ho(wE),ko(0,"div",0),ko(1,"div",1,2),Lo("click",(function(e){return t._control.onContainerClick&&t._control.onContainerClick(e)})),wo(3,uE,9,0,"ng-container",3),wo(4,dE,2,0,"div",4),ko(5,"div",5,6),Go(7),ko(8,"span",7),wo(9,gE,5,16,"label",8),Ao(),Ao(),wo(10,_E,2,0,"div",9),Ao(),wo(11,yE,3,4,"div",10),ko(12,"div",11),wo(13,vE,2,1,"div",12),wo(14,bE,5,2,"div",13),Ao(),Ao()),2&e&&(gr(3),Po("ngIf","outline"==t.appearance),gr(1),Po("ngIf",t._prefixChildren.length),gr(5),Po("ngIf",t._hasFloatingLabel()),gr(1),Po("ngIf",t._suffixChildren.length),gr(1),Po("ngIf","outline"!=t.appearance),gr(1),Po("ngSwitch",t._getDisplayedMessages()),gr(1),Po("ngSwitchCase","error"),gr(1),Po("ngSwitchCase","hint"))},directives:[Ph,Ih,Rh,ky],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[TE.transitionMessages]},changeDetection:0}),e})(),VE=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lv,Ay],lv]}),e})();const UE=new je("MAT_INPUT_VALUE_ACCESSOR"),qE=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let HE=0;class GE{constructor(e,t,i,n){this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=i,this.ngControl=n}}const WE=pv(GE);let ZE=(()=>{class e extends WE{constructor(e,t,i,n,r,s,o,a,l){super(s,n,r,i),this._elementRef=e,this._platform=t,this.ngControl=i,this._autofillMonitor=a,this._uid="mat-input-"+HE++,this.focused=!1,this.stateChanges=new T,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(e=>O_().has(e));const c=this._elementRef.nativeElement,h=c.nodeName.toLowerCase();this._inputValueAccessor=o||c,this._previousNativeValue=this.value,this.id=this.id,t.IOS&&l.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",e=>{let t=e.target;t.value||t.selectionStart||t.selectionEnd||(t.setSelectionRange(1,1),t.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===h,this._isTextarea="textarea"===h,this._isNativeSelect&&(this.controlType=c.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=j_(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required}set required(e){this._required=j_(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&O_().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=j_(e)}ngOnInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e===this.focused||this.readonly&&e||(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){if(qE.indexOf(this._type)>-1)throw Error(`Input type "${this._type}" isn't supported by matInput.`)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,t=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&t&&t.label)}return this.focused||!this.empty}setDescribedByIds(e){this._ariaDescribedby=e.join(" ")}onContainerClick(){this.focused||this.focus()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(A_),So(Mb,10),So(ww,8),So(Ow,8),So(Pv),So(UE,10),So(sE),So(Cc))},e.\u0275dir=bt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(e,t){1&e&&Lo("focus",(function(){return t._focusChanged(!0)}))("blur",(function(){return t._focusChanged(!1)}))("input",(function(){return t._onInput()})),2&e&&(ga("disabled",t.disabled)("required",t.required),xo("id",t.id)("placeholder",t.placeholder)("readonly",t.readonly&&!t._isNativeSelect||null)("aria-describedby",t._ariaDescribedby||null)("aria-invalid",t.errorState)("aria-required",t.required.toString()),ia("mat-input-server",t._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[Da([{provide:PE,useExisting:e}]),va,Ea]}),e})(),$E=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[Pv],imports:[[oE,VE],oE,VE]}),e})(),XE=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv],lv]}),e})();const KE=["trigger"],YE=["panel"];function JE(e,t){if(1&e&&(ko(0,"span",8),pa(1),Ao()),2&e){const e=Uo();gr(1),ma(e.placeholder||"\xa0")}}function QE(e,t){if(1&e&&(ko(0,"span"),pa(1),Ao()),2&e){const e=Uo(2);gr(1),ma(e.triggerValue||"\xa0")}}function eT(e,t){1&e&&Go(0,0,["*ngSwitchCase","true"])}function tT(e,t){1&e&&(ko(0,"span",9),wo(1,QE,2,1,"span",10),wo(2,eT,1,0,void 0,11),Ao()),2&e&&(Po("ngSwitch",!!Uo().customTrigger),gr(2),Po("ngSwitchCase",!0))}function iT(e,t){if(1&e){const e=No();ko(0,"div",12),ko(1,"div",13,14),Lo("@transformPanel.done",(function(t){return Jt(e),Uo()._panelDoneAnimatingStream.next(t.toState)}))("keydown",(function(t){return Jt(e),Uo()._handleKeydown(t)})),Go(3,1),Ao(),Ao()}if(2&e){const e=Uo();Po("@transformPanelWrap",void 0),gr(1),i="mat-select-panel ",n=e._getPanelTheme(),r="",function(e,t,i,n){const r=Yt(),s=ai(2);r.firstUpdatePass&&oa(r,null,s,!0);const o=Kt();if(i!==ur&&vo(o,s,i)){const n=r.data[xi()+20];if(da(n,!0)&&!sa(r,s)){let e=n.classesWithoutHost;null!==e&&(i=Ce(e,i||"")),Mo(r,n,o,i,!0)}else!function(e,t,i,n,r,s,o,a){r===ur&&(r=$o);let l=0,c=0,h=0<r.length?r[0]:null,u=0<s.length?s[0]:null;for(;null!==h||null!==u;){const o=l<r.length?r[l+1]:void 0,d=c<s.length?s[c+1]:void 0;let p=null,m=void 0;h===u?(l+=2,c+=2,o!==d&&(p=u,m=d)):null===u||null!==h&&h<u?(l+=2,p=h):(c+=2,p=u,m=d),null!==p&&ca(e,t,i,n,p,m,!0,a),h=l<r.length?r[l]:null,u=c<s.length?s[c]:null}}(r,n,o,o[11],o[s+1],o[s+1]=function(e,t,i){if(null==i||""===i)return $o;const n=[],r=xn(i);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(n,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(n,s,r[s]);else"string"==typeof r&&t(n,r);return n}(e,t,i),0,s)}}(at,na,bo(Kt(),i,n,r)),ta("transform-origin",e._transformOrigin)("font-size",e._triggerFontSize,"px"),Po("ngClass",e.panelClass)("@transformPanel",e.multiple?"showing-multiple":"showing"),xo("id",e.id+"-panel")}var i,n,r}const nT=[[["mat-select-trigger"]],"*"],rT=["mat-select-trigger","*"],sT={transformPanelWrap:vu("transformPanelWrap",[Tu("* => void",Mu("@transformPanel",[Pu()],{optional:!0}))]),transformPanel:vu("transformPanel",[Su("void",Cu({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Su("showing",Cu({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Su("showing-multiple",Cu({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Tu("void => *",xu("120ms cubic-bezier(0, 0, 0.2, 1)")),Tu("* => void",xu("100ms 25ms linear",Cu({opacity:0})))])};let oT=0;const aT=new je("mat-select-scroll-strategy"),lT=new je("MAT_SELECT_CONFIG"),cT={provide:aT,deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition()}};class hT{constructor(e,t){this.source=e,this.value=t}}class uT{constructor(e,t,i,n,r){this._elementRef=e,this._defaultErrorStateMatcher=t,this._parentForm=i,this._parentFormGroup=n,this.ngControl=r}}const dT=uv(dv(cv(pv(uT))));let pT=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-select-trigger"]]}),e})(),mT=(()=>{class e extends dT{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,p){super(r,n,o,a,c),this._viewportRuler=e,this._changeDetectorRef=t,this._ngZone=i,this._dir=s,this._parentFormField=l,this.ngControl=c,this._liveAnnouncer=d,this._panelOpen=!1,this._required=!1,this._scrollTop=0,this._multiple=!1,this._compareWith=(e,t)=>e===t,this._uid="mat-select-"+oT++,this._destroy=new T,this._triggerFontSize=0,this._onChange=()=>{},this._onTouched=()=>{},this._optionIds="",this._transformOrigin="top",this._panelDoneAnimatingStream=new T,this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],this._disableOptionCentering=!1,this._focused=!1,this.controlType="mat-select",this.ariaLabel="",this.optionSelectionChanges=Jp(()=>{const e=this.options;return e?e.changes.pipe(Mm(e),Sm(()=>$(...e.map(e=>e.onSelectionChange)))):this._ngZone.onStable.asObservable().pipe(ym(1),Sm(()=>this.optionSelectionChanges))}),this.openedChange=new Ol,this._openedStream=this.openedChange.pipe(em(e=>e),B(()=>{})),this._closedStream=this.openedChange.pipe(em(e=>!e),B(()=>{})),this.selectionChange=new Ol,this.valueChange=new Ol,this.ngControl&&(this.ngControl.valueAccessor=this),this._scrollStrategyFactory=u,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(h)||0,this.id=this.id,p&&(null!=p.disableOptionCentering&&(this.disableOptionCentering=p.disableOptionCentering),null!=p.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=p.typeaheadDebounceInterval))}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required}set required(e){this._required=j_(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){if(this._selectionModel)throw Error("Cannot change `multiple` mode of select after initialization.");this._multiple=j_(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=j_(e)}get compareWith(){return this._compareWith}set compareWith(e){if("function"!=typeof e)throw Error("`compareWith` must be a function.");this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){e!==this._value&&(this.writeValue(e),this._value=e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=V_(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new fy(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Q_(),cy(this._destroy)).subscribe(()=>{this.panelOpen?(this._scrollTop=0,this.openedChange.emit(!0)):(this.openedChange.emit(!1),this.overlayDir.offsetX=0,this._changeDetectorRef.markForCheck())}),this._viewportRuler.change().pipe(cy(this._destroy)).subscribe(()=>{this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(cy(this._destroy)).subscribe(e=>{e.added.forEach(e=>e.select()),e.removed.forEach(e=>e.deselect())}),this.options.changes.pipe(Mm(null),cy(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){this.ngControl&&this.updateErrorState()}ngOnChanges(e){e.disabled&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.asObservable().pipe(ym(1)).subscribe(()=>{this._triggerFontSize&&this.overlayDir.overlayRef&&this.overlayDir.overlayRef.overlayElement&&(this.overlayDir.overlayRef.overlayElement.style.fontSize=this._triggerFontSize+"px")}))}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this.options&&this._setSelectionByValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(e=>e.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const t=e.keyCode,i=40===t||38===t||37===t||39===t,n=13===t||32===t,r=this._keyManager;if(!r.isTyping()&&n&&!wy(e)||(this.multiple||e.altKey)&&i)e.preventDefault(),this.open();else if(!this.multiple){const i=this.selected;36===t||35===t?(36===t?r.setFirstItemActive():r.setLastItemActive(),e.preventDefault()):r.onKeydown(e);const n=this.selected;n&&i!==n&&this._liveAnnouncer.announce(n.viewValue,1e4)}}_handleOpenKeydown(e){const t=this._keyManager,i=e.keyCode,n=40===i||38===i,r=t.isTyping();if(36===i||35===i)e.preventDefault(),36===i?t.setFirstItemActive():t.setLastItemActive();else if(n&&e.altKey)e.preventDefault(),this.close();else if(r||13!==i&&32!==i||!t.activeItem||wy(e))if(!r&&this._multiple&&65===i&&e.ctrlKey){e.preventDefault();const t=this.options.some(e=>!e.disabled&&!e.selected);this.options.forEach(e=>{e.disabled||(t?e.select():e.deselect())})}else{const i=t.activeItemIndex;t.onKeydown(e),this._multiple&&n&&e.shiftKey&&t.activeItem&&t.activeItemIndex!==i&&t.activeItem._selectViaInteraction()}else e.preventDefault(),t.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this.overlayDir.positionChange.pipe(ym(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop})}_getPanelTheme(){return this._parentFormField?"mat-"+this._parentFormField.color:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.multiple&&e){if(!Array.isArray(e))throw Error("Value must be an array in multiple-selection mode.");this._selectionModel.clear(),e.forEach(e=>this._selectValue(e)),this._sortValues()}else{this._selectionModel.clear();const t=this._selectValue(e);t?this._keyManager.setActiveItem(t):this.panelOpen||this._keyManager.setActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectValue(e){const t=this.options.find(t=>{try{return null!=t.value&&this._compareWith(t.value,e)}catch(i){return En()&&console.warn(i),!1}});return t&&this._selectionModel.select(t),t}_initKeyManager(){this._keyManager=new Ly(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(cy(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(cy(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollActiveOptionIntoView():this._panelOpen||this.multiple||!this._keyManager.activeItem||this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=$(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(cy(e)).subscribe(e=>{this._onSelect(e.source,e.isUserInput),e.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),$(...this.options.map(e=>e._stateChanges)).pipe(cy(e)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()}),this._setOptionIds()}_onSelect(e,t){const i=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(i!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),t&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),t&&this.focus())):(e.deselect(),this._selectionModel.clear(),this._propagateChanges(e.value)),i!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((t,i)=>this.sortComparator?this.sortComparator(t,i,e):e.indexOf(t)-e.indexOf(i)),this.stateChanges.next()}}_propagateChanges(e){let t=null;t=this.multiple?this.selected.map(e=>e.value):this.selected?this.selected.value:e,this._value=t,this.valueChange.emit(t),this._onChange(t),this.selectionChange.emit(new hT(this,t)),this._changeDetectorRef.markForCheck()}_setOptionIds(){this._optionIds=this.options.map(e=>e.id).join(" ")}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_scrollActiveOptionIntoView(){const e=this._keyManager.activeItemIndex||0,t=Yv(e,this.options,this.optionGroups);this.panel.nativeElement.scrollTop=function(e,t,i,n){const r=e*t;return r<i?r:r+t>i+256?Math.max(0,r-256+t):i}(e+t,this._getItemHeight(),this.panel.nativeElement.scrollTop)}focus(e){this._elementRef.nativeElement.focus(e)}_getOptionIndex(e){return this.options.reduce((t,i,n)=>void 0!==t?t:e===i?n:void 0,void 0)}_calculateOverlayPosition(){const e=this._getItemHeight(),t=this._getItemCount(),i=Math.min(t*e,256),n=t*e-i;let r=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);r+=Yv(r,this.options,this.optionGroups);const s=i/2;this._scrollTop=this._calculateOverlayScroll(r,s,n),this._offsetY=this._calculateOverlayOffsetY(r,s,n),this._checkOverlayWithinViewport(n)}_calculateOverlayScroll(e,t,i){const n=this._getItemHeight();return Math.min(Math.max(0,n*e-t+n/2),i)}_getAriaLabel(){return this.ariaLabelledby?null:this.ariaLabel||this.placeholder}_getAriaLabelledby(){return this.ariaLabelledby?this.ariaLabelledby:this._parentFormField&&this._parentFormField._hasFloatingLabel()&&!this._getAriaLabel()&&this._parentFormField._labelId||null}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_calculateOverlayOffsetX(){const e=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),t=this._viewportRuler.getViewportSize(),i=this._isRtl(),n=this.multiple?56:32;let r;if(this.multiple)r=40;else{let e=this._selectionModel.selected[0]||this.options.first;r=e&&e.group?32:16}i||(r*=-1);const s=0-(e.left+r-(i?n:0)),o=e.right+r-t.width+(i?0:n);s>0?r+=s+8:o>0&&(r-=o+8),this.overlayDir.offsetX=Math.round(r),this.overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(e,t,i){const n=this._getItemHeight(),r=(n-this._triggerRect.height)/2,s=Math.floor(256/n);let o;return this._disableOptionCentering?0:(o=0===this._scrollTop?e*n:this._scrollTop===i?(e-(this._getItemCount()-s))*n+(n-(this._getItemCount()*n-256)%n):t-n/2,Math.round(-1*o-r))}_checkOverlayWithinViewport(e){const t=this._getItemHeight(),i=this._viewportRuler.getViewportSize(),n=this._triggerRect.top-8,r=i.height-this._triggerRect.bottom-8,s=Math.abs(this._offsetY),o=Math.min(this._getItemCount()*t,256)-s-this._triggerRect.height;o>r?this._adjustPanelUp(o,r):s>n?this._adjustPanelDown(s,n,e):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(e,t){const i=Math.round(e-t);this._scrollTop-=i,this._offsetY-=i,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(e,t,i){const n=Math.round(e-t);if(this._scrollTop+=n,this._offsetY+=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=i)return this._scrollTop=i,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_getOriginBasedOnOption(){const e=this._getItemHeight(),t=(e-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-t+e/2}px 0px`}_getItemCount(){return this.options.length+this.optionGroups.length}_getItemHeight(){return 3*this._triggerFontSize}setDescribedByIds(e){this._ariaDescribedby=e.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty}}return e.\u0275fac=function(t){return new(t||e)(So(vy),So(qs),So(Cc),So(Pv),So(Fa),So(py,8),So(ww,8),So(Ow,8),So(FE,8),So(Mb,10),Eo("tabindex"),So(aT),So(Wy),So(lT,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-select"]],contentQueries:function(e,t,i){var n;1&e&&($l(i,pT,!0),$l(i,Kv,!0),$l(i,Gv,!0)),2&e&&(Hl(n=Yl())&&(t.customTrigger=n.first),Hl(n=Yl())&&(t.options=n),Hl(n=Yl())&&(t.optionGroups=n))},viewQuery:function(e,t){var i;1&e&&(Wl(KE,!0),Wl(YE,!0),Wl(VC,!0)),2&e&&(Hl(i=Yl())&&(t.trigger=i.first),Hl(i=Yl())&&(t.panel=i.first),Hl(i=Yl())&&(t.overlayDir=i.first))},hostAttrs:["role","listbox",1,"mat-select"],hostVars:19,hostBindings:function(e,t){1&e&&Lo("keydown",(function(e){return t._handleKeydown(e)}))("focus",(function(){return t._onFocus()}))("blur",(function(){return t._onBlur()})),2&e&&(xo("id",t.id)("tabindex",t.tabIndex)("aria-label",t._getAriaLabel())("aria-labelledby",t._getAriaLabelledby())("aria-required",t.required.toString())("aria-disabled",t.disabled.toString())("aria-invalid",t.errorState)("aria-owns",t.panelOpen?t._optionIds:null)("aria-multiselectable",t.multiple)("aria-describedby",t._ariaDescribedby||null)("aria-activedescendant",t._getAriaActiveDescendant()),ia("mat-select-disabled",t.disabled)("mat-select-invalid",t.errorState)("mat-select-required",t.required)("mat-select-empty",t.empty))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Da([{provide:PE,useExisting:e},{provide:Xv,useExisting:e}]),va,Ea],ngContentSelectors:rT,decls:9,vars:9,consts:[["cdk-overlay-origin","","aria-hidden","true",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],[3,"ngClass","keydown"],["panel",""]],template:function(e,t){if(1&e&&(Ho(nT),ko(0,"div",0,1),Lo("click",(function(){return t.toggle()})),ko(3,"div",2),wo(4,JE,2,1,"span",3),wo(5,tT,3,2,"span",4),Ao(),ko(6,"div",5),Io(7,"div",6),Ao(),Ao(),wo(8,iT,4,11,"ng-template",7),Lo("backdropClick",(function(){return t.close()}))("attach",(function(){return t._onAttached()}))("detach",(function(){return t.close()}))),2&e){const e=Co(1);gr(3),Po("ngSwitch",t.empty),gr(1),Po("ngSwitchCase",!0),gr(1),Po("ngSwitchCase",!1),gr(3),Po("cdkConnectedOverlayScrollStrategy",t._scrollStrategy)("cdkConnectedOverlayOrigin",e)("cdkConnectedOverlayOpen",t.panelOpen)("cdkConnectedOverlayPositions",t._positions)("cdkConnectedOverlayMinWidth",null==t._triggerRect?null:t._triggerRect.width)("cdkConnectedOverlayOffsetY",t._offsetY)}},directives:[jC,Ih,Rh,VC,Oh,Ch],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[sT.transformPanelWrap,sT.transformPanel]},changeDetection:0}),e})(),fT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[cT],imports:[[Fh,qC,Jv,lv],xy,VE,Jv,lv]}),e})();const gT={provide:new je("mat-autocomplete-scroll-strategy"),deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition()}};let _T=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[gT],imports:[[Jv,qC,lv,Fh],xy,Jv,lv]}),e})();function yT(e,t){}class vT{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const xT={dialogContainer:vu("dialogContainer",[Su("void, exit",Cu({opacity:0,transform:"scale(0.7)"})),Su("enter",Cu({transform:"none"})),Tu("* => enter",xu("150ms cubic-bezier(0, 0, 0.2, 1)",Cu({transform:"none",opacity:1}))),Tu("* => void, * => exit",xu("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",Cu({opacity:0})))])};function bT(){throw Error("Attempting to attach dialog content after content is already attached")}let wT=(()=>{class e extends rC{constructor(e,t,i,n,r){super(),this._elementRef=e,this._focusTrapFactory=t,this._changeDetectorRef=i,this._config=r,this._elementFocusedBeforeDialogWasOpened=null,this._state="enter",this._animationStateChanged=new Ol,this.attachDomPortal=e=>(this._portalOutlet.hasAttached()&&bT(),this._setupFocusTrap(),this._portalOutlet.attachDomPortal(e)),this._ariaLabelledBy=r.ariaLabelledBy||null,this._document=n}attachComponentPortal(e){return this._portalOutlet.hasAttached()&&bT(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._portalOutlet.hasAttached()&&bT(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(e)}_recaptureFocus(){this._containsFocus()||this._focusTrap.focusInitialElement()||this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const e=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&e&&"function"==typeof e.focus){const t=this._document.activeElement,i=this._elementRef.nativeElement;t&&t!==this._document.body&&t!==i&&!i.contains(t)||e.focus()}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}_containsFocus(){const e=this._elementRef.nativeElement,t=this._document.activeElement;return e===t||e.contains(t)}_onAnimationDone(e){"enter"===e.toState?this._trapFocus():"exit"===e.toState&&this._restoreFocus(),this._animationStateChanged.emit(e)}_onAnimationStart(e){this._animationStateChanged.emit(e)}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(qy),So(qs),So(th,8),So(vT))},e.\u0275cmp=ft({type:e,selectors:[["mat-dialog-container"]],viewQuery:function(e,t){var i;1&e&&Gl(aC,!0),2&e&&Hl(i=Yl())&&(t._portalOutlet=i.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(e,t){1&e&&Bo("@dialogContainer.start",(function(e){return t._onAnimationStart(e)}))("@dialogContainer.done",(function(e){return t._onAnimationDone(e)})),2&e&&(xo("id",t._id)("role",t._config.role)("aria-labelledby",t._config.ariaLabel?null:t._ariaLabelledBy)("aria-label",t._config.ariaLabel)("aria-describedby",t._config.ariaDescribedBy||null),_a("@dialogContainer",t._state))},features:[va],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,t){1&e&&wo(0,yT,0,0,"ng-template",0)},directives:[aC],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[xT.dialogContainer]}}),e})(),CT=0;class ST{constructor(e,t,i="mat-dialog-"+CT++){this._overlayRef=e,this._containerInstance=t,this.id=i,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new T,this._afterClosed=new T,this._beforeClosed=new T,this._state=0,t._id=i,t._animationStateChanged.pipe(em(e=>"done"===e.phaseName&&"enter"===e.toState),ym(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(em(e=>"done"===e.phaseName&&"exit"===e.toState),ym(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),e.keydownEvents().pipe(em(e=>27===e.keyCode&&!this.disableClose&&!wy(e))).subscribe(e=>{e.preventDefault(),this.close()}),e.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():this.close()})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(em(e=>"start"===e.phaseName),ym(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._containerInstance._startExitAnimation(),this._state=1}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(e){let t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(e="",t=""){return this._getPositionStrategy().width(e).height(t),this._overlayRef.updatePosition(),this}addPanelClass(e){return this._overlayRef.addPanelClass(e),this}removePanelClass(e){return this._overlayRef.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}const ET=new je("MatDialogData"),TT=new je("mat-dialog-default-options"),PT=new je("mat-dialog-scroll-strategy"),MT={provide:PT,deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.block()}};let kT=(()=>{class e{constructor(e,t,i,n,r,s,o){this._overlay=e,this._injector=t,this._defaultOptions=n,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new T,this._afterOpenedAtThisLevel=new T,this._ariaHiddenElements=new Map,this.afterAllClosed=Jp(()=>this.openDialogs.length?this._afterAllClosed:this._afterAllClosed.pipe(Mm(void 0))),this._scrollStrategy=r}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}get _afterAllClosed(){const e=this._parentDialog;return e?e._afterAllClosed:this._afterAllClosedAtThisLevel}open(e,t){if((t=function(e,t){return Object.assign(Object.assign({},t),e)}(t,this._defaultOptions||new vT)).id&&this.getDialogById(t.id))throw Error(`Dialog with id "${t.id}" exists already. The dialog id must be unique.`);const i=this._createOverlay(t),n=this._attachDialogContainer(i,t),r=this._attachDialogContent(e,n,i,t);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(r),r.afterClosed().subscribe(()=>this._removeOpenDialog(r)),this.afterOpened.next(r),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(t=>t.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(e){const t=this._getOverlayConfig(e);return this._overlay.create(t)}_getOverlayConfig(e){const t=new xC({positionStrategy:this._overlay.position().global(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(t.backdropClass=e.backdropClass),t}_attachDialogContainer(e,t){const i=so.create({parent:t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,providers:[{provide:vT,useValue:t}]}),n=new tC(wT,t.viewContainerRef,i,t.componentFactoryResolver);return e.attach(n).instance}_attachDialogContent(e,t,i,n){const r=new ST(i,t,n.id);if(e instanceof cl)t.attachTemplatePortal(new iC(e,null,{$implicit:n.data,dialogRef:r}));else{const i=this._createInjector(n,r,t),s=t.attachComponentPortal(new tC(e,n.viewContainerRef,i));r.componentInstance=s.instance}return r.updateSize(n.width,n.height).updatePosition(n.position),r}_createInjector(e,t,i){const n=e&&e.viewContainerRef&&e.viewContainerRef.injector,r=[{provide:wT,useValue:i},{provide:ET,useValue:e.data},{provide:ST,useValue:t}];return!e.direction||n&&n.get(py,null)||r.push({provide:py,useValue:{value:e.direction,change:qp()}}),so.create({parent:n||this._injector,providers:r})}_removeOpenDialog(e){const t=this.openDialogs.indexOf(e);t>-1&&(this.openDialogs.splice(t,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((e,t)=>{e?t.setAttribute("aria-hidden",e):t.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._afterAllClosed.next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const t=e.parentElement.children;for(let i=t.length-1;i>-1;i--){let n=t[i];n===e||"SCRIPT"===n.nodeName||"STYLE"===n.nodeName||n.hasAttribute("aria-live")||(this._ariaHiddenElements.set(n,n.getAttribute("aria-hidden")),n.setAttribute("aria-hidden","true"))}}}_closeDialogs(e){let t=e.length;for(;t--;)e[t].close()}}return e.\u0275fac=function(t){return new(t||e)(Ke(LC),Ke(so),Ke(gh,8),Ke(TT,8),Ke(PT),Ke(e,12),Ke(PC))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),AT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[kT,MT],imports:[[qC,hC,lv],lv]}),e})(),IT=(()=>{class e{constructor(){this.changes=new T,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(e,t){return`${e} \u2013 ${t}`}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})();const RT={provide:new je("mat-datepicker-scroll-strategy"),deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition()}};let OT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[IT,RT],imports:[[Fh,pS,AT,qC,ev,hC],xy]}),e})(),NT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fv,lv],lv]}),e})(),DT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})(),zT=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fv,lv,Ay,DT],lv,DT]}),e})();function LT(e,t){1&e&&(ko(0,"div"),Io(1,"img",7),Ao())}function BT(e,t){1&e&&(ko(0,"div"),pa(1," :"),ko(2,"mat-icon"),pa(3,"keyboard_backspace"),Ao(),Ao())}function FT(e,t){if(1&e&&(ko(0,"p",12),pa(1),Ao()),2&e){const e=Uo().$implicit;gr(1),ma(e.name)}}function jT(e,t){if(1&e&&(ko(0,"mat-list",8),ko(1,"a",9),ko(2,"mat-icon",10),pa(3),Ao(),wo(4,FT,2,1,"p",11),Ao(),Ao()),2&e){const e=t.$implicit,i=Uo();gr(1),Wo("routerLink",e.link),gr(1),Po("matTooltip",i.isExpanded?null:e.name),gr(1),fa(" ",e.icon,""),gr(1),Po("ngIf",i.isExpanded)}}function VT(e,t){if(1&e&&(ko(0,"mat-list",8),ko(1,"a",9),ko(2,"mat-icon",10),pa(3),Ao(),Ao(),Ao()),2&e){const e=t.$implicit,i=Uo();gr(1),Wo("routerLink",e.link),gr(1),Po("matTooltip",i.isExpanded?null:e.name),gr(1),fa(" ",e.icon," ")}}let UT=(()=>{class e{constructor(){this.toggleMenu=new Ol,this.routeLinks=[{link:"map",name:"Map",icon:"language icon"},{link:"Occupancy",name:"Occupancy",icon:"dashboard"},{link:"IAQ",name:"IAQ",icon:"opacity icon"},{link:"PM",name:"Premetive Maintenance",icon:" extension icon"}],this.tools=[{link:"Settings",name:"Settings",icon:"settings"},{link:"Users",name:"User Management",icon:"supervised_user_circle"}]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ft({type:e,selectors:[["side-nav"]],inputs:{isExpanded:"isExpanded"},outputs:{toggleMenu:"toggleMenu"},decls:12,vars:6,consts:[[1,"toggle"],[1,"icon-button"],[4,"ngIf"],[1,"menuBreak"],[1,"middle"],["class","nav",4,"ngFor","ngForOf"],[1,"bottom"],["src","/assets/blue user.png","alt","",1,"icon"],[1,"nav"],["mat-list-item","","routerLinkActive","active-link",1,"hover",3,"routerLink"],["mat-list-icon","","matTooltipPosition","right",3,"matTooltip"],["matLine","",4,"ngIf"],["matLine",""]],template:function(e,t){1&e&&(ko(0,"section"),ko(1,"div",0),ko(2,"div"),ko(3,"button",1),wo(4,LT,2,0,"div",2),wo(5,BT,4,0,"div",2),Ao(),Ao(),Ao(),ko(6,"div",3),Io(7,"hr"),Ao(),ko(8,"div",4),wo(9,jT,5,4,"mat-list",5),Ao(),ko(10,"div",6),wo(11,VT,4,3,"mat-list",5),Ao(),Ao()),2&e&&(ia("sidenav",t.isExpanded),gr(4),Po("ngIf",!t.isExpanded),gr(1),Po("ngIf",t.isExpanded),gr(4),Po("ngForOf",t.routeLinks),gr(2),Po("ngForOf",t.tools))},directives:[Ph,Eh,gb,$w,Yw,r_,o_,Kw,rS,Mv],styles:[".row[_ngcontent-%COMP%]{display:grid;align-content:space-between;height:100%}.middle[_ngcontent-%COMP%]{margin-top:50%;margin-bottom:0}.bottom[_ngcontent-%COMP%]{margin-top:200%;margin-bottom:0}.icon-button[_ngcontent-%COMP%]{background:none;padding:0;border:0;cursor:pointer}.icon-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:50px}.menuBreak[_ngcontent-%COMP%]{width:100%;height:10px;display:flex;align-items:center;justify-content:center}.menuBreak[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{width:50%;height:3px;background-color:#353535;border:none;border-radius:5px}.sidenav[_ngcontent-%COMP%]{width:auto;display:grid}.toggle[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;padding:25px 0}.toggle[_ngcontent-%COMP%]:hover{cursor:pointer}.nav[_ngcontent-%COMP%]   .active-link[_ngcontent-%COMP%]{background-color:#fafafa;border-left:3px solid #1976d2}.nav[_ngcontent-%COMP%]   .hover[_ngcontent-%COMP%]{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:transform,border,background-color}.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{border:none;box-sizing:border-box;text-decoration:none}.nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#fafafa;border-left:3px solid #1976d2}.nav[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}"]}),e})(),qT=(()=>{class e{constructor(e){this.router=e,this.isExpanded=!1,this.router.navigate(["/map"])}toggleMenu(){this.isExpanded=!this.isExpanded}}return e.\u0275fac=function(t){return new(t||e)(So(i_))},e.\u0275cmp=ft({type:e,selectors:[["app-root"]],decls:7,vars:4,consts:[["autosize",""],["fixedInViewport","true","mode","side",3,"opened"],["sidenav",""],[3,"isExpanded","toggleMenu"],[1,"content-container"]],template:function(e,t){1&e&&(ko(0,"mat-sidenav-container",0),ko(1,"mat-sidenav",1,2),ko(3,"side-nav",3),Lo("toggleMenu",(function(){return t.toggleMenu()})),Ao(),Ao(),ko(4,"mat-sidenav-content"),ko(5,"div",4),Io(6,"router-outlet"),Ao(),Ao(),Ao()),2&e&&(gr(1),Wo("opened",t.isExpanded),gr(2),Po("isExpanded",t.isExpanded),gr(1),ta("margin-left",t.isExpanded?250:60,"px"))},directives:[vx,_x,UT,gx,c_],styles:[".content-container[_ngcontent-%COMP%] {\n        min-height: 100vh;\n        box-sizing: border-box;\n        padding: 25px;\n      }"]}),e})();for(var HT=i("/t/I"),GT=i.n(HT),WT=i("A1R+"),ZT=i.n(WT),$T=i("Vfn7"),XT=i.n($T),KT=[],YT=0;YT<6;YT++)KT[YT]=[];var JT=[];function QT(e,t,i){var n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v;s=(n=e)[1],o=n[2],c=n[5],h=n[6],p=n[9],m=n[10],_=n[13],y=n[14],eP(KT[0],(a=n[3])-(r=n[0]),(u=n[7])-(l=n[4]),(f=n[11])-(d=n[8]),(v=n[15])-(g=n[12])),eP(KT[1],a+r,u+l,f+d,v+g),eP(KT[2],a+s,u+c,f+p,v+_),eP(KT[3],a-s,u-c,f-p,v-_),eP(KT[4],a-o,u-h,f-m,v-y),eP(KT[5],a+o,u+h,f+m,v+y);for(var x=0;x<6;x++)if(!i||"0"!==i.charAt(x)){var b=KT[x];if(JT[0]=b[0]>0?t[1][0]:t[0][0],JT[1]=b[1]>0?t[1][1]:t[0][1],JT[2]=b[2]>0?t[1][2]:t[0][2],tP(b,JT)<0)return!1}return!0}function eP(e,t,i,n,r){return e[0]=t*(1/6),e[1]=i*(1/6),e[2]=n*(1/6),e[3]=r*(1/6),e}function tP(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]}var iP={idleLog:!1,idleTimeRemaining:8,idleForceTimeThreshold:100,idleTimeout:1e3,workerCount:window.MAPTALKS_WORKER_COUNT||0,taskCountPerWorkerMessage:5},nP=["MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"],rP=["FeatureCollection","Feature","Point","LineString","Polygon"].concat(nP),sP=["markerFile","polygonPatternFile","linePatternFile","markerFillPatternFile","markerLinePatternFile"],oP=[["markerWidth","markerHeight"],[],[null,"lineWidth"],[],[null,"markerLineWidth"]],aP={lineWidth:1,lineOpacity:1,lineDx:1,lineDy:1,polygonOpacity:1,markerWidth:1,markerHeight:1,markerDx:1,markerDy:1,markerOpacity:1,markerFillOpacity:1,markerLineWidth:1,markerLineOpacity:1,textSize:1,textOpacity:1,textHaloRadius:1,textWrapWidth:1,textLineSpacing:1,textDx:1,textDy:1},lP=["lineColor","polygonFill","markerFill","markerLineColor","textFill"];function cP(){return Date.now()}function hP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function uP(e){return null==e}function dP(e){return"number"==typeof e&&!isNaN(e)}function pP(e){return(0|e)===e}function mP(e){return"object"==typeof e&&!!e}function fP(e){return!uP(e)&&("string"==typeof e||null!==e.constructor&&e.constructor===String)}function gP(e){return!uP(e)&&("function"==typeof e||null!==e.constructor&&e.constructor===Function)}var _P=Object.prototype.hasOwnProperty;function yP(e,t){return _P.call(e,t)}var vP=Math.PI/180;function xP(e){return e*vP}function bP(e){return e/vP}var wP="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&!process.versions.electron&&!process.versions.nw&&!process.versions["node-webkit"],CP={};function SP(){return window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI}if(!wP){var EP=navigator.userAgent.toLowerCase(),TP=document.documentElement||{style:{}},PP="ActiveXObject"in window,MP=-1!==EP.indexOf("webkit"),kP=-1!==EP.indexOf("phantom"),AP=-1!==EP.search("android [23]"),IP=-1!==EP.indexOf("chrome"),RP=-1!==EP.indexOf("gecko")&&!MP&&!window.opera&&!PP,OP=/iphone/i.test(EP)&&/micromessenger/i.test(EP),NP="undefined"!=typeof orientation||-1!==EP.indexOf("mobile"),DP=!window.PointerEvent&&window.MSPointerEvent,zP=window.PointerEvent&&navigator.pointerEnabled||DP,LP=PP&&"transition"in TP.style,BP="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!AP,FP="MozPerspective"in TP.style,jP="OTransition"in TP.style,VP=(LP||BP||FP)&&!jP&&!kP,UP="undefined"!=typeof window&&gP(window.createImageBitmap),qP="undefined"!=typeof window&&gP(window.ResizeObserver),HP="undefined"!=typeof window&&gP(window.btoa),GP="undefined"!=typeof window&&gP(window.Proxy),WP="undefined"!=typeof window&&gP(window.requestIdleCallback),ZP=0;IP&&(ZP=EP.match(/chrome\/([\d.]+)/)[1]);var $P=!kP&&(zP||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),XP="undefined"!=typeof window&&"WebGLRenderingContext"in window,KP=SP(),YP=!1;try{new OffscreenCanvas(2,2).getContext("2d"),YP=!0}catch(T0){YP=!1}var JP=!1;try{window.addEventListener("testPassive",(function(){}),{get passive(){JP=!0}})}catch(P0){}CP={isTest:!1,ie:PP,ielt9:PP&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:MP,gecko:RP,android:-1!==EP.indexOf("android"),android23:AP,chrome:IP,chromeVersion:ZP,safari:!IP&&-1!==EP.indexOf("safari"),phantomjs:kP,ie3d:LP,webkit3d:BP,gecko3d:FP,opera12:jP,any3d:VP,iosWeixin:OP,mobile:NP,mobileWebkit:NP&&MP,mobileWebkit3d:NP&&BP,mobileOpera:NP&&window.opera,mobileGecko:NP&&RP,touch:!!$P,msPointer:!!DP,pointer:!!zP,retina:KP>1,devicePixelRatio:KP,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:PP&&9===document.documentMode,ie10:PP&&10===document.documentMode,webgl:XP,imageBitMap:UP,resizeObserver:qP,btoa:HP,decodeImageInWorker:YP,monitorDPRChange:!0,supportsPassive:JP,proxy:GP,requestIdleCallback:WP,checkDevicePixelRatio:function(){if("undefined"!=typeof window&&CP.monitorDPRChange){var e=SP(),t=e!==CP.devicePixelRatio;return t&&(CP.devicePixelRatio=e),t}return!1}}}var QP=CP;function eM(){return(eM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function tM(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,nM(e,t)}function iM(e){return(iM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nM(e,t){return(nM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function rM(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(P0){return!1}}function sM(e,t,i){return(sM=rM()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&nM(r,i.prototype),r}).apply(null,arguments)}function oM(e){var t="function"==typeof Map?new Map:void 0;return(oM=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return sM(e,arguments,iM(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),nM(i,e)})(e)}function aM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lM,cM,hM=function(){function e(e,t,i){if(uP(e)||uP(t)?uP(e.x)||uP(e.y)?Array.isArray(e)&&(this.x=+e[0],this.y=+e[1],this.z=e[2]):(this.x=+e.x,this.y=+e.y,this.z=e.z):(this.x=+e,this.y=+t,this.z=i),this._isNaN())throw new Error("Position is NaN")}var t=e.prototype;return t.set=function(e,t,i){return this.x=e,this.y=t,this.z=i||0,this},t.abs=function(){return new this.constructor(Math.abs(this.x),Math.abs(this.y))},t._abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.round=function(){return new this.constructor(Math.round(this.x),Math.round(this.y))},t._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.ceil=function(){return new this.constructor(Math.ceil(this.x),Math.ceil(this.y))},t.distanceTo=function(e){var t=e.x-this.x,i=e.y-this.y;return Math.sqrt(t*t+i*i)},t.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.floor=function(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))},t.copy=function(){return new this.constructor(this.x,this.y,this.z)},t._add=function(e,t){return uP(e.x)?uP(e[0])?(this.x+=e,this.y+=t):(this.x+=e[0],this.y+=e[1]):(this.x+=e.x,this.y+=e.y),this},t.add=function(e,t){var i,n;return uP(e.x)?uP(e[0])?(i=this.x+e,n=this.y+t):(i=this.x+e[0],n=this.y+e[1]):(i=this.x+e.x,n=this.y+e.y),new this.constructor(i,n)},t._sub=function(e,t){return uP(e.x)?uP(e[0])?(this.x-=e,this.y-=t):(this.x-=e[0],this.y-=e[1]):(this.x-=e.x,this.y-=e.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(e,t){var i,n;return uP(e.x)?uP(e[0])?(i=this.x-e,n=this.y-t):(i=this.x-e[0],n=this.y-e[1]):(i=this.x-e.x,n=this.y-e.y),new this.constructor(i,n)},t.substract=function(){return this.sub.apply(this,arguments)},t.multi=function(e){return new this.constructor(this.x*e,this.y*e)},t._multi=function(e){return this.x*=e,this.y*=e,this},t.div=function(e){return this.multi(1/e)},t._div=function(e){return this._multi(1/e)},t.equals=function(e){return e instanceof this.constructor&&this.x===e.x&&this.y===e.y&&this.z===e.z},t._isNaN=function(){return isNaN(this.x)||isNaN(this.y)||dP(this.z)&&isNaN(this.z)},t.isZero=function(){return 0===this.x&&0===this.y},t.toArray=function(){return dP(this.z)?[this.x,this.y,this.z]:[this.x,this.y]},t.toFixed=function(e){return new this.constructor(this.x.toFixed(e),this.y.toFixed(e),dP(this.z)?this.z.toFixed:void 0)},t.toJSON=function(){var e={x:this.x,y:this.y};return dP(this.z)&&(e.z=this.z),e},e}(),uM=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.closeTo=function(e,t){return t||(t=0),this.x>=e.x-t&&this.x<=e.x+t&&this.y>=e.y-t&&this.y<=e.y+t},i.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.unit=function(){return this.copy()._unit()},i._unit=function(){return this._div(this.mag()),this},i.perp=function(){return this.copy()._perp()},i._perp=function(){var e=this.y;return this.y=this.x,this.x=-e,this},i.angleWith=function(e){return this.angleWithSep(e.x,e.y)},i.angleWithSep=function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},i._rotate=function(e){var t=Math.cos(e),i=Math.sin(e),n=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=n,this},i.rotate=function(e){return this.copy()._rotate(e)},t}(hM);function dM(e){return e.length>4&&".svg"===e.slice(-4)?1:"data:image/svg+xml"===e.slice(0,"data:image/svg+xml".length)?2:0}function pM(e,t){wP&&pM.node?pM.node(e,t):e.src=t[0]}!function(){if(wP)return lM=function(e){return setTimeout(e,16)},void(cM=clearTimeout);var e,t;function i(e){return setTimeout(e,1e3/30)}function n(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}"undefined"!=typeof window?(e=window.requestAnimationFrame||n("RequestAnimationFrame")||i,t=window.cancelAnimationFrame||n("CancelAnimationFrame")||n("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)}):(e=i,t=clearTimeout),lM=function(t){return e(t)},cM=function(e){e&&t(e)}}();var mM=0;function fM(){return mM++}function gM(e){return e&&fP(e)?JSON.parse(e):e}function _M(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i&&i.length)for(var n=0,r=i.length;n<r;n++)e.push(i[n])}return e.length}function yM(e,t){var i=t.indexOf(e);i>-1&&t.splice(i,1)}function vM(e,t,i){if(!Array.isArray(e))return i?t.call(i,e):t(e);for(var n,r,s=[],o=0,a=e.length;o<a;o++)uP(n=e[o])?s.push(null):Array.isArray(n)?s.push(vM(n,t,i)):(r=i?t.call(i,n):t(n),s.push(r));return s}function xM(e,t){return void 0===e?t:e}function bM(e){return Math.sign?Math.sign(e):0==(e=+e)||isNaN(e)?Number(e):e>0?1:-1}function wM(e,t,i){return e*(1-i)+t*i}function CM(e,t,i){if(e===i||e===t)return e;var n=i-t;return((e-t)%n+n)%n+t}function SM(e,t,i){return Math.min(i,Math.max(t,e))}function EM(e){return Array.isArray(e)&&e.length>0}var TM=/^url\((['"])(.+)\1\)$/i,PM=/^url\(([^'"].*[^'"])\)$/i;function MM(e){var t=function(e){return fP(e)?PM.test(e)?1:TM.test(e)?2:3:0}(e);return 3===t?e:1===t?PM.exec(e)[1]:2===t?TM.exec(e)[2]:e}function kM(e,t,i,n){return Math.atan2(n-t,i-e)}var AM="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function IM(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;for(var i in e)if("center"===i){if(!t[i]||!RM(e[i][0],t[i][0])||!RM(e[i][1],t[i][1]))return!1}else if(e[i]!==t[i])return!1;return!0}function RM(e,t,i){return null==i&&(i=1e-6),e>=t-i&&e<=t+i}function OM(e,t,i,n){e||(e=100),t||(t=4);var r=this,s=this.isVisible();return t*=2,this._flashTimeout&&clearTimeout(this._flashTimeout),this._flashTimeout=setTimeout((function o(){if(0===t)return s?r.show():r.hide(),void(i&&(n?i.call(n):i()));t%2==0?r.hide():r.show(),t--,r._flashTimeout=setTimeout(o,e)}),e),this}function NM(e,t){void 0===e&&(e=[]),void 0===t&&(t="_pt");for(var i=[],n=0,r=e.length;n<r;n++){var s=e[n];if(s){s[t]||(s[t]=new uM(0,0));var o=s[t];o.x=0,o.y=0,i.push(o)}else i.push(null)}return i}function DM(e,t){t(e.data)}function zM(e){if(e&&0===e.indexOf("http://")||0===e.indexOf("https://"))return e;var t=document.createElement("a");return t.href=e,e=t.href,t=null,e}var LM,BM={cssWidth:"1px",cssHeight:"1px",width:1,height:1};function FM(e,t){void 0===t&&(t=1);var i=e.width,n=e.height;return BM.cssWidth=i+"px",BM.cssHeight=n+"px",BM.width=Math.round(i*t),BM.height=Math.round(n*t),BM}var jM={width:100,height:10};function VM(){if(!LM){var e=jM.width,t=jM.height;OffscreenCanvas?LM=new OffscreenCanvas(e,t):((LM=document.createElement("canvas")).width=e,LM.height=t)}return LM}var UM,qM=function(){function e(e,t){if(void 0===t&&(t={}),Array.isArray(e))if(e.length<2)console.error("colors.length should >1");else{this.colors=e;for(var i=1/0,n=-1/0,r=0,s=e.length;r<s;r++){var o=e[r][0];i=Math.min(o,i),n=Math.max(o,n)}this.min=i,this.max=n,this.valueOffset=this.max-this.min,this.options=Object.assign({},jM,t),this._initImgData()}else console.error("colors is not array")}var t=e.prototype;return t.getImageData=function(){return this.imgData},t._initImgData=function(){var e=VM(),t=this.options,i=t.height;e.width=t.width,e.height=i;var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);for(var r=n.createLinearGradient(0,0,e.width,0),s=this.colors,o=this.valueOffset,a=0,l=s.length;a<l;a++){var c=s[a];r.addColorStop((c[0]-this.min)/o,c[1])}n.fillStyle=r,n.fillRect(0,0,e.width,e.height),this.imgData=n.getImageData(0,0,e.width,e.height)},t.getColor=function(e){e=Math.max(this.min,e),e=Math.min(e,this.max);var t=Math.round((e-this.min)/this.valueOffset*this.imgData.width),i=4*(t=Math.min(t,this.imgData.width-1));return[this.imgData.data[i],this.imgData.data[i+1],this.imgData.data[i+2],this.imgData.data[i+3]]},e}();function HM(e,t){for(var i=0;i<e.stops.length;i++)if(t===e.stops[i][0])return e.stops[i][1];return e.default}function GM(e,t){for(var i=0;i<e.stops.length&&!(t<e.stops[i][0]);i++);return e.stops[Math.max(i-1,0)][1]}function WM(e,t){for(var i=void 0!==e.base?e.base:1,n=0;!(n>=e.stops.length||t<=e.stops[n][0]);)n++;return 0===n?e.stops[n][1]:n===e.stops.length?e.stops[n-1][1]:function e(t,i,n,r,s,o){return"function"==typeof s?function(){var a=s.apply(void 0,arguments),l=o.apply(void 0,arguments);return e(t,i,n,r,a,l)}:s.length?function(e,t,i,n,r,s){for(var o=[],a=0;a<r.length;a++)o[a]=KM(e,t,i,n,r[a],s[a]);return o}(t,i,n,r,s,o):KM(t,i,n,r,s,o)}(t,i,e.stops[n-1][0],e.stops[n][0],e.stops[n-1][1],e.stops[n][1])}"function"==typeof Map&&(UM=new Map);var ZM={width:100,height:1};function $M(e,t){var i=e.stops;if(i&&i.length>1){var n;if(UM){var r=JSON.stringify(i);if(!UM.has(r)){var s=new qM(i,ZM);UM.set(r,s)}n=UM.get(r)}else n=new qM(i,ZM);var o=n.getColor(t);return[o[0]/255,o[1]/255,o[2]/255,o[3]/255]}return i&&1===i.length?i[0][1]:null}function XM(e,t){return n=e.default,void 0!==(i=t)?i:void 0!==n?n:null;var i,n}function KM(e,t,i,n,r,s){var o,a=n-i,l=e-i;return r*(1-(o=1===t?l/a:(Math.pow(t,l)-1)/(Math.pow(t,a)-1)))+s*o}function YM(e){return e&&"object"==typeof e&&(e.stops||e.property&&"identity"===e.type)}function JM(e){for(var t in e)if(YM(e[t]))return!0;return!1}function QM(e){return function e(t,i){if(!YM(t))return function(){return t};var n=!0,r=!0,s=(t=JSON.parse(JSON.stringify(t))).stops;if(s)for(var o=0;o<s.length;o++)if(YM(s[o][1])){var a=e(s[o][1],i);n=n&&a.isZoomConstant,r=r&&a.isFeatureConstant,s[o]=[s[o][0],a]}var l=function e(t,i){var n,r,s;if(YM(t)){var o,a=t.stops&&"object"==typeof t.stops[0][0],l=a||!(a||void 0!==t.property),c=t.type||i||"exponential";if("exponential"===c)o=WM;else if("interval"===c)o=GM;else if("categorical"===c)o=HM;else if("identity"===c)o=XM;else{if("color-interpolate"!==c)throw new Error('Unknown function type "'+c+'"');o=$M}if(a){for(var h={},u=[],d=0;d<t.stops.length;d++){var p=t.stops[d];void 0===h[p[0].zoom]&&(h[p[0].zoom]={zoom:p[0].zoom,type:t.type,property:t.property,default:t.default,stops:[]}),h[p[0].zoom].stops.push([p[0].value,p[1]])}for(var m in h)u.push([h[m].zoom,e(h[m])]);n=function(e,i){var n=WM({stops:u,base:t.base},e)(e,i);return"function"==typeof n?n(e,i):n},r=!1,s=!1}else l?(n=function(e){var i=o(t,e);return"function"==typeof i?i(e):i},r=!0,s=!1):(n=function(e,i){var n=o(t,i?i[t.property]:null);return"function"==typeof n?n(e,i):n},r=!1,s=!0)}else n=function(){return t},r=!0,s=!0;return n.isZoomConstant=s,n.isFeatureConstant=r,n}(t,i);return l.isZoomConstant=n&&l.isZoomConstant,l.isFeatureConstant=r&&l.isFeatureConstant,l}(e,"exponential")}function ek(e,t){if(!e)return null;var i=!1;if(Array.isArray(e)){for(var n,r=[],s=0;s<e.length;s++)(n=ek(e[s],t))?(r.push(n),i=!0):r.push(e[s]);return i?r:e}var o,a={__fn_types_loaded:!0},l=[];for(o in e)e.hasOwnProperty(o)&&l.push(o);for(var c=function(e){Object.defineProperty(a,e,{get:function(){return this["__fn_"+e]||(this["__fn_"+e]=QM(this["_"+e])),this["__fn_"+e].apply(this,t())},set:function(t){this["_"+e]=t},configurable:!0,enumerable:!0})},h=0,u=l.length;h<u;h++)YM(e[o=l[h]])?(i=!0,a["_"+o]=e[o],c(o)):a[o]=e[o];return i?a:e}function tk(e){if(!e||!e.stops)return[];for(var t=[],i=0,n=e.stops.length;i<n;i++)t.push(e.stops[i][1]);return t}var ik=["Unknown","Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"];function nk(e){return new Function("f","var p = (f && f.properties || {}); return "+rk(e))}function rk(e){if(!e)return"true";var t,i,n,r=e[0];return e.length<=1?"any"===r?"false":"true":"("+("=="===r?ok(e[1],e[2],"===",!1):"!="===r?ok(e[1],e[2],"!==",!1):"<"===r||">"===r||"<="===r||">="===r?ok(e[1],e[2],r,!0):"any"===r?lk(e.slice(1),"||"):"all"===r?lk(e.slice(1),"&&"):"none"===r?uk(lk(e.slice(1),"||")):"in"===r?ck(e[1],e.slice(2)):"!in"===r?uk(ck(e[1],e.slice(2))):"has"===r?hk(e[1]):"!has"===r?uk(hk(e[1])):"contains"===r?(t=e[2],i=e[3],n=sk(e[1]),void 0!==i?"("+n+" + '').indexOf(\""+t+'") === '+i:"("+n+" + '').indexOf(\""+t+'") >= 0'):"true")+")"}function sk(e){return"$"===e[0]?"f."+e.substring(1):"p["+JSON.stringify(e)+"]"}function ok(e,t,i,n){return"object"==typeof(r=e)&&r&&e.op?function(e,t,i,n){var r=e.property,s=e.op,o=sk(r);return"length"!==s?(console.error("not support "+s+" op"),"false"):ak(o="(("+o+"+='').length)",r,t,i,n)}(e,t,i,n):ak(sk(e),e,t,i,n);var r}function ak(e,t,i,n,r){var s="$type"===t?ik.indexOf(i):JSON.stringify(i);return(r?"typeof "+e+"=== typeof "+s+"&&":"")+e+n+s}function lk(e,t){return e.map(rk).join(t)}function ck(e,t){"$type"===e&&(t=t.map((function(e){return ik.indexOf(e)})));var i=JSON.stringify(t.sort(dk)),n=sk(e);return t.length<=200?i+".indexOf("+n+") !== -1":"function(v, a, i, j) {\n        while (i <= j) { var m = (i + j) >> 1;\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\n        }\n    return false; }("+n+", "+i+",0,"+(t.length-1)+")"}function hk(e){return"$id"===e?'"id" in f':JSON.stringify(e)+" in p"}function uk(e){return"!("+e+")"}function dk(e,t){return e<t?-1:e>t?1:0}function pk(e){var t=e._toJSON(),i=t.feature;return i.type=ik.indexOf(i.geometry.type),i.subType=t.subType,i}function mk(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}var fk=[],gk={};function _k(e,t){return ek(e,(function(){var e,i,n,r,s,o,a,l=t.getMap();return e=fk,i=l?l.getZoom():12,n=hP({},t.getProperties(),(r=gk,s=l&&l.getBearing()||0,o=l&&l.getPitch()||0,a=l?l.getZoom():10,r["{bearing}"]=s,r["{pitch}"]=o,r["{zoom}"]=a,r)),e[0]=i,e[1]=n,e}))}function yk(e,t,i){if(!e.markerPath)return null;var n,r,s=1,o=(0===(r={stroke:{stroke:(n=e).markerLineColor,"stroke-width":n.markerLineWidth,"stroke-opacity":n.markerLineOpacity,"stroke-dasharray":null,"stroke-linecap":"butt","stroke-linejoin":"round"},fill:{fill:n.markerFill,"fill-opacity":n.markerFillOpacity}}).stroke["stroke-width"]&&(r.stroke["stroke-opacity"]=0),r);dP(e.markerOpacity)&&(s=e.markerOpacity),dP(e.opacity)&&(s*=e.opacity);var a={};if(o){for(var l in o.stroke)o.stroke.hasOwnProperty(l)&&(uP(o.stroke[l])||(a[l]=o.stroke[l]));for(var c in o.fill)o.fill.hasOwnProperty(c)&&(uP(o.fill[c])||(a[c]=o.fill[c]))}for(var h,u=Array.isArray(e.markerPath)?e.markerPath:[e.markerPath],d=[],p=0;p<u.length;p++)(h=hP({},h=fP(u[p])?{path:u[p]}:u[p],a)).d=h.path,delete h.path,d.push(h);var m=['<svg version="1.1"','xmlns="http://www.w3.org/2000/svg"'];s<1&&m.push('opacity="'+s+'"'),e.markerPathWidth&&e.markerPathHeight&&m.push('viewBox="0 0 '+e.markerPathWidth+" "+e.markerPathHeight+'"'),m.push('preserveAspectRatio="none"'),t&&m.push('width="'+t+'"'),i&&m.push('height="'+i+'"'),m.push("><defs></defs>");for(var f=0;f<d.length;f++){var g="<path ";for(var _ in d[f])d[f].hasOwnProperty(_)&&(g+=" "+_+'="'+d[f][_]+'"');m.push(g+="></path>")}return m.push("</svg>"),"data:image/svg+xml;base64,"+function(e){if(QP.btoa)return window.btoa(e);for(var t,i,n=String(e),r="",s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.charAt(0|s)||(o="=",s%1);r+=o.charAt(63&t>>8-s%1*8)){if((i=n.charCodeAt(s+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|i}return r}(m.join(" "))}function vk(e,t){if(!e)return[];var i=e;Array.isArray(e)||(i=[e]);for(var n,r,s,o,a=[],l=sP,c=i.length-1;c>=0;c--)if(e=i[c]){t&&(e=xk(e));for(var h=0;h<l.length;h++)if(YM(n=e[l[h]])&&(n=tk(n)),n){Array.isArray(n)||(n=[n]);for(var u=0;u<n.length;u++)"url("===n[u].slice(0,4)&&(n[u]=MM(n[u])),a.push([n[u],e[(r=oP[h])[0]],e[r[1]]])}if("path"===e.markerType&&e.markerPath)if(s=YM(e.markerWidth)?200:e.markerWidth,o=YM(e.markerHeight)?200:e.markerHeight,YM(e.markerPath)){n=tk(e.markerPath);for(var d=e.markerPath,p=0;p<n.length;p++)e.markerPath=n[p],a.push([yk(e),s,o]);e.markerPath=d}else a.push([yk(e),s,o])}return a}function xk(e){if(!e)return null;var t=e;if(wP)return t;for(var i,n=sP,r=0,s=n.length;r<s;r++)(i=t[n[r]])&&(t[n[r]]=bk(i));return t}function bk(e){if(YM(e)&&e.stops){for(var t=e.stops,i=0;i<t.length;i++)t[i][1]=bk(t[i][1]);return e}return"url("===e.slice(0,4)&&(e=MM(e)),e}var wk=function(){function e(e,t){dP(e)&&dP(t)?(this.width=e,this.height=t):dP(e.width)?(this.width=e.width,this.height=e.height):Array.isArray(e)&&(this.width=e[0],this.height=e[1])}var t=e.prototype;return t.copy=function(){return new e(this.width,this.height)},t.add=function(t,i){var n,r;return t instanceof e?(n=this.width+t.width,r=this.height+t.height):(n=this.width+t,r=this.height+i),new e(n,r)},t.equals=function(e){return this.width===e.width&&this.height===e.height},t.multi=function(t){return new e(this.width*t,this.height*t)},t._multi=function(e){return this.width*=e,this.height*=e,this},t._round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.toPoint=function(){return new uM(this.width,this.height)},t.toArray=function(){return[this.width,this.height]},t.toJSON=function(){return{width:this.width,height:this.height}},e}();function Ck(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}var Sk=/[\b\t\r\v\f]/gim;function Ek(e){return fP(e)?e.replace(Sk,""):e}var Tk="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):null;function Pk(e,t){return Pk.node?Pk.node(e,t):(Tk.font=t,Tk.measureText(e).width)}function Mk(e,t,i){var n=Pk(e,t);return new wk(n,i||14)}function kk(e,t,i,n){if(!e||0===e.length)return[{text:"",width:0}];var r=uP(n)?Pk(e,t):n,s=r/e.length,o=Math.floor(i/s/2);if(s>=i||o<=0)return[{text:"",width:i}];if(r<=i)return[{text:e,width:r}];for(var a=[],l=e.substring(0,o),c=s*o,h=o,u=e.length;h<u;h++){var d=e[h],p=Pk(l+d);p>=i?(a.push({text:l,width:c}),l=e.substring(h,o+h),h+=o-1,c=s*o):(l+=d,c=p),h>=u-1&&(c=Pk(l),a.push({text:l,width:c}))}return a}var Ak=/\{([\w_]+)\}/g;function Ik(e,t){return fP(e)?e.replace(Ak,(function(e,i){if(!t)return"";var n=t[i];return uP(n)?"":Array.isArray(n)?n.join():n})):e}function Rk(e,t){dP(e)&&(e+="");var i=t.textMaxHeight||0,n=Dk(e=e||"",t);return i&&i<n.size.height&&(n.size.height=i),n}function Ok(e,t,i){var n=e.width,r=e.height;return new uM("left"===t?-n:"right"===t?0:-n/2,"top"===i?-r:"bottom"===i?0:-r/2)}function Nk(e){if(e.textFont)return e.textFont;var t=e.textSize;return uP(t)&&(t=14),(e.textStyle&&"normal"!==e.textStyle?e.textStyle+" ":"")+(e.textWeight&&"normal"!==e.textWeight?e.textWeight+" ":"")+t+"px "+(e.textFaceName?e.textFaceName:"monospace")}function Dk(e,t){var i=Nk(t),n=t.textLineSpacing||0,r=Mk(e,i,t.textSize),s=r.width,o=r.height,a=t.textWrapCharacter||"\n",l=[],c=t.textWrapWidth;(!c||c>s)&&(c=s),fP(e)||(e+="");var h=0;if(a&&e.indexOf(a)>=0)for(var u=e.split(a),d=0,p=u.length;d<p;d++){var m=u[d],f=Pk(m,i);if(f>c)for(var g=kk(m,i,c,f),_=0,y=g.length;_<y;_++){var v=g[_].width;v>h&&(h=v),l.push({text:g[_].text,size:new wk(v,o)})}else f>h&&(h=f),l.push({text:m,size:new wk(f,o)})}else if(s>c)for(var x=kk(e,i,c,s),b=0;b<x.length;b++){var w=x[b].width;w>h&&(h=w),l.push({text:x[b].text,size:new wk(w,o)})}else s>h&&(h=s),l.push({text:e,size:r});var C=l.length;return{total:C,size:new wk(h,o*C+n*(C-1)),rows:l,rawSize:r}}function zk(e){var t=0,i=e&&e.length||0;if(!i)return t;for(var n=0;n<i;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}function Lk(e){return e&&e.colorStops}function Bk(e){var t=[e.type];if(e.places&&t.push(e.places.join()),e.colorStops){for(var i=[],n=e.colorStops.length-1;n>=0;n--)i.push(e.colorStops[n].join());t.push(i.join(","))}return t.join("_")}function Fk(e,t){if(!e)return 1;var i=[];if(Array.isArray(e)){for(var n=0;n<e.length;n++)i.push(Fk(e[n],t));return i.sort().join(",")}var r=Object.keys(e).sort().reduce((function(i,n){return t&&0!==n.indexOf(t)||(i[n]=e[n]),i}),{});return zk(JSON.stringify(r))}function jk(e,t){function i(e,t){uP(e.opacity)?e.opacity=t:e.opacity*=t}var n;if(Array.isArray(e)){n=[];for(var r=0;r<e.length;r++){var s=hP({},e[r]);i(s,t),n.push(s)}}else i(n=hP({},e),t);return n}function Vk(e){var t=Array.prototype.slice.call(arguments,1);if(t&&t.length||(t=[{}]),Array.isArray(e)){for(var i,n,r=[],s=0,o=e.length;s<o;s++){i=e[s],n={};for(var a=0,l=t.length;a<l;a++)Array.isArray(t[a])?uP(t[a][s])?hP(n,i||{}):hP(n,i,t[a][s]):hP(n,i,t[a]?t[a]:{});r.push(n)}return r}var c=[{},e];return c.push.apply(c,t),hP.apply(this,c)}var Uk=/(\{\$root\}|\{\$iconset\})/g;function qk(e,t){for(var i in e)e.hasOwnProperty(i)&&"textName"!==i&&(fP(e[i])&&e[i].length>2?e[i]=e[i].replace(Uk,t):YM(e[i])?e[i]=Hk(e[i],t):mP(e[i])&&qk(e[i],t))}function Hk(e,t){var i=e.default;fP(i)&&(e.default=i.replace(Uk,t));var n=e.stops;if(!n)return e;for(var r=0;r<n.length;r++)Array.isArray(n[r])&&(fP(n[r][1])?n[r][1]=n[r][1].replace(Uk,t):YM(n[r][1])&&(n[r][1]=Hk(n[r][1],t)));return e}var Gk=wP?function(e){return e[0]}:function(e){for(var t=document.documentElement&&document.documentElement.style||{},i=0;i<e.length;i++)if(e[i]in t)return e[i];return!1},Wk=Gk(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),Zk=Gk(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),$k=Gk(["transition","WebkitTransition","OTransition","MozTransition","msTransition"]);function Xk(e,t){var i=document.createElement(e);return t&&cA(i,t),i}function Kk(e,t,i){var n=Xk(e);return t&&oA(n,t),i&&i.appendChild(n),n}function Yk(e){if(!e)return this;if(QP.ielt9||QP.ie9){var t=Xk("div");t.appendChild(e),t.innerHTML="",t=null}else e.parentNode&&e.parentNode.removeChild(e);return this}function Jk(e,t,i,n){if(!(e&&e.addEventListener&&t&&i))return this;for(var r=function(t){t||(t=window.event),i.call(n||e,t)},s=t.split(" "),o=s.length-1;o>=0;o--){var a=s[o];a&&(e["Z__"+a]||(e["Z__"+a]=[]),eA(e,a,i)>=0&&(console.warn(e,"find '"+a+"' handler:",i," The old listener function will be removed"),Qk(e,a,i)),e["Z__"+a].push({callback:r,src:i}),e.addEventListener(a,r,!!QP.supportsPassive&&{capture:!1,passive:!1}))}return this}function Qk(e,t,i){function n(t,i){"mousewheel"===t&&QP.gecko&&(t="DOMMouseScroll"),e.removeEventListener(t,i,!1)}if(!e||!e.removeEventListener||!t)return this;for(var r=t.split(" "),s=r.length-1;s>=0;s--){var o=r[s];if(o){if(!i&&e["Z__"+o]){for(var a=e["Z__"+o],l=0,c=a.length;l<c;l++)n(a[l].callback);return delete e["Z__"+o],this}var h=eA(e,o,i);if(h<0)return this;n(o,e["Z__"+o][h].callback),e["Z__"+o].splice(h,1)}}return this}function eA(e,t,i){if(!e||!e["Z__"+t]||!i)return-1;for(var n=e["Z__"+t],r=0,s=n.length;r<s;r++)if(n[r].src===i)return r;return-1}function tA(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function iA(e){return e._cancelBubble=!0,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this}function nA(e,t){return e?(QP.any3d?function(e,t){var i=t||new uM(0,0);e.style[Wk]=QP.any3d?"translate3d("+i.x+"px,"+i.y+"px,0px)":"translate("+i.x+"px,"+i.y+"px)"}(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px"),t):null}function rA(e){var t=window.getComputedStyle(e),i=[parseInt(t["padding-left"]),parseInt(t["padding-top"])],n=e.getBoundingClientRect(),r=e.offsetWidth,s=e.offsetHeight;return e.__position=[n.left+i[0],n.top+i[1],r?n.width/r:1,s?n.height/s:1],e.__position}function sA(e,t){e||(e=window.event);var i=t.__position;return i||(i=rA(t)),new uM((e.clientX-i[0]-t.clientLeft)/i[2],(e.clientY-i[1]-t.clientTop)/i[3])}function oA(e,t){var i,n,r=e.style.cssText;return(n=(i=r).length-";".length)>=0&&i.indexOf(";",n)===n||(r+=";"),e.style.cssText=r+t,this}function aA(e,t){if(void 0!==e.classList)return e.classList.contains(t);var i=hA(e);return i.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(i)}function lA(e,t){if(void 0===e.classList||aA(e,t)){var i=hA(e);cA(e,(i?i+" ":"")+t)}else for(var n=Ck(t).split(/\s+/),r=0,s=n.length;r<s;r++)e.classList.add(n[r]);return this}function cA(e,t){return uP(e.className.baseVal)?e.className=t:e.className.baseVal=t,this}function hA(e){return uP(e.className.baseVal)?e.className:e.className.baseVal}function uA(e,t){var i,n=((i=document.createElement(e)).style.cssText="position:absolute;left:-10000px;top:-10000px;",document.body.appendChild(i),i);fP(t)?n.innerHTML=t:n.appendChild(t);var r=new wk(n.clientWidth,n.clientHeight);return Yk(n),r}Gk(["filter","WebkitFilter","OFilter","MozFilter","msFilter"]);var dA=Jk,pA=Qk;function mA(e){return e&&("mousemove"===e||"touchmove"===e)}function fA(e,t){var i=cP();return!!(e._mousemoveTime&&i-e._mousemoveTime<(t||48))||(e._mousemoveTime=i,!1)}var gA,_A="undefined"!=typeof Promise?Promise:GT.a,yA=!1,vA=[];function xA(e){return vA.indexOf(e)>-1}function bA(e){xA(e)||vA.push(e)}var wA,CA,SA={},EA="undefined"!=typeof window?window.navigator.hardwareConcurrency||4:0,TA=Math.max(Math.floor(EA/2),1),PA=function(){function e(e){void 0===e&&(e=50),this._limit=e,this._messages=[],this.buffers=[]}var t=e.prototype;return t.addMessage=function(e,t){if(this._messages.push(e),Array.isArray(t))for(var i=0;i<t.length;i++)this.buffers.indexOf(t[i])<0&&this.buffers.push(t[i])},t.isFull=function(){return this._messages.length>=this._limit},t.getMessage=function(){return{messageType:"batch",messages:this._messages}},e}(),MA=function(){function e(){this.active={},this.workerCount="undefined"!=typeof window?iP.workerCount||TA:0,this._messages=[],this._messageBuffers=[]}var t=e.prototype;return t.acquire=function(e){if(!this.workers){this.workers=[];for(var t=function(){if("undefined"==typeof window)return null;if(!wA){var e=function(){var e="\n    var adapters = {};\n    // Dynamic Create Adapter\n    function createAdapter(key,code){\n        if(adapters[key]||!code){\n            return;\n        }\n        var func=new Function('exports',code+'(exports)');\n        var workerExports={};\n        func(workerExports,self);\n        adapters[key]=workerExports;\n        workerExports.initialize && workerExports.initialize(self);\n        \n    }\n    onmessage = function (msg) {\n        msg = msg.data;\n        //createAdapter\n        if (msg.messageType === 'createAdapter') {\n           var key=msg.key;\n           var code=msg.code;\n           createAdapter(key,code);\n           postMessage({adapterName:key});\n           return;\n        }\n        // postMessage when main thread idle\n        if(msg.messageType==='idle'){\n            var messageCount = msg.messageCount||5;\n            handleMessageQueue(messageCount);\n            return;\n        }\n        if (msg.messageType === 'batch') {\n            const messages = msg.messages;\n            if (messages) {\n                for (let i = 0; i < messages.length; i++) {\n                    dispatch(messages[i]);\n                }\n            }\n        } else {\n            dispatch(msg);\n        }\n    };\n\n    function dispatch(msg) {\n        var workerKey = msg.workerKey;\n        var adapter = adapters[workerKey];\n        if (!adapter) {\n            post(msg.callback, 'Unregistered worker adapters for ' + workerKey);\n            return;\n        }\n        try {\n            adapter.onmessage(msg, wrap(msg.callback));\n        } catch (err) {\n            post(msg.callback, workerKey + ':' + err.message);\n            console.error(err);\n            throw err;\n        }\n    }\n\n    var messageResultQueue = [];\n    \n    function handleMessageQueue(messageCount){\n       if(messageResultQueue.length===0){\n          return;\n       }\n       var queues = messageResultQueue.slice(0,messageCount);\n       queues.forEach(function(queue){\n          post(queue.callback,queue.err,queue.data,queue.buffers);\n       });\n       messageResultQueue=messageResultQueue.slice(messageCount,Infinity);\n    }\n\n    function post(callback, err, data, buffers) {\n        var msg = {\n            callback : callback\n        };\n        if (err) {\n            msg.error = err;\n        } else {\n            msg.data = data;\n        }\n        if (buffers && buffers.length > 0) {\n            postMessage(msg, buffers);\n        } else {\n            postMessage(msg);\n        }\n    }\n\n    function joinQueue(callback,err,data,buffers){\n        messageResultQueue.push({\n            callback:callback,\n            err:err,\n            data:data,\n            buffers:buffers\n        });\n    }\n\n    function wrap(callback) {\n        return function (err, data, buffers) {\n            joinQueue(callback, err, data, buffers);\n        };\n    }\n    var workerExports;\n";for(var t in SA){var i=SA[t];bA(t),gP(i)&&0===i.length&&(i=i()),e+="\n    workerExports = {};\n    ("+i+")(workerExports, self);\n    adapters['"+t+"'] = workerExports",e+="\n    workerExports.initialize && workerExports.initialize(self);\n        "}return e+"\n    workerExports = null;\n"}();wA=window.URL.createObjectURL(new Blob([e],{type:"text/javascript"})),SA={}}return wA}(),i=0;i<this.workerCount;i++){var n=new Worker(t);n.id=i,this.workers.push(n)}URL.revokeObjectURL(t),yA=!0}return this.active[e]=!0,this.workers.slice()},t.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)},t.addMessage=function(e,t,i){var n=this._messages[e];n&&n.length||(n=this._messages[e]=[new PA]);var r=n[n.length-1];r.isFull()&&(r=new PA,this._messages[e].push(r)),r.addMessage(t,i)},t.commit=function(){if(this.workers&&this._messages.length)for(var e=0;e<this._messages.length;e++)if(this._messages[e]&&this._messages[e].length){var t=this._messages[e].shift();this.workers[e].postMessage(t.getMessage(),t.buffers)}},t.getWorkers=function(){return this.workers||[]},t.broadcastIdleMessage=function(){return this.getWorkers().forEach((function(e){e.postMessage({messageType:"idle",messageCount:iP.taskCountPerWorkerMessage})})),this},e}();function kA(){return CA||(CA=new MA,gA=CA),CA}var AA=[],IA=!0;function RA(){IA?kA().broadcastIdleMessage():kA().commit(),function(){if(0!==AA.length){for(var e=[],t=[],i=AA.length,n=0;n<i;n++){var r=AA[n];if(r.count--,-1===r.count)t.push(r);else{e.push(r);var s=r.run();r.results.push(s)}}AA=e,i=t.length;for(var o=0;o<i;o++){var a=t[o];a.resolve&&a.resolve(a.results)}}}(),IA=!IA}var OA=cP();function NA(e){var t=iP.idleTimeRemaining,i=iP.idleLog,n=iP.idleTimeout,r=iP.idleForceTimeThreshold;if(QP.requestIdleCallback){if(e&&e.timeRemaining){var s=e.timeRemaining();s>t||e.didTimeout?(e.didTimeout&&i&&console.error("idle timeout in",n),RA(),OA=cP()):(cP()-OA>r&&(RA(),OA=cP()),s<=t&&i&&console.warn("currrent page is busy,the timeRemaining is",s))}requestIdleCallback(NA,{timeout:n})}else RA(),lM(NA),i&&console.warn("current env not support requestIdleCallback. Fallback to requestAnimFrame")}var DA=!1;function zA(){DA||(DA=!0,QP.requestIdleCallback?requestIdleCallback(NA,{timeout:iP.idleTimeout}):lM(NA))}var LA,BA="function"==typeof Map,FA=function(){},jA=function(){function e(e,t){this.max=e,this.onRemove=t||FA,this.reset()}var t=e.prototype;return t.reset=function(){for(var e in this.data)this.onRemove(this.data[e]);return this.data={},this.order=[],this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(e,t){if(this.has(e))this.order.splice(this.order.indexOf(e),1),this.data[e]=t,this.order.push(e);else if(this.data[e]=t,this.order.push(e),this.order.length>this.max){var i=this.getAndRemove(this.order[0]);i&&this.onRemove(i)}return this},t.has=function(e){return e in this.data},t.keys=function(){return this.order},t.getAndRemove=function(e){if(!this.has(e))return null;var t=this.data[e];return delete this.data[e],this.order.splice(this.order.indexOf(e),1),t},t.get=function(e){return this.has(e)?this.data[e]:null},t.remove=function(e){if(!this.has(e))return this;var t=this.data[e];return delete this.data[e],this.onRemove(t),this.order.splice(this.order.indexOf(e),1),this},t.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this.getAndRemove(this.order[0]);t&&this.onRemove(t)}return this},e}();BA&&(LA=function(){function e(e,t){this.max=e,this.onRemove=t||FA,this.reset()}var t=e.prototype;return t.reset=function(){if(this.data){var e=this.data.values(),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}this.onRemove(n)}}return this.data=new Map,this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(e,t){return t?(this.has(e)?(this.data.delete(e),this.data.set(e,t)):this.data.set(e,t),this):this},t.keys=function(){var e=new Array(this.data.size),t=0,i=this.data.keys(),n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(r>=i.length)break;s=i[r++]}else{if((r=i.next()).done)break;s=r.value}e[t++]=s}return e},t.shrink=function(){for(var e=this.data.keys(),t=e.next();this.data.size>this.max;){var i=this.getAndRemove(t.value);i&&this.onRemove(i),t=e.next()}},t.has=function(e){return this.data.has(e)},t.getAndRemove=function(e){if(!this.has(e))return null;var t=this.data.get(e);return this.data.delete(e),t},t.get=function(e){return this.has(e)?this.data.get(e):null},t.remove=function(e){if(!this.has(e))return this;var t=this.data.get(e);return this.data.delete(e),this.onRemove(t),this},t.setMaxSize=function(e){return this.max=e,this.data.size>this.max&&this.shrink(),this},e}());var VA=BA?LA:jA,UA={jsonp:function(e,t){var i="_maptalks_jsonp_"+fM();e.match(/\?/)?e+="&callback="+i:e+="?callback="+i;var n=document.createElement("script");return n.type="text/javascript",n.src=e,window[i]=function(e){t(null,e),document.getElementsByTagName("head")[0].removeChild(n),n=null,delete window[i]},document.getElementsByTagName("head")[0].appendChild(n),this},get:function(e,t,i){if(gP(t)){var n=i;i=t,t=n}if(wP&&UA.get.node)return UA.get.node(e,i,t);var r=UA._getClient(i);if(r.open("GET",e,!0),t){for(var s in t.headers)r.setRequestHeader(s,t.headers[s]);r.withCredentials="include"===t.credentials,t.responseType&&(r.responseType=t.responseType)}return r.send(null),r},post:function(e,t,i){var n;if(fP(e)){if(gP(t)){var r=i;i=t,t=r}n=(t=t||{}).postData}else n=t,e=(t=e).url,i=i;if(wP&&UA.post.node)return t.url=e,UA.post.node(t,n,i);var s=UA._getClient(i);if(s.open("POST",t.url,!0),t.headers||(t.headers={}),t.headers["Content-Type"]||(t.headers["Content-Type"]="application/x-www-form-urlencoded"),"setRequestHeader"in s)for(var o in t.headers)t.headers.hasOwnProperty(o)&&s.setRequestHeader(o,t.headers[o]);return fP(n)||(n=JSON.stringify(n)),s.send(n),s},_wrapCallback:function(e,t){return function(){4===e.readyState&&(200===e.status?"arraybuffer"===e.responseType?0===e.response.byteLength?t(new Error("http status 200 returned without content.")):t(null,{data:e.response,cacheControl:e.getResponseHeader("Cache-Control"),expires:e.getResponseHeader("Expires"),contentType:e.getResponseHeader("Content-Type")}):t(null,e.responseText):t(new Error(e.statusText+","+e.status)))}},_getClient:function(e){var t;try{t=new XMLHttpRequest}catch(P0){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(P0){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(P0){}}}return t.onreadystatechange=UA._wrapCallback(t,e),t},getArrayBuffer:function(e,t,i){if(gP(t)){var n=i;i=t,t=n}return t||(t={}),t.responseType="arraybuffer",UA.get(e,t,i)},getImage:function(e,t,i){return UA.getArrayBuffer(t,i,(function(t,i){if(t)e.onerror&&e.onerror(t);else if(i){var n=window.URL||window.webkitURL,r=e.onload;e.onload=function(){r&&r(),n.revokeObjectURL(e.src)};var s=new Blob([new Uint8Array(i.data)],{type:i.contentType});e.cacheControl=i.cacheControl,e.expires=i.expires,e.src=i.data.byteLength?n.createObjectURL(s):AM}}))},getJSON:function(e,t,i){if(gP(t)){var n=i;i=t,t=n}var r=function(e,t){var n=t?gM(t):null;i(e,n)};return t&&t.jsonp?UA.jsonp(e,r):UA.get(e,t,r)}},qA=[1/0,1/0,-1/0,-1/0];function HA(e){e[0]=1/0,e[1]=1/0,e[2]=-1/0,e[3]=-1/0}function GA(e,t){if(e)if(Array.isArray(e[0]))for(var i=0,n=e.length;i<n;i++)GA(e[i],t);else if(Array.isArray(e))for(var r=0,s=e.length;r<s;r++){var o=e[r],a=o.x,l=o.y;t[0]=Math.min(a,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(a,t[2]),t[3]=Math.max(l,t[3])}else a=e.x,l=e.y,t[0]=Math.min(a,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(a,t[2]),t[3]=Math.max(l,t[3])}function WA(e,t,i,n,r){(0===t||t)&&(Array.isArray(t)&&(i=t[1],n=t[2],r=t[3],t=t[0]),e[0]=Math.min(t,e[0]),e[1]=Math.min(i,e[1]),e[2]=Math.max(n,e[2]),e[3]=Math.max(r,e[3]))}function ZA(e){return e&&e[0]!==1/0&&void 0!==e[0]}var $A=!1,XA=null,KA=Math.PI/180,YA={getCanvas2DContext:function(e){return e.getContext("2d",{willReadFrequently:!0})},setHitTesting:function(e){$A=e},createCanvas:function(e,t,i){var n;return wP?n=new i(e,t):((n=Xk("canvas")).width=e,n.height=t),n},prepareCanvasFont:function(e,t){e.textBaseline="top",e.font=Nk(t);var i=t.textFill;i||(i="#000"),e.fillStyle=YA.getRgba(i,t.textOpacity)},prepareCanvas:function(e,t,i,n){if(t){var r=t.lineWidth;uP(r)||e.lineWidth===r||(e.lineWidth=r);var s=t.linePatternFile,o=t.lineColor||"#000";if(n)e.strokeStyle="#000";else if(s&&i){var a;(t.linePatternDx||t.linePatternDy)&&(a=[t.linePatternDx,t.linePatternDy]),YA._setStrokePattern(e,s,r,a,i),t.lineDasharray=[]}else Lk(o)?e.strokeStyle=t.lineGradientExtent?YA._createGradient(e,o,t.lineGradientExtent):"#000":(Array.isArray(o)&&(o=YA.normalizeColorToRGBA(o)),e.strokeStyle=o);t.lineJoin&&(e.lineJoin=t.lineJoin),t.lineCap&&(e.lineCap=t.lineCap),e.setLineDash&&EM(t.lineDasharray)&&e.setLineDash(t.lineDasharray);var l=t.polygonPatternFile,c=t.polygonFill||"rgba(255,255,255,0)";if(n)e.fillStyle="#000";else if(l&&i){var h=QA(l),u=i.getImage([h,null,null]);if(u||(u=i.getImage([h+"-texture",null,r])),dM(h)&&u instanceof Image&&(QP.edge||QP.ie)){var d=u.width||20,p=u.height||20,m=YA.createCanvas(d,p);YA.image(m.getContext("2d"),u,0,0,d,p),u=m}u?(e.fillStyle=e.createPattern(u,"repeat"),(t.polygonPatternDx||t.polygonPatternDy)&&(e.fillStyle.polygonPatternOffset=[t.polygonPatternDx,t.polygonPatternDy])):"undefined"!=typeof console&&console.warn("img not found for",h)}else Lk(c)?e.fillStyle=t.polygonGradientExtent?YA._createGradient(e,c,t.polygonGradientExtent):"rgba(255,255,255,0)":(Array.isArray(c)&&(c=YA.normalizeColorToRGBA(c)),e.fillStyle=c)}},_createGradient:function(e,t,i){var n=null,r=t.places,s=i.getMin(),o=i.getMax(),a=i.getWidth(),l=i.getHeight();if(t.type&&"linear"!==t.type){if("radial"===t.type){if(r){if(6!==r.length)throw new Error("A radial gradient's places should have 6 numbers.");r=[s.x+r[0]*a,s.y+r[1]*l,a*r[2],s.x+r[3]*a,s.y+r[4]*l,a*r[5]]}else{var c=i.getCenter()._round();r=[c.x,c.y,Math.abs(c.x-s.x),c.x,c.y,0]}n=e.createRadialGradient.apply(e,r)}}else{if(r){if(4!==r.length)throw new Error("A linear gradient's places should have 4 numbers.");r=[s.x+r[0]*a,s.y+r[1]*l,s.x+r[2]*a,s.y+r[3]*l]}else r=[s.x,s.y,o.x,s.y];n=e.createLinearGradient.apply(e,r)}return t.colorStops.forEach((function(e){n.addColorStop.apply(n,e)})),n},_setStrokePattern:function(e,t,i,n,r){var s,o=QA(t);if(wP)s=r.getImage([o,null,i]);else{var a=o+"-texture-"+i;if(!(s=r.getImage(a))){var l=r.getImage([o,null,null]);if(l){var c;c=l.width&&l.height?Math.round(l.width*i/l.height):i;var h=YA.createCanvas(c,i,e.canvas.constructor);YA.image(h.getContext("2d"),l,0,0,c,i),r.addResource([a,null,i],h),s=h}}}s?(e.strokeStyle=e.createPattern(s,"repeat"),e.strokeStyle.linePatternOffset=n):"undefined"!=typeof console&&console.warn("img not found for",o)},clearRect:function(e,t,i,n,r){e.canvas._drawn=!1,e.clearRect(t,i,n,r)},fillCanvas:function(e,t,i,n){if($A&&(t=1),e.canvas._drawn=!0,0!==t){var r,s=YA._isPattern(e.fillStyle),o=e.fillStyle&&e.fillStyle.polygonPatternOffset,a=o?o[0]:0,l=o?o[1]:0;uP(t)&&(t=1),t<1&&(r=e.globalAlpha,e.globalAlpha*=t),s&&e.translate((i=i||0)+a,(n=n||0)+l),e.fill(),s&&e.translate(-i-a,-n-l),t<1&&(e.globalAlpha=r)}},getRgba:function(e,t){return uP(t)&&(t=1),"#"!==e[0]?(Array.isArray(e)&&(e=YA.normalizeColorToRGBA(e,t)),e):(7===e.length?(i=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16)):(i=17*parseInt(e.substring(1,2),16),n=17*parseInt(e.substring(2,3),16),r=17*parseInt(e.substring(3,4),16)),"rgba("+i+","+n+","+r+","+t+")");var i,n,r},normalizeColorToRGBA:function(e,t){return void 0===t&&(t=1),"rgba("+255*e[0]+","+255*e[1]+","+255*e[2]+","+(4===e.length?e[3]:1)*t+")"},image:function(e,t,i,n,r,s){e.canvas._drawn=!0;try{dP(r)&&dP(s)?e.drawImage(t,i,n,r,s):e.drawImage(t,i,n)}catch(o){console&&(console.warn("error when drawing image on canvas:",o),console.warn(t))}},text:function(e,t,i,n,r){return YA._textOnMultiRow(e,r.rows,n,i,r.size,r.rawSize)},_textOnMultiRow:function(e,t,i,n,r,s){var o,a,l=Ok(r,i.textHorizontalAlignment,i.textVerticalAlignment),c=s.height+i.textLineSpacing,h=n.add(0,l.y),u=i.textMaxHeight,d=0;HA(qA);for(var p=0,m=t.length;p<m;p++){o=t[p].text,a=Ok(t[p].size,i.textHorizontalAlignment,i.textVerticalAlignment);var f=h.add(a.x,p*c);YA._textOnLine(e,o,f,i.textHaloRadius,i.textHaloFill,i.textHaloOpacity);var g=t[p].size,_=f.x,y=f.y;if(WA(qA,_,y,_+g.width,y+g.height),u>0&&(d+=c)+g.height>=u)break}return qA},_textOnLine:function(e,t,i,n,r,s){$A&&(s=1);var o,a,l=0!==s&&0!==n;e.textBaseline="top";var c=e.shadowBlur,h=e.shadowOffsetX,u=e.shadowOffsetY;if(l){var d=e.globalAlpha;e.globalAlpha*=s,e.miterLimit=2,e.lineJoin="round",e.lineCap="round",e.lineWidth=2*n,Array.isArray(r)&&(r=YA.normalizeColorToRGBA(r)),e.strokeStyle=r,e.strokeText(t,i.x,i.y+1),e.miterLimit=10,e.globalAlpha=d,o=e.globalCompositeOperation,e.globalCompositeOperation="destination-out",a=e.fillStyle,e.fillStyle="#000"}c&&l&&(e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0),YA.fillText(e,t,i),o&&(e.globalCompositeOperation=o,YA.fillText(e,t,i,a),c&&(e.shadowBlur=c,e.shadowOffsetX=h,e.shadowOffsetY=u))},fillText:function(e,t,i,n){e.canvas._drawn=!0,n&&(e.fillStyle=n),e.fillText(t,i.x,i.y+1)},_stroke:function(e,t,i,n){if($A&&(t=1),e.canvas._drawn=!0,0!==t){var r,s=e.strokeStyle&&e.strokeStyle.linePatternOffset,o=s?s[0]:0,a=s?s[1]:0,l=YA._isPattern(e.strokeStyle)&&(!uP(i)&&!uP(n)||!uP(o)&&!uP(a));uP(t)&&(t=1),t<1&&(r=e.globalAlpha,e.globalAlpha*=t),l&&e.translate((i=i||0)+o,(n=n||0)+a),e.stroke(),l&&e.translate(-i-o,-n-a),t<1&&(e.globalAlpha=r)}},_path:function(e,t,i,n,r){if(EM(t))for(var s,o=EM(i),a=!0!==r&&YA._isPattern(e.strokeStyle),l=0,c=t.length;l<c;l++)if(s=t[l],!o||e.setLineDash)e.lineTo(s.x,s.y),a&&l>0&&(h(t[l-1],s),e.beginPath(),e.moveTo(s.x,s.y));else if(o){if(l===c-1)break;JA(e,s,t[l+1],i)}function h(t,i){var r=kM(t.x,t.y,i.x,i.y);e.save();var s=Math.cos(r);Math.abs(s)<1e-7?e.translate(t.x-e.lineWidth/2,t.y):e.translate(t.x,t.y-e.lineWidth/2/s),e.rotate(r),YA._stroke(e,n),e.restore()}},path:function(e,t,i,n,r){EM(t)&&(e.beginPath(),e.moveTo(t[0].x,t[0].y),YA._path(e,t,r,i),YA._stroke(e,i))},_multiClip:function(e,t){if(t&&0!==t.length)for(var i=0,n=(t=t[0]).length;i<n;i++){var r=t[i],s=r.x,o=r.y;0===i?e.moveTo(s,o):e.lineTo(s,o),i===n-1&&e.lineTo(s=t[0].x,o=t[0].y)}},polygon:function(e,t,i,n,r,s){if(e.isMultiClip)YA._multiClip(e,t);else if(e.isClip)YA._multiClip(e,Array.isArray(t[0])?t:[t]);else if(EM(t)){var o=YA._isPattern(e.strokeStyle),a=EM(r)&&!e.setLineDash||o&&!s;EM(t[0])||(t=[t]);var l,c,h,u=e;if(t.length>1&&!wP&&(XA||(XA=YA.createCanvas(1,1)),e.canvas._drawn=!1,XA.width=e.canvas.width,XA.height=e.canvas.height,tI(e=XA.getContext("2d"),[]),tI(e,r),eI(e,u)),a){for(e.save(),c=0,h=t.length;c<h;c++)EM(t[c])&&(YA._ring(e,t[c],null,0,!0),l=n,c>0&&(e.globalCompositeOperation="destination-out",l=1),YA.fillCanvas(e,l,t[c][0].x,t[c][0].y),c>0?e.globalCompositeOperation="source-over":h>1&&(e.fillStyle="#fff"),YA._stroke(e,0));e.restore()}var d=e.fillStyle;for(c=0,h=t.length;c<h;c++)EM(t[c])&&(s?(YA.paintSmoothLine(e,t[c],i,s,!0),e.closePath()):YA._ring(e,t[c],r,i),a||(l=n,c>0&&(e.globalCompositeOperation="destination-out",l=1),YA.fillCanvas(e,l,t[c][0].x,t[c][0].y),c>0?e.globalCompositeOperation="source-over":h>1&&(e.fillStyle="#fff")),YA._stroke(e,i));e.fillStyle!==d&&(e.fillStyle=d),t.length>1&&!wP&&(u.drawImage(XA,0,0),u.canvas._drawn=e.canvas._drawn,eI(u,e))}},_ring:function(e,t,i,n,r){var s=YA._isPattern(e.strokeStyle);r||!s||t[0].equals(t[t.length-1])||(t=t.concat([t[0]])),e.beginPath(),e.moveTo(t[0].x,t[0].y),YA._path(e,t,i,n,r),s||e.closePath()},paintSmoothLine:function(e,t,i,n,r,s,o){if(t)if(t.length<=2||!n)YA.path(e,t,i);else{var a,l=t.length,c=r?l:l-1;e.beginPath(),e.moveTo(t[0].x,t[0].y),void 0!==o&&(c-=Math.max(c-s-1,0));for(var h=0;h<c;h++){var u=void 0,d=void 0,p=void 0,m=void 0,f=void 0,g=void 0;h-1<0?r?(u=t[c-1].x,d=t[c-1].y):(u=t[h+1].x,d=t[h+1].y):(u=t[h-1].x,d=t[h-1].y),h+1<l?(p=t[h+1].x,m=t[h+1].y):(p=t[h+1-l].x,m=t[h+1-l].y),h+2<l?(f=t[h+2].x,g=t[h+2].y):r?(f=t[h+2-l].x,g=t[h+2-l].y):(f=t[h].x,g=t[h].y);var _=v(u,d,t[h].x,t[h].y,p,m,f,g,n,h===c-1?o:1);if(h===c-1&&o>=0&&o<1){e.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]),t.splice(c-1,l-(c-1)-1);var y=new uM(_[4],_[5]);y.prevCtrlPoint=new uM(_[2],_[3]),t.push(y),l=t.length}else e.bezierCurveTo(_[0],_[1],_[2],_[3],p,m);t[h].nextCtrlPoint=_.slice(0,2),t[h].prevCtrlPoint=a?a.slice(2):null,a=_}!r&&t[1].prevCtrlPoint&&(t[0].nextCtrlPoint=t[1].prevCtrlPoint,delete t[0].prevCtrlPoint),t[l-1].prevCtrlPoint||(t[l-1].prevCtrlPoint=t[l-2].nextCtrlPoint),YA._stroke(e,i)}function v(e,t,i,n,r,s,o,a,l,c){var h=(e+i)/2,u=(t+n)/2,d=(i+r)/2,p=(n+s)/2,m=(r+o)/2,f=(s+a)/2,g=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t)),_=Math.sqrt((r-i)*(r-i)+(s-n)*(s-n)),y=g/(g+_),v=_/(_+Math.sqrt((o-r)*(o-r)+(a-s)*(a-s))),x=h+(d-h)*y,b=u+(p-u)*y,w=d+(m-d)*v,C=p+(f-p)*v,S=x+(d-x)*l+i-x,E=b+(p-b)*l+n-b,T=w+(d-w)*l+r-w,P=C+(p-C)*l+s-C,M=[S,E,T,P];return c<1?function(e,t,i,n,r,s,o,a,l,c){var h=1-t,u=i*h*h+2*r*t*h+o*t*t,d=r*h*h+2*o*t*h+l*t*t,p=n*h*h+2*s*t*h+a*t*t,m=s*h*h+2*a*t*h+c*t*t;return[(1*i*1+2*r*0*1+0*o*0)*h+(1*r*1+2*o*0*1+0*l*0)*t,(1*n*1+2*s*0*1+0*a*0)*h+(1*s*1+2*a*0*1+0*c*0)*t,1*u+0*d,1*p+0*m,u*h+d*t,p*h+m*t]}(0,c,i,n,S,E,T,P,r,s):M}},_arcBetween:function(e,t,i,n){var r=n,s=t.distanceTo(i),o=s/2/Math.sin(r/2),a=Math.asin((i.y-t.y)/s);t.x>i.x&&(a=Math.PI-a);var l=a-(90*KA-r/2),c=Math.cos(l)*o,h=Math.sin(l)*o,u=t.x+c,d=t.y+h,p=Math.asin((i.y-d)/o);u>i.x&&(p=Math.PI-p);var m=p+r;return e.beginPath(),e.arc(u,d,o,p,m),[u,d]},_lineTo:function(e,t){e.lineTo(t.x,t.y)},bezierCurveAndFill:function(e,t,i,n){e.beginPath();var r=t[0];e.moveTo(r.x,r.y);var s=[e];s.push.apply(s,t.splice(1)),YA._bezierCurveTo.apply(YA,s),YA.fillCanvas(e,n),YA._stroke(e,i)},_bezierCurveTo:function(e,t,i,n){e.bezierCurveTo(t.x,t.y,i.x,i.y,n.x,n.y)},ellipse:function(e,t,i,n,r,s,o){var a,l,c,h,u,d,p,m,f;e.beginPath(),i===n&&i===r?e.arc(t.x,t.y,i,0,2*Math.PI):e.ellipse?n!==r?(e.ellipse(t.x,t.y,i,n,0,180*KA,360*KA,!1),e.ellipse(t.x,t.y,i,r,0,0,180*KA,!1)):e.ellipse(t.x,t.y,i,n,0,0,360*KA,!1):(p=(c=i)*(d=.5522848),m=(h=n)*d,f=(u=r)*d,e.moveTo((a=t.x)-c,l=t.y),e.bezierCurveTo(a-c,l-m,a-p,l-h,a,l-h),e.bezierCurveTo(a+p,l-h,a+c,l-m,a+c,l),e.bezierCurveTo(a+c,l+f,a+p,l+u,a,l+u),e.bezierCurveTo(a-p,l+u,a-c,l+f,a-c,l),e.closePath()),YA.fillCanvas(e,o,t.x-i,t.y-n),YA._stroke(e,s,t.x-i,t.y-n)},rectangle:function(e,t,i,n,r){var s=t.x,o=t.y;e.beginPath(),e.rect(s,o,i.width,i.height),YA.fillCanvas(e,r,s,o),YA._stroke(e,n,s,o)},sector:function(e,t,i,n,r,s){var o=KA;!function(e,t,i,n,a,l){var c=o*-l,h=o*-a;e.beginPath(),e.moveTo(t,i),e.arc(t,i,n,c,h),e.lineTo(t,i),YA.fillCanvas(e,s,t-n,i-n),YA._stroke(e,r,t-n,i-n)}(e,t.x,t.y,i,n[0],n[1])},_isPattern:function(e){return!fP(e)&&!("addColorStop"in e)},drawCross:function(e,t,i,n,r){e.canvas._drawn=!0,e.strokeStyle=r,e.lineWidth=n,e.beginPath(),e.moveTo(t-5,i),e.lineTo(t+5,i),e.moveTo(t,i-5),e.lineTo(t,i+5),e.stroke()},copy:function(e,t){var i=t||Xk("canvas");return i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0),i},pixelRect:function(e,t,i,n){var r=e.globalAlpha,s=!1;if(e.lineWidth>0&&i>0)s=!0,i<1&&(e.globalAlpha*=i);else{if(!(n>0))return;n<1&&(e.globalAlpha*=n)}e.canvas._drawn=!0,s?e.strokeRect(t[0],t[1],1,1):e.fillRect(t[0],t[1],1,1),e.globalAlpha!==r&&(e.globalAlpha=r)}};function JA(e,t,i,n){var r=t.x,s=t.y,o=i.x,a=i.y,l=n,c=function(e,t){return e<=t},h=function(e,t){return e>=t},u=function(e,t){return Math.min(e,t)},d=function(e,t){return Math.max(e,t)},p={thereYet:h,cap:u},m={thereYet:h,cap:u};s-a>0&&(m.thereYet=c,m.cap=d),r-o>0&&(p.thereYet=c,p.cap=d),e.moveTo(r,s);for(var f,g,_=r,y=s,v=0,x=!0;!p.thereYet(_,o)||!m.thereYet(y,a);)f=Math.atan2(a-s,o-r),g=l[v],_=p.cap(o,_+Math.cos(f)*g),y=m.cap(a,y+Math.sin(f)*g),x?e.lineTo(_,y):e.moveTo(_,y),v=(v+1)%l.length,x=!x}function QA(e){return"data:image/"===e.substring(0,"data:image/".length)?e:MM(e)}function eI(e,t){e.filter=t.filter,e.fillStyle=t.fillStyle,e.globalAlpha=t.globalAlpha,e.lineCap=t.lineCap,e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle}function tI(e,t){t&&e.setLineDash&&Array.isArray(t)&&e.setLineDash(t)}function iI(e){return"Z__"+e}var nI=function(e){return function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.on=function(e,t,i){if(!e)return this;if(!fP(e))return this._switch("on",e,t);if(!t)return this;this._eventMap||(this._eventMap={});var n,r=e.toLowerCase().split(" ");i||(i=this);var s,o=dP(t._id);t._id=fM();for(var a=0,l=r.length;a<l;a++){var c=iI(n=r[a]);if(t[c]&&(t[c]._id=t._id),(s=this._eventMap[n])||(this._eventMap[n]=s=[]),o){var h=s.length;if(h>0)for(var u=0;u<h;u++)if(t===s[u].handler&&s[u].context===i)return QP.isTest||console.warn(this,"find '"+e+"' handler:",t," The old listener function will be removed"),this;s.push({handler:t,context:i})}else s.push({handler:t,context:i})}return this},i.addEventListener=function(){return this.on.apply(this,arguments)},i.once=function(e,t,i){if(!fP(e)){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=this._wrapOnceHandler(r,e[r],i));return this._switch("on",n)}for(var s=e.split(" "),o=0,a=s.length;o<a;o++)this.on(s[o],this._wrapOnceHandler(s[o],t,i));return this},i.off=function(e,t,i){if(!this._eventMap||!e)return this;if(!fP(e))return this._switch("off",e,t);if(!t)return this;if(!dP(t._id))return this;var n,r,s,o=e.split(" ");i||(i=this);for(var a=0,l=o.length;a<l;a++)if(s=iI(n=o[a].toLowerCase()),r=this._eventMap[n]){for(var c=r.length-1;c>=0;c--){var h=r[c];t!==h.handler&&t!==h.handler[s]||h.context!==i||(delete h.handler[s],r.splice(c,1))}r.length||delete this._eventMap[n]}return this},i.removeEventListener=function(){return this.off.apply(this,arguments)},i.listens=function(e,t,i){if(!this._eventMap||!fP(e))return 0;var n=this._eventMap[e.toLowerCase()];if(!n||!n.length)return 0;if(!t)return n.length;for(var r=0,s=n.length;r<s;r++)if(t===n[r].handler&&(uP(i)||n[r].context===i))return 1;return 0},i.getListeningEvents=function(){return this._eventMap?Object.keys(this._eventMap):[]},i.copyEventListeners=function(e){var t,i=e._eventMap;if(!i)return this;for(var n in i)for(var r=0,s=(t=i[n]).length;r<s;r++)this.on(n,t[r].handler,t[r].context);return this},i.fire=function(){return this._eventParent?this._eventParent.fire.apply(this._eventParent,arguments):this._fire.apply(this,arguments)},i._wrapOnceHandler=function(e,t,i){var n=iI(e),r=!1,s=function e(){r||(delete s[n],r=!0,t.apply(i||this,arguments),e._called=!0)};return s[n]=t,s},i._switch=function(e,t,i){for(var n in t)t.hasOwnProperty(n)&&this[e](n,t[n],i);return this},i._clearListeners=function(e){this._eventMap&&fP(e)&&this._eventMap[e.toLowerCase()]&&(this._eventMap[e]=null)},i._clearAllListeners=function(){this._eventMap=null},i._setEventParent=function(e){return this._eventParent=e,this},i._setEventTarget=function(e){return this._eventTarget=e,this},i._fire=function(e,t){if(!this._eventMap)return this;e=e.toLowerCase();var i=this._eventMap[e];if(!i)return this;t||(t={}),t.type=e,t.target=this._eventTarget||this;for(var n,r,s=i.slice(0),o=0,a=s.length;o<a;o++)s[o]&&(s[o].handler._called||(n=s[o].context,r=hP({},t),!1===(n?s[o].handler.call(n,r):s[o].handler(r))&&t.domEvent&&iA(t.domEvent)));var l=this._eventMap[e];if(l){for(var c=[],h=0,u=l.length;h<u;h++)l[h].handler._called||c.push(l[h]);this._eventMap[e]=c}return this},t}(e)},rI=nI(function(){function e(e){this.target=e}var t=e.prototype;return t.enable=function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},t.disable=function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},t.enabled=function(){return!!this._enabled},t.remove=function(){this.disable(),delete this.target,delete this.dom},e}()),sI=function(){function e(e){if(!this||!this.setOptions)throw new Error('Class instance is being created without "new" operator.');this.setOptions(e),this.callInitHooks(),this._isUpdatingOptions=!1}var t=e.prototype;return t.proxyOptions=function(){var e=this;return QP.proxy?(this.options.isExtensible||(this.options=new Proxy(this.options,{set:function(t,i,n){if(t[i]===n)return!0;if(t[i]=n,e._isUpdatingOptions)return!0;var r={};return r[i]=n,e.config(r),!0}})),this):this},t.callInitHooks=function(){var e=Object.getPrototypeOf(this);return this._visitInitHooks(e),this},t.setOptions=function(e){if(this.hasOwnProperty("options")||(this.options=this.options?Object.create(this.options):{}),!e)return this;for(var t in e)this.options[t]=e[t];return this},t.config=function(e){if(this._isUpdatingOptions=!0,!e){var t={};for(var i in this.options)this.options.hasOwnProperty(i)&&(t[i]=this.options[i]);return this._isUpdatingOptions=!1,t}if(2===arguments.length){var n={};n[e]=arguments[1],e=n}for(var r in e)this.options[r]=e[r],this[r]&&this[r]instanceof rI&&(e[r]?this[r].enable():this[r].disable());return this.onConfig(e),this._isUpdatingOptions=!1,this},t.onConfig=function(){},t._visitInitHooks=function(e){if(!this._initHooksCalled){var t=Object.getPrototypeOf(e);t._visitInitHooks&&t._visitInitHooks.call(this,t),this._initHooksCalled=!0;var i=e._initHooks;if(i&&i!==t._initHooks)for(var n=0;n<i.length;n++)i[n].call(this)}},e.addInitHook=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r="function"==typeof e?e:function(){this[e].apply(this,i)},s=this.prototype,o=Object.getPrototypeOf(s);return s._initHooks&&s._initHooks!==o._initHooks||(s._initHooks=[]),s._initHooks.push(r),this},e.include=function(){for(var e=0;e<arguments.length;e++)hP(this.prototype,e<0||arguments.length<=e?void 0:arguments[e]);return this},e.mergeOptions=function(e){var t=this.prototype,i=Object.getPrototypeOf(t);return t.options&&t.options!==i.options||(t.options=t.options?Object.create(t.options):{}),hP(t.options,e),this},e}(),oI=new(function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t}(nI((function(){}))));if("undefined"!=typeof window&&window.matchMedia)for(var aI=1;aI<500;aI++){var lI=(.01*aI).toFixed(2),cI=window.matchMedia("screen and (resolution: "+lI+"dppx)");cI&&(cI.addEventListener?cI.addEventListener("change",QP.checkDevicePixelRatio):cI.addListener&&cI.addListener(QP.checkDevicePixelRatio))}if(QP.devicePixelRatio){var hI=QP.devicePixelRatio;Object.defineProperty(QP,"devicePixelRatio",{get:function(){return hI},set:function(e){e!==hI&&(hI=e,QP.monitorDPRChange&&oI.fire("dprchange",{devicePixelRatio:e}))}})}QP.webgl&&"undefined"!=typeof document&&(Jk(document,"visibilitychange",(function(){oI.fire("docvisibilitychange",{visibilityState:document.visibilityState})})),Jk(document,"dragstart",(function(){oI.fire("dragstart")})),Jk(document,"dragend",(function(){oI.fire("dragend")})));var uI={},dI=function(e){return function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.registerJSONType=function(e){return e?uI[e]?(console.error(e+" has register. please use Different name for:",this),this):(uI[e]=this,this):this},t.getJSONClass=function(e){return e?uI[e]:null},t.prototype.getJSONType=function(){if(void 0===this._jsonType){var e=Object.getPrototypeOf(this).constructor;for(var t in uI)if(uI[t]===e){this._jsonType=t;break}}if(!this._jsonType)throw new Error("Found an unregistered Layer/Geometry class!");return this._jsonType},t}(e)},pI={},mI=function(){function e(){this._tree=ZT()(9,["[0]","[1]","[2]","[3]"])}var t=e.prototype;return t.collides=function(e){return pI.minX=e[0],pI.minY=e[1],pI.maxX=e[2],pI.maxY=e[3],this._tree.collides(pI)},t.insertBox=function(e){return this._tree.insert(e),this},t.bulkInsertBox=function(e){return this._tree.load(e),this},t.clear=function(){return this._tree.clear(),this},e}();function fI(e){return function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHandler=function(e,t){if(!t)return this;if(this._handlers||(this._handlers=[]),this[e])return this[e].enable(),this;var i=this[e]=new t(this);return this._handlers.push(i),this.options[e]&&i.enable(),this},i.removeHandler=function(e){if(!e)return this;var t=this[e];if(t){var i=this._handlers.indexOf(t);i>=0&&this._handlers.splice(i,1),this[e].remove(),delete this[e]}return this},i._clearHandlers=function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].remove();this._handlers=[]},t}(e)}var gI={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},_I={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},yI=function(e){function t(t,i){var n;return void 0===i&&(i={}),(n=e.call(this,null)||this).dom=t,n.options=i,n}tM(t,e);var i=t.prototype;return i.enable=function(){return this.dom?(this._onMouseDown=function(e){return this.onMouseDown(e)},dA(this.dom,"touchstart mousedown",this._onMouseDown,this),this):this},i.disable=function(){return this.dom?(this._offEvents(),pA(this.dom,"touchstart mousedown",this._onMouseDown),delete this._onMouseDown,this):this},i.onMouseDown=function(e){if((this.options.rightclick||2!==e.button)&&!(e.touches&&e.touches.length>1||this.options.cancelOn&&!0===this.options.cancelOn(e))){var t=this.dom;t.setCapture?t.setCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP),t.ondragstart=function(){return!1},delete this.moved;var i=e.touches?e.touches[0]:e;this.startPos=new uM(i.clientX,i.clientY),pA(document,gI[e.type],this.onMouseMove,this),pA(document,_I[e.type],this.onMouseUp,this),dA(document,gI[e.type],this.onMouseMove,this),dA(document,_I[e.type],this.onMouseUp,this),this.options.ignoreMouseleave||(pA(this.dom,"mouseleave",this.onMouseUp,this),dA(this.dom,"mouseleave",this.onMouseUp,this)),this.fire("mousedown",{domEvent:e,mousePos:new uM(i.clientX,i.clientY)})}},i.onMouseMove=function(e){if(e.touches&&e.touches.length>1)this.moved&&(this.interupted=!0,this.onMouseUp(e));else{var t=e.touches?e.touches[0]:e,i=new uM(t.clientX,t.clientY).sub(this.startPos);(i.x||i.y)&&(this.moved?this.fire("dragging",{domEvent:e,mousePos:new uM(t.clientX,t.clientY)}):(this.fire("dragstart",{domEvent:e,mousePos:this.startPos.copy()}),this.moved=!0))}},i.onMouseUp=function(e){var t=e.changedTouches?e.changedTouches[0]:e;this._offEvents();var i={domEvent:e};dP(t.clientX)&&(i.mousePos=new uM(parseInt(t.clientX,0),parseInt(t.clientY,0))),this.moved&&(i.interupted=this.interupted,this.fire("dragend",i),delete this.interupted,delete this.moved),this.fire("mouseup",i)},i._offEvents=function(){var e=this.dom;if(pA(e,"mouseleave",this.onMouseUp,this),"undefined"!=typeof document&&"undefined"!=typeof window){for(var t in gI)pA(document,gI[t],this.onMouseMove,this),pA(document,_I[t],this.onMouseUp,this);e.releaseCapture?e.releaseCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP)}},t}(rI),vI=function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.toNumberArrays=function(e){return Array.isArray(e)?vM(e,(function(e){return[e.x,e.y]})):[e.x,e.y]},t.toCoordinates=function(e){if(dP(e[0])&&dP(e[1]))return new t(e);if(e instanceof t)return e;for(var i=[],n=0,r=e.length;n<r;n++){var s=e[n];Array.isArray(s)?dP(s[0])?i.push(new t(s)):i.push(t.toCoordinates(s)):i.push(s instanceof t?s:new t(s))}return i},t}(hM),xI=function(){function e(e,t){this.type=e,this.properties=t}return e.createProj4=function(t){return new e("proj4",{proj:t})},e.fromProjectionCode=function(t){return t&&e[t=t.toUpperCase().replace(":","")]||null},e}();xI.WGS84=xI.createProj4("+proj=longlat +datum=WGS84 +no_defs"),xI.EPSG4326=xI.WGS84,xI.EPSG3857=xI.createProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),xI.IDENTITY=xI.createProj4("+proj=identity +no_defs"),xI.CGCS2000=xI.createProj4("+proj=longlat +datum=CGCS2000"),xI.EPSG4490=xI.CGCS2000,xI.BD09LL=xI.createProj4("+proj=longlat +datum=BD09"),xI.GCJ02=xI.createProj4("+proj=longlat +datum=GCJ02");var bI,wI=new uM(0,0),CI=new vI(0,0),SI=new vI(0,0),EI=new vI(0,0),TI=new vI(0,0),PI=new vI(0,0),MI=new vI(0,0),kI=new vI(0,0),AI=new vI(0,0),II=[],RI=[],OI=function(){function e(e,t,i,n){this._clazz=vI;var r=arguments.length,s=r>0?arguments[r-1]:null;s&&s.unproject&&(this.projection=arguments[r-1]),this._dirty=!0,this._initialize(e,t,i,n)}var t=e.prototype;return t._initialize=function(e,t,i,n){if(this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,!uP(e)){var r=this.projection;dP(e)&&dP(t)&&dP(i)&&dP(n)?r?this.set(e,t,i,n):this.set(Math.min(e,i),Math.min(t,n),Math.max(e,i),Math.max(t,n)):Array.isArray(e)?r?this.set(e[0],e[1],e[2],e[3]):this.set(Math.min(e[0],e[2]),Math.min(e[1],e[3]),Math.max(e[0],e[2]),Math.max(e[1],e[3])):dP(e.x)&&dP(t.x)&&dP(e.y)&&dP(t.y)?r?this.set(e.x,e.y,t.x,t.y):(e.x>t.x?(this.xmin=t.x,this.xmax=e.x):(this.xmin=e.x,this.xmax=t.x),e.y>t.y?(this.ymin=t.y,this.ymax=e.y):(this.ymin=e.y,this.ymax=t.y)):dP(e.xmin)&&dP(e.xmax)&&dP(e.ymin)&&dP(e.ymax)&&this.set(e.xmin,e.ymin,e.xmax,e.ymax)}},t._add=function(e){return this._dirty=!0,uP(e.x)?uP(e.xmin)?uP(e[0])||(this.xmin+=e[0],this.ymin+=e[1],this.xmax+=e[0],this.ymax+=e[1]):(this.xmin+=e.xmin,this.ymin+=e.ymin,this.xmax+=e.xmax,this.ymax+=e.ymax):(this.xmin+=e.x,this.ymin+=e.y,this.xmax+=e.x,this.ymax+=e.y),this},t.add=function(){var e=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return e._add.apply(e,arguments)},t._scale=function(e){return this._dirty=!0,this.xmin*=e,this.ymin*=e,this.xmax*=e,this.ymax*=e,this},t._sub=function(e){return this._dirty=!0,uP(e.x)?uP(e.xmin)?uP(e[0])||(this.xmin-=e[0],this.ymin-=e[1],this.xmax-=e[0],this.ymax-=e[1]):(this.xmin-=e.xmin,this.ymin-=e.ymin,this.xmax-=e.xmax,this.ymax-=e.ymax):(this.xmin-=e.x,this.ymin-=e.y,this.xmax-=e.x,this.ymax-=e.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(){var e=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return e._sub.apply(e,arguments)},t.substract=function(){return this.sub.apply(this,arguments)},t.round=function(){return new this.constructor(Math.round(this.xmin),Math.round(this.ymin),Math.round(this.xmax),Math.round(this.ymax),this.projection)},t._round=function(){return this._dirty=!0,this.xmin=Math.round(this.xmin),this.ymin=Math.round(this.ymin),this.xmax=Math.round(this.xmax),this.ymax=Math.round(this.ymax),this},t.getMin=function(e){return e?(e.set(this.xmin,this.ymin),e):new this._clazz(this.xmin,this.ymin)},t.getMax=function(e){return e?(e.set(this.xmax,this.ymax),e):new this._clazz(this.xmax,this.ymax)},t.getCenter=function(e){var t=(this.xmin+this.xmax)/2,i=(this.ymin+this.ymax)/2;return e?(e.set(t,i),e):new this._clazz(t,i)},t.isValid=function(){return!(uP(this.xmin)||uP(this.ymin)||uP(this.xmax)||uP(this.ymax))},t.equals=function(e){return this.xmin===e.xmin&&this.xmax===e.xmax&&this.ymin===e.ymin&&this.ymax===e.ymax},t.intersects=function(e){this._project(this),this._project(e);var t=Math.max(this.pxmin,e.pxmin),i=Math.max(this.pymin,e.pymin),n=Math.min(this.pxmax,e.pxmax),r=Math.min(this.pymax,e.pymax);return!(t>n||i>r)},t.within=function(e){return this._project(this),this._project(e),this.pxmin>=e.pxmin&&this.pxmax<=e.pxmax&&this.pymin>=e.pymin&&this.pymax<=e.pymax},t.contains=function(e){if(!e)return!1;this._project(this);var t=this.projection;if(t)if(void 0!==e.x){var i=CI;Array.isArray(e)?(i.x=e[0],i.y=e[1]):(i.x=e.x,i.y=e.y),e=t.project(i,i)}else void 0!==e.xmin&&this._project(e);return(e.x||e.pxmin||0)>=this.pxmin&&(e.x||e.pxmax||0)<=this.pxmax&&(e.y||e.pymin||0)>=this.pymin&&(e.y||e.pymax||0)<=this.pymax},t.getWidth=function(){return Math.abs(this.xmax-this.xmin)},t.getHeight=function(){return Math.abs(this.ymax-this.ymin)},t.getSize=function(){return new wk(this.getWidth(),this.getHeight())},t.set=function(e,t,i,n){return this.xmin=e,this.ymin=t,this.xmax=i,this.ymax=n,this._dirty=!0,this},t.__combine=function(e){var t,i,n,r;void 0!==e.x&&(bI.xmin=bI.xmax=e.x,bI.ymin=bI.ymax=e.y,e=bI),this._project(e),this._project(this),dP(this.pxmin)?(t=Math.min(this.pxmin,e.pxmin),i=Math.min(this.pymin,e.pymin),n=Math.max(this.pxmax,e.pxmax),r=Math.max(this.pymax,e.pymax)):(t=e.pxmin,i=e.pymin,n=e.pxmax,r=e.pymax);var s=this.projection;if(s){SI.set(t,i),EI.set(n,r);var o=s.unproject(SI,SI),a=s.unproject(EI,EI);t=o.x,i=o.y,n=a.x,r=a.y}return RI[0]=t,RI[1]=i,RI[2]=n,RI[3]=r,RI},t._combine=function(e){if(!e||e.isValid&&!e.isValid())return this;var t=this.__combine(e);return this.set(t[0],t[1],t[2],t[3]),this._dirty=!0,this},t.combine=function(e){if(!e||e.isValid&&!e.isValid())return this;var t=this.__combine(e);return new this.constructor(t[0],t[1],t[2],t[3],this.projection)},t.intersection=function(e){if(!this.intersects(e))return null;TI.x=Math.max(this.pxmin,e.pxmin),TI.y=Math.max(this.pymin,e.pymin),PI.x=Math.min(this.pxmax,e.pxmax),PI.y=Math.min(this.pymax,e.pymax);var t=TI,i=PI,n=this.projection;return n&&(t=n.unproject(t,t),i=n.unproject(i,i)),new this.constructor(t,i,n)},t.expand=function(e){var t,i;return dP(e)?t=i=e:(t=e.width||e.x||e[0]||0,i=e.height||e.y||e[1]||0),new this.constructor(this.xmin-t,this.ymin-i,this.xmax+t,this.ymax+i,this.projection)},t._expand=function(e){var t,i;return dP(e)?t=i=e:(t=e.width||e.x||e[0]||0,i=e.height||e.y||e[1]||0),this.xmin-=t,this.ymin-=i,this.xmax+=t,this.ymax+=i,this._dirty=!0,this},t.toJSON=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},t.toArray=function(e){var t=this.xmin,i=this.ymin,n=this.xmax,r=this.ymax;return e?(e[0].x=t,e[0].y=r,e[1].x=n,e[1].y=r,e[2].x=n,e[2].y=i,e[3].x=t,e[3].y=i,e[4].x=t,e[4].y=r,e):[new this._clazz([t,r]),new this._clazz([n,r]),new this._clazz([n,i]),new this._clazz([t,i]),new this._clazz([t,r])]},t.toString=function(){return this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},t.copy=function(){return new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection)},t.convertTo=function(e,t){if(!this.isValid())return null;var i,n=t||new this.constructor;return t&&n.set(null,null,null,null),this._clazz===vI?i=MI:this._clazz===uM&&(i=wI),i.x=this.xmin,i.y=this.ymax,n._combine(e(i)),i.x=this.xmax,n._combine(e(i)),i.y=this.ymin,n._combine(e(i)),i.x=this.xmin,n._combine(e(i)),n},t._project=function(e){if(e&&e.isValid()){var t=this.projection;if(t){if(e._dirty){kI.set(e.xmax,e.ymin),AI.set(e.xmin,e.ymax),II[0]=kI,II[1]=AI;var i=t.projectCoords(II),n=i[0],r=i[1];e.pxmin=Math.min(n.x,r.x),e.pymin=Math.min(n.y,r.y),e.pxmax=Math.max(n.x,r.x),e.pymax=Math.max(n.y,r.y)}delete e._dirty}else e.pxmin=e.xmin,e.pxmax=e.xmax,e.pymin=e.ymin,e.pymax=e.ymax}else e&&(e.pxmin=e.pxmax=e.pymin=e.pymax=null)},e}();bI=new OI(0,0,0,0);var NI,DI=function(e){function t(t,i,n,r){var s;return(s=e.call(this,t,i,n,r)||this)._clazz=uM,s}return tM(t,e),t}(OI),zI=function(){function e(e){this.matrix=e}var t=e.prototype;return t.transform=function(e,t,i){var n=this.matrix[0]*(e.x-this.matrix[2])/t,r=-this.matrix[1]*(e.y-this.matrix[3])/t;return i?(i.x=n,i.y=r,i):new uM(n,r)},t.untransform=function(e,t,i){var n=e.x*t/this.matrix[0]+this.matrix[2],r=e.y*t/-this.matrix[1]+this.matrix[3];return i?(i.x=n,i.y=r,i):new vI(n,r)},e}(),LI={is:function(e){if(this.code===e)return!0;if(!this.aliases)return!1;for(var t=0;t<this.aliases.length;t++)if(this.aliases[t]===e)return!0;return!1},project:function(){},unproject:function(){},projectCoords:function(e,t){var i=this;if(!e)return[];if(!Array.isArray(e))return this.project(e);if(0===e.length)return[];if(!this.isSphere())return vM(e,this.project,this);if(Array.isArray(e[0]))return e.map((function(e){return i.projectCoords(e,t)}));for(var n,r,s,o,a,l,c=!1!==t,h=this.getCircum(),u=this.getSphereExtent(),d=u.sx,p=u.sy,m=e[0],f=[this.project(m)],g=1,_=e.length;g<_;g++)o=(s=e[g]).x-m.x,a=s.y-m.y,l=this.project(s),Math.abs(o)>180&&c&&(void 0===n&&(n=s.x>m.x),n&&(l._add(-h.x*bM(o)*d,0),s._add(-360*bM(o),0))),Math.abs(a)>90&&c&&(void 0===r&&(r=s.y<m.y),r&&(l._add(0,-h.y*bM(a)*p),s._add(0,-180*bM(a)))),m=s,f.push(l);return f},unprojectCoords:function(e){return e?Array.isArray(e)?vM(e,this.unproject,this):this.unproject(e):[]},isSphere:function(){return!!this.sphere},isOutSphere:function(e){return!!this.isSphere()&&!this.getSphereExtent().contains(e)},wrapCoord:function(e){if(!this.isSphere())return e;var t=this.getSphereExtent(),i=new vI(e);return t.contains(i)||(i.x=CM(e.x,t.xmin,t.xmax),i.y=CM(e.y,t.ymin,t.ymax)),i},getCircum:function(){if(!this.circum&&this.isSphere()){var e=this.getSphereExtent();this.circum={x:e.getWidth(),y:e.getHeight()}}return this.circum},getSphereExtent:function(){if(!this.extent&&this.isSphere()){var e=this.project(new vI(180,90)),t=this.project(new vI(-180,-90));this.extent=new OI(t,e,this),this.extent.sx=e.x>t.x?1:-1,this.extent.sy=e.y>t.y?1:-1}return this.extent}},BI={measureLength:function(e,t){if(!Array.isArray(e))return this.measureLenBetween(e,t);for(var i=0,n=0,r=e.length;n<r-1;n++)i+=this.measureLenBetween(e[n],e[n+1]);return i}},FI=hP({measure:"IDENTITY",measureLenBetween:function(e,t){if(!e||!t)return 0;try{return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}catch(T0){return 0}},measureArea:function(e){if(!Array.isArray(e))return 0;for(var t=0,i=0,n=e.length;i<n;i++){var r,s=e[i];t+=s.x*(r=i===n-1?e[0]:e[i+1]).y-s.y*r.x}return Math.abs(t/2)},locate:function(e,t,i,n){return(n=n||new vI(0,0)).set(e.x,e.y),this._locate(n,t,i)},_locate:function(e,t,i){return e?(t||(t=0),i||(i=0),t||i?(e.x=e.x+t,e.y=e.y+i,e):e):null},rotate:function(e,t,i){return e=new vI(e.x,e.y),this._rotate(e,t,i)},_rotate:(NI=new uM(0,0),function(e,t,i){return NI.x=e.x-t.x,NI.y=e.y-t.y,NI._rotate(i*Math.PI/180),e.x=t.x+NI.x,e.y=t.y+NI.y,e})},BI),jI=function(){function e(e){this.radius=e}var t=e.prototype;return t.measureLenBetween=function(e,t){if(!e||!t)return 0;var i=xP(e.y),n=xP(t.y),r=i-n,s=xP(e.x)-xP(t.x);return(i=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(i)*Math.cos(n)*Math.pow(Math.sin(s/2),2))))*this.radius},t.measureArea=function(e){var t,i=xP(this.radius),n=0,r=e,s=r.length;if(s<3)return 0;for(t=0;t<s-1;t++){var o=r[t],a=r[t+1];n+=o.x*i*Math.cos(xP(o.y))*a.y*i-a.x*i*Math.cos(xP(a.y))*o.y*i}return s=r[t],r=r[0],n+=s.x*i*Math.cos(xP(s.y))*r.y*i-r.x*i*Math.cos(xP(r.y))*s.y*i,.5*Math.abs(n)},t.locate=function(e,t,i,n){return(n=n||new vI(0,0)).set(e.x,e.y),this._locate(n,t,i)},t._locate=function(e,t,i){if(!e)return null;if(t||(t=0),i||(i=0),!t&&!i)return e;var n,r,s=xP(e.y);if(0!==i){var o=Math.abs(i);r=CM(180*(s+=2*Math.sin(o/(2*this.radius))*(i>0?1:-1))/Math.PI,-90,90)}else r=e.y;if(0!==t){var a=Math.abs(t),l=xP(e.x);n=CM(180*(l+=2*Math.sqrt(Math.pow(Math.sin(a/(2*this.radius)),2)/Math.pow(Math.cos(s),2))*(t>0?1:-1))/Math.PI,-180,180)}else n=e.x;return e.x=n,e.y=r,e},t.rotate=function(e,t,i){return e=new vI(e),this._rotate(e,t,i)},t._rotate=function(e,t,i){var n,r,s,o,a=(n=t,r=e,void 0===s&&(s={}),((o=s.final?VI(r,n):VI(n,r))>180?-(360-o):o)-i),l=this.measureLenBetween(t,e);return e.x=t.x,e.y=t.y,function(e,t,i,n){var r=t/n,s=e.x*Math.PI/180,o=xP(e.y),a=xP(i),l=r*Math.cos(a),c=o+l;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var h=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),u=Math.abs(h)>1e-11?l/h:Math.cos(o),d=r*Math.sin(a)/u;return e.x=(180*(s+d)/Math.PI+540)%360-180,e.y=180*c/Math.PI,e}(e,l,a,this.radius)},e}();function VI(e,t){var i=xP(e.y),n=xP(t.y),r=xP(t.x-e.x);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var s=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(i/2+Math.PI/4));return(bP(Math.atan2(r,s))+360)%360}var UI=hP({measure:"EPSG:4326",sphere:new jI(6378137),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},BI),qI=hP({measure:"BAIDU",sphere:new jI(6370996.81),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},BI),HI=UI,GI={};function WI(e){GI[e.measure]=e}WI(FI),WI(UI),WI(qI);var ZI={getInstance:function(e){if(!e)return HI;for(var t in GI)if(yP(GI,t)){var i=GI[t].measure;if(!i)continue;if(e.toLowerCase()===i.toLowerCase())return GI[t]}return null}},$I=hP({},LI,{code:"EPSG:3857",rad:Math.PI/180,metersPerDegree:6378137*Math.PI/180,maxLatitude:85.0511287798,project:function(e,t){var i=this.rad,n=this.metersPerDegree,r=this.maxLatitude,s=e.x,o=Math.max(Math.min(r,e.y),-r),a=s*n,l=(0===o?0:Math.log(Math.tan((90+o)*i/2))/i)*n;return t?(t.x=a,t.y=l,t):new vI(a,l)},unproject:function(e,t){var i,n=this.rad,r=this.metersPerDegree,s=e.x/r,o=e.y;0===o?i=0:(i=o/r,i=(2*Math.atan(Math.exp(i*n))-Math.PI/2)/n),Math.abs(Math.abs(s)-180)<1e-7&&(s=180*bM(s)),Math.abs(Math.abs(i)-this.maxLatitude)<1e-7&&(i=bM(i)*this.maxLatitude);var a=CM(s,-180,180),l=CM(i,-this.maxLatitude,this.maxLatitude);return t?(t.x=a,t.y=l,t):new vI(a,l)}},UI),XI=hP({},LI,{code:"EPSG:4326",aliases:["EPSG:4490"],project:function(e,t){return t?(t.x=e.x,t.y=e.y,t):new vI(e)},unproject:function(e,t){return t?(t.x=e.x,t.y=e.y,t):new vI(e)}},UI),KI=Math.abs,YI=Math.sin,JI=Math.cos,QI=Math.tan,eR=Math.atan,tR=Math.atan2,iR=Math.sqrt,nR=Math.log,rR=Math.hypot,sR=Math.sinh,oR=Math.cosh;Math;var aR=.017453292519943295,lR=["Traverse_Mercator"],cR=hP({},LI,{code:"EPSG:9807",aliases:lR,create:function(e){var t={a:6378137,es:.0066943799901413165,x0:uP(e.falseEasting)?5e5:e.falseEasting,y0:uP(e.falseNorthing)?0:e.falseNorthing,k0:e.scaleFactor||.9996,lam0:(e.centralMeridian||0)*aR,phi0:(e.latitudeOfOrigin||0)*aR,originLam0:e.startLongtitude||0,originPhi0:e.startLatitude||0};!function(e){var t,i,n,r,s,o,a=[],l=[],c=[],h=[];function u(e,t){for(var i,n=2*JI(2*t),r=e.length-1,s=e[r],o=0;--r>=0;)i=n*s-o+e[r],o=s,s=i;return t+i*YI(2*t)}function d(e,t,i){for(var n,r,s=YI(t),o=JI(t),a=sR(i),l=oR(i),c=2*o*l,h=-2*s*a,u=e.length-1,d=e[u],p=0,m=0,f=0;--u>=0;)n=m,r=p,d=c*(m=d)-n-h*(p=f)+e[u],f=h*m-r+c*p;return[(c=s*l)*d-(h=o*a)*f,c*f+h*d]}s=r=(n=e.es/(1+iR(1-e.es)))/(2-n),a[0]=r*(2+r*(-2/3+r*(r*(116/45+r*(26/45+r*(-2854/675)))-2))),l[0]=r*(r*(2/3+r*(4/3+r*(-82/45+r*(32/45+r*(4642/4725)))))-2),a[1]=(s*=r)*(7/3+r*(r*(-227/45+r*(2704/315+r*(2323/945)))-1.6)),l[1]=s*(5/3+r*(-16/15+r*(-13/9+r*(904/315+r*(-1522/945))))),a[2]=(s*=r)*(56/15+r*(-136/35+r*(-1262/105+r*(73814/2835)))),l[2]=s*(-26/15+r*(34/21+r*(1.6+r*(-12686/2835)))),a[3]=(s*=r)*(4279/630+r*(-332/35+r*(-399572/14175))),l[3]=s*(1237/630+r*(r*(-24832/14175)-2.4)),a[4]=(s*=r)*(4174/315+r*(-144838/6237)),l[4]=s*(-734/315+r*(109598/31185)),a[5]=(s*=r)*(601676/22275),l[5]=s*(444337/155925),t=e.k0/(1+r)*(1+(s=r*r)*(1/4+s*(1/64+s/256))),c[0]=r*(r*(2/3+r*(-37/96+r*(1/360+r*(81/512+r*(-96199/604800)))))-.5),h[0]=r*(.5+r*(-2/3+r*(5/16+r*(41/180+r*(-127/288+r*(7891/37800)))))),c[1]=s*(-1/48+r*(-1/15+r*(437/1440+r*(-46/105+r*(1118711/3870720))))),h[1]=s*(13/48+r*(r*(557/1440+r*(281/630+r*(-1983433/1935360)))-.6)),c[2]=(s*=r)*(-17/480+r*(37/840+r*(209/4480+r*(-5569/90720)))),h[2]=s*(61/240+r*(-103/140+r*(15061/26880+r*(167603/181440)))),c[3]=(s*=r)*(-4397/161280+r*(11/504+r*(830251/7257600))),h[3]=s*(49561/161280+r*(-179/168+r*(6601661/7257600))),c[4]=(s*=r)*(-4583/161280+r*(108847/3991680)),h[4]=s*(34729/80640+r*(-3418889/1995840)),c[5]=(s*=r)*(-20648693/638668800),h[5]=.6650675310896665*s,o=u(l,e.phi0),i=-t*(o+function(e,t){for(var i,n=2*JI(t),r=e.length-1,s=e[r],o=0;--r>=0;)i=n*s-o+e[r],o=s,s=i;return YI(t)*i}(h,2*o)),e.fwd=function(e,n){var r,s,o,a,c,p,m,f=e.phi,g=e.lam;f=u(l,f),r=YI(f),s=JI(f),a=YI(g),o=JI(g),f=tR(r,o*s),g=tR(a*s,rR(r,s*o)),p=QI(g),m=function(e){var t=1+e,i=t-1;return 0===i?e:e*nR(t)/i}((m=KI(p))*(1+m/(rR(1,m)+1))),f+=(c=d(h,2*f,2*(g=p<0?-m:m)))[0],KI(g+=c[1])<=2.623395162778?(n.y=t*f+i,n.x=t*g):n.x=n.y=1/0},e.inv=function(e,n){var r,s,o,l,h,p=e.y,m=e.x;p=(p-i)/t,KI(m/=t)<=2.623395162778?(p+=(h=d(c,2*p,2*m))[0],m=eR(sR(m+=h[1])),r=YI(p),s=JI(p),l=YI(m),o=JI(m),m=tR(l,o*s),p=tR(r*o,rR(l,o*s)),n.phi=u(a,p),n.lam=m):n.phi=n.lam=1/0}}(t);var i={lam:0,phi:0},n={},r=0,s=0;return(t.originLam0||t.originPhi0)&&(i.lam=t.originLam0*aR-t.lam0,i.phi=t.originPhi0*aR,t.fwd(i,n),r=t.a*n.x+t.x0,s=t.a*n.y+t.y0),hP({},LI,{code:"EPSG:9807",aliases:lR,centralMeridian:e.centralMeridian,project:function(e,o){i.lam=e.x*aR-t.lam0,i.phi=e.y*aR,t.fwd(i,n);var a=t.a*n.x+t.x0-r,l=t.a*n.y+t.y0-s;return o?(o.x=a,o.y=l,o):new vI(a,l)},unproject:function(e,o){n.x=(e.x-t.x0+r)/t.a,n.y=(e.y-t.y0+s)/t.a,t.inv(n,i);var a=57.29577951308232*(i.lam+t.lam0),l=57.29577951308232*i.phi;return o?(o.x=a,o.y=l,o):new vI(a,l)}},UI)}}),hR=hP({},cR,{code:"utm",aliases:[],create:function(e){var t={},i=parseInt(e.zone);if(t.falseNorthing=e.south?1e7:0,t.falseEasting=5e5,!(i>0&&i<=60))throw new Error("zone must be > 0 and <= 60.");return i--,t.centralMeridian=6*(i+.5)-180,t.scaleFactor=.9996,cR.create(t)}}),uR=hP({},LI,{code:"BAIDU",project:function(e,t){return this.convertLL2MC(e,t)},unproject:function(e,t){return this.convertMC2LL(e,t)}},qI,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],convertMC2LL:function(e,t){for(var i,n=0,r=this.MCBAND.length;n<r;n++)if(Math.abs(e.y)>=this.MCBAND[n]){i=this.MC2LL[n];break}return this.convertor(e,i,t)},convertLL2MC:function(e,t){var i,n,r;e.x=this.getLoop(e.x,-180,180),e.y=this.getRange(e.y,-74,74);var s=new vI(e.x,e.y);for(n=0,r=this.LLBAND.length;n<r;n++)if(s.y>=this.LLBAND[n]){i=this.LL2MC[n];break}if(!i)for(n=this.LLBAND.length-1;n>=0;n--)if(s.y<=-this.LLBAND[n]){i=this.LL2MC[n];break}return this.convertor(e,i,t)},convertor:function(e,t,i){if(!e||!t)return null;var n=t[0]+t[1]*Math.abs(e.x),r=Math.abs(e.y)/t[9],s=t[2]+t[3]*r+t[4]*r*r+t[5]*r*r*r+t[6]*r*r*r*r+t[7]*r*r*r*r*r+t[8]*r*r*r*r*r*r;return n*=e.x<0?-1:1,s*=e.y<0?-1:1,i?(i.x=n,i.y=s,i):new vI(n,s)},toRadians:function(e){return Math.PI*e/180},toDegrees:function(e){return 180*e/Math.PI},getRange:function(e,t,i){return null!=t&&(e=Math.max(e,t)),null!=i&&(e=Math.min(e,i)),e},getLoop:function(e,t,i){if(e===1/0)return i;if(e===-1/0)return t;for(;e>i;)e-=i-t;for(;e<t;)e+=i-t;return e}}),dR=hP({},LI,{code:"IDENTITY",project:function(e,t){return t?(t.x=e.x,t.y=e.y,t):e.copy()},unproject:function(e,t){return t?(t.x=e.x,t.y=e.y,t):e.copy()}},FI),pR=$I,mR=Object.freeze({EPSG3857:$I,DEFAULT:pR,EPSG4326:XI,EPSG9807:cR,UTM:hR,BAIDU:uR,IDENTITY:dR,Common:LI}),fR=function(e){return function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.registerRenderer=function(e,t){var i=this.prototype,n=Object.getPrototypeOf(i);return i._rendererClasses&&i._rendererClasses!==n._rendererClasses||(i._rendererClasses=i._rendererClasses?Object.create(i._rendererClasses):{}),i._rendererClasses[e.toLowerCase()]=t,this},t.getRendererClass=function(e){var t=this.prototype;return t._rendererClasses?t._rendererClasses[e.toLowerCase()]:null},t}(e)},gR=0,_R=[],yR=function(){function e(e){var t=this;zA(),this._delayMessages=[],this.initializing=!1;var i=xA(e);yA&&!i&&(this.initializing=!0,console.log("Injecting codes in worker with worker key: :"+e),function(e,i){if(SA[e]){var n=SA[e];if(gP(n)&&0===n.length&&(n=n()),n="("+n+")",gA){var r=gA.workers||[];0===r.length&&console.error("workerpool workers count is 0");var s=0,o=function i(n){(n=n.data||{}).adapterName===e&&++s===r.length&&(r.forEach((function(e){e.removeEventListener("message",i)})),delete SA[e],t.initializing=!1,t.created())};r.forEach((function(t){t.addEventListener("message",o),t.postMessage({key:e,code:n,messageType:"createAdapter"})}))}}else console.error("not find "+e+" adapter")}(e)),this.workerKey=e,this.workerPool=kA(),this.currentActor=0,this.actorId=fM(),this.workers=this.workerPool.acquire(this.actorId),this.callbacks={},this.callbackID=0,this.receiveFn=this.receive.bind(this),this.workers.forEach((function(e){e.addEventListener("message",t.receiveFn,!1)})),bA(e)}var t=e.prototype;return t.created=function(){var e=this;this._delayMessages.forEach((function(t){e[t.command](t.data,t.buffers,t.cb,t.workerId)})),this._delayMessages=[]},t.isActive=function(){return!!this.workers},t.broadcast=function(e,t,i){var n=this;return this.initializing?(this._delayMessages.push({command:"broadcast",data:e,buffers:t,cb:i}),this):(function(i,r,s){i.length||s(null,[]);var o=i.length,a=new Array(i.length),l=null;i.forEach((function(i,r){n.send(e,t,(function(e,t){e&&(l=e),a[r]=t,0==--o&&s(l,a)}),i.id)}))}(this.workers,0,i=i||function(){}),this)},t.send=function(e,t,i,n){if(this.initializing)return this._delayMessages.push({command:"send",data:e,buffers:t,cb:i,workerId:n}),this;var r=i?this.actorId+":"+this.callbackID++:null;return i&&(this.callbacks[r]=i),this.post({data:e,callback:String(r)},t,n),this},t.receive=function(e){var t=this,i=e.data,n=i.callback,r=this.callbacks[n];delete this.callbacks[n],"<request>"===i.type?this.actorId===i.actorId&&this[i.command](i.params,(function(e,n,r){var s={type:"<response>",callback:i.callback};e?s.error=e.message:s.data=n,t.post(s,r||_R,i.workerId)})):r&&i.error?r(i.error):r&&r(null,i.data)},t.remove=function(){var e=this;this.workers.forEach((function(t){t.removeEventListener("message",e.receiveFn,!1)})),delete this.receiveFn,delete this.workers,delete this.callbacks,delete this.workerPool},t.post=function(e,t,i){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.workerPool.workerCount),e.workerId=i,e.workerKey=this.workerKey,e.actorId=this.actorId,this.workerPool.addMessage(i,e,t||_R),i},t.getDedicatedWorker=function(){return gR=(gR+1)%this.workerPool.workerCount},e}(),vR=[],xR=function(e){function t(){return e.call(this,"core-fetch-image")||this}return tM(t,e),t.prototype.fetchImage=function(e,t){this.send({url:e},vR,t)},t}(yR),bR=function(e){function t(t){var i;return(i=e.call(this)||this).layer=t,i._painted=!1,i._drawTime=0,!QP.decodeImageInWorker||QP.safari||QP.iosWeixin||(i._resWorkerConn=new xR),i.setToRedraw(),i}tM(t,e);var i=t.prototype;return i.render=function(e){this.prepareRender(),this.getMap()&&this.layer.isVisible()&&(this.resources||(this.resources=new wR),this.checkAndDraw(this._tryToDraw,e),this._frameTime=e)},i.getFrameTimestamp=function(){return this._frameTime||0},i.checkAndDraw=function(e){var t=this;this._toRedraw=!1;for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];if(this.checkResources){var s=this.checkResources();s.length>0?(this._loadingResource=!0,this.loadResources(s).then((function(){if(t._loadingResource=!1,t.layer){t.layer.fire("resourceload");var e=t.layer.getMap();t.setToRedraw(),e.getRenderer().callInNextFrame((function(){t.setToRedraw()}))}}))):e.call.apply(e,[this].concat(n))}else e.call.apply(e,[this].concat(n))},i.testIfNeedRedraw=function(){var e=this.getMap();return!(this._loadingResource||!this._toRedraw&&(e.isInteracting()&&!this.drawOnInteracting||!this.needToRedraw()))},i.needToRedraw=function(){var e=this.getMap();return!(!e.isInteracting()&&!e.getRenderer().isViewChanged()||!e.getPitch()&&e.isMoving()&&!e.isZooming()&&!e.isRotating()&&!this.layer.options.forceRenderOnMoving)},i.onSkipDrawOnInteracting=function(){},i.isLoadingResource=function(){return this._loadingResource},i.isRenderComplete=function(){return!!this._renderComplete},i.mustRenderOnInteracting=function(){return!this._painted},i.setToRedraw=function(){return this._toRedraw=!0,this},i.setCanvasUpdated=function(){return this._canvasUpdated=!0,this},i.isCanvasUpdated=function(){return!!this._canvasUpdated},i.remove=function(){this.onRemove(),delete this._loadingResource,delete this.southWest,delete this.canvas,delete this.context,delete this.canvasExtent2D,delete this._extent2D,this.resources&&this.resources.remove(),delete this.resources,this._resWorkerConn&&(this._resWorkerConn.remove(),delete this._resWorkerConn),delete this.layer},i.onRemove=function(){},i.onAdd=function(){},i.getMap=function(){return this.layer?this.layer.getMap():null},i.getCanvasImage=function(){var e=this.getMap();if(this._canvasUpdated=!1,this._renderZoom!==e.getZoom()||!this.canvas||!this._extent2D)return null;if(this.isBlank())return null;if(this.layer.isEmpty&&this.layer.isEmpty())return null;var t=e._pointToContainerPoint(this.southWest)._add(0,-e.height);return{image:this.canvas,layer:this.layer,point:t}},i.clear=function(){this.clearCanvas()},i.isBlank=function(){return!this._painted},i.show=function(){this.setToRedraw()},i.hide=function(){this.clear(),this.setToRedraw()},i.setZIndex=function(){this.setToRedraw()},i.hitDetect=function(e){if(!this.context||this.layer.isEmpty&&this.layer.isEmpty()||this.isBlank()||this._errorThrown||this.layer.isVisible&&!this.layer.isVisible())return!1;var t=this.getMap(),i=t.getDevicePixelRatio(),n=t.getSize();if(e.x<0||e.x>n.width*i||e.y<0||e.y>n.height*i)return!1;var r=this.getImageData&&this.getImageData();if(r){var s=Math.round(i*e.x),o=Math.round(i*e.y);return r.data[o*r.width*4+4*s+3]>0}try{if(this.context.getImageData(i*e.x,i*e.y,1,1).data[3]>0)return!0}catch(a){return this._errorThrown||(console&&console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",a),this._errorThrown=!0),!1}return!1},i.loadResources=function(e){this.resources||(this.resources=new wR);var t=this.resources,i=[];if(EM(e))for(var n={},r=e.length-1;r>=0;r--){var s=e[r];s&&s.length&&!n[s.join("-")]&&(n[s.join("-")]=1,t.isResourceLoaded(s,!0)||i.push(new _A(this._promiseResource(s))))}return _A.all(i)},i.prepareRender=function(){delete this._renderComplete;var e=this.getMap();this._renderZoom=e.getZoom(),this.canvasExtent2D=this._extent2D=e._get2DExtent(),this.southWest=e._containerPointToPoint(new uM(0,e.height))},i.createCanvas=function(){if(!this.canvas){var e=this.getMap(),t=e.getSize(),i=e.getDevicePixelRatio(),n=Math.round(i*t.width),r=Math.round(i*t.height);if(this.layer._canvas){var s=this.layer._canvas;s.width=n,s.height=r,s.style&&(s.style.width=t.width+"px",s.style.height=t.height+"px"),this.canvas=this.layer._canvas}else this.canvas=YA.createCanvas(n,r,e.CanvasClass);this.onCanvasCreate()}},i.onCanvasCreate=function(){},i.createContext=function(){if(!(this.gl&&this.gl.canvas===this.canvas||this.context)&&(this.context=YA.getCanvas2DContext(this.canvas),this.context)){this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation);var e=this.getMap().getDevicePixelRatio();1!==e&&this.context.scale(e,e)}},i.resetCanvasTransform=function(){if(this.context){var e=this.getMap().getDevicePixelRatio();this.context.setTransform(e,0,0,e,0,0)}},i.resizeCanvas=function(e){var t=this.canvas;if(t){var i=e||this.getMap().getSize(),n=this.getMap().getDevicePixelRatio(),r=FM(i,n),s=r.width,o=r.height,a=r.cssWidth,l=r.cssHeight;!this.layer._canvas||t.style.width===a&&t.style.height===l||(t.style.width=a,t.style.height=l),t.width===s&&t.height===o||(t.height=o,t.width=s,1!==n&&this.context&&this.context.scale(n,n))}},i.clearCanvas=function(){if(this.context&&this.getMap()){var e=1/this.getMap().getDevicePixelRatio(),t=this.canvas.height*e;YA.clearRect(this.context,0,0,Math.max(this.canvas.width*e,this.canvas.width),Math.max(t,this.canvas.height))}},i.prepareCanvas=function(){this.canvas?(this.resetCanvasTransform(),this.clearCanvas(),this.resizeCanvas()):(this.createCanvas(),this.createContext(),this.layer.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})),delete this._maskExtent;var e=this.layer.getMask();if(!e)return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),null;var t=this._maskExtent=e._getMaskPainter().get2DExtent();return t.intersects(this._extent2D),this.layer.fire("renderstart",{context:this.context,gl:this.gl}),t},i.clipCanvas=function(e){var t=this.layer.getMask();if(!t)return!1;var i=this.southWest,n=this.getMap();this.southWest=n._containerPointToPoint(new uM(0,n.height)),e.save();var r=n.getDevicePixelRatio();if(1!==r&&(e.save(),e.scale(r,r)),t.getGeometries){e.isMultiClip=!0;var s=t.getGeometries()||[];e.beginPath(),s.forEach((function(t){t._getMaskPainter().paint(null,e)})),e.stroke(),e.isMultiClip=!1}else e.isClip=!0,e.beginPath(),t._getMaskPainter().paint(null,e),e.isClip=!1;return 1!==r&&e.restore(),e.clip(),this.southWest=i,!0},i.getViewExtent=function(){return{extent:this._extent2D,maskExtent:this._maskExtent,zoom:this._renderZoom,southWest:this.southWest}},i.completeRender=function(){this.getMap()&&(this._renderComplete=!0,this.layer.fire("renderend",{context:this.context,gl:this.gl}),this.setCanvasUpdated())},i.getEvents=function(){return{_zoomstart:this.onZoomStart,_zooming:this.onZooming,_zoomend:this.onZoomEnd,_resize:this.onResize,_movestart:this.onMoveStart,_moving:this.onMoving,_moveend:this.onMoveEnd,_dragrotatestart:this.onDragRotateStart,_dragrotating:this.onDragRotating,_dragrotateend:this.onDragRotateEnd,_spatialreferencechange:this.onSpatialReferenceChange}},i.onZoomStart=function(){},i.onZoomEnd=function(){this.setToRedraw()},i.onZooming=function(){},i.onMoveStart=function(){},i.onMoving=function(){},i.onMoveEnd=function(){this.setToRedraw()},i.onResize=function(){delete this._extent2D,this.resizeCanvas(),this.setToRedraw()},i.onDragRotateStart=function(){},i.onDragRotating=function(){},i.onDragRotateEnd=function(){this.setToRedraw()},i.onSpatialReferenceChange=function(){},i.getDrawTime=function(){return this._drawTime},i._tryToDraw=function(e){this._toRedraw=!1,!this.canvas&&this.layer.isEmpty&&this.layer.isEmpty()?this._renderComplete=!0:this._drawAndRecord(e)},i._drawAndRecord=function(e){if(this.getMap()){var t=this._painted;this._painted=!0;var i=cP();this.draw(e),i=cP()-i,this._drawTime=t?i:i/2,t&&this.layer&&this.layer.options.logDrawTime&&console.log(this.layer.getId(),"frameTimeStamp:",e,"drawTime:",this._drawTime)}},i._promiseResource=function(e){var t=this.layer,i=this,n=this.resources,r=t.options.crossOrigin,s=t.options.renderer||"";return function(o){if(n.isResourceLoaded(e,!0))o(e);else if(dM(e[0])||!i._resWorkerConn||"canvas"===t.options.renderer&&!t.options.decodeImageInWorker){var a=new Image;uP(r)?"canvas"!==s&&(a.crossOrigin=""):a.crossOrigin=r,dM(e[0])&&!wP&&(e[1]&&(e[1]*=2),e[2]&&(e[2]*=2)),a.onload=function(){i._cacheResource(e,a),o(e)},a.onabort=function(t){console&&console.warn("image loading aborted: "+e[0]),t&&console&&console.warn(t),o(e)},a.onerror=function(t){t&&"undefined"!=typeof console&&console.warn(t),n.markErrorResource(e),o(e)},pM(a,e)}else{var l=zM(e[0]);i._resWorkerConn.fetchImage(l,(function(t,n){if(t)return t&&"undefined"!=typeof console&&console.warn(t),void o(e);DM(n,(function(t){i._cacheResource(e,t),o(e)}))}))}}},i._cacheResource=function(e,t){if(this.layer&&this.resources){var i=e[1],n=e[2];if(this.layer.options.cacheSvgOnCanvas&&1===dM(e[0])&&(QP.edge||QP.ie)){uP(i)&&(i=t.width||this.layer.options.defaultIconSize[0]),uP(n)&&(n=t.height||this.layer.options.defaultIconSize[1]);var r=YA.createCanvas(i,n);YA.image(r.getContext("2d"),t,0,0,i,n),t=r}this.resources.addResource(e,t)}},t}(sI),wR=function(){function e(){this.resources={},this._errors={}}var t=e.prototype;return t.addResource=function(e,t){var i=this;if(this.resources[e[0]]={image:t,width:+e[1],height:+e[2],refCnt:0},t&&t.width&&t.height&&!t.close&&QP.imageBitMap&&!QP.safari&&!QP.iosWeixin){if(t.src&&dM(t.src))return;createImageBitmap(t).then((function(t){i.resources[e[0]]&&(i.resources[e[0]].image=t)}))}},t.isResourceLoaded=function(e,t){if(!e)return!1;var i=this._getImgUrl(e);if(this._errors[i])return!0;var n=this.resources[i];return!(!n||t&&dM(e[0])&&(+e[1]>n.width||+e[2]>n.height))},t.login=function(e){var t=this.resources[e];t&&t.refCnt++},t.logout=function(e){var t=this.resources[e];t&&t.refCnt--<=0&&(t.image&&t.image.close&&t.image.close(),delete this.resources[e])},t.getImage=function(e){var t=this._getImgUrl(e);return!this.isResourceLoaded(e)||this._errors[t]?null:this.resources[t].image},t.markErrorResource=function(e){this._errors[this._getImgUrl(e)]=1},t.merge=function(e){if(!e)return this;for(var t in e.resources){var i=e.resources[t];this.addResource([t,i.width,i.height],i.image)}return this},t.forEach=function(e){if(!this.resources)return this;for(var t in this.resources)yP(this.resources,t)&&e(t,this.resources[t]);return this},t._getImgUrl=function(e){return Array.isArray(e)?e[0]:e},t.remove=function(){for(var e in this.resources){var t=this.resources[e];t&&t.image&&t.image.close&&t.image.close()}this.resources={}},e}();QP.decodeImageInWorker&&(SA["core-fetch-image"]=function(){return"\nfunction (exports) {\n    exports.onmessage = function (msg, postResponse) {\n        var url = msg.data.url;\n        var fetchOptions = msg.data.fetchOptions;\n        requestImageOffscreen(url, function (err, data) {\n            var buffers = [];\n            if (data && data.data) {\n                buffers.push(data.data);\n            }\n            postResponse(err, data, buffers);\n        }, fetchOptions);\n    };\n\n    function requestImageOffscreen(url, cb, fetchOptions) {\n        fetch(url, fetchOptions ? fetchOptions : {})\n            .then(response => response.arrayBuffer())\n            .then(arrayBuffer => {\n                const blob=new Blob([arrayBuffer]);\n                return createImageBitmap(blob);\n            })\n            .then(bitmap => {\n                cb(null, {data:bitmap});\n            }).catch(err => {\n                console.warn('error when loading tile:', url);\n                console.warn(err);\n                cb(err);\n            });\n    }\n}"});var CR=new uM(0,0);function SR(e,t,i,n,r,s){var o=r.x+s.x,a=r.y+s.y;CR.x=o,CR.y=a;var l=function(e){if(!e)return 0;var t=e.x,i=e.y;if(0===t&&0===i)return 0;if(0===t||!t){if(i<0)return-Math.PI/2;if(i>0)return Math.PI/2}var n=i/t;return i<0&&t<0?Math.atan(n)-Math.PI:i>0&&t<0?Math.atan(n)+Math.PI:Math.atan(n)}(CR),c=Math.sqrt(o*o+a*a),h=0,u=0;h+=Math.cos(t+l)*c,u+=Math.sin(t+l)*c;var d=function(e,t,i){var n=Math.PI/2+i,r=Math.PI/4+i,s=i,o=t,a=Math.sqrt(e*e+t*t),l=e,c=Math.cos(n)*o,h=Math.sin(n)*o,u=Math.cos(r)*a,d=Math.sin(r)*a,p=Math.cos(s)*l,m=Math.sin(s)*l,f=Math.min(c,u,p,0),g=Math.min(h,d,m,0);return[f,g,Math.max(c,u,p,0)-f,Math.max(h,d,m,0)-g]}(i,n,t),p=d[3];u+=d[1];var m=(h+=d[0])+Math.max(i,d[2]),f=u+Math.max(n,p);return e.set(h,u,m,f),e}var ER=new uM(0,0);function TR(e,t,i,n,r,s,o){var a=ER.set(t,i);if(n)return SR(e,n,s,o,a,r);var l,c,h=e.set(a.x,a.y,a.x+s,a.y+o);return h._add(r),n&&(c=n,NR.set((l=h).xmin,l.ymin,l.xmax,l.ymax),NR.convertTo((function(e){return e._rotate(c)}),l)),h}var PR=[];function MR(e,t,i){if((i=i||OR(PR,t))&&(0===i[0]||0===i[1]))return ZR(e),e;var n=RR(t,i[0],i[1]);return TR(e,t.markerDx||0,t.markerDy||0,DR(t),n,i[0],i[1])}function kR(e){return"rectangle"===e?"right":"middle"}function AR(e){return"bar"===e||"pie"===e||"pin"===e?"top":"rectangle"===e?"bottom":"middle"}var IR=new wk(0,0);function RR(e,t,i){var n=2*(e.shadowBlur||0)+.5;IR.width=t,IR.height=i;var r=e.markerType,s=Ok(IR,e.markerHorizontalAlignment||kR(r),e.markerVerticalAlignment||AR(r));return s.x!==-t/2&&(s.x-=bM(s.x+t/2)*n),s.y!==-i/2&&(s.y-=bM(s.y+i/2)*n),s}function OR(e,t){var i=xM(t.markerWidth,10),n=xM(t.markerHeight,10);if(0===i||0===n)return e[0]=0,e[1]=0,e;var r=xM(t.markerLineWidth,1),s=2*((t.shadowBlur||0)+Math.max(Math.abs(t.shadowOffsetX||0)+Math.abs(t.shadowOffsetY||0))),o=Math.round(i+r+s+1),a=Math.round(n+r+s+1);return e[0]=o,e[1]=a,e}var NR=new DI;function DR(e,t){void 0===t&&(t="markerRotation");var i=e[t];return dP(i)?-i*Math.PI/180:0}function zR(e,t,i){var n=i?i.getImage(t.markerFile):null,r=t.markerWidth||(n?n.width:0),s=t.markerHeight||(n?n.height:0);if(IR.width=r,IR.height=s,0===t.markerWidth||0===t.markerHeight)return ZR(e),e;var o=Ok(IR,t.markerHorizontalAlignment||"middle",t.markerVerticalAlignment||"top");return TR(e,t.markerDx||0,t.markerDy||0,DR(t),o,r,s)}function LR(e,t,i){var n=i.size;if(n&&(0===n.width||0===n.height))return ZR(e),e;var r=Ok(n,t.textHorizontalAlignment,t.textVerticalAlignment),s=t.textHaloRadius||0,o=TR(e,t.textDx||0,t.textDy||0,DR(t,"textRotation"),r,n.width,n.height);return o.xmin-=s,o.xmax+=s,o.ymin-=s,o.ymax+=s,o}var BR=new DI;function FR(e,t,i,n){var r=e||new DI;if(Array.isArray(t)){for(var s=t,o=0;o<s.length;o++)FR(r,s[o],i,n[o]);return r}return jR(t)&&r._combine(LR(BR,t,n)),VR(t)&&r._combine(zR(BR,t,i)),UR(t)&&r._combine(MR(BR,t)),qR(t)&&r._combine(zR(BR,t)),r}function jR(e){return!!e&&!uP(e.textName)}function VR(e){return!!e&&!uP(e.markerFile)}function UR(e){return!!e&&!(!uP(e.markerFile)||uP(e.markerType)||"path"===e.markerType)}function qR(e){return!!e&&!(!uP(e.markerFile)||"path"!==e.markerType)}var HR,GR=["markerWidth","markerHeight","markerHorizontalAlignment","markerVerticalAlignment","markerDx","markerDy","markerRotation","textName","textSize","textDx","textDy","textVerticalAlignment","textHorizontalAlignment","textRotation","textWrapWidth"],WR=["textName","markerType","markerFile","textHaloRadius","shadowBlur","shadowOffsetX","shadowOffsetY","textWrapWidth"];function ZR(e){e&&(e.xmin=1/0,e.ymin=1/0,e.xmax=-1/0,e.ymax=-1/0)}function $R(e,t,i,n){for(var r,s=[],o=0,a=0,l=e.length;a<l-1;a++)(r=XR(e[a],e[a+1],t,a,i,n))&&(s[o]=s[o]||[],s[o].push({point:r[0],index:a}),r[1]===e[a+1]&&a!==l-2||(s[o].push({point:r[1],index:a+1}),o++));return s}function XR(e,t,i,n,r,s){var o,a,l,c=n?HR:JR(e,i),h=JR(t,i);for(HR=h;;){if(!(c|h))return[e,t];if(c&h)return!1;if(s)return[e,t];l=JR(a=YR(e,t,o=c||h,i,r),i),o===c?(e=a,c=l):(t=a,h=l)}}function KR(e,t,i){var n,r,s,o,a,l,c,h,u,d=[1,4,2,8];for(r=0,c=e.length;r<c;r++)e[r]._code=JR(e[r],t);for(o=0;o<4;o++){for(h=d[o],n=[],r=0,s=(c=e.length)-1;r<c;s=r++)l=e[s],(a=e[r])._code&h?l._code&h||((u=YR(l,a,h,t,i))._code=JR(u,t),n.push(u)):(l._code&h&&((u=YR(l,a,h,t,i))._code=JR(u,t),n.push(u)),n.push(a));e=n}return e}function YR(e,t,i,n,r){var s,o,a=t.x-e.x,l=t.y-e.y,c=n.getMin(),h=n.getMax();8&i?(s=e.x+a*(h.y-e.y)/l,o=h.y):4&i?(s=e.x+a*(c.y-e.y)/l,o=c.y):2&i?(s=h.x,o=e.y+l*(h.x-e.x)/a):1&i&&(s=c.x,o=e.y+l*(c.x-e.x)/a);var u=new uM(s,o);return r&&u._round(),u}function JR(e,t){var i=0;return e.x<t.getMin().x?i|=1:e.x>t.getMax().x&&(i|=2),e.y<t.getMin().y?i|=4:e.y>t.getMax().y&&(i|=8),i}function QR(e,t,i,n){e=new uM(e);var r,s,o,a=Math.abs(i.x-t.x),l=Math.abs(i.y-t.y),c=Math.sqrt(Math.abs(a*a-l*l));return a>=l?(r=new uM(t.x-c,t.y),s=new uM(t.x+c,t.y),o=2*a):(r=new uM(t.x,t.y-c),s=new uM(t.x,t.y+c),o=2*l),e.distanceTo(r)+e.distanceTo(s)<=o+2*n}var eO=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i._prepareContext=function(e){if(YM(this.symbol.opacity)?this._opacityFn||(this._opacityFn=QM(this.symbol.opacity)):delete this._opacityFn,dP(this.symbol.opacity))e.globalAlpha!==this.symbol.opacity&&(e.globalAlpha=this.symbol.opacity);else if(this._opacityFn){var t=this.getMap();e.globalAlpha=this._opacityFn(t.getZoom())}else 1!==e.globalAlpha&&(e.globalAlpha=1)},i.prepareCanvas=function(e,t,i){e.setLineDash&&EM(t.lineDasharray)&&e.setLineDash(t.lineDasharray);var n=this.getPainter().isHitTesting();YA.prepareCanvas(e,t,i,n)},i.remove=function(){},i.setZIndex=function(){},i.show=function(){},i.hide=function(){},i._defineStyle=function(e){return _k(e,this.geometry)},t}(function(){function e(){this.bbox=[1/0,1/0,-1/0,-1/0]}var t=e.prototype;return t._setBBOX=function(e,t,i,n,r){return e.isHitTesting||WA(this.bbox,t,i,n,r),this},t._bufferBBOX=function(e,t){return void 0===t&&(t=0),e.isHitTesting||function(e,t){void 0===t&&(t=0),e[0]-=t,e[1]-=t,e[2]+=t,e[3]+=t}(this.bbox,t),this},t.getMap=function(){return this.geometry.getMap()},t.getPainter=function(){return this.painter},t.isDynamicSize=function(){return!1},e.testColor=function(e){return!(!e||!fP(e))&&lP.indexOf(e)>=0},e}());function tO(e,t,i,n){var r,s=iO(i),o=i,a=o.markerType.toLowerCase(),l=nO(a,o.markerWidth,o.markerHeight),c=s.lineOpacity,h=s.polygonOpacity;Lk(s.polygonFill)&&Lk(s.polygonFill)&&(r||(r=function(e,t,i){var n=new DI;return n._combine(e),n.xmin+=-t/2,n.ymin+=-i/2,n.xmax+=t/2,n.ymax+=i/2,n}(t,o.markerWidth,o.markerHeight)),s.polygonGradientExtent=r),YA.prepareCanvas(e,s,n);var u=o.markerWidth,d=o.markerHeight,p=o.markerLineWidth/2;if("ellipse"===a)YA.ellipse(e,t,u/2,d/2,d/2,c,h);else if("cross"===a||"x"===a){for(var m=l.length-1;m>=0;m--)l[m]._add(t);YA.path(e,l.slice(0,2),c),YA.path(e,l.slice(2,4),c)}else if("diamond"===a||"bar"===a||"square"===a||"rectangle"===a||"triangle"===a){"bar"===a?t=t.add(0,-p):"rectangle"===a&&(t=t.add(p,p));for(var f=l.length-1;f>=0;f--)l[f]._add(t);YA.polygon(e,l,c,h)}else if("pin"===a){t=t.add(0,-p);for(var g=l.length-1;g>=0;g--)l[g]._add(t);var _=e.lineCap;e.lineCap="round",YA.bezierCurveAndFill(e,l,c,h),e.lineCap=_}else{if("pie"!==a)throw new Error("unsupported markerType: "+a);t=t.add(0,-p);var y=180*Math.atan(u/2/d)/Math.PI,v=e.lineCap;e.lineCap="round",YA.sector(e,t,d,[90-y,90+y],c,h),e.lineCap=v}return e.canvas}function iO(e){var t={lineColor:e.markerLineColor,linePatternFile:e.markerLinePatternFile,lineWidth:e.markerLineWidth,lineOpacity:e.markerLineOpacity,lineDasharray:e.markerLineDasharray,lineCap:"butt",lineJoin:"round",polygonFill:e.markerFill,polygonPatternFile:e.markerFillPatternFile,polygonOpacity:e.markerFillOpacity};return 0===t.lineWidth&&(t.lineOpacity=0),t}function nO(e,t,i){var n,r,s,o,a=i/2,l=t/2;if("triangle"===e)return[n=new uM(0,0-a),r=new uM(0-l,0+a),s=new uM(0+l,0+a)];if("cross"===e)return[n=new uM(0-l,0),r=new uM(0+l,0),s=new uM(0,0-a),o=new uM(0,0+a)];if("diamond"===e)return[n=new uM(0-l,0),r=new uM(0,0-a),s=new uM(0+l,0),o=new uM(0,0+a)];if("square"===e)return[n=new uM(0-l,0+a),r=new uM(0+l,0+a),s=new uM(0+l,0-a),o=new uM(0-l,0-a)];if("rectangle"===e)return r=(n=new uM(0,0)).add(t,0),s=n.add(t,i),o=n.add(0,i),[n,r,s,o];if("x"===e)return[n=new uM(0-l,0+a),r=new uM(0+l,0-a),s=new uM(0+l,0+a),o=new uM(0-l,0-a)];if("bar"===e)return[n=new uM(0-l,0-i),r=new uM(0+l,0-i),s=new uM(0+l,0),o=new uM(0-l,0)];if("pin"===e||"pie"===e){var c=i*Math.atan(l/a);return[n=new uM(0,0),r=new uM(0-c,0-i),s=new uM(0+c,0-i),o=new uM(0,0)]}return[]}var rO,sO=new uM(0,0),oO=new uM(0,0),aO=new uM(0,0),lO=new uM(0,0),cO=function(e){function t(t,i,n){var r;return(r=e.call(this)||this).symbol=t,r.geometry=i,r.painter=n,r}tM(t,e);var i=t.prototype;return i.get2DExtent=function(){for(var e=this.getMap(),t=e.getGLRes(),i=new DI,n=this._getRenderPoints()[0],r=n.length-1;r>=0;r--)n[r]&&i._combine(e._pointAtResToPoint(n[r],t));return i},i.isDynamicSize=function(){var e=this.symbol;return YM(e.markerWidth)||YM(e.markerHeight)||YM(e.textSize)},i._rotateExtent=function(e,t){return e.convertTo((function(e){return e._rotate(t)}))},i._getRenderPoints=function(){var e=this.getPainter().isSpriting()?"center":this.getPlacement();return this.getPainter().getRenderPoints(e)},i._getRenderContainerPoints=function(e){var t=this.getPainter();if(t.isSpriting())return this._getRenderPoints()[0];var i,n=this.geometry,r=this.getDxDy();if(n._cPoint&&!e){var s=e?aO:lO;s.set(n._cPoint.x,n._cPoint.y),s._sub(t.containerOffset);var o=r.x,a=r.y;(o||a)&&s._add(o||0,a||0),i=[s]}else{var l=this._getRenderPoints()[0];i=this.painter._pointContainerPoints(l,r.x,r.y,e,!0,this.getPlacement())}if(!i||!Array.isArray(i[0]))return i;for(var c=[],h=0,u=i.length;h<u;h++)for(var d=0,p=i[h].length;d<p;d++)c.push(i[h][d]);return c},i.getPlacement=function(){return this.symbol.markerPlacement},i.getRotation=function(){return DR(this.style)},i.getDxDy=function(){var e=this.style;return new uM(e.markerDx,e.markerDy)},i._getRotationAt=function(e){var t=this.getRotation();t||(t=0);var i=this._getRenderPoints()[1];if(!i||!i[e])return t;var n=this.getMap(),r=i[e][0],s=i[e][1];if(n.isTransforming()){var o=n.getGLRes();return r=n._pointAtResToContainerPoint(i[e][0],o,0,sO),s=n._pointAtResToContainerPoint(i[e][1],o,0,oO),t+kM(r.x,r.y,s.x,s.y)}return t+-kM(r.x,r.y,s.x,s.y)},i._rotate=function(e,t,i){if(i){var n=this.getDxDy(),r=t.sub(n);return e.save(),e.translate(r.x,r.y),e.rotate(i),n}return null},t}(eO),hO=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.getPlacement=function(){return"point"},i.getDxDy=function(){return new uM(0,0)},i.symbolize=function(e){var t=this.geometry,i=t.getLayer();if(t.options.debug||!i||i.options.debug){var n=this.getMap();if(n&&!n.isZooming()){var r=i.options.debugOutline;e.strokeStyle=r,e.fillStyle=r,e.lineWidth=1,e.font="18px  serif";var s=t.getContainerExtent().toArray();YA.polygon(e,[s],1,0);for(var o=this._getRenderContainerPoints(),a=this.geometry.getId(),l=nO("cross",10,10),c=0;c<o.length;c++){var h=o[c];uP(a)||YA.fillText(e,a,h.add(8,-4),r);for(var u=[],d=0;d<l.length;d++)u.push(l[d].add(h));YA.path(e,u.slice(0,2),1),YA.path(e,u.slice(2,4),1)}}}},t}(cO),uO=new wk(1,1),dO=new DI,pO=function(e){function t(t,i,n){var r;return(r=e.call(this,t,i,n)||this).style=r._defineStyle(r.translate()),r}tM(t,e),t.test=function(e){return VR(e)};var i=t.prototype;return i.symbolize=function(e,t){var i=this.style;if(this.painter.isHitTesting()||0!==i.markerWidth&&0!==i.markerHeight&&0!==i.markerOpacity){var n=this._getRenderContainerPoints();if(EM(n)){var r=this._getImage(t);if(r){this._prepareContext(e);var s,o=i.markerWidth,a=i.markerHeight;if(!dP(o)||!dP(a)){a=r.height,i.markerWidth=o=r.width,i.markerHeight=a;var l=i.markerFile;t.isResourceLoaded(l)||t.addResource(l,r);var c=this.getPainter();c.isSpriting()||c.removeCache()}"path"!==this.symbol.markerType&&dP(i.markerOpacity)&&i.markerOpacity<1&&(s=e.globalAlpha,e.globalAlpha*=i.markerOpacity),uO.width=o,uO.height=a;for(var h=Ok(uO,i.markerHorizontalAlignment,i.markerVerticalAlignment),u=0,d=n.length;u<d;u++){var p=n[u],m=this.getRotation()?this._rotate(e,p,this._getRotationAt(u)):null,f=void 0;if(m){var g=p.sub(m);p=m;var _=this._getRotationAt(u);(f=SR(dO,_,o,a,p,h))._add(g)}var y=p.x+h.x,v=p.y+h.y;YA.image(e,r,y,v,o,a),m&&e.restore(),m?this._setBBOX(e,f.xmin,f.ymin,f.xmax,f.ymax):this._setBBOX(e,y,v,y+o,v+a)}void 0!==s&&(e.globalAlpha=s)}else"undefined"!=typeof console&&console.warn("no img found for "+(this.style.markerFile||this._url[0]))}}},i._getImage=function(e){return function(e,t){return e&&e.getImage(t)||null}(e,this.style.markerFile)},i.getFixedExtent=function(e){return this._fixedExtent=this._fixedExtent||new DI,zR(this._fixedExtent,this.style,e)},i.translate=function(){var e=this.symbol;return{markerFile:e.markerFile,markerOpacity:xM(e.markerOpacity,1),markerWidth:xM(e.markerWidth,null),markerHeight:xM(e.markerHeight,null),markerRotation:xM(e.markerRotation,0),markerDx:xM(e.markerDx,0),markerDy:xM(e.markerDy,0),markerHorizontalAlignment:xM(e.markerHorizontalAlignment,"middle"),markerVerticalAlignment:xM(e.markerVerticalAlignment,"top")}},t}(cO),mO=new vI(0,0),fO=new vI(0,0),gO=function(e){function t(t,i,n){var r;return(r=e.call(this)||this).symbol=t,r.geometry=i,r.painter=n,i.isPoint?aM(r):(r.style=r._defineStyle(r.translate()),r)}tM(t,e),t.test=function(e,t){if(!e)return!1;if(t&&t.isPoint)return!1;for(var i in e){var n=i.slice(0,4);if("line"===n||"poly"===n)return!0}return!1};var i=t.prototype;return i.symbolize=function(e,t){var i=this.style;if(0!==i.polygonOpacity||0!==i.lineOpacity||this.painter.isHitTesting()){var n=this._getPaintParams();if(n){this._prepareContext(e);var r=Lk(i.lineColor),s="Polygon"===this.geometry.getJSONType()||"LineString"===this.geometry.type;!r||!i.lineColor.places&&s||(i.lineGradientExtent=this.geometry.getContainerExtent()._expand(i.lineWidth)),Lk(i.polygonFill)&&(i.polygonGradientExtent=this.geometry.getContainerExtent());var o=this.geometry.getLayer().options.geometryEventTolerance||0,a=this.geometry._hitTestTolerance()+o,l=n[0];if("Polygon"===this.geometry.getJSONType()&&l.length>0&&Array.isArray(l[0][0])||"LineString"===this.geometry.type&&l.length>0&&Array.isArray(l[0]))for(var c=0;c<l.length;c++){this.prepareCanvas(e,i,t),r&&s&&!i.lineColor.places&&this._createGradient(e,l[c],i.lineColor);var h=[e,l[c]];n.length>1&&h.push.apply(h,n.slice(1)),h.push(i.lineOpacity,i.polygonOpacity,i.lineDasharray);var u=this.geometry._paintOn.apply(this.geometry,h);this._setBBOX(e,u),this._bufferBBOX(e,a)}else{this.prepareCanvas(e,i,t),r&&s&&!i.lineColor.places&&this._createGradient(e,l,i.lineColor);var d=[e];d.push.apply(d,n),d.push(i.lineOpacity,i.polygonOpacity,i.lineDasharray);var p=this.geometry._paintOn.apply(this.geometry,d);this._setBBOX(e,p),this._bufferBBOX(e,a)}e.setLineDash&&Array.isArray(i.lineDasharray)&&e.setLineDash([])}}},i.get2DExtent=function(){var e=this.getMap(),t=this.geometry._getPrjExtent();if(!t)return null;this._extMin&&this._extMax||(this._extMin=new vI(0,0),this._extMax=new vI(0,0)),this._extMin.x=t.xmin,this._extMin.y=t.ymin,this._extMax.x=t.xmax,this._extMax.y=t.ymax;var i=e._prjToPoint(this._extMin,void 0,mO),n=e._prjToPoint(this._extMax,void 0,fO);return this._pxExtent?this._pxExtent.set(Math.min(i.x,n.x),Math.min(i.y,n.y),Math.max(i.x,n.x),Math.max(i.y,n.y)):this._pxExtent=new DI(i,n),this._pxExtent},i.getFixedExtent=function(){var e=this.style.lineWidth/2;return new DI(-e,-e,e,e)},i._getPaintParams=function(){return this.getPainter().getPaintParams(this.style.lineDx,this.style.lineDy)},i.translate=function(){var e=this.symbol,t={lineColor:xM(e.lineColor,"#000"),lineWidth:xM(e.lineWidth,2),lineOpacity:xM(e.lineOpacity,1),lineDasharray:xM(e.lineDasharray,[]),lineCap:xM(e.lineCap,"butt"),lineJoin:xM(e.lineJoin,"miter"),linePatternFile:xM(e.linePatternFile,null),lineDx:xM(e.lineDx,0),lineDy:xM(e.lineDy,0),polygonFill:xM(e.polygonFill,null),polygonOpacity:xM(e.polygonOpacity,1),polygonPatternFile:xM(e.polygonPatternFile,null),polygonPatternDx:xM(e.polygonPatternDx,0),polygonPatternDy:xM(e.polygonPatternDy,0),linePatternDx:xM(e.linePatternDx,0),linePatternDy:xM(e.linePatternDy,0)};return 0===t.lineWidth&&(t.lineOpacity=0),"LineString"!==this.geometry.type||t.polygonFill||(t.polygonFill=t.lineColor),t},i._createGradient=function(e,t,i){if(Array.isArray(t)&&t.length){var n=function(e){var t,i=!0;Array.isArray(e[0])?(t=e[0],i=!1):t=e;var n=t.length;if(i)return[t[0],t[n-1]];for(var r,s=t[0],o=0,a=1;a<n;a++){var l=t[a],c=s.distanceTo(l);c>o&&(o=c,r=l)}return[s,r]}(t),r=n[0],s=n[1];if(r&&s){var o=e.createLinearGradient(r.x,r.y,s.x,s.y);i.colorStops.forEach((function(e){o.addColorStop.apply(o,e)})),e.strokeStyle=o}else console.error("unable create canvas LinearGradient,error data:",t)}},t}(eO),_O=new DI,yO=function(e){function t(t,i,n){var r,s=(r=e.call(this,t,i,n)||this).translate();return r._dynamic=JM(s),r.style=r._defineStyle(s),0===r.style.textWrapWidth?aM(r):(r.strokeAndFill=r._defineStyle(r.translateLineAndFill(r.style)),r)}tM(t,e),t.test=function(e){return jR(e)};var i=t.prototype;return i.symbolize=function(e,t){if(this.painter.isHitTesting()||0!==this.style.textSize&&(this.style.textOpacity||this.style.textHaloRadius&&this.style.textHaloOpacity)&&0!==this.style.textWrapWidth){var i=this._getRenderContainerPoints();if(EM(i)){var n=this.style,r=this.strokeAndFill,s=Ik(this.style.textName,this.geometry.getProperties());this._dynamic&&delete this._textDesc;var o=this._textDesc=this._textDesc||Rk(s,this.style);this._prepareContext(e),this.prepareCanvas(e,r,t),YA.prepareCanvasFont(e,n);for(var a=n.textHaloRadius||0,l=0,c=i.length;l<c;l++){var h=i[l],u=this.getRotation()?this._rotate(e,h,this._getRotationAt(l)):null,d=void 0;if(u){var p=h.sub(u);h=u;var m=this._getRotationAt(l),f=o.size||{width:0,height:0},g=f.width,_=f.height,y=Ok(o.size,n.textHorizontalAlignment,n.textVerticalAlignment);(d=SR(_O,m,g,_,h,y))._add(p)}var v=YA.text(e,s,h,n,o);u?(this._setBBOX(e,d.xmin,d.ymin,d.xmax,d.ymax),e.restore()):this._setBBOX(e,v),this._bufferBBOX(e,a)}}}},i.getPlacement=function(){return this.symbol.textPlacement},i.getRotation=function(){var e=this.style.textRotation;return dP(e)?-e*Math.PI/180:null},i.getDxDy=function(){var e=this.style;return new uM(e.textDx,e.textDy)},i.getFixedExtent=function(){var e=this.geometry.getTextDesc();return Array.isArray(e)&&(e=e[this._index]),this._fixedExtent=this._fixedExtent||new DI,e?LR(this._fixedExtent,this.style,e):this._fixedExtent},i.translate=function(){var e=this.symbol,t={textName:e.textName,textFaceName:xM(e.textFaceName,"monospace"),textWeight:xM(e.textWeight,"normal"),textStyle:xM(e.textStyle,"normal"),textSize:xM(e.textSize,14),textFont:xM(e.textFont,null),textFill:xM(e.textFill,"#000"),textOpacity:xM(e.textOpacity,1),textHaloFill:xM(e.textHaloFill,"#ffffff"),textHaloRadius:xM(e.textHaloRadius,0),textHaloOpacity:xM(e.textHaloOpacity,1),textWrapWidth:xM(e.textWrapWidth,null),textWrapCharacter:xM(e.textWrapCharacter,"\n"),textLineSpacing:xM(e.textLineSpacing,0),textDx:xM(e.textDx,0),textDy:xM(e.textDy,0),textHorizontalAlignment:xM(e.textHorizontalAlignment,"middle"),textVerticalAlignment:xM(e.textVerticalAlignment,"middle"),textAlign:xM(e.textAlign,"center"),textRotation:xM(e.textRotation,0),textMaxWidth:xM(e.textMaxWidth,0),textMaxHeight:xM(e.textMaxHeight,0)};return t.textMaxWidth>0&&(!t.textWrapWidth||t.textWrapWidth>t.textMaxWidth)&&(t.textWrapWidth||(t.textMaxHeight=1),t.textWrapWidth=t.textMaxWidth),t},i.translateLineAndFill=function(e){return{lineColor:e.textHaloRadius?e.textHaloFill:e.textFill,lineWidth:e.textHaloRadius,lineOpacity:e.textOpacity,lineDasharray:null,lineCap:"butt",lineJoin:"round",polygonFill:e.textFill,polygonOpacity:e.textOpacity}},t}(cO),vO=[],xO=new DI,bO=new uM(0,0),wO=function(e){function t(t,i,n){var r,s=(r=e.call(this,t,i,n)||this).translate();return r._dynamic=JM(s),r.style=r._defineStyle(s),r.strokeAndFill=r._defineStyle(iO(r.style)),r.padding=0,r}tM(t,e),t.test=function(e){return UR(e)};var i=t.prototype;return i.symbolize=function(e,t){var i=this.style;if(this.painter.isHitTesting()||0!==i.markerWidth&&0!==i.markerHeight&&(0!==i.polygonOpacity||0!==i.lineOpacity)){var n=this._getRenderContainerPoints();EM(n)&&(this._prepareContext(e),this.getPainter().isSpriting()||this.geometry.getLayer().getMask()===this.geometry||this._dynamic||!1===this.geometry.getLayer().options.cacheVectorOnCanvas?this._drawMarkers(e,n,t):this._drawMarkersWithCache(e,n,t))}},i._drawMarkers=function(e,t,i){for(var n=t.length-1;n>=0;n--){var r=t[n],s=OR(vO,this.style),o=s[0],a=s[1],l=void 0,c=this.getRotation()?this._rotate(e,r,this._getRotationAt(n)):null;if(c){var h=r.sub(c);r=c;var u=this._getRotationAt(n);(l=SR(xO,u,o,a,r,bO))._add(h)}if(this._drawVectorMarker(e,r,i),c)e.restore(),this._setBBOX(e,l.xmin,l.ymin,l.xmax,l.ymax);else{var d=r.x,p=r.y;this._setBBOX(e,d,p,d+o,p+a)}}},i._drawMarkersWithCache=function(e,t,i){var n=this._stampSymbol(),r=i.getImage(n);r||(r=this._createMarkerImage(e,i),i.addResource([n,r.width,r.height],r));for(var s=RR(this.style,r.width,r.height),o=t.length-1;o>=0;o--){var a=t[o],l=this.getRotation()?this._rotate(e,a,this._getRotationAt(o)):null,c=void 0;if(l){var h=a.sub(l);a=l;var u=this._getRotationAt(o);(c=SR(xO,u,r.width,r.height,a,s))._add(h)}var d=a.x+s.x,p=a.y+s.y;YA.image(e,r,d,p),l?(e.restore(),this._setBBOX(e,c.xmin,c.ymin,c.xmax,c.ymax)):this._setBBOX(e,d,p,d+r.width,p+r.height)}},i._createMarkerImage=function(e,t){var i=e.canvas.constructor,n=OR(vO,this.style),r=YA.createCanvas(n[0],n[1],i),s=this._getCacheImageAnchor(n[0],n[1]),o=r.getContext("2d");return this._drawVectorMarker(o,s,t),r},i._stampSymbol=function(){return this._stamp||(this._stamp=zk([this.style.markerType,Lk(this.style.markerFill)?Bk(this.style.markerFill):this.style.markerFill,this.style.markerFillOpacity,this.style.markerFillPatternFile,Lk(this.style.markerLineColor)?Bk(this.style.markerLineColor):this.style.markerLineColor,this.style.markerLineWidth,this.style.markerLineOpacity,this.style.markerLineDasharray?this.style.markerLineDasharray.join(","):"",this.style.markerLinePatternFile,this.style.markerWidth,this.style.markerHeight,this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment].join("_"))),this._stamp},i._getCacheImageAnchor=function(e,t){var i=2*(this.symbol.shadowBlur||0)+this.padding,n=this.style.markerType;return"bar"===n||"pie"===n||"pin"===n?new uM(e/2,t-i):"rectangle"===n?new uM(i,i):new uM(e/2,t/2)},i._getGraidentExtent=function(e){var t=new DI,i=this.getDxDy(),n=this.getFixedExtent();if(Array.isArray(e))for(var r=e.length-1;r>=0;r--)t._combine(e[r]);else t._combine(e);return t.xmin+=n.xmin-i.x,t.ymin+=n.ymin-i.y,t.xmax+=n.xmax-i.x,t.ymax+=n.ymax-i.y,t},i._drawVectorMarker=function(e,t,i){tO(e,t,this.style,i)},i.getFixedExtent=function(){var e=this.isDynamicSize(),t=this.style.markerWidth,i=this.style.markerHeight;return this._fixedExtent=this._fixedExtent||new DI,MR(this._fixedExtent,this.style,e?[128,128*(0===t?1:i/t)]:null)},i.translate=function(){var e=this.symbol,t={markerType:xM(e.markerType,"ellipse"),markerFill:xM(e.markerFill,"#00f"),markerFillOpacity:xM(e.markerFillOpacity,1),markerFillPatternFile:xM(e.markerFillPatternFile,null),markerLineColor:xM(e.markerLineColor,"#000"),markerLineWidth:xM(e.markerLineWidth,1),markerLineOpacity:xM(e.markerLineOpacity,1),markerLineDasharray:xM(e.markerLineDasharray,[]),markerLinePatternFile:xM(e.markerLinePatternFile,null),markerDx:xM(e.markerDx,0),markerDy:xM(e.markerDy,0),markerWidth:xM(e.markerWidth,10),markerHeight:xM(e.markerHeight,10),markerRotation:xM(e.markerRotation,0),shadowBlur:xM(e.shadowBlur,0),shadowOffsetX:xM(e.shadowOffsetX,0),shadowOffsetY:xM(e.shadowOffsetY,0)},i=t.markerType,n=kR(i),r=AR(i);return t.markerHorizontalAlignment=xM(e.markerHorizontalAlignment,n),t.markerVerticalAlignment=xM(e.markerVerticalAlignment,r),dP(e.markerOpacity)&&(dP(e.markerFillOpacity)&&(t.markerFillOpacity*=e.markerOpacity),dP(e.markerLineOpacity)&&(t.markerLineOpacity*=e.markerOpacity)),t},t}(cO),CO=function(e){function t(t,i,n){var r;uP(t.markerWidth)&&(t.markerWidth=80),uP(t.markerHeight)&&(t.markerHeight=80),t=hP(t,(r=e.call(this,t,i,n)||this).translate());var s=r.style=r._defineStyle(t);return r._url=QP.gecko?[yk(s,s.markerWidth,s.markerHeight),s.markerWidth,s.markerHeight]:[yk(s),s.markerWidth,s.markerHeight],r}tM(t,e),t.test=function(e){return qR(e)};var i=t.prototype;return i._prepareContext=function(){},i._getImage=function(e){var t=this;if(e&&e.isResourceLoaded(this._url))return e.getImage(this._url);var i=this.painter,n=new Image;return n.onload=function(){var e=i.getLayer()&&i.getLayer().getRenderer();e&&e.setToRedraw()},n.onerror=function(i){i&&"undefined"!=typeof console&&console.warn(i),e.markErrorResource(t._url)},n.src=this._url[0],e&&e.addResource(this._url,n),n},t}(pO),SO={lineWidth:1,polygonFill:"#fff",polygonOpacity:.5},EO=[function(e){function t(t,i,n){var r;return(r=e.call(this,t,i,n)||this).style=i.getLayer().options.drawAltitude,r.style&&mP(r.style)||(r.style={lineWidth:2}),r.style.lineWidth||(r.style.lineWidth=0),r.dxdy=r._defineStyle({dx:t.textDx||t.markerDx,dy:t.textDy||t.markerDy}),r}tM(t,e),t.test=function(e,t){if(!t.getLayer())return!1;var i=t.getJSONType();return"Marker"===i||"LineString"===i};var i=t.prototype;return i.symbolize=function(e){if(this.geometry.getLayer().options.drawAltitude&&this.geometry.hasAltitude()){var t=this._getStyle();if(this._prepareContext(e),"LineString"===this.geometry.type){var i=this._getPaintParams(t.lineDx,t.lineDy,!1,!0);if(!i)return;var n=this.getPainter().getPaintParams(t.lineDx,t.lineDy,!0,!0,"_groundpt")[0];this._drawLineAltitude(e,i[0],n)}else{var r=this._getRenderContainerPoints(),s=this._getRenderContainerPoints(!0);if(!r||0===r.length)return;this._drawMarkerAltitude(e,r[0],s[0])}}},i.getDxDy=function(){var e=this.dxdy;return new uM(e.dx||0,e.dy||0)},i.get2DExtent=function(){return"LineString"===this.geometry.type?gO.prototype.get2DExtent.apply(this):e.prototype.get2DExtent.call(this)},i.getPlacement=function(){return"point"},i._getPaintParams=function(e,t){return this.getPainter().getPaintParams(e||0,t||0,null,!0,"_altpt")},i._drawMarkerAltitude=function(e,t,i){var n=this._getStyle();this.prepareCanvas(e,n),YA.path(e,[t,i],n.lineOpacity,null,n.lineDasharray)},i._drawLineAltitude=function(e,t,i){var n=this._getStyle();if(t.length>0&&Array.isArray(t[0]))for(var r=0;r<t.length;r++)this._drawLine(e,t[r],i[r]);else this._drawLine(e,t,i);e.setLineDash&&Array.isArray(n.lineDasharray)&&e.setLineDash([])},i._drawLine=function(e,t,i){var n=this._getStyle();this.prepareCanvas(e,n);for(var r=0,s=t.length-1;r<s;r++)YA.polygon(e,[t[r],t[r+1],i[r+1],i[r]],n.lineOpacity,n.polygonOpacity,n.lineDasharray)},i._getStyle=function(){var e=this.geometry.getLayer().options.drawAltitude;return mP(e)||(e=SO),e.lineWidth||(e.lineWidth=0,e.lineOpacity=0),e},t}(cO),gO,pO,CO,wO,yO],TO=new uM(0,0),PO=new DI,MO=new DI,kO=new DI,AO=new DI,IO=new DI,RO={},OO={minx:1/0,miny:1/0,maxx:-1/0,maxy:-1/0},NO=function(e){function t(t){var i;return(i=e.call(this)||this).geometry=t,i.symbolizers=i._createSymbolizers(),i._altAtGL=i._getGeometryAltitude(),i.bbox=[1/0,1/0,-1/0,-1/0],i._drawTime=0,i}tM(t,e);var i=t.prototype;return i._setDrawTime=function(e){return this._drawTime=e,this},i.getRenderBBOX=function(){var e=this.getLayer();if(e&&e._drawTime!==this._drawTime)return null;HA(this.bbox);for(var t=this.symbolizers.length-1;t>=0;t--){var i=this.symbolizers[t].bbox;ZA(i)&&WA(this.bbox,i)}return ZA(this.bbox)?this.bbox:null},i.getMap=function(){return this.geometry.getMap()},i.getLayer=function(){return this.geometry&&this.geometry.getLayer()},i._createSymbolizers=function(){var e=this.getSymbol(),t=[],i=EO,n=e;Array.isArray(e)||(n=[e]);for(var r=n.length-1;r>=0;r--)for(var s=n[r],o=i.length-1;o>=0;o--)if(i[o].test(s,this.geometry)){var a=new i[o](s,this.geometry,this);a._index=r,t.push(a),a instanceof cO&&(this._hasPoint=!0)}if(!t.length&&console){var l=this.geometry.getId();console.warn("invalid symbol for geometry("+(this.geometry?this.geometry.getType()+(l?":"+l:""):"")+") to draw : "+JSON.stringify(e))}return this._debugSymbolizer=new hO(e,this.geometry,this),t},i.hasPoint=function(){return!!this._hasPoint},i.getRenderPoints=function(e){return this._verifyProjection(),this._renderPoints||(this._renderPoints={}),e||(e="center"),this._renderPoints[e]||(this._renderPoints[e]=this.geometry._getRenderPoints(e)),this._renderPoints[e]},i.getPaintParams=function(e,t,i,n,r){void 0===r&&(r="_pt");var s,o,a,l,c,h=this.getLayer()._getRenderer().mapStateCache,u=this.getMap();h&&!this._hitPoint?(s=h.resolution,o=h.pitch,a=h.bearing,l=h.glScale,c=h.containerExtent):(s=u.getResolution(),o=u.getPitch(),a=u.getBearing(),l=u.getGLScale(),c=u.getContainerExtent());var d=this.geometry,p=s,m=0!==o,f=0!==a,g=this._cachedParams,_=d._paintAsPath&&d._paintAsPath();if(_&&this._unsimpledParams&&p<=this._unsimpledParams._res)g=this._unsimpledParams;else if(!g||g._res!==s||this._pitched!==m&&d._redrawWhenPitch()||this._rotated!==f&&d._redrawWhenRotate()){if(!(g=d._getPaintParams()))return null;g._res=p,!d._simplified&&_&&(this._unsimpledParams||(this._unsimpledParams=g),p>this._unsimpledParams._res&&(this._unsimpledParams._res=p)),this._cachedParams=g}if(!g)return null;this._pitched=m,this._rotated=f;var y=l,v=[],x=this._pointContainerPoints(g[0],e,t,i,n||this._hitPoint&&!c.contains(this._hitPoint),null,r);if(!x)return null;v.push(x);for(var b=1,w=g.length;b<w;b++)dP(g[b])||g[b]instanceof wk?dP(g[b])?v.push(g[b]/y):v.push(g[b].multi(1/y)):v.push(g[b]);return v},i._pointContainerPoints=function(e,t,i,n,r,s,o){if(void 0===o&&(o="_pt"),this._aboveCamera())return null;var a,l,c,h=this.getLayer()._getRenderer(),u=h.mapStateCache,d=this.getMap(),p=this.geometry,m=this.containerOffset;u?(a=u.glRes,l=u.containerExtent):(a=d.getGLRes(),l=d.getContainerExtent());var f=this.getLayer().options.roundPoint,g=1/0,_=1/0,y=-1/0,v=-1/0,x=!r,b=h.layer.options.clipBBoxBufferSize||3,w=this.symbolizers;function C(e,n){void 0===e&&(e=[]),void 0===n&&(n=[]);for(var r=NM(e,o),s=0,c=(r=d._pointsAtResToContainerPoints(e,a,n,r)).length;s<c;s++){var h=r[s];h._sub(m),(t||i)&&h._add(t||0,i||0),f&&(h.x=Math.ceil(h.x),h.y=Math.ceil(h.y)),g=Math.min(h.x,g),_=Math.min(h.y,_),y=Math.max(h.x,y),v=Math.max(h.y,v)}if(x&&function(e){void 0===e&&(e=[]),Array.isArray(e)||(e=[e]);for(var t=e.length,i=0;i<t;i++){var n=e[i];if(n.style){var r=n.style,s=r.lineDasharray,o=r.lineWidth;if(o&&dP(o)&&o>0&&s&&Array.isArray(s)&&s.length)return!0}}return!1}(w)){if(IO.ymin=l.ymin,IO.ymin<b&&(IO.ymin=l.ymin-b),IO.xmin=l.xmin-b,IO.xmax=l.xmax+b,IO.ymax=l.ymax+b,p.getShell&&p.getHoles)return KR(r,IO);var u=$R(r,IO,!1);if(u.length){var C=[];return u.forEach((function(e){for(var t=0,i=e.length;t<i;t++)C.push(e[t].point)})),C}}return r}var S=this.getAltitude();if(Array.isArray(e)){var E;!r&&this.geometry.options.enableClip?(E=this._clip(e,S)).inView&&(x=!1):E={points:e,altitude:S};var T=E.points;S=E.altitude,n&&(S=0);var P=S;c=[];for(var M=[],k=dP(S),A=0,I=T.length;A<I;A++){var R=T[A];if(Array.isArray(R)){if(k){var O=C(R,S);c.push(O);continue}for(var N=[],D=0,z=R.length;D<z;D++)Array.isArray(S)&&(P=S[A]?S[A][D]:0),N.push(P);var L=C(R,N);c.push(L)}else Array.isArray(S)&&(P="vertex-last"===s?S[S.length-1-A]:"line"===s?(S[A]+S[A+1])/2:S[A]),M.push(P)}M.length&&(c=C(T,M))}else e instanceof uM&&(n&&(S=0),c=d._pointAtResToContainerPoint(e,a,S)._sub(m),(t||i)&&c._add(t,i));return OO.minx=g,OO.miny=_,OO.maxx=y,OO.maxy=v,this._containerBbox=OO,c},i._clip=function(e,t){if(dP(t)&&0!==t)return{points:e,altitude:t};if(Array.isArray(t)){for(var i=!1,n=0,r=t.length;n<r;n++)if(0!==t[n]){i=!0;break}if(i)return{points:e,altitude:t}}var s=this.getMap(),o=this.geometry,a=this.getSymbol().lineWidth;dP(a)||(a=4);var l,c,h,u=this.getLayer()._getRenderer().mapStateCache;u?(l=u._2DExtent,c=u.glExtent,h=u.pitch):(l=s._get2DExtent(),c=s._get2DExtentAtRes(s.getGLRes()),h=s.getPitch());var d=l._expand(a);if(h>0&&t){var p=s.cameraLookAt,m=s.cameraPosition;TO.set(m.x,m.y),d=d._combine(TO._add(bM(p[0]-m[0]),bM(p[1]-m[1])))}var f=e;if(this.get2DExtent(null,AO).within(d))return{points:f,altitude:t,inView:!0};var g=c._expand(a*s._glScale);kO.xmin=g.xmin,kO.xmax=g.xmax,kO.ymin=g.ymin,kO.ymax=g.ymax;var _=o.options.smoothness;if(o.getShell&&this.geometry.getHoles&&!_){var y=g.ymin,v=g.ymax,x=Math.abs(g.xmax-g.xmin),b=Math.abs(v-y),w=Math.sqrt(x*x+b*b),C=(w-x)/2,S=(w-b)/2;if(kO.xmin=g.xmin-C,kO.xmax=g.xmax+C,kO.ymin=g.ymin-S,kO.ymax=g.ymax+S,Array.isArray(e[0])){f=[];for(var E=0;E<e.length;E++){var T=KR(e[E],kO);T.length&&f.push(T)}}else f=KR(e,kO)}else if("LineString"===o.getJSONType()&&!_){if(Array.isArray(e[0])){f=[];for(var P=0;P<e.length;P++)_M(f,$R(e[P],kO,!1,!!_))}else f=$R(e,kO,!1,!!_);return this._interpolateSegAlt(f,e,t)}return{points:f,altitude:t}},i._interpolateSegAlt=function(e,t,i){if(!Array.isArray(i)){var n=function(e){return e.point};return{points:e.map((function(e){return Array.isArray(e)?e.map(n):e.point})),altitude:i}}var r=function e(t,i,n){if(!Array.isArray(n))return t;for(var r=[],s=0,o=t.length;s<o;s++)if(Array.isArray(t[s]))r.push(e(t[s],i,n));else{var a=t[s];if(a.point.equals(i[a.index]))a.altitude=n[a.index],r.push(a);else{var l=void 0,c=void 0;0===a.index?(l=a.index,c=a.index+1):(l=a.index-1,c=a.index);var h=a.point.distanceTo(i[c]),u=h/(h+i[l].distanceTo(a.point)),d=wM(n[l],n[c],1-u);a.altitude=d,r.push(a)}}return r}(e,t,i);return i=[],{points:r.map((function(e){if(Array.isArray(e)){var t=[],n=e.map((function(e){return t.push(e.altitude),e.point}));return i.push(t),n}return i.push(e.altitude),e.point})),altitude:i}},i.getSymbol=function(){return this.geometry._getInternalSymbol()},i._resetSymbolizersBBOX=function(){for(var e=this.symbolizers.length-1;e>=0;e--)HA(this.symbolizers[e].bbox);return this},i.paint=function(e,t,i){if(this.symbolizers){var n=this.getLayer(),r=n._getRenderer();if(r&&(r.context||t)){var s=r.mapStateCache||{};if(this.geometry._isCheck||!e||e.intersects(this.get2DExtent(r.resources,PO))){var o=this.getMap();if(!this._aboveCamera()){this.containerOffset=i||s.offset||o._pointToContainerPoint(r.southWest)._add(0,-o.height),this._beforePaint();var a=t||r.context;a.isHitTesting||this._resetSymbolizersBBOX();for(var l=[a,r.resources],c=this.symbolizers.length-1;c>=0;c--)(a.shadowBlur||this.symbolizers[c].symbol.shadowBlur)&&this._prepareShadow(a,this.symbolizers[c].symbol),this.symbolizers[c].symbolize.apply(this.symbolizers[c],l);this._afterPaint(),this._painted=!0,(this.geometry.options.debug||n.options.debug)&&this._debugSymbolizer.symbolize.apply(this._debugSymbolizer,l)}}}}},i.getSprite=function(e,t){if(!this.geometry.isPoint)return null;if(this._spriting=!0,!this._sprite&&this.symbolizers.length>0){var i=new DI;this.symbolizers.forEach((function(t){var n=t.getFixedExtent(e);i._combine(n)}));var n,r=i.getMin().multi(-1),s=t||(this.getMap()?this.getMap().CanvasClass:null),o=YA.createCanvas(i.getWidth(),i.getHeight(),s);this._renderPoints&&(n=this._renderPoints);for(var a=o.getContext("2d"),l=[a,e],c=this.symbolizers.length-1;c>=0;c--){var h=this.symbolizers[c].getDxDy();this._renderPoints={center:[[r.add(h)]]},this._prepareShadow(a,this.symbolizers[c].symbol),this.symbolizers[c].symbolize.apply(this.symbolizers[c],l)}n&&(this._renderPoints=n),this._sprite={canvas:o,offset:i.getCenter()}}return this._spriting=!1,this._sprite},i.isSpriting=function(){return!!this._spriting},i.hitTest=function(e,t){if((!t||t<.5)&&(t=.5),this._hitPoint=e.sub(t,t),!rO){var i=this.getMap()?this.getMap().CanvasClass:null;rO=YA.createCanvas(1,1,i)}YA.setHitTesting(!0),rO.width=rO.height=2*t;var n=YA.getCanvas2DContext(rO);n.isHitTesting=!0;try{this.paint(null,n,this._hitPoint)}catch(P0){throw P0}finally{YA.setHitTesting(!1)}delete this._hitPoint;for(var r=n.getImageData(0,0,rO.width,rO.height).data,s=3,o=r.length;s<o;s+=4)if(r[s]>0)return!0;return!1},i.isHitTesting=function(){return!!this._hitPoint},i._prepareShadow=function(e,t){t.shadowBlur?(e.shadowBlur=this.isHitTesting()?0:t.shadowBlur,e.shadowColor=t.shadowColor||"#000",e.shadowOffsetX=t.shadowOffsetX||0,e.shadowOffsetY=t.shadowOffsetY||0):e.shadowBlur&&(e.shadowBlur=null,e.shadowColor=null,e.shadowOffsetX=null,e.shadowOffsetY=null)},i._eachSymbolizer=function(e,t){if(this.symbolizers){t||(t=this);for(var i=this.symbolizers.length-1;i>=0;i--)e.apply(t,[this.symbolizers[i]])}},i.get2DExtent=function(e,t){this._verifyProjection();var i=this.getMap();e=e||this.getLayer()._getRenderer().resources;var n=i.getZoom(),r=this._isDynamicSize();if(this._extent2D&&this._extent2D._zoom===n&&this._fixedExtent||(this._extent2D&&this._extent2D._zoom!==n&&delete this._extent2D,this.symbolizers&&(this._extent2D||(this._extent2D=this._computeExtent2D(new DI),this._extent2D._zoom=n),this._fixedExtent||(this._fixedExtent=this._computeFixedExtent(e,new DI)))),!this._extent2D)return r&&delete this._fixedExtent,null;var s=this._fixedExtent,o=s.xmin,a=s.ymin,l=s.xmax,c=s.ymax;return r&&delete this._fixedExtent,MO.set(o,-c,l,-a),t?(t.set(this._extent2D.xmin,this._extent2D.ymin,this._extent2D.xmax,this._extent2D.ymax),t._add(MO),t):this._extent2D.add(MO)},i._computeExtent2D=function(e){for(var t=this.symbolizers.length-1;t>=0;t--)e._combine(this.symbolizers[t].get2DExtent());return e},i._computeFixedExtent=function(e,t){for(var i=this.symbolizers.length-1;i>=0;i--){var n=this.symbolizers[i];n.getFixedExtent&&t._combine(n.getFixedExtent(e))}return t},i._isDynamicSize=function(){for(var e=this.symbolizers.length-1;e>=0;e--)if(this.symbolizers[e].isDynamicSize())return!0;return!1},i._aboveCamera=function(){var e=this.getMinAltitude(),t=this.getMap(),i=t.getGLRes();e=t.altitudeToPoint(e,i)*bM(e);var n=t.getFrustumAltitude();return e&&n&&n<e},i.getFixedExtent=function(){var e=this.getMap().getZoom();return this._isDynamicSize()?this._computeFixedExtent(null,new DI):(this._extent2D&&this._extent2D._zoom===e||this.get2DExtent(null,MO),this._fixedExtent)},i.setZIndex=function(e){this._eachSymbolizer((function(t){t.setZIndex(e)}))},i.show=function(){this._painted?(this.removeCache(),this._eachSymbolizer((function(e){e.show()}))):this.getLayer().isCanvasRender()||this.paint()},i.hide=function(){this._eachSymbolizer((function(e){e.hide()}))},i.repaint=function(){this._altAtGL=this._getGeometryAltitude(),this.removeCache();var e=this.getLayer();if(e){var t=e.getRenderer();t&&t.setToRedraw()&&t.setToRedraw()}},i.refreshSymbol=function(){this.removeCache(),this._removeSymbolizers(),this.symbolizers=this._createSymbolizers()},i.remove=function(){this.removeCache(),this._removeSymbolizers()},i._removeSymbolizers=function(){this._eachSymbolizer((function(e){delete e.painter,e.remove()})),delete this.symbolizers},i.removeCache=function(){delete this._renderPoints,delete this._paintParams,delete this._sprite,delete this._extent2D,delete this._fixedExtent,delete this._cachedParams,delete this._unsimpledParams},i.getAltitude=function(){return this.geometry._getAltitude()!==this._propAlt&&(this._altAtGL=this._getGeometryAltitude()),this._altAtGL?this._altAtGL:0},i.getMinAltitude=function(){return this.minAltitude?this.minAltitude:0},i.getMaxAltitude=function(){return this.maxAltitude?this.maxAltitude:0},i._getGeometryAltitude=function(){var e=this;if(!this.getMap())return 0;var t=this.geometry._getAltitude();return this._propAlt=t,t?this.geometry.getCenter()?Array.isArray(t)?(this.minAltitude=Number.MAX_VALUE,this.maxAltitude=Number.MIN_VALUE,t.map((function(t){var i=t;return i<e.minAltitude&&(e.minAltitude=i),i>e.maxAltitude&&(e.maxAltitude=i),i}))):(this.minAltitude=this.maxAltitude=t,this.minAltitude):0:(this.minAltitude=this.maxAltitude=0,0)},i._verifyProjection=function(){var e=this.geometry._getProjection()||RO;this._projCode&&this._projCode!==e.code&&this.removeCache(),this._projCode=e.code},i._beforePaint=function(){},i._afterPaint=function(){},t}(sI),DO=new DI,zO=function(e){function t(t,i){var n;return(n=e.call(this)||this).geometry=t,n.isMask=i,n.bbox=[1/0,1/0,-1/0,-1/0],n._drawTime=0,n}tM(t,e);var i=t.prototype;return i._setDrawTime=function(e){return this._drawTime=e,this._eachPainter((function(t){t._setDrawTime(e)})),this},i.getRenderBBOX=function(){var e=this,t=this.getLayer();return t&&t._drawTime!==this._drawTime?null:(HA(this.bbox),this._eachPainter((function(t){var i=t.getRenderBBOX();ZA(i)&&WA(e.bbox,i)})),ZA(this.bbox)?this.bbox:null)},i._eachPainter=function(e){for(var t,i=this.geometry.getGeometries(),n=0,r=i.length;n<r&&(!(t=this.isMask?i[n]._getMaskPainter():i[n]._getPainter())||!t||!1!==e.call(this,t));n++);},i.getLayer=function(){return this.geometry&&this.geometry.getLayer()},i.paint=function(e){this.geometry&&this._eachPainter((function(t){t.paint(e)}))},i.get2DExtent=function(e,t){t&&t.set(null,null,null,null);var i=t||new DI;return this._eachPainter((function(t){i=i._combine(t.get2DExtent(e,DO))})),i},i.remove=function(){var e=arguments;this._eachPainter((function(t){t.remove.apply(t,e)}))},i.setZIndex=function(){var e=arguments;this._eachPainter((function(t){t.setZIndex.apply(t,e)}))},i.show=function(){var e=arguments;this._eachPainter((function(t){t.show.apply(t,e)}))},i.hide=function(){var e=arguments;this._eachPainter((function(t){t.hide.apply(t,e)}))},i.repaint=function(){var e=arguments;this._eachPainter((function(t){t.repaint.apply(t,e)}))},i.refreshSymbol=function(){var e=arguments;this._eachPainter((function(t){t.refreshSymbol.apply(t,e)}))},i.hasPoint=function(){var e=!1;return this._eachPainter((function(t){return!t.hasPoint()||(e=!0,!1)})),e},i.getMinAltitude=function(){var e=!0,t=0;return this._eachPainter((function(i){var n=i.getMinAltitude();(e||n<t)&&(e=!1,t=n)})),t},i.getMaxAltitude=function(){var e=0;return this._eachPainter((function(t){var i=t.getMaxAltitude();i>e&&(e=i)})),e},t}(sI),LO={"EPSG:3857":{projection:"EPSG:3857",resolutions:function(){for(var e=[],t=12756274*Math.PI,i=0;i<23;i++)e[i]=t/(256*Math.pow(2,i));return e}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"EPSG:4326":{projection:"EPSG:4326",fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var e=[],t=0;t<23;t++)e[t]=180/(128*Math.pow(2,t));return e}()},BAIDU:{projection:"baidu",resolutions:function(){for(var e=Math.pow(2,18),t=[],i=0;i<23;i++)t[i]=e,e*=.5;return t}(),fullExtent:{top:33554432,left:-33554432,bottom:-33554432,right:33554432}},IDENTITY:{projection:"identity",resolutions:function(){for(var e=Math.pow(2,8),t=[],i=0;i<23;i++)t[i]=e,e*=.5;return t}(),fullExtent:{top:2e5,left:-2e5,bottom:-2e5,right:2e5}},"PRESET-VT-3857":{projection:"EPSG:3857",resolutions:function(){for(var e=[],t=6378137*Math.PI,i=0;i<23;i++)e[i]=t/(256*Math.pow(2,i));return e}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"PRESET-VT-4326":{projection:"EPSG:4326",fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var e=[],t=0;t<23;t++)e[t]=45/(128*Math.pow(2,t));return e}()}};LO["EPSG:4490"]=LO["EPSG:4326"],LO["PRESET-3857-512"]=LO["PRESET-VT-3857"],LO["PRESET-4326-512"]=LO["PRESET-VT-4326"];var BO=function(){function e(e){void 0===e&&(e={}),this.options=e,this._initSpatialRef()}e.registerPreset=function(e,t){e=e&&e.toUpperCase(),LO[e]&&console.warn("Spatial reference "+e+" already registered."),LO[e]=t},e.getPreset=function(e){return LO[e.toUpperCase()]},e.getAllPresets=function(){return Object.keys(LO)},e.getProjectionInstance=function(e){if(!e)return null;if(fP(e)&&(e={code:e}),e.project)return e.locate||(e=hP({},e),hP(e,ZI.getInstance("identity"===e.measure?"IDENTITY":"EPSG:4326"))),e;var t=(e.code+"").toLowerCase();for(var i in mR)if(yP(mR,i)){var n=mR[i].aliases||[];n.push(mR[i].code);for(var r=0;r<n.length;r++)if(n[r].toLowerCase()===t){if(mR[i].create){var s=mR[i].create(e);return s.code=n[r],s}if(mR[i].code===n[r])return mR[i];var o=hP({},mR[i]);return o.code=n[r],o}}return null},e.equals=function(e,t){if(fP(e)||fP(t))return e===t;if(!e&&!t)return!0;if(!e||!t)return!1;if(e.projection!==t.projection)return!1;var i=e.fullExtent,n=t.fullExtent;if(i&&!n||!i&&n)return!1;if(i&&n&&(i.top!==n.top||i.bottom!==n.bottom||i.left!==n.left||i.right!==n.right))return!1;var r=e.resolutions,s=t.resolutions;if(r&&s){if(r.length!==s.length)return!1;for(var o=0;o<r.length;o++)if(r[o]!==s[o])return!1}else if(r||s)return!1;return!0};var t=e.prototype;return t._initSpatialRef=function(){var t=this.options.projection;if(!(t=t?e.getProjectionInstance(t):pR))throw new Error("must provide a valid projection in map's spatial reference.");(t=hP({},LI,t)).measureLength||hP(t,ZI.DEFAULT),this._projection=t;var i,n=this.options.resolutions;if(!n&&(t.code&&(i=LO[t.code.toUpperCase()])&&(n=i.resolutions,this.isEPSG="IDENTITY"!==t.code),!n))throw new Error("must provide valid resolutions in map's spatial reference.");if(this._resolutions=n,this._pyramid=!0,this._pyramid)for(var r=0;r<n.length;r++)if(n[r]&&n[r-1]&&n[r-1]/n[r]!=2){this._pyramid=!1;break}var s=this.options.fullExtent;if(!s&&(t.code&&(i=LO[t.code.toUpperCase()])&&(s=i.fullExtent),!s))throw new Error("must provide a valid fullExtent in map's spatial reference.");if(uP(s.left)?(this._fullExtent=new OI(s),s.left=s.xmin,s.right=s.xmax,s.top=s.ymax,s.bottom=s.ymin):this._fullExtent=new OI(new vI(s.left,s.top),new vI(s.right,s.bottom)),uP(s.top)||uP(s.bottom)||uP(s.left)||uP(s.right))throw new Error("must provide valid top/bottom/left/right in fullExtent.");hP(this._fullExtent,s),this._projection.fullExtent=s,this._transformation=new zI([s.right>=s.left?1:-1,s.top>=s.bottom?-1:1,0,0])},t.getResolutions=function(){return this._resolutions||[]},t.getResolution=function(e){var t=0|e;t<0?t=0:t>this._resolutions.length-1&&(t=this._resolutions.length-1);var i=this._resolutions[t];return t!==e&&e>0&&t<this._resolutions.length-1?i+(this._resolutions[t+1]-i)*(e-t):i},t.getProjection=function(){return this._projection},t.getFullExtent=function(){return this._fullExtent},t.getTransformation=function(){return this._transformation},t.getMinZoom=function(){for(var e=0;e<this._resolutions.length;e++)if(!uP(this._resolutions[e]))return e;return 0},t.getMaxZoom=function(){for(var e=this._resolutions.length-1;e>=0;e--)if(!uP(this._resolutions[e]))return e;return this._resolutions.length-1},t.getZoomDirection=function(){return bM(this._resolutions[this.getMinZoom()]-this._resolutions[this.getMaxZoom()])},t.toJSON=function(){return this.json||(this.json={resolutions:this._resolutions,fullExtent:{top:this._fullExtent.top,left:this._fullExtent.left,bottom:this._fullExtent.bottom,right:this._fullExtent.right},projection:this._projection.code}),this.json},t.isPyramid=function(){return this._pyramid},e}(),FO=new uM(0,0),jO=new DI,VO={},UO=function(e){function t(t){var i,n=hP({},t),r=n.symbol,s=n.properties,o=n.id;return delete n.symbol,delete n.id,delete n.properties,i=e.call(this,n)||this,r?i.setSymbol(r):i._genSizeSymbol(),s&&i.setProperties(s),uP(o)||i.setId(o),i}tM(t,e);var i=t.prototype;return i.getFirstCoordinate=function(){if("GeometryCollection"===this.type){var e=this.getGeometries();return e.length?e[0].getFirstCoordinate():null}var t=this.getCoordinates();if(!Array.isArray(t))return t;do{t=t[0]}while(Array.isArray(t)&&t.length>0);return t},i.getLastCoordinate=function(){if("GeometryCollection"===this.type){var e=this.getGeometries();return e.length?e[e.length-1].getLastCoordinate():null}var t=this.getCoordinates();if(!Array.isArray(t))return t;do{t=t[t.length-1]}while(Array.isArray(t)&&t.length>0);return t},i.addTo=function(e,t){return e.addGeometry(this,t),this},i.getLayer=function(){return this._layer?this._layer:null},i.getMap=function(){return this._layer?this._layer.getMap():null},i.getId=function(){return this._id},i.setId=function(e){var t=this.getId();return this._id=e,this._fireEvent("idchange",{old:t,new:e}),this},i.getProperties=function(){return this.properties?this.properties:this._getParent()?this._getParent().getProperties():null},i.setProperties=function(e){var t=this.properties;return this.properties=mP(e)?hP({},e):e,this._clearAltitudeCache(),this._repaint(),this._fireEvent("propertieschange",{old:t,new:e}),this},i.getType=function(){return this.type},i.getSymbol=function(){var e=this._symbol;return e?Array.isArray(e)?Vk(e):hP({},e):null},i.setSymbol=function(e){return this._symbolUpdated=e,this._symbol=this._prepareSymbol(e),this.onSymbolChanged(),delete this._compiledSymbol,delete this._symbolHash,this},i.getSymbolHash=function(){return this._symbolHash||(this._symbolHash=Fk(this._symbolUpdated)),this._symbolHash},i.updateSymbol=function(e){if(!e)return this;var t=this._getSymbol();if(Array.isArray(t)){if(!Array.isArray(e))throw new Error("Parameter of updateSymbol is not an array.");for(var i=0;i<e.length;i++)jR(e[i])&&delete this._textDesc,t[i]&&e[i]&&(t[i]=Vk(t[i],e[i]))}else{if(Array.isArray(e))throw new Error("Geometry's symbol is not an array to update.");jR(t)&&delete this._textDesc,t=Vk(t||this._getInternalSymbol(),e)}return this._eventSymbolProperties=e,delete this._compiledSymbol,this.setSymbol(t)},i.getTextContent=function(){var e=this._getInternalSymbol();if(Array.isArray(e)){for(var t=[],i=!1,n=0;n<e.length;n++)t[n]=Ik(e[n]&&e[n].textName,this.getProperties()),uP(t[n])||(i=!0);return i?t:null}return Ik(e&&e.textName,this.getProperties())},i.getTextDesc=function(){if(!this._textDesc){var e=this.getTextContent(),t=this._sizeSymbol,i=Array.isArray(e);this._textDesc=Array.isArray(t)?t.map((function(t,n){return Rk(i?e[n]:"",t)})):Rk(e,t)}return this._textDesc},i.getCenter=function(){return this._computeCenter(this._getMeasurer())},i.getExtent=function(){var e=this._getPrjExtent(),t=this._getProjection();if(e&&t){var i=t.unproject(new vI(e.xmin,e.ymin)),n=t.unproject(new vI(e.xmax,e.ymax));return new OI(i,n,t)}return this._computeExtent(this._getMeasurer())},i.getContainerExtent=function(e){var t=this.get2DExtent();if(!t||!t.isValid())return null;var i=this.getMap(),n=i.getGLRes(),r=this.getMinAltitude(),s=t.convertTo((function(e){return i._pointAtResToContainerPoint(e,n,r,FO)}),e),o=this.getMaxAltitude();if(o!==r){var a=t.convertTo((function(e){return i._pointAtResToContainerPoint(e,n,o,FO)}),jO);s._combine(a)}var l=this.getLayer();if(l&&"LineString"===this.type&&o&&l.options.drawAltitude){var c=t.convertTo((function(e){return i._pointAtResToContainerPoint(e,n,0,FO)}),jO);s._combine(c)}if(s){var h=this._getFixedExtent();(function(e){return!!e&&e.xmax-e.xmin>0&&e.ymax-e.ymin>0})(h)&&s._add(h)}return this.options.smoothness&&s._expand(.15*s.getWidth()),s},i._getFixedExtent=function(){this._fixedExtent||(this._fixedExtent=new DI);var e=this._sizeSymbol,t=(e&&e.lineWidth||1)/2;return this._fixedExtent.set(-t,-t,t,t),this._fixedExtent._add([e&&e.lineDx||0,0]),this._fixedExtent._add([0,e&&e.lineDy||0]),this._fixedExtent},i.get2DExtent=function(){var e=this.getMap();if(!e)return null;if(this._extent2d)return this._extent2d;var t=this._getPrjExtent();if(!t||!t.isValid())return null;var i=t.getMin(),n=t.getMax(),r=e.getGLRes();return e._prjToPointAtRes(i,r,i),e._prjToPointAtRes(n,r,n),this._extent2d=new DI(i,n),this._extent2d.z=e.getZoom(),this._extent2d},i.getSize=function(){var e=this.getContainerExtent();return e?e.getSize():null},i.containsPoint=function(e,t){if(!this.getMap())throw new Error('The geometry is required to be added on a map to perform "containsPoint".');return e instanceof vI&&(e=this.getMap().coordToContainerPoint(e)),this._containsPoint(e,t)},i._containsPoint=function(e,t){var i=this._getPainter();return!!i&&(t=t||0,this._hitTestTolerance&&(t+=this._hitTestTolerance()),i.hitTest(e,t))},i.show=function(){if(this.options.visible=!0,this.getMap()){var e=this._getPainter();e&&e.show(),this._fireEvent("show")}return this},i.hide=function(){if(this.options.visible=!1,this.getMap()){this.onHide();var e=this._getPainter();e&&e.hide(),this._fireEvent("hide")}return this},i.isVisible=function(){if(!this.options.visible)return!1;var e=this._getInternalSymbol();if(!e)return!0;if(Array.isArray(e)){if(!e.length)return!0;for(var t=0,i=e.length;t<i;t++)if(uP(e[t].opacity)||e[t].opacity>0)return!0;return!1}return uP(e.opacity)||mP(e.opacity)||dP(e.opacity)&&e.opacity>0},i.getZIndex=function(){return this.options.zIndex||0},i.setZIndex=function(e){var t=this.options.zIndex;return this.options.zIndex=e,this._fireEvent("zindexchange",{old:t,new:e}),this},i.setZIndexSilently=function(e){return this.options.zIndex=e,this},i.bringToFront=function(){var e=this.getLayer();if(!e||!e.getGeoMaxZIndex)return this;var t=e.getGeoMaxZIndex();return this.setZIndex(t+1),this},i.bringToBack=function(){var e=this.getLayer();if(!e||!e.getGeoMinZIndex)return this;var t=e.getGeoMinZIndex();return this.setZIndex(t-1),this},i.translate=function(e,t){if(uP(e))return this;var i=new vI(e,t);if(0===i.x&&0===i.y)return this;var n=this.getCoordinates();if(this._silence=!0,n)if(Array.isArray(n)){var r=vM(n,(function(e){return e.add(i)}));this.setCoordinates(r)}else this.setCoordinates(n.add(i));return this._silence=!1,this._fireEvent("positionchange"),this},i.flash=function(e,t,i,n){return OM.call(this,e,t,i,n)},i.copy=function(){var e=this.toJSON(),i=t.fromJSON(e);return i.options.visible=!0,i},i.remove=function(){return this.getLayer()?(this._fireEvent("removestart"),this._unbind(),this._fireEvent("removeend"),this._fireEvent("remove"),this):this},i.toGeoJSONGeometry=function(){return this._exportGeoJSONGeometry()},i.toGeoJSON=function(e){e||(e={});var t={type:"Feature",geometry:null};if(uP(e.geometry)||e.geometry){var i=this._exportGeoJSONGeometry();t.geometry=i}var n,r=this.getId();return uP(r)||(t.id=r),(uP(e.properties)||e.properties)&&(n=this._exportProperties()),t.properties=n,t},i.toJSON=function(e){e||(e={});var t=this._toJSON(e);return hP(t,this._exportGraphicOptions(e)),t},i.getLength=function(){return this._computeGeodesicLength(this._getMeasurer())},i.getArea=function(){return this._computeGeodesicArea(this._getMeasurer())},i.rotate=function(e,t){if(!dP(e))return console.error("angle:"+e+" is not number"),this;if("GeometryCollection"===this.type)return this.getGeometries().forEach((function(i){return i.rotate(e,t)})),this;t=t?new vI(t):this.getCenter(),this._angle=e,this._pivot=t;var i=this._getMeasurer(),n=this.getCoordinates();if(!Array.isArray(n)){if(t.x===n.x&&t.y===n.y||this.getShell)this.onPositionChanged();else{var r=i._rotate(n,t,e);this.setCoordinates(r)}return this}return vM(n,(function(n){return i._rotate(n,t,e)})),this.setCoordinates(n),this},i._rotatePrjCoordinates=function(e){if(!e||0===this._angle||!this._pivot)return e;var t=this._getProjection();if(!t)return e;var i,n,r=0,s=Array.isArray(e),o=s?e:[e],a=[];if(this.getRotateOffsetAngle){r=this.getRotateOffsetAngle();var l=o[o.length-1];i=l.x,n=l.y}else{var c=[1/0,1/0,-1/0,-1/0];GA(o,c),i=(c[0]+c[2])/2,n=(c[1]+c[3])/2}for(var h=0,u=o.length;h<u;h++){var d=o[h],p=d.x,m=d.y,f=p-i,g=m-n,_=Math.sqrt(f*f+g*g),y=(GO(i,n,p,m)-this._angle+r)/180*Math.PI,v=Math.cos(y)*_,x=Math.sin(y)*_,b=new vI(i+v,n+x);a.push(b)}for(var w=t.project(this._pivot),C=i-w.x,S=n-w.y,E=0,T=a.length;E<T;E++){var P=a[E];P.x-=C,P.y-=S}return s?a:a[0]},i.isRotated=function(){return dP(this._angle)&&this._pivot},i._getConnectPoints=function(){return[this.getCenter()]},i._initOptions=function(e){var t=hP({},e),i=t.symbol,n=t.properties,r=t.id;delete t.symbol,delete t.id,delete t.properties,this.setOptions(t),i&&this.setSymbol(i),n&&this.setProperties(n),uP(r)||this.setId(r)},i._bindLayer=function(e){if(e!==this.getLayer()){if(this.getLayer())throw new Error("Geometry cannot be added to two or more layers at the same time.");this._layer=e,this._clearCache(),this._bindInfoWindow(),this._bindMenu()}},i._prepareSymbol=function(e){if(Array.isArray(e)){for(var t=[],i=0;i<e.length;i++)t.push(xk(this._checkAndCopySymbol(e[i])));return t}return e?xk(e=this._checkAndCopySymbol(e)):null},i._checkAndCopySymbol=function(e){var t={};for(var i in e)t[i]=aP[i]&&fP(e[i])?+e[i]:e[i];return t},i._getSymbol=function(){return this._symbol},i._setExternSymbol=function(e){return this._eventSymbolProperties=e,this._symbol||delete this._textDesc,this._externSymbol=this._prepareSymbol(e),this.onSymbolChanged(),this},i._getInternalSymbol=function(){return this._symbol?this._symbol:this._externSymbol?this._externSymbol:this.options.symbol?this.options.symbol:null},i._getPrjExtent=function(){var e=this._getProjection();return this._verifyProjection(),!this._extent&&e&&(this._extent=this._computePrjExtent(e)),this._extent},i._unbind=function(){var e=this.getLayer();e&&(this._animPlayer&&this._animPlayer.finish(),this._unbindMenu(),this._unbindInfoWindow(),this.isEditing()&&this.endEdit(),this._removePainter(),this.onRemove&&this.onRemove(),e.onRemoveGeometry&&e.onRemoveGeometry(this),delete this._layer,delete this._internalId,delete this._extent)},i._getInternalId=function(){return this._internalId},i._setInternalId=function(e){this._internalId=e},i._getMeasurer=function(){return this._getProjection()?this._getProjection():BO.getProjectionInstance(this.options.defaultProjection)},i._getProjection=function(){var e=this.getMap();return e?e.getProjection():null},i._verifyProjection=function(){var e=this._getProjection();this._projCode&&e&&this._projCode!==e.code&&this._clearProjection(),this._projCode=e?e.code:this._projCode},i._getExternalResources=function(){return vk(this._getInternalSymbol())},i._getPainter=function(){if(this._painter)return this._painter;var e=this.getLayer();if(!this._painter&&e)if(-1!==nP.indexOf(this.type)){if(e.constructor.getCollectionPainterClass){var t=e.constructor.getCollectionPainterClass();t&&(this._painter=new t(this))}}else if(e.constructor.getPainterClass){var i=e.constructor.getPainterClass();i&&(this._painter=new i(this))}return this._painter},i._getMaskPainter=function(){return this._maskPainter||(this._maskPainter=this.getGeometries&&this.getGeometries()?new zO(this,!0):new NO(this)),this._maskPainter},i._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter},i._paint=function(e){if(this._painter){if(this._dirtyCoords){delete this._dirtyCoords;var t=this._getProjection();t&&(this._pcenter=t.project(this._coordinates),this._clearCache())}this._painter.paint(e)}},i._clearCache=function(){delete this._extent,delete this._extent2d,this._clearAltitudeCache()},i._clearProjection=function(){delete this._extent,delete this._extent2d},i._repaint=function(){this._painter&&this._painter.repaint()},i.onHide=function(){this.closeMenu(),this.closeInfoWindow()},i.onShapeChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("shapechange")},i.onPositionChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("positionchange")},i.onSymbolChanged=function(){this._painter&&this._painter.refreshSymbol();var e={};this._eventSymbolProperties?(e.properties=JSON.parse(JSON.stringify(this._eventSymbolProperties)),delete this._eventSymbolProperties):delete this._textDesc,this._genSizeSymbol(),this._fireEvent("symbolchange",e)},i._genSizeSymbol=function(){var e=this._getInternalSymbol();if(e)if(Array.isArray(e)){this._sizeSymbol=[];for(var t=!1,i=0;i<e.length;i++){var n=this._sizeSymbol[i]=this._getSizeSymbol(e[i]);!t&&n&&n._dynamic&&(t=!0)}this._sizeSymbol._dynamic=t}else this._sizeSymbol=this._getSizeSymbol(e);else delete this._sizeSymbol},i._getSizeSymbol=function(e){var t=_k({lineWidth:e.lineWidth,lineDx:e.lineDx,lineDy:e.lineDy},this);return(YM(e.lineWidth)||YM(e.lineDx)||YM(e.lineDy))&&(t._dynamic=!0),t},i._getCompiledSymbol=function(){return this._compiledSymbol||(this._compiledSymbol=_k(this._getInternalSymbol(),this)),this._compiledSymbol},i.onConfig=function(e){var t;e.properties&&(t=e.properties,delete e.properties);var i=!1;for(var n in e)if(e.hasOwnProperty(n)){var r=n.slice(0,5);if("arrow"===r||"smoot"===r){i=!0;break}}t?(this.setProperties(t),this._repaint()):i&&this._repaint()},i._setParent=function(e){e&&(this._parent=e)},i._getParent=function(){return this._parent},i._fireEvent=function(e,t){this._silence||(this.getLayer()&&this.getLayer()._onGeometryEvent&&(t||(t={}),t.type=e,t.target=this,this.getLayer()._onGeometryEvent(t)),this.fire(e,t))},i._toJSON=function(e){return{feature:this.toGeoJSON(e)}},i._exportGraphicOptions=function(e){var t={};return(uP(e.options)||e.options)&&(t.options=this.config()),(uP(e.symbol)||e.symbol)&&(t.symbol=this.getSymbol()),(uP(e.infoWindow)||e.infoWindow)&&this._infoWinOptions&&(t.infoWindow=this._infoWinOptions),t},i._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),t=vI.toNumberArrays(e);return{type:this.getType(),coordinates:t}},i._exportProperties=function(){var e=null,t=this.getProperties();return uP(t)||(e=mP(t)?hP({},t):t),e},i._hitTestTolerance=function(){return 0},i._getAltitude=function(){var e=this.getLayer();if(!e)return 0;var t=e.options,i=e.getAltitude?e.getAltitude():0,n=t.enableAltitude;if(!n)return i;var r=qO(e),s=(this.properties||VO)[r];if(uP(s)){var o=HO(this,i,n);return uP(o)?i:o}return Array.isArray(s)?s.map((function(e){return e+i})):s+i},i.getAltitude=function(){var e=qO(this.getLayer()),t=(this.properties||VO)[e];if(!uP(t))return t;var i=HO(this,0,!1);return uP(i)?0:i},i.hasAltitude=function(){return!!this._getAltitude()},i.setAltitude=function(e){if(!dP(e))return this;var t=this.getLayer(),i=qO(t),n=this.properties||VO,r=n[i];if(!uP(r))if(Array.isArray(r))for(var s=0,o=r.length;s<o;s++)r[s]=e;else n[i]=e;var a=this.getCoordinates?this.getCoordinates():null;if(!a)return this;if(function e(t,i){if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e(t[n],i);else t.z=i}(a,e),t){var l=t.getRenderer();l&&l.gl?this.setCoordinates(a):l&&this._repaint()}return this._clearAltitudeCache(),this},i._genMinMaxAlt=function(){var e=this,t=this._getAltitude();Array.isArray(t)?(this._minAlt=Number.MAX_VALUE,this._maxAlt=Number.MIN_VALUE,t.forEach((function(t){var i=t;i<e._minAlt&&(e._minAlt=i),i>e._maxAlt&&(e._maxAlt=i)}))):this._minAlt=this._maxAlt=t},i.getMinAltitude=function(){return void 0===this._minAlt&&this._genMinMaxAlt(),this._minAlt?this._minAlt:0},i.getMaxAltitude=function(){return void 0===this._maxAlt&&this._genMinMaxAlt(),this._maxAlt?this._maxAlt:0},i._clearAltitudeCache=function(){return this._minAlt=void 0,this._maxAlt=void 0,this},t}(dI(nI(fI(sI))));function qO(e){var t="altitude";return e&&(t=e.options.altitudeProperty),t}function HO(e,t,i){var n=e.getCoordinates?e.getCoordinates():null;if(n){var r=[];if(function e(t,i){if(!i.length)if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e(t[n],i);else dP(t.z)&&i.push(t.z)}(n,r),r.length){var s=function e(t,i,n){if(Array.isArray(t)){for(var r=[],s=0,o=t.length;s<o;s++)r.push(e(t[s],i,n));return r}return dP(t.z)?n?i+t.z:t.z:n?i:0}(n,t,i);return e.getShell&&Array.isArray(s[0])?s[0][0]:s}}return null}function GO(e,t,i,n){return e===i?n>t?-90:90:(i-=e,n=-(n-=t),Math.atan2(n,i)/Math.PI*180)}UO.mergeOptions({id:null,visible:!0,interactive:!0,editable:!0,cursor:null,antiMeridian:!1,defaultProjection:"EPSG:4326"});var WO={attribution:null,minZoom:null,maxZoom:null,visible:!0,opacity:1,globalCompositeOperation:null,renderer:"canvas",debugOutline:"#0f0",cssFilter:null,forceRenderOnMoving:!1,forceRenderOnZooming:!1,forceRenderOnRotating:!1,collision:!1,collisionScope:"layer",hitDetect:!QP.mobile},ZO=function(e){function t(t,i){var n,r;return i&&(r=i.canvas,delete i.canvas),(n=e.call(this,i)||this)._canvas=r,n.setId(t),i&&(n.setZIndex(i.zIndex),i.mask&&n.setMask(UO.fromJSON(i.mask))),n.proxyOptions(),n}tM(t,e);var i=t.prototype;return i.load=function(){if(!this.getMap())return this;if(this.onLoad()){this._initRenderer();var e=this.getZIndex();uP(e)||(this._renderer.setZIndex(e),this.isCanvasRender()||this._renderer.render()),this.onLoadEnd()}return this},i.getId=function(){return this._id},i.setId=function(e){var t=this._id;return uP(e)||(e+=""),this._id=e,this.fire("idchange",{old:t,new:e}),this},i.addTo=function(e){return e.addLayer(this),this},i.setZIndex=function(e){return this._zIndex=e,uP(e)?delete this.options.zIndex:this.options.zIndex=e,this.map&&this.map._sortLayersByZIndex(),this._renderer&&this._renderer.setZIndex(e),this.fire("setzindex",{zIndex:e}),this},i.getZIndex=function(){return this._zIndex||0},i.getMinZoom=function(){var e=this.getMap(),t=this.options.minZoom;return e?Math.max(e.getMinZoom(),t||0):t},i.getMaxZoom=function(){var e=this.getMap(),t=this.options.maxZoom;return e?Math.min(e.getMaxZoom(),uP(t)?1/0:t):t},i.getOpacity=function(){return this.options.opacity},i.setOpacity=function(e){return this.config("opacity",e),this.fire("setopacity",{opacity:e}),this},i.isCanvasRender=function(){var e=this._getRenderer();return e&&e instanceof bR},i.getMap=function(){return this.map?this.map:null},i.getProjection=function(){var e=this.getMap();return e?e.getProjection():null},i.bringToFront=function(){var e=this._getLayerList();if(!e.length)return this;var t=e[e.length-1];if(1===e.length||t===this)return this;var i=t.getZIndex();return this.setZIndex(i+1),this},i.bringToBack=function(){var e=this._getLayerList();if(!e.length)return this;var t=e[0];if(1===e.length||t===this)return this;var i=t.getZIndex();return this.setZIndex(i-1),this},i.show=function(){var e=this;if(!this.options.visible){this.options.visible=!0;var t=this.getRenderer();t&&t.show();var i=this.getMap();t&&i?i.once("renderend",(function(){e.fire("show")})):this.fire("show")}return this},i.hide=function(){var e=this;if(this.options.visible){this.options.visible=!1;var t=this.getRenderer();t&&t.hide();var i=this.getMap();t&&i?i.once("renderend",(function(){e.fire("hide")})):this.fire("hide")}return this},i.isVisible=function(){if(dP(this.options.opacity)&&this.options.opacity<=0)return!1;var e=this.getMap();if(e){var t=e.getZoom();if(!uP(this.options.maxZoom)&&this.options.maxZoom<t||!uP(this.options.minZoom)&&this.options.minZoom>t)return!1}return uP(this.options.visible)&&(this.options.visible=!0),this.options.visible},i.remove=function(){if(this.map){var e=this.map.getRenderer();this.map.removeLayer(this),e&&e.setToRedraw()}else this.fire("remove");return this},i.getMask=function(){return this._mask},i.setMask=function(e){if(!("Point"===e.type&&e._isVectorMarker()||"Polygon"===e.type||"MultiPolygon"===e.type))throw new Error("Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).");if(e._bindLayer(this),"Point"===e.type?e.updateSymbol({markerLineColor:"rgba(0, 0, 0, 0)",markerFillOpacity:0}):e.setSymbol({lineColor:"rgba(0, 0, 0, 0)",polygonOpacity:0}),this._mask=e,this.options.mask=e.toJSON(),!this.getMap()||this.getMap().isZooming())return this;var t=this._getRenderer();return t&&t.setToRedraw&&this._getRenderer().setToRedraw(),this},i.removeMask=function(){if(delete this._mask,delete this.options.mask,!this.getMap()||this.getMap().isZooming())return this;var e=this._getRenderer();return e&&e.setToRedraw&&this._getRenderer().setToRedraw(),this},i.onLoad=function(){return!0},i.onLoadEnd=function(){},i.isLoaded=function(){return!!this._loaded},i.getCollisionIndex=function(){if("layer"===this.options.collisionScope)return this._collisionIndex||(this._collisionIndex=new mI),this._collisionIndex;var e=this.getMap();return e?e.getCollisionIndex():null},i.clearCollisionIndex=function(){return"layer"===this.options.collisionScope&&this._collisionIndex&&this._collisionIndex.clear(),this},i.getRenderer=function(){return this._getRenderer()},i.onConfig=function(e){if(e&&Object.keys&&Object.keys(e).length>0&&uP(e.animation)){if(this._optionsHook&&gP(this._optionsHook)&&this._optionsHook(e),this._silentConfig)return;var t=this.getRenderer();t&&t.setToRedraw&&t.setToRedraw()}},i.onAdd=function(){},i.onRendererCreate=function(){},i.onCanvasCreate=function(){},i.onRemove=function(){},i._bindMap=function(e,t){e&&(this.map=e,uP(t)||this.setZIndex(t),this._switchEvents("on",this),this.onAdd(),this.fire("add"))},i._initRenderer=function(){var e=this.options.renderer;if(this.constructor.getRendererClass){var t=this.constructor.getRendererClass(e);if(!t)throw new Error("Invalid renderer for Layer("+this.getId()+"):"+e);this._renderer=new t(this),this._renderer.layer=this,this._renderer.setZIndex(this.getZIndex()),this._switchEvents("on",this._renderer),this._renderer.onAdd&&this._renderer.onAdd(),this.onRendererCreate(),this.fire("renderercreate",{renderer:this._renderer})}},i._doRemove=function(){this._loaded=!1,this._switchEvents("off",this),this.onRemove(),this._renderer&&(this._switchEvents("off",this._renderer),this._renderer.remove(),delete this._renderer),delete this.map,delete this._collisionIndex},i._switchEvents=function(e,t){t&&t.getEvents&&this.getMap()&&this.getMap()[e](t.getEvents(),t)},i._getRenderer=function(){return this._renderer},i._getLayerList=function(){return this.map?this.map._layers:[]},i._getMask2DExtent=function(){if(!this._mask||!this.getMap())return null;var e=this._mask._getMaskPainter();return e?e.get2DExtent():null},t}(dI(nI(fR(sI))));ZO.mergeOptions(WO);var $O=ZO.prototype.fire;ZO.prototype.fire=function(e,t){return"layerload"===e&&(this._loaded=!0),this.map&&(t||(t={}),t.type=e,t.target=this,this.map._onLayerEvent(t)),$O.apply(this,arguments),["show","hide"].indexOf(e)>-1&&this.fire("visiblechange",Object.assign({},t,{visible:this.options.visible})),this};var XO,KO,YO,JO,QO,eN,tN,iN,nN,rN=new vI(0,0),sN=new uM(0,0),oN=["centerCross","fog","fogColor","debugSky"],aN={maxVisualPitch:70,maxPitch:80,centerCross:!1,zoomInCenter:!1,zoomOrigin:null,zoomAnimation:!wP,zoomAnimationDuration:330,panAnimation:!wP,panAnimationDuration:600,rotateAnimation:!wP,zoomable:!0,enableInfoWindow:!0,hitDetect:!QP.mobile,hitDetectLimit:5,fpsOnInteracting:25,layerCanvasLimitOnInteracting:-1,maxZoom:null,minZoom:null,maxExtent:null,fixCenterOnResize:!0,checkSize:!0,checkSizeInterval:1e3,renderer:"canvas",cascadePitches:[10,60],renderable:!0,clickTimeThreshold:280,stopRenderOnOffscreen:!0,preventWheelScroll:!0,preventTouch:!0,supportPluginEvent:!0,switchDragButton:!1,mousemoveThrottleTime:48},lN=function(e){function t(i,n){var r;if(!n)throw new Error("Invalid options when creating map.");if(!n.center)throw new Error("Invalid center when creating map.");var s=hP({},n),o=s.zoom;delete s.zoom;var a=new vI(s.center);delete s.center;var l=s.baseLayer;delete s.baseLayer;var c=s.layers;return delete s.layers,(r=e.call(this,s)||this).VERSION=t.VERSION,Object.defineProperty(aM(aM(r)),"id",{value:fM(),writable:!1}),r._loaded=!1,r._initContainer(i),r._panels={},r._baseLayer=null,r._layers=[],r._zoomLevel=o,r._center=a,r.setSpatialReference(s.spatialReference||s.view),r._mapViewPoint=new uM(0,0),r._initRenderer(),r._updateMapSize(r._getContainerDomSize()),l&&r.setBaseLayer(l),c&&r.addLayer(c),r.setMaxExtent(s.maxExtent),r._Load(),r.proxyOptions(),r.isMap=!0,r}tM(t,e),t.addOnLoadHook=function(e){var t=Array.prototype.slice.call(arguments,1),i="function"==typeof e?e:function(){this[e].apply(this,t)};return this.prototype._onLoadHooks=this.prototype._onLoadHooks||[],this.prototype._onLoadHooks.push(i),this};var i=t.prototype;return i.isLoaded=function(){return!!this._loaded},i.getContainer=function(){return this._containerDOM},i.getSpatialReference=function(){return this._spatialReference},i.setSpatialReference=function(e){var t=this.options.spatialReference;return this._loaded&&BO.equals(t,e)||this._updateSpatialReference(e,t),this},i._updateSpatialReference=function(e,t){fP(e)&&(e=BO.getPreset(e)),e=hP({},e),this._center=this.getCenter(),this.options.spatialReference=e,this._spatialReference=new BO(e);var i=this._spatialReference.getProjection();return this.options.spatialReference&&gP(this.options.spatialReference.projection)&&(this.options.spatialReference.projection=i.code),this._resetMapStatus(),cR.is(i.code)&&(this._originLng=i.centralMeridian,this._altitudeOriginDirty=!0),this._fireEvent("spatialreferencechange",{old:t,new:hP({},this.options.spatialReference)}),this},i.onConfig=function(e){var t=e.spatialReference||e.view;uP(t)||this._updateSpatialReference(t,null);for(var i=!1,n=0,r=oN.length;n<r;n++)if(!uP(e[oN[n]])){i=!0;break}if(!i)return this;var s=this.getRenderer();return s&&s.setToRedraw(),this},i.getProjection=function(){return this._spatialReference?this._spatialReference.getProjection():null},i.getFullExtent=function(){return this._spatialReference?this._spatialReference.getFullExtent():null},i.setCursor=function(e){return delete this._cursor,this._trySetCursor(e),this._cursor=e,this},i.resetCursor=function(){return this.setCursor(null)},i.getCenter=function(){if(!this._loaded||!this._prjCenter)return this._center;var e=this.getProjection().unproject(this._prjCenter);return e.x=Math.round(1e8*e.x)/1e8,e.y=Math.round(1e8*e.y)/1e8,this.centerAltitude&&(e.z=this.centerAltitude),e},i.setCenter=function(e,t){if(!e)return this;e=new vI(e),t&&(e=this._getCenterByPadding(e,this.getZoom(),t));var i=this.getProjection().project(e);return this._verifyExtent(i)?this._loaded?(this.onMoveStart(),this._setPrjCenter(i),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this):(this._center=e,this):this},i.getSize=function(){return uP(this.width)||uP(this.height)?this._getContainerDomSize():new wk(this.width,this.height)},i.getContainerExtent=function(){var e=this.height,t=this.getPitch(),i=this.options.maxVisualPitch;return i&&t>i&&(e=this._getVisualHeight(i)),new DI(0,this.height-e,this.width,this.height)},i._getVisualHeight=function(e){e=e||.01;var t=(90-this.getPitch())*Math.PI/180,i=this.getFov()*Math.PI/180;e*=Math.PI/180;var n=this.cameraCenterDistance/this.getGLScale(),r=Math.tan(i/2),s=n*r/(1/Math.tan(e)-r)/Math.sin(e),o=n*(Math.sin(t)*s/(n+Math.cos(t)*s));return this.height/2+o},i.getExtent=function(){return this._pointToExtent(this._get2DExtent())},i.getProjExtent=function(){var e=this._get2DExtent();return new OI(this._pointToPrj(e.getMin()),this._pointToPrj(e.getMax()))},i.getPrjExtent=function(){return this.getProjExtent()},i.getMaxExtent=function(){return this.options.maxExtent?new OI(this.options.maxExtent,this.getProjection()):null},i.setMaxExtent=function(e){if(e){var t=new OI(e,this.getProjection());this.options.maxExtent=t;var i=this.getProjection();this._prjMaxExtent=t.convertTo((function(e){return i.project(e)})),this._verifyExtent(this._getPrjCenter())||(this._loaded?this._panTo(this._prjMaxExtent.getCenter()):this._center=i.unproject(this._prjMaxExtent.getCenter()))}else delete this.options.maxExtent,delete this._prjMaxExtent;return this},i.getZoom=function(){return this._zoomLevel},i.getZoomForScale=function(e,t,i){var n=this.getZoom();if(uP(t)&&(t=n),1===e&&t===n)return n;var r=this._getResolution(t),s=this.getZoomFromRes(r/e);return i?s:this.getSpatialReference().getZoomDirection()<0?Math.ceil(s-1e-6):Math.floor(s+1e-6)},i.getZoomFromRes=function(e){var t=this._getResolutions(),i=this._getResolution(this.getMinZoom()),n=this._getResolution(this.getMaxZoom());if(i<=n){if(e<=i)return this.getMinZoom();if(e>=n)return this.getMaxZoom()}else{if(e>=i)return this.getMinZoom();if(e<=n)return this.getMaxZoom()}for(var r=t.length,s=0;s<r-1;s++)if(t[s]){var o=t[s+1]-t[s],a=e-t[s];if(bM(o)===bM(a)&&Math.abs(o)>=Math.abs(a))return s+a/o}return r-1},i.setZoom=function(e,t){return void 0===t&&(t={animation:!0}),isNaN(e)||uP(e)||(e=+e,this._loaded&&this.options.zoomAnimation&&t.animation?this._zoomAnimation(e):this._zoom(e)),this},i.getMaxZoom=function(){return uP(this.options.maxZoom)?this.getMaxNativeZoom():this.options.maxZoom},i.setMaxZoom=function(e){var t=this.getMaxNativeZoom();return e>t&&(e=t),null!==e&&e<this._zoomLevel&&(this.setZoom(e),e=+e),this.options.maxZoom=e,this},i.getMinZoom=function(){return uP(this.options.minZoom)?this._spatialReference.getMinZoom():this.options.minZoom},i.setMinZoom=function(e){if(null!==e){e=+e;var t=this._spatialReference.getMinZoom();e<t&&(e=t),e>this._zoomLevel&&this.setZoom(e)}return this.options.minZoom=e,this},i.getMaxNativeZoom=function(){var e=this.getSpatialReference();return e?e.getMaxZoom():null},i.getGLRes=function(){if(this._glRes)return this._glRes;var e=this.getSpatialReference().getFullExtent();return this._glRes=(e.right-e.left)/Math.pow(2,19),this._glRes},i.getGLScale=function(e){return uP(e)&&(e=this.getZoom()),this._getResolution(e)/this.getGLRes()},i.zoomIn=function(){return this.setZoom(this.getZoom()+1)},i.zoomOut=function(){return this.setZoom(this.getZoom()-1)},i.isZooming=function(){return!!this._zooming},i.isInteracting=function(){return this.isZooming()||this.isMoving()||this.isRotating()},i.setCenterAndZoom=function(e,t){return uP(t)||this._zoomLevel===t?this.setCenter(e):(this.setCenter(e),this.setZoom(t,{animation:!1})),this},i._getPaddingSize=function(e){return void 0===e&&(e={}),e.paddingLeft||e.paddingTop||e.paddingRight||e.paddingBottom?{width:(e.paddingLeft||0)+(e.paddingRight||0),height:(e.paddingTop||0)+(e.paddingBottom||0)}:null},i.getFitZoom=function(e,t,i){var n=this;if(!(e&&e instanceof OI))return this._zoomLevel;if(e.xmin===e.xmax&&e.ymin===e.ymax)return this.getMaxZoom();var r=this.getSize(),s=this._getPaddingSize(i);s&&(r={width:r.width-(s.width||0),height:r.height-(s.height||0)});var o=e.convertTo((function(e){return n.coordToPoint(e)})),a=o.getWidth(),l=o.getHeight(),c=r.width/a,h=r.height/l,u=this.getSpatialReference().getZoomDirection()<0?Math.max(c,h):Math.min(c,h);return this.getZoomForScale(u,null,t)},i.getView=function(){return{center:this.getCenter().toArray(),zoom:this.getZoom(),pitch:this.getPitch(),bearing:this.getBearing()}},i.setView=function(e){return e?(e.center&&this.setCenter(e.center),null===e.zoom||isNaN(+e.zoom)||this.setZoom(+e.zoom,{animation:!1}),null===e.pitch||isNaN(+e.pitch)||this.setPitch(+e.pitch),null===e.pitch||isNaN(+e.bearing)||this.setBearing(+e.bearing),this):this},i.getResolution=function(e){return this._getResolution(e)},i.getScale=function(e){var t=uP(e)?this.getZoom():e,i=this._getResolution(this.getMaxNativeZoom());return this._getResolution(t)/i},i._getCenterByPadding=function(e,t,i){void 0===i&&(i={});var n=this.coordinateToPoint(e,t),r=i.paddingLeft,s=void 0===r?0:r,o=i.paddingRight,a=void 0===o?0:o,l=i.paddingTop,c=void 0===l?0:l,h=i.paddingBottom,u=void 0===h?0:h,d=0,p=0;(s||a)&&(d=(a-s)/2),(c||u)&&(p=(c-u)/2);var m=new uM({x:n.x+d,y:n.y+p});return this.pointToCoordinate(m,t)},i.fitExtent=function(e,t,i,n){if(void 0===i&&(i={}),!e)return this;e=new OI(e,this.getProjection());var r=this.getFitZoom(e,i.isFraction||!1,i)+(t||0),s=e.getCenter();return this._getPaddingSize(i)&&(s=this._getCenterByPadding(s,r,i)),void 0===i.animation||i.animation?this._animateTo({center:s,zoom:r},{duration:i.duration||this.options.zoomAnimationDuration,easing:i.easing||"out"},n):this.setCenterAndZoom(s,r)},i.getBaseLayer=function(){return this._baseLayer},i.setBaseLayer=function(e){var t=!1;return this._baseLayer&&(t=!0,this._fireEvent("baselayerchangestart"),this._baseLayer.remove()),e?(this._baseLayer=e,e._bindMap(this,-1),this._baseLayer.on("layerload",(function(){this._fireEvent("baselayerload"),t&&(t=!1,this._fireEvent("baselayerchangeend"))}),this),this._loaded&&this._baseLayer.load(),this._fireEvent("setbaselayer"),this):(delete this._baseLayer,this._fireEvent("baselayerchangeend"),this._fireEvent("setbaselayer"),this)},i.removeBaseLayer=function(){return this._baseLayer&&(this._baseLayer.remove(),delete this._baseLayer,this._fireEvent("baselayerremove")),this},i.getLayers=function(e){return this._getLayers((function(t){return!(t===this._baseLayer||t.getId().indexOf("_maptalks__internal_layer_")>=0)&&(!e||e(t))}))},i.getLayer=function(e){if(!e)return null;var t=this._layerCache?this._layerCache[e]:null;if(t)return t;var i=this.getBaseLayer();return i&&i.getId()===e?i:null},i.addLayer=function(e){if(!e)return this;if(!Array.isArray(e))return e=Array.prototype.slice.call(arguments,0),this.addLayer(e);this._layerCache||(this._layerCache={});for(var t=this._layers,i=0,n=e.length;i<n;i++){var r=e[i],s=r.getId();if(uP(s))throw new Error("Invalid id for the layer: "+s);if(r.getMap()!==this){if(this._layerCache[s])throw new Error("Duplicate layer id in the map: "+s);this._layerCache[s]=r,r._bindMap(this),t.push(r),this._loaded&&r.load()}}return this._sortLayersByZIndex(),this._fireEvent("addlayer",{layers:e}),this},i.removeLayer=function(e){if(!e)return this;if(!Array.isArray(e))return this.removeLayer([e]);for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];if(r instanceof ZO||(r=this.getLayer(r)),r){var s=r.getMap();if(s&&s===this){t.push(r),this._removeLayer(r,this._layers),this._loaded&&r._doRemove();var o=r.getId();this._layerCache&&delete this._layerCache[o]}}}if(t.length>0){var a=this.getRenderer();a&&a.setLayerCanvasUpdated(),this.once("frameend",(function(){t.forEach((function(e){e.fire("remove")}))}))}return this._fireEvent("removelayer",{layers:e}),this},i.sortLayers=function(e){if(!e||!Array.isArray(e))return this;for(var t=[],i=Number.MAX_VALUE,n=0,r=e.length;n<r;n++){var s=e[n];if(fP(e[n])&&(s=this.getLayer(s)),!(s instanceof ZO&&s.getMap()&&s.getMap()===this))throw new Error("It must be a layer added to this map to order.");s.getZIndex()<i&&(i=s.getZIndex()),t.push(s)}for(var o=0,a=t.length;o<a;o++)t[o].setZIndex(i+o);return this},i.toDataURL=function(e){e||(e={});var t=e.mimeType;t||(t="image/png");var i=e.save,n=this._getRenderer();if(n&&n.toDataURL){var r=e.fileName;r||(r="export");var s=n.toDataURL(t,e.quality||.92);if(i&&s){var o;if("undefined"!=typeof Blob&&"undefined"!=typeof atob){var a=function(e,t){for(var i=atob(e),n=new ArrayBuffer(i.length),r=new Uint8Array(n),s=0;s<i.length;s++)r[s]=255&i.charCodeAt(s);return new Blob([n],{type:t})}(s.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,""),t);o=URL.createObjectURL(a)}else o=s;var l=document.createElement("a");l.download=r,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l)}return s}return null},i.coordToPoint=function(e,t,i){return this.coordinateToPoint(e,t,i)},i.coordToPointAtRes=function(e,t,i){return this.coordinateToPointAtRes(e,t,i)},i.pointToCoord=function(e,t,i){return this.pointToCoordinate(e,t,i)},i.pointAtResToCoord=function(e,t,i){return this.pointAtResToCoordinate(e,t,i)},i.coordToViewPoint=function(e,t,i){return this.coordinateToViewPoint(e,t,i)},i.viewPointToCoord=function(e,t){return this.viewPointToCoordinate(e,t)},i.coordToContainerPoint=function(e,t,i){return this.coordinateToContainerPoint(e,t,i)},i.containerPointToCoord=function(e,t){return this.containerPointToCoordinate(e,t)},i.containerPointToViewPoint=function(e,t){return t?t.set(e.x,e.y):t=e.copy(),t._sub(this.getViewPoint())},i.viewPointToContainerPoint=function(e,t){return t?t.set(e.x,e.y):t=e.copy(),t._add(this.getViewPoint())},i.checkSize=function(e){var t=cP()-this._initTime<1500&&0===this.width||0===this.height,i=this._getContainerDomSize(),n=this.height,r=this.width;if(!e&&i.width===r&&i.height===n)return this;rA(this._containerDOM);var s=this.getCenter();if(this.options.fixCenterOnResize)this._updateMapSize(i);else{var o=this._getVisualHeight(this.getPitch()),a=new uM(0,this.height-o),l=this._containerPointToPrj(a);this._updateMapSize(i);var c=this._getVisualHeight(this.getPitch()),h=new uM(0,this.height-c);this._setPrjCoordAtContainerPoint(l,h),this._mapViewCoord=this._getPrjCenter()}return(t||0===i.width||0===i.height||0===r||0===n)&&(this._eventSilence=!0,this.setCenter(s),delete this._eventSilence),this._fireEvent("resize"),this},i.locate=function(e,t,i){return this.getProjection()._locate(new vI(e),t,i)},i.getMainPanel=function(){return this._getRenderer().getMainPanel()},i.getPanels=function(){return this._panels},i.remove=function(){var e=this;if(this.isRemoved())return this;this._fireEvent("removestart"),this._removeDomEvents(),this._clearHandlers(),this.removeBaseLayer();for(var t=this.getLayers(),i=0;i<t.length;i++)t[i].remove();return this._getRenderer()&&this._getRenderer().remove(),this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&Array.prototype.slice.call(this._containerDOM.childNodes,0).filter((function(e){return"maptalks-wrapper"===e.className})).forEach((function(t){return e._containerDOM.removeChild(t)})),delete this._panels,delete this._containerDOM,delete this.renderer,this._fireEvent("removeend"),this._clearAllListeners(),this},i.isRemoved=function(){return!this._containerDOM},i.isMoving=function(){return!!this._moving},i.onMoveStart=function(e){this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer);var t=this._getPrjCenter();this._originCenter&&!this._verifyExtent(t)||(this._originCenter=t),this._moving=!0,this._trySetCursor("move"),this._fireEvent("movestart",this._parseEvent(e?e.domEvent:null,"movestart"))},i.onMoving=function(e){this._fireEvent("moving",this._parseEvent(e?e.domEvent:null,"moving"))},i.onMoveEnd=function(e){this._moving=!1,this._suppressRecenter||this._recenterOnTerrain(),this._trySetCursor("default"),this._fireEvent("moveend",e&&e.domEvent?this._parseEvent(e.domEvent,"moveend"):e),!this._verifyExtent(this._getPrjCenter())&&this._originCenter&&this._panTo(this._originCenter)},i.onDragRotateStart=function(e){this._dragRotating=!0,this._fireEvent("dragrotatestart",this._parseEvent(e?e.domEvent:null,"dragrotatestart"))},i.onDragRotating=function(e){this._fireEvent("dragrotating",this._parseEvent(e?e.domEvent:null,"dragrotating"))},i.onDragRotateEnd=function(e){this._dragRotating=!1,this._fireEvent("dragrotateend",this._parseEvent(e?e.domEvent:null,"dragrotateend"))},i.isDragRotating=function(){return!!this._dragRotating},i.isOffscreen=function(e,t){void 0===t&&(t=0);var i=this.width+t,n=this.height+t,r=e.xmin,s=e.ymin,o=e.xmax,a=e.ymax;return Array.isArray(e)&&(r=e[0],s=e[1],o=e[2],a=e[3]),o<t||r>=i||a<t||s>n},i.getRenderer=function(){return this._getRenderer()},i.getDevicePixelRatio=function(){return this.options.devicePixelRatio||QP.devicePixelRatio||1},i.setDevicePixelRatio=function(e){return dP(e)&&e>0&&e!==this.options.devicePixelRatio&&(this.options.devicePixelRatio=e,this.checkSize(!0)),this},i._initContainer=function(e){if(fP(e)){if(this._containerDOM=document.getElementById(e),!this._containerDOM)throw new Error("Invalid container when creating map: '"+e+"'")}else this._containerDOM=e,wP&&(this.CanvasClass=this._containerDOM.constructor);if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&"maptalks-wrapper"===this._containerDOM.childNodes[0].className)throw new Error("Container is already loaded with another map instance, use map.remove() to clear it.")},i._trySetCursor=function(e){return this._cursor||this._priorityCursor||(e||(e="default"),this._setCursorToPanel(e)),this},i._setPriorityCursor=function(e){if(e)this._priorityCursor=e,this._setCursorToPanel(e);else{var t=!1;this._priorityCursor&&(t=!0),delete this._priorityCursor,t&&this.setCursor(this._cursor)}return this},i._setCursorToPanel=function(e){var t=this.getMainPanel();t&&t.style&&t.style.cursor!==e&&(t.style.cursor=e)},i._removeLayer=function(e,t){if(e&&t){var i=t.indexOf(e);i>-1&&t.splice(i,1)}},i._sortLayersByZIndex=function(){if(this._layers){for(var e=0,t=this._layers.length;e<t;e++)this._layers[e]._order=e,this._layers[e].sortLayersByZIndex&&this._layers[e].sortLayersByZIndex();this._layers.sort((function(e,t){var i=e.getZIndex()-t.getZIndex();return 0===i?e._order-t._order:i}))}},i._fireEvent=function(e,t){this._eventSilence||("_"!==e[0]&&this.fire("_"+e,t),this.fire(e,t))},i._Load=function(){this._resetMapStatus(),this.options.pitch&&(this.setPitch(this.options.pitch),delete this.options.pitch),this.options.bearing&&(this.setBearing(this.options.bearing),delete this.options.bearing),delete this._glRes,this._loadAllLayers(),this._getRenderer().onLoad(),this._loaded=!0,this._callOnLoadHooks(),this._initTime=cP()},i._initRenderer=function(){var e=t.getRendererClass(this.options.renderer);this._renderer=new e(this),this._renderer.load()},i._getRenderer=function(){return this._renderer},i._loadAllLayers=function(){this._baseLayer&&this._baseLayer.load(),this._eachLayer((function(e){e&&e.load()}),this.getLayers())},i._getLayers=function(e){for(var t=this._baseLayer?[this._baseLayer].concat(this._layers):this._layers,i=[],n=0;n<t.length;n++)e&&!e.call(this,t[n])||i.push(t[n]);return i},i._eachLayer=function(e){if(!(arguments.length<2)){var t=Array.prototype.slice.call(arguments,1);t&&!Array.isArray(t)&&(t=[t]);for(var i=[],n=0,r=t.length;n<r;n++)i=i.concat(t[n]);for(var s=0,o=i.length;s<o;s++)e.call(e,i[s])}},i._onLayerEvent=function(e){e&&"idchange"===e.type&&(delete this._layerCache[e.old],this._layerCache[e.new]=e.target)},i._resetMapStatus=function(){var e=this.getMaxZoom(),t=this.getMinZoom(),i=this._spatialReference.getMaxZoom(),n=this._spatialReference.getMinZoom();(uP(e)||-1===e||e>i)&&this.setMaxZoom(i),(uP(t)||-1===t||t<n)&&this.setMinZoom(n),(e=this.getMaxZoom())<(t=this.getMinZoom())&&this.setMaxZoom(t),(uP(this._zoomLevel)||this._zoomLevel>e)&&(this._zoomLevel=e),this._zoomLevel<t&&(this._zoomLevel=t),delete this._prjCenter,delete this._glRes;var r=this.getProjection();this._prjCenter=r.project(this._center),this._calcMatrices();var s=this._getRenderer();s&&s.resetContainer()},i._getContainerDomSize=function(){if(!this._containerDOM)return null;var e,t,i=this._containerDOM;if(this._containerDomContentRect)return new wk(e=this._containerDomContentRect.width,t=this._containerDomContentRect.height);if(uP(i.width)||uP(i.height)){if(uP(i.clientWidth)||uP(i.clientHeight))throw new Error("can not get size of container");e=parseInt(i.clientWidth,0),t=parseInt(i.clientHeight,0)}else{e=i.width,t=i.height;var n=this.getDevicePixelRatio();1!==n&&i.layer&&(e/=n,t/=n)}return new wk(e,t)},i._updateMapSize=function(e){return this.width=e.width,this.height=e.height,this._getRenderer().updateMapSize(e),this._calcMatrices(),this},i._getPrjCenter=function(){return this._prjCenter},i._setPrjCenter=function(e){this._prjCenter=e,this.isInteracting()&&!this.isMoving()&&(this._mapViewCoord=e),this._calcMatrices()},i._setPrjCoordAtContainerPoint=function(e,t){if(!this.centerAltitude&&t.x===this.width/2&&t.y===this.height/2)return this;var i=this._containerPointToPoint(t)._sub(this._prjToPoint(this._getPrjCenter())),n=this._pointToPrj(this._prjToPoint(e).sub(i));return this._setPrjCenter(n),this},i._verifyExtent=function(e){if(!e)return!1;var t=this._prjMaxExtent;return!t||t.contains(e)},i._offsetCenterByPixel=function(e){var t=sN.set(this.width/2-e.x,this.height/2-e.y),i=this._containerPointToPrj(t,rN),n=sN.set(this.width/2,this.height/2);this._setPrjCoordAtContainerPoint(i,n)},i.offsetPlatform=function(e){return e?(this._getRenderer().offsetPlatform(e),this._mapViewCoord=this._getPrjCenter(),this._mapViewPoint=this._mapViewPoint.add(e),this):this._mapViewPoint},i.getViewPoint=function(){var e=this._getViewPointFrameOffset(),t=this.offsetPlatform();return e&&(t=t.add(e)),t},i._resetMapViewPoint=function(){this._mapViewPoint=new uM(0,0),this._mapViewCoord=this._getPrjCenter()},i._getResolution=function(e){return void 0!==e&&e!==this._zoomLevel||void 0===this._mapRes?(uP(e)&&(e=this._zoomLevel),this._spatialReference.getResolution(e)):this._mapRes},i._getResolutions=function(){return this._spatialReference.getResolutions()},i._prjToPoint=function(e,t,i){t=uP(t)?this.getZoom():t;var n=this._getResolution(t);return this._prjToPointAtRes(e,n,i)},i._prjToPointAtRes=function(e,t,i){return this._spatialReference.getTransformation().transform(e,t,i)},i._prjsToPointsAtRes=function(e,t,i){void 0===i&&(i=[]);for(var n=this._spatialReference.getTransformation(),r=[],s=0,o=e.length;s<o;s++){var a=n.transform(e[s],t,i[s]);r.push(a)}return r},i._pointToPrj=function(e,t,i){t=uP(t)?this.getZoom():t;var n=this._getResolution(t);return this._pointToPrjAtRes(e,n,i)},i._pointToPrjAtRes=function(e,t,i){return this._spatialReference.getTransformation().untransform(e,t,i)},i._pointToPoint=function(e,t,i){return uP(t)?(i?(i.x=e.x,i.y=e.y):i=e.copy(),i):this._pointAtResToPoint(e,this._getResolution(t),i)},i._pointAtResToPoint=function(e,t,i){return i?(i.x=e.x,i.y=e.y):i=e.copy(),i._multi(t/this._getResolution())},i._pointToPointAtRes=function(e,t,i){return i?(i.x=e.x,i.y=e.y):i=e.copy(),i._multi(this._getResolution()/t)},i._containerPointToPrj=function(e,t){return this._pointToPrj(this._containerPointToPoint(e,void 0,t),void 0,t)},i._callOnLoadHooks=function(){var e=t.prototype;if(e._onLoadHooks)for(var i=0,n=e._onLoadHooks.length;i<n;i++)e._onLoadHooks[i].call(this)},i._fixPrjOnWorldWide=function(e){var t=this.getProjection();if(t&&t.fullExtent&&e){var i=t.fullExtent||{},n=i.left,r=i.bottom,s=i.top,o=i.right;dP(n)&&(e.x=Math.max(n,e.x)),dP(o)&&(e.x=Math.min(o,e.x)),dP(r)&&(e.y=Math.max(r,e.y)),dP(s)&&(e.y=Math.min(s,e.y))}return this},t}(fI(nI(fR(sI))));lN.include({coordinateToPoint:function(e,t,i){var n=this._getResolution(t);return this.coordinateToPointAtRes(e,n,i)},coordinateToPointAtRes:(nN=new vI(0,0),function(e,t,i){var n=this.getProjection().project(e,nN);return this._prjToPointAtRes(n,t,i)}),pointToCoordinate:function(){var e=new vI(0,0);return function(t,i,n){var r=this._pointToPrj(t,i,e);return this.getProjection().unproject(r,n)}}(),pointAtResToCoordinate:function(){var e=new vI(0,0);return function(t,i,n){var r=this._pointToPrjAtRes(t,i,e);return this.getProjection().unproject(r,n)}}(),coordinateToViewPoint:function(){var e=new vI(0,0);return function(t,i,n){return this._prjToViewPoint(this.getProjection().project(t,e),i,n)}}(),viewPointToCoordinate:function(){var e=new vI(0,0);return function(t,i){return this.getProjection().unproject(this._viewPointToPrj(t,e),i)}}(),coordinateToContainerPoint:function(e,t,i){var n=this._getResolution(t);return this.coordinateToContainerPointAtRes(e,n,i)},coordinateToContainerPointAtRes:function(){var e=new vI(0,0);return function(t,i,n){var r=this.getProjection().project(t,e);return this._prjToContainerPointAtRes(r,i,n)}}(),coordinatesToContainerPoints:function(e,t){var i=this._getResolution(t);return this.coordinatesToContainerPointsAtRes(e,i)},coordinatesToContainerPointsAtRes:function(e,t){for(var i=[],n=this._spatialReference.getTransformation(),r=t/this._getResolution(),s=this.getProjection(),o=new vI(0,0),a=this.isTransforming(),l=this._prjToPoint(this._getPrjCenter(),void 0,rN),c=0,h=e.length;c<h;c++){var u=s.project(e[c],o),d=n.transform(u,t);d=d._multi(r),this._toContainerPoint(d,a,e[c].z,l),i.push(d)}return i},containerPointToCoordinate:function(){var e=new vI(0,0);return function(t,i){var n=this._containerPointToPrj(t,e);return this.getProjection().unproject(n,i)}}(),containerToExtent:(tN=new uM(0,0),iN=new uM(0,0),function(e){var t=new DI(this._containerPointToPoint(e.getMin(tN),void 0,tN),this._containerPointToPoint(e.getMax(iN),void 0,iN));return this._pointToExtent(t)}),distanceToPixel:function(){var e=new uM(0,0),t=new uM(0,0);return function(i,n,r){var s=this.getProjection();if(!s)return null;var o=this.getScale()/this.getScale(r),a=this.getCenter(),l=s.locate(a,i,n),c=this.coordToContainerPoint(a,void 0,e),h=this.coordToContainerPoint(l,void 0,t);return h._sub(c)._multi(o)._abs(),new wk(h.x,h.y)}}(),distanceToPoint:function(e,t,i,n){var r=this._getResolution(i);return this.distanceToPointAtRes(e,t,r,n)},distanceToPointAtRes:function(){var e=new uM(0,0),t=new vI(0,0);return function(i,n,r,s,o){var a=this.getProjection();if(!a)return null;var l=s||this.getCenter(),c=a.locate(l,i,n,t),h=this.coordToPointAtRes(l,r,e),u=this.coordToPointAtRes(c,r,o);return u._sub(h)._abs(),u}}(),altitudeToPoint:(QO=new vI(0,40),eN=new uM(0,0),function(e,t,i){void 0===e&&(e=0),this._altitudeOriginDirty&&(QO.x=this._originLng,this._altitudeOriginDirty=!1);var n=this.distanceToPointAtRes(e,e,t,i||QO,eN);e<0&&n.x>0&&(n.x=-n.x);var r=this.options.heightFactor;return r&&1!==r&&(n.x*=r,n.y*=r),n.x}),pointAtResToAltitude:function(){var e=new vI(0,40);return function(t,i,n){return void 0===t&&(t=0),this.pointAtResToDistance(t,0,i,n||e)}}(),pixelToDistance:(XO=new vI(0,0),KO=new vI(0,0),YO=new vI(0,0),JO=new vI(0,0),function(e,t){var i=this.getProjection();if(!i)return null;var n=this.getFullExtent(),r=n.top>n.bottom?-1:1,s=XO.set(this.width/2,this.height/2),o=KO.set(this.width/2+e,this.height/2+r*t),a=this.containerPointToCoord(s,YO),l=this.containerPointToCoord(o,JO);return i.measureLength(a,l)}),pointToDistance:function(e,t,i){var n=this.getResolution(i);return this.pointAtResToDistance(e,t,n)},pointAtResToDistance:function(){var e=new uM(0,0),t=new vI(0,0),i=new vI(0,0),n=new vI(0,0);return function(r,s,o,a){var l=this.getProjection();if(!l)return null;var c=a?l.project(a,t):this._getPrjCenter(),h=this._prjToPointAtRes(c,o,e);h._add(r,s);var u=this.pointAtResToCoord(h,o,i),d=a||l.unproject(c,n);return l.measureLength(d,u)}}(),locateByPoint:function(){var e=new uM(0,0);return function(t,i,n){var r=this.coordToContainerPoint(t,void 0,e);return this.containerPointToCoord(r._add(i,n))}}(),_get2DExtent:function(e,t){var i;if(void 0!==e&&e!==this._zoomLevel||!this._mapExtent2D||(i=this._mapExtent2D),i)return t?(t.set(i.xmin,i.ymin,i.xmax,i.ymax),t):i.copy();var n=this._getResolution(e);return this._get2DExtentAtRes(n,t)},_get2DExtentAtRes:function(){var e=new uM(0,0);return function(t,i){var n=this;return t===this._mapGlRes&&this._mapGlExtent2D?this._mapGlExtent2D:this.getContainerExtent().convertTo((function(i){return n._containerPointToPointAtRes(i,t,e)}),i)}}(),_pointToExtent:function(){var e=new vI(0,0),t=new vI(0,0);return function(i){var n=i.getMin(),r=i.getMax(),s=this.getFullExtent(),o=!s||s.left<=s.right?[n.x,r.x]:[r.x,n.x],a=o[1],l=!s||s.top>s.bottom?[r.y,n.y]:[n.y,r.y],c=l[0],h=n.set(o[0],l[1]),u=r.set(a,c);return new OI(this.pointToCoord(h,void 0,e),this.pointToCoord(u,void 0,t),this.getProjection())}}(),_getViewPointFrameOffset:function(){var e=new uM(0,0);return function(){if(this.isZooming())return null;var t=this._getPrjCenter();return this._mapViewCoord&&!this._mapViewCoord.equals(t)?this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(t,void 0,e)):null}}(),_viewPointToPrj:function(){var e=new uM(0,0);return function(t,i){return this._containerPointToPrj(this.viewPointToContainerPoint(t,e),i)}}(),_prjToContainerPoint:function(e,t,i,n){var r=this._getResolution(t);return this._prjToContainerPointAtRes(e,r,i,n)},_prjToContainerPointAtRes:function(){var e=new uM(0,0);return function(t,i,n,r){return this._pointAtResToContainerPoint(this._prjToPointAtRes(t,i,e),i,r||0,n)}}(),_prjToViewPoint:function(){var e=new uM(0,0);return function(t,i,n){var r=this._prjToContainerPoint(t,void 0,e,n);return this.containerPointToViewPoint(r,i)}}(),_viewPointToPoint:function(){var e=new uM(0,0);return function(t,i,n){return this._containerPointToPoint(this.viewPointToContainerPoint(t,e),i,n)}}(),_pointToViewPoint:function(){var e=new vI(0,0);return function(t,i,n){return this._prjToViewPoint(this._pointToPrj(t,i,e),n)}}()}),lN.mergeOptions(aN);var cN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){this.target&&this.target.on("_dblclick",this._onDoubleClick,this)},i.removeHooks=function(){this.target&&this.target.off("_dblclick",this._onDoubleClick,this)},i._onDoubleClick=function(e){var t=this.target;if(t.options.doubleClickZoom){var i=t.getZoom(),n=e.domEvent.shiftKey?Math.ceil(i)-1:Math.floor(i)+1;t._zoomAnimation(n,e.containerPoint)}},t}(rI);lN.mergeOptions({doubleClickZoom:!0}),lN.addOnLoadHook("addHandler","doubleClickZoom",cN);var hN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){var e=this.target;e&&(this._dragHandler=new yI(e._panels.mapWrapper||e._containerDOM,{cancelOn:this._cancelOn.bind(this),rightclick:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this).on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this).enable())},i.removeHooks=function(){this._dragHandler.off("mousedown",this._onMouseDown,this).off("dragstart",this._onDragStart,this).off("dragging",this._onDragging,this).off("dragend",this._onDragEnd,this),this._dragHandler.remove(),delete this._dragHandler},i._cancelOn=function(e){return!(!this.target.isZooming()&&!this._ignore(e))},i._ignore=function(e){return!!e&&(e.domEvent&&(e=e.domEvent),this.target._ignoreEvent(e)||this.target._isEventOutMap(e))},i._onMouseDown=function(e){delete this.startDragTime,delete this._mode;var t=this.target.options.switchDragButton;t&&"touchstart"===e.domEvent.type||e.domEvent.button===(t?0:2)||e.domEvent.ctrlKey?(this.target.options.dragRotate||this.target.options.dragPitch)&&(this._mode="rotatePitch"):this.target.options.dragPan&&(this._mode="move"),this.target._stopAnim(this.target._mapAnimPlayer),tA(e.domEvent)},i._onDragStart=function(e){this.startDragTime=cP(),"move"===this._mode?this._moveStart(e):"rotatePitch"===this._mode&&this._rotateStart(e)},i._onDragging=function(e){this.target._isEventOutMap(e.domEvent)||("move"===this._mode?this._moving(e):"rotatePitch"===this._mode&&this._rotating(e))},i._onDragEnd=function(e){"move"===this._mode?this._moveEnd(e):"rotatePitch"===this._mode&&this._rotateEnd(e),delete this.startDragTime,delete this.startBearing},i._start=function(e){this.preX=e.mousePos.x,this.preY=e.mousePos.y,this.startX=this.preX,this.startY=this.preY,this._startPrjCenter=this.target._getPrjCenter().copy()},i._moveStart=function(e){this._start(e);var t=this.target;t.onMoveStart(e);var i=sA(t._getActualEvent(e.domEvent),t.getContainer());this.startPrjCoord=t._containerPointToPrj(i)},i._moving=function(e){if(this.startDragTime){var t=this.target,i=sA(t._getActualEvent(e.domEvent),t.getContainer());t._setPrjCoordAtContainerPoint(this.startPrjCoord,i),t.onMoving(e)}},i._moveEnd=function(e){if(this.startDragTime){var t="touchend"===e.domEvent.type,i=this.target,n=cP()-this.startDragTime,r=e.mousePos.x-this.startX,s=e.mousePos.y-this.startY,o=i._getPrjCenter(),a=o.sub(this._startPrjCenter);if(this._clear(),i.options.panAnimation&&!e.interupted&&i._verifyExtent(i._getPrjCenter())&&n<280&&Math.abs(s)+Math.abs(r)>5){n*=5;var l=o.add(a._multi(t?5:2.8));i._panTo(l,{duration:t?3*n:2*n,easing:"outExpo"})}else i.onMoveEnd(e)}},i._rotateStart=function(e){this._start(e),delete this._rotateMode,this.startBearing=this.target.getBearing(),this.target.onDragRotateStart(e),this._db=0},i._rotating=function(e){var t=this.target,i=e.mousePos.x,n=e.mousePos.y,r=t.getPitch(),s=t.getBearing(),o=Math.abs(i-this.preX),a=Math.abs(n-this.preY);if(this._rotateMode||(this._rotateMode=t.options.dragRotatePitch?"rotate_pitch":o>a?"rotate":o<a?"pitch":"rotate"),!("pitch"===this._rotateMode&&0===r&&a<10)){if(this._rotateMode.indexOf("rotate")>=0&&t.options.dragRotate){var l;l=t.options.dragPitch||o>a?-.15*(this.preX-i):i>t.width/2?.15*(this.preY-n):-.15*(this.preY-n);var c=t.getBearing()+l;this._db=this._db||0,this._db+=l,t._setBearing(c)}this._rotateMode.indexOf("pitch")>=0&&t.options.dragPitch&&t._setPitch(t.getPitch()+.15*(this.preY-n)),this.preX=i,this.preY=n,t.getBearing()===s&&t.getPitch()===r||t.onDragRotating(e)}},i._rotateEnd=function(e){var t=this.target,i=t.getBearing();this._clear();var n=cP()-this.startDragTime;if(t.onDragRotateEnd(e),t.options.rotateAnimation&&Math.abs(i-this.startBearing)>20&&("rotate"===this._rotateMode||"rotate_pitch"===this._rotateMode)&&!e.interupted&&n<400){var r=t.getBearing();t._animateTo({bearing:r+this._db/1.5},{easing:"outQuint",duration:1600})}},i._clear=function(){delete this.startPrjCoord,delete this.preX,delete this.preY,delete this.startX,delete this.startY},t}(rI);lN.mergeOptions({draggable:!0,dragPan:!0,dragRotatePitch:!0,dragRotate:!0,dragPitch:!0}),lN.addOnLoadHook("addHandler","draggable",hN);var uN="mousedown mouseup mousemove click dblclick contextmenu touchstart touchmove touchend mouseout",dN={mousemove:["mousemove","mouseover","mouseout","mouseenter"],touchend:["touchend","click"]},pN=function(e){return e&&e.getLayer&&e.on&&e.fire},mN=function(e){return e._getInternalId?e._getInternalId():e.getId?e.getId():null},fN=function(e,t,i){if(e._onEvent)return e._onEvent(t,i);var n=e.getLayer();return n&&n.fireGeoEvent?n.fireGeoEvent(e,t,i):null},gN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){var e=this.target;dA(e._panels.allLayers||e._containerDOM,uN,this._identifyGeometryEvents,this)},i.removeHooks=function(){var e=this.target;pA(e._panels.allLayers||e._containerDOM,uN,this._identifyGeometryEvents,this)},i._identifyGeometryEvents=function(e,t){var i=this.target;if(!i.isInteracting()&&!i._ignoreEvent(e)){var n=null,r=t||e.type;if(mA(r)&&!QP.isTest&&fA(this,i.options.mousemoveThrottleTime))iA(e);else{var s="mousedown"===r||"touchstart"===r&&e.touches&&1===e.touches.length;if(s)this._mouseDownTime=cP();else if(("click"===r||"touchend"===r)&&this._mouseDownTime){var o=this._mouseDownTime;if(delete this._mouseDownTime,cP()-o>300){if("click"===r)return}else"touchend"===r&&(n="click")}var a=e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e;if(a){var l=sA(a,i._containerDOM);"touchstart"===r&&i.options.preventTouch&&tA(e);for(var c=null,h=this.target.getRenderer().getTopElements(),u=s&&2!==e.button,d=0;d<h.length;d++)if(h[d].hitTest(l)){var p=h[d].options.cursor;if(p&&(c=p),u||h[d].events&&h[d].events.indexOf(r)>=0){var m={target:i,type:r,domEvent:e,containerPoint:l};if(u)return i._setPriorityCursor(c),void h[d].mousedown(m);h[d].onEvent(m)}}var f=i._getLayers((function(e){return!(!e.identify||!e.options.geometryEvents)}));if(f.length){var g={includeInternals:!0,filter:function(t){if(t instanceof UO){var i=t._getEventTypeToFire(e);return"mousemove"===r?(!c&&t.options.cursor&&(c=t.options.cursor),!0):!(!t.listens(i)&&!t.listens(n))}return!!pN(t)},count:1,onlyVisible:i.options.onlyVisibleGeometryEvents,containerPoint:l,layers:f,eventTypes:dN[r]||[r],domEvent:e},_=(function(t){var s=this,o=!0,a=function(){return s._prevOverGeos&&s._prevOverGeos.geos||[]},l=function(t,i){if(void 0===t&&(t=[]),void 0===i&&(i={}),t&&t.length>0)for(var n=t.length-1;n>=0;n--){var r=t[n];pN(r)&&(i[mN(t[n])]||(o=fN(r,e,"mouseout")))}};if("mouseout"===r){var h=a();this._prevOverGeos={geos:[],geomap:{}},l(h,{})}else if("mousemove"===r){var u={};if(t.length>0)for(var d=t.length-1;d>=0;d--){var p=t[d];if(pN(p)){var m=mN(p);u[m]=p,fN(p,e),this._prevOverGeos&&this._prevOverGeos.geomap[m]||fN(p,e,"mouseenter"),o=fN(p,e,"mouseover")}}i._setPriorityCursor(c);var f=a();this._prevOverGeos={geos:t,geomap:u},l(f,u)}else{if(!t||!t.length)return;for(var g=t.length-1;g>=0;g--)if(pN(t[g])){o=fN(t[g],e),n&&fN(t[g],e,n);break}}!1===o&&iA(e)}).bind(this);mA(r)?this._queryIdentifyTimeout=i.getRenderer().callInNextFrame((function(){i.isInteracting()||i.identifyAtPoint(g,_)})):i.identifyAtPoint(g,_)}}}}},t}(rI);lN.mergeOptions({geometryEvents:!0,onlyVisibleGeometryEvents:!0}),lN.addOnLoadHook("addHandler","geometryEvents",gN);var _N=function(e){function t(t){var i;return(i=e.call(this,t)||this)._thisScrollZoom=i._scrollZoom.bind(aM(aM(i))),i._wheelZoomRate=1/450,i._defaultZoomRate=.01,i._delta=0,i}tM(t,e);var i=t.prototype;return i.addHooks=function(){Jk(this.target._containerDOM,"wheel",this._onWheelScroll,this)},i.removeHooks=function(){Qk(this.target._containerDOM,"wheel",this._onWheelScroll)},i._onWheelScroll=function(e){var t=this.target;if(t.options.preventWheelScroll&&(tA(e),iA(e)),t._ignoreEvent(e)||t._isEventOutMap(e)||!t.options.zoomable)return!1;var i=t._checkZoomOrigin(sA(e,t._containerDOM));return t.options.seamlessZoom?(this._zooming||(this._trackPadSuspect=0,this._ensureTrackpad=!1),this._seamless(e,i)):this._interval(e,i)},i._seamless=function(e,t){var i=e.deltaMode===window.WheelEvent.DOM_DELTA_LINE?60*e.deltaY:e.deltaY;if(i%4.000244140625!=0&&(this._ensureTrackpad||(Math.abs(i)<60?this._trackPadSuspect++:this._trackPadSuspect=0,this._trackPadSuspect>=2&&(this._ensureTrackpad=!0)),this._ensureTrackpad&&(i*=14)),e.shiftKey&&i&&(i/=4),this._lastWheelEvent=e,this._delta-=i,!this._zooming&&this._delta){var n=this.target;this._zoomOrigin=t,n.onZoomStart(null,t)}this._start()},i._start=function(){this._delta&&(this._zooming=!0,this._active||(this.target.getRenderer().callInNextFrame(this._thisScrollZoom),this._active=!0))},i._scrollZoom=function(){var e=this;if(this._active=!1,this._delta){var t=Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);var n=this.target,r=n.getZoom(),s=n.getZoomForScale(i,r,!0);this._delta=0,n.onZooming(s,this._zoomOrigin),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout((function(){e._zooming=!1,delete e._timeout,n.onZoomEnd(n.getZoom(),e._zoomOrigin)}),210)}},i._interval=function(e,t){var i=this,n=this.target;if(this._zooming)return this._requesting++,!1;this._requesting=0;var r=(e.deltaY?-1*e.deltaY:e.wheelDelta?e.wheelDelta:e.detail)>0?1:-1;e.detail&&(r*=-1);var s=n.getZoom(),o=s+r;return(o=n._checkZoom(r>0?Math.ceil(o):Math.floor(o)))===s||(this._zooming=!0,this._delta||(n.onZoomStart(null,t),this._origin=t,this._delta=r,this._startZoom=n.getZoom()),n._animateTo({zoom:o-1*this._delta/2,around:this._origin},{continueOnViewChanged:!0,easing:"linear",duration:90,wheelZoom:!0},(function(t){"finished"===t.state.playState?i._requesting<1||Math.abs(o-i._startZoom)>2||o===n.getMaxZoom()||o===n.getMinZoom()?(n._animateTo({zoom:o,around:i._origin},{continueOnViewChanged:!0,duration:100},(function(e){"running"!==e.state.playState&&(delete i._zooming,delete i._requesting)})),delete i._startZoom,delete i._origin,delete i._delta,i._requesting=0):uP(i._requesting)||(delete i._zooming,i._onWheelScroll(e)):"running"!==t.state.playState&&(delete i._zooming,delete i._requesting)}))),!1},t}(rI);lN.mergeOptions({scrollWheelZoom:!0,seamlessZoom:!0}),lN.addOnLoadHook("addHandler","scrollWheelZoom",_N);var yN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){Jk(this.target.getContainer(),"touchstart",this._onTouchStart,this)},i.removeHooks=function(){Qk(this.target.getContainer(),"touchstart",this._onTouchStart)},i._onTouchStart=function(e){var t=this.target;if(e.touches&&!(e.touches.length<2)){var i=t.getContainer(),n=sA(e.touches[0],i),r=sA(e.touches[1],i);this.preY=n.y,this._startP1=n,this._startP2=r,this._startDist=n.distanceTo(r),this._startVector=n.sub(r),this._startZoom=t.getZoom(),this._startBearing=t.getBearing(),pA(document,"touchmove",this._onTouchMove,this),pA(document,"touchend",this._onTouchEnd,this),Jk(document,"touchmove",this._onTouchMove,this),Jk(document,"touchend",this._onTouchEnd,this),t.options.preventTouch&&tA(e),t._fireEvent("touchactstart")}},i._onTouchMove=function(e){var t=this.target;if(e.touches&&!(e.touches.length<2)){var i=t.getContainer(),n=sA(e.touches[0],i),r=sA(e.touches[1],i),s=n.sub(this._startP1),o=r.sub(this._startP2),a=n.sub(r),l=n.distanceTo(r)/this._startDist,c=180*a.angleWith(this._startVector)/Math.PI,h=.4*((this.preY||n.y)-n.y);this.preY=n.y;var u={domEvent:e,mousePos:[n,r]};if(this.mode||(t.options.touchRotate&&Math.abs(c)>8?this.mode=t.options.touchZoomRotate?"rotate_zoom":"rotate":t.options.touchPitch&&s.y*o.y>0&&Math.abs(s.y)>10&&Math.abs(o.y)>10?this.mode="pitch":t.options.zoomable&&t.options.touchZoom&&Math.abs(1-l)>.15&&(this.mode=t.options.touchZoomRotate&&t.options.touchRotate?"rotate_zoom":"zoom"),this._startTouching(u)),"zoom"===this.mode||"rotate_zoom"===this.mode){this._scale=l;var d=t._getResolution(this._startZoom)/l,p=t.getZoomFromRes(d);t.onZooming(p,this._Origin)}"rotate"===this.mode||"rotate_zoom"===this.mode?(t._setBearing(this._startBearing+c),t.onDragRotating(u)):"pitch"===this.mode&&(t._setPitch(t.getPitch()+h),t.onDragRotating(u)),t._fireEvent("touchactinging")}},i._startTouching=function(e){var t=this.target;if("zoom"===this.mode||"rotate_zoom"===this.mode){var i=t.getSize();this._Origin=new uM(i.width/2,i.height/2),t.onZoomStart(null,this._Origin)}"rotate"!==this.mode&&"pitch"!==this.mode&&"rotate_zoom"!==this.mode||t.onDragRotateStart(e)},i._onTouchEnd=function(e){delete this.preY;var t=this.target;if(pA(document,"touchmove",this._onTouchMove,this),pA(document,"touchend",this._onTouchEnd,this),"zoom"===this.mode||"rotate_zoom"===this.mode){var i=this._scale,n=t._getResolution(this._startZoom)/i,r=t.getZoomFromRes(n);t.onZoomEnd(r,this._Origin)}"pitch"!==this.mode&&"rotate"!==this.mode&&"rotate_zoom"!==this.mode||t.onDragRotateEnd({domEvent:e}),delete this.mode,t._fireEvent("touchactend")},t}(rI);lN.mergeOptions({touchGesture:!0,touchZoom:!0,touchPitch:!0,touchRotate:!0,touchZoomRotate:!1}),lN.addOnLoadHook("addHandler","touchGesture",yN);var vN="__anim_player",xN={outExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},outQuint:function(e){return 1-Math.pow(1-e,5)},in:function(e){return Math.pow(e,2)},out:function(e){return 1-xN.in(1-e)},inAndOut:function(e){return 3*e*e-2*e*e*e},linear:function(e){return e},upAndDown:function(e){return e<.5?xN.inAndOut(2*e):1-xN.inAndOut(2*(e-.5))}},bN=function(){function e(e,t){this.state=e,this.styles=t}var t,i;return t=e,(i=[{key:"playState",get:function(){return this.state.playState}},{key:"symbol",get:function(){return this.styles.symbol}}])&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key))?r:String(r),n)}var r}(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),wN=function(e,t,i,n){this._animation=e,this.options=t,this._onFrame=i,this.playState="idle",this.ready=!0,this.finished=!1,this.target=n},CN={speed:{slow:2e3,normal:1e3,fast:500},_resolveStyles:function(e){if(!e)return null;function t(e){if(!Array.isArray(e))return CN._resolveStyles(e);for(var t=[],i=[],n=[],r=0;r<e.length;r++){var s=CN._resolveStyles(e[r]);s&&(t.push(s[0]),i.push(s[1]),n.push(s[2]))}return t.length?[t,i,n]:null}function i(e){var t,i=e;Array.isArray(e)||(i=dP(e)?[0,e]:e instanceof uM||e instanceof vI?[new(t=e.constructor)(0,0),e]:[e,e]);var n=i[0],r=i[1];return dP(n)&&dP(r)?n===r?null:[n,r-n,r]:Array.isArray(n)&&dP(n[0])||n instanceof vI||n instanceof uM?(Array.isArray(n)?(n=new vI(n),r=new vI(r)):(n=new(t=n.constructor)(n),r=new t(r)),n.equals(r)?null:[n,r.sub(n),r]):[n,r,r]}var n,r={},s={},o={};for(var a in e)if(e.hasOwnProperty(a)){var l,c=e[a];if(!c)continue;if(Array.isArray(c)&&(uP(c[0])||uP(c[1])))continue;n=c,(l=!Array.isArray(n)&&n.constructor===Object||Array.isArray(n)&&n[0].constructor===Object?t(c):i(c))&&(s[a]=l[0],r[a]=l[1],o[a]=l[2])}return[s,r,o]},framing:function(e,t){t||(t={});var i,n,r,s=t.easing?xN[t.easing]:xN.linear;return s||(s=xN.linear),(e=CN._resolveStyles(e))&&(n=e[0],i=e[1],r=e[2]),function(e,t){var o,a;if(e<0)o={playState:"idle",delta:0},a=n;else if(e<t){var l=s(e/t);o={playState:"running",delta:l},a=function e(t,i,n){if(!i||!n)return null;var s={};for(var o in n)if(n.hasOwnProperty(o)){if(i[o]===r[o]){s[o]=i[o];continue}var a=i[o],l=n[o];if(dP(l))s[o]=a+t*l;else if(Array.isArray(l)){for(var c=[],h=0;h<l.length;h++)c.push(e(t,a[h],l[h]));s[o]=c}else s[o]=l.constructor===Object?e(t,a,l):a instanceof uM||a instanceof vI?a.add(l.multi(t)):l}return s}(l,n,i)}else o={playState:"finished",delta:1},a=r;return o.startStyles=n,o.destStyles=r,o.progress=e,o.remainingMs=t-e,new bN(o,a)}},_requestAnimFrame:function(e){this._frameQueue||(this._frameQueue=[]),this._frameQueue.push(e),this._a()},_a:function(){this._animationFrameId||(this._animationFrameId=lM(CN._frameFn))},_run:function(){if(this._frameQueue.length){var e=this._frameQueue;this._frameQueue=[];for(var t=0,i=e.length;t<i;t++)e[t]();this._frameQueue.length?this._animationFrameId=lM(CN._frameFn):delete this._animationFrameId}},animate:function(e,t,i,n){t||(t={});var r=CN.framing(e,t);return new wN(r,t,i,n)}};CN._frameFn=CN._run.bind(CN),hP(wN.prototype,{_prepare:function(){var e=this.options,t=e.speed||e.duration;fP(t)&&((t=CN.speed[t])||(t=+t)),t||(t=CN.speed.normal),this.duration=t,this._framer=e.framer||CN._requestAnimFrame.bind(CN)},play:function(){if("idle"!==this.playState&&"paused"!==this.playState||this.target&&this.target[vN])return this;this.target&&(this.target[vN]=1),"idle"===this.playState&&(this.currentTime=0,this._prepare());var e=cP();if(!this.startTime){var t=this.options;this.startTime=t.startTime?t.startTime:e}return this._playStartTime=Math.max(e,this.startTime),"paused"===this.playState&&(this._playStartTime-=this.currentTime),this.playState="running",this._run(),this},pause:function(){return"paused"===this.playState||(this.playState="paused",this._run()),this},cancel:function(){return"idle"===this.playState||(this.playState="idle",this.finished=!1,this._run()),this},finish:function(){return"finished"===this.playState||(this.playState="finished",this.finished=!0,this._run()),this},reverse:function(){},_run:function(){var e=this,t=this._onFrame,i=cP(),n=i-this._playStartTime;if(this.options.repeat&&n>=this.duration&&(this._playStartTime=i,n=0),"running"===this.playState){var r=this._animation(n,this.duration);this.playState=r.state.playState,"running"!==this.playState&&this.target&&delete this.target[vN],"idle"===this.playState?this.startTime>i&&setTimeout(this._run.bind(this),this.startTime-i):"running"===this.playState?this._framer((function(){"running"===e.playState&&(e.currentTime=n,t&&t(r),e._run())})):"finished"===this.playState&&(this.finished=!0,t&&t(r))}else if(this.target&&delete this.target[vN],t){"finished"===this.playState?n=this.duration:"idle"===this.playState&&(n=0);var s=this._animation(n,this.duration);s.state.playState=this.playState,t(s)}}});var SN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.animateShow=function(e,t){var i=this;void 0===e&&(e={}),this._showPlayer&&this._showPlayer.finish(),gP(e)&&(t=e={});var n=this.getCoordinates();if(0===n.length)return this;this._animIdx=0,this._animLenSoFar=0,this.show();var r=this.getShell?this.getShell().concat(this.getShell()[0]):n,s=this._getProjection(),o=s.projectCoords(r,this.options.antiMeridian);this._prjAniShowCenter=this._getPrjExtent().getCenter(),this._aniShowCenter=s.unproject(this._prjAniShowCenter);var a=e.duration||1e3,l=e.easing||"out";this.setCoordinates([]);var c=0;o.length&&(o[0]._distance=0);for(var h=1;h<o.length;h++){var u=o[h].distanceTo(o[h-1]);o[h]._distance=u,c+=u}this._tempCoord=new vI(0,0),this._tempPrjCoord=new uM(0,0);var d=this._showPlayer=CN.animate({t:a},{duration:a,easing:l},(function(e){if(i.getMap()){var s=i._drawAnimShowFrame(e.styles.t,a,c,r,o);"finished"===e.state.playState&&(delete i._showPlayer,delete i._aniShowCenter,delete i._prjAniShowCenter,delete i._animIdx,delete i._animLenSoFar,delete i._animTailRatio,delete i._tempCoord,delete i._tempPrjCoord,i.setCoordinates(n)),t&&t(e,s)}else if("finished"!==d.playState&&(d.finish(),t)){var l=i.getCoordinates();t(e,l[l.length-1])}}),this);return d.play(),d},i._drawAnimShowFrame=function(e,t,i,n,r){if(0===e)return n[0];var s,o,a=e/t*i,l=0;for(s=this._animIdx+1,o=r.length;s<o&&!(this._animLenSoFar+(l=r[s]._distance)>a);s++)this._animLenSoFar+=l;if(this._animIdx=s-1,this._animIdx>=o-1)return this.setCoordinates(n),n[n.length-1];var c=this._animIdx,h=r[c],u=r[c+1],d=(a-this._animLenSoFar)/l;this._animTailRatio=d;var p=h.y+(u.y-h.y)*d;this._tempPrjCoord.x=h.x+(u.x-h.x)*d,this._tempPrjCoord.y=p;var m=this._tempPrjCoord,f=n[c],g=n[c+1],_=f.y+(g.y-f.y)*d;this._tempCoord.x=f.x+(g.x-f.x)*d,this._tempCoord.y=_;var y=this._tempCoord,v=!!this.getShell;if(!v&&this.options.smoothness>0){for(var x=[],b=[],w=0;w<=this._animIdx;w++)x.push(n[w]),b.push(r[w]);x.push(y,y),b.push(m,m),this.setCoordinates(x),this._setPrjCoordinates(b)}else{var C=n.slice(0,this._animIdx+1);C.push(y);var S=r.slice(0,this._animIdx+1);S.push(m),v?(this.setCoordinates([this._aniShowCenter].concat(C)),this._setPrjCoordinates([this._prjAniShowCenter].concat(S))):(this.setCoordinates(C),this._setPrjCoordinates(S))}return y},i._getCenterInExtent=function(e,t,i){var n=this.getExtent();if(!e.intersects(n))return null;var r=i(t,e);if(0===r.length)return null;var s=0,o=0,a=0;r.forEach((function(e){Array.isArray(e)?e.forEach((function(e){e.point&&(e=e.point),s+=e.x,o+=e.y,a++})):(e.point&&(e=e.point),s+=e.x,o+=e.y,a++)}));var l=new vI(s,o)._multi(1/a);return l.count=a,l},i._getPath2DPoints=function(e,t,i){if(!EM(e))return[];var n=this.getMap(),r=!t&&this._shouldSimplify(),s=this.options.simplifyTolerance*n._getResolution(),o=Array.isArray(e[0]);if(delete this._simplified,r&&!o){var a=e.length;e=XT()(e,s,!1),this._simplified=e.length<a}if(i||(i=n._getResolution()),Array.isArray(e)){var l=[];if(!Array.isArray(e[0]))return l=NM(e,"_glPt"),n._prjsToPointsAtRes(e,i,l);for(var c=[],h=0,u=e.length;h<u;h++){var d=e[h];l=NM(d,"_glPt");var p=n._prjsToPointsAtRes(d,i,l);c.push(p)}return c}return n._prjToPointAtRes(e,i)},i._shouldSimplify=function(){var e=this.getLayer();return e&&e.options.enableSimplify&&!e.options.enableAltitude&&this.options.enableSimplify&&!this._showPlayer},i._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},i._getPrjCoordinates=function(){return this._verifyProjection(),!this._prjCoords&&this._getProjection()&&(this._prjCoords=this._projectCoords(this._coordinates)),this._prjCoords},i._updateCache=function(){this._clearCache(),this._getProjection()&&this._prjCoords&&(this._coordinates=this._unprojectCoords(this._getPrjCoordinates()))},i._clearProjection=function(){this._prjCoords=null,e.prototype._clearProjection.call(this)},i._projectCoords=function(e){var t=this._getProjection();return t?t.projectCoords(e,this.options.antiMeridian):[]},i._unprojectCoords=function(e){var t=this._getProjection();return t?t.unprojectCoords(e):[]},i._computeCenter=function(){var e=this._coordinates;if(!EM(e))return null;for(var t=0,i=0,n=0,r=e.length,s=0;s<r;s++)e[s]&&dP(e[s].x)&&dP(e[s].y)&&(t+=e[s].x,i+=e[s].y,n++);return new vI(t/n,i/n)},i._computeExtent=function(){var e=this._coordinates;if(!EM(e))return null;var t=[e];return this.hasHoles&&this.hasHoles()&&t.push.apply(t,this.getHoles()),this._coords2Extent(t,this._getProjection())},i._computePrjExtent=function(){var e=[this._getPrjCoordinates()];return this.hasHoles&&this.hasHoles()&&e.push.apply(e,this._getPrjHoles()),this._coords2Extent(e)},i._get2DLength=function(){for(var e=this._getPath2DPoints(this._getPrjCoordinates(),!0),t=0,i=1,n=e.length;i<n;i++)t+=e[i].distanceTo(e[i-1]);return t},i._hitTestTolerance=function(){var t,i=this._getInternalSymbol();if(Array.isArray(i)){t=0;for(var n=0;n<i.length;n++)dP(i[n].lineWidth)&&i[n].lineWidth>t&&(t=i[n].lineWidth)}else t=i.lineWidth;return e.prototype._hitTestTolerance.call(this)+(dP(t)?t/2:1.5)},i._coords2Extent=function(e,t){if(!e||0===e.length||Array.isArray(e[0])&&0===e[0].length)return null;for(var i=new OI(t),n=0,r=e.length;n<r;n++)for(var s=0,o=e[n].length;s<o;s++)i._combine(e[n][s]);return i},t}(UO);SN.mergeOptions({smoothness:0,enableClip:!0,enableSimplify:!0,simplifyTolerance:2,symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:1,opacity:1}});var EN=function(e){function t(t,i){var n;return(n=e.call(this,i)||this).type="Polygon",t&&n.setCoordinates(t),n}tM(t,e);var i=t.prototype;return i.getOutline=function(){return this._getPainter()?new t(this.getExtent().toArray(),{symbol:{lineWidth:1,lineColor:"6b707b"}}):null},i.setCoordinates=function(e){if(!e)return this._coordinates=null,this._holes=null,this._projectRings(),this;var t=vI.toCoordinates(e),i=t.length;if(Array.isArray(t[0]))if(this._coordinates=this._trimRing(t[0]),i>1){for(var n=[],r=1;r<i;r++)t[r]&&n.push(this._trimRing(t[r]));this._holes=n}else this._holes=null;else this._coordinates=this._trimRing(t);return this._projectRings(),this},i.getCoordinates=function(){if(!this._coordinates)return[];for(var e=this.getHoles(),t=[this._copyAndCloseRing(this._coordinates)],i=0,n=e.length;i<n;i++)t.push(this._copyAndCloseRing(e[i]));return t},i.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getShell(),KR)},i.getShell=function(){return this._coordinates||[]},i.getHoles=function(){return this._holes||[]},i.hasHoles=function(){return this.getHoles().length>0},i._projectRings=function(){this.getMap()?(this._prjCoords=this._projectCoords(this._coordinates),this._prjHoles=this._projectCoords(this._holes),this.onShapeChanged()):this.onShapeChanged()},i._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},i._cleanRing=function(e){for(var t=e.length-1;t>=0;t--)e[t]||e.splice(t,1)},i._checkRing=function(e){if(this._cleanRing(e),!e||!EM(e))return!1;var t=e[e.length-1],i=!0;return e[0].x===t.x&&e[0].y===t.y||(i=!1),i},i._trimRing=function(e){var t=this._checkRing(e);return EM(e)&&t&&e.splice(e.length-1,1),e},i._copyAndCloseRing=function(e){e=e.slice(0);var t=this._checkRing(e);return EM(e)&&!t?(e.push(e[0].copy()),e):e},i._getPrjShell=function(){return"Polygon"===this.getJSONType()?this._getPrjCoordinates():(this._verifyProjection(),this._getProjection()&&!this._prjShell&&(this._prjShell=this._projectCoords(this._getShell?this._getShell():this.getShell())),this._prjShell)},i._getPrjHoles=function(){var e=this._getProjection();return this._verifyProjection(),e&&!this._prjHoles&&(this._prjHoles=this._projectCoords(this.getHoles())),this._prjHoles},i._computeGeodesicLength=function(e){var t=this.getCoordinates();if(!EM(t))return 0;for(var i=0,n=0,r=t.length;n<r;n++)i+=e.measureLength(t[n]);return i},i._computeGeodesicArea=function(e){var t=this.getCoordinates();if(!EM(t))return 0;for(var i=e.measureArea(t[0]),n=1,r=t.length;n<r;n++)i-=e.measureArea(t[n]);return i},i._updateCache=function(){e.prototype._updateCache.call(this),this._prjHoles&&(this._holes=this._unprojectCoords(this._getPrjHoles()))},i._clearCache=function(){return delete this._prjShell,e.prototype._clearCache.call(this)},i._clearProjection=function(){this._prjHoles&&(this._prjHoles=null),this._prjShell&&(this._prjShell=null),e.prototype._clearProjection.call(this)},t}(SN);function TN(e){return function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.getCoordinates=function(){return this._coordinates},i.setCoordinates=function(e){var t=e instanceof vI?e:new vI(e);if(this._coordinates=t,!this.getMap())return this._dirtyCoords=!0,this.onPositionChanged(),this;var i=this._getProjection();return this._setPrjCoordinates(i.project(this._coordinates)),this},i._getCenter2DPoint=function(e){var t=this.getMap();if(!t)return null;var i=this._getPrjCoordinates();return i?(e||(e=t._getResolution()),t._prjToPointAtRes(i,e)):null},i._getPrjCoordinates=function(){var e=this._getProjection();return this._verifyProjection(),!this._pcenter&&e&&this._coordinates&&(this._pcenter=e.project(this._coordinates)),this._pcenter},i._setPrjCoordinates=function(e){this._pcenter=e,this.onPositionChanged()},i._updateCache=function(){this._clearCache();var e=this._getProjection();this._pcenter&&e&&(this._coordinates=e.unproject(this._pcenter))},i._clearProjection=function(){this._pcenter=null,e.prototype._clearProjection.call(this)},i._computeCenter=function(){return this._coordinates?this._coordinates.copy():null},t}(e)}EN.registerJSONType("Polygon");var PN=new DI,MN=function(e){function t(t,i){var n;return(n=e.call(this,i)||this).type="Point",n.isPoint=!0,t&&n.setCoordinates(t),n}tM(t,e);var i=t.prototype;return i.getOutline=function(){var e=this.getCoordinates(),i=this.getContainerExtent(),n=this.getMap().coordToContainerPoint(e);return new t(e,{symbol:{markerType:"square",markerWidth:i.getWidth(),markerHeight:i.getHeight(),markerLineWidth:1,markerLineColor:"6b707b",markerFill:"rgba(0, 0, 0, 0)",markerDx:i.xmin-(n.x-i.getWidth()/2),markerDy:i.ymin-(n.y-i.getHeight()/2)}})},i.setSymbol=function(){var t;delete this._fixedExtent;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.prototype.setSymbol).call.apply(t,[this].concat(n))},i._getSizeSymbol=function(e){for(var t,i={},n=!1,r=!1,s=0;s<GR.length;s++){var o=e[GR[s]];uP(o)||(!n&&YM(o)&&(n=!0,r=!0),i[GR[s]]=o)}for(var a=0;a<WR.length;a++){var l=e[WR[a]];uP(l)||(!n&&YM(l)&&(n=!0),i[WR[a]]=l)}return n?(t=_k(i,this),r&&(t._dynamic=!0)):t=i,t},i._setExternSymbol=function(t){return this._symbol||delete this._fixedExtent,e.prototype._setExternSymbol.call(this,t)},i._isDynamicSize=function(){return this._sizeSymbol&&this._sizeSymbol._dynamic},i._getFixedExtent=function(){if(this._fixedExtent&&!this._isDynamicSize())return this._fixedExtent;this._fixedExtent=this._fixedExtent||new DI,this._fixedExtent.set(null,null,null,null);var e=this._sizeSymbol;if(!e)return this._fixedExtent;var t=this.getLayer()&&this.getLayer().getRenderer(),i=t&&t.resources,n=this.getTextDesc();if(Array.isArray(e)){PN.set(1/0,1/0,-1/0,-1/0);for(var r=0;r<e.length;r++)e[r]&&this._fixedExtent._combine(FR(PN,e[r],i,n&&n[r]))}else this._fixedExtent=FR(this._fixedExtent,e,i,n);return this._fixedExtent},i._isVectorMarker=function(){var e=this._getInternalSymbol();return!Array.isArray(e)&&UR(e)},i._canEdit=function(){var e=this._getInternalSymbol();return!Array.isArray(e)&&(UR(e)||qR(e)||VR(e))},i._containsPoint=function(t,i){var n=this.getContainerExtent();return i&&(n=n.expand(i)),!!n.contains(t)&&(!this.options.hitTestForEvent||e.prototype._containsPoint.call(this,t,i))},i._computeExtent=function(){return kN.call(this,"getCenter")},i._computePrjExtent=function(){return kN.call(this,"_getPrjCoordinates")},i._computeGeodesicLength=function(){return 0},i._computeGeodesicArea=function(){return 0},i._getSprite=function(e,t){return this._getPainter()?this._getPainter().getSprite(e,t):new NO(this).getSprite(e,t)},t}(TN(UO));function kN(e){var t=this[e]();return t?new OI(t,t,this._getProjection()):null}MN.mergeOptions({symbol:{markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},hitTestForEvent:!1,collision:!0}),MN.registerJSONType("Marker");var AN=function(e){function t(t,i){var n;return(n=e.call(this,i)||this).type="LineString",t&&n.setCoordinates(t),n}tM(t,e);var i=t.prototype;return i.getOutline=function(){return EN.prototype.getOutline.call(this)},i.setCoordinates=function(e){return e?(this._coordinates=vI.toCoordinates(e),this.getMap()?this._setPrjCoordinates(this._projectCoords(this._coordinates)):this.onShapeChanged(),this):(this._coordinates=null,this._setPrjCoordinates(null),this)},i.getCoordinates=function(){return this._coordinates||[]},i.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getCoordinates(),$R)},i._computeGeodesicLength=function(e){return e.measureLength(this.getCoordinates())},i._computeGeodesicArea=function(){return 0},t}(SN);AN.mergeOptions({arrowStyle:null,arrowPlacement:"vertex-last"}),AN.registerJSONType("LineString");var IN=new DI,RN=function(e){function t(t,i){var n;return(n=e.call(this,i)||this).type="GeometryCollection",n.setGeometries(t),n}tM(t,e);var i=t.prototype;return i.getContainerExtent=function(e){var t=e||new DI;return this.forEach((function(e){t._combine(e.getContainerExtent(IN))})),t},i.setGeometries=function(e){for(var t=this._checkGeometries(e||[]),i=this._getSymbol(),n=this.config(),r=this.getProperties(),s=t.length-1;s>=0;s--)t[s]._initOptions(n),t[s]._setParent(this),t[s]._setEventParent(this),i&&t[s].setSymbol(i),r&&t[s].setProperties(r);return this._geometries=t,this.getLayer()&&(this._bindGeometriesToLayer(),this.onShapeChanged()),this},i.getGeometries=function(){return this._geometries||[]},i.forEach=function(e,t){for(var i=this.getGeometries(),n=0,r=i.length;n<r;n++)i[n]&&(t?e.call(t,i[n],n):e(i[n],n));return this},i.filter=function(e,i){if(!e)return new t;var n=[],r=gP(e),s=r?e:nk(e);return this.forEach((function(e){var t=r?e:pk(e);(i?s.call(i,t):s(t))&&n.push(e)}),this),new t(n)},i.translate=function(e){if(!e)return this;if(this.isEmpty())return this;var t=arguments;return this.forEach((function(e){e&&e.translate&&e.translate.apply(e,t)})),this},i.isEmpty=function(){return!EM(this.getGeometries())},i.remove=function(){return this.forEach((function(e){e._unbind()})),UO.prototype.remove.apply(this,arguments)},i.show=function(){return this.options.visible=!0,this.forEach((function(e){e.show()})),this},i.hide=function(){return this.options.visible=!1,this.forEach((function(e){e.hide()})),this},i.onConfig=function(e){this.forEach((function(t){t.config(e)}))},i.getSymbol=function(){var t=e.prototype.getSymbol.call(this);if(!t){var i=[],n=!1;this.forEach((function(e){e.getSymbol()&&!n&&(n=!0),i.push(e.getSymbol())})),n&&(t={children:i})}return t},i.setSymbol=function(e){var t=this;if(e&&e.children)this._symbol=null,this.forEach((function(i,n){i._eventSymbolProperties=t._eventSymbolProperties,i.setSymbol(e.children[n])}));else{var i=this._prepareSymbol(e);this._symbol=i,this.forEach((function(e){e._eventSymbolProperties=t._eventSymbolProperties,e.setSymbol(i)}))}return this.onSymbolChanged(),this},i._setExternSymbol=function(e){return e=this._prepareSymbol(e),this._externSymbol=e,this.forEach((function(t){t._setExternSymbol(e)})),this.onSymbolChanged(),this},i._bindLayer=function(){e.prototype._bindLayer.apply(this,arguments),this._bindGeometriesToLayer()},i._bindGeometriesToLayer=function(){var e=this.getLayer();this.forEach((function(t){t._bindLayer(e)}))},i._checkGeometries=function(e){for(var t=[],i=0,n=(e=Array.isArray(e)?e:[e]).length;i<n;i++){var r=e[i];r&&(this._checkGeo(r)?NN(r)?QP.isTest||console.error(r," is GeometryCollection sub class,it Cannot be placed in GeometryCollection"):t.push(r):console.error("The geometry added to collection is invalid. Index: "+i))}return t},i._checkGeo=function(e){return e instanceof UO},i._updateCache=function(){this._clearCache(),this.isEmpty()||this.forEach((function(e){e&&e._updateCache&&e._updateCache()}))},i._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter,this.forEach((function(e){e._removePainter()}))},i._computeCenter=function(e){if(!e||this.isEmpty())return null;for(var t=0,i=0,n=0,r=this.getGeometries(),s=0,o=r.length;s<o;s++)if(r[s]){var a=r[s]._computeCenter(e);a&&(t+=a.x,i+=a.y,n++)}return 0===n?null:new vI(t/n,i/n)},i._containsPoint=function(e,t){if(this.isEmpty())return!1;delete this._pickGeometryIndex;for(var i=this.getGeometries(),n=0,r=i.length;n<r;n++)if(i[n]._containsPoint(e,t))return this._pickGeometryIndex=n,!0;return!1},i._hitTestTolerance=function(){for(var e=this.getGeometries(),t=0,i=0,n=e.length;i<n;i++){var r=e[i]._hitTestTolerance();t=Math.max(t,r)}return t},i._computeExtent=function(e){return ON.call(this,e,"_computeExtent")},i._computePrjExtent=function(e){return ON.call(this,e,"_computePrjExtent")},i._computeGeodesicLength=function(e){if(!e||this.isEmpty())return 0;for(var t=this.getGeometries(),i=0,n=0,r=t.length;n<r;n++)t[n]&&(i+=t[n]._computeGeodesicLength(e));return i},i._computeGeodesicArea=function(e){if(!e||this.isEmpty())return 0;for(var t=this.getGeometries(),i=0,n=0,r=t.length;n<r;n++)t[n]&&(i+=t[n]._computeGeodesicArea(e));return i},i._exportGeoJSONGeometry=function(){var e=[];if(!this.isEmpty())for(var t=this.getGeometries(),i=0,n=t.length;i<n;i++)t[i]&&e.push(t[i]._exportGeoJSONGeometry());return{type:"GeometryCollection",geometries:e}},i._toJSON=function(e){e=hP({},e);var t,i={type:"Feature",geometry:{type:"GeometryCollection",geometries:this.getGeometries().filter((function(e){return e&&e._toJSON})).map((function(e){var t=e._toJSON();return t.subType?t:e._exportGeoJSONGeometry()}))}},n=this.getId();return uP(n)||(i.id=n),(uP(e.properties)||e.properties)&&(t=this._exportProperties()),i.properties=t,e.feature=i,e},i._clearProjection=function(){if(!this.isEmpty())for(var e=this.getGeometries(),t=0,i=e.length;t<i;t++)e[t]&&e[t]._clearProjection()},i._getConnectPoints=function(){var e=this.getExtent();return[new vI(e.xmin,e.ymax),new vI(e.xmax,e.ymin),new vI(e.xmin,e.ymin),new vI(e.xmax,e.ymax)]},i._getExternalResources=function(){if(this.isEmpty())return[];for(var e,t,i=this.getGeometries(),n=[],r={},s=0,o=i.length;s<o;s++)if(i[s])for(var a=0,l=(e=vk(i[s]._getInternalSymbol())).length;a<l;a++)r[t=e[a].join()]||(n.push(e[a]),r[t]=1);return n},i.startEdit=function(e){var t=this;if(this.isEmpty())return this;e||(e={}),e.symbol&&(this._originalSymbol=this.getSymbol(),this.setSymbol(e.symbol)),this._draggbleBeforeEdit=this.options.draggable,this.config("draggable",!1);for(var i=this.getGeometries(),n=0,r=i.length;n<r;n++)i[n].startEdit(e);this._editing=!0;var s=this.getLayer();return s&&"canvas"===s.options.renderer&&this.hide(),setTimeout((function(){t.fire("editstart")}),1),this},i.endEdit=function(){if(this.isEmpty())return this;for(var e=this.getGeometries(),t=0,i=e.length;t<i;t++)e[t].endEdit();return this._originalSymbol&&(this.setSymbol(this._originalSymbol),delete this._originalSymbol),this._editing=!1,this.show(),this.config("draggable",this._draggbleBeforeEdit),this.fire("editend"),this},i.isEditing=function(){return!!this._editing},t}(UO);function ON(e,t){if(this.isEmpty())return null;for(var i=new OI,n=this.getGeometries(),r=0,s=n.length;r<s;r++)if(n[r]){var o=n[r][t](e);o&&i._combine(o)}return i}function NN(e){return e instanceof RN}RN.registerJSONType("GeometryCollection");var DN=function(e){function t(t,i,n,r){var s;return(s=e.call(this,null,r)||this).GeometryType=t,s.type=i,s._initData(n),s}tM(t,e);var i=t.prototype;return i.getCoordinates=function(){for(var e=[],t=this.getGeometries(),i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.getShell&&"Polygon"!==r.getJSONType()?[r.getShell()]:r.getCoordinates())}return e},i.setCoordinates=function(e){for(var t=[],i=0,n=(e=e||[]).length;i<n;i++){var r=new this.GeometryType(e[i],this.config());t.push(r)}return this.setGeometries(t),this},i._initData=function(e){(e=e||[]).length&&(e[0]instanceof this.GeometryType?this.setGeometries(e):this.setCoordinates(e))},i._checkGeo=function(e){return e instanceof this.GeometryType},i._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),t=vI.toNumberArrays(e);return{type:this.getType(),coordinates:t}},i._toJSON=function(e){return{feature:this.toGeoJSON(e)}},t}(RN),zN=function(e){function t(t,i){return e.call(this,MN,"MultiPoint",t,i)||this}return tM(t,e),t.prototype.findClosest=function(e){if(!e)return null;var t=this.getCoordinates(),i=null,n=1/0;return t.forEach((function(t){var r,s,o,a,l=(o=(s=e).x-(r=t).x,a=s.y-r.y,Math.sqrt(o*o+a*a));l<n&&(i=t,n=l)})),i},t}(DN);zN.registerJSONType("MultiPoint");var LN=function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.prototype.getCenterInExtent=function(e){var t=this.getGeometries(),i=0,n=0,r=0;return t.forEach((function(t){var s=t.getCenterInExtent(e);s&&(i+=s.x*s.count,n+=s.y*s.count,r+=s.count)})),0===r?null:new vI(i,n)._multi(1/r)},t}(DN),BN=function(e){function t(t,i){return e.call(this,AN,"MultiLineString",t,i)||this}return tM(t,e),t}(LN);BN.registerJSONType("MultiLineString");var FN=function(e){function t(t,i){return e.call(this,EN,"MultiPolygon",t,i)||this}return tM(t,e),t}(LN);FN.registerJSONType("MultiPolygon");var jN={Marker:MN,LineString:AN,Polygon:EN,MultiPoint:zN,MultiLineString:BN,MultiPolygon:FN},VN={toGeometry:function(e,t){if(fP(e)&&(e=gM(e)),Array.isArray(e)){for(var i=[],n=0,r=e.length;n<r;n++){var s=VN._convert(e[n],t);Array.isArray(s)?_M(i,s):i.push(s)}return i}return VN._convert(e,t)},toGeometryAsync:function(e,t,i){return void 0===i&&(i=2e3),fP(e)&&(e=gM(e)),new _A((function(n){var r,s=[];if(e&&(Array.isArray(e)||Array.isArray(e.features))){var o=dP(i)?Math.round(i):2e3,a=e.features||e,l=Math.ceil(a.length/o),c=1;(r={count:l,run:function(){var e=a.slice((c-1)*o,c*o),i=VN.toGeometry(e,t);return c++,i}},zA(),new _A((function(e,t){r?(gP(r)&&(r={count:1,run:r}),r.run?(uP(r.count)&&(r.count=1),r.count=Math.ceil(r.count),dP(r.count)?(r.results=[],AA.push(r),r.resolve=e):t(new Error("task.count is not number"))):t(new Error("task.run is null"))):t(new Error("task is null"))}))).then((function(e){for(var t=0,i=e.length;t<i;t++){var r=e[t];r&&(Array.isArray(r)?_M(s,r):s.push(r))}n(s)}))}else{var h=VN.toGeometry(e,t);n(h)}}))},_convert:function(e,t){if(!e||uP(e.type))return null;var i=e.type;if("Feature"===i){var n=VN._convert(e.geometry);return n?(n.setId(e.id),n.setProperties(e.properties),t&&t(n),n):null}if("FeatureCollection"===i){var r=e.features;return r?VN.toGeometry(r,t):null}if(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(i)>=0){var s=new jN["Point"===i?"Marker":i](e.coordinates);return t&&t(s),s}if("GeometryCollection"===i){var o=e.geometries;if(!EM(o)){var a=new RN;return t&&t(a),a}for(var l=[],c=o.length,h=0;h<c;h++)l.push(o[h].subType?UO.getJSONClass(o[h].subType).fromJSON(o[h]):VN._convert(o[h]));var u=new RN(l);return t&&t(u),u}return null},_isGeoJSON:function(e){if(!e)return!1;if(e=e||{},Array.isArray(e)&&e.length)return VN.isGeoJSON(e[0]);var t=e.type;if(!t)return!1;if(-1===rP.indexOf(t))return!1;var i=e.features,n=e.geometries,r=e.geometry,s=e.coordinates;if(s&&Array.isArray(s))return!0;if(Array.isArray(n))return!0;if(Array.isArray(i))return!0;if(r){var o=r.coordinates;if(o&&Array.isArray(o))return!0}return!1}},UN=function(e){function t(t,i,n){var r;return r=e.call(this,null,n)||this,t&&r.setCoordinates(t),r._radius=i,r}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(e.coordinates,e.radius,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i.getRadius=function(){return this._radius},i.setRadius=function(e){return this._radius=e,this.onShapeChanged(),this},i.getShell=function(){for(var e,t,i,n=this._getMeasurer(),r=this.getCoordinates(),s=this.options.numberOfShellPoints,o=this.getRadius(),a=[],l=0,c=s-1;l<c;l++){e=360*l/c*Math.PI/180,t=o*Math.cos(e),i=o*Math.sin(e);var h=n.locate(r,t,i);h.z=r.z,a.push(h)}return a.push(a[0]),a},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._containsPoint=function(t,i){var n=this.getMap();if(n.getPitch())return e.prototype._containsPoint.call(this,t,i);var r=n._pointToContainerPoint(this._getCenter2DPoint()),s=this.getSize(),o=this._hitTestTolerance()+(i||0),a=r.add(s.width/2,s.height/2);return QR(t,r,a,o)},i._computePrjExtent=function(e){var t=this._getMinMax(e);if(!t)return null;var i=this._getPrjCoordinates(),n=t.map((function(t){return e.project(t)})),r=n[1].x-i.x,s=n[3].y-i.y;return new OI(i.add(n[0].x-i.x,n[2].y-i.y),i.add(r,s))},i._computeExtent=function(e){var t=this._getMinMax(e);return t?new OI(t[0].x,t[2].y,t[1].x,t[3].y,this._getProjection()):null},i._getMinMax=function(e){if(!e||!this._coordinates||uP(this._radius))return null;var t=this._radius;return[e.locate(this._coordinates,-t,0),e.locate(this._coordinates,t,0),e.locate(this._coordinates,0,t),e.locate(this._coordinates,0,-t)]},i._computeGeodesicLength=function(){return uP(this._radius)?0:2*Math.PI*this._radius},i._computeGeodesicArea=function(){return uP(this._radius)?0:Math.PI*Math.pow(this._radius,2)},i._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:vI.toNumberArrays([this.getShell()])}},i._toJSON=function(e){var t=this.getCenter(),i=hP({},e);i.geometry=!1;var n=this.toGeoJSON(i);return n.geometry={type:"Polygon"},{feature:n,subType:"Circle",coordinates:[t.x,t.y],radius:this.getRadius()}},t}(TN(EN));UN.mergeOptions({numberOfShellPoints:60}),UN.registerJSONType("Circle");var qN=function(e){function t(t,i,n,r){var s;return s=e.call(this,null,r)||this,t&&s.setCoordinates(t),s.width=i,s.height=n,s}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(e.coordinates,e.width,e.height,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i.getWidth=function(){return this.width},i.setWidth=function(e){return this.width=e,this.onShapeChanged(),this},i.getHeight=function(){return this.height},i.setHeight=function(e){return this.height=e,this.onShapeChanged(),this},i.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},i._getShell=function(){for(var e,t,i,n,r=this._getMeasurer(),s=this.getCoordinates(),o=this.options.numberOfShellPoints-1,a=this.getWidth(),l=this.getHeight(),c=[],h=Math.pow(a/2,2)*Math.pow(l/2,2),u=Math.pow(a/2,2),d=Math.pow(l/2,2),p=0;p<o;p++){t=(e=360*p/o)*Math.PI/180,i=Math.sqrt(h/(u*Math.pow(Math.tan(t),2)+d)),n=Math.sqrt(h/(d*Math.pow(1/Math.tan(t),2)+u)),e>90&&e<270&&(i*=-1),e>180&&e<360&&(n*=-1);var m=r.locate(s,i,n);m.z=s.z,c.push(m)}return c.push(c[0].copy()),c},i._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this);return this._rotatePrjCoordinates(t)},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._containsPoint=function(t,i){var n=this.getMap();if(n.isTransforming())return e.prototype._containsPoint.call(this,t,i);var r=n.getProjection(),s=this._hitTestTolerance()+(i||0),o=r.projectCoords([this._coordinates,n.locate(this._coordinates,this.getWidth()/2,this.getHeight()/2)],this.options.antiMeridian);return QR(t,n._prjToContainerPoint(o[0]),n._prjToContainerPoint(o[1]),s)},i._computePrjExtent=function(){return this.isRotated()?this._computeRotatedPrjExtent():UN.prototype._computePrjExtent.apply(this,arguments)},i._computeExtent=function(){return UN.prototype._computeExtent.apply(this,arguments)},i._getMinMax=function(e){if(!e||!this._coordinates||uP(this.width)||uP(this.height))return null;var t=this.getWidth(),i=this.getHeight();return[e.locate(this._coordinates,-t/2,0),e.locate(this._coordinates,t/2,0),e.locate(this._coordinates,0,-i/2),e.locate(this._coordinates,0,i/2)]},i._computeGeodesicLength=function(){return uP(this.width)||uP(this.height)?0:2*Math.PI*(this.width>this.height?this.width:this.height)/2-4*Math.abs(this.width-this.height)},i._computeGeodesicArea=function(){return uP(this.width)||uP(this.height)?0:Math.PI*this.width*this.height/4},i._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:vI.toNumberArrays([this.getShell()])}},i._toJSON=function(e){var t=hP({},e),i=this.getCenter();t.geometry=!1;var n=this.toGeoJSON(t);return n.geometry={type:"Polygon"},{feature:n,subType:"Ellipse",coordinates:[i.x,i.y],width:this.getWidth(),height:this.getHeight()}},t}(TN(EN));qN.mergeOptions({numberOfShellPoints:81}),qN.registerJSONType("Ellipse");var HN=function(e){function t(t,i,n,r){var s;return s=e.call(this,null,r)||this,t&&s.setCoordinates(t),s._width=i,s._height=n,s}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(e.coordinates,e.width,e.height,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i.getCoordinates=function(){return this._coordinates},i.setCoordinates=function(e){if(this._coordinates=e instanceof vI?e:new vI(e),!this._coordinates||!this.getMap())return this.onPositionChanged(),this;var t=this._getProjection();return this._setPrjCoordinates(t.project(this._coordinates)),this},i.getWidth=function(){return this._width},i.setWidth=function(e){return this._width=e,this.onShapeChanged(),this},i.getHeight=function(){return this._height},i.setHeight=function(e){return this._height=e,this.onShapeChanged(),this},i.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},i._getShell=function(){var e=this._getMeasurer(),t=this._coordinates,i=this.getMap(),n=1,r=-1;if(i){var s=i.getFullExtent();s.left>s.right&&(n=-1),s.bottom>s.top&&(r=1)}var o=[];o.push(t);var a=e.locate(t,n*this._width,0);a.z=t.z,o.push(a);var l=e.locate(t,n*this._width,r*this._height);l.z=t.z,o.push(l);var c=e.locate(t,0,r*this._height);return o.push(c),c.z=t.z,o.push(t),o},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._getPrjCoordinates=function(){var e=this._getProjection();return this._verifyProjection(),!this._pnw&&e&&this._coordinates&&(this._pnw=e.project(this._coordinates)),this._pnw},i._setPrjCoordinates=function(e){this._pnw=e,this.onPositionChanged()},i._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this),i=this._getProjection();if(!i.isSphere())return this._rotatePrjCoordinates(t);for(var n=i.getSphereExtent(),r=n.sx,s=n.sy,o=this._getProjection().getCircum(),a=t[0],l=1,c=t.length;l<c;l++){var h=t[l],u=0,d=0;r*(a.x-h.x)>0&&(u=o.x*r),s*(a.y-h.y)<0&&(d=o.y*s),t[l]._add(u,d)}return this._rotatePrjCoordinates(t)},i._updateCache=function(){this._clearCache();var e=this._getProjection();this._pnw&&e&&(this._coordinates=e.unproject(this._pnw))},i._clearProjection=function(){this._pnw=null,e.prototype._clearProjection.call(this)},i._computeCenter=function(e){return e.locate(this._coordinates,this._width/2,-this._height/2)},i._containsPoint=function(t,i){var n=this.getMap();if(n.isTransforming())return e.prototype._containsPoint.call(this,t,i);var r=uP(i)?this._hitTestTolerance():i,s=n._getResolution()*r,o=this._getPrjExtent().expand(s),a=n._containerPointToPrj(t);return o.contains(a)},i._computePrjExtent=function(e){if(this.isRotated())return this._computeRotatedPrjExtent();var t=this._getSouthEast(e);if(!t)return null;var i=e.projectCoords([new vI(this._coordinates.x,t.y),new vI(t.x,this._coordinates.y)],this.options.antiMeridian);return new OI(i[0],i[1])},i._computeExtent=function(e){var t=this._getSouthEast(e);return t?new OI(this._coordinates,t,this._getProjection()):null},i._getSouthEast=function(e){if(!e||!this._coordinates||uP(this._width)||uP(this._height))return null;var t=this.getWidth(),i=-this.getHeight();if(e.fullExtent){var n=e.fullExtent;t*=n.right>n.left?1:-1,i*=n.top>n.bottom?1:-1}var r=e.locate(this._coordinates,t,0),s=e.locate(this._coordinates,0,i);return r.y=s.y,r},i._computeGeodesicLength=function(){return uP(this._width)||uP(this._height)?0:2*(this._width+this._height)},i._computeGeodesicArea=function(){return uP(this._width)||uP(this._height)?0:this._width*this._height},i._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:vI.toNumberArrays([this.getShell()])}},i._toJSON=function(e){var t=hP({},e),i=this.getCoordinates();t.geometry=!1;var n=this.toGeoJSON(t);return n.geometry={type:"Polygon"},{feature:n,subType:"Rectangle",coordinates:[i.x,i.y],width:this.getWidth(),height:this.getHeight()}},t}(EN);HN.registerJSONType("Rectangle");var GN=function(e){function t(t,i,n,r,s){var o;return(o=e.call(this,t,i,s)||this).startAngle=n,o.endAngle=r,o}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(e.coordinates,e.radius,e.startAngle,e.endAngle,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i.getStartAngle=function(){return this.startAngle},i.setStartAngle=function(e){return this.startAngle=e,this.onShapeChanged(),this},i.getEndAngle=function(){return this.endAngle},i.setEndAngle=function(e){return this.endAngle=e,this.onShapeChanged(),this},i.getShell=function(){return this.isRotated()?this.getRotatedShell():this._getShell()},i._getShell=function(){for(var e,t,i,n=this._getMeasurer(),r=this.getCoordinates(),s=this.options.numberOfShellPoints-2,o=this.getRadius(),a=[r.copy()],l=this.getStartAngle(),c=this.getEndAngle()-l,h=0;h<s;h++){e=(c*h/(s-1)+l)*Math.PI/180,t=o*Math.cos(e),i=o*Math.sin(e);var u=n.locate(r,t,i);u.z=r.z,a.push(u)}return a.push(r.copy()),a},i.getRotateOffsetAngle=function(){return 90},i._getPrjShell=function(){var t=e.prototype._getPrjShell.call(this);return this._rotatePrjCoordinates(t)},i._computePrjExtent=function(){return this.isRotated()?this._computeRotatedPrjExtent():UN.prototype._computePrjExtent.apply(this,arguments)},i._containsPoint=function(t,i){var n=this.getMap();if(n.isTransforming())return e.prototype._containsPoint.call(this,t,i);var r,s=n._pointToContainerPoint(this._getCenter2DPoint()),o=this._hitTestTolerance()+(i||0),a=this.getSize(),l=s,c=t,h=Math.atan2(l.y-c.y,c.x-l.x),u=h<0?360*(h+2*Math.PI)/(2*Math.PI):360*h/(2*Math.PI),d=this.startAngle%360,p=this.endAngle%360;return r=d>p?!(u>p&&u<d):u>=d&&u<=p,c.distanceTo(l)<=a.width/2+o&&r},i._computeGeodesicLength=function(){return uP(this._radius)?0:2*Math.PI*this._radius*Math.abs(this.startAngle-this.endAngle)/360+2*this._radius},i._computeGeodesicArea=function(){return uP(this._radius)?0:Math.PI*Math.pow(this._radius,2)*Math.abs(this.startAngle-this.endAngle)/360},i._toJSON=function(e){var t=hP({},e),i=this.getCenter();t.geometry=!1;var n=this.toGeoJSON(t);return n.geometry={type:"Polygon"},{feature:n,subType:"Sector",coordinates:[i.x,i.y],radius:this.getRadius(),startAngle:this.getStartAngle(),endAngle:this.getEndAngle()}},t}(UN);GN.mergeOptions({numberOfShellPoints:60}),GN.registerJSONType("Sector");var WN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i._arc=function(e,t,i){for(var n=this.options.arcDegree*Math.PI/180,r=1,s=t.length;r<s;r++){var o=YA._arcBetween(e,t[r-1],t[r],n),a=[t[r-1].x+t[r].x-o[0],t[r-1].y+t[r].y-o[1]];t[r-1].nextCtrlPoint=a,t[r].prevCtrlPoint=a,YA._stroke(e,i)}},i._quadraticCurve=function(e,t){if(t.length<=2)YA._path(e,t);else{var i,n;for(i=2,n=t.length;i<n;i+=2)e.quadraticCurveTo(t[i-1].x,t[i-1].y,t[i].x,t[i].y);if((i-=1)<n)for(;i<n;i++)e.lineTo(t[i].x,t[i].y)}},i._bezierCurve=function(e,t){if(t.length<=3)YA._path(e,t);else{var i,n;for(i=1,n=t.length;i+2<n;i+=3)e.bezierCurveTo(t[i].x,t[i].y,t[i+1].x,t[i+1].y,t[i+2].x,t[i+2].y);if(i<n)for(;i<n;i++)e.lineTo(t[i].x,t[i].y)}},i._getCurveArrowPoints=function(e,t,i,n,r,s){var o,a=t.length;for(o=s;o<a;o+=s){var l=this._getArrowShape(t[o-1],t[o],i,n,r);l&&e.push(l)}if((o-=s)<a-1)for(o+=1;o<a;o++){var c=this._getArrowShape(t[o-1],t[o],i,n,r);c&&e.push(c)}},t}(AN);WN.mergeOptions({enableSimplify:!1,enableClip:!1});var ZN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"ArcCurve"}},i._paintOn=function(e,t,i){e.beginPath(),this._arc(e,t,i),YA._stroke(e,i),this._paintArrow(e,t,i)},t.fromJSON=function(e){var i=e.feature,n=new t(i.geometry.coordinates,e.options);return n.setProperties(i.properties),n},t}(WN);ZN.registerJSONType("ArcCurve"),ZN.mergeOptions({arcDegree:90});var $N=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(i.geometry.coordinates,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"CubicBezierCurve"}},i._paintOn=function(e,t,i){e.beginPath(),e.moveTo(t[0].x,t[0].y),this._bezierCurve(e,t),YA._stroke(e,i),this._paintArrow(e,t,i)},i._getArrowPoints=function(e,t,i,n,r){return this._getCurveArrowPoints(e,t,i,n,r,3)},t}(WN);$N.registerJSONType("CubicBezierCurve");var XN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e),t.fromJSON=function(e){var i=e.feature,n=new t(i.geometry.coordinates,e.options);return n.setProperties(i.properties),n};var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"QuadBezierCurve"}},i._paintOn=function(e,t,i){e.beginPath(),e.moveTo(t[0].x,t[0].y),this._quadraticCurve(e,t,i),YA._stroke(e,i),this._paintArrow(e,t,i)},i._getArrowPoints=function(e,t,i,n,r){return this._getCurveArrowPoints(e,t,i,n,r,2)},t}(WN);XN.registerJSONType("QuadBezierCurve");var KN={textFaceName:"monospace",textSize:12,textLineSpacing:8,textWrapCharacter:"\n",textHorizontalAlignment:"middle",textVerticalAlignment:"middle"},YN={markerType:"square",markerLineColor:"#000",markerLineWidth:2,markerLineOpacity:1,markerFill:"#fff",markerOpacity:1},JN=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.getContent=function(){return this._content},i.setContent=function(e){var t=this._content;return this._content=Ek(e),this._refresh(),this._fireEvent("contentchange",{old:t,new:e}),this},i.onAdd=function(){this._refresh()},i.toJSON=function(){var t=e.prototype.toJSON.call(this);return delete t.symbol,t},i.setSymbol=function(t){if(this._refreshing||!t)return e.prototype.setSymbol.call(this,t);var i=this._parseSymbol(t);if(this.setTextStyle){var n=this.getTextStyle()||{};n.symbol=i[0],this.setTextStyle(n)}else this.setTextSymbol&&this.setTextSymbol(i[0]);if(this.setBoxStyle){var r=this.getBoxStyle()||{};r.symbol=i[1],this.setBoxStyle(r)}else this.setBoxSymbol&&this.setBoxSymbol(i[1]);return this},i._parseSymbol=function(e){var t={},i={};for(var n in e)yP(e,n)&&(0===n.indexOf("text")?t[n]=e[n]:i[n]=e[n]);return[t,i]},i._getTextSize=function(e){return Dk(this._content,e).size},i._getInternalSymbol=function(){return this._symbol},i._getDefaultTextSymbol=function(){return hP({},KN)},i._getDefaultBoxSymbol=function(){return hP({},YN)},i._getDefaultPadding=function(){return[12,8]},t}(MN),QN=function(e){function t(t,i,n,r,s){var o;return void 0===s&&(s={}),(o=e.call(this,i,s)||this)._content=Ek(t),o._width=uP(n)?100:n,o._height=uP(r)?40:r,s.boxSymbol&&o.setBoxSymbol(s.boxSymbol),s.textStyle&&o.setTextStyle(s.textStyle),o._refresh(),o}tM(t,e);var i=t.prototype;return i.getWidth=function(){return this._width},i.setWidth=function(e){return this._width=e,this._refresh(),this},i.getHeight=function(){return this._height},i.setHeight=function(e){return this._height=e,this._refresh(),this},i.getBoxSymbol=function(){return hP({},this.options.boxSymbol)},i.setBoxSymbol=function(e){return this.options.boxSymbol=e?hP({},e):e,this.getSymbol()&&this._refresh(),this},i.getTextStyle=function(){return this.options.textStyle?hP({},this.options.textStyle):null},i.setTextStyle=function(e){return this.options.textStyle=e?hP({},e):e,this.getSymbol()&&this._refresh(),this},t.fromJSON=function(e){var i=e.feature,n=new t(e.content,i.geometry.coordinates,e.width,e.height,e.options);return n.setProperties(i.properties),n.setId(i.id),e.symbol&&n.setSymbol(e.symbol),n},i._toJSON=function(e){return{feature:this.toGeoJSON(e),width:this.getWidth(),height:this.getHeight(),subType:"TextBox",content:this._content}},i._refresh=function(){var e,t,i=this.getTextStyle()||{},n=i.padding||[12,8];if(YM(this._width)){var r=(e=JSON.parse(JSON.stringify(this._width))).stops;if(r)for(var s=0;s<r.length;s++)r[s][1]=r[s][1]-2*n[0]}else e=this._width-2*n[0];if(YM(this._height)){var o=(t=JSON.parse(JSON.stringify(this._height))).stops;if(o)for(var a=0;a<o.length;a++)o[a][1]=o[a][1]-2*n[1]}else t=this._height-2*n[1];var l=hP({},i.symbol||this._getDefaultTextSymbol(),this.options.boxSymbol||this._getDefaultBoxSymbol(),{textName:this._content,markerWidth:this._width,markerHeight:this._height,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textMaxWidth:e,textMaxHeight:t});i.wrap&&!l.textWrapWidth&&(l.textWrapWidth=e);var c,h=i.horizontalAlignment;if(l.textDx=l.markerDx||0,YM(this._width)){var u=(c=JSON.parse(JSON.stringify(this._width))).stops;if(u)for(var d=0;d<u.length;d++)u[d][1]=u[d][1]/2-n[0],"left"===h&&(u[d][1]*=-1)}else c=l.markerWidth/2-n[0],"left"===h&&(c*=-1);"left"===h?(l.textHorizontalAlignment="right",l.textDx=c):"right"===h&&(l.textHorizontalAlignment="left",l.textDx=c);var p,m=i.verticalAlignment;if(l.textDy=l.markerDy||0,YM(this._height)){var f=(p=JSON.parse(JSON.stringify(this._height))).stops;if(f)for(var g=0;g<f.length;g++)f[g][1]=f[g][1]/2-n[1],"top"===m&&(f[g][1]*=-1)}else p=l.markerHeight/2-n[1],"top"===m&&(p*=-1);"top"===m?(l.textVerticalAlignment="bottom",l.textDy=p):"bottom"===m&&(l.textVerticalAlignment="top",l.textDy=p),this._refreshing=!0,this.updateSymbol(l),delete this._refreshing},i.startEdit=function(t){var i=this._getCompiledSymbol();if(YM(this._width)){var n=i.markerWidth;this._oldWidth=this._width,this.setWidth(n)}if(YM(this._height)){var r=i.markerHeight;this._oldHeight=this._height,this.setHeight(r)}e.prototype.startEdit.call(this,t)},i.endEdit=function(){var t=this.getMap(),i=t&&t.getZoom();if(this._oldWidth){for(var n=this._width/QM(this._oldWidth)(i),r=this._oldWidth.stops,s=0;s<r.length;s++)r[s][1]*=n;this.setWidth(this._oldWidth),delete this._oldWidth}if(this._oldHeight){for(var o=this._height/QM(this._oldHeight)(i),a=this._oldHeight.stops,l=0;l<a.length;l++)a[l][1]*=o;this.setHeight(this._oldHeight),delete this._oldHeight}e.prototype.endEdit.call(this)},t}(JN);QN.mergeOptions({textStyle:{wrap:!0,padding:[12,8],verticalAlignment:"middle",horizontalAlignment:"middle"},boxSymbol:null}),QN.registerJSONType("TextBox");var eD=function(e){function t(t,i,n){var r;return void 0===n&&(n={}),r=e.call(this,i,n)||this,n.textSymbol&&r.setTextSymbol(n.textSymbol),n.boxStyle&&r.setBoxStyle(n.boxStyle),r._content=Ek(t),r._refresh(),r}tM(t,e);var i=t.prototype;return i.getBoxStyle=function(){return this.options.boxStyle?hP({},this.options.boxStyle):null},i.setBoxStyle=function(e){return this.options.boxStyle=e?hP({},e):e,this._refresh(),this},i.getTextSymbol=function(){return hP({},this._getDefaultTextSymbol(),this.options.textSymbol)},i.setTextSymbol=function(e){return this.options.textSymbol=e?hP({},e):e,this._refresh(),this},t.fromJSON=function(e){var i=e.feature,n=new t(e.content,i.geometry.coordinates,e.options);return n.setProperties(i.properties),n.setId(i.id),e.symbol&&n.setSymbol(e.symbol),n},i._canEdit=function(){return!1},i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"Label",content:this._content}},i._refresh=function(){var e=hP({},this.getTextSymbol(),{textName:this._content}),t=this.getBoxStyle();if(t){hP(e,t.symbol);var i=this._getBoxSize(e),n=i[1],r=t.padding||this._getDefaultPadding(),s=i[0];e.markerWidth=s.width,e.markerHeight=s.height;var o=e.textDx||0,a=e.textDy||0,l=Ok(n,e.textHorizontalAlignment,e.textVerticalAlignment)._add(o,a),c=t.horizontalAlignment||"middle";e.markerDx=l.x,"left"===c?e.markerDx+=e.markerWidth/2-r[0]:"right"===c?e.markerDx-=e.markerWidth/2-n.width-r[0]:e.markerDx+=n.width/2;var h=t.verticalAlignment||"middle";e.markerDy=l.y,"top"===h?e.markerDy+=e.markerHeight/2-r[1]:"bottom"===h?e.markerDy-=e.markerHeight/2-n.height-r[1]:e.markerDy+=n.height/2}this._refreshing=!0,this.updateSymbol(e),delete this._refreshing},i._getBoxSize=function(e){e.markerType||(e.markerType="square");var t,i,n=this.getBoxStyle(),r=this._getTextSize(e),s=n.padding||this._getDefaultPadding();return t=r.width+2*s[0],i=r.height+2*s[1],n.minWidth&&(!t||t<n.minWidth)&&(t=n.minWidth),n.minHeight&&(!i||i<n.minHeight)&&(i=n.minHeight),[new wk(t,i),r]},t}(JN);eD.mergeOptions({boxStyle:null,textSymbol:null}),eD.registerJSONType("Label");var tD=function(e){return function(e){function t(){return e.apply(this,arguments)||this}tM(t,e),t._hasConnectors=function(e){return!uP(e.__connectors)&&e.__connectors.length>0},t._getConnectors=function(e){return e.__connectors};var i=t.prototype;return i.getConnectSource=function(){return this._connSource},i.setConnectSource=function(e){var t=this._connTarget;return this.onRemove(),this._connSource=e,this._connTarget=t,this.onAdd(),this},i.getConnectTarget=function(){return this._connTarget},i.setConnectTarget=function(e){var t=this._connSource;return this.onRemove(),this._connSource=t,this._connTarget=e,this._updateCoordinates(),this._registerEvents(),this},i._updateCoordinates=function(){var e=this.getMap();if(!e&&this._connSource&&(e=this._connSource.getMap()),!e&&this._connTarget&&(e=this._connTarget.getMap()),e&&this._connSource&&this._connTarget){for(var t,i,n=this._connSource._getConnectPoints(),r=this._connTarget._getConnectPoints(),s=0,o=this.getCoordinates(),a=0,l=n.length;a<l;a++)for(var c=n[a],h=0,u=r.length;h<u;h++){var d=r[h],p=e.computeLength(c,d);0===a&&0===h?(t=c,i=d,s=p):p<s&&(t=c,i=d)}EM(o)&&o[0].equals(t)&&o[1].equals(i)||this.setCoordinates([t,i])}},i.onAdd=function(){this._registerEvents(),this._updateCoordinates()},i.onRemove=function(){if(this._connSource&&(this._connSource.__connectors&&yM(this,this._connSource.__connectors),this._connSource.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connSource.off("dragstart mousedown mouseover",this._showConnect,this),this._connSource.off("dragend mouseup mouseout",this.hide,this),this._connSource.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connSource),this._connTarget&&(yM(this,this._connTarget.__connectors),this._connTarget.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connTarget.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connTarget),!(this._connSource instanceof UO&&this._connTarget instanceof UO)){var e=this.getMap();e&&e.off("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}},i._showConnect=function(){this._connSource&&this._connTarget&&this._connSource.isVisible()&&this._connTarget.isVisible()&&(this._updateCoordinates(),this.show())},i._registerEvents=function(){if(this._connSource&&this._connTarget){this._connSource.__connectors||(this._connSource.__connectors=[]),this._connTarget.__connectors||(this._connTarget.__connectors=[]),this._connSource.__connectors.push(this),this._connTarget.__connectors.push(this),this._connSource.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connTarget.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connSource.on("show",this._showConnect,this).on("hide",this.hide,this),this._connTarget.on("show",this._showConnect,this).on("hide",this.hide,this);var e=this.options.showOn;if(this.hide(),"moving"===e?(this._connSource.on("dragstart",this._showConnect,this).on("dragend",this.hide,this),this._connTarget.on("dragstart",this._showConnect,this).on("dragend",this.hide,this)):"click"===e?(this._connSource.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this),this._connTarget.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this)):"mouseover"===e?(this._connSource.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this),this._connTarget.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this)):this._showConnect(),!(this._connSource instanceof UO&&this._connTarget instanceof UO)){var t=this.getMap();t&&t.on("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}}},t}(e)},iD={showOn:"always"},nD=function(e){function t(t,i,n){var r;return r=e.call(this,null,n)||this,1===arguments.length&&(n=t,t=null,i=null),r._connSource=t,r._connTarget=i,r}return tM(t,e),t}(tD(AN));nD.mergeOptions(iD),nD.registerJSONType("ConnectorLine");var rD=function(e){function t(t,i,n){var r;return r=e.call(this,null,n)||this,1===arguments.length&&(n=t,t=null,i=null),r._connSource=t,r._connTarget=i,r}return tM(t,e),t}(tD(ZN));function sD(e){return e&&e instanceof UO}rD.mergeOptions(iD),rD.registerJSONType("ArcConnectorLine");var oD=[],aD=function(e){function t(t,i,n){var r;i&&!sD(i)&&!Array.isArray(i)&&rP.indexOf(i.type)<0&&(n=i,i=null),(r=e.call(this,t,n)||this)._maxZIndex=0,r._minZIndex=0,r._initCache(),i&&r.addGeometry(i);var s=r.options.style;return s&&r.setStyle(s),r}tM(t,e);var i=t.prototype;return i.getGeometryById=function(e){return uP(e)||""===e?null:this._geoMap[e]?this._geoMap[e]:null},i.getGeometries=function(e,t){if(!e)return this._geoList.slice(0);for(var i,n=[],r=0,s=this._geoList.length;r<s;r++)i=this._geoList[r],(t?e.call(t,i):e(i))&&n.push(i);return n},i.getFirstGeometry=function(){return this._geoList.length?this._geoList[0]:null},i.getLastGeometry=function(){var e=this._geoList.length;return 0===e?null:this._geoList[e-1]},i.getCount=function(){return this._geoList.length},i.getExtent=function(){if(0===this.getCount())return null;var e=new OI(this.getProjection());return this.forEach((function(t){e._combine(t.getExtent())})),e},i.forEach=function(e,t){for(var i=this._geoList.slice(0),n=0,r=i.length;n<r;n++)t?e.call(t,i[n],n):e(i[n],n);return this},i.filter=function(e,t){var i=[],n=gP(e),r=n?e:nk(e);return this.forEach((function(e){var s=n?e:pk(e);(t?r.call(t,s):r(s))&&i.push(e)}),this),i},i.isEmpty=function(){return!this._geoList.length},i.addGeometry=function(e,t){if(!e)return this;if("FeatureCollection"===e.type)return this.addGeometry(VN.toGeometry(e),t);if(!Array.isArray(e)){var i=arguments.length,n=arguments[i-1];return e=Array.prototype.slice.call(arguments,0,i-1),t=n,n&&mP(n)&&("type"in n||sD(n))&&(e.push(n),t=!1),this.addGeometry(e,t)}if(0===e.length)return this;var r;this._initCache(),t&&(r=new OI),this._toSort=this._maxZIndex>0;for(var s=[],o=0,a=e.length;o<a;o++){var l=e[o];if(!l||!VN._isGeoJSON(l)&&!sD(l))throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+o);if(!l.getLayer||l.getLayer()!==this){if(!sD(l)&&(l=UO.fromJSON(l),Array.isArray(l)))for(var c=0,h=l.length;c<h;c++)this._add(l[c],r,o),s.push(l[c]);if(!l)throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+o);Array.isArray(l)||(this._add(l,r,o),s.push(l))}}var u=this.getMap();if(u&&(this._getRenderer().onGeometryAdd(s),r&&!uP(r.xmin))){var d=r.getCenter(),p=u.getFitZoom(r);if(mP(t)){var m=gP(t.step)?t.step:function(){};u.animateTo({center:d,zoom:p},hP({duration:u.options.zoomAnimationDuration,easing:"out"},t),m)}else!0===t&&u.setCenterAndZoom(d,p)}return this.fire("addgeo",{geometries:e}),this},i.getGeoMinZIndex=function(){return this._minZIndex},i.getGeoMaxZIndex=function(){return this._maxZIndex},i._add=function(e,t,i){this._toSort||(this._toSort=0!==e.getZIndex()),this._updateZIndex(e.getZIndex());var n=e.getId();if(!uP(n)){if(!uP(this._geoMap[n]))throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+n+", at index:"+i);this._geoMap[n]=e}var r=fM();e._setInternalId(r),this._geoList.push(e),this.onAddGeometry(e),e._bindLayer(this),e.onAdd&&e.onAdd(),t&&t._combine(e.getExtent()),e._fireEvent("add",{layer:this}),this._cookedStyles&&this._styleGeometry(e)},i.removeGeometry=function(e){if(!Array.isArray(e))return this.removeGeometry([e]);for(var t=e.length-1;t>=0;t--)e[t]instanceof UO||(e[t]=this.getGeometryById(e[t])),e[t]&&this===e[t].getLayer()&&e[t].remove();return this.fire("removegeo",{geometries:e}),this},i.clear=function(){this._clearing=!0,this.forEach((function(e){e.remove()})),this._geoMap={};var e=this._geoList;this._geoList=[];var t=this._getRenderer();return t&&(t.onGeometryRemove(e),t.clearImageData&&(t.clearImageData(),delete t._lastGeosToDraw)),this._clearing=!1,this.fire("clear"),this},i.onRemoveGeometry=function(e){if(e&&!this._clearing&&this===e.getLayer()&&!uP(e._getInternalId())){var t=e.getId();uP(t)||delete this._geoMap[t];var i=this._findInList(e);i>=0&&this._geoList.splice(i,1),this._getRenderer()&&this._getRenderer().onGeometryRemove([e])}},i.getStyle=function(){return this.options.style?this.options.style:null},i.setStyle=function(e){return this.options.style=e,e=function(e){if(e.symbol&&(e=[e]),Array.isArray(e))return e;var t=e.$root,i=e.$iconset;return e=e.style,(t||i)&&(t&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),i&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),function(e,t){for(var i=0;i<e.length;i++){var n=e[i].symbol;n&&qk(n,t)}}(e,(function(e){return"{$root}"===e?t:"{$iconset}"===e?i:null}))),e}(e),this._cookedStyles=function e(t){if(!Array.isArray(t))return e([t]);for(var i=[],n=0;n<t.length;n++){var r;r=!0===t[n].filter?function(){return!0}:nk(t[n].filter),i.push(mk({},t[n],{filter:r}))}return i}(e),this.forEach((function(e){this._styleGeometry(e)}),this),this.fire("setstyle",{style:e}),this},i._styleGeometry=function(e){if(!this._cookedStyles)return!1;for(var t=pk(e),i=0,n=this._cookedStyles.length;i<n;i++)if(!0===this._cookedStyles[i].filter(t))return e._setExternSymbol(this._cookedStyles[i].symbol),!0;return!1},i.removeStyle=function(){return this.options.style?(delete this.options.style,delete this._cookedStyles,this.forEach((function(e){e._setExternSymbol(null)}),this),this.fire("removestyle"),this):this},i.onAddGeometry=function(e){this.getStyle()&&this._styleGeometry(e)},i.hide=function(){for(var e=0,t=this._geoList.length;e<t;e++)this._geoList[e].onHide();return ZO.prototype.hide.call(this)},i._initCache=function(){this._geoList||(this._geoList=[],this._geoMap={})},i._updateZIndex=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this._maxZIndex=Math.max(this._maxZIndex,Math.max.apply(Math,t)),this._minZIndex=Math.min(this._minZIndex,Math.min.apply(Math,t))},i._sortGeometries=function(){var e=this;this._toSort&&(this._maxZIndex=0,this._minZIndex=0,this._geoList.sort((function(t,i){return e._updateZIndex(t.getZIndex(),i.getZIndex()),e._compare(t,i)})),this._toSort=!1)},i._compare=function(e,t){return e.getZIndex()===t.getZIndex()?e._getInternalId()-t._getInternalId():e.getZIndex()-t.getZIndex()},i._findInList=function(e){var t=this._geoList.length;if(0===t)return-1;this._sortGeometries();for(var i,n=0,r=t-1;n<=r;){if(i=Math.floor((n+r)/2),this._geoList[i]===e)return i;this._compare(this._geoList[i],e)>0?r=i-1:n=i+1}return-1},i._onGeometryEvent=function(e){if(e&&e.target){var t=e.type;"idchange"===t?this._onGeometryIdChange(e):"zindexchange"===t?this._onGeometryZIndexChange(e):"positionchange"===t?this._onGeometryPositionChange(e):"shapechange"===t?this._onGeometryShapeChange(e):"symbolchange"===t?this._onGeometrySymbolChange(e):"show"===t?this._onGeometryShow(e):"hide"===t?this._onGeometryHide(e):"propertieschange"===t&&this._onGeometryPropertiesChange(e)}},i._onGeometryIdChange=function(e){if(e.new!==e.old||!this._geoMap[e.old]||this._geoMap[e.old]!==e.target){if(!uP(e.new)){if(this._geoMap[e.new])throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+e.new);this._geoMap[e.new]=e.target}uP(e.old)||e.new===e.old||delete this._geoMap[e.old]}},i._onGeometryZIndexChange=function(e){e.old!==e.new&&(this._updateZIndex(e.new),this._toSort=!0,this._getRenderer()&&this._getRenderer().onGeometryZIndexChange(e))},i._onGeometryPositionChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPositionChange(e)},i._onGeometryShapeChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryShapeChange(e)},i._onGeometrySymbolChange=function(e){this._getRenderer()&&this._getRenderer().onGeometrySymbolChange(e)},i._onGeometryShow=function(e){this._getRenderer()&&this._getRenderer().onGeometryShow(e)},i._onGeometryHide=function(e){this._getRenderer()&&this._getRenderer().onGeometryHide(e)},i._onGeometryPropertiesChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPropertiesChange(e)},i._hasGeoListeners=function(e){if(!e)return!1;Array.isArray(e)||(oD[0]=e,e=oD);for(var t=this.getGeometries()||[],i=0,n=t.length;i<n;i++){var r=t[i];if(r){if(r.options.cursor)return!0;for(var s=0,o=e.length;s<o;s++)if(r.listens(e[s])>0)return!0}}return!1},t}(ZO);aD.mergeOptions({drawImmediate:!1,geometryEvents:!0,geometryEventTolerance:1});var lD=new DI,cD={debug:!1,enableSimplify:!0,defaultIconSize:[20,20],cacheVectorOnCanvas:!0,cacheSvgOnCanvas:QP.gecko,enableAltitude:!1,altitudeProperty:"altitude",drawAltitude:!1,sortByDistanceToCamera:!1,roundPoint:!1,altitude:0,clipBBoxBufferSize:3,collision:!1,collisionBufferSize:2,collisionDelay:250,collisionScope:"layer",progressiveRender:!1,progressiveRenderCount:1e3,progressiveRenderDebug:!1},hD=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}tM(t,e);var i=t.prototype;return i.onConfig=function(t){if(e.prototype.onConfig.call(this,t),t.enableAltitude||t.drawAltitude||t.altitudeProperty){var i=this.getRenderer();i&&i.setToRedraw&&i.setToRedraw()}},i.identify=function(e,t){void 0===t&&(t={});var i=this.getRenderer();e instanceof vI||(e=new vI(e));var n=this.getMap().coordToContainerPoint(e);return t.onlyVisible&&i&&i.identifyAtPoint?i.identifyAtPoint(n,t):this._hitGeos(this._geoList,n,t)},i.identifyAtPoint=function(e,t){void 0===t&&(t={});var i=this.getRenderer();return e instanceof uM||(e=new uM(e)),t.onlyVisible&&i&&i.identifyAtPoint?i.identifyAtPoint(e,t):this._hitGeos(this._geoList,e,t)},i._hitGeos=function(e,t,i){if(void 0===i&&(i={}),!e||!e.length)return[];var n=i.filter,r=[],s=i.tolerance,o=this.getMap(),a=this.getRenderer(),l=a&&a.getImageData&&a.getImageData();if(l){var c=0,h=a.maxTolerance;if(dP(h))c=h;else for(var u=e.length-1;u>=0;u--){var d=e[u]._hitTestTolerance()+(s||0);d>c&&(c=d)}var p=o.getDevicePixelRatio();l.r=p;for(var m=!1,f=t.x-c,g=t.y-c,_=-c;_<=c;_++){for(var y=-c;y<=c;y++){var v=Math.round((f+_)*p),x=Math.round((g+y)*p);if(l.data[x*l.width*4+4*v+3]>0){m=!0;break}}if(m)break}if(!m)return r}for(var b=i.onlyVisible,w=e.length-1;w>=0;w--){var C=e[w];if(C&&C.options.interactive&&(b||C.isVisible())){var S=C._getPainter();if(S){var E=S.getRenderBBOX&&S.getRenderBBOX();if(E){var T=t.x,P=t.y;if(T<E[0]||P<E[1]||T>E[2]||P>E[3])continue}if(!(C instanceof AN&&(C._getArrowStyle()||C instanceof WN))){var M=C.getContainerExtent(lD);if(s&&(M=M._expand(s)),!M||!M.contains(t))continue}if(C._containsPoint(t,s)&&(!n||n(C))&&(r.push(C),i.count&&r.length>=i.count))break}}}return r},i.getAltitude=function(){return this.options.altitude||0},i.toJSON=function(e){e||(e={});var t={type:this.getJSONType(),id:this.getId(),options:this.config()};if(uP(e.geometries)||e.geometries){var i;if(e.clipExtent){var n=this.getMap(),r=n?n.getProjection():null;i=new OI(e.clipExtent,r)}for(var s=[],o=this.getGeometries(),a=0,l=o.length;a<l;a++){var c=o[a],h=c.getExtent();if(h&&(!i||i.intersects(h))){var u=c.toJSON(e.geometries);s.push(u)}}t.geometries=s}return t},t.fromJSON=function(e){if(!e||"VectorLayer"!==e.type)return null;for(var i=new t(e.id,e.options),n=e.geometries,r=[],s=0;s<n.length;s++){var o=UO.fromJSON(n[s]);o&&r.push(o)}return i.addGeometry(r),i},t.getPainterClass=function(){return NO},t.getCollectionPainterClass=function(){return zO},t}(aD);hD.mergeOptions(cD),hD.registerJSONType("VectorLayer");var uD=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addTo=function(e){return e?(this._map=e,e._map_tool&&e._map_tool.disable(),this.onAdd&&this.onAdd(),this.enable(),e._map_tool=this,this._fireEvent("add"),this):this},i.getMap=function(){return this._map},i.enable=function(){return!this._map||this._enabled||(this._enabled=!0,this._switchEvents("off"),this._registerEvents(),this.onEnable&&this.onEnable(),this._fireEvent("enable")),this},i.disable=function(){return this._enabled&&this._map?(this._enabled=!1,this._switchEvents("off"),this.onDisable&&this.onDisable(),this._fireEvent("disable"),this):this},i.isEnabled=function(){return!!this._enabled},i.remove=function(){return this._map?(this.disable(),this._map&&(delete this._map._map_tool,delete this._map),this._fireEvent("remove"),this):this},i._registerEvents=function(){this._switchEvents("on")},i._switchEvents=function(e){var t=this.getEvents();t&&this._map[e](t,this)},i._fireEvent=function(e,t){t||(t={}),this.fire(e,t)},t}(nI(sI)),dD={symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3},doubleClickZoom:!1,mode:null,once:!1,autoPanAtEdge:!1,ignoreMouseleave:!0,blockGeometryEvents:!1,zIndex:Number.MAX_VALUE},pD={},mD=function(e){function t(t){var i;return(i=e.call(this,t)||this)._checkMode(),i._events={click:i._clickHandler,"mousemove touchmove":i._mouseMoveHandler,dblclick:i._doubleClickHandler,"mousedown touchstart":i._mouseDownHandler,"mouseup touchend":i._mouseUpHandler,mousemove:i._mouseMoveHandler,mousedown:i._mouseDownHandler,mouseup:i._mouseUpHandler},i}tM(t,e),t.registerMode=function(e,t){pD[e.toLowerCase()]=t},t.getRegisterMode=function(e){return pD[e.toLowerCase()]};var i=t.prototype;return i.getMode=function(){return this.options.mode?this.options.mode.toLowerCase():null},i.setMode=function(e){return this._geometry&&(this._geometry.remove(),delete this._geometry),this._clearStage(),this._switchEvents("off"),this.options.mode=e,this._checkMode(),this.isEnabled()&&(this._switchEvents("on"),this._restoreMapCfg(),this._saveMapCfg()),this},i.getSymbol=function(){return Vk(this.options.symbol||this.options.symbol)},i.setSymbol=function(e){return e?(this.options.symbol=e,this._geometry&&this._geometry.setSymbol(e),this):this},i.getCurrentGeometry=function(){return this._geometry},i.onAdd=function(){this._checkMode()},i.onEnable=function(){this._saveMapCfg(),this._drawToolLayer=this._getDrawLayer(),this._clearStage(),this._loadResources();var e=this.getMap();return this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge=e.options.autoPanAtEdge,this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!0})),this._geometryEvents=e.options.geometryEvents,this.options.blockGeometryEvents&&e.config("geometryEvents",!1),this},i.onDisable=function(){var e=this.getMap();return this._restoreMapCfg(),this.endDraw({ignoreEndEvent:!0}),this._map&&(e.removeLayer(this._getDrawLayer()),this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!1}))),this.options.blockGeometryEvents&&e.config("geometryEvents",this._geometryEvents),this},i.undo=function(){var e=this._getRegisterMode();if(!this._shouldRecordHistory(e.action)||!this._historyPointer)return this;var t=this._clickCoords.slice(0,--this._historyPointer);return e.update(this.getMap().getProjection(),t,this._geometry),this},i.redo=function(){var e=this._getRegisterMode();if(!this._shouldRecordHistory(e.action)||uP(this._historyPointer)||this._historyPointer===this._clickCoords.length)return this;var t=this._clickCoords.slice(0,++this._historyPointer);return e.update(this.getMap().getProjection(),t,this._geometry),this},i._shouldRecordHistory=function(e){return Array.isArray(e)&&"click"===e[0]&&"mousemove"===e[1]&&"dblclick"===e[2]},i._checkMode=function(){this._getRegisterMode()},i._saveMapCfg=function(){var e=this.getMap();this._mapDoubleClickZoom=e.options.doubleClickZoom,e.config({doubleClickZoom:this.options.doubleClickZoom});for(var t=this._getRegisterMode().action,i=!1,n=0;n<t.length;n++)if(t[n].indexOf("mousedown")>=0||t[n].indexOf("touchstart")>=0){i=!0;break}if(i){var r=this.getMap();this._mapDraggable=r.options.draggable,r.config({draggable:!1})}},i._restoreMapCfg=function(){var e=this.getMap();e.config({doubleClickZoom:this._mapDoubleClickZoom}),uP(this._mapDraggable)||e.config("draggable",this._mapDraggable),delete this._mapDraggable,delete this._mapDoubleClickZoom},i._loadResources=function(){var e=vk(this.getSymbol());e.length>0&&this._drawToolLayer._getRenderer().loadResources(e)},i._getProjection=function(){return this._map.getProjection()},i._getRegisterMode=function(){var e=this.getMode(),i=t.getRegisterMode(e);if(!i)throw new Error(e+" is not a valid mode of DrawTool.");return i},i.getEvents=function(){var e=this._getRegisterMode().action,t={};if(Array.isArray(e)){for(var i=0;i<e.length;i++)t[e[i]]=this._events[e[i]];return t}return null},i._mouseDownHandler=function(e){this._createGeometry(e)},i._mouseUpHandler=function(e){this.endDraw(e)},i._clickHandler=function(e){var t=this.getMap(),i=this._getRegisterMode();if(this._clickCoords&&this._clickCoords.length){var n=this._clickCoords.length,r=t._pointToPrj(e.point2d);if(this._clickCoords[n-1].equals(r))return}if(this._geometry){var s=t._pointToPrj(e.point2d);uP(this._historyPointer)||(this._clickCoords=this._clickCoords.slice(0,this._historyPointer));var o=this._geometry.snapTo;if(o&&gP(o)){var a=this._getSnapResult(o,e.containerPoint);if(s=a.prjCoord,this._clickCoords=this._clickCoords.concat(a.effectedVertex),this._clickCoords[this._clickCoords.length-1].equals(s))return}if(this._clickCoords.push(s),this._historyPointer=this._clickCoords.length,e.drawTool=this,i.update(t.getProjection(),this._clickCoords,this._geometry,e),"point"===this.getMode())return void this.endDraw(e);this._fireEvent(this._clickCoords.length<=1?"drawstart":"drawvertex",e),i.clickLimit&&i.clickLimit===this._historyPointer&&this.endDraw(e)}else this._createGeometry(e)},i._createGeometry=function(e){var t=this.getMode(),i=this._getRegisterMode(),n=this.getMap()._pointToPrj(e.point2d),r=this.getSymbol();if(!this._geometry){this._fireEvent("drawprepare",e),this._clickCoords=[n],e.drawTool=this,this._geometry=i.create(this.getMap().getProjection(),this._clickCoords,e),r&&"point"!==t?this._geometry.setSymbol(r):this.options.hasOwnProperty("symbol")&&this._geometry.setSymbol(this.options.symbol),this._addGeometryToStage(this._geometry),this._fireEvent("drawstart",e);var s=this._geometry.snapTo;if(s&&gP(s)){var o=this._getSnapResult(s,e.containerPoint),a=this.getMap();a&&o&&(this._clickCoords=[o.prjCoord],i.update(a.getProjection(),this._clickCoords,this._geometry,e))}}"point"===t&&"mousemove"!==e.type&&this.endDraw(e)},i._mouseMoveHandler=function(e){var t=this.getMap();if(t&&!t.isInteracting())if("point"!==this.getMode()||this._geometry){if(this._geometry){var i=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(i)){var n=t._pointToPrj(e.point2d),r=[],s=this._geometry.snapTo;if(s&&gP(s)){var o=this._getSnapResult(s,i);n=o.prjCoord,r=o.effectedVertex}var a=t.getProjection();e.drawTool=this;var l=this._getRegisterMode();if(this._shouldRecordHistory(l.action)){var c=this._clickCoords.slice(0,this._historyPointer);if(c&&c.length>0&&n.equals(c[c.length-1]))return;l.update(a,c.concat(r,[n]),this._geometry,e)}else l.update(a,n,this._geometry,e);this._fireEvent("mousemove",e)}}}else this._createGeometry(e)},i._doubleClickHandler=function(e){if(this._geometry){var t=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(t)){var i=this._getRegisterMode(),n=this._clickCoords;if(!(n.length<2)){var r=this.getMode();if(!(r&&r.indexOf("polygon")>-1&&n.length<3)){for(var s=this.getMap().getProjection(),o=[n[0]],a=1,l=n.length;a<l;a++)n[a].x===n[a-1].x&&n[a].y===n[a-1].y||o.push(n[a]);o.length<2||this._geometry&&this._geometry instanceof EN&&o.length<3||(e.drawTool=this,i.update(s,o,this._geometry,e),this.endDraw(e))}}}}},i._addGeometryToStage=function(e){this._getDrawLayer().addGeometry(e)},i.endDraw=function(e){if(!this._geometry||this._ending)return this;this._ending=!0;var t=this._geometry;return this._clearStage(),e=e||{},this._geometry=t,e.ignoreEndEvent||this._fireEvent("drawend",e),delete this._geometry,this.options.once&&this.disable(),delete this._ending,delete this._historyPointer,this._vertexes&&(this._vertexes=[]),this},i._clearStage=function(){this._getDrawLayer().clear(),delete this._geometry,delete this._clickCoords},i._getMouseContainerPoint=function(e){var t=this._getRegisterMode().action;return(t[0].indexOf("mousedown")>=0||t[0].indexOf("touchstart")>=0)&&iA(e.domEvent),e.containerPoint},i._isValidContainerPoint=function(e){var t=this._map.getSize();return!(e.x<0||e.y<0||e.x>t.width||e.y>t.height)},i._getSnapResult=function(e,t){var i=this.getMap(),n=[];if(this.options.edgeAutoComplete){n.push(i._prjToContainerPoint(this._clickCoords[(this._historyPointer||1)-1]));var r=this._clickCoords[(this._historyPointer||1)-2];r&&n.push(i._prjToContainerPoint(r))}var s=e(t,n),o=i._containerPointToPrj(t=(s.effectedVertex?s.point:s)||t);return s.effectedVertex&&(s.effectedVertex=s.effectedVertex.map((function(e){return i._containerPointToPrj(e)}))),{prjCoord:o,effectedVertex:s.effectedVertex||[]}},i._getDrawLayer=function(){var e="_maptalks__internal_layer_drawtool",t=this._map.getLayer(e);return t||(t=new hD(e,{enableSimplify:!1,enableAltitude:this.options.enableAltitude,zIndex:this.options.zIndex}),this._map.addLayer(t)),this._pushLayers(t),t},i._fireEvent=function(e,t){t||(t={}),t=hP({},t),this._geometry&&(t.geometry=this._getRegisterMode().generate(this._geometry,{drawTool:this}),t.tempGeometry=this._geometry),uD.prototype._fireEvent.call(this,e,t)},i._pushLayers=function(e){var t=this;return e?(Array.isArray(e)||(e=[e]),this._layers=this._layers||[],e.forEach((function(e){-1===t._layers.indexOf(e)&&t._layers.push(e)})),this):this},i._outLayers=function(e){var t=this;return e?(Array.isArray(e)||(e=[e]),this._layers=this._layers||[],e.forEach((function(e){for(var i=0,n=t._layers.length;i<n;i++)if(e===t._layers[i]){t._layers.splice(i,1);break}})),this):this},i.setLayerZIndex=function(e){return dP(e)?(this.options.zIndex=e,this._layers=this._layers||[],this._layers.forEach((function(t){t&&t.setZIndex&&t.setZIndex(e)})),this):this},t}(uD);mD.mergeOptions(dD);var fD=function(e){function t(t){var i;return(i=e.call(this,t)||this).drawTool=new mD({mode:"boxZoom",ignoreMouseleave:!1}),i}tM(t,e);var i=t.prototype;return i.addHooks=function(){this.target.on("_mousedown",this._onMouseDown,this)},i.removeHooks=function(){this.target.off("_mousedown",this._onMouseDown,this),this.drawTool.isEnabled()&&this.drawTool.remove()},i._onMouseDown=function(e){this.target.options.boxZoom&&e.domEvent.shiftKey&&this.drawTool.setSymbol(this.target.options.boxZoomSymbol).on("drawend",this._boxZoom,this).addTo(this.target)},i._boxZoom=function(e){var t=this.target;this.drawTool.remove();var i=e.geometry,n=i.getCenter(),r=i.getSymbol(),s=new OI(n,t.locateByPoint(n,r.markerWidth,r.markerHeight),t.getProjection()),o=t.getFitZoom(s);t._animateTo({center:s.getCenter(),zoom:o})},t}(rI);lN.mergeOptions({boxZoom:!0,boxZoomSymbol:{markerType:"rectangle",markerLineWidth:3,markerLineColor:"#1bbc9b",markerLineDasharray:[10,5],markerFillOpacity:.1,markerFill:"#1bbc9b",markerWidth:1,markerHeight:1}}),lN.addOnLoadHook("addHandler","boxZoom",fD);var gD=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){this.target&&this.target.on("_mousemove",this._onMouseMove,this)},i.removeHooks=function(){this.target&&this.target.off("_mousemove",this._onMouseMove,this)},i._onMouseMove=function(e){var t=this.target;if(t.options.autoPanAtEdge){var i=e.containerPoint,n=t.getContainerExtent();if(n){var r,s=i.x,o=i.y,a=n.xmax,l=n.ymax;s<30&&(r=[Math.abs(s-30),0]),o<30&&(r=[0,Math.abs(o-30)]),s+30>a&&(r=[-Math.abs(s+30-a),0]),o+30>l&&(r=[0,-Math.abs(o+30-l)]),r&&t.panBy(r,{duration:1})}}},t}(rI);function _D(e,t,i){return e*(1-i)+t*i}function yD(e){e.stopPropagation(),e.preventDefault()}lN.mergeOptions({autoPanAtEdge:!1}),lN.addOnLoadHook("addHandler","autoPanAtEdge",gD),lN.include({animateTo:function(e,t,i){var n=this;void 0===t&&(t={}),e=hP({},this.getView(),e),gP(t)&&(i=t,t={});var r=this.getProjection(),s=this.getView(),o={},a=!0;for(var l in e)if(yP(e,l)&&!uP(e[l])&&("prjCenter"===l||!uP(s[l])))if(a=!1,"center"===l){var c=new vI(s[l]),h=new vI(e[l]);c.equals(h)||(o.center=[c,h])}else if("prjCenter"===l){var u=new vI(this._getPrjCenter()),d=new vI(e[l]);u.equals(d)||(o.prjCenter=[u,d])}else s[l]!==e[l]&&"around"!==l&&(o[l]=[s[l],e[l]]);if(a)return null;this._animPlayer&&(this._isInternalAnimation?"running"===this._animPlayer.playState&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer)));var p=e.around||new uM(this.width/2,this.height/2),m=this._getRenderer(),f=this._animPlayer=CN.animate(o,{easing:t.easing||"out",duration:t.duration||this.options.zoomAnimationDuration,framer:function(e){m.callInNextFrame(e)},repeat:t.repeat},(function(e){n.isRemoved()?f.finish():("running"===f.playState?(e.styles.center?(n._setPrjCenter(r.project(e.styles.center)),n.onMoving(n._parseEventFromCoord(n.getCenter()))):e.styles.prjCenter&&(n._setPrjCenter(e.styles.prjCenter),n.onMoving(n._parseEventFromCoord(n.getCenter()))),uP(e.styles.zoom)||n.onZooming(e.styles.zoom,p),uP(e.styles.pitch)||n._setPitch(e.styles.pitch),uP(e.styles.bearing)||n._setBearing(e.styles.bearing),n._fireEvent("animating")):"paused"===f.playState&&f!==n._mapAnimPlayer||(f._interupted||(o.center?n._setPrjCenter(r.project(o.center[1])):o.prjCenter&&n._setPrjCenter(o.prjCenter[1]),uP(o.pitch)||n._setPitch(o.pitch[1]),uP(o.bearing)||n._setBearing(o.bearing[1])),n._endAnim(f,o,p,t)),i&&i(e))}),this);return this._startAnim(o,p),f},_animateTo:function(e,t,i){return void 0===t&&(t={}),this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._isInternalAnimation=!0,this._mapAnimPlayer=this.animateTo(e,t,i),delete this._isInternalAnimation,this._mapAnimPlayer},flyTo:function(e,t,i){var n=this;void 0===t&&(t={}),e=hP({},this.getView(),e),this._animPlayer&&(this._isInternalAnimation?"running"===this._animPlayer.playState&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer))),gP(t)&&(i=t,t={}),t=hP({curve:1.42},t);var r=this;function s(e,t){return r.getResolution(t)/r.getResolution(e)}var o=e.around||new uM(this.width/2,this.height/2),a=this.getMinZoom(),l=this.getMaxZoom(),c=this.getProjection(),h=this.getView(),u=h.zoom,d=h.bearing,p=h.pitch,m="zoom"in e?SM(+e.zoom,a,l):u,f="bearing"in e?+e.bearing:d,g="pitch"in e?+e.pitch:p,_=c.project(e.center&&new vI(e.center)||this.getCenter()),y=s(m,u),v=c.project(this.getCenter()),x=_.sub(v),b=t.curve,w=Math.max(this.width,this.height),C=w/y,S=x.mag();if("minZoom"in t){var E=SM(Math.min(t.minZoom,u,m),a,l),T=w/s(E,u);b=Math.sqrt(T/S*2)}var P=b*b;function M(e){var t=(C*C-w*w+(e?-1:1)*P*P*S*S)/(2*(e?C:w)*P*S);return Math.log(Math.sqrt(t*t+1)-t)}function k(e){return(Math.exp(e)-Math.exp(-e))/2}function A(e){return(Math.exp(e)+Math.exp(-e))/2}var I=M(0),R=function(e){return A(I)/A(I+b*e)},O=function(e){return w*((A(I)*(k(t=I+b*e)/A(t))-k(I))/P)/S;var t},N=(M(1)-I)/b;if(Math.abs(S)<1e-6||!isFinite(N)){if(Math.abs(w-C)<1e-6)return this.animateTo(e,t,i);var D=C<w?-1:1;N=Math.abs(Math.log(C/w))/b,O=function(){return 0},R=function(e){return Math.exp(D*b*e)}}var z=this._getRenderer(),L=this._animPlayer=CN.animate({k:[0,1]},{easing:t.easing||"out",duration:t.duration||8,framer:function(e){z.callInNextFrame(e)}},(function(r){if(n.isRemoved())L.finish();else{var s=r.styles.k,a=s*N,l=1/R(a),c={};if(e.center){var h=1===s?_:v.add(x.multi(O(a)));c.prjCenter=[_,h]}if(u!==m){var y=1===s?m:n.getZoomForScale(l,u,!0);c.zoom=[u,y]}if(p!==g){var b=_D(p,g,s);c.pitch=[g,b]}if(d!==f){var w=_D(d,f,s);c.bearing=[f,w]}"running"===L.playState?(c.prjCenter&&(n._setPrjCenter(c.prjCenter[1]),n.onMoving(n._parseEventFromCoord(n.getCenter()))),c.zoom&&n.onZooming(c.zoom[1],o),c.pitch&&n._setPitch(c.pitch[1]),c.bearing&&n._setBearing(c.bearing[1]),n._fireEvent("animating")):"paused"===L.playState&&L!==n._mapAnimPlayer||(L._interupted||(c.prjCenter&&n._setPrjCenter(c.prjCenter[1]),c.pitch&&n._setPitch(c.pitch[1]),c.bearing&&n._setBearing(c.bearing[1])),n._endAnim(L,c,o,t)),i&&i(r)}}));return this._startAnim({center:e.center,zoom:e.zoom!==u,pitch:g!==p,bearing:f!==d},o),this},isAnimating:function(){return!!this._animPlayer},isRotating:function(){return this.isDragRotating()||!!this._animRotating},_endAnim:function(e,t,i,n){delete this._animRotating;var r,s=e._interupted?"animateinterrupted":"animateend";if(e===this._animPlayer&&delete this._animPlayer,e===this._mapAnimPlayer&&delete this._mapAnimPlayer,t.center)r=e._interupted?this.getCenter():t.center[1],this.onMoveEnd(this._parseEventFromCoord(r));else if(t.prjCenter){var o;o=e._interupted?this._getPrjCenter():t.prjCenter[1];var a=this._parseEventFromCoord(this.getProjection().unproject(o));a.point2d=this._prjToPoint(o),this.onMoveEnd(a)}uP(t.zoom)||(e._interupted?this.onZoomEnd(this.getZoom()):n.wheelZoom?this.onZooming(t.zoom[1],i):this.onZoomEnd(t.zoom[1])),s&&this._fireEvent(s),uP(t.pitch)||this.getPitch()||this.getRenderer().setToRedraw(),n.wheelZoom||this._resumePrev(e)},_startAnim:function(e,t){this._animPlayer&&((e.center||e.prjCenter)&&this.onMoveStart(),e.zoom&&!this.isZooming()&&this.onZoomStart(e.zoom[1],t),(e.pitch||e.bearing)&&(this._animRotating=!0),this._fireEvent("animatestart"),this._animPlayer.play())},_stopAnim:function(e){e&&(delete this._animRotating,"finished"!==e.playState&&(e._interupted=!0,e.cancel()),e===this._animPlayer&&delete this._animPlayer,e===this._mapAnimPlayer&&delete this._mapAnimPlayer)},_resumePrev:function(e){if(this._prevAnimPlayer){var t=this._prevAnimPlayer;"paused"!==t.playState&&delete this._prevAnimPlayer,e!==t&&(this._animPlayer=t,t.play())}}});var vD=["dragstart","dragenter","dragend","dragleave","dragover"].join(" ").toString(),xD="mousedown mouseup mouseover mouseout mouseenter mouseleave mousemove click dblclick contextmenu keypress touchstart touchmove touchend drop ";function bD(e,t,i,n,r){var s=1/Math.tan(t/2),o=1/(n-r);return e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*n*o,e[15]=0,e}function wD(e,t,i){var n,r,s,o,a,l,c,h,u,d,p,m,f=i[0],g=i[1],_=i[2];return t===e?(e[12]=t[0]*f+t[4]*g+t[8]*_+t[12],e[13]=t[1]*f+t[5]*g+t[9]*_+t[13],e[14]=t[2]*f+t[6]*g+t[10]*_+t[14],e[15]=t[3]*f+t[7]*g+t[11]*_+t[15]):(r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=t[9],p=t[10],m=t[11],e[0]=n=t[0],e[1]=r,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=h,e[8]=u,e[9]=d,e[10]=p,e[11]=m,e[12]=n*f+a*g+u*_+t[12],e[13]=r*f+l*g+d*_+t[13],e[14]=s*f+c*g+p*_+t[14],e[15]=o*f+h*g+m*_+t[15]),e}function CD(e,t,i){var n=i[0],r=i[1],s=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function SD(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],h=t[7],u=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],_=t[14],y=t[15],v=i[0],x=i[1],b=i[2],w=i[3];return e[0]=v*n+x*a+b*u+w*f,e[1]=v*r+x*l+b*d+w*g,e[2]=v*s+x*c+b*p+w*_,e[3]=v*o+x*h+b*m+w*y,e[4]=(v=i[4])*n+(x=i[5])*a+(b=i[6])*u+(w=i[7])*f,e[5]=v*r+x*l+b*d+w*g,e[6]=v*s+x*c+b*p+w*_,e[7]=v*o+x*h+b*m+w*y,e[8]=(v=i[8])*n+(x=i[9])*a+(b=i[10])*u+(w=i[11])*f,e[9]=v*r+x*l+b*d+w*g,e[10]=v*s+x*c+b*p+w*_,e[11]=v*o+x*h+b*m+w*y,e[12]=(v=i[12])*n+(x=i[13])*a+(b=i[14])*u+(w=i[15])*f,e[13]=v*r+x*l+b*d+w*g,e[14]=v*s+x*c+b*p+w*_,e[15]=v*o+x*h+b*m+w*y,e}function ED(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],h=t[8],u=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],y=i*a-n*o,v=i*l-r*o,x=i*c-s*o,b=n*l-r*a,w=n*c-s*a,C=r*c-s*l,S=h*f-u*m,E=h*g-d*m,T=h*_-p*m,P=u*g-d*f,M=u*_-p*f,k=d*_-p*g,A=y*k-v*M+x*P+b*T-w*E+C*S;return A?(e[0]=(a*k-l*M+c*P)*(A=1/A),e[1]=(r*M-n*k-s*P)*A,e[2]=(f*C-g*w+_*b)*A,e[3]=(d*w-u*C-p*b)*A,e[4]=(l*T-o*k-c*E)*A,e[5]=(i*k-r*T+s*E)*A,e[6]=(g*x-m*C-_*v)*A,e[7]=(h*C-d*x+p*v)*A,e[8]=(o*M-a*T+c*S)*A,e[9]=(n*T-i*M-s*S)*A,e[10]=(m*w-f*x+_*y)*A,e[11]=(u*x-h*w-p*y)*A,e[12]=(a*E-o*P-l*S)*A,e[13]=(i*P-n*E+r*S)*A,e[14]=(f*v-m*b-g*y)*A,e[15]=(h*b-u*v+d*y)*A,e):null}function TD(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function PD(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function MD(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e}function kD(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function AD(e){var t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)}function ID(e,t){var i=t[0],n=t[1],r=t[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s),e}function RD(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[0],a=i[1],l=i[2];return e[0]=r*l-s*a,e[1]=s*o-n*l,e[2]=n*a-r*o,e}function OD(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return Math.hypot?Math.hypot(i,n,r):function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}(i,n,r)}function ND(e,t,i){var n=t[0],r=t[1],s=t[2],o=1/(i[3]*n+i[7]*r+i[11]*s+i[15]);return e[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])*o,e[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])*o,e[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])*o,e}lN.include({_registerDomEvents:function(){var e=this._panels.mapWrapper||this._containerDOM;Jk(e,xD,this._handleDOMEvent,this),Jk(e,vD,yD,this)},_removeDomEvents:function(){var e=this._panels.mapWrapper||this._containerDOM;Qk(e,xD,this._handleDOMEvent),Qk(e,vD,yD)},_handleDOMEvent:function(e){if(e&&"drop"===e.type){e.stopPropagation(),e.preventDefault();var t=this._parseEvent(e,e.type);return t=hP({},t,{dataTransfer:e.dataTransfer}),void this._fireEvent(e.type,t)}var i=this.options.clickTimeThreshold,n=e.type;if(!mA(n)||QP.isTest||!fA(this,this.options.mousemoveThrottleTime)){var r="mousedown"===n||"touchstart"===n&&(!e.touches||1===e.touches.length);r&&(this._domMouseDownTime=cP(),this._domMouseDownView=this.getView());var s="contextmenu"===n&&function(e){if(!e._domMouseDownView)return!0;var t=e.getView(),i=e._domMouseDownView;return t.bearing!==i.bearing||t.pitch!==i.pitch}(this);if("contextmenu"===n){tA(e);var o=this._domMouseDownTime;cP()-o<=i&&!s&&this._fireDOMEvent(this,e,"dom:"+e.type)}else this._fireDOMEvent(this,e,"dom:"+e.type);if(!this._ignoreEvent(e)&&!this._isEventOutMap(e)){var a,l=!1;if(r)this._mouseDownTime=cP();else if("click"===n||"touchend"===n||"contextmenu"===n){if(!this._mouseDownTime)return;var c=this._mouseDownTime;if(delete this._mouseDownTime,cP()-c>i){if("click"===n||"contextmenu"===n)return}else if("contextmenu"===n){if(s)return}else"touchend"===n&&(l=!0)}l&&(this._clickTime&&cP()-this._clickTime<=i?(delete this._clickTime,a="dblclick",this._fireDOMEvent(this,e,"dom:dblclick")):(this._clickTime=cP(),a="click",this._fireDOMEvent(this,e,"dom:click"))),this._ignoreEvent(e)||this._isEventOutMap(e)||(this._fireDOMEvent(this,e,n),a&&this._fireDOMEvent(this,e,a))}}},_ignoreEvent:function(e){if(!e||!this._panels.control)return!1;var t,i=e.srcElement||e.target;if(i)for(;i&&i!==this._containerDOM;){if(i.className&&i.className.indexOf&&(i.className.indexOf("maptalks-control")>=0||i.className.indexOf("maptalks-ui")>=0&&t&&!t.eventsPropagation))return!0;t=i,i=i.parentNode}return!1},_isEventOutMap:function(e){if(this.getPitch()>this.options.maxVisualPitch){var t=sA(this._getActualEvent(e),this._containerDOM);if(!this.getContainerExtent().contains(t))return!0}return!1},_parseEvent:function(e,t){if(!e)return null;var i={domEvent:e};if("keypress"!==t){var n=this._getActualEvent(e);if(n&&void 0!==n.clientX){var r=sA(n,this._containerDOM);i=hP(i,{containerPoint:r,viewPoint:this.containerPointToViewPoint(r)});var s=this.options.maxVisualPitch;(this.getPitch()<=s||r.y>=this.height-this._getVisualHeight(s))&&(i=hP(i,{coordinate:this.containerPointToCoord(r),point2d:this._containerPointToPoint(r)}))}}return i},_parseEventFromCoord:function(e){var t=this.coordToContainerPoint(e);return{coordinate:e,containerPoint:t,viewPoint:this.containerPointToViewPoint(t),point2d:this.coordToPoint(e)}},_getActualEvent:function(e){return e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e},_fireDOMEvent:function(e,t,i){var n=this;if(!this.isRemoved()){var r=this._parseEvent(t,i);mA(i)?this.getRenderer().callInNextFrame((function(){n._fireEvent(r.domEvent&&r.domEvent._cancelBubble?"_"+i:i,r)})):this._fireEvent(i,r)}},_getEventParams:function(e){var t={domEvent:e},i=e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e;if(i){var n=sA(i,this._containerDOM);t.coordinate=this.containerPointToCoordinate(n),t.containerPoint=n,t.viewPoint=this.containerPointToViewPoint(n),t.pont2d=this._containerPointToPoint(n)}return t}}),lN.addOnLoadHook("_registerDomEvents"),lN.include({isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},requestFullScreen:function(e){return this._fireEvent("fullscreenstart"),this._requestFullScreen(e||this._containerDOM),this._fireEvent("fullscreenend"),this},cancelFullScreen:function(){return this._cancelFullScreen(),this._fireEvent("cancelfullscreen"),this},_requestFullScreen:function(e){if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullScreen)e.webkitRequestFullScreen();else if(e.msRequestFullScreen)e.msRequestFullScreen();else{var t="fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,width="+(screen.availWidth-8)+",height="+(screen.availHeight-45);null!==window.open(location.href,"_blank",t)&&(window.opener=null,window.close())}},_cancelFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():null!==window.open(location.href,"_blank","fullscreen=no,status=yes,resizable=yes,scrollbars=no,titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes")&&(window.opener=null,window.close())}}),lN.include({panTo:function(e,t,i){if(void 0===t&&(t={}),!e)return this;if(gP(t)&&(i=t,t={}),e=new vI(e),void 0===t.animation||t.animation){var n=this.getProjection().project(e);return this._panAnimation(n,t.duration,i)}return this.setCenter(e),this},_panTo:function(e,t){return void 0===t&&(t={}),void 0===t.animation||t.animation?this._panAnimation(e,t.duration):(this.onMoveStart(),this._setPrjCenter(e),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this)},panBy:function(e,t,i){if(void 0===t&&(t={}),!e)return this;if(gP(t)&&(i=t,t={}),e=new uM(e),this.getContainerExtent().ymin>0&&e.y>30){var n=e.y;e.y=30,e.x=30*e.x/n,console.warn("offset is limited to panBy when pitch is above maxPitch")}if(void 0===t.animation||t.animation){e=e.multi(-1);var r=this._containerPointToPrj(new uM(this.width/2+e.x,this.height/2+e.y));this._panAnimation(r,t.duration,i)}else{this.onMoveStart(),this._offsetCenterByPixel(e);var s=this.containerPointToCoord(new uM(this.width/2,this.height/2));this.onMoveEnd(this._parseEventFromCoord(s))}return this},_panAnimation:function(e,t,i){return this._animateTo({prjCenter:e},{duration:t||this.options.panAnimationDuration},i)}}),UO.fromJSON=function(e){if(Array.isArray(e)){for(var t=[],i=0,n=e.length;i<n;i++){var r=UO.fromJSON(e[i]);Array.isArray(e)?t=t.concat(r):t.push(r)}return t}return e&&!e.feature?VN.toGeometry(e):(e.subType?(s=UO.getJSONClass(e.subType).fromJSON(e),uP(e.feature.id)||s.setId(e.feature.id)):(s=VN.toGeometry(e.feature),e.options&&s.config(e.options)),e.symbol&&s.setSymbol(e.symbol),e.infoWindow&&s.setInfoWindow(e.infoWindow),s);var s},ZO.fromJSON=function(e){if(!e)return null;var t=e.type,i=ZO.getJSONClass(t);if(!i||!i.fromJSON)throw new Error("unsupported layer type:"+t);return i.fromJSON(e)},lN.include({JSON_VERSION:"1.0",toJSON:function(e){e||(e={});var t={jsonVersion:this.JSON_VERSION,version:this.VERSION,extent:this.getExtent().toJSON()};t.options=this.config(),t.options.center=this.getCenter(),t.options.zoom=this.getZoom(),t.options.bearing=this.getBearing(),t.options.pitch=this.getPitch();var i=this.getBaseLayer();(uP(e.baseLayer)||e.baseLayer)&&i&&(t.baseLayer=i.toJSON(e.baseLayer));var n={};e.clipExtent&&(n.clipExtent=!0===e.clipExtent?this.getExtent():e.clipExtent);var r=[];if(uP(e.layers)||e.layers&&!Array.isArray(e.layers)){for(var s=this.getLayers(),o=0,a=s.length;o<a;o++)if(s[o].toJSON){var l=hP({},mP(e.layers)?e.layers:{},n);r.push(s[o].toJSON(l))}t.layers=r}else if(EM(e.layers)){for(var c=e.layers,h=0;h<c.length;h++){var u=c[h],d=this.getLayer(u.id);if(d.toJSON){var p=hP({},u.options,n);r.push(d.toJSON(p))}}t.layers=r}else t.layers=[];return t}}),lN.fromJSON=function(e,t,i){if(!e||!t)return null;i||(i={});var n=new lN(e,t.options);if(uP(i.baseLayer)||i.baseLayer){var r=ZO.fromJSON(t.baseLayer);r&&n.setBaseLayer(r)}if(uP(i.layers)||i.layers){for(var s=[],o=t.layers,a=0;a<o.length;a++){var l=ZO.fromJSON(o[a]);s.push(l)}n.addLayer(s)}return n},lN.include({computeLength:function(e,t){if(!this.getProjection())return null;var i=new vI(e),n=new vI(t);return i.equals(n)?0:this.getProjection().measureLength(i,n)},computeGeometryLength:function(e){return e._computeGeodesicLength(this.getProjection())},computeGeometryArea:function(e){return e._computeGeodesicArea(this.getProjection())},identify:function(e,t){var i=new vI((e=e||{}).coordinate);return this._identify(e,t,(function(t){return t.identify(i,e)}))},identifyAtPoint:function(e,t){var i=e.includeInternals,n=e.tolerance,r=new uM((e=e||{}).containerPoint),s=this.containerPointToCoord(r);return this._identify(e,t,(function(t){var r,o=e.containerPoint;return i&&!uP(t.options.geometryEventTolerance)&&(e.tolerance=e.tolerance||0,e.tolerance+=t.options.geometryEventTolerance),t._hasGeoListeners&&i&&e.eventTypes.indexOf("mousemove")>=0&&!t._hasGeoListeners(e.eventTypes)?[]:(r=t.identifyAtPoint?t.identifyAtPoint(o,e):s&&t.identify?t.identify(s,e):[],i&&(uP(n)?delete e.tolerance:e.tolerance=n),r&&r.length||(t.fire("identifyempty",e),t.getLayers&&gP(t.getLayers)&&(t.getLayers()||[]).filter((function(e){return e})).forEach((function(t){t.fire("identifyempty",e)}))),r)}))},_identify:function(e,t,i){var n=e.layers;if(!EM(n))return this;for(var r=e.eventTypes,s=[],o=0,a=n.length;o<a;o++)fP(n[o])?s.push(this.getLayer(n[o])):s.push(n[o]);r&&(s=s.filter((function(e){return!e._hasGeoListeners||e._hasGeoListeners(r)})));for(var l=[],c=s.length-1;c>=0&&!(e.count&&l.length>=e.count);c--){var h=s[c];if(h&&h.getMap()&&(e.includeInvisible||h.isVisible())&&(e.includeInternals||!(h.getId().indexOf("_maptalks__internal_layer_")>=0))){var u=i(h),d=h.getId();if(u)if(Array.isArray(u)){for(var p=0;p<u.length;p++)u[p]&&!u[p].getLayer&&uP(u[p].layer)&&(u[p].layer=d);_M(l,u)}else!u.getLayer&&uP(u.layer)&&(u.layer=d),l.push(u)}}return t.call(this,l),this}}),lN.include({_zoom:function(e,t){this.options.zoomable&&!this.isZooming()&&(t=this._checkZoomOrigin(t),e=this._checkZoom(e),this.onZoomStart(e,t),this._frameZoom=this.getZoom(),this.onZoomEnd(e,t))},_zoomAnimation:function(e,t,i){this.options.zoomable&&!this.isZooming()&&(e=this._checkZoom(e),this.getZoom()!==e&&(t=this._checkZoomOrigin(t),this._startZoomAnim(e,t,i)))},_checkZoomOrigin:function(e){return e&&!this.options.zoomInCenter||(e=new uM(this.width/2,this.height/2)),this.options.zoomOrigin&&(e=new uM(this.options.zoomOrigin)),e},_startZoomAnim:function(e,t,i){uP(i)&&(i=1);var n=this._getResolution(this._startZoomVal)/this._getResolution(e),r=this.options.zoomAnimationDuration*Math.abs(n-i)/Math.abs(n-1);this._frameZoom=this._startZoomVal,this._animateTo({zoom:e,around:t},{continueOnViewChanged:!0,duration:r})},onZoomStart:function(e,t){this.options.zoomable&&!this.isZooming()&&(this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),delete this.cameraZenithDistance,this._zooming=!0,this._startZoomVal=this.getZoom(),this._startZoomCoord=this._containerPointToPrj(t),this._fireEvent("zoomstart",{from:this._startZoomVal,to:e}))},onZooming:function(e,t,i){if(this.options.zoomable&&this._frameZoom!==e){uP(i)&&(i=1),this._zoomTo(e,t);var n=this.getResolution(e),r=this.getResolution(this._startZoomVal)/n/i,s=this._prjToContainerPoint(this._startZoomCoord,this._startZoomVal),o=this.getViewPoint();if(!this.isRotating()&&!s.equals(t)&&1!==r){var a=this.getPitch(),l=s._sub(t)._multi(1/(1-r));a&&(l.y/=Math.cos(a*Math.PI/180)),t=t.add(l)}var c={view:[r,0,0,r,(t.x-o.x)*(1-r),(t.y-o.y)*(1-r)]},h=this.getDevicePixelRatio();1!==h&&(t=t.multi(h)),c.container=[r,0,0,r,t.x*(1-r),t.y*(1-r)],this._fireEvent("zooming",{from:this._startZoomVal,to:e,origin:t,matrix:c}),this._frameZoom=e}},onZoomEnd:function(e,t){if(this.options.zoomable){var i=this._startZoomVal;this._zoomTo(e,t),this._zooming=!1,this._getRenderer().onZoomEnd(),this._suppressRecenter||this._recenterOnTerrain(),this._fireEvent("zoomend",{from:i,to:e}),this._verifyExtent(this._getPrjCenter())||this._panTo(this._prjMaxExtent.getCenter())}},_zoomTo:function(e,t){this._zoomLevel=e,this._calcMatrices(),t&&this._setPrjCoordAtContainerPoint(this._startZoomCoord,t)},_checkZoom:function(e){var t=this.getMaxZoom(),i=this.getMinZoom();return e<i&&(e=i),e>t&&(e=t),e}});var DD,zD,LD,BD,FD,jD,VD,UD,qD,HD=Math.PI/180,GD=new vI(0,0),WD=new uM(0,0);function ZD(){return TD(new Array(16))}lN.include({getFov:function(){return this._fov||(this._fov=.6435011087932844),this._fov/HD},setFov:function(e){if(this.isZooming())return this;if(e=Math.max(.01,Math.min(60,e)),this._fov===e)return this;var t=this.getFov();return this._fov=e*HD,this._calcMatrices(),this._renderLayers(),this._fireEvent("fovchange",{from:t,to:this.getFov()}),this},getBearing:function(){return this._angle?-this._angle/HD:0},setBearing:function(e){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setBearing(e)},_setBearing:function(e){if(QP.ie9)throw new Error("map can't rotate in IE9.");var t=-CM(e,-180,180)*HD;if(this._angle===t)return this;var i=this.getBearing();return this._fireEvent("rotatestart",{from:i,to:t}),this._angle=t,this._calcMatrices(),this._renderLayers(),this._fireEvent("rotate",{from:i,to:t}),this._fireEvent("rotateend",{from:i,to:t}),this},getPitch:function(){return this._pitch?this._pitch/Math.PI*180:0},setPitch:function(e){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setPitch(e)},_setPitch:function(e){if(QP.ie9)throw new Error("map can't tilt in IE9.");var t=SM(e,0,this.options.maxPitch)*HD;if(this._pitch===t)return this;var i=this.getPitch();return this._fireEvent("pitchstart",{from:i,to:t}),this._pitch=t,this._calcMatrices(),this._renderLayers(),this._fireEvent("pitch",{from:i,to:t}),this._fireEvent("pitchend",{from:i,to:t}),this},setCameraMovements:function(e,t){var i=this;if(!Array.isArray(e)||!e.length)return this;if(this.setView({center:e[0].center,zoom:e[0].zoom,pitch:e[0].pitch,bearing:e[0].bearing}),1===e.length)return this;var n=1,r=function(s){if("finished"===s.state.playState){++n==e.length-1&&(r=null);var o=e[n];o.duration=o.timestamp-e[n-1].timestamp,t&&t.autoRotate&&(o.bearing=(l=o.center,c=xP((a=e[n-1].center)[0]),h=xP(l[0]),u=xP(a[1]),d=xP(l[1]),p=Math.sin(h-c)*Math.cos(d),m=Math.cos(u)*Math.sin(d)-Math.sin(u)*Math.cos(d)*Math.cos(h-c),bP(Math.atan2(p,m)))),i._setCameraMovement(o,r)}var a,l,c,h,u,d,p,m};2===e.length&&(r=null);var s=this.getBearing();return this._setCameraMovement(eM({bearing:s},e[n],{duration:e[n].timestamp-e[n-1].timestamp}),r),{play:function(){i._animPlayer.play()},pause:function(){i._animPlayer.pause()},cancel:function(){i._animPlayer.cancel()},finish:function(){i._animPlayer.finish()},reverse:function(){i._animPlayer.reverse()}}},_setCameraMovement:function(e,t){this.animateTo({zoom:e.zoom,center:e.center,pitch:e.pitch,bearing:e.bearing},{duration:e.duration,easing:"out"},t)},setCameraPosition:function(e){var t=e.position,i=e.pitch,n=e.bearing,r=(this.centerAltitude||0)*this._meterToGLPoint,s=i*HD,o=(t[2]*this._meterToGLPoint-r)/Math.cos(s),a=Math.sin(s)*o,l=this._getZoomFromCameraToCenterDistance(o+r),c=CM(n,-180,180)*HD,h=this.getGLRes(),u=new vI(t[0],t[1]),d=this.coordToPointAtRes(u,h),p=new uM(0,0);p.x=d.x+a*Math.sin(c),p.y=d.y+a*Math.cos(c);var m=this._pointToPrjAtRes(p,this.getGLRes());return this._setPrjCenter(m),this.setView({bearing:n,pitch:i,zoom:l}),this},_getZoomFromCameraToCenterDistance:function(e){for(var t=e*this._getFovRatio()*2/(this.height||1)*this.getGLRes(),i=this._getResolutions(),n=0;n<i.length-1;n++){if(i[n]===t)return n;if(i[n+1]===t)return n+1;if(t<i[n]&&t>i[n+1])return(n=(t-i[n])/(i[n+1]-i[n])+n)-1}return n},isTransforming:function(){return!(!this._pitch&&!this._angle)},getFrustumAltitude:function(){return this._frustumAltitude},_calcFrustumAltitude:function(){var e=90-this.getPitch(),t=this.getFov()/2,i=this.cameraPosition?this.cameraPosition[2]:0;if(t<=e)return i;t=Math.PI*t/180;var n=new uM(this.cameraPosition).distanceTo(new uM(this.cameraLookAt)),r=i*Math.tan(2*t);return i+Math.tan(t)*(n+r)},_pointToContainerPoint:function(e,t,i,n){void 0===i&&(i=0);var r=this._getResolution(t);return this._pointAtResToContainerPoint(e,r,i,n)},_pointAtResToContainerPoint:function(e,t,i,n){void 0===i&&(i=0),n||(n=new uM(0,0)),e=this._pointAtResToPoint(e,t,n);var r,s=this.isTransforming();return s||i||(r=this._prjToPoint(this._getPrjCenter(),void 0,GD)),this._toContainerPoint(n,s,i,r),n},_pointsAtResToContainerPoints:function(e,t,i,n){void 0===i&&(i=[]),void 0===n&&(n=[]);var r=this.getPitch(),s=this.getBearing(),o=t/this._getResolution();if(0===r&&0===s&&!function(e){if(dP(e))return 0!==e;if(Array.isArray(e)&&e.length>0)for(var t=0,i=e.length;t<i;t++)if(dP(e[t])&&0!==e[t])return!0;return!1}(i)){var a=this._get2DExtent(),l=a.xmin,c=a.ymin,h=a.xmax,u=a.ymax;if(h>l&&u>c){for(var d=this.getSize(),p=d.height,m=(h-l)/d.width,f=(u-c)/p,g=0,_=e.length;g<_;g++)if(e[g]){var y=n[g];y.x=e[g].x,y.y=e[g].y,y._multi(o),y.x=(y.x-l)*m,y.y=p-(y.y-c)*f}else n[g]=null;return n}}for(var v=Array.isArray(i),x=this.isTransforming(),b=this._prjToPoint(this._getPrjCenter(),void 0,GD),w=0,C=e.length;w<C;w++)if(e[w]){var S=n[w];S.x=e[w].x,S.y=e[w].y,S._multi(o),this._toContainerPoint(S,x,v?i[w]||0:i,b)}else n[w]=null;return n},_toContainerPoint:(qD=[0,0,0],function(e,t,i,n){var r=this.width/2,s=this.height/2;if(t||i){this._altitudeScale||(this._altitudeScale=this.altitudeToPoint(100,this.getGLRes())/100);var o=this._glScale;MD(qD,e.x*o,e.y*o,i*this._altitudeScale);var a=this._projIfBehindCamera(qD,this.cameraPosition,this.cameraForward);ND(a,a,this.projViewMatrix),e.x=a[0]*r+r,e.y=-a[1]*s+s}else e._sub(n.x,n.y),e.set(e.x,-e.y),e._add(r,s)}),_projIfBehindCamera:(jD=new Array(3),VD=new Array(3),UD=new Array(3),function(e,t,i){kD(jD,e,t);var n=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(i,jD);return n<=0&&(function(e,t,i){e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i}(VD,i,1.01*n),function(e,t,i){e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2]}(e,t,kD(UD,jD,VD))),e}),_containerPointToPoint:function(e,t,i){var n=this._getResolution(t);return this._containerPointToPointAtRes(e,n,i)},_containerPointToPointAtRes:(LD=[0,0,0],BD=[0,0,0,1],FD=[0,0,0,1],function(e,t,i){if(this.isTransforming()){var n=this.width/2||1,r=this.height/2||1;MD(LD,(e.x-n)/n,(r-e.y)/r,0),MD(BD,LD[0],LD[1],0),MD(FD,LD[0],LD[1],1),BD[3]=FD[3]=1,ND(BD,BD,this.projViewMatrixInverse),ND(FD,FD,this.projViewMatrixInverse);var s=BD[1],o=FD[1],a=BD[2],l=FD[2],c=a===l?0:(0-a)/(l-a),h=wM(BD[0],FD[0],c),u=wM(s,o,c);return i?(i.x=h,i.y=u):i=new uM(h,u),i._multi(1/this._glScale),this._getResolution()===t?i:this._pointToPointAtRes(i,t,i)}var d=this._prjToPointAtRes(this._getPrjCenter(),t,i),p=this._getResolution()/t;return d._add(p*(e.x-this.width/2),-p*(e.y-this.height/2))}),_calcMatrices:(zD=ZD(),function(){delete this._mapRes,delete this._mapGlRes,delete this._mapExtent2D,delete this._mapGlExtent2D;var e=this.getSize(),t=e.width||1,i=e.height||1;this._glScale=this.getGLScale();var n=this._getCameraWorldMatrix(),r=this.getFov()*Math.PI/180,s=this._getCameraFar(r,this.getPitch());this.cameraFar=s,this.cameraNear=this.cameraCenterDistance/20;var o=this.projMatrix||ZD();bD(o,r,t/i,this.cameraNear,s),this.projMatrix=o,this.viewMatrix=ED(this.viewMatrix||ZD(),n),this.projViewMatrix=SD(this.projViewMatrix||ZD(),o,this.viewMatrix),this._calcCascadeMatrixes(),this.projViewMatrixInverse=SD(this.projViewMatrixInverse||ZD(),n,ED(zD,o)),this.domCssMatrix=this._calcDomMatrix(),this._frustumAltitude=this._calcFrustumAltitude(),this._mapRes=this._getResolution(),this._mapGlRes=this.getGLRes(),this._mapExtent2D=this._get2DExtent(),this._mapGlExtent2D=this._get2DExtentAtRes(this._mapGlRes)}),_getCameraFar:function(e,t){var i=this.cameraCenterDistance=OD(this.cameraPosition,this.cameraLookAt),n=i,r=(this.options.cameraInfiniteFar?10:4)*i;if(t>0&&(t=t*Math.PI/180,2/Math.PI-t>e/2)){var s=Math.tan(e/2),o=Math.tan(t);r=Math.max(i*s/(1/o-s),r)}return(n+=r)+1},_calcCascadeMatrixes:function(){var e=ZD();function t(t,i,n){var r=this.width,s=this.height,o=this.getFov()*Math.PI/180,a=this._getCameraFar(o,i),l=this.cameraCenterDistance;return a=l+(a-l)/Math.cos((90-i)*Math.PI/180)*Math.cos((90-t)*Math.PI/180),bD(e,o,r/s,.1,a),SD(n,e,this.viewMatrix)}return function(){var e=this.getPitch(),i=this.options.cascadePitches[0],n=this.options.cascadePitches[1],r=this.cascadeFrustumMatrix0=this.cascadeFrustumMatrix0||ZD(),s=this.cascadeFrustumMatrix1=this.cascadeFrustumMatrix1||ZD();e>i?t.call(this,e,i,r):PD(this.cascadeFrustumMatrix0,this.projViewMatrix),e>n?t.call(this,e,n,s):PD(this.cascadeFrustumMatrix1,this.cascadeFrustumMatrix0)}}(),_calcDomMatrix:function(){var e=ZD(),t=ZD(),i=[1,-1,1],n=[0,0,0];return function(){var r=this.width||1,s=this.height||1,o=.5/Math.tan(this._fov/2)*s;return CD(e,this.projMatrix,i),wD(e,e,MD(n,0,0,-o)),this._pitch&&function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*n,e[5]=o*r+h*n,e[6]=a*r+u*n,e[7]=l*r+d*n,e[8]=c*r-s*n,e[9]=h*r-o*n,e[10]=u*r-a*n,e[11]=d*r-l*n}(e,e,this._pitch),this._angle&&function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],h=t[5],u=t[6],d=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*n,e[1]=o*r+h*n,e[2]=a*r+u*n,e[3]=l*r+d*n,e[4]=c*r-s*n,e[5]=h*r-o*n,e[6]=u*r-a*n,e[7]=d*r-l*n}(e,e,this._angle),TD(t),CD(t,t,MD(n,r/2,-s/2,1)),SD(this.domCssMatrix||ZD(),t,e)}}(),_getFovZ:function(e){var t=this.getGLScale(e),i=this._getFovRatio();return t*(this.height||1)/2/i},_getCameraWorldMatrix:(DD={},function(){var e=this.getGLRes();this._meterToGLPoint||(this._meterToGLPoint=this.distanceToPointAtRes(100,0,e).x/100);var t=this._prjToPointAtRes(this._prjCenter,e,WD),i=(this.centerAltitude||0)*this._meterToGLPoint;this.cameraLookAt=MD(this.cameraLookAt||[0,0,0],t.x,t.y,i);var n=this.getPitch()*HD,r=this.getBearing()*HD,s=this._getFovZ(),o=(void 0===this.cameraZenithDistance?s:this.cameraZenithDistance)-i,a=o*Math.cos(n),l=Math.sin(n)*o,c=t.x-l*Math.sin(r),h=t.y-l*Math.cos(r);this.cameraPosition=MD(this.cameraPosition||[0,0,0],c,h,a+i),this.cameraToCenterDistance=s;var u=l||1,d=this.cameraUp=MD(this.cameraUp||[0,0,0],Math.sin(r)*u,Math.cos(r)*u,0),p=this.cameraWorldMatrix=this.cameraWorldMatrix||ZD();!function(e,t,i,n){var r=[0,0,0],s=[0,0,0],o=[0,0,0];kD(o,t,i),0===AD(o)&&(o[2]=1),ID(o,o),RD(r,n,o),0===AD(o)&&(1===Math.abs(n[2])?o[0]+=1e-4:o[2]+=1e-4,ID(o,o),RD(r,n,o)),ID(r,r),RD(s,o,r),e[0]=r[0],e[4]=s[0],e[8]=o[0],e[1]=r[1],e[5]=s[1],e[9]=o[1],e[2]=r[2],e[6]=s[2],e[10]=o[2]}(p,this.cameraPosition,this.cameraLookAt,d);var m,f,g=this.cameraForward||[0,0,0];return kD(g,this.cameraLookAt,this.cameraPosition),this.cameraForward=ID(g,g),function(e,t){var i,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],h=t[6],u=t[10],d=n+a+u;d>0?(i=.5/Math.sqrt(d+1),e.w=.25/i,e.x=(h-l)*i,e.y=(s-c)*i,e.z=(o-r)*i):n>a&&n>u?(i=2*Math.sqrt(1+n-a-u),e.w=(h-l)/i,e.x=.25*i,e.y=(r+o)/i,e.z=(s+c)/i):a>u?(i=2*Math.sqrt(1+a-n-u),e.w=(s-c)/i,e.x=(r+o)/i,e.y=.25*i,e.z=(l+h)/i):(i=2*Math.sqrt(1+u-n-a),e.w=(o-r)/i,e.x=(s+c)/i,e.y=(l+h)/i,e.z=.25*i)}(DD,p),function(e,t){var i=e,n=t.x,r=t.y,s=t.z,o=t.w,a=n+n,l=r+r,c=s+s,h=n*a,u=n*l,d=n*c,p=r*l,m=r*c,f=s*c,g=o*a,_=o*l,y=o*c;i[0]=1-(p+f),i[4]=u-y,i[8]=d+_,i[1]=u+y,i[5]=1-(h+f),i[9]=m-g,i[2]=d-_,i[6]=m+g,i[10]=1-(h+p),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1}(p,DD),(f=p)[12]=(m=this.cameraPosition)[0],f[13]=m[1],f[14]=m[2],p}),updateCenterAltitude:function(){this.getRenderer().setToRedraw(),!this.centerAltitude&&this._hasAltitudeLayer()&&(this.centerAltitude=0),this._recenterOnTerrain()},_recenterOnTerrain:function(){if(void 0!==this.centerAltitude){var e=this._queryTerrainByProjCoord(this._prjCenter);uP(e)&&this._hasAltitudeLayer()&&(e=this.centerAltitude);var t=e||0,i=this.getPitch()*HD,n=this.getBearing()*HD,r=(t-this.centerAltitude)*this._meterToGLPoint,s=this._getFovZ(),o=(void 0===this.cameraZenithDistance?s:this.cameraZenithDistance)-this.centerAltitude*this._meterToGLPoint-r/Math.cos(i),a=this.cameraPosition,l=Math.sin(i)*o,c=WD;c.x=a[0]+l*Math.sin(n),c.y=a[1]+l*Math.cos(n);var h=t*this._meterToGLPoint;this.cameraZenithDistance=(a[2]-h)/Math.cos(i)+h,this.centerAltitude=t;var u=this.pointAtResToCoordinate(c,this.getGLRes(),GD);this._eventSilence=!0,this._suppressRecenter=!0,this.setCenter(u),delete this._suppressRecenter,delete this._eventSilence,uP(e)&&delete this.centerAltitude}},_queryTerrainByProjCoord:function(e){for(var t=this._getLayers(),i=0;i<t.length;i++)if(t[i].queryTerrainByProjCoord)return t[i].queryTerrainByProjCoord(e)[0];return 0},_hasAltitudeLayer:function(){for(var e=this._getLayers(),t=0;t<e.length;t++)if(e[t].getTerrainLayer&&e[t].getTerrainLayer())return!0;return!1},_getFovRatio:function(){var e=this.getFov();return Math.tan(e/2*HD)},_renderLayers:function(){this.isInteracting()||this._getLayers().forEach((function(e){if(e){var t=e._getRenderer();t&&t.setToRedraw&&t.setToRedraw()}}))}}),lN.include({_onViewChange:function(e){this._viewHistory||(this._viewHistory=[],this._viewHistoryPointer=0);for(var t=this._getCurrentView(),i=this._viewHistory.length-1;i>=0;i--)if(IM(e,this._viewHistory[i]))return this._viewHistoryPointer=i,void this._fireViewChange(t,e);this._viewHistoryPointer<this._viewHistory.length-1&&this._viewHistory.splice(this._viewHistoryPointer+1),this._viewHistory.push(e);var n=this.options.viewHistoryCount;n>0&&this._viewHistory.length>n&&this._viewHistory.splice(0,this._viewHistory.length-n),this._viewHistoryPointer=this._viewHistory.length-1,this._fireViewChange(t,e)},zoomToPreviousView:function(e){if(void 0===e&&(e={}),!this.hasPreviousView())return null;var t=this._viewHistory[--this._viewHistoryPointer];return this._zoomToView(t,e),t},hasPreviousView:function(){return!(!this._viewHistory||0===this._viewHistoryPointer)},zoomToNextView:function(e){if(void 0===e&&(e={}),!this.hasNextView())return null;var t=this._viewHistory[++this._viewHistoryPointer];return this._zoomToView(t,e),t},hasNextView:function(){return!(!this._viewHistory||this._viewHistoryPointer===this._viewHistory.length-1)},_zoomToView:function(e,t){var i=this,n=this.getView();t.animation?this._animateTo(e,{duration:t.duration},(function(t){"finished"===t.state.playState&&i._fireViewChange(n,e)})):(this.setView(e),this._fireViewChange(n,e))},getViewHistory:function(){return this._viewHistory},_fireViewChange:function(e,t){this._fireEvent("viewchange",{old:e,new:t}),this._insertUICollidesQueue()},_getCurrentView:function(){return this._viewHistory?this._viewHistory[this._viewHistoryPointer]:null}}),lN.mergeOptions({viewHistory:!0,viewHistoryCount:10});var $D=new mI;lN.include({getCollisionIndex:function(){return this._collisionIndex||this.createCollisionIndex(),this._collisionIndex||this.createCollisionIndex()},createCollisionIndex:function(){return this.clearCollisionIndex(),this._collisionIndex=new mI,this._collisionIndex},clearCollisionIndex:function(){return this.collisionFrameTime=0,this._collisionIndex&&this._collisionIndex.clear(),this},_insertUICollidesQueue:function(){return this._uiCollidesQueue||(this._uiCollidesQueue=[]),this._uiCollidesQueue.push(1),this},uiCollides:function(){if(!this.uiList||0===this.uiList.length||!this._uiCollidesQueue||0===this._uiCollidesQueue.length)return this;var e=$D;e.clear();for(var t=this.uiList,i=0,n=t.length;i<n;i++){var r=t[i],s=r.options,o=s.collisionBufferSize;if(s.collision){var a=r.getDOM();if(r.isVisible()&&a&&a.getBoundingClientRect){r.bbox||(r.bbox=[0,0,0,0]);var l=a.getBoundingClientRect(),c=l.x,h=l.y,u=l.width,d=l.height;if(0===u||0===d){var p=r.getSize();p&&(u=p.width,d=p.height)}var m=c+u+o,f=h-o,g=h+d+o;r.bbox[0]=c-o,r.bbox[1]=f,r.bbox[2]=m,r.bbox[3]=g,e.collides(r.bbox)?r._collidesEffect(!1):(e.insertBox(r.bbox),r._collidesEffect(!0))}}}return this._uiCollidesQueue=[],this},_addUI:function(e){return this.uiList||(this.uiList=[]),this.uiList.indexOf(e)>-1||(this.uiList.push(e),this.uiList=this.uiList.sort((function(e,t){return t.options.collisionWeight-e.options.collisionWeight}))),this},_removeUI:function(e){if(!this.uiList)return-1;var t=this.uiList.indexOf(e);return t<0||this.uiList.splice(t,1),t}});var XD={distancetool:{start:"\u8d77\u70b9",units:{mile:" \u7c73",feet:" \u516c\u91cc",kilometer:" \u82f1\u5c3a",meter:" \u82f1\u91cc"}},areatool:{units:{mile:" \u5e73\u65b9\u82f1\u91cc",feet:" \u5e73\u65b9\u82f1\u5c3a",kilometer:" \u5e73\u65b9\u516c\u91cc",meter:" \u5e73\u65b9\u7c73"}}},KD={distancetool:{start:"Inicio",units:{mile:" mi",feet:" ft",kilometer:" km",meter:" m"}},areatool:{units:{mile:" mi\xb2",feet:" ft\xb2",kilometer:" km\xb2",meter:" m\xb2"}}},YD={distancetool:{start:"Start",units:{mile:" mi",feet:" ft",kilometer:" km",meter:" m"}},areatool:{units:{mile:" mi\xb2",feet:" ft\xb2",kilometer:" km\xb2",meter:" m\xb2"}}},JD=function(e){function t(t){var i;return(i=e.call(this,"Translator: "+t)||this).name="TranslatorError",i}return tM(t,e),t}(oM(Error)),QD=function(e){function t(t){var i;return(i=e.call(this)||this).languages={"zh-CN":XD,"es-MX":KD,"en-US":YD},i.nodes={},i.setLang(t||"zh-CN"),i}tM(t,e);var i=t.prototype;return i.setLang=function(e){var t=this.languages[e];if(!t)throw new JD("Setted Lang does not exist");this.nodes=t},i._validateNestedProps=function(e){e.forEach((function(e){if(""===e)throw new JD('Any of sides of a dot "." cannot be empty')}))},i.translate=function(e){if(void 0===e&&(e=null),null==e)throw new JD("Missing parameter textNode");if("string"!=typeof e)throw new JD("Param passed has to be a String");if(!e.includes("."))return this.nodes[e];var t=e.split(".");if(t.length>3)throw new JD("Translate function can only access through 3 nested properties, trying to access -> "+t.length);this._validateNestedProps(t);try{var i=null;switch(t.length){case 2:i=this.nodes[t[0]][t[1]];break;case 3:i=this.nodes[t[0]][t[1]][t[2]]}return i}catch(T0){throw new JD("Unable to find the text translated in lang json"+T0.message)}},t}(sI),ez=function(e){function t(t){var i;return(i=e.call(this,t)||this).on("enable",i._afterEnable,aM(aM(i))).on("disable",i._afterDisable,aM(aM(i))),i._measureLayers=[],i.translator=new QD(i.options.language),i}tM(t,e);var i=t.prototype;return i.clear=function(){if(EM(this._measureLayers))for(var e=0;e<this._measureLayers.length;e++)this._measureLayers[e].remove();return delete this._lastMeasure,delete this._lastVertex,this._outLayers(this._measureLayers),this._measureLayers=[],this},i.getMeasureLayers=function(){return this._measureLayers},i.getLastMeasure=function(){return this._lastMeasure?this._lastMeasure:0},i.undo=function(){e.prototype.undo.call(this);var t=this._historyPointer;if(t!==this._vertexes.length)for(var i=t;i<this._vertexes.length;i++)this._vertexes[i].label&&this._vertexes[i].label.remove(),this._vertexes[i].marker.remove();return this},i.redo=function(){e.prototype.redo.call(this);var t=this._historyPointer-1;return this._vertexes[t]&&(this._vertexes[t].marker.getLayer()||(this._vertexes[t].label&&this._vertexes[t].label.addTo(this._measureMarkerLayer),this._vertexes[t].marker.addTo(this._measureMarkerLayer))),this},i._formatLabelContent=function(e){var t=this.options.formatLabelContent;return t&&gP(t)?t.call(this,e)+"":null},i._measure=function(e){var t,i=this.getMap();e instanceof UO?t=i.computeGeometryLength(e):Array.isArray(e)&&(t=i.getProjection().measureLength(e)),this._lastMeasure=t;var n=this._formatLabelContent(t);if(n)return n;var r=[this.translator.translate("distancetool.units.meter"),this.translator.translate("distancetool.units.kilometer"),this.translator.translate("distancetool.units.feet"),this.translator.translate("distancetool.units.mile")],s="",o=this.options.decimalPlaces;return this.options.metric&&(s+=t<1e3?t.toFixed(o)+r[0]:(t/1e3).toFixed(o)+r[1]),this.options.imperial&&(s.length>0&&(s+="\n"),s+=(t*=3.2808399)<5280?t.toFixed(o)+r[2]:(t/5280).toFixed(o)+r[3]),s},i._registerMeasureEvents=function(){this.on("drawstart",this._msOnDrawStart,this).on("drawvertex",this._msOnDrawVertex,this).on("mousemove",this._msOnMouseMove,this).on("drawend",this._msOnDrawEnd,this)},i._afterEnable=function(){this._registerMeasureEvents()},i._afterDisable=function(){this.off("drawstart",this._msOnDrawStart,this).off("drawvertex",this._msOnDrawVertex,this).off("mousemove",this._msOnMouseMove,this).off("drawend",this._msOnDrawEnd,this)},i._msOnDrawStart=function(e){var t=this.getMap(),i=t._pointToPrj(e.point2d),n=fM(),r="distancetool_"+n,s="distancetool_markers_"+n,o=this.options.zIndex;t.getLayer(r)?(this._measureLineLayer=t.getLayer(r),this._measureMarkerLayer=t.getLayer(s)):(this._measureLineLayer=new hD(r,{zIndex:o}).addTo(t),this._measureMarkerLayer=new hD(s,{zIndex:o}).addTo(t)),this._measureLayers.push(this._measureLineLayer),this._measureLayers.push(this._measureMarkerLayer),this._pushLayers([this._measureLineLayer,this._measureMarkerLayer]);var a=new MN(e.coordinate,{symbol:this.options.vertexSymbol});a._setPrjCoordinates(i);var l=this.translator.translate("distancetool.start"),c=new eD(l,e.coordinate,this.options.labelOptions);c._setPrjCoordinates(i),this._lastVertex=c,this._addVertexMarker(a,c)},i._msOnMouseMove=function(e){var t=this._measure(this._msGetCoordsToMeasure(e));if(!this._tailMarker){var i=Vk(this.options.vertexSymbol);i.markerWidth/=2,i.markerHeight/=2,this._tailMarker=new MN(e.coordinate,{symbol:i}).addTo(this._measureMarkerLayer),this._tailLabel=new eD(t,e.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer)}var n=this._geometry._getPrjCoordinates(),r=n[n.length-1];this._tailMarker.setCoordinates(e.coordinate),this._tailMarker._setPrjCoordinates(r),this._tailLabel.setContent(t),this._tailLabel.setCoordinates(e.coordinate),this._tailLabel._setPrjCoordinates(r)},i._msGetCoordsToMeasure=function(e){return e.geometry.getCoordinates().concat([e.coordinate])},i._msOnDrawVertex=function(e){var t=this._geometry._getPrjCoordinates(),i=t[t.length-1],n=e.geometry,r=new MN(e.coordinate,{symbol:this.options.vertexSymbol}),s=this._measure(n),o=new eD(s,e.coordinate,this.options.labelOptions);this._addVertexMarker(r,o),o._setPrjCoordinates(i),r._setPrjCoordinates(i),this._lastVertex=o},i._addVertexMarker=function(e,t){this._vertexes||(this._vertexes=[]),void 0!==this._historyPointer&&this._vertexes.length>this._historyPointer-1&&(this._vertexes.length=this._historyPointer-1),this._vertexes.push({label:t,marker:e}),this._measureMarkerLayer.addGeometry(e),t&&this._measureMarkerLayer.addGeometry(t)},i._msOnDrawEnd=function(e){if(this._clearTailMarker(),e.geometry._getPrjCoordinates().length<2)return this._lastMeasure=0,void this._clearMeasureLayers();var t=this._lastVertex.getSize();t||(t=new wk(10,10)),this._addClearMarker(this._lastVertex.getCoordinates(),this._lastVertex._getPrjCoordinates(),t.width);var i=e.geometry.copy();i._setPrjCoordinates(e.geometry._getPrjCoordinates()),i.addTo(this._measureLineLayer),this._lastMeasure=i.getLength()},i._addClearMarker=function(e,t,i){var n=this.options.clearButtonSymbol,r={markerDx:(n.markerDx||0)+i,textDx:(n.textDx||0)+i};Array.isArray(n)&&(r=n.map((function(e){return e?{markerDx:(e.markerDx||0)+i,textDx:(e.textDx||0)+i}:null}))),n=Vk(n,r);var s=new MN(e,{symbol:n}),o=this._measureLineLayer,a=this._measureMarkerLayer;s.on("click",(function(){return o.remove(),a.remove(),!1}),this),s.addTo(this._measureMarkerLayer),s._setPrjCoordinates(t)},i._clearTailMarker=function(){this._tailMarker&&(this._tailMarker.remove(),delete this._tailMarker),this._tailLabel&&(this._tailLabel.remove(),delete this._tailLabel)},i._clearMeasureLayers=function(){this._measureLineLayer.remove(),this._measureMarkerLayer.remove()},t}(mD);ez.mergeOptions({formatLabelContent:null,decimalPlaces:2,mode:"LineString",language:"zh-CN",metric:!0,imperial:!1,symbol:{lineColor:"#000",lineWidth:3,lineOpacity:1},vertexSymbol:{markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:3,markerWidth:11,markerHeight:11},labelOptions:{textSymbol:{textFaceName:"monospace",textLineSpacing:1,textHorizontalAlignment:"right",textDx:15},boxStyle:{padding:[6,2],symbol:{markerType:"square",markerFill:"#fff",markerFillOpacity:.9,markerLineColor:"#b4b3b3"}}},clearButtonSymbol:[{markerType:"square",markerFill:"#fff",markerLineColor:"#b4b3b3",markerLineWidth:2,markerWidth:15,markerHeight:15,markerDx:20},{markerType:"x",markerWidth:10,markerHeight:10,markerDx:20}]}),function(e){function t(t){var i;return(i=e.call(this,t)||this).translator=new QD(i.options.language),i._measureLayers=[],i}tM(t,e);var i=t.prototype;return i._measure=function(e){var t,i=this.getMap();e instanceof UO?t=i.computeGeometryArea(e):Array.isArray(e)&&(t=i.getProjection().measureArea(e)),this._lastMeasure=t;var n=this._formatLabelContent(t);if(n)return n;var r=[this.translator.translate("areatool.units.meter"),this.translator.translate("areatool.units.kilometer"),this.translator.translate("areatool.units.feet"),this.translator.translate("areatool.units.mile")],s="",o=this.options.decimalPlaces;return this.options.metric&&(s+=t<1e6?t.toFixed(o)+r[0]:(t/1e6).toFixed(o)+r[1]),this.options.imperial&&(t*=Math.pow(3.2808399,2),s.length>0&&(s+="\n"),s+=t<27878400?t.toFixed(o)+r[2]:(t/27878400).toFixed(o)+r[3]),s},i._msGetCoordsToMeasure=function(e){return e.geometry.getShell().concat([e.coordinate])},i._msOnDrawVertex=function(e){var t=this.getMap()._pointToPrj(e.point2d),i=new MN(e.coordinate,{symbol:this.options.vertexSymbol});i._setPrjCoordinates(t),this._measure(e.geometry),this._lastVertex=i,this._addVertexMarker(i)},i._msOnDrawEnd=function(e){var t;if(this._clearTailMarker(),e.point2d)t=this.getMap()._pointToPrj(e.point2d);else{var i=e.geometry._getPrjCoordinates();i=i.slice(0,i.length-1),e.geometry._setPrjCoordinates(i),t=i[i.length-1]}if(e.geometry._getPrjCoordinates().length<3)return this._lastMeasure=0,void this._clearMeasureLayers();var n=this._measure(e.geometry),r=this.getMap().getProjection().unproject(t),s=new eD(n,r,this.options.labelOptions).addTo(this._measureMarkerLayer);s._setPrjCoordinates(t);var o=s.getSize();o||(o=new wk(10,10)),this._addClearMarker(r,t,o.width);var a=e.geometry.copy();a._setPrjCoordinates(e.geometry._getPrjCoordinates()),a.addTo(this._measureLineLayer),this._lastMeasure=a.getArea()},t}(ez).mergeOptions({mode:"Polygon",symbol:{lineColor:"#000000",lineWidth:2,lineOpacity:1,lineDasharray:"",polygonFill:"#ffffff",polygonOpacity:.5},language:"zh-CN"});var tz={create:function(e,t){var i=e.unproject(t[0]),n=new UN(i,0);return n._setPrjCoordinates(t[0]),n},update:function(e,t,i){var n=i.getMap(),r=Array.isArray(t)?t[t.length-1]:t,s=e.unproject(r),o=n.computeLength(i.getCenter(),s);i.setRadius(o)},generate:function(e){return e}};mD.registerMode("circle",hP({clickLimit:2,action:["click","mousemove","click"]},tz)),mD.registerMode("freeHandCircle",hP({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},tz));var iz={create:function(e,t){var i=e.unproject(t[0]),n=new qN(i,0,0);return n._setPrjCoordinates(t[0]),n},update:function(e,t,i){var n=i.getMap(),r=i.getCenter(),s=Array.isArray(t)?t[t.length-1]:t,o=e.unproject(s),a=n.computeLength(r,new vI({x:o.x,y:r.y})),l=n.computeLength(r,new vI({x:r.x,y:o.y}));i.setWidth(2*a),i.setHeight(2*l)},generate:function(e){return e}};mD.registerMode("ellipse",hP({clickLimit:2,action:["click","mousemove","click"]},iz)),mD.registerMode("freeHandEllipse",hP({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},iz));var nz={create:function(e,t){var i=new EN([]);return i._firstClick=t[0],i},update:function(e,t,i,n){var r=i.getMap(),s=n.containerPoint,o=r._prjToContainerPoint(i._firstClick),a=[[o.x,o.y],[s.x,o.y],[s.x,s.y],[o.x,s.y]];i.setCoordinates(a.map((function(e){return r.containerPointToCoord(new uM(e))}))),i._setPrjCoordinates(a.map((function(e){return r._containerPointToPrj(new uM(e))})))},generate:function(e){return e}};mD.registerMode("rectangle",hP({clickLimit:2,action:["click","mousemove","click"]},nz)),mD.registerMode("freeHandRectangle",hP({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},nz)),mD.registerMode("point",{clickLimit:1,action:["click","mousemove"],create:function(e,t){var i=e.unproject(t[0]),n=new MN(i);return n._setPrjCoordinates(t[0]),n},generate:function(e){return e},update:function(e,t,i){if(Array.isArray(t)&&(t=t[t.length-1]),!t)return i;var n=e.unproject(t);return i.setCoordinates(n),i}});var rz={create:function(e,t){var i=t.map((function(t){return e.unproject(t)})),n=new AN(i);return n._setPrjCoordinates(t),n},update:function(e,t,i){var n,r=i.getSymbol();Array.isArray(t)?n=t:(n=i._getPrjCoordinates()).push(t);var s=n.map((function(t){return e.unproject(t)}));i.setCoordinates(s),i._setPrjCoordinates(n);var o=i.getLayer();if(o){var a=o.getGeometryById("polygon");if(!a&&n.length>=3){if(a=new EN([s],{id:"polygon"}),r){var l=Vk(r,{lineOpacity:0});a.setSymbol(l)}a.addTo(o)}a&&a._setPrjCoordinates(n)}},generate:function(e){var t=new EN(e.getCoordinates(),{symbol:e.getSymbol()});return t._setPrjCoordinates(e._getPrjCoordinates()),t._projCode=e._projCode,t}};mD.registerMode("polygon",hP({action:["click","mousemove","dblclick"]},rz)),mD.registerMode("freeHandPolygon",hP({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},rz));var sz={create:function(e,t){var i=t.map((function(t){return e.unproject(t)})),n=new AN(i);return n._setPrjCoordinates(t),n},update:function(e,t,i){var n;Array.isArray(t)?n=t:(n=i._getPrjCoordinates()).push(t);var r=n.map((function(t){return e.unproject(t)}));i.setCoordinates(r),i._setPrjCoordinates(n)},generate:function(e){return e}};function oz(e){for(var t=e.tileInfo,i=[t.cols,t.rows],n=[],r=t.lods,s=0,o=r.length;s<o;s++)n.push(r[s].resolution);var a=e.fullExtent,l=t.origin,c=[1,-1,l.x,l.y];return delete a.spatialReference,{spatialReference:{resolutions:n,fullExtent:a},tileSystem:c,tileSize:i}}function az(e,t){return void 0===t&&(t=[]),t.forEach((function(t){e=e.replace(t[0],t[1])})),e}function lz(e){var t=e.projection,i=e.isArcgis,n=e.isGeoServer,r=e.isSuperMap,s=.0002645833333333333;return(i||n||r)&&(s=28e-5),t&&t.indexOf("4326")>-1&&(s=2.3767925226029154e-9,(i||r)&&(s=2.518101729011901e-9),n&&(s=2.51528279553466e-9)),s}function cz(e,t){var i=e.getElementsByTagName(t);return i&&i.length?i:e.getElementsByTagName("wmts:"+t)}function hz(e,t){for(var i=0;i<e.length;i++){var n=e[i];if((n=n.getElementsByTagName("ows:Identifier")[0])&&n.textContent===t)return e[i]}return null}function uz(e,t){void 0===t&&(t={});var i,n,r,s=cz(e,"TileMatrix"),o=[],a=[],l=[],c=!1;if(!i){var h=e.getElementsByTagName("ows:SupportedCRS")[0];h&&(i=function(e){return az(e.indexOf("EPSG")>-1?e:"EPSG:"+e,[["4490","4326"],["102100","3857"],["900913","3857"]])}(i=function(e){for(var t="",i=e.split(""),n=i.length-1;n>=0&&!isNaN(i[n]);n--)t=i[n]+t;return t}(i=(i=h.textContent).split("EPSG")[1])))}n||(n=e.getElementsByTagName("ows:Identifier")[0])&&(n=n.textContent),t.projection=i;for(var u=1/0,d=0;d<s.length;d++){var p=s[d],m=p.getElementsByTagName("ows:Identifier")[0].textContent;isNaN(parseInt(m))?(r=m.substr(0,m.lastIndexOf(":")),m=(m=m.split(":"))[m.length-1],m=parseInt(m),c=!0,t.isGeoServer=!0):m=parseInt(m),u=Math.min(u,m);var f=cz(p,"ScaleDenominator")[0].textContent,g=cz(p,"TopLeftCorner")[0].textContent,_=cz(p,"TileWidth")[0].textContent,y=cz(p,"TileHeight")[0].textContent;if(0===l.length&&l.push(parseInt(_),parseInt(y)),0===a.length){var v=g.split(" ").filter((function(e){return""!==e})).map((function(e){return parseFloat(e)})),x=v[0],b=v[1];x>0?a.push(1,-1,b,x):a.push(1,-1,x,b)}var w=lz(t),C=parseFloat(f)*w;o.push(C)}if(u>0)for(var S=o[0],E=u-1;E>=0;E--)o.splice(0,0,S*=2);return{resolutions:o,tileSize:l,tileSystem:a,projection:i,TileMatrixSet:n,isGeoServer:c,levelStr:r}}mD.registerMode("linestring",hP({action:["click","mousemove","dblclick"]},sz)),mD.registerMode("freeHandLinestring",hP({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},sz)),mD.registerMode("arccurve",{action:["click","mousemove","dblclick"],create:function(e,t){var i=t.map((function(t){return e.unproject(t)})),n=new ZN(i);return n._setPrjCoordinates(t),n},update:sz.update,generate:function(e){return e}}),mD.registerMode("quadbeziercurve",{action:["click","mousemove","dblclick"],create:function(e,t){var i=t.map((function(t){return e.unproject(t)})),n=new XN(i);return n._setPrjCoordinates(t),n},update:sz.update,generate:function(e){return e}}),mD.registerMode("cubicbeziercurve",{action:["click","mousemove","dblclick"],create:function(e,t){var i=t.map((function(t){return e.unproject(t)})),n=new $N(i);return n._setPrjCoordinates(t),n},update:sz.update,generate:function(e){return e}}),mD.registerMode("boxZoom",{action:["mousedown","mousemove","mouseup"],create:function(e,t){var i=e.unproject(t=t[0]),n=new MN(i);return n._firstClick=t,n},update:function(e,t,i,n){var r=i.getMap(),s=r._prjToContainerPoint(i._firstClick),o=n.containerPoint;t=r._containerPointToPrj(new vI(Math.min(s.x,o.x),Math.min(s.y,o.y)));var a=e.unproject(t);i.setCoordinates(a)._setPrjCoordinates(t),i.updateSymbol({markerWidth:Math.abs(s.x-o.x),markerHeight:Math.abs(s.y-o.y)})},generate:function(e){return e}}),BO.loadArcgis=function(e,t,i){if(void 0===i&&(i={jsonp:!0}),fP(e)&&"{"!==e.substring(0,1))UA.getJSON(e,(function(e,i){if(e)t(e);else{var n=oz(i);t(null,n)}}),i);else{fP(e)&&(e=gM(e));var n=oz(e);t(null,n)}return this},BO.loadWMTS=function(e,t,i){return void 0===i&&(i={jsonp:!0}),fP(e)&&UA.get(e,(function(n,r){if(n)t(n);else{var s=function(e,t,i){null==i.isArcgis&&(i.isArcgis=e.indexOf("arcgis")>-1),null==i.isSuperMap&&(i.isSuperMap=e.indexOf("supermap")>-1);var n=(new DOMParser).parseFromString(e,"text/xml").querySelectorAll("Contents")[0];if(!n)return[];var r=cz(n,"Layer");if(!r.length)return[];for(var s=[],o=0,a=n.childNodes.length;o<a;o++)"TileMatrixSet"===n.childNodes[o].localName&&s.push(n.childNodes[o]);if(!s.length)return[];for(var l=[],c=0,h=r.length;c<h;c++){var u=r[c],d=u.querySelectorAll("Style")[0];d&&(d=d.getElementsByTagName("ows:Identifier")[0])&&(d=d.textContent);var p=u.getElementsByTagName("ows:Identifier")[0];p&&(p=p.textContent);var m=cz(u,"TileMatrixSetLink");if(0!==m.length)for(var f=0,g=m.length;f<g;f++){var _=m[f];(_=cz(_,"TileMatrixSet")[0])&&(_=_.textContent);var y=hz(s,_);if(y){var v=u.querySelectorAll("ResourceURL")[0],x="";v&&(x=v.attributes.template.value);var b=uz(y,i),w=b.resolutions,C=b.tileSize,S=b.tileSystem,E=b.projection,T=b.TileMatrixSet,P=b.isGeoServer,M=b.levelStr;x.length||(x=t.substr(0,t.lastIndexOf("?")),x+="?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={tiles}&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}");var k=az(x,[["{LAYER}",p],["{Layer}",p],["{layer}",p],["{STYLE}",d],["{Style}",d],["{style}",d],["{TileMatrixSet}",T],["{TileMatrix}",P?M+":{z}":"{z}"],["{TileRow}","{y}"],["{TileCol}","{x}"],["{tiles}",P?"image/png":"tiles"]]);l.push({tileSize:C,tileSystem:S,spatialReference:{resolutions:w,projection:E},urlTemplate:k,info:{layerName:p,TileMatrixSet:T,style:d,tileSize:C,tileSystem:S,resolutions:w,projection:E,urlTemplate:k}})}}}return l}(r,e,i);t(null,s)}}),i),this};var dz=function(e){function t(t){var i;return(i=e.call(this,t)||this).proxyOptions(),i}tM(t,e);var i=t.prototype;return i.addTo=function(e){return this._owner=e,this._switchEvents("on"),this.onAdd&&this.onAdd(),this.fire("add"),this},i.getMap=function(){return this._owner?this._owner.getBaseLayer?this._owner:this._owner.getMap():null},i._collides=function(){var e=this.getMap();return e?(e._addUI(this),e._insertUICollidesQueue(),this):this},i._collidesEffect=function(e){var t=this.getDOM();if(!t)return this;if(t.style.visibility=e?"visible":"hidden",!t.classList||!t.classList.add)return this;if(!this.options.collisionFadeIn)return this;var i=t.classList.contains("mtk-ui-fadein");return e&&!i?t.classList.add("mtk-ui-fadein"):!e&&i&&t.classList.remove("mtk-ui-fadein"),this},i.show=function(e){var t=this,i=this.getMap();if(!i)return this;this.options.visible=!0,(e=e||this._coordinate||this._owner.getCenter())instanceof vI||(e=new vI(e));var n=this.isVisible();this._showBySymbolChange||this.fire("showstart");var r=this._getUIContainer();this._coordinate=e,this._removePrevDOM(),this._mapEventsOn||this._switchMapEvents("on");var s=this.__uiDOM=this.buildOn(i);s.eventsPropagation=this.options.eventsPropagation,this._observerDomSize(s);var o=this.options.zIndex;if(!s)return this._showBySymbolChange||this.fire("showend"),this._collides(),this.setZIndex(o),this;this._measureSize(s),this._singleton()&&(s._uiComponent=this,i[this._uiDomKey()]=s),this._setPosition(),s.style[$k]=null,r.appendChild(s);var a=this._getAnimation();if(n&&(a.ok=!1),a.ok&&(a.fade&&(s.style.opacity=0),a.scale)){if(this.getTransformOrigin){var l=this.getTransformOrigin();s.style[Zk]=l}s.style[Wk]=this._toCSSTranslate(this._pos)+" scale(0)"}this.isSupportZoomFilter()||(s.style.display=""),this.options.eventsToStop&&dA(s,this.options.eventsToStop,iA);var c=a.transition;return a.ok&&c&&(c&&(s.style[$k]=c),a.fade&&(s.style.opacity=1),a.scale&&(s.style[Wk]=this._toCSSTranslate(this._pos)+" scale(1)")),this._showBySymbolChange||this.fire("showend"),this._collides(),clearTimeout(this._autoPanId),this.options.autoPan&&(this._autoPanId=setTimeout((function(){t._autoPan()}),32)),this.setZIndex(o),this},i.hide=function(){var e=this;if(!this.getDOM())return this;this._onDomMouseout&&this._onDomMouseout(),this.options.visible=!1;var t=this._getAnimation(),i=this.getDOM();return this.options.animationOnHide||(t.ok=!1),t.ok?(i.style[$k]=t.transition,setTimeout((function(){i.style.display="none",e.fire("hide")}),this.options.animationDuration)):(i.style.display="none",this.fire("hide")),t.fade&&(i.style.opacity=0),t.scale&&(i.style[Wk]=this._toCSSTranslate(this._pos)+" scale(0)"),this._switchMapEvents("off"),this._collides(),this},i.isVisible=function(){if(!this.options.visible)return!1;var e=this.getDOM();return this.getMap()&&e&&e.parentNode&&"none"!==e.style.display},i.remove=function(){if(delete this._mapEventsOn,!this._owner)return this;var e=this.getMap();return e&&e._removeUI(this),this.hide(),this._switchEvents("off"),this.onRemove&&this.onRemove(),!this._singleton()&&this.__uiDOM&&this._removePrevDOM(),delete this._owner,this.fire("remove"),this._collides(),this},i.getSize=function(){return this._domContentRect&&this._size&&(this._size.width=this._domContentRect.width,this._size.height=this._domContentRect.height),this._size?this._size.copy():null},i.getOwner=function(){return this._owner},i.getDOM=function(){return this.__uiDOM},i.setZIndex=function(e){if(!dP(e))return this;var t=this.getDOM();return t?(t.style.zIndex=e,e!==this.options.zIndex&&(this.options.zIndex=e),this):this},i._roundPoint=function(e){return this.options.roundPoint&&(e=e._round()),e},i.getPosition=function(){if(!this.getMap())return null;var e=this._roundPoint(this._getViewPoint());if(this.getOffset){var t=this._roundPoint(this.getOffset());t&&e._add(t)}return e},i._getAnimation=function(){for(var e={fade:!1,scale:!1},t=this.options.animation?this.options.animation.split(","):[],i=0;i<t.length;i++){var n=Ck(t[i]);"fade"===n?e.fade=!0:"scale"===n&&(e.scale=!0)}var r=null;return e.fade&&(r="opacity "+this.options.animationDuration+"ms"),e.scale&&(r=r?r+",":"",r+=Wk+" "+this.options.animationDuration+"ms"),e.transition=r,e.ok=null!==r,e},i._getViewPoint=function(){var e=0,t=this._coordinate||{};dP(t.z)?e=t.z:this._owner&&this._owner.getAltitude&&(dP(e=this._owner.getAltitude()||0)||(e=0));var i=this._meterToPoint(this._coordinate,e);return this.getMap().coordToViewPoint(this._coordinate,void 0,i)._add(this.options.dx,this.options.dy)},i._meterToPoint=function(e,t){return t},i._autoPan=function(){var e=this.getMap(),t=this.getDOM();if(t&&e&&!e.isMoving()){var i=this._getViewPoint()._round(),n=e.width,r=e.height,s=e.getContainer();if(t&&s&&t.getBoundingClientRect){var o=s.getBoundingClientRect(),a=o.left,l=o.top,c=t.getBoundingClientRect(),h=0,u=0,d=c.left,p=c.right,m=c.top,f=c.bottom;if(d-=a,p-=a,m-=l,f-=l,c.width>0&&c.height>0)return d<50&&(h=50-d),0===h&&p+50>n&&(h=-(p+50-n)),m<50&&(u=50-m),0===u&&f+50>r&&(u=-(f+50-r)),void((0!==h||0!==u)&&(e.getPitch()>40&&0!==u&&this._coordinate?e.animateTo({center:this._coordinate},{duration:e.options.panAnimationDuration}):e.panBy([Math.ceil(h),Math.ceil(u)])))}var g=e.viewPointToContainerPoint(i),_=this.getOffset(),y=g.add(_),v=e._viewPointToPrj(i),x=parseInt(t.clientWidth),b=parseInt(t.clientHeight),w=0,C=0;if(y.x<0?w=50-y.x:y.x+x>n&&(w=-(y.x+x-n)-50),y.y-b<0?C=Math.abs(y.y-b)+50:y.y+b>r&&(C=r-(y.y+b)-50),x>=n&&(w=n/2-g.x),0!==C||0!==w){var S=g.add(w,C),E=e._containerPointToPoint(S)._sub(e._prjToPoint(e._getPrjCenter())),T=e._pointToPrj(e._prjToPoint(v).sub(E));e._panAnimation(T)}}},i._measureSize=function(e){var t=this._getUIContainer();e.style.position="absolute";var i=e.style.bottom?"bottom":"top";if(e.style.display="",t.appendChild(e),e.getBoundingClientRect){var n=e.getBoundingClientRect();this._size=new wk(n.width,n.height)}else this._size=new wk(e.clientWidth,e.clientHeight);return e.style.display="none",e.style.left="0px",e.style[i]="0px",this._size},i._removePrevDOM=function(){this.onDomRemove&&this.onDomRemove();var e=this.options.eventsToStop;if(this._singleton()){var t=this.getMap(),i=this._uiDomKey();if(t[i]){e&&pA(t[i],e,iA);var n=t[i]._uiComponent;n&&n!==this&&n.isVisible()&&n.fire("hide"),Yk(t[i]),n&&!this.hideDom&&n._switchMapEvents("off"),delete t[i]}delete this.__uiDOM}else this.__uiDOM&&(e&&pA(this.__uiDOM,e,iA),Yk(this.__uiDOM),delete this.__uiDOM);this._resizeObserver&&(this._resizeObserver.disconnect(),delete this._resizeObserver,delete this._domContentRect)},i._uiDomKey=function(){return"__ui_"+this._getClassName()},i._singleton=function(){return this.options.single},i._getUIContainer=function(){return this.getMap()._panels.ui},i._getClassName=function(){return"UIComponent"},i._switchMapEvents=function(e){var t=this.getMap();if(t){this._mapEventsOn="on"===e;var i=this._getDefaultEvents();if(this.getEvents&&hP(i,this.getEvents()),i)for(var n in i)i.hasOwnProperty(n)&&t[e](n,i[n],this)}},i._switchEvents=function(e){var t=this._getOwnerEvents();if(this._owner)for(var i in t)t.hasOwnProperty(i)&&this._owner[e](i,t[i],this)},i._getDefaultEvents=function(){return{"zooming rotate pitch":this.onEvent,zoomend:this.onZoomEnd,moving:this.onMoving,moveend:this.onMoving,resize:this.onResize}},i._getOwnerEvents=function(){var e={};return this._owner&&this._owner instanceof UO&&(e.positionchange=this.onGeometryPositionChange,e.symbolchange=this._updatePosition),this.getOwnerEvents&&hP(e,this.getOwnerEvents()),e},i.onGeometryPositionChange=function(e){this._owner&&this.isVisible()&&(this._showBySymbolChange=!0,this.show(e.target.getCenter()),delete this._showBySymbolChange)},i.onMoving=function(){this.isVisible()&&this.getMap().isTransforming()&&this._updatePosition()},i.onEvent=function(){this.isVisible()&&this._updatePosition()},i.onZoomEnd=function(){this.isVisible()&&this._setPosition()},i.onResize=function(){this.isVisible()&&this._setPosition()},i.onDomSizeChange=function(){this.isVisible()&&(this._setPosition(),this._collides())},i._updatePosition=function(){return this.getMap()?(this.getMap()._getRenderer().callInNextFrame(this._setPosition.bind(this)),this):this},i._setPosition=function(){var e=this.getDOM();if(e){e.style[$k]=null;var t=this.getPosition();this._pos=t,e.style[Wk]=this._toCSSTranslate(t)+" scale(1)"}},i._toCSSTranslate=function(e){if(!e)return"";if(QP.any3d){var t=this.getMap(),i=t?t.getBearing():0,n=t?t.getPitch():0,r="";return this.options.pitchWithMap&&n&&(r+=" rotateX("+Math.round(n)+"deg)"),this.options.rotateWithMap&&i&&(r+=" rotateZ("+Math.round(-i)+"deg)"),"translate3d("+e.x+"px,"+e.y+"px, 0px)"+r}return"translate("+e.x+"px,"+e.y+"px)"},i._observerDomSize=function(e){var t=this;return e&&QP.resizeObserver&&!this._resizeObserver?(this._resizeObserver=new ResizeObserver((function(e){if(e.length){var i=e[0].borderBoxSize;t._domContentRect=i&&i.length?{width:i[0].inlineSize,height:i[0].blockSize}:e[0].contentRect}else delete t._domContentRect;t.onDomSizeChange&&t.onDomSizeChange()})),this._resizeObserver.observe(e),this):this},i.isSupportZoomFilter=function(){return!1},i.onConfig=function(){return this._updatePosition(),this},t.isSupport=function(e){return!!(e&&gP(e.on)&&gP(e.off)&&gP(e.getCenter))},t}(nI(sI));dz.mergeOptions({eventsPropagation:!1,eventsToStop:null,dx:0,dy:0,autoPan:!1,autoPanDuration:600,single:!0,animation:"scale",animationOnHide:!1,animationDuration:500,pitchWithMap:!1,rotateWithMap:!1,visible:!0,roundPoint:!1,collision:!1,collisionBufferSize:2,collisionWeight:0,collisionFadeIn:!1,zIndex:0});var pz="mousedown mouseup mouseenter mouseover mouseout mousemove click dblclick contextmenu keypress touchstart touchmove touchend",mz=function(e){function t(t,i){var n;return(n=e.call(this,i)||this)._markerCoord=new vI(t),n}tM(t,e);var i=t.prototype;return i._getClassName=function(){return"UIMarker"},i.setCoordinates=function(e){return this._markerCoord=e,this.fire("positionchange"),this.isVisible()&&(this._coordinate=this._markerCoord,this._setPosition(),this._collides()),this},i.getCoordinates=function(){return this._markerCoord},i.getCenter=function(){return this.getCoordinates()},i.getAltitude=function(){var e=this.getCoordinates()||{};return dP(e.z)?e.z:this.options.altitude||0},i.setAltitude=function(e){return dP(e)&&this._markerCoord&&(this._markerCoord.z=e,this._updatePosition&&(this._updatePosition(),this._collides())),this},i.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(),this},i.getContent=function(){return this.options.content},i.onAdd=function(){if(this._owner&&!this._owner.isMap)throw new Error("UIMarker Can only be added to the map, but owner is:",this._owner.getJSONType());return this.show(),this},i.show=function(){return e.prototype.show.call(this,this._markerCoord)},i.flash=function(e,t,i,n){return OM.call(this,e,t,i,n)},i.buildOn=function(){var e,t=this.options.content,i=fP(t);return i||gP(t)?(e=Xk("div"),i?e.innerHTML=this.options.content:t.bind(this)(e)):e=this.options.content,this.options.containerClass&&(e.className=this.options.containerClass),this._registerDOMEvents(e),e},i.getOffset=function(){var e=this.getSize(),t=-e.width/2,i=-e.height/2,n=this.options,r=n.horizontalAlignment,s=n.verticalAlignment;return"left"===r?t=-e.width:"right"===r&&(t=0),"top"===s?i=-e.height:"bottom"===s&&(i=0),new uM(t,i)},i.getTransformOrigin=function(){return"center center"},i.onDomRemove=function(){var e=this.getDOM();this._removeDOMEvents(e)},i.isDragging=function(){return!!this.draggable&&this.draggable.isDragging()},i._registerDOMEvents=function(e){dA(e,pz,this._onDomEvents,this)},i._onDomEvents=function(e){var t=this.getMap()._parseEvent(e,e.type),i=e.type;if("mousedown"===i&&(this._mousedownEvent=e),"mouseup"===i&&(this._mouseupEvent=e),("click"!==i||!this._mouseClickPositionIsChange())&&("touchstart"===i&&(this._touchstartTime=cP()),this.fire(e.type,t),"touchend"===i&&QP.touch)){var n=this.getMap().options.clickTimeThreshold||280;cP()-this._touchstartTime<n&&this._onDomEvents(hP({},e,{type:"click"}))}},i._removeDOMEvents=function(e){pA(e,pz,this._onDomEvents,this)},i._mouseClickPositionIsChange=function(){var e=this._mousedownEvent||{},t=this._mouseupEvent||{};return e.x!==t.x||e.y!==t.y},i._getConnectPoints=function(){var e=this.getMap(),t=e.coordToContainerPoint(this.getCoordinates()),i=this.getSize(),n=i.width,r=i.height;return[e.containerPointToCoordinate(t.add(-n/2,0)),e.containerPointToCoordinate(t.add(n/2,0)),e.containerPointToCoordinate(t.add(0,r/2)),e.containerPointToCoordinate(t.add(0,-r/2))]},i._getViewPoint=function(){var e=0;if(this._owner){var t=this.getAltitude();t>0&&(e=this._meterToPoint(this._coordinate,t))}return this.getMap().coordToViewPoint(this._coordinate,void 0,e)._add(this.options.dx,this.options.dy)},i._getDefaultEvents=function(){return hP({},e.prototype._getDefaultEvents.call(this),{"zooming zoomend":this.onZoomFilter})},i._setPosition=function(){this.onZoomFilter(),e.prototype._setPosition.call(this)},i.onZoomFilter=function(){var e=this.getDOM();e&&(this.isVisible()||"none"===e.style.display?this.isVisible()&&"none"===e.style.display&&(e.style.display=""):e.style.display="none")},i.isVisible=function(){var e=this.getMap();if(!e)return!1;if(!this.options.visible)return!1;var t=e.getZoom(),i=this.options,n=i.minZoom,r=i.maxZoom;return!(!uP(n)&&t<n||!uP(r)&&t>r)&&this.getDOM()&&!0},i.isSupportZoomFilter=function(){return!0},t}(fI(dz));mz.mergeOptions({containerClass:null,eventsPropagation:!0,draggable:!1,single:!1,content:null,altitude:0,minZoom:0,maxZoom:null,horizontalAlignment:"middle",verticalAlignment:"middle"});var fz=QP.touch?"touchstart mousedown":"mousedown",gz=function(e){function t(t){return e.call(this,t)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){this.target.on(fz,this._startDrag,this)},i.removeHooks=function(){this.target.off(fz,this._startDrag,this)},i._startDrag=function(e){var t=e.domEvent;t.touches&&t.touches.length>1||2===t.button||this.isDragging()||(this.target.on("click",this._endDrag,this),this._lastCoord=e.coordinate,this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),this.target.fire("dragstart",e))},i._prepareDragHandler=function(){this._dragHandler=new yI(this.target.getDOM(),{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},i._cancelOn=function(e){var t=(e.srcElement||e.target).tagName.toLowerCase();return"button"===t||"input"===t||"select"===t||"option"===t||"textarea"===t},i._onMouseDown=function(e){iA(e.domEvent)},i._dragging=function(e){var t=this.target,i=t.getMap()._parseEvent(e.domEvent),n=i.domEvent;if(!(n.touches&&n.touches.length>1))if(this._isDragging){var r=i.coordinate,s=i.containerPoint;this._lastCoord||(this._lastCoord=r),this._lastPoint||(this._lastPoint=s);var o=r.sub(this._lastCoord),a=s.sub(this._lastPoint);this._lastCoord=r,this._lastPoint=s,this.target.setCoordinates(this.target.getCoordinates().add(o)),i.coordOffset=o,i.pointOffset=a,t.fire("dragging",i)}else this._isDragging=!0},i._endDrag=function(e){var t=this.target,i=t.getMap();if(this._dragHandler&&(t.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1,i){var n=i._parseEvent(e.domEvent);t&&t._mouseClickPositionIsChange&&t._mouseClickPositionIsChange()&&t.fire("dragend",n)}},i.isDragging=function(){return!!this._isDragging},t}(rI);mz.addInitHook("addHandler","draggable",gz);var _z=/\{ *([\w_]+) *\}/g,yz={containerClass:"maptalks-msgBox",autoPan:!0,autoCloseOn:null,autoOpenOn:"click",width:"auto",minHeight:120,custom:!1,title:null,content:null,enableTemplate:!1},vz=new wk(0,0),xz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i._getClassName=function(){return"InfoWindow"},i.addTo=function(t){return t instanceof UO&&(t.getInfoWindow()&&t.getInfoWindow()!==this&&t.removeInfoWindow(),t._infoWindow=this),e.prototype.addTo.call(this,t)},i.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(this._coordinate),this},i.getContent=function(){return this.options.content},i.setTitle=function(e){var t=e;return this.options.title=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.show(this._coordinate),this},i.getTitle=function(){return this.options.title},i.buildOn=function(){var e=gP(this.options.content),t=fP(this.options.content);if(this.options.custom){if(t||e){var i=Xk("div");return t?(i.innerHTML=this.options.content,this._replaceTemplate(i)):this.options.content.bind(this)(i),i}return this._replaceTemplate(this.options.content),this.options.content}this._bindDomEvents(this.getDOM(),"off");var n=Xk("div");this.options.containerClass&&(n.className=this.options.containerClass);var r=this._getWindowWidth();n.style.width=dP(r)?r+"px":"auto",n.style.bottom="0px";var s='<em class="maptalks-ico"></em>';this.options.title&&(s+="<h2>"+this.options.title+"</h2>"),n.innerHTML=s+='<a href="javascript:void(0);" class="maptalks-close">\xd7</a><div class="maptalks-msgContent"></div>',this._replaceTemplate(n);var o=n.querySelector(".maptalks-msgContent");return t||e?t?o.innerHTML=this.options.content:this.options.content.bind(this)(o):o.appendChild(this.options.content),this._onCloseBtnClick=this.hide.bind(this),Jk(n.querySelector(".maptalks-close"),"click touchend",this._onCloseBtnClick),e||this._replaceTemplate(o),this._bindDomEvents(n,"on"),n},i._replaceTemplate=function(e){if(this.options.enableTemplate&&this._owner&&this._owner.getProperties&&e&&e.innerHTML){var t=this._owner.getProperties()||{};mP(t)&&(e.innerHTML=e.innerHTML.replace(_z,(function(e,i){return t[i]})))}return this},i.getTransformOrigin=function(){return this.getSize().width/2+"px bottom"},i.getOffset=function(){var e=this.getSize(),t=new uM(-e.width/2,0);this.options.custom?t._sub(0,e.height):t._sub(4,12);var i=this.getOwner();if(i instanceof MN||i instanceof zN){var n,r;if(i instanceof MN)n=i._getPainter(),r=i.getSize();else{var s=i.getGeometries();if(!s||!s.length)return t;n=s[0]._getPainter(),r=s[0].getSize()}if(r||(r=vz),n){var o=n.getFixedExtent();t._add(o.xmax-r.width/2,o.ymin)}else t._add(0,-r.height)}return t},i.show=function(t){return this.getMap()&&this.getMap().options.enableInfoWindow?e.prototype.show.call(this,t):this},i.getEvents=function(){if(!this.options.autoCloseOn)return null;var e={};return e[this.options.autoCloseOn]=this.hide,e},i.getOwnerEvents=function(){var e=this.getOwner();if(!this.options.autoOpenOn||!e)return null;var t={};return t[this.options.autoOpenOn]=this._onAutoOpen,t},i.onRemove=function(){this._onDomMouseout(),this.onDomRemove()},i.onDomRemove=function(){this._onCloseBtnClick&&(Qk(this.getDOM().childNodes[2],"click touchend",this._onCloseBtnClick),delete this._onCloseBtnClick)},i._onAutoOpen=function(e){var t=this,i=this.getOwner();setTimeout((function(){i instanceof MN||i instanceof dz?t.show(i.getCoordinates()):i instanceof zN?t.show(i.findClosest(e.coordinate)):i instanceof AN||i instanceof BN?(t.getMap().getScale()>=8&&(e.coordinate=t._rectifyMouseCoordinte(i,e.coordinate)),t.show(e.coordinate)):t.show(e.coordinate)}),1)},i._rectifyMouseCoordinte=function(e,t){var i=this;return e instanceof AN?this._rectifyLineStringMouseCoordinate(e,t).coordinate:e instanceof BN?e.getGeometries().map((function(e){return i._rectifyLineStringMouseCoordinate(e,t)})).sort((function(e,t){return e.dis-t.dis}))[0].coordinate:t},i._rectifyLineStringMouseCoordinate=function(e,t){for(var i=this,n=e.getCoordinates().map((function(e){return i.getMap().coordToContainerPoint(e)})),r=this.getMap().coordToContainerPoint(t),s=1/0,o=-1,a=0,l=n.length;a<l;a++){var c=r.distanceTo(n[a]);c<s&&(s=c,o=a)}var h=[];0===o?h.push(n[0],n[1]):o===n.length-1?h.push(n[o-1],n[o]):h.push(n[o-1],n[o],n[o+1]);for(var u=[],d=this.getMap().getSize(),p=d.width,m=d.height,f=0,g=h.length-1;f<g;f++){var _=h[f],y=h[f+1];if(_.x===y.x)for(var v=Math.max(0,Math.min(_.y,y.y)),x=Math.min(m,Math.max(_.y,y.y)),b=v;b<=x;b++)u.push(new uM(_.x,b));else for(var w=(y.y-_.y)/(y.x-_.x),C=Math.max(0,Math.min(_.x,y.x)),S=Math.min(p,Math.max(_.x,y.x)),E=C;E<=S;E++)u.push(new uM(E,w*(E-_.x)+_.y))}for(var T=1/0,P=-1,M=0,k=u.length;M<k;M++){var A=r.distanceTo(u[M]);A<T&&(T=A,P=M)}return{dis:T,coordinate:P<0?t:this.getMap().containerPointToCoord(u[P])}},i._getWindowWidth=function(){var e=this.options.width;return e||(e=yz.width),e},i._bindDomEvents=function(e,t){if(e){var i=this._getDomEvents(),n="on"===t?dA:pA;for(var r in i)n(e,r,i[r],this)}},i._getDomEvents=function(){return{mouseover:this._onDomMouseover,mouseout:this._onDomMouseout}},i._onDomMouseover=function(e){var t=this.getMap();t&&(t.options.preventWheelScroll=!1)},i._onDomMouseout=function(e){var t=this.getMap();t&&(t.options.preventWheelScroll=!0)},t}(dz);xz.mergeOptions(yz);var bz="remove hide shapechange positionchange dragend animatestart",wz=function(e){tM(i,e);var t=i.prototype;function i(t,i){var n;return void 0===i&&(i={}),(n=e.call(this,i)||this)._content=t,n}return t._getClassName=function(){return"ToolTip"},t.addTo=function(t){if(i.isSupport(t))return t.on("mousemove",this.onMouseMove,this),t.on("mouseout",this.onMouseOut,this),t.on(bz,this.hideDom,this),e.prototype.addTo.call(this,t);throw new Error("Invalid geometry or UIMarker the tooltip is added to.")},t.setStyle=function(e){return this.options.containerClass=e,this},t.getStyle=function(){return this.options.containerClass},t.getContent=function(){return this._content},t.buildOn=function(){var e=Xk("div"),t=this.options||{};t.height&&(e.style.height=t.height+"px"),t.width&&(e.style.width=t.width+"px");var i=t.containerClass||t.cssName;return!i&&t.height&&(e.style.lineHeight=t.height+"px"),gP(this._content)?this._content.bind(this)(e):e.innerHTML='<div class="'+i+'">'+this._content+"</div>",e},t.onMouseOut=function(){clearTimeout(this._timeout),this.isVisible()&&this._removePrevDOM(),this._switchMapEvents("off")},t.onMouseMove=function(e){var t=this;clearTimeout(this._timeout);var i=this.getMap();if(i){var n=i.locateByPoint(e.coordinate,-5,25);0===this.options.showTimeout?this.show(n):this._timeout=setTimeout((function(){i&&t.show(n)}),this.options.showTimeout)}},t.onRemove=function(){clearTimeout(this._timeout),this._owner&&(this._owner.off("mouseover",this.onMouseOver,this),this._owner.off("mouseout",this.onMouseOut,this),this._owner.off(bz,this.hideDom,this))},t.hideDom=function(){return this.hide()},t.onEvent=function(){return e.prototype.onEvent.call(this),this.hideDom(),this},t._getViewPoint=function(){return this.getMap().coordToViewPoint(this._coordinate,void 0,0)._add(this.options.dx,this.options.dy)},i}(dz);wz.mergeOptions({width:0,height:0,animation:"fade",containerClass:"maptalks-tooltip",showTimeout:400});var Cz=function(e){function t(t){return e.call(this,t)||this}tM(t,e);var i=t.prototype;return i._getClassName=function(){return"Menu"},i.addTo=function(e){return e._menu&&e._menu!==this&&e.removeMenu(),e._menu=this,this._owner=e,dz.prototype.addTo.apply(this,arguments)},i.setItems=function(e){return this.options.items=e,this},i.getItems=function(){return this.options.items||[]},i.buildOn=function(){if(this.options.custom){if(fP(this.options.items)){var e=Xk("div");return e.innerHTML=this.options.items,e}return this.options.items}var t=Xk("div");this.options.containerClass&&lA(t,this.options.containerClass),t.style.width=this._getMenuWidth()+"px";var i=this._createMenuItemDom();return t.appendChild(i),dA(t,"contextmenu",tA),t},i.getOffset=function(){if(!this.getMap())return null;var e=this.getMap().getSize(),t=this.getMap().viewPointToContainerPoint(this._getViewPoint()),i=this.getSize(),n=0,r=0;return t.x+i.width>e.width&&(n=-i.width),t.y+i.height>e.height&&(r=-i.height),new uM(n,r)},i.getTransformOrigin=function(){var e=this.getOffset()._multi(-1);return e.x+"px "+e.y+"px"},i.getEvents=function(){return{"_zoomstart _zoomend _movestart _dblclick _click":this._removePrevDOM}},i._createMenuItemDom=function(){var e=this,t=this.getMap(),i=Xk("ul");lA(i,"maptalks-menu-items");var n,r,s=this.getItems();function o(i){return function(n){var r=t._parseEvent(n,"click");r.target=e,r.owner=e._owner,r.index=i,!1!==this._callback(r)&&(e.hide(),e._owner&&e._owner.fire("closemenu"))}}for(var a=0,l=s.length;a<l;a++){if("-"===(n=s[a])||"_"===n)lA(r=Xk("li"),"maptalks-menu-splitter");else{r=Xk("li");var c=n.item;gP(c)&&(c=c({owner:this._owner,index:a})),r.innerHTML=c,r._callback=n.click,dA(r,"click",o(a))}i.appendChild(r)}var h=this.options.maxHeight||0;return h>0&&oA(i,"max-height: "+h+"px; overflow-y: auto;"),i},i._getMenuWidth=function(){return this.options.width||160},t}(dz);Cz.mergeOptions({containerClass:"maptalks-menu",animation:null,animationDelay:10,animationOnHide:!1,autoPan:!1,width:160,maxHeight:0,custom:!1,items:[]});var Sz={setMenu:function(e){return this._menuOptions=e,this._menu?this._menu.setOptions(e):this.on("contextmenu",this._defaultOpenMenu,this),this},getMenu:function(){return this._menu},openMenu:function(e){var t=this instanceof lN?this:this.getMap();return e||(e=this.getCenter()),this._menu?this._menu.show(e):this._menuOptions&&t&&(this._bindMenu(),this._menu.show(e)),this.fire("openmenu",{coordinate:e}),this},setMenuItems:function(e){return this._menuOptions||(this._menuOptions={}),Array.isArray(e)&&(this._menuOptions.custom=!1),this._menuOptions.items=e,this.setMenu(this._menuOptions),this},getMenuItems:function(){return this._menu?this._menu.getItems():this._menuOptions&&this._menuOptions.items||[]},closeMenu:function(){return this._menu&&this._menu.hide(),this.fire("closemenu",{}),this},removeMenu:function(){return this.off("contextmenu",this._defaultOpenMenu,this),this._unbindMenu(),delete this._menuOptions,this.fire("removemenu",{}),this},_bindMenu:function(){return this._menuOptions?(this._menu=new Cz(this._menuOptions),this._menu.addTo(this),this):this},_unbindMenu:function(){return this._menu&&(this.closeMenu(),this._menu.remove(),delete this._menu),this},_defaultOpenMenu:function(e){return this.openMenu(e.coordinate),!1}};lN.include(Sz),UO.include(Sz);var Ez=Object.freeze({UIComponent:dz,UIMarker:mz,InfoWindow:xz,ToolTip:wz,Menuable:Sz,Menu:Cz}),Tz=function(e){function t(t){return t&&t.position&&!fP(t.position)&&(t.position=hP({},t.position)),e.call(this,t)||this}tM(t,e);var i=t.prototype;return i.addTo=function(e){if(this.remove(),!e.options.control)return this;this._map=e;var t=e._panels.control;return this.__ctrlContainer=Xk("div"),oA(this.__ctrlContainer,"position:absolute;overflow:visible;"),this.update(),t.appendChild(this.__ctrlContainer),this.onAdd&&this.onAdd(),this.fire("add",{dom:t}),this},i.update=function(){return this.__ctrlContainer.innerHTML="",this._controlDom=this.buildOn(this.getMap()),this._controlDom&&(this._updatePosition(),this.__ctrlContainer.appendChild(this._controlDom)),this},i.getMap=function(){return this._map},i.getPosition=function(){return hP({},this._parse(this.options.position))},i.setPosition=function(e){return this.options.position=fP(e)?e:hP({},e),this._updatePosition(),this},i.getContainerPoint=function(){var e,t,i=this.getPosition(),n=this.getMap().getSize();return uP(i.left)?uP(i.right)||(e=n.width-parseInt(i.right)):e=parseInt(i.left),uP(i.top)?uP(i.bottom)||(t=n.height-parseInt(i.bottom)):t=parseInt(i.top),new uM(e,t)},i.getContainer=function(){return this.__ctrlContainer},i.getDOM=function(){return this._controlDom},i.show=function(){return this.__ctrlContainer.style.display="",this},i.hide=function(){return this.__ctrlContainer.style.display="none",this},i.isVisible=function(){return this.__ctrlContainer&&""===this.__ctrlContainer.style.display},i.remove=function(){return this._map?(Yk(this.__ctrlContainer),this.onRemove&&this.onRemove(),delete this._map,delete this.__ctrlContainer,delete this._controlDom,this.fire("remove"),this):this},i._parse=function(e){var i=e;return fP(e)&&(i=t.positions[i]),i},i._updatePosition=function(){var e=this.getPosition();for(var t in e||(e={top:20,left:20}),e)e.hasOwnProperty(t)&&(e[t]=parseInt(e[t]),this.__ctrlContainer.style[t]=e[t]+"px");this.fire("positionchange",{position:hP({},e)})},t}(nI(sI));Tz.positions={"top-left":{top:20,left:20},"top-right":{top:20,right:20},"bottom-left":{bottom:20,left:20},"bottom-right":{bottom:20,right:20}},lN.mergeOptions({control:!0}),lN.include({addControl:function(e){return this._containerDOM.getContext||e.addTo(this),this},removeControl:function(e){return e&&e.getMap()===this?(e.remove(),this):this}});var Pz="addlayer removelayer setbaselayer baselayerremove",Mz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(){return this._attributionContainer=Xk("div"),this._attributionContainer.className="maptalks-attribution",this._update(),this._attributionContainer},i.onAdd=function(){this.getMap().on(Pz,this._update,this)},i.onRemove=function(){this.getMap().off(Pz,this._update,this)},i._update=function(){var e=this.getMap();if(e){var t=e._getLayers((function(e){return e.options.attribution})).reverse().map((function(e){return e.options.attribution})),i=this.options.content+(t.length>0?" - "+t.join(", "):"");this._attributionContainer.innerHTML='<span style="padding:0px 4px">'+i+"</span>"}},t}(Tz);Mz.mergeOptions({position:{bottom:0,left:0},content:'<a href="http://maptalks.org" target="_blank">maptalks</a>'}),lN.mergeOptions({attribution:!0}),lN.addOnLoadHook((function(){var e=this.options.attribution||this.options.attributionControl;e&&(this.attributionControl=new Mz(e),this.addControl(this.attributionControl))}));var kz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(e){var t=this._getCompass();return this._compass=t,this._registerDomEvents(),e.on("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),t},i.onAdd=function(){this._rotateCompass()},i._getCompass=function(){return Xk("div","maptalks-compass")},i._registerDomEvents=function(){dA(this._compass,"click",this._resetView,this)},i._rotateCompass=function(){var e=this.getMap().getBearing().toFixed(1);e<=180&&(e*=-1),e!==this._bearing&&(this._bearing=e,oA(this._compass,"transform: rotate("+this._bearing+"deg);"))},i.onRemove=function(){this.getMap().off("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),delete this._compass,delete this._bearing},i._resetView=function(){this.getMap().animateTo({bearing:0})},t}(Tz);kz.mergeOptions({position:{top:120,left:20}}),lN.mergeOptions({compassControl:!1}),lN.addOnLoadHook((function(){this.options.compassControl&&(this.compassControl=new kz(this.options.compassControl),this.addControl(this.compassControl))}));var Az=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(){var e=this.container=Xk("div",this.options.containerClass),t=this.panel=Xk("div","panel"),i=this.button=Xk("button");return e.appendChild(i),e.appendChild(t),e},i.onAdd=function(){dA(this.button,"mouseover",this._show,this),dA(this.panel,"mouseleave",this._hide,this),dA(this.getMap(),"click",this._hide,this)},i.onRemove=function(){this.panel&&(pA(this.button,"mouseover",this._show,this),pA(this.panel,"mouseleave",this._hide,this),pA(this.getMap(),"click",this._hide,this),Yk(this.panel),Yk(this.button),delete this.panel,delete this.button,delete this.container)},i._show=function(){aA(this.container,"shown")||(lA(this.container,"shown"),this._createPanel())},i._hide=function(e){this.panel.contains(e.toElement||e.relatedTarget)||cA(this.container,this.options.containerClass)},i._createPanel=function(){this.panel.innerHTML="";var e=Xk("ul");this.panel.appendChild(e),this._renderLayers(this.getMap(),e)},i._renderLayers=function(e,t){var i=this,n=e.getBaseLayer(),r=e.getLayers(),s=r.length;if(n){var o=n.layers||[n],a=Xk("li","group"),l=Xk("ul"),c=Xk("label");c.innerHTML=this.options.baseTitle,a.appendChild(c);for(var h=0,u=o.length;h<u;h++)this._isExcluded(o[h])&&(l.appendChild(this._renderLayer(o[h],!0)),a.appendChild(l),t.appendChild(a))}if(s){var d=Xk("li","group"),p=Xk("ul"),m=Xk("label"),f=Xk("input");f.type="checkbox",f.checked=!0,m.innerHTML=this.options.overlayTitle,d.appendChild(f),d.appendChild(m);for(var g=function(e){var t=e.target.checked,i=e.target.parentNode;if(i){var n=i.getElementsByTagName("ul")[0];if(n){var r=function(e){var i=e._layer;i&&i[t?"show":"hide"]()},s=function(e){var i=e._layer,n=e.childNodes[0];n&&(n.checked=t),i&&i[t?"show":"hide"]()};r(i),n.childNodes.forEach((function(e){s(e);var t=e.getElementsByTagName("ul")[0];t&&(r(e),t.childNodes.forEach((function(e){s(e)})))}))}}},_=0;_<s;_++){var y=r[_];this._isExcluded(y)&&(y.getLayers?function(){var e=Xk("li","group"),t=Xk("ul"),n=Xk("label"),r=Xk("input");n.innerHTML=y.getId(),r.type="checkbox",r.checked=y.isVisible(),r.onchange=g,e.appendChild(r),e.appendChild(n),e.appendChild(t),e._layer=y,p.appendChild(e),(y.getLayers()||[]).forEach((function(e){t.appendChild(i._renderLayer(e,!1,r.checked))}))}():p.appendChild(this._renderLayer(y)),y&&!y.isVisible()&&(f.checked=!1))}d.appendChild(p),t.appendChild(d),f.onchange=g}},i._isExcluded=function(e){var t=e.getId(),i=this.options.excludeLayers;return!(i.length&&i.indexOf(t)>=0)},i._renderLayer=function(e,t,i){var n=this;void 0===i&&(i=!0);var r=Xk("li","layer"),s=Xk("label"),o=Xk("input"),a=this.getMap(),l=e.options.visible;e.options.visible=!0;var c=e.isVisible();return e.options.visible=l,r.className="layer",t?(o.type="radio",o.name="base"):o.type="checkbox",o.checked=l&&c,i||(o.checked=!1),c||o.setAttribute("disabled","disabled"),o.onchange=function(t){if("radio"===t.target.type){var i=a.getBaseLayer(),r=i.layers;if(r)for(var s=0,o=r.length;s<o;s++){var l=r[s];l[l===e?"show":"hide"]()}else i.isVisible()||i.show();a._fireEvent("setbaselayer")}else e[t.target.checked?"show":"hide"]();n.fire("layerchange",{target:e})},r.appendChild(o),s.innerHTML=e.getId(),r.appendChild(s),r._layer=e,r},t}(Tz);Az.mergeOptions({position:"top-right",baseTitle:"Base Layers",overlayTitle:"Layers",excludeLayers:[],containerClass:"maptalks-layer-switcher"}),lN.mergeOptions({layerSwitcherControl:!1}),lN.addOnLoadHook((function(){this.options.layerSwitcherControl&&(this.layerSwitcherControl=new Az(this.options.layerSwitcherControl),this.addControl(this.layerSwitcherControl))}));var Iz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(){var e=this.options.size;this.options.maximize||(e=[0,0]);var t=Xk("div"),i=this.mapContainer=Xk("div");i.style.width=e[0]+"px",i.style.height=e[1]+"px",i.className=this.options.containerClass;var n=this.button=Xk("div");return n.className=this.options.buttonClass,t.appendChild(i),t.appendChild(n),t},i.onAdd=function(){this.options.maximize&&this._createOverview(),this.getMap().on("resize moving zooming rotate dragrotating viewchange",this._update,this).on("setbaselayer",this._updateBaseLayer,this).on("spatialreferencechange",this._updateSpatialReference,this),dA(this.button,"click",this._onButtonClick,this),this._updateButtonText()},i.onRemove=function(){this.getMap().off("resize moving zooming rotate dragrotating viewchange",this._update,this).off("setbaselayer",this._updateBaseLayer,this).off("spatialreferencechange",this._updateSpatialReference,this),this._overview&&(this._overview.remove(),delete this._overview,delete this._perspective),pA(this.button,"click",this._onButtonClick,this)},i.maxmize=function(){var e=this.options.size,t=this.mapContainer;return t.style.width=e[0]+"px",t.style.height=e[1]+"px",this._createOverview(),this},i.minimize=function(){this._overview&&this._overview.remove(),delete this._overview,delete this._perspective;var e=this.mapContainer;return e.style.width="0px",e.style.height="0px",this},i.getOverviewMap=function(){return this._overview},i._onButtonClick=function(){this._overview?this.minimize():this.maxmize(),this._updateButtonText()},i._updateButtonText=function(){this.button.innerHTML=this._overview?"-":"+"},i._createOverview=function(){var e=this.getMap(),t=this.mapContainer,i=e.config();hP(i,{center:e.getCenter(),zoom:this._getOverviewZoom(),zoomAnimationDuration:150,pitch:0,bearing:0,scrollWheelZoom:!1,checkSize:!1,doubleClickZoom:!1,touchZoom:!1,control:!1,draggable:!1,maxExtent:null}),this._overview=new lN(t,i),this._updateBaseLayer(),this._perspective=new EN(this._getPerspectiveCoords(),{draggable:!0,cursor:"move",symbol:this.options.symbol}).on("dragend",this._onDragEnd,this),new hD("perspective_layer",this._perspective).addTo(this._overview),this.fire("load")},i._getOverviewZoom=function(){var e=this.getMap(),t=e.getZoom(),i=e.getMinZoom(),n=this.options.level;if(n>0){for(var r=n;r>0;r--)if(t-r>=i)return t-r}else for(var s=n;s<0;s++)if(t-s>=i)return t-s;return t},i._onDragEnd=function(){var e=this._perspective.getCenter();this._overview.setCenter(e),this.getMap().panTo(e)},i._getPerspectiveCoords=function(){var e=this.getMap(),t=e.getProjection();return e.getContainerExtent().toArray().map((function(i){if(t){var n=e._containerPointToPrj(i);return e._fixPrjOnWorldWide(n),t.unproject(n)}return e.containerPointToCoordinate(i)}))},i._update=function(){if(this._overview){rA(this._overview._containerDOM);var e=this._getPerspectiveCoords();this._perspective.setCoordinates(e),this._overview.setCenterAndZoom(this.getMap().getCenter(),this._getOverviewZoom())}},i._updateSpatialReference=function(){if(this._overview){var e=this.getMap();this._overview.setSpatialReference(e.options.spatialReference)}},i._updateBaseLayer=function(){if(this._overview){var e=this.getMap().getBaseLayer();if(e){var t=e.layers,i=0;if(t)for(var n=0,r=t.length;n<r;n++)if(t[n].isVisible()){i=n;break}var s=e.toJSON(),o=null;t?(o=s.layers[i].options).visible=!0:o=s.options,this._overview.setMinZoom(o.minZoom||null).setMaxZoom(o.maxZoom||null),delete o.minZoom,delete o.maxZoom,delete s.options.canvas,s.options.visible=!0,s.options.renderer="canvas";var a=ZO.fromJSON(s);for(var l in e)gP(e[l])&&e.hasOwnProperty(l)&&e[l]!==e.constructor.prototype[l]&&(a[l]=e[l]);this._overview.setBaseLayer(a)}else this._overview.setBaseLayer(null)}},t}(Tz);Iz.mergeOptions({level:4,position:{right:1,bottom:1},size:[300,200],maximize:!0,symbol:{lineWidth:3,lineColor:"#1bbc9b",polygonFill:"#1bbc9b",polygonOpacity:.4},containerClass:"maptalks-overview",buttonClass:"maptalks-overview-button"}),lN.mergeOptions({overviewControl:!1}),lN.addOnLoadHook((function(){this.options.overviewControl&&(this.overviewControl=new Iz(this.options.overviewControl),this.addControl(this.overviewControl))}));var Rz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(){var e;if(this.options.custom)fP(this.options.content)?(e=Xk("div")).innerHTML=this.options.content:e=this.options.content;else{if(e=Xk("div","maptalks-panel"),this.options.closeButton){var t=Xk("a","maptalks-close");t.innerText="\xd7",t.href="javascript:;",t.onclick=function(){e.style.display="none"},e.appendChild(t)}var i=Xk("div","maptalks-panel-content");i.innerHTML=this.options.content,e.appendChild(i)}return this.draggable=new yI(e,{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this.draggable.on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this),this.options.draggable&&this.draggable.enable(),e},i.update=function(){return this.draggable&&(this.draggable.disable(),delete this.draggable),Tz.prototype.update.call(this)},i.setContent=function(e){var t=this.options.content;return this.options.content=e,this.fire("contentchange",{old:t,new:e}),this.isVisible()&&this.update(),this},i.getContent=function(){return this.options.content},i._cancelOn=function(e){var t=(e.srcElement||e.target).tagName.toLowerCase();return"button"===t||"input"===t||"select"===t||"option"===t||"textarea"===t},i._onDragStart=function(e){this._startPos=e.mousePos,this._startPosition=hP({},this.getPosition()),this.fire("dragstart",e)},i._onDragging=function(e){var t=e.mousePos.sub(this._startPos),i=this._startPosition,n=this.getPosition();uP(n.top)||(n.top=parseInt(i.top)+t.y),uP(n.bottom)||(n.bottom=parseInt(i.bottom)-t.y),uP(n.left)||(n.left=parseInt(i.left)+t.x),uP(n.right)||(n.right=parseInt(i.right)-t.x),this.setPosition(n),this.fire("dragging",e)},i._onDragEnd=function(e){delete this._startPos,delete this._startPosition,this.fire("dragend",e)},i._getConnectPoints=function(){var e=this.getMap(),t=this.getContainerPoint(),i=this.getDOM(),n=parseInt(i.clientWidth),r=parseInt(i.clientHeight);return[e.containerPointToCoordinate(t.add(n/2,0)),e.containerPointToCoordinate(t.add(n,r/2)),e.containerPointToCoordinate(t.add(n/2,r)),e.containerPointToCoordinate(t.add(0,r/2))]},t}(Tz);Rz.mergeOptions({position:"top-right",draggable:!0,custom:!1,content:"",closeButton:!0});var Oz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(){var e=this._getReset();return this._reset=e,this._registerDomEvents(),e},i.onAdd=function(){this._view=this.options.view?this.options.view:this.getMap().getView()},i.setView=function(e){this._view=e},i._getReset=function(){return Xk("div","maptalks-reset")},i._registerDomEvents=function(){dA(this._reset,"click",this._resetView,this)},i.onRemove=function(){delete this._reset,delete this._view},i._resetView=function(){this.getMap().setView(this._view)},t}(Tz);Oz.mergeOptions({position:{top:156,left:20},view:null}),lN.mergeOptions({resetControl:!1}),lN.addOnLoadHook((function(){this.options.resetControl&&(this.resetControl=new Oz(this.options.resetControl),this.addControl(this.resetControl))}));var Nz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(e){return this._map=e,this._scaleContainer=Xk("div",this.options.containerClass),this._addScales(),e.on("zoomend moving moveend",this._update,this),this._map._loaded&&this._update(),this._scaleContainer},i.onRemove=function(){this.getMap().off("zoomend moving moveend",this._update,this)},i._addScales=function(){var e="border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden;-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);";this.options.metric&&(this._mScale=Kk("div",this.options.containerClass?null:e,this._scaleContainer)),this.options.imperial&&(this._iScale=Kk("div",this.options.containerClass?null:e,this._scaleContainer))},i._update=function(){var e=this._map.pixelToDistance(this.options.maxWidth,0);this._updateScales(e)},i._updateScales=function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},i._updateMetric=function(e){var t=this._getRoundNum(e);this._updateScale(this._mScale,t<1e3?t+" m":t/1e3+" km",t/e)},i._updateImperial=function(e){var t,i,n,r=3.2808399*e;r>5280?(i=this._getRoundNum(t=r/5280),this._updateScale(this._iScale,i+" mile",i/t)):(n=this._getRoundNum(r),this._updateScale(this._iScale,n+" feet",n/r))},i._updateScale=function(e,t,i){e.style.width=Math.round(this.options.maxWidth*i)+"px",e.innerHTML=t},i._getRoundNum=function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),i=e/t;return t*(i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)},t}(Tz);Nz.mergeOptions({position:"bottom-left",maxWidth:100,metric:!0,imperial:!1,containerClass:null}),lN.mergeOptions({scaleControl:!1}),lN.addOnLoadHook((function(){this.options.scaleControl&&(this.scaleControl=new Nz(this.options.scaleControl),this.addControl(this.scaleControl))}));var Dz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(e){this._map=e;var t=Xk("div"),i=Xk("ul","maptalks-toolbar-hx");t.appendChild(i),lA(t,this.options.vertical?"maptalks-toolbar-vertical":"maptalks-toolbar-horizonal");var n=this;function r(e,t,i,r){var s=n._getItems()[t];return function(n){return iA(n),e({target:s,index:t,childIndex:i,dom:r})}}var s=this.options.items;if(EM(s))for(var o=0,a=s.length;o<a;o++){var l=s[o],c=Xk("li");if(28!==this.options.height&&(c.style.lineHeight=this.options.height+"px"),c.style.height=this.options.height+"px",c.style.cursor="pointer",/<[a-z\][\s\S]*>/i.test(l.item)){c.style.textAlign="center";var h=uA("div",l.item);c.innerHTML='<div style="margin-top:'+(this.options.height-h.height)/2+'px;">'+l.item+"</div>"}else c.innerHTML=l.item;if(l.click&&dA(c,"click",r(l.click,o,null,c)),EM(l.children)){var u=this._createDropMenu(o);c.appendChild(u),c._menu=u,dA(c,"mouseover",(function(){this._menu.style.display=""})),dA(c,"mouseout",(function(){this._menu.style.display="none"}))}i.appendChild(c)}return t},i._createDropMenu=function(e){var t=this;function i(e,i,n){var r=t._getItems()[i].children[n];return function(t){return iA(t),e({target:r,index:i,childIndex:n})}}var n=Xk("div","maptalks-dropMenu"),r=this._getItems(),s=r.length,o=Xk("ul"),a=r[e].children;e===s-1&&a&&(n.style.cssText="right: 0px;",o.style.cssText="right: 0px;position: absolute;",this.options.reverseMenu&&(o.style.bottom=0)),n.appendChild(Xk("em","maptalks-ico"));for(var l=0,c=0,h=a.length;c<h;c++){var u=Mk(a[c].item,"12px");u.width>l&&(l=u.width)}for(var d=0,p=a.length;d<p;d++){var m=a[d],f=Xk("li");f.innerHTML='<a href="javascript:;">'+m.item+"</a>",f.style.cursor="pointer",f.style.width=l+24+"px",dA(f.childNodes[0],"click",i(m.click,e,d)),o.appendChild(f)}if(this.options.vertical){var g=l<95?95:l;this.options.reverseMenu?n.style.right=-(g+20+2)+"px":n.style.left=-(g+20+2)+"px"}else this.options.reverseMenu?n.style.bottom="28px":n.style.top="29px";return n.appendChild(o),n.style.display="none",n},i._getItems=function(){return this.options.items||[]},t}(Tz);Dz.mergeOptions({height:28,vertical:!1,position:"top-right",reverseMenu:!1,items:{}});var zz=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.buildOn=function(e){var t=this.options,i=Xk("div","maptalks-zoom");if(t.zoomLevel){var n=Xk("span","maptalks-zoom-zoomlevel"),r=Xk("span","maptalks-zoom-zoomlevel-text");n.appendChild(r),i.appendChild(n),this._levelDOM=r}var s=Xk("div","maptalks-zoom-slider"),o=Xk("a","maptalks-zoom-zoomin");o.href="javascript:;",s.appendChild(o),this._zoomInButton=o;var a=Xk("a","maptalks-zoom-zoomout");return a.href="javascript:;",s.appendChild(a),this._zoomOutButton=a,i.appendChild(s),e.on("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this),this._update(),this._registerDomEvents(),i},i.onRemove=function(){this.getMap().off("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this)},i._update=function(){this._updateText()},i._updateText=function(){if(this._levelDOM){var e=this.getMap().getZoom();pP(e)||(e=Math.floor(10*e)/10),this._levelDOM.innerHTML=e}},i._registerDomEvents=function(){this._zoomInButton&&dA(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&dA(this._zoomOutButton,"click",this._onZoomOutClick,this)},i._onZoomInClick=function(e){tA(e),this.getMap().zoomIn()},i._onZoomOutClick=function(e){tA(e),this.getMap().zoomOut()},t}(Tz);zz.mergeOptions({position:"top-left",zoomLevel:!0,seamless:!1}),lN.mergeOptions({zoomControl:!1}),lN.addOnLoadHook((function(){this.options.zoomControl&&(this.zoomControl=new zz(this.options.zoomControl),this.addControl(this.zoomControl))}));var Lz=Object.freeze({Control:Tz,Attribution:Mz,Compass:kz,LayerSwitcher:Az,Overview:Iz,Panel:Rz,Reset:Oz,Scale:Nz,Toolbar:Dz,Zoom:zz}),Bz=function(){function e(e,t,i,n){Array.isArray(e)?(this.scale={x:e[0],y:e[1]},this.origin={x:e[2],y:e[3]}):(this.scale={x:e,y:t},this.origin={x:i,y:n})}return e.getDefault=function(e){var t=e.code.toLowerCase();return"baidu"===t?"baidu":t==="EPSG:4326".toLowerCase()||t==="EPSG:4490".toLowerCase()?"tms-global-geodetic":"identity"===t?[1,-1,0,0]:"web-mercator"},e}(),Fz=6378137*Math.PI;hP(Bz,{"web-mercator":new Bz([1,-1,-Fz,Fz]),"tms-global-mercator":new Bz([1,1,-Fz,-Fz]),"tms-global-geodetic":new Bz([1,1,-180,-90]),baidu:new Bz([1,1,0,0])});var jz=function(){function e(e,t,i,n){this.map=e,this.tileSize=n,this.fullExtent=i,this.prepareTileInfo(t,i),this._xScale=i.right>=i.left?1:-1,this._yScale=i.top>=i.bottom?1:-1;var r=e.getGLRes();this._pointOrigin=e._prjToPointAtRes(new uM(this.tileSystem.origin),r),this._glRes=r}var t=e.prototype;return t.prepareTileInfo=function(e,t){if(fP(e)?e=Bz[e.toLowerCase()]:Array.isArray(e)&&(e=new Bz(e)),!e)throw new Error("Invalid TileSystem");this.tileSystem=e,this.transformation=new zI([t.right>t.left?1:-1,t.top>t.bottom?-1:1,e.origin.x,e.origin.y])},t._getTileNum=function(e,t){var i=this.tileSystem,n=this.tileSize,r=Math.floor(1e-7*i.scale.x+e.x/(n.width*t)),s=Math.ceil(1e-7*i.scale.y+e.y/(n.height*t));return{x:i.scale.x*r,y:i.scale.y*s}},t.getTileIndex=function(e,t,i){var n=this.tileSystem,r=this.transformation.transform(e,1),s=this._getTileNum(r,t);return n.scale.x<0&&(s.x-=1),n.scale.y>0&&(s.y-=1),this.getNeighorTileIndex(s.x,s.y,0,0,t,i)},t.getNeighorTileIndex=function(e,t,i,n,r,s){var o=this.tileSystem,a=e+o.scale.x*i,l=t-o.scale.y*n,c=!1,h=a,u=l,d=this._getTileFullIndex(r);return s&&(!0!==s&&"x"!==s||(d.xmax===d.xmin?a=d.xmin:a<d.xmin?(a=d.xmax-(d.xmin-a)%(d.xmax-d.xmin))===d.xmax&&(a=d.xmin):a>=d.xmax&&(a=d.xmin+(a-d.xmin)%(d.xmax-d.xmin))),!0!==s&&"y"!==s||(d.ymax===d.ymin?l=d.ymin:l>=d.ymax?l=d.ymin+(l-d.ymin)%(d.ymax-d.ymin):l<d.ymin&&(l=d.ymax-(d.ymin-l)%(d.ymax-d.ymin))===d.ymax&&(l=d.ymin))),(a<d.xmin||a>d.xmax||l>d.ymax||l<d.ymin)&&(c=!0),{x:a,y:l,idx:h,idy:u,out:c}},t._getTileFullIndex=function(e){if(this._tileFullIndex||(this._tileFullIndex={}),this._tileFullIndex[e])return this._tileFullIndex[e];var t=this.fullExtent,i=this.transformation,n=this._getTileNum(i.transform(new vI(t.left,t.top),1),e),r=this._getTileNum(i.transform(new vI(t.right,t.bottom),1),e),s=this.tileSystem;return s.scale.x<0&&(n.x-=1,r.x-=1),s.scale.y>0&&(n.y-=1,r.y-=1),this._tileFullIndex[e]=new OI(n,r),this._tileFullIndex[e]},t.getTilePrjNW=function(e,t,i,n){var r=this.tileSystem,s=this.tileSize,o=r.origin.y+this._yScale*r.scale.y*(t+(1===r.scale.y?1:0))*i*s.height,a=r.origin.x+this._xScale*r.scale.x*(e+(1===r.scale.x?0:1))*i*s.width;return n?(n.set(a,o),n):new vI(a,o)},t.getTilePointNW=function(e,t,i,n){var r=this._glRes/i,s=this.tileSystem,o=this.tileSize,a=this._pointOrigin.y*r+this._yScale*s.scale.y*(t+(1===s.scale.y?1:0))*o.height,l=this._pointOrigin.x*r+this._xScale*s.scale.x*(e+(1===s.scale.x?0:1))*o.width;return n?(n.set(l,a),n):new uM(l,a)},t.getTilePrjSE=function(e,t,i,n){var r=this.tileSystem,s=this.tileSize,o=r.origin.y+this._yScale*r.scale.y*(t+(1===r.scale.y?0:1))*i*s.height,a=r.origin.x+this._xScale*r.scale.x*(e+(1===r.scale.x?1:0))*i*s.width;return n?(n.set(a,o),n):new vI(a,o)},t.getTilePointSE=function(e,t,i,n){var r=this._glRes/i,s=this.tileSystem,o=this.tileSize,a=this._pointOrigin.y*r+this._yScale*s.scale.y*(t+(1===s.scale.y?0:1))*o.height,l=this._pointOrigin.x*r+this._xScale*s.scale.x*(e+(1===s.scale.x?1:0))*o.width;return n?(n.set(l,a),n):new uM(l,a)},t.getTilePrjExtent=function(e,t,i){var n=this.getTilePrjNW(e,t,i),r=this.getTilePrjSE(e,t,i);return new OI(n,r)},e}(),Vz=new uM(0,0),Uz="undefined"!=typeof Set,qz=function(){function e(){this._table=Uz?new Set:{}}var t=e.prototype;return t.add=function(e){Uz?this._table.add(e):this._table[e]=!0},t.has=function(e){return Uz?this._table.has(e):this._table[e]},t.reset=function(){Uz?this._table.clear():this._table={}},e}(),Hz={urlTemplate:null,subdomains:null,errorUrl:null,repeatWorld:!0,background:!0,loadingLimitOnInteracting:3,loadingLimit:0,tileRetryCount:0,placeholder:!1,crossOrigin:null,tileSize:[256,256],offset:[0,0],tileSystem:null,fadeAnimation:!wP,fadeDuration:1e3/60*10,debug:!1,spatialReference:null,maxCacheSize:256,renderer:QP.webgl?"gl":"canvas",clipByPitch:!0,maxAvailableZoom:null,cascadeTiles:!0,zoomOffset:0,pyramidMode:1,decodeImageInWorker:!1,tileLimitPerFrame:0,tileStackStartDepth:7,tileStackDepth:6,awareOfTerrain:!0,bufferPixel:.5,mipmapTexture:!0,depthMask:!0},Gz=/\{ *([\w_]+) *\}/g,Wz=new uM(0,0),Zz=new uM(0,0),$z=new uM(0,0),Xz=new uM(0,0),Kz=new uM(0,0),Yz=new uM(0,0),Jz=[[0,0,0],[0,0,0]],Qz=[0,0,0],eL=[0,0,0],tL=[],iL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e),t.fromJSON=function(e){return e&&"TileLayer"===e.type?new t(e.id,e.options):null};var i=t.prototype;return i.forceReload=function(){return this.fire("forcereloadstart"),this.clear(),this.load(),this.fire("forcereloadend"),this},i.getTileSize=function(){if(this._tileSize)return this._tileSize;var e=this.options.tileSize;return dP(e)&&(e=[e,e]),this._tileSize=new wk(e),this._tileSize},i.getTiles=function(e,t){return this._coordCache={},this._isPyramidMode()?this._getPyramidTiles(e,t):this._getCascadeTiles(e,t)},i._isPyramidMode=function(){var e=this.getSpatialReference();return!this._disablePyramid&&!this._hasOwnSR&&this.options.pyramidMode&&e&&e.isPyramid()},i._getTileFullExtent=function(){if(this._tileFullExtent)return this._tileFullExtent;var e=this.getSpatialReference(),t=e.getFullExtent(),i=e.getResolution(0),n=this.getMap();return this._tileFullExtent=t.convertTo((function(e){return n._prjToPointAtRes(e,i,Vz)})),this._tileFullExtent},i._getRootNodes=function(e){var t=this.getMap();if(this._rootNodes){var i=this._rootNodes,n=i.tiles;if(t.width!==i.mapWidth||t.height!==i.mapHeight){for(var r=this._getRootError(),s=0;s<n.length;s++)n[s].error=r;this._rootNodes.mapWidth=t.width,this._rootNodes.mapHeight=t.height}for(var o=0;o<n.length;o++)n[o].offset[0]=e[0],n[o].offset[1]=e[1];return this._rootNodes}var a=this.getSpatialReference(),l=a.getResolution(0),c=this._getTileConfig(),h=a.getFullExtent(),u=c.tileSystem,d=u.origin,p=u.scale,m=c.getTilePrjExtent(0,0,l),f=m.getWidth(),g=m.getHeight(),_=Math.abs((d.x-h.left)/f);_=Math.ceil(_-1e-5);var y=Math.abs((h.right-d.x)/f);y=Math.ceil(y-1e-5);var v=Math.ceil(Math.abs(h.top-d.y)/g);v=Math.ceil(v-1e-5);var x=Math.ceil(Math.abs(h.bottom-d.y)/g);if((y+_)*((x=Math.ceil(x-1e-5))+v)>32)return{status:0,error:"Too many root nodes"};for(var b=this._getRootError(),w=[],C=-_;C<y;C++)for(var S=-v;S<x;S++){var E=p.y<0?S:-(S+1);w.push(this.createTileNode(C,E,0,C,E,l,b))}return this._rootNodes={status:1,tiles:w,mapWidth:t.width,mapHeight:t.height},this._getRootNodes(e)},i.createTileNode=function(e,t,i,n,r,s,o,a,l,c){var h=this.getMap(),u=this.options.zoomOffset;l||(l=this._getTileConfig().getTilePrjExtent(e,t,s).convertTo((function(e){return h._prjToPointAtRes(e,s,Vz)})));var d=this._getTileOffset(i);return{parent:a,layer:this.getId(),x:e,y:t,z:i,idx:n,idy:r,res:s,extent2d:l,id:c||this._getTileId(e,t,i),url:this.getTileUrl(e,t,i+u),offset:d,error:o,children:[]}},i._getRootError=function(){var e=this.getMap(),t=xP(e.getFov()),i=e.width/e.height,n=e.cameraPosition[2],r=n*Math.tan(.5*t),s=r*i,o=Math.sqrt(n*n+r*r+s*s);return e._getFovZ(0)*(o/n)*this.getSpatialReference().getResolution(0)/e.getResolution(0)},i._getPyramidTiles=function(e,t){var i=this.getMap();isNaN(+e)&&(e=this._getTileZoom(i.getZoom()));var n,r=this.getSpatialReference(),s=Math.min(e,this.getMaxZoom(),this.getMaxAvailableZoom()||1/0),o=i.projViewMatrix,a=this._getTileFullExtent(),l=this._getTileOffset(0);if(this.options.repeatWorld){var c=i.getContainerExtent(),h=this._convertToExtent2d(c),u=r.getResolution(0)/i.getResolution();if(h.within(a.copy()._scale(u))){var d=this._getRootNodes(l);if(1!==d.status)return console.warn(d.error),this._disablePyramid=!0,this.getTiles(e,t);n=d.tiles.concat()}else{var p=i.getPitch(),m=i.options.cascadePitches[1],f=Math.floor(i._getVisualHeight(m)),g=p<=m?c:new DI(0,i.height-f,i.width,i.height);this._visitedTiles=new qz;var _=this._getTiles(0-this.options.zoomOffset,g,2,t&&t.getRenderer(),!0),y=this._getRootError()*Math.pow(2,this.options.zoomOffset);_.tiles.forEach((function(e){e.error=y})),n=_.tiles}}else{var v=this._getRootNodes(l);if(1!==v.status)return console.warn(v.error),this._disablePyramid=!0,this.getTiles(e,t);n=v.tiles.concat()}for(var x=i.getGLRes(),b={0:l},w=new DI,C=[],S=[];n.length>0;){var E=n.pop();E.z!==s?(b[E.z+1]||(b[E.z+1]=this._getTileOffset(E.z+1)),this._splitNode(E,o,n,C,w,s,b[E.z+1],t&&t.getRenderer(),x),this.isParentTile(e,s,E)&&S.push(E)):(w._combine(E.extent2d),C.push(E))}return S.sort(nL),{tileGrids:[{extent:w,count:C.length,tiles:C,parents:S,offset:[0,0],zoom:e}],count:C.length}},i.isParentTile=function(e,t,i){var n=Math.max(this.getMinZoom(),e-this.options.tileStackStartDepth),r=Math.min(t,n+this.options.tileStackDepth);return i.z>=n&&i.z<r},i._splitNode=function(e,t,i,n,r,s,o,a,l){for(var c=e.z+1,h=this.getSpatialReference(),u=e.idx,d=e.idy,p=a||this.getRenderer(),m=!1,f=[],g=h.getResolution(c)/l,_=0;_<4;_++){var y=_%2,v=_>>1,x=(u<<1)+y,b=(d<<1)+v;e.children||(e.children=[]);var w=e.children[_];w||(w=this._getTileId(x,b,c),e.children[_]=w);var C=p.isTileCachedOrLoading(w),S=C&&C.info;S||(this.tileInfoCache||(this.tileInfoCache=new VA(4*this.options.maxCacheSize)),(S=this.tileInfoCache.get(w))||(S=this._createChildNode(e,y,v,o,w))),S.error=e.error/2,S.offset[0]=o[0],S.offset[1]=o[1];var E=this._isTileVisible(S,t,g,s,o);if(1===E)m=!0;else{if(-1===E)continue;if(0===E&&c!==s)return n.push(e),void r._combine(e.extent2d)}f.push(S)}c===s?m?i.push.apply(i,f):(n.push(e),r._combine(e.extent2d)):i.push.apply(i,f)},i._createChildNode=function(e,t,i,n,r){var s,o=e.extent2d,a=e.z+1,l=(e.x<<1)+t,c=(e.y<<1)+i,h=(e.idx<<1)+t,u=(e.idy<<1)+i,d=o.getWidth()/2*2,p=o.getHeight()/2*2,m=2*o.xmin,f=2*o.ymax,g=2*o.ymin,_=this._getTileConfig().tileSystem.scale.y;if(r=r||this._getTileId(h,u,a),_<0){var y=m+t*d,v=f-i*p;s=new DI(y,v-p,y+d,v)}else{var x=m+t*d,b=g+i*p;s=new DI(x,b,x+d,b+p)}var w=this.createTileNode(l,c,a,h,u,e.res/2,e.error/2,e.id,s,r);return this.tileInfoCache.add(r,w),w},i._isTileVisible=function(e,t,i,n,r){if(0===e.z)return 1;if(!this._isTileInFrustum(e,t,i,r))return-1;var s=this.options.maxError;return uP(s)&&(s=1),this._getScreenSpaceError(e,i,n,r)>=s?1:0},i._isTileInFrustum=function(e,t,i,n){if(!this._zScale){var r=this.getMap(),s=r.getGLRes();this._zScale=r.altitudeToPoint(100,s)/100}var o=this.getRenderer(),a=e.extent2d,l=a.ymin,c=a.xmax,h=a.ymax;return Jz[0][0]=(a.xmin-n[0])*i,Jz[0][1]=(l-n[1])*i,Jz[0][2]=(e.minAltitude||o&&o.avgMinAltitude||0)*this._zScale,Jz[1][0]=(c-n[0])*i,Jz[1][1]=(h-n[1])*i,Jz[1][2]=(e.maxAltitude||o&&o.avgMaxAltitude||0)*this._zScale,QT(t,Jz)},i._getScreenSpaceError=function(e,t,i,n){var r=e.error,s=this.getMap(),o=e.extent2d,a=o.ymin,l=o.xmax,c=o.ymax;Qz[0]=(o.xmin-n[0])*t,Qz[1]=(a-n[1])*t,eL[0]=(l-n[0])*t,eL[1]=(c-n[1])*t;var h,u,d,p,m,f,g=(h=Qz,u=eL,d=s.cameraPosition,p=Math.max(h[0]-d[0],0,d[0]-u[0]),m=Math.max(h[1]-d[1],0,d[1]-u[1]),f=Math.max(h[2]-d[2],0,d[2]-u[2]),Math.sqrt(p*p+m*m+f*f)),_=Math.max(Math.abs(g),1e-7),y=Math.abs(e.z-i);return r*(s.height<1e3||y<=1?1:y<=2?.7:.605)/_},i._getCascadeTiles=function(e,t){var i=this.getMap(),n=i.getPitch(),r=t&&t.getRenderer(),s=i.getContainerExtent(),o=[],a=0,l=this.getMinZoom(),c=i.options.cascadePitches[0],h=i.options.cascadePitches[1],u=Math.floor(i._getVisualHeight(h)),d=uP(e)?this._getTileZoom(i.getZoom()):e;if(this._visitedTiles=new qz,!uP(e)||!this.options.cascadeTiles||n<=c||!uP(l)&&d<=l){var p=n<=h?s:new DI(0,i.height-u,i.width,i.height),m=this._getTiles(d,p,2,r);return m&&(a+=m.tiles.length,o.push(m)),{tileGrids:o,count:a}}var f=Math.floor(i._getVisualHeight(c)),g=new DI(0,i.height-f,i.width,i.height),_=this._getTiles(d,g,0,r);a+=_?_.tiles.length:0,o.push(_);var y,v,x=g.ymin,b=i.getSpatialReference().getZoomDirection(),w=b;if(n>h){d-w<=l&&(w=0);var C=new DI(0,i.height-u,i.width,x);a+=(y=this._getTiles(d-w,C,1,r))?y.tiles.length:0,x=C.ymin,w+=4*b,o.push(y)}if(d-w>=l){var S=new DI(0,s.ymin,i.width,x);a+=(v=this._getTiles(d-w,S,2,r))?v.tiles.length:0,o.push(v)}return y&&v&&(o[1]=v,o[2]=y),{tileGrids:o,count:a}},i.getTileUrl=function(e,t,i){var n=this.options.urlTemplate,r="";if(this.options.subdomains){var s=this.options.subdomains;if(EM(s)){var o=(e+t)%s.length;o<0&&(o=0),r=s[o]}}if(gP(n))return n(e,t,i,r);var a={x:e,y:t,z:i,s:r};return this.options.token&&(a.token=this.options.token),this.options.customTags&&hP(a,this.options.customTags),n.replace(Gz,(function(e,t){var i=a[t];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"==typeof i&&(i=i(a)),i}))},i.clear=function(){return this._renderer&&this._renderer.clear(),this.tileInfoCache&&this.tileInfoCache.reset(),this.fire("clear"),this},i.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),options:this.config()}},i.getSpatialReference=function(){var e=this.getMap();if(e&&(!this.options.spatialReference||BO.equals(this.options.spatialReference,e.options.spatialReference)))return e.getSpatialReference();if(this._sr)return this._sr;var t=this.options.spatialReference;if(fP(t)&&!(t=BO.getPreset(t)))throw new Error("Unsupported spatial reference: "+this.options.spatialReference+", possible values: "+BO.getAllPresets().join());return this._sr=new BO(t),this._srMinZoom=this._sr.getMinZoom(),this._srMaxZoom=this._sr.getMaxZoom(),this._hasOwnSR=this._sr.toJSON().projection!==e.getSpatialReference().toJSON().projection,this._sr},i.getMinZoom=function(){var e=this.options.minZoom||0;return this.getSpatialReference()!==this.getMap().getSpatialReference()?Math.max(e,this._srMinZoom):e},i.getMaxZoom=function(){return this.getSpatialReference()!==this.getMap().getSpatialReference()?Math.min(e.prototype.getMaxZoom.call(this),this._srMaxZoom):e.prototype.getMaxZoom.call(this)},i._getTileZoom=function(e){if(!this._hasOwnSR){var t=this.getMap().getResolution(e),i=this.getSpatialReference().getResolution(e);e+=Math.log(i/t)*Math.LOG2E}var n=this.getMaxAvailableZoom();return!uP(n)&&e>n&&(e=n),pP(e)||(e=Math.round(e)),Math.max(0,e)},i.getMaxAvailableZoom=function(){var e=this.getSpatialReference();return this.options.maxAvailableZoom||e&&e.getMaxZoom()},i._getTiles=function(e,t,i,n,r){var s=this.getMap(),o=e,a=s.projViewMatrix,l=s.getResolution(e)/s.getResolution(e-1)==.5;i<2&&(0===i&&l&&(o-=1),a=0===i?s.cascadeFrustumMatrix0:1===i?s.cascadeFrustumMatrix1:s.projViewMatrix);var c=o+this.options.zoomOffset,h=this._getTileOffset(o),u=h[0]||h[1],d={zoom:o,extent:null,offset:h,tiles:[]};if(c<0)return d;if(!(s&&this.isVisible()&&s.width&&s.height))return d;if(!r){var p=this.getMinZoom(),m=this.getMaxZoom();if(!uP(p)&&o<p||!uP(m)&&o>m)return d}var f=this._getTileConfig();if(!f)return d;var g,_={zoom:h},y=this.getSpatialReference().getResolution(o);g=this._hasOwnSR?s.getGLScale(o):y/s.getGLRes();var v=!this._hasOwnSR&&this.options.repeatWorld,x=this._convertToExtent2d(t),b=this._getMask2DExtent();if(b){var w=b.intersection(x);if(!w)return d;t=w.convertTo((function(e){return s._pointToContainerPoint(e,void 0,0,Vz)}))}var C,S=s._containerPointToPrj(t.getCenter(),Wz),E=s._prjToPoint(S,o,Zz);C=this._project(u?s._pointToPrj(E._add(h),o,Zz):S,Zz);var T=s.getGLScale()/s.getGLScale(o);$z.x=x.xmin*T,$z.y=x.ymax*T,Xz.x=x.xmax*T,Xz.y=x.ymin*T;for(var P=this._project(s._pointToPrj($z._add(h),o,$z),$z),M=this._project(s._pointToPrj(Xz._add(h),o,Xz),Xz),k=f.getTileIndex(C,y,v),A=f.getTileIndex(P,y,v),I=f.getTileIndex(M,y,v),R=Math.ceil(Math.abs(k.idy-A.idy)),O=Math.ceil(Math.abs(k.idx-A.idx)),N=Math.ceil(Math.abs(k.idy-I.idy)),D=Math.ceil(Math.abs(k.idx-I.idx)),z=(R+N+1)*(O+D+1),L=this.getTileSize(),B=this.getRenderer()||n,F=this._getTileConfig().tileSystem.scale,j=[],V=new DI,U=new uM(0,0),q=-R;q<=N;q++)for(var H=-O,G=-1/0,W=!1;H>=G&&H<=D;){var Z=f.getNeighorTileIndex(k.idx,k.idy,H,q,y,v);G===-1/0?H++:H--;var $=this._getTileId(Z.idx,Z.idy,o);if(!(Z.out||this._visitedTiles&&this._visitedTiles.has($))){var X=B&&B.isTileCachedOrLoading($);X&&(X=X.info);var K=void 0;if(X){var Y=X.extent2d;U.set(Y.xmin,Y.ymax),K=U}else if(this._hasOwnSR){var J=f.getTilePrjNW(Z.x,Z.y,y);K=s._prjToPoint(this._unproject(J,Xz),o)}else K=f.getTilePointNW(Z.x,Z.y,y);var Q=void 0,ee=void 0;if(this._hasOwnSR){var te=void 0;if(this._hasOwnSR){var ie=f.getTilePrjSE(Z.x,Z.y,y);te=s._prjToPoint(this._unproject(ie,Xz),o,Xz)}else te=f.getTilePointSE(Z.x,Z.y,y);Q=Math.ceil(Math.abs(te.x-K.x)),ee=Math.ceil(Math.abs(te.y-K.y))}else Q=L.width,ee=L.height;var ne=F.x*(Z.idx-Z.x)*Q,re=F.y*(Z.idy-Z.y)*ee;X||!ne&&!re||K._add(ne,re);var se=X&&X.extent2d||new DI(K.x,K.y-ee,K.x+Q,K.y);if(z<=4||W||this._isTileInExtent(a,se,h,g)){var oe=this._hasOwnSR?s._getResolution(o):y;this._visitedTiles&&0===i&&this._visitedTiles.add($),l&&0===i?(this._splitTiles(a,j,B,Z,o+1,oe,se,ne,re,_),V._combine(se)):(X?(X.offset[0]=h[0],X.offset[1]=h[1]):X=this.createTileNode(Z.x,Z.y,o,Z.idx,Z.idy,oe,0,null,se,$),j.push(X),V._combine(se)),G===-1/0?(G=H,H=D):W||(W=!0)}}}if(j.length){var ae=s._containerPointToPoint(t.getCenter(),o,Vz)._add(h),le=new uM(0,0),ce=new uM(0,0);j.sort((function(e,t){return le.set((e.extent2d.xmin+e.extent2d.xmax)/2,(e.extent2d.ymin+e.extent2d.ymax)/2),ce.set((t.extent2d.xmin+t.extent2d.xmax)/2,(t.extent2d.ymin+t.extent2d.ymax)/2),le.distanceTo(ae)-ce.distanceTo(ae)}))}return{offset:h,zoom:e,extent:V,tiles:j}},i._convertToExtent2d=function(e){var t=this,i=this.getMap();return e.convertTo((function(e){if(e.y>0&&e.y<i.height){var n=(0===e.x?0:1)+e.y;t._coordCache[n]||(t._coordCache[n]=i._containerPointToPoint(e))}return i._containerPointToPoint(e,void 0,Vz)}))},i._splitTiles=function(e,t,i,n,r,s,o,a,l,c){var h=this._getTileConfig().tileSystem.scale.y,u=this.getMap().getGLScale(r),d=Kz.set(2*o.xmin,h<0?2*o.ymax:2*o.ymin),p=o.getWidth(),m=o.getHeight(),f=2*n.idx,g=2*n.idy,_=2*n.x,y=2*n.y,v=this._checkAndAddTile(e,i,f,g,_,y,r,s,0,0,p,m,d,u,c);v&&t.push(v),(v=this._checkAndAddTile(e,i,f,g,_,y,r,s,0,1,p,m,d,u,c))&&t.push(v),(v=this._checkAndAddTile(e,i,f,g,_,y,r,s,1,0,p,m,d,u,c))&&t.push(v),(v=this._checkAndAddTile(e,i,f,g,_,y,r,s,1,1,p,m,d,u,c))&&t.push(v)},i._checkAndAddTile=function(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m){var f=this._getTileId(i+l,n+c,o);if(this._visitedTiles&&this._visitedTiles.has(f))return null;var g=m[o];g||(g=m[o]=this._getTileOffset(o));var _=this._getTileConfig().tileSystem.scale.y,y=new DI(d.x+l*h,d.y+_*c*u,d.x+(l+1)*h,d.y+_*(c+1)*u);if(!this._isSplittedTileInExtent(e,y,g,p))return null;var v=a/2,x=t&&t.isTileCachedOrLoading(f);return x?x.info:this.createTileNode(r+l,s+c,o,i+l,i+s,v,0,null,y,f)},i._getTileOffset=function(){var e=this.options.offset;if(gP(e)){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];e=(t=e).call.apply(t,[this].concat(n))}return dP(e)&&(e=[e,e]),e||[0,0]},i.getTileId=function(e,t,i,n){return this._getTileId(e,t,i,n)},i._getTileId=function(e,t,i,n){return(n||this.getId())+"_"+e+"_"+t+"_"+i},i._project=function(e,t){if(this._hasOwnSR){var i=this.getMap().getProjection();return this.getSpatialReference().getProjection().project(i.unproject(e,t),t)}return e},i._unproject=function(e,t){if(this._hasOwnSR){var i=this.getMap(),n=this.getSpatialReference(),r=i.getProjection(),s=n.getProjection();return r.project(s.unproject(e,t),t)}return e},i._initTileConfig=function(){var e=this.getMap(),t=this.getTileSize(),i=this.getSpatialReference(),n=i.getProjection(),r=i.getFullExtent();this._defaultTileConfig=new jz(e,Bz.getDefault(n),r,t),this.options.hasOwnProperty("tileSystem")&&(this._tileConfig=new jz(e,this.options.tileSystem,r,t)),delete this._rootNodes,delete this._tileFullExtent,delete this._disablePyramid},i._getTileConfig=function(){return this._defaultTileConfig||this._initTileConfig(),this._tileConfig||this._defaultTileConfig},i._bindMap=function(t){var i=t.getBaseLayer();return i===this&&(i.options.hasOwnProperty("forceRenderOnMoving")||this.config({forceRenderOnMoving:!0})),this._onSpatialReferenceChange(),e.prototype._bindMap.apply(this,arguments)},i._isTileInExtent=function(e,t,i,n){var r,s=this.getMap();if(e!==s.projViewMatrix){var o=t.getCenter(Yz)._sub(i[0],i[1])._multi(n);MD(tL,o.x,o.y,0),r=function(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[3]*n+i[7]*r+i[11]*s+i[15];return e[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/(o=o||1),e[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/o,e}(tL,tL,s.projViewMatrix)[1]<0?s.projViewMatrix:e}else r=s.projViewMatrix;return Jz[0][0]=(t.xmin-i[0])*n,Jz[0][1]=(t.ymin-i[1])*n,Jz[1][0]=(t.xmax-i[0])*n,Jz[1][1]=(t.ymax-i[1])*n,QT(r,Jz)},i._isSplittedTileInExtent=function(e,t,i,n){var r=this.getMap();return Jz[0][0]=(t.xmin-i[0])*n,Jz[0][1]=(t.ymin-i[1])*n,Jz[1][0]=(t.xmax-i[0])*n,Jz[1][1]=(t.ymax-i[1])*n,QT(r.projViewMatrix,Jz)},i.getEvents=function(){return{spatialreferencechange:this._onSpatialReferenceChange}},i._onSpatialReferenceChange=function(){delete this._tileConfig,delete this._defaultTileConfig,delete this._sr,delete this._srMinZoom,delete this._hasOwnSR,delete this._rootNodes,this.tileInfoCache&&this.tileInfoCache.reset();var e=this.getRenderer();e&&e.clear()},i.getPolygonOffsetCount=function(){return 2},i.getPolygonOffset=function(){return this._polygonOffset||0},i.setPolygonOffset=function(e){return this._polygonOffset=e,this},t}(ZO);function nL(e,t){return e.z-t.z}iL.registerJSONType("TileLayer"),iL.mergeOptions(Hz);var rL=new wk(256,256),sL="show hide remove setzindex forcereloadstart";function oL(e){return Array.isArray(e)||(e=[e]),e}var aL=function(e){function t(t,i,n){var r;return(r=e.call(this,t,n)||this).layers=i||[],r._checkChildren(),r.layerMap={},r._groupChildren=[],r}tM(t,e),t.fromJSON=function(e){if(!e||"GroupTileLayer"!==e.type)return null;var i=e.layers.map((function(e){return ZO.fromJSON(e)}));return new t(e.id,i,e.options)};var i=t.prototype;return i.getLayers=function(){return this.layers},i.addLayer=function(e){var t=this;void 0===e&&(e=[]),e=oL(e);var i=this.layers.length;return e.forEach((function(e){e instanceof iL&&(-1!==t.layers.indexOf(e)||t.layerMap[e.getId()]||t.layers.push(e))})),i!==this.layers.length&&(this._sortLayers(),this._refresh(),this._renderLayers()),this},i.removeLayer=function(e){var t=this;void 0===e&&(e=[]),e=oL(e);var i=this.layers.length;return e.forEach((function(e){if(e instanceof iL||(e=t.layerMap[e]),e instanceof iL){var i=t.layers.indexOf(e);i>=0&&(t.layers.splice(i,1),e._doRemove(),e.off(sL,t._onLayerShowHide,t))}})),i!==this.layers.length&&(this._refresh(),this._renderLayers()),this},i.clearLayers=function(){var e=this;return this.layers.forEach((function(t){t._doRemove(),t.off(sL,e._onLayerShowHide,e)})),this.layers=[],this._refresh(),this._renderLayers(),this},i.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),layers:this.layers.map((function(e){return e.toJSON()})),options:this.config()}},i.getTileSize=function(e){var t=this.getLayer(e);return t?t.getTileSize():rL},i.getTiles=function(e,t){for(var i=this.layers,n=[],r=0,s=0,o=i.length;s<o;s++){var a=i[s];if(a&&a.options.visible&&a.isVisible()&&a.getMap()){var l=a.getTiles(e,t||this);l&&0!==l.count&&(r+=l.count,_M(n,l.tileGrids))}}return{count:r,tileGrids:n}},i.onAdd=function(){this._sortLayers(),this._refresh(),e.prototype.onAdd.call(this)},i.onRemove=function(){var t=this;this.layers.forEach((function(e){e._doRemove(),e.off(sL,t._onLayerShowHide,t)})),this.layerMap={},this._groupChildren=[],e.prototype.onRemove.call(this)},i.getLayer=function(e){return this.getChildLayer(e)},i.getChildLayer=function(e){var t=this.layerMap[e];if(t)return t;for(var i=0;i<this._groupChildren.length;i++){var n=this._groupChildren[i].getChildLayer(e);if(n)return n}return null},i._removeChildTileCache=function(e){if(!e)return this;var t,i=this.getRenderer();if(!i)return this;var n=e.getId(),r=function(){return t&&t.info&&t.info.layer===n};i.tileCache&&i.tileCache.keys().forEach((function(e){t=i.tileCache.get(e),r()&&i.tileCache.remove(e)}));var s=i.tilesInView||{};for(var o in s)t=s[o],r()&&delete s[o];var a=i.tilesLoading||{};for(var l in a)t=a[l],r()&&i.abortTileLoading(t.image,t.info);return this},i._onLayerShowHide=function(e){var t=e||{},i=t.type,n=t.target;return"remove"===i&&n?(this.layers.splice(this.layers.indexOf(n),1),n._doRemove(),n.off(sL,this._onLayerShowHide,this),this._refresh()):"setzindex"===i?this._sortLayers():"forcereloadstart"===i&&this._removeChildTileCache(n),this._renderLayers(),this},i._renderLayers=function(){var e=this.getRenderer();return e&&e.setToRedraw(),this},i._refresh=function(){var e=this,t=this.getMap();return this._groupChildren=[],this.layerMap={},this.layers.forEach((function(i){e.layerMap[i.getId()]=i,i.getChildLayer&&e._groupChildren.push(i),i.getMap()||i._bindMap(t),i.off(sL,e._onLayerShowHide,e),i.on(sL,e._onLayerShowHide,e)})),this},i.isVisible=function(){if(!e.prototype.isVisible.call(this))return!1;for(var t=this.layers,i=0,n=t.length;i<n;i++)if(t[i].isVisible())return!0;return!1},i._checkChildren=function(){var e=this,t={};this.layers.forEach((function(i){var n=i.getId();if(t[n])throw new Error("Duplicate child layer id ("+n+") in the GroupTileLayer ("+e.getId()+")");t[n]=1}))},i._sortLayers=function(){this.layers.sort((function(e,t){return e.options.zIndex-t.options.zIndex}))},t}(iL);aL.registerJSONType("GroupTileLayer"),aL.mergeOptions({maxCacheSize:1024});var lL,cL={crs:null,uppercase:!1,detectRetina:!1},hL={service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},uL=function(e){function t(t,i){var n;return n=e.call(this,t)||this,lL||(lL=hP({},n.options)),n.wmsParams=hP({},hL),n.setOptions(i),n.setZIndex(i.zIndex),QP.proxy||n._optionsHook(i),n}tM(t,e);var i=t.prototype;return i._optionsHook=function(e){for(var t in void 0===e&&(e={}),e)"tileSize"===t&&(this._tileSize=null),t in lL||(this.wmsParams[t]=e[t]);var i=this.getTileSize();return this.wmsParams.width=i.width,this.wmsParams.height=i.height,this._wmsVersion=parseFloat(this.wmsParams.version),this},i.onAdd=function(){var t=this.getMap().getDevicePixelRatio(),i=cL.detectRetina?t:1;this.wmsParams.width*=i,this.wmsParams.height*=i;var n=this.options.crs||this.getMap().getProjection().code;this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=n,e.prototype.onAdd.call(this)},i.getTileUrl=function(t,i,n){var r=this.getSpatialReference().getResolution(n),s=this._getTileConfig().getTilePrjExtent(t,i,r),o=s.getMax(),a=s.getMin(),l=(this._wmsVersion>=1.3&&("EPSG:4326"===this.wmsParams.crs||"EPSG:4490"===this.wmsParams.crs)?[a.y,a.x,o.y,o.x]:[a.x,a.y,o.x,o.y]).join(","),c=e.prototype.getTileUrl.call(this,t,i,n);return c+function(e,t,i){var n=[];for(var r in e)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(e[r]));return(t&&-1!==t.indexOf("?")?"&":"?")+n.join("&")}(this.wmsParams,c,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+l},i.toJSON=function(){return{type:"WMSTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return e&&"WMSTileLayer"===e.type?new t(e.id,e.options):null},t}(iL);uL.registerJSONType("WMSTileLayer"),uL.mergeOptions(cL);var dL=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).options.hasOwnProperty("forceRenderOnMoving")||(n.options.forceRenderOnMoving=!1),n}tM(t,e);var i=t.prototype;return i.drawTile=function(){},i.toJSON=function(){return{type:"CanvasTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return e&&"CanvasTileLayer"===e.type?new t(e.id,e.options):null},t}(iL);function pL(e,t,i){var n=e.createShader(t);if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("Failed to compile shader: "+r)}return n}function mL(e,t,i){var n=pL(e,e.VERTEX_SHADER,t),r=pL(e,e.FRAGMENT_SHADER,i);if(!n||!r)return null;var s=e.createProgram();return s?(e.attachShader(s,n),e.attachShader(s,r),e.linkProgram(s),{program:s,vertexShader:n,fragmentShader:r}):null}function fL(e,t,i){if(Array.isArray(i[0])){for(var n=Float32Array.BYTES_PER_ELEMENT,r=0,s=0;s<i.length;s++)r+=i[s][1]||0;for(var o=0,a=0;a<i.length;a++){var l=e.getAttribLocation(t,i[a][0]);if(l<0)throw new Error("Failed to get the storage location of "+i[a][0]);e.vertexAttribPointer(l,i[a][1],e[i[a][2]||"FLOAT"],!1,n*r,n*o),o+=i[a][1]||0,e.enableVertexAttribArray(l)}}else{var c=e.getAttribLocation(t,i[0]);e.vertexAttribPointer(c,i[1],e[i[2]||"FLOAT"],!1,0,0),e.enableVertexAttribArray(c)}}dL.registerJSONType("CanvasTileLayer");var gL={never:512,"<":513,"=":514,"<=":515,">":516,"!=":517,">=":518,always:519},_L=[1,1,1,1],yL=[0,0],vL=[0,0,0],xL=new Array(16),bL=new uM(20,20),wL=function(e){var t,i=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.drawGLImage=function(e,t,i,n,r,s,o,a,l){this.gl.program!==this.program&&this.useProgram(this.program);var c=this.gl;if(this.loadTexture(e),this.canvas.gl&&this.canvas.gl.wrap){var h=this.layer&&this.layer.options.opacity;uP(h)&&(h=1),o*=h}vL[0]=t||0,vL[1]=i||0,vL[2]=0;var u=this.layer;if(u){var d=u.options.altitude,p=dP(d);if(p||(this._layerAlt=0),this._layerAltitude!==d&&p){var m=u.getMap();if(m){var f=m.altitudeToPoint(d,m.getGLRes());this._layerAltitude=d,this._layerAlt=f}}}vL[2]=this._layerAlt||0;var g=TD(xL);wD(g,g,vL),CD(g,g,[s,s,1]),SD(g,this.getMap().projViewMatrix,g),c.uniformMatrix4fv(this.program.u_matrix,!1,g),c.uniform1f(this.program.u_opacity,o),c.uniform1f(this.program.u_debug_line,0),c.uniform4fv(this.program.u_base_color,l||_L),c.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0);var _=e.glBuffer;!_||_.width===n&&_.height===r||(this.saveImageBuffer(_),delete e.glBuffer),e.glBuffer?c.bindBuffer(c.ARRAY_BUFFER,_):e.glBuffer=this.bufferTileData(0,0,n,r),yL[0]="a_position",yL[1]=2,yL[2]=e.glBuffer.type,this.enableVertexAttrib(yL),c.bindBuffer(c.ARRAY_BUFFER,this.texBuffer),yL[0]="a_texCoord",yL[1]=2,yL[2]="UNSIGNED_BYTE",this.enableVertexAttrib(yL),c.drawArrays(c.TRIANGLE_STRIP,0,4),a&&this.drawDebug(g,0,0,n,r,a)},i.drawDebug=function(e,t,i,n,r,s){var o=this.gl;o.disable(o.DEPTH_TEST),o.bindBuffer(o.ARRAY_BUFFER,this._debugBuffer),this.enableVertexAttrib(["a_position",2,"FLOAT"]),o.bufferData(o.ARRAY_BUFFER,new Float32Array([t,i,t+n,i,t+n,i-r,t,i-r,t,i]),o.DYNAMIC_DRAW),o.uniformMatrix4fv(this.program.u_matrix,!1,e),o.uniform1f(this.program.u_opacity,1),o.uniform1f(this.program.u_debug_line,1),o.uniform4fv(this.program.u_base_color,_L),o.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0),o.drawArrays(o.LINE_STRIP,0,5);var a=this._debugInfoCanvas;if(!a){var l=this.getMap().getDevicePixelRatio()>1?2:1;(a=this._debugInfoCanvas=document.createElement("canvas")).width=256*l,a.height=32*l;var c=a.getContext("2d");c.font="20px monospace",c.scale(l,l)}var h=a.getContext("2d");h.clearRect(0,0,a.width,a.height),YA.fillText(h,s,bL,this.layer.options.debugOutline),this.loadTexture(a),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,a);var u=t+(n=256),d=i-r+32,p=i-r;o.bufferData(o.ARRAY_BUFFER,this.set8(t,d,t,p,u,d,u,p),o.DYNAMIC_DRAW),o.uniform1f(this.program.u_debug_line,0),o.bindBuffer(o.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2,"UNSIGNED_BYTE"]),o.drawArrays(o.TRIANGLE_STRIP,0,4),o.enable(o.DEPTH_TEST)},i.bufferTileData=function(e,t,i,n,r){var s,o=e,a=e+i,l=t,c=t-n;s=pP(o)&&pP(a)&&pP(l)&&pP(c)?this.set8Int(o,l,o,c,a,l,a,c):this.set8(o,l,o,c,a,l,a,c);var h=this.loadImageBuffer(s,r);return h.width=i,h.height=n,h.type=s instanceof Int16Array?"SHORT":"FLOAT",h},i.drawTinImage=function(e,t,i,n,r){var s=this.gl;this.loadTexture(e),s.uniformMatrix4fv(this.program.u_matrix,!1,this.getMap().projViewMatrix),s.uniform1f(this.program.u_opacity,r),s.bindBuffer(s.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),s.bufferData(s.ARRAY_BUFFER,new Float32Array(t),s.DYNAMIC_DRAW),s.bindBuffer(s.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),s.bufferData(s.ARRAY_BUFFER,new Float32Array(i),s.DYNAMIC_DRAW),s.bufferData(s.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),s.DYNAMIC_DRAW),s.drawElements(s.TRIANGLES,n.length,s.UNSIGNED_SHORT,0)},i.createCanvas2=function(){this.canvas2=YA.createCanvas(this.canvas.width,this.canvas.height)},i.createGLContext=function(){this.gl=this.canvas.gl&&this.canvas.gl.wrap?this.canvas.gl.wrap():function(e,t){for(var i={alpha:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!1},n=["webgl","experimental-webgl"],r=null,s=0;s<n.length;++s){try{r=e.getContext(n[s],t||i)}catch(P0){}if(r)break}return r}(this.canvas2||this.canvas,this.layer.options.glOptions);var e=this.gl;e.clearColor(0,0,0,0),e.enable(e.DEPTH_TEST),e.enable(e.STENCIL_TEST),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.program=this.createProgram("\n        attribute vec2 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\n\n            v_texCoord = a_texCoord;\n        }\n    ",this.layer.options.fragmentShader||"\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n        uniform float u_debug_line;\n        uniform vec4 u_base_color;\n        uniform float u_alpha_test;\n        varying vec2 v_texCoord;\n\n        void main() {\n            if (u_debug_line == 1.) {\n                gl_FragColor = vec4(0., 1., 0., 1.);\n            } else {\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n            }\n            gl_FragColor *= u_base_color;\n            if (gl_FragColor.a < u_alpha_test) {\n                discard;\n            }\n        }\n    "),this._debugBuffer=this.createBuffer(),this.useProgram(this.program),this.texBuffer=this.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2,"UNSIGNED_BYTE"]),e.bufferData(e.ARRAY_BUFFER,new Uint8Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW),this.enableSampler("u_image"),e.activeTexture(e.TEXTURE0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)},i.resizeGLCanvas=function(){this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2&&(this.canvas2.width===this.canvas.width&&this.canvas2.height===this.canvas.height||(this.canvas2.width=this.canvas.width,this.canvas2.height=this.canvas.height))},i.clearGLCanvas=function(){this.gl&&(this.gl.clearStencil(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)),this.gl.wrap||this.gl.clear(this.gl.DEPTH_BUFFER_BIT)},i.disposeImage=function(e){e&&(e.texture&&this.saveTexture(e.texture),e.glBuffer&&this.saveImageBuffer(e.glBuffer),delete e.texture,delete e.glBuffer)},i._createTexture=function(e){var t=this.gl,i=this.getTexture()||t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);var n=this.layer.options.mipmapTexture;return!n||CL(e.width)&&CL(e.height)||(e=function(e){if(CL(e.width)&&CL(e.height))return e;var t=e.width,i=e.height;CL(t)||(t=SL(t)),CL(i)||(i=SL(i));var n=document.createElement("canvas");n.width=t,n.height=i;var r=n.getContext("2d");return r.imageSmoothingEnabled=!1,r.drawImage(e,0,0,t,i),n}(e)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),n&&t.generateMipmap(t.TEXTURE_2D),i},i.getTexture=function(){this._textures||(this._textures=[]);var e=this._textures;return e&&e.length>0?e.pop():null},i.saveTexture=function(e){this._textures.push(e)},i.loadTexture=function(e){var t=this.getMap(),i=this.gl,n=e.texture;return n||(n=this._createTexture(e),e.texture=n),i.bindTexture(i.TEXTURE_2D,n),this.layer.options.mipmapTexture&&(t.isMoving()&&t.getRenderer().isViewChanged()?i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR):i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)),n},i.getImageBuffer=function(){this._imageBuffers||(this._imageBuffers=[]);var e=this._imageBuffers;return e&&e.length>0?e.pop():null},i.saveImageBuffer=function(e){this._imageBuffers||(this._imageBuffers=[]),this._imageBuffers.push(e)},i.loadImageBuffer=function(e,t){var i=this.gl,n=t||this.createImageBuffer();return i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,e,i.STATIC_DRAW),n},i.createImageBuffer=function(){return this.getImageBuffer()||this.createBuffer()},i.removeGLCanvas=function(){var e=this.gl;if(e){if(this._debugBuffer&&(e.deleteBuffer(this._debugBuffer),delete this._debugBuffer),this._buffers&&(this._buffers.forEach((function(t){e.deleteBuffer(t)})),delete this._buffers),this._textures&&(this._textures.forEach((function(t){return e.deleteTexture(t)})),delete this._textures),this._debugInfoCanvas){var t=this._debugInfoCanvas.texture;t&&e.deleteTexture(t),delete this._debugInfoCanvas.texture,delete this._debugInfoCanvas}var i=e.program;e.deleteShader(i.fragmentShader),e.deleteShader(i.vertexShader),e.deleteProgram(i),delete this.gl,delete this.canvas2}},i.createBuffer=function(){var e=this.gl.createBuffer();if(!e)throw new Error("Failed to create the buffer object");return this._buffers||(this._buffers=[]),this._buffers.push(e),e},i.enableVertexAttrib=function(e){fL(this.gl,this.gl.program,e)},i.createProgram=function(e,t){for(var i=this.gl,n=mL(i,e,t),r=n.program,s=n.vertexShader,o=n.fragmentShader,a=i.getProgramParameter(r,35718),l=[],c=0;c<a;++c){var h=i.getActiveUniform(r,c);l.push(h.name)}return r.vertexShader=s,r.fragmentShader=o,this._initUniforms(r,l),r},i.useProgram=function(e){var t=this.gl;return t.useProgram(e),t.program=e,this},i.enableSampler=function(e,t){var i=this.gl,n=this._getUniform(i.program,e);return t||(t=0),i.uniform1i(n,t),n},i._initUniforms=function(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=t[i],s=n.indexOf("[");s>=0&&(n=n.substring(0,s),wP||(r=r.substring(0,s))),e[n]=this._getUniform(e,r)}},i._getUniform=function(e,t){var i=this.gl.getUniformLocation(e,t);if(!i)throw new Error("Failed to get the storage location of "+t);return i},t}(e);return hP(i.prototype,{set8:(t=QP.ie9?null:new Float32Array(8),function(e,i,n,r,s,o,a,l){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t}),set8Int:function(){var e=QP.ie9?null:new Int16Array(8);return function(t,i,n,r,s,o,a,l){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=s,e[5]=o,e[6]=a,e[7]=l,e}}()}),i};function CL(e){return 0==(e&e-1)&&0!==e}function SL(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}var EL={renderer:QP.webgl?"gl":"canvas",crossOrigin:null,alphaTest:0,depthMask:!0,depthFunc:"<="},TL=new uM(0,0),PL=function(e){function t(t,i,n){var r;return!i||Array.isArray(i)||i.url||(n=i,i=null),(r=e.call(this,t,n)||this)._images=i,r}tM(t,e);var i=t.prototype;return i.onAdd=function(){this._prepareImages(this._images)},i.setImages=function(e){return this._images=e,this._prepareImages(e),this},i.getImages=function(){return this._images},i._prepareImages=function(e){e=e||[],Array.isArray(e)||(e=[e]);var t=this.getMap(),i=t.getGLRes();this._imageData=e.map((function(e){var n=new OI(e.extent);return hP({},e,{extent:n,extent2d:n.convertTo((function(e){return t.coordToPointAtRes(e,i)}))})})),this._images=e;var n=this.getRenderer();n&&n.refreshImages()},t}(ZO);PL.mergeOptions(EL);var ML=[],kL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("ImageLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),!1)},i.checkResources=function(){var e=this;if(this._imageLoaded)return ML;var t=this.layer._imageData.map((function(e){return[e.url,null,null]}));if(this.resources){var i=[],n=new wR;t.forEach((function(t){if(e.resources.isResourceLoaded(t)){var r=e.resources.getImage(t);n.addResource(t,r)}else i.push(t)})),this.resources.forEach((function(t,i){n.isResourceLoaded(t)||e.retireImage(i.image)})),this.resources=n,t=i}return this._imageLoaded=!0,t},i.retireImage=function(e){e.close&&e.close()},i.refreshImages=function(){this._imageLoaded=!1,this.setToRedraw()},i.draw=function(e,t){this.isDrawable()&&(this.prepareCanvas(),this._painted=!1,this._drawImages(e,t),this.completeRender())},i._drawImages=function(){var e=this.layer._imageData,t=this.getMap(),i=t._get2DExtentAtRes(t.getGLRes());if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n].extent2d,s=this.resources&&this.resources.getImage(e[n].url);s&&i.intersects(r)&&(this._painted=!0,this._drawImage(s,r,e[n].opacity||1))}},i._drawImage=function(e,t,i){var n=0,r=this.context;i<1&&(n=r.globalAlpha,r.globalAlpha=i);var s=this.getMap(),o=TL.set(t.xmin,t.ymax),a=s._pointAtResToContainerPoint(o,s.getGLRes()),l=a.x,c=a.y,h=s.getBearing();h&&(r.save(),r.translate(l,c),h&&r.rotate(-h*Math.PI/180),l=c=0);var u=s.getGLScale();r.drawImage(e,l,c,t.getWidth()/u,t.getHeight()/u),h&&r.restore(),n&&(r.globalAlpha=n)},i.drawOnInteracting=function(){this.draw()},t}(bR),AL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.drawOnInteracting=function(e,t,i){this.draw(t,i)},i._prepareGLContext=function(){var e=this.gl;e&&(e.disable(e.STENCIL_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.depthFunc(gL[this.layer.options.depthFunc]),e.depthMask(!!this.layer.options.depthMask))},i._drawImages=function(t,i){var n=this.gl;if(i&&i.renderTarget){var r=i.renderTarget.fbo;if(r){var s=i.renderTarget.getFramebuffer(r);n.bindFramebuffer(n.FRAMEBUFFER,s)}}this._prepareGLContext(),e.prototype._drawImages.call(this),i&&i.renderTarget&&i.renderTarget.fbo&&n.bindFramebuffer(n.FRAMEBUFFER,null)},i.isDrawable=function(){return!0},i._drawImage=function(e,t,i){this.drawGLImage(e,t.xmin,t.ymax,t.getWidth(),t.getHeight(),1,i)},i.createContext=function(){this.createGLContext()},i.resizeCanvas=function(t){this.canvas&&(e.prototype.resizeCanvas.call(this,t),this.resizeGLCanvas())},i.clearCanvas=function(){this.canvas&&(e.prototype.clearCanvas.call(this),this.clearGLCanvas())},i.retireImage=function(e){e.close&&e.close(),this.disposeImage(e)},i.onRemove=function(){this.removeGLCanvas(),e.prototype.onRemove.call(this)},t}(wL(kL));PL.registerRenderer("canvas",kL),PL.registerRenderer("gl",AL);var IL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.getPrepareParams=function(){return[]},i.getDrawParams=function(){return[]},i.onCanvasCreate=function(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=YA.createCanvas(this.canvas.width,this.canvas.height,this.getMap().CanvasClass))},i.needToRedraw=function(){return!!this.layer.options.animation||!(this.getMap().isInteracting()&&!this.layer.drawOnInteracting)&&e.prototype.needToRedraw.call(this)},i.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer.apply(this,arguments)},i.drawOnInteracting=function(){this._drawLayerOnInteracting.apply(this,arguments)},i.getCanvasImage=function(){var t=e.prototype.getCanvasImage.call(this);if(t&&t.image&&this.layer.options.doubleBuffer){var i=t.image;this.buffer.width===i.width&&this.buffer.height===i.height||(this.buffer.width=i.width,this.buffer.height=i.height);var n=this.buffer.getContext("2d"),r=this.layer.doubleBuffer(n,this.context);(void 0===r||r)&&(YA.image(n,i,0,0),t.image=this.buffer)}return t},i.remove=function(){return delete this._drawContext,e.prototype.remove.call(this)},i.onZoomStart=function(t){this.layer.onZoomStart(t),e.prototype.onZoomStart.call(this,t)},i.onZooming=function(t){this.layer.onZooming(t),e.prototype.onZooming.call(this,t)},i.onZoomEnd=function(t){this.layer.onZoomEnd(t),e.prototype.onZoomEnd.call(this,t)},i.onMoveStart=function(t){this.layer.onMoveStart(t),e.prototype.onMoveStart.call(this,t)},i.onMoving=function(t){this.layer.onMoving(t),e.prototype.onMoving.call(this,t)},i.onMoveEnd=function(t){this.layer.onMoveEnd(t),e.prototype.onMoveEnd.call(this,t)},i.onResize=function(t){this.layer.onResize(t),e.prototype.onResize.call(this,t)},i.prepareDrawContext=function(){if(!this._predrawed){var e=RL(this.getPrepareParams());this._drawContext=this.layer.prepareToDraw.apply(this.layer,[this.context].concat(e)),this._drawContext||(this._drawContext=[]),Array.isArray(this._drawContext)||(this._drawContext=[this._drawContext]),this._predrawed=!0}},i._prepareDrawParams=function(){if(!this.getMap())return null;var e=this.getViewExtent();if(e.maskExtent&&!e.extent.intersects(e.maskExtent))return this.completeRender(),null;var t=[this.context,e],i=RL(this.getDrawParams());return t.push.apply(t,i),t.push.apply(t,this._drawContext),t},i._drawLayer=function(){var e=this._prepareDrawParams();if(e){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];this.layer.draw.apply(this.layer,e.concat(i)),this.completeRender()}},i._drawLayerOnInteracting=function(){if(this.layer.drawOnInteracting){var e=this._prepareDrawParams();if(e){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];this.layer.drawOnInteracting.apply(this.layer,e.concat(i)),this.completeRender()}}},t}(bR);function RL(e){return e||(e=[]),Array.isArray(e)||(e=[e]),e}var OL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.isCanvasRender=function(){return!0},i.prepareToDraw=function(){},i.draw=function(){},i.redraw=function(){return this._getRenderer()&&this._getRenderer().setToRedraw(),this},i.play=function(){return this.config("animation",!0),this},i.pause=function(){return this.config("animation",!1),this},i.isPlaying=function(){return this.options.animation},i.clearCanvas=function(){return this._getRenderer()&&this._getRenderer().clearCanvas(),this},i.requestMapToRender=function(){return this._getRenderer()&&this._getRenderer().requestMapToRender(),this},i.completeRender=function(){return this._getRenderer()&&this._getRenderer().completeRender(),this},i.onCanvasCreate=function(){return this},i.onZoomStart=function(){},i.onZooming=function(){},i.onZoomEnd=function(){},i.onMoveStart=function(){},i.onMoving=function(){},i.onMoveEnd=function(){},i.onResize=function(){},i.doubleBuffer=function(e){return e.clearRect(0,0,e.canvas.width,e.canvas.height),this},t}(ZO);OL.mergeOptions({doubleBuffer:!1,animation:!1}),OL.registerRenderer("canvas",IL);var NL=new uM(0,0),DL=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.getParticles=function(){},i.draw=function(e,t){var i=this.getParticles(cP());if(i&&0!==i.length){var n=this.getMap(),r=t.extent;t.maskExtent&&(r=t.extent.intersection(t.maskExtent)),r=r.convertTo((function(e){return n._pointToContainerPoint(e,void 0,0,NL)}));for(var s=2*Math.PI,o=0,a=i.length;o<a;o++){var l=i[o].point;if(r.contains(l)){var c=i[o].color||this.options.lineColor||"#fff",h=i[o].r;e.fillStyle!==c&&(e.fillStyle=c),h<=2?e.fillRect(l.x-h/2,l.y-h/2,h,h):(e.beginPath(),e.arc(l.x,l.y,h/2,0,s),e.fill())}}this._fillCanvas(e)}else this._getRenderer()&&(this._getRenderer()._shouldClear=!0)},i._fillCanvas=function(e){var t=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",e.fillStyle="rgba(0, 0, 0, "+1/(this.options.trail||30)+")",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation=t},t}(OL);DL.mergeOptions({animation:!0}),DL.registerRenderer("canvas",function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.draw=function(){this.canvas&&this.layer.options.animation&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this.prepareDrawContext(),this._drawLayer()},i.drawOnInteracting=function(){this.draw(),this._shouldClear=!1},i.onSkipDrawOnInteracting=function(){this._shouldClear=!0},t}(IL));var zL,LL,BL=new wR,FL=function(e){function t(t,i,n){var r;(r=e.call(this,n)||this).target=t,t.once("remove",r.delete,aM(aM(r)));var s=r.options.symbol,o=s.markerLineWidth||1;return r.w=s.markerWidth+o,r.h=s.markerHeight+o,r.opacity=uP(s.opacity)?1:s.opacity,r.map=i,r.events=n.events,r._fetchImage(),r.addTo(i),r}tM(t,e);var i=t.prototype;return i.getCursor=function(){return this.options.cursor||"default"},i._fetchImage=function(){var e=this.map,t=this.options.symbol,i=t.markerFile;this.url=i||Fk(t);var n=BL.getImage(this.url);if(!n){var r=this.w,s=this.h;if(i)(n=new Image).onload=function(){var t=e.getRenderer();t&&t.setToRedraw()},n.src=this.url;else{var o=document.createElement("canvas");o.width=r,o.height=s,n=tO(o.getContext("2d"),{x:r/2,y:s/2},t,BL)}BL.addResource([this.url,r,s],n)}BL.login(this.url),this._img=n},i.setContainerPoint=function(e){this._point=e,this._point._sub(this.w/2,this.h/2)},i.getContainerPoint=function(){return this._point.add(this.w/2,this.h/2)},i.offset=function(e){this._point._add(e)},i.render=function(e){if(!this._img)return!1;var t=this.options.symbol,i=t.markerDx||0,n=t.markerDy||0,r=this.map,s=this._point,o=s.x,a=s.y,l=this.w,c=this.h;if(o+l>0&&o<r.width&&a+c>0&&a<r.height){var h=r.getDevicePixelRatio();return e.globalAlpha=this.opacity,e.drawImage(this._img,Math.round((o+i)*h),Math.round((a+n)*h),Math.round(l*h),Math.round(c*h)),!0}return!1},i.delete=function(){if(this.map){var e=this.map.getRenderer();e&&e.removeTopElement(this)}BL.logout(this.url),this._dragger&&(this._dragger.disable(),delete this._dragger),delete this.map},i.hitTest=function(e){var t=this.options.symbol,i=this._point.x+(t.markerDx||0),n=this._point.y+(t.markerDy||0);return e.x>=i&&e.x<=i+this.w&&e.y>=n&&e.y<=n+this.h},i.addTo=function(e){this.map=e,e.getRenderer().addTopElement(this)},i.onEvent=function(e){this.fire(e.type,e)},i.mousedown=function(e){var t=this.options.cursor;t&&e.target.setCursor(t),this.onDragstart(e)},i.onDragstart=function(e){var t=e.containerPoint,i=e.target,n=this._dragger=new yI(i._panels.mapWrapper||i._containerDOM);n.on("dragging",this.onDragging,this).on("mouseup",this.onDragend,this).enable(),n.type="handle",n.onMouseDown(e.domEvent),zL=t.x,LL=t.y,this.fire("dragstart",{containerPoint:t})},i.onDragging=function(e){if(this._dragger){var t=this.map,i=sA(e.domEvent,t._containerDOM),n={x:i.x-zL,y:i.y-LL},r=t.containerPointToCoord(new uM(zL,LL)),s=t.containerPointToCoord(i);zL=i.x,LL=i.y,this.offset(n),this.fire("dragging",{containerPoint:i,coordOffset:s._sub(r)})}},i.onDragend=function(e){if(this._dragger){var t=this.map;t.resetCursor();var i=sA(e.domEvent,t._containerDOM);this.offset({x:i.x-zL,y:i.y-LL}),this._dragger.disable(),delete this._dragger,this.fire("dragend",{containerPoint:i})}},t}(nI(sI)),jL=function(){function e(e,t){this.target=e,e.once("remove",this.delete,this),this.map=t,this.addTo(t)}var t=e.prototype;return t.setPoints=function(e){this.points=e;var t=e.map((function(e){return e.x})),i=e.map((function(e){return e.y}));this.xmin=Math.min.apply(Math,t),this.xmax=Math.max.apply(Math,t),this.ymin=Math.min.apply(Math,i),this.ymax=Math.max.apply(Math,i)},t.hitTest=function(){return!1},t.render=function(e){var t=this.map;if(!(this.xmax<=0||this.xmin>=t.width||this.ymax<=0||this.ymin>=t.height)){var i=t.getDevicePixelRatio();e.lineWidth=1,e.strokeStyle="#000",e.globalAlpha=1,e.beginPath();var n=this.points;e.moveTo(s(n[0].x),s(n[0].y));for(var r=1;r<this.points.length;r++)e.lineTo(s(n[r].x),s(n[r].y));e.closePath(),e.stroke()}function s(e){return Math.round(e)*i+.5}},t.addTo=function(e){this.map=e,e.getRenderer().addTopElement(this)},t.delete=function(){if(this.map){var e=this.map.getRenderer();e&&e.removeTopElement(this)}},e}();function VL(e,t){return{markerType:e,markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:t}}var UL={fixAspectRatio:!1,symbol:null,removeVertexOn:"contextmenu",centerHandleSymbol:VL("ellipse",1),vertexHandleSymbol:VL("square",1),newVertexHandleSymbol:VL("square",.4)},qL=function(e){function t(t,i){var n;return(n=e.call(this,i)||this)._geometry=t,n._geometry?n:aM(n)}tM(t,e);var i=t.prototype;return i.getMap=function(){return this._geometry.getMap()},i.prepare=function(){var e=this.getMap();e&&(e.on("drawtopstart",this._refresh,this),this.options.symbol&&(this._originalSymbol=this._geometry.getSymbol(),this._geometry.setSymbol(this.options.symbol)),this._prepareEditStageLayer())},i._prepareEditStageLayer=function(){var e=this._geometry.getLayer();if("canvas"===e.options.renderer){var t=this.getMap(),i="_maptalks__internal_layer__edit_stage_"+fM()+"_shadow";this._shadowLayer=t.getLayer(i),this._shadowLayer||(this._shadowLayer=new(0,e.constructor)(i),t.addLayer(this._shadowLayer))}},i.start=function(){if(this._geometry&&this._geometry.getMap()&&!this._geometry.editing){this.editing=!0,this.prepare();var e,t=this._geometry,i="canvas"===this._geometry.getLayer().options.renderer;this._geometryDraggble=t.options.draggable,i?(t.config("draggable",!1),(e=t.copy()).setSymbol(t._getInternalSymbol()),e.copyEventListeners(t),t._getParent()&&e.copyEventListeners(t._getParent()),e._setEventTarget(t),e.setId(null).config({draggable:!1}),this._shadow=e,t.hide()):t instanceof MN&&t.config("draggable",!0),this._switchGeometryEvents("on"),(t instanceof MN||t instanceof UN||t instanceof HN||t instanceof qN)&&this._createOrRefreshOutline(),this._shadowLayer&&this._shadowLayer.bringToFront().addGeometry(e),t instanceof MN?e&&(e.config("draggable",!0),e.on("dragend",this._onMarkerDragEnd,this)):this._createCenterHandle(),t instanceof MN&&!1!==this.options.resize?this.createMarkerEditor():t instanceof UN?this.createCircleEditor():t instanceof HN||t instanceof qN?this.createEllipseOrRectEditor():t instanceof GN||(t instanceof EN||t instanceof AN)&&this.createPolygonEditor()}},i.stop=function(){delete this._history,delete this._historyPointer,delete this._editOutline,this._switchGeometryEvents("off"),this.getMap()?(this._geometry.config("draggable",this._geometryDraggble),this._shadow&&(delete this._shadow,delete this._geometryDraggble,this._geometry.show()),this._shadowLayer&&(this._shadowLayer.remove(),delete this._shadowLayer),this._refreshHooks=[],this.options.symbol&&(this._geometry.setSymbol(this._originalSymbol),delete this._originalSymbol),this.editing=!1,this.fire("remove")):this.fire("remove")},i.isEditing=function(){return!uP(this.editing)&&this.editing},i._getGeometryEvents=function(){return{symbolchange:this._onGeoSymbolChange,dragstart:this._onDragStart,dragend:this._onDragEnd,"positionchange shapechange":this._exeAndReset}},i._switchGeometryEvents=function(e){if(this._geometry){var t=this._getGeometryEvents();for(var i in t)this._geometry[e](i,t[i],this)}},i._onGeoSymbolChange=function(e){this._shadow&&this._shadow.setSymbol(e.target._getInternalSymbol())},i._onMarkerDragEnd=function(){this._update("setCoordinates",this._shadow.getCoordinates().toArray())},i._createOrRefreshOutline=function(){var e=this._geometry,t=this._editOutline;t||(this._editOutline=new jL(this,this.getMap()),this._addRefreshHook(this._createOrRefreshOutline));var i=this._editOutline.points;if(e instanceof MN)this._editOutline.setPoints(e.getContainerExtent().toArray(i));else{var n=this.getMap();(i=e._getPrjExtent().toArray(i)).forEach((function(e){return n._prjToContainerPoint(e,null,e)})),this._editOutline.setPoints(i)}return t},i._createCenterHandle=function(){var e,t=this,i=this.getMap(),n=this.options.centerHandleSymbol,r=i.coordToContainerPoint(this._geometry.getCenter()),s=this.createHandle(r,{symbol:n,cursor:"move",onDown:function(){if(t._shadow){var i=jk((e=t._shadow.copy())._getInternalSymbol(),.5);e.setSymbol(i).addTo(t._geometry.getLayer())}},onMove:function(i){var n=i.coordOffset;e?e.translate(n):t._geometry.translate(n)},onUp:function(){if(e){var i=e.getFirstCoordinate(),n=t._geometry.getFirstCoordinate(),r=i.sub(n);t._update("translate",r),e.remove()}}});this._addRefreshHook((function(){var e=t._geometry.getCenter();s.setContainerPoint(i.coordToContainerPoint(e))}))},i._createHandleInstance=function(e,t){var i=this.getMap(),n=ek(t.symbol,(function(){return[i.getZoom(),{"{bearing}":i.getBearing(),"{pitch}":i.getPitch(),"{zoom}":i.getZoom()}]})),r=new FL(this,i,{symbol:n,cursor:t.cursor,events:this.options.removeVertexOn});return r.setContainerPoint(e),r},i.createHandle=function(e,t){t||(t={});var i=this._createHandleInstance(e,t),n=this;return i.on("dragstart",(function(e){return this._updating=!0,t.onDown&&(t.onDown.call(n,e.containerPoint,e),this._geometry.fire("handledragstart")),!1}),this),i.on("dragging",(function(e){return n._hideContext(),t.onMove&&(t.onMove.call(n,e),this._geometry.fire("handledragging")),!1}),this),i.on("dragend",(function(e){return t.onUp&&(t.onUp.call(n,e),this._geometry.fire("handledragend")),this._updating=!1,!1}),this),t.onRefresh&&(i.refresh=t.onRefresh),i},i._createResizeHandles=function(e,t,i){var n=this,r=["nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize"],s=[null,"y",null,"x","x",null,"y",null],o=this._geometry,a=o instanceof MN;e||(e=[]);var l=this,c=[],h={},u=this.getMap(),d=this.options.vertexHandleSymbol,p=function(){for(var p=function(){if(a){var e=o.getContainerExtent();return[new uM(e.xmin,e.ymin),new uM((e.xmax+e.xmin)/2,e.ymin),new uM(e.xmax,e.ymin),new uM(e.xmin,(e.ymin+e.ymax)/2),new uM(e.xmax,(e.ymin+e.ymax)/2),new uM(e.xmin,e.ymax),new uM((e.xmax+e.xmin)/2,e.ymax),new uM(e.xmax,e.ymax)]}var t=o._getPrjExtent();return[new uM(t.xmin,t.ymax),new uM((t.xmax+t.xmin)/2,t.ymax),new uM(t.xmax,t.ymax),new uM(t.xmin,(t.ymax+t.ymin)/2),new uM(t.xmax,(t.ymax+t.ymin)/2),new uM(t.xmin,t.ymin),new uM((t.xmax+t.xmin)/2,t.ymin),new uM(t.xmax,t.ymin)]}(),m=function(m){if(Array.isArray(e)&&e.some((function(e){return e===m})))return"continue";var f,g=p[m],_=a?g:u._prjToContainerPoint(g);if(c.length<p.length-e.length){var y=n.createHandle(_,{symbol:d,cursor:r[m],axis:s[m],onMove:(f=m,function(e){l._updating=!0,t(e.containerPoint,f),o.fire("resizing")}),onUp:function(){l._updating=!1,i()}});h[m]=c.length,c.push(y)}else c[h[m]].setContainerPoint(_)},f=0;f<p.length;f++)m(f)};return p(),this._addRefreshHook(p),c},i.createMarkerEditor=function(){var e=this,t=this._shadow||this._geometry,i=this.getMap();if(t._canEdit()){this._history||this._recordHistory(p());var n=t._getInternalSymbol(),r=new uM(0,0);dP(n.markerDx)&&(r.x=n.markerDx),dP(n.markerDy)&&(r.y=n.markerDy);var s=null,o="middle",a="middle";if(wO.test(n)){var l=n.markerType;"pin"===l||"pie"===l||"bar"===l?(s=[5,6,7],o="bottom"):"rectangle"===l&&(s=[0,1,2,3,5],o="top",a="left")}else(pO.test(n)||CO.test(n))&&(o="bottom",s=[5,6,7]);var c,h=[2,1,2,0,0,2,1,2];if(this.options.fixAspectRatio){var u=t.getSize();c=u.width/u.height}var d=this._createResizeHandles(s,(function(n,l){if(s&&s.indexOf(l)>=0){var u=i.containerPointToCoordinate(n.sub(r)),p=t.getCoordinates();u.x=p.x,t.setCoordinates(u),e._updateCoordFromShadow(!0),n=d[d.length-1-l].getContainerPoint()}var m=i.coordToContainerPoint(t.getCoordinates()).add(r),f=t._getInternalSymbol(),g=n.sub(m);"bottom"===o&&n.y>m.y&&(g.y=0);var _="middle"===o?2:1,y="left"===a?1:2,v=Math.abs(g.x)*y,x=Math.abs(g.y)*_;c&&(x=(v=Math.max(v,x*c))/c);var b=h[l];t instanceof QN?((c||0===b||2===b)&&(t.setWidth(v),t!==e._geometry&&e._geometry.setWidth(v)),(c||1===b||2===b)&&(t.setHeight(x),t!==e._geometry&&e._geometry.setHeight(x))):((c||0===b||2===b)&&(f.markerWidth=Math.min(v,e._geometry.options.maxMarkerWidth||1/0)),(c||1===b||2===b)&&(f.markerHeight=Math.min(x,e._geometry.options.maxMarkerHeight||1/0)),t.setSymbol(f),t!==e._geometry&&e._geometry.setSymbol(f))}),(function(){e._update(p())}))}else console&&console.warn("A marker can't be resized with symbol:",t.getSymbol());function p(){var e=[["setCoordinates",t.getCoordinates().toArray()]];return t instanceof QN?(e.push(["setWidth",t.getWidth()]),e.push(["setHeight",t.getHeight()])):e.push(["setSymbol",t.getSymbol()]),e}},i.createCircleEditor=function(){var e=this,t=this._shadow||this._geometry,i=this.getMap();this._history||this._recordHistory([["setCoordinates",t.getCoordinates().toArray()],["setRadius",t.getRadius()]]),this._createResizeHandles(null,(function(n){var r=t.getCenter(),s=i.containerPointToCoord(n),o=new AN([[r.x,r.y],[s.x,r.y]]),a=new AN([[r.x,r.y],[r.x,s.y]]),l=Math.max(i.computeGeometryLength(o),i.computeGeometryLength(a));t.setRadius(l),t!==e._geometry&&e._geometry.setRadius(l)}),(function(){e._update("setRadius",t.getRadius())}))},i.createEllipseOrRectEditor=function(){var e=this,t=[2,1,2,0,0,2,1,2],i=this._shadow||this._geometry;this._history||this._recordHistory(a());var n,r=this.getMap(),s=this._geometry instanceof HN;this.options.fixAspectRatio&&(n=i.getWidth()/i.getHeight());var o=this._createResizeHandles(null,(function(a,l){var c,h,u,d=s?1:2,p=o[l].getContainerPoint(),m=t[l];if(s){var f=o[7-l].getContainerPoint(),g=(c=p.sub(f)).abs();h=r.pixelToDistance(g.x,0),u=r.pixelToDistance(0,g.y);var _=i.getSize(),y=i.getCoordinates(),v=i.getWidth(),x=i.getHeight(),b=r.containerPointToCoord(a),w=r.containerPointToCoord(f),C=new AN([[w.x,w.y],[b.x,w.y]]),S=new AN([[w.x,w.y],[w.x,b.y]]);if(h=r.computeGeometryLength(C),u=r.computeGeometryLength(S),0===m)if(n&&(g.y=g.x/n,_.height=Math.abs(g.y),u=h/n),p.y=f.y-_.height/2,b.y=y.y,4===l)b.x=Math.min(b.x,y.x);else{var E=r.locate(y,v,0);b.x=r.locate(new vI(E.x,b.y),-h,0).x}else if(1===m)n&&(g.x=g.y*n,_.width=Math.abs(g.x),h=u*n),p.x=f.x-_.width/2,b.x=y.x,b.y=Math.max(b.y,w.y);else{if(n&&(h>u*n?(u=h/n,p.y=f.y+g.x*bM(c.y)/n):(h=u*n,p.x=f.x+g.y*bM(c.x)*n)),0===l||5===l){var T=r.locate(y,v,0===l?0:-x);b.x=r.locate(new vI(T.x,b.y),-h,0).x}else b.x=Math.min(b.x,w.x);b.y=Math.max(b.y,w.y)}i.setCoordinates(b),e._updateCoordFromShadow(!0)}else{var P=i.getCenter(),M=r.containerPointToCoord(p),k=new AN([[P.x,P.y],[M.x,P.y]]),A=new AN([[P.x,P.y],[P.x,M.y]]);h=r.computeGeometryLength(k),u=r.computeGeometryLength(A),n&&(u=(h=Math.max(h,u*n))/n)}(n||0===m||2===m)&&(i.setWidth(h*d),i!==e._geometry&&e._geometry.setWidth(h*d)),(n||1===m||2===m)&&(i.setHeight(u*d),i!==e._geometry&&e._geometry.setHeight(u*d))}),(function(){e._update(a())}));function a(){return[["setCoordinates",i.getCoordinates().toArray()],["setWidth",i.getWidth()],["setHeight",i.getHeight()]]}},i.createPolygonEditor=function(){var e=this.getMap(),t=this._shadow||this._geometry,i=this;this._history||this._recordHistory("setCoordinates",vI.toNumberArrays(t.getCoordinates()));var n=t instanceof EN?3:2,r="maptalks--editor-vertex-index",s={0:[]},o={0:[]};function a(e){if(void 0===e&&(e=0),t instanceof EN){var i=t.getCoordinates()[e]||[];return i.slice(0,i.length-1)}return t.getCoordinates()}function l(e){return void 0===e&&(e=0),0===e?t._getPrjCoordinates():t._getPrjHoles()[e-1]}function c(){for(var e in s){for(var t=s[e].length-1;t>=0;t--)s[e][t][r]=t;for(var n=o[e].length-1;n>=0;n--)o[e][n][r]=n}i._updateCoordFromShadow()}function h(e){i._updating=!0;var a=e.target,h=a[r],u=dP(a._ringIndex)?a._ringIndex:0,d=l(u);if(!(d.length<=n)){var p,m=t instanceof AN&&(0===h||h===d.length-1);if(d.splice(h,1),u>0?t._prjHoles[u-1]=d:t._setPrjCoordinates(d),t._updateCache(),s[u].splice(h,1)[0].delete(),h<o[u].length&&o[u].splice(h,1)[0].delete(),o[u].splice(p=0===h?o[u].length-1:h-1,1)[0].delete(),m||o[u].splice(p,0,g.call(i,p,u)),u>0){var f=t.getCoordinates(),_=f[u];_&&Array.isArray(_)&&_.length>1&&(_.splice(h,1),t!==this._geometry&&t.setCoordinates(f))}c(),i._updating=!1}}function u(n,r,s){void 0===s&&(s=0);var a=i._geometry.snapTo;a&&gP(a)&&(n=i._geometry.snapTo(n)||n);var c,h=l(s),u=e._containerPointToPrj(n.sub(p())),d=h[r];d.x=u.x,d.y=u.y,t._updateCache(),t.onShapeChanged(),i._updateCoordFromShadow(!0),c=0===r?o[s].length-1:r-1,o[s][r]&&o[s][r].refresh(),o[s][c]&&o[s][c].refresh()}var d=new uM(0,0);function p(){var e=t._getCompiledSymbol();return d.x=e.lineDx||0,d.y=e.lineDy||0,d}function m(t,n,s){void 0===n&&(n=0);var o=(s||a(n))[t],l=i.createHandle(e.coordToContainerPoint(o)._add(p()),{symbol:i.options.vertexHandleSymbol,cursor:"pointer",axis:null,onMove:function(){u(l.getContainerPoint(),l[r],n)},onRefresh:function(t,i){o=(i||a(n))[l[r]];var s=e.coordToContainerPoint(o);l.setContainerPoint(s._add(p()))},onUp:function(){i._updateCoordFromShadow()},onDown:function(e,t){}});return l[r]=t,l._ringIndex=n,l.on(i.options.removeVertexOn,h),l}var f=!1;function g(n,h,d){void 0===h&&(h=0);var _=d||a(h),y=_[n].add(n+1>=_.length?_[0]:_[n+1]).multi(.5),v=i.createHandle(y,{symbol:i.options.newVertexHandleSymbol,cursor:"pointer",axis:null,onDown:function(n,s){if(!s||!s.domEvent||2!==s.domEvent.button){var a=l(h),c=v[r],u=v.getContainerPoint(),d=e._containerPointToPrj(u);a.splice(c+1,0,d),h>0?t._prjHoles[h-1]=a:t._setPrjCoordinates(a),t._updateCache(),v.opacity=1,o[h].splice(c,0,g.call(i,c,h),g.call(i,c+1,h)),f=!0}},onMove:function(){u(v.getContainerPoint(),v[r]+1,h)},onUp:function(e){if(e&&e.domEvent&&2===e.domEvent.button)f=!1;else{var t=v[r];yM(v,o[h]),v.delete(),s[h].splice(t+1,0,m.call(i,t+1,h)),c(),i._updateCoordFromShadow(),f=!1}},onRefresh:function(t,i){_=i||a(t);var n=v[r],s=_[n].add(_[n===_.length-1?0:n+1]).multi(.5),o=e.coordToContainerPoint(s);v.setContainerPoint(o._add(p()))}});return v[r]=n,v}if(t instanceof EN)for(var _=t.getHoles().length+1,y=0;y<_;y++){s[y]=[],o[y]=[];for(var v=a(y),x=0,b=v.length;x<b;x++)s[y].push(m.call(this,x,y,v)),x<b-1&&o[y].push(g.call(this,x,y,v));o[y].push(g.call(this,v.length-1,y,v))}else{for(var w=a(0),C=0,S=w.length;C<S;C++)s[0].push(m.call(this,C,0,w)),C<S-1&&o[0].push(g.call(this,C,0,w));o[0].length&&2===t.getCoordinates().length&&(o[0][0].options.symbol.markerDx=12)}this._addRefreshHook((function(){if(!f){for(var e in o)for(var i=a(e),n=o[e].length-1;n>=0;n--)o[e][n].refresh(e,i);for(var r in o[0].length&&t instanceof AN&&(2===t.getCoordinates().length?o[0][0].options.symbol.markerDx=12:t.getCoordinates().length>2&&(o[0][0].options.symbol.markerDx=0)),s)for(var l=a(r),c=s[r].length-1;c>=0;c--)s[r][c].refresh(r,l)}}))},i._refresh=function(){if(this._refreshHooks)for(var e=this._refreshHooks.length-1;e>=0;e--)this._refreshHooks[e].call(this)},i._hideContext=function(){this._geometry&&(this._geometry.closeMenu(),this._geometry.closeInfoWindow())},i._addRefreshHook=function(e){e&&(this._refreshHooks||(this._refreshHooks=[]),this._refreshHooks.push(e))},i._update=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this._exeHistory([e,i]),this._recordHistory.apply(this,[e].concat(i))},i._updateCoordFromShadow=function(e){var t=(this._shadow||this._geometry).getCoordinates(),i=this._geometry,n=this._updating;this._updating=!0,i.setCoordinates(t),e||this._recordHistory("setCoordinates",vI.toNumberArrays(i.getCoordinates())),this._updating=n},i._recordHistory=function(e){this._history||(this._history=[],this._historyPointer=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];if(this._history.length){var r=this._history[this._history.length-1];if(r[0]===e&&JSON.stringify(r[1])===JSON.stringify(i))return}this._historyPointer<this._history.length-1&&this._history.splice(this._historyPointer+1),this._history.push([e,i]),this._historyPointer=this._history.length-1,this._geometry.fire("editrecord")},i.cancel=function(){return this._history&&0!==this._historyPointer?(this._historyPointer=0,this._exeAndReset(this._history[0]),this):this},i.undo=function(){if(!this._history||0===this._historyPointer)return this;var e=this._history[--this._historyPointer];return this._exeAndReset(e),this},i.redo=function(){if(!this._history||this._historyPointer===this._history.length-1)return this;var e=this._history[++this._historyPointer];return this._exeAndReset(e),this},i._exeAndReset=function(e){if(!this._updating){this._exeHistory(e);var t=this._history,i=this._historyPointer;this.stop(),this._history=t,this._historyPointer=i,this.start()}},i._onDragStart=function(){this._updating=!0},i._onDragEnd=function(){this._updating=!1},i._exeHistory=function(e){if(Array.isArray(e)){var t=this._updating;this._updating=!0;var i=this._shadow||this._geometry,n=this._geometry;Array.isArray(e[0])?e[0].forEach((function(e){var t=e[0],r=e.slice(1);i[t].apply(i,r),i!==n&&n[t].apply(n,r)})):(i[e[0]].apply(i,e[1]),i!==n&&n[e[0]].apply(n,e[1])),this._updating=t}},t}(nI(sI));qL.mergeOptions(UL),JN.include({startEditText:function(){return this.getMap()?(this.hide(),this.endEditText(),this._prepareEditor(),this._fireEvent("edittextstart"),this):this},endEditText:function(){if(this._textEditor){var e=this._textEditor.innerHTML;e=e.replace(/<p>/gi,"").replace(/<\/p>/gi,"<br/>"),this._textEditor.innerHTML=e;var t=this._textEditor.innerText.replace(/[\r\n]+$/gi,"");this.setContent(t),pA(this._textEditor,"mousedown dblclick",iA),this.getMap().off("mousedown",this.endEditText,this),this._editUIMarker.remove(),delete this._editUIMarker,this._textEditor.onkeyup=null,delete this._textEditor,this.show(),this._fireEvent("edittextend")}return this},isEditingText:function(){return!!this._textEditor},getTextEditor:function(){return this._editUIMarker},_prepareEditor:function(){var e=this.getMap(),t=this._createEditor();this._textEditor=t,e.on("mousedown",this.endEditText,this);var i=this._getEditorOffset();this._editUIMarker=new mz(this.getCoordinates(),{animation:null,content:t,dx:i.dx,dy:i.dy}).addTo(e),this._setCursorToLast(this._textEditor)},_getEditorOffset:function(){var e=this._getInternalSymbol()||{},t=0,i=0,n=e.textHorizontalAlignment;return"middle"===n||uP(n)?(t=(e.textDx||0)-2,i=(e.textDy||0)-2):(t=(e.markerDx||0)-2,i=(e.markerDy||0)-2),{dx:t,dy:i}},_createEditor:function(){var e=this.getContent(),t=this.getSize(),i=this._getInternalSymbol()||{},n=t.width,r=i.textFill||"#000000",s=i.textSize||12,o=t.height,a=i.markerLineColor||"#000",l=i.markerFill||"#3398CC",c=i.textLineSpacing||0,h=Xk("div");return h.contentEditable=!0,h.style.cssText="background:"+l+"; border:1px solid "+a+";\n            color:"+r+";font-size:"+s+"px;width:"+(n-2)+"px;height:"+(o-2)+"px;margin: auto;\n            line-height:"+(s+c)+"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;",h.innerText=e,dA(h,"mousedown dblclick",iA),h.onkeyup=function(e){13===e.keyCode&&(h.style.height=parseInt(h.style.height||0)+s/2+"px")},h},_setCursorToLast:function(e){var t;window.getSelection?(e.focus(),(t=window.getSelection()).selectAllChildren(e),t.collapseToEnd()):document.selection&&((t=document.selection.createRange()).moveToElementText(e),t.collapse(!1),t.select())}}),UO.include({animate:function(e,t,i){var n=this;this._animPlayer&&this._animPlayer.finish(),gP(t)&&(i=t),t||(t={});var r,s=this.getMap(),o=this._getProjection(),a=this._prepareAnimationStyles(e),l=t.focus;if(delete this._animationStarted,s){var c=s._getRenderer();t.framer=function(e){c.callInNextFrame(e)}}var h=CN.animate(a,t,(function(e){if(s&&s.isRemoved())h.finish();else{s&&!n._animationStarted&&l&&s.onMoveStart();var t=e.styles;for(var a in t)if("symbol"!==a&&"translate"!==a&&t.hasOwnProperty(a)){var c="set"+a[0].toUpperCase()+a.slice(1);n[c](t[a])}var u=t.translate;if(u){var d=u;r&&(d=u.sub(r)),r=u,n.translate(d)}var p=t.symbol;if(p){var m=n.getSymbol()||{};n.setSymbol(Vk(m,p))}if(s&&l){var f=o.project(n.getCenter());s._setPrjCenter(f);var g=s._parseEventFromCoord(o.unproject(f));"running"!==h.playState?s.onMoveEnd(g):s.onMoving(g)}n._fireAnimateEvent(h.playState),i&&i(e)}}),this);return this._animPlayer=h,this._animPlayer.play()},_prepareAnimationStyles:function(e){var t=this._getInternalSymbol(),i={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if("translate"!==n&&"symbol"!==n){var s=this["get"+n[0].toUpperCase()+n.substring(1)]();i[n]=[s,r]}else if("symbol"===n){var o=void 0;if(Array.isArray(e.symbol)){if(!Array.isArray(t))throw new Error("geometry'symbol isn't a composite symbol, while the symbol in styles is.");o=[];for(var a=e.symbol,l=0;l<a.length;l++)if(a[l]){var c={};for(var h in a[l])a[l].hasOwnProperty(h)&&(c[h]=[t[l][h],a[l][h]]);o.push(c)}else o.push(null)}else{if(Array.isArray(t))throw new Error("geometry'symbol is a composite symbol, while the symbol in styles isn't.");for(var u in o={},r)r.hasOwnProperty(u)&&(o[u]=[t[u],r[u]])}i.symbol=o}else"translate"===n&&(i.translate=new vI(r))}return i},_fireAnimateEvent:function(e){"finished"===e?(delete this._animationStarted,this._fireEvent("animateend")):"running"===e&&(this._animationStarted?this._fireEvent("animating"):(this._fireEvent("animatestart"),this._animationStarted=!0))}});var HL=QP.touch?"touchstart mousedown":"mousedown",GL=function(e){function t(t){return e.call(this,t)||this}tM(t,e);var i=t.prototype;return i.addHooks=function(){this.target.on(HL,this._startDrag,this)},i.removeHooks=function(){this._endDrag(),this.target.off(HL,this._startDrag,this),delete this.container},i._prepareDragHandler=function(){this._dragHandler=new yI(this.container),this._dragHandler.on("dragging",this._dragging,this).on("mouseup",this._endDrag,this).enable()},i._prepareShadow=function(){var e=this,t=this.target;if("canvas"===t.getLayer().options.renderer){this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var i=this._shadow=t.copy();if(i.getGeometries){var n=i.getGeometries(),r=t.getGeometries();n.forEach((function(t,i){e._updateShadowSymbol(t,r[i])}))}else this._updateShadowSymbol(i,t);i.setId(null),this._prepareShadowConnectors()}},i._updateShadowSymbol=function(e,t){if(e.setSymbol(t._getInternalSymbol()),t.options.dragShadow){var i=jk(e._getInternalSymbol(),.5);e.setSymbol(i)}},i._prepareShadowConnectors=function(){var e=this.target,t=this._shadow,i=this._dragStageLayer._getRenderer().resources,n=[];if(nD._hasConnectors(e))for(var r=nD._getConnectors(e),s=0,o=r.length;s<o;s++){var a,l=r[s],c=l.config(),h=l._getInternalSymbol();c.symbol=jk(h,.5),a=l.getConnectSource()===e?new l.constructor(t,l.getConnectTarget(),c):new l.constructor(l.getConnectSource(),t,c),n.push(a),l.getLayer()&&l.getLayer()._getRenderer()&&i.merge(l.getLayer()._getRenderer().resources)}this._shadowConnectors=n,n.push(t),this._dragStageLayer.bringToFront().addGeometry(n)},i._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target._getSymbol())},i._prepareDragStageLayer=function(){var e=this.target.getMap(),t=this.target.getLayer();this._dragStageLayer=e.getLayer("_maptalks__internal_layer__drag_stage"),this._dragStageLayer||(this._dragStageLayer=new hD("_maptalks__internal_layer__drag_stage",{enableAltitude:t.options.enableAltitude,altitudeProperty:t.options.altitudeProperty}),e.addLayer(this._dragStageLayer));var i=new wR;i.merge(t._getRenderer().resources),this._dragStageLayer._getRenderer().resources=i},i._startDrag=function(e){var t=this.target.getMap();if(t&&!this.target._getParent()&&!this.isDragging()){var i=e.domEvent;i.touches&&i.touches.length>1||2===i.button||(this.container=t._panels.mapWrapper||t._containerDOM,this.target.on("click",this._endDrag,this),this._lastCoord=this._correctCoord(e.coordinate),this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),dA(this.container,"mouseleave",this._endDrag,this),this._startParam=e,this._moved=!1)}},i._dragging=function(e){var t=this.target,i=t.getMap();if(!i._isEventOutMap(e.domEvent)){var n=i._parseEvent(e.domEvent),r=n.domEvent;if(!(r.touches&&r.touches.length>1)){var s=i._getVisualHeight(i.options.maxVisualPitch);if(!(n.containerPoint.y<i.height-s)){if(!this._moved)return this._moved=!0,t.on("symbolchange",this._onTargetUpdated,this),this._isDragging=!0,this._prepareShadow(),this._shadow&&(t.options.dragShadow||t.hide(),this._shadow._fireEvent("dragstart",n)),this.target._fireEvent("dragstart",this._startParam||n),void delete this._startParam;var o=this._shadow||t,a=o.options.dragOnAxis,l=o.options.dragOnScreenAxis,c=n.containerPoint,h=n.coordinate;this._lastPoint=this._lastPoint||c,this._lastCoord=this._lastCoord||h,l?("x"===a?c.y=this._lastPoint.y:"y"===a&&(c.x=this._lastPoint.x),h=i.containerPointToCoord(c)):h=this._correctCoord(h);var u=c.sub(this._lastPoint),d=h.sub(this._lastCoord);l||("x"===a?u.y=d.y=0:"y"===a&&(u.x=d.x=0)),this._lastPoint=c,this._lastCoord=h,o.translate(d),o===t||t.options.dragShadow||t.translate(d),n.coordOffset=d,n.pointOffset=u,o._fireEvent("dragging",n),o!==t&&t._fireEvent("dragging",n)}}}},i._endDrag=function(e){if(this._dragHandler&&(this._dragHandler.disable(),delete this._dragHandler),this.container&&pA(this.container,"mouseleave",this._endDrag,this),this.target){var t=this.target;t.off("click",this._endDrag,this),t.off("symbolchange",this._onTargetUpdated,this),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1;var i=t.getMap();if(this.enabled()&&i){var n=i._parseEvent(e?e.domEvent:null);this._updateTargetAndRemoveShadow(n),this._moved&&t._fireEvent("dragend",n)}}},i.isDragging=function(){return!!this._isDragging},i._updateTargetAndRemoveShadow=function(e){if(this._shadow){var t=this.target,i=t.getMap();t.options.dragShadow||t.show();var n=this._shadow;if(n){if(t.options.dragShadow){var r=n.getFirstCoordinate(),s=t.getFirstCoordinate(),o=r.sub(s);t.translate(o)}n._fireEvent("dragend",e),n.remove(),delete this._shadow}this._shadowConnectors&&(i.getLayer("_maptalks__internal_layer__drag_stage").removeGeometry(this._shadowConnectors),delete this._shadowConnectors),this._dragStageLayer&&(this._dragStageLayer._getRenderer().resources=new wR,this._dragStageLayer.remove())}},i._correctCoord=function(e){var t=this.target.getMap();if(!t.getPitch())return e;var i=this.target;if(!i.getMinAltitude())return e;var n=(i.getMinAltitude()+i.getMaxAltitude())/2;return t.locateByPoint(e,0,-n)},t}(rI);UO.mergeOptions({draggable:!1,dragShadow:!0,dragOnAxis:null,dragOnScreenAxis:!1}),UO.addInitHook("addHandler","draggable",GL),UO.include({isDragging:function(){return this._getParent()?this._getParent().isDragging():!!this.draggable&&this.draggable.isDragging()}}),UO.include({startEdit:function(e){var t=this.getMap();return t&&this.options.editable?(this._editor&&this.endEdit(),this._editor=new qL(this,e),this._editor.start(),this._getParent()||this.fire("editstart"),t.getRenderer().setToRedraw(),this):this},endEdit:function(){if(this._editor){this._editor.stop(),delete this._editor,this._getParent()||this.fire("editend");var e=this.getMap();e&&e.getRenderer().setToRedraw()}return this},redoEdit:function(){return this.isEditing()?(this._editor.redo(),this._getParent()||this.fire("redoedit"),this):this},undoEdit:function(){return this.isEditing()?(this._editor.undo(),this._getParent()||this.fire("undoedit"),this):this},cancelEdit:function(){return this.isEditing()?(this._editor.cancel(),this._getParent()||this.fire("canceledit"),this):this},isEditing:function(){return!!this._editor&&this._editor.isEditing()}}),UO.include({_onEvent:function(e,t){var i=this.getMap();if(i){var n=t||this._getEventTypeToFire(e);"contextmenu"===n&&this.listens("contextmenu")&&(iA(e),tA(e));var r=i._getEventParams(e);dP(this._pickGeometryIndex)&&(r.pickGeometryIndex=this._pickGeometryIndex),this._fireEvent(n,r)}},_getEventTypeToFire:function(e){return e.type}}),UO.include({setInfoWindow:function(e){return this.removeInfoWindow(),e instanceof xz?(this._infoWindow=e,this._infoWinOptions=hP({},this._infoWindow.options),this._infoWindow.addTo(this),this):(this._infoWinOptions=hP({},e),this._infoWindow?this._infoWindow.setOptions(e):this.getMap()&&this._bindInfoWindow(),this)},getInfoWindow:function(){return this._infoWindow?this._infoWindow:null},openInfoWindow:function(e){return this.getMap()?(e||(e=this.getCenter()),this._infoWindow?this._infoWindow.show(e):this._infoWinOptions&&this.getMap()&&(this._bindInfoWindow(),this._infoWindow.show(e)),this):this},closeInfoWindow:function(){return this._infoWindow&&this._infoWindow.hide(),this},removeInfoWindow:function(){return this._unbindInfoWindow(),delete this._infoWinOptions,delete this._infoWindow,this},_bindInfoWindow:function(){var e=this._infoWinOptions;return e?(this._infoWindow=new xz(e),this._infoWindow.addTo(this),this):this},_unbindInfoWindow:function(){return this._infoWindow&&(this.closeInfoWindow(),this._infoWindow.remove(),delete this._infoWindow),this}});var WL=new uM(0,0),ZL=new uM(0,0),$L=new uM(0,0),XL=new uM(0,0),KL=[],YL=function(e){function t(){return e.call(this,"core-fetch-image")||this}tM(t,e);var i=t.prototype;return i.checkUrl=function(e){return e&&fP(e)?zM(e):e},i.fetchImage=function(e,t,i,n){e=this.checkUrl(e),this.send({url:e,fetchOptions:n},KL,i,t)},t}(yR),JL=new Image,QL=function(e){function t(t){var i;(i=e.call(this,t)||this).tilesInView={},i.tilesLoading={},i._parentTiles=[],i._childTiles=[],i._tileQueue=[],i._tileQueueIds=new Set;var n=t.getTileSize().width;return i.tileCache=new VA(t.options.maxCacheSize*n/512*n/512,(function(e){i.deleteTile(e)})),QP.decodeImageInWorker&&i.layer.options.decodeImageInWorker&&("gl"===t.options.renderer||!QP.safari&&!QP.iosWeixin)&&(i._tileImageWorkerConn=new YL),i._compareTiles=tB.bind(aM(aM(i))),i}tM(t,e);var i=t.prototype;return i.getCurrentTileZoom=function(){return this._tileZoom},i.draw=function(e,t){var i=this.getMap();if(this.isDrawable()){var n=this.prepareCanvas();if(!n||n.intersects(this.canvasExtent2D)){var r;this._renderTimestamp!==e&&(this._consumeTileQueue(),this._computeAvgTileAltitude(),this._renderTimestamp=e);var s=!1,o=this._frameTiles;if(o&&e===o.timestamp){if(o.empty)return;r=o}else{if(!(r=this._getTilesInCurrentFrame()))return this._frameTiles={empty:!0,timestamp:e},void this.completeRender();s=!0,this._frameTiles=r,this._frameTiles.timestamp=e,r.loadingCount&&this.loadTileQueue(r.tileQueue)}var a=r.loading,l=r.loadingCount;this._drawTiles(r.tiles,r.parentTiles,r.childTiles,r.placeholders,t,r.missedTiles,r.incompleteTiles),l||a||(i.isAnimating()||!this._parentTiles.length&&!this._childTiles.length||(this._parentTiles=[],this._childTiles=[],this.setToRedraw()),this.completeRender()),s&&this.retireTiles()}else this.completeRender()}},i.getTileGridsInCurrentFrame=function(){return this._frameTileGrids},i.getCurrentTimestamp=function(){return this._renderTimestamp||0},i._getTilesInCurrentFrame=function(){var e=this.getMap(),t=this.layer,i=t._isPyramidMode()&&t.options.terrainTileMode,n=t.getTiles();if(this._frameTileGrids=n,!(n=n.tileGrids)||!n.length)return null;var r=n.reduce((function(e,t){return e+(t&&t.tiles&&t.tiles.length||0)}),0);r>=this.tileCache.max/2&&this.tileCache.setMaxSize(2*r+1);var s=0,o=!1,a={},l=[],c=[],h={},u=[],d={},p=[],m={},f={},g=this.markTiles(),_=this._getLoadLimit(),y=n.length,v=void 0===this._tileZoom&&!this._terrainHelper;this._tileZoom=n[0].zoom;var x=null,b=null;i&&(x=[],b=new Map);for(var w=0;w<y;w++){var C=n[w],S=C.tiles,E=C.parents||KL,T=E.length,P=v?S:E.concat(S),M=void 0;P.length&&(M=this._generatePlaceHolder(P[0].res));for(var k=0,A=P.length;k<A;k++){var I=P[k],R=I.id,O=k<T,N=!1,D=l.length;if(this._isLoadingTile(R))N=o=!0,this.markCurrent(this.tilesLoading[R],!0);else{var z=this.getCachedTile(I,O);if(z)O||(z.image&&this.isTileFadingIn(z.image)&&(N=o=!0,this.setToRedraw()),this.isTileComplete(z)?l.push(z):(N=!0,i&&b.set(R,z)));else{N=o=!0;var L=_&&s+g[0]>_;this._tileQueueIds.has(I.id)||L||e.isInteracting()&&!e.isMoving()&&!e.isRotating()||(s++,f[R]=I)}}if(i&&!O&&(l.length===D?x.push(I):a[I.id]=1),!i&&!O&&N&&!a[R]){a[R]=1,M&&!m[R]&&(I.cache=!1,p.push({image:M,info:I}),m[R]=1);var B=this._findChildTiles(I);if(B.length&&B.forEach((function(e){d[e.info.id]||(u.push(e),d[e.info.id]=1)})),!B.length||4!==B.length){var F=this._findParentTile(I);if(F){var j=F.info.id;void 0===h[j]&&(h[j]=c.length,c.push(F))}}}}}var V=[];if(i)for(var U=0;U<x.length;U++){var q=x[U].info?x[U].info:x[U];if(q.parent&&!a[q.id]){var H=this._findChildTiles(q),G=H.tiles,W=H.missedTiles;G.length?(_M(l,G),_M(V,W)):b.has(q.id)?(l.push(b.get(q.id)),b.delete(q.id)):(a[q.id]=1,V.push(q))}}return this.tileCache.shrink(),{childTiles:u,missedTiles:V,parentTiles:c,tiles:l,incompleteTiles:b&&Array.from(b.values()),placeholders:p,loading:o,loadingCount:s,tileQueue:f}},i.removeTileCache=function(e){delete this.tilesInView[e],this.tileCache.remove(e)},i.isTileCachedOrLoading=function(e){return this.tileCache.get(e)||this.tilesInView[e]||this.tilesLoading[e]},i.isTileCached=function(e){return!(!this.tileCache.get(e)&&!this.tilesInView[e])},i.isTileFadingIn=function(e){return this._getTileFadingOpacity(e)<1},i._drawTiles=function(e,t,i,n,r){var s=this;t.length&&(t.sort(this._compareTiles),this._parentTiles=t),i.length&&(this._childTiles=i,this._childTiles.sort(this._compareTiles));var o=!0;this.layer.constructor!==iL&&this.layer.constructor!==uL||(this._renderTimestamp===this.canvas._parentTileTimestamp?o=!1:this.canvas._parentTileTimestamp=this._renderTimestamp);var a="gl"===this.layer.options.renderer&&(!this.isGL||this.isGL()),l={tiles:e,parentTiles:this._parentTiles,childTiles:this._childTiles,parentContext:r};if(this.onDrawTileStart(l,r),o&&1===this.layer.options.opacity){this.layer._silentConfig=!0;var c=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,a?(this._drawChildTiles(i,r),this._drawParentTiles(this._parentTiles,r)):(this._drawParentTiles(this._parentTiles,r),this._drawChildTiles(i,r)),this.layer.options.fadeAnimation=c,this.layer._silentConfig=!1}this.drawingCurrentTiles=!0,e.sort(this._compareTiles);for(var h=0,u=e.length;h<u;h++)this._drawTileAndCache(e[h],r);if(delete this.drawingCurrentTiles,o&&this.layer.options.opacity<1){this.layer._silentConfig=!0;var d=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,a?(this._drawChildTiles(i,r),this._drawParentTiles(this._parentTiles,r)):(this._drawParentTiles(this._parentTiles,r),this._drawChildTiles(i,r)),this.layer.options.fadeAnimation=d,this.layer._silentConfig=!1}n.forEach((function(e){return s._drawTile(e.info,e.image,r)})),this.onDrawTileEnd(l,r)},i._drawChildTiles=function(e,t){var i=this;this.drawingChildTiles=!0,e.forEach((function(e){return i._drawTile(e.info,e.image,t)})),delete this.drawingChildTiles},i._drawParentTiles=function(e,t){var i=this;this.drawingParentTiles=!0,this._parentTiles.forEach((function(e){return i._drawTile(e.info,e.image,t)})),delete this.drawingParentTiles},i.onDrawTileStart=function(){},i.onDrawTileEnd=function(){},i._drawTile=function(e,t,i){t&&this.drawTile(e,t,i)},i._drawTileAndCache=function(e,t){this.isValidCachedTile(e)&&this._addTileToCache(e.info,e.image),this._drawTile(e.info,e.image,t)},i.drawOnInteracting=function(e,t,i){this.draw(t,i)},i.needToRedraw=function(){var t=this.getMap();return!!this._tileQueue.length||(t.getPitch()?e.prototype.needToRedraw.call(this):!(!t.isRotating()&&!t.isZooming())||(t.isMoving()?!!this.layer.options.forceRenderOnMoving:e.prototype.needToRedraw.call(this)))},i.hitDetect=function(){return!1},i._getLoadLimit=function(){return this.getMap().isInteracting()?this.layer.options.loadingLimitOnInteracting:this.layer.options.loadingLimit||0},i.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("TileLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),this.clear(),!1)},i.clear=function(){this.retireTiles(!0),this.tileCache.reset(),this.tilesInView={},this.tilesLoading={},this._tileQueue=[],this._tileQueueIds.clear(),this._parentTiles=[],this._childTiles=[],e.prototype.clear.call(this)},i._isLoadingTile=function(e){return!!this.tilesLoading[e]},i.clipCanvas=function(t){return e.prototype.clipCanvas.call(this,t)},i._clipByPitch=function(e){var t=this.getMap();if(t.getPitch()<=t.options.maxVisualPitch)return!1;if(!this.layer.options.clipByPitch)return!1;var i=t.getContainerExtent(),n=t.getDevicePixelRatio();return e.save(),e.strokeStyle="rgba(0, 0, 0, 0)",e.beginPath(),e.rect(0,Math.ceil(i.ymin)*n,Math.ceil(i.getWidth())*n,Math.ceil(i.getHeight())*n),e.stroke(),e.clip(),!0},i.loadTileQueue=function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t],n=this.loadTile(i);void 0===n.loadTime&&(this.tilesLoading[i.id]={image:n,current:!0,info:i})}},i.loadTile=function(e){var t=this,i={};if(this.loadTileBitmap)this.loadTileBitmap(e.url,e,(function(i){t.onTileLoad(i,e)}));else if(this._tileImageWorkerConn&&this.loadTileImage===this.constructor.prototype.loadTileImage)this._fetchImage(i,e);else{var n=this.layer.getTileSize(e.layer);(i=new Image).width=n.width,i.height=n.height,i.onload=this.onTileLoad.bind(this,i,e),i.onerror=this.onTileError.bind(this,i,e),this.loadTileImage(i,e.url)}return i},i._fetchImage=function(e,t){var i=this;if(e instanceof Image)e.src=t.url;else{var n=Math.abs(t.x+t.y)%this._tileImageWorkerConn.workers.length;this._tileImageWorkerConn.fetchImage(t.url,n,(function(n,r){n?i.onTileError(e,t,n):DM(r,(function(e){i.onTileLoad(e,t)}))}),this.layer.options.fetchOptions||{referrer:document.location.href,headers:{accept:"image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"}})}},i.loadTileImage=function(e,t){var i=this.layer.options.crossOrigin;return uP(i)||(e.crossOrigin=i),pM(e,[t])},i.abortTileLoading=function(e,t){t&&void 0!==t.id&&this.removeTileLoading(t),e&&e instanceof Image&&(e.onload=eB,e.onerror=eB,e.src=AM)},i.onTileLoad=function(e,t){this.removeTileLoading(t),this._tileQueue.push({tileInfo:t,tileData:e}),this._tileQueueIds.add(t.id),this.setToRedraw()},i.removeTileLoading=function(e){delete this.tilesLoading[e.id],this.setToRedraw()},i._consumeTileQueue=function(){for(var e=0,t=this.layer.options.tileLimitPerFrame,i=this._tileQueue;i.length&&(t<=0||e<t);){var n=i.shift(),r=n.tileData,s=n.tileInfo;this._tileQueueIds.has(s.id)&&(this._tileQueueIds.delete(s.id),this.checkTileInQueue(r,s)&&(this.consumeTile(r,s),e++))}},i._computeAvgTileAltitude=function(){var e=0,t=0,i=0;for(var n in this.tilesInView){var r=this.tilesInView[n]&&this.tilesInView[n].info;r&&(e+=r.minAltitude||0,t+=r.maxAltitude||0,i++)}this.avgMinAltitude=e/i,this.avgMaxAltitude=t/i},i.checkTileInQueue=function(){return!0},i.consumeTile=function(e,t){if(this.layer&&this.tilesInView){var i={tile:t,tileImage:e};this.resetTileLoadTime(e=i.tileImage),this.removeTileLoading(t),this._addTileToCache(t,e),this.layer.fire("tileload",i),this.setToRedraw()}},i.resetTileLoadTime=function(e){e.loadTime=cP()},i.onTileError=function(e,t){if(this.layer){if(e.onerrorTick=e.onerrorTick||0,this.layer.options.tileRetryCount>e.onerrorTick)return e.onerrorTick++,this._fetchImage(e,t),void this.removeTileLoading(t);var i=this.layer.options.errorUrl;if(i){if(e instanceof Image&&e.src!==i)return e.src=i,void this.removeTileLoading(t);(e=new Image).src=i}e=e instanceof Image?e:JL,this.abortTileLoading(e,t),e.loadTime=0,this.removeTileLoading(t),this._addTileToCache(t,e),this.setToRedraw(),this.layer.fire("tileerror",{tile:t})}},i.drawTile=function(e,t){if(t&&this.getMap()){var i=e.extent2d,n=e.offset,r=WL.set(i.xmin-n[0],i.ymax-n[1]),s=e.z,o=e.id,a=this.getMap(),l=a.getZoom(),c=this.context,h=a._pointAtResToContainerPoint(r,e.res,0,ZL),u=a.getBearing(),d=u||l!==s,p=this.getTileOpacity(t,e),m=c.globalAlpha;p<1&&(c.globalAlpha=p),d||h._round();var f=h.x,g=h.y,_=e.extent2d.xmax-e.extent2d.xmin,y=e.extent2d.ymax-e.extent2d.ymin,v=this.layer,x=v?v.options.bufferPixel:0;if(d){c.save(),c.translate(f,g),u&&c.rotate(-u*Math.PI/180),_+=x,y+=x;var b=a._getResolution();if(b!==e.res){var w=e.res/b;c.scale(w,w)}f=g=0}if(YA.image(c,t,f,g,_,y),this.layer.options.debug){var C=this.layer.options.debugOutline;c.save(),c.strokeStyle=C,c.fillStyle=C,c.strokeWidth=10,c.font="20px monospace";var S=new uM(f,g);YA.rectangle(c,S,{width:_,height:y},1,0),YA.fillText(c,this.getDebugInfo(o),S._add(32,y-14),C),YA.drawCross(c,f+_/2,g+y/2,2,C),c.restore()}d&&c.restore(),c.globalAlpha!==m&&(c.globalAlpha=m),this.setCanvasUpdated()}},i.getDebugInfo=function(e){var t=e.split("_"),i=t.length;return t[i-3]+"/"+t[i-2]+"/"+t[i-1]},i.findChildTiles=function(e){return this._findChildTiles(e)},i._findChildTiles=function(e){var t=this._getLayerOfTile(e.layer),i=t&&t.options.terrainTileMode&&t._isPyramidMode();if(!t||!t.options.background&&!i||e.z>this.layer.getMaxZoom())return KL;var n=this.getMap(),r=[];if(t._isPyramidMode()){if(!i){for(var s=this._getLayerOfTile(e.layer),o=2*e.x,a=2*e.y,l=e.z+1,c=[],h=0;h<2;h++)for(var u=0;u<2;u++)c.push(o+h,a+u,l);for(;c.length;){var d=c.pop(),p=c.pop(),m=c.pop(),f=s._getTileId(m,p,d,e.layer),g=d+1<=e.z+2,_=this.tileCache.getAndRemove(f);if(_){if(this.isValidCachedTile(_))r.push(_),this.tileCache.add(f,_);else if(g)for(var y=0;y<2;y++)for(var v=0;v<2;v++)c.push(2*m+y,2*p+v,d+1)}else if(g)for(var x=0;x<2;x++)for(var b=0;b<2;b++)c.push(2*m+x,2*p+b,d+1)}return r}var w;i&&(w=[]);for(var C=2*e.x,S=2*e.y,E=e.z+1,T=[],P=0;P<2;P++)for(var M=0;M<2;M++){var k=t._getTileId(C+P,S+M,E,e.layer),A=this.tileCache.getAndRemove(k);A&&this.isValidCachedTile(A)?(r.push(A),this.tileCache.add(k,A),T.push(null)):T.push(k)}if(r.length<4)for(var I=0,R=0;R<2;R++)for(var O=0;O<2;O++){var N=T[I++];if(N){for(var D=C+R,z=S+O,L=E,B=r.length,F=[],j=0;j<2;j++)for(var V=0;V<2;V++){var U=t._getTileId(2*D+j,2*z+V,L+1,e.layer),q=this.tileCache.getAndRemove(U);q&&this.isValidCachedTile(q)?(r.push(q),this.tileCache.add(U,q),F.push(null)):F.push(U)}if(i&&r.length-B<4){var H=t.tileInfoCache.get(N)||t._createChildNode(e,R,O,[0,0],N);if(r.length-B==0)w.push(H);else for(var G=0,W=0;W<2;W++)for(var Z=0;Z<2;Z++){var $=F[G++];if($){var X=this.layer.tileInfoCache.get($)||t._createChildNode(H,W,Z,[0,0],$);w.push(X)}}}}}return i?{tiles:r,missedTiles:w}:r}for(var K=e.res,Y=e.extent2d.getMin(),J=e.extent2d.getMax(),Q=t._project(n._pointToPrjAtRes(Y,K,$L),$L),ee=t._project(n._pointToPrjAtRes(J,K,XL),XL),te=1;te<1;te++)this._findChildTilesAt(r,Q,ee,t,e.z+te);return r},i._findChildTilesAt=function(e,t,i,n,r){var s=n.getId(),o=n.getSpatialReference().getResolution(r);if(o)for(var a,l,c=n._getTileConfig().getTileIndex(t,o),h=n._getTileConfig().getTileIndex(i,o),u=Math.min(c.idx,h.idx),d=Math.max(c.idx,h.idx),p=Math.min(c.idy,h.idy),m=Math.max(c.idy,h.idy),f=u;f<d;f++)for(var g=p;g<m;g++)a=n._getTileId(f,g,r,s),(l=this.tileCache.getAndRemove(a))&&this.isValidCachedTile(l)&&(e.push(l),this.tileCache.add(a,l))},i.findParentTile=function(e,t){return this._findParentTile(e,t)},i._findParentTile=function(e,t){var i=this.getMap(),n=this._getLayerOfTile(e.layer);if(!n||!n.options.background&&!n.options.terrainTileMode)return null;var r=n.getMinZoom(),s=t||e.z-r;if(n._isPyramidMode()){for(var o=e.z-s,a=e.z-1;a>=o;a--){var l,c=Math.pow(2,e.z-a),h=Math.floor(e.x/c),u=Math.floor(e.y/c);l=a===e.z-1?e.parent:n._getTileId(h,u,a,e.layer);var d=this.tileCache.getAndRemove(l);if(d&&this.isValidCachedTile(d))return this.tileCache.add(l,d),d}return null}for(var p=n.getSpatialReference(),m=p.getZoomDirection(),f=e.res,g=e.extent2d.getCenter(),_=n._project(i._pointToPrjAtRes(g,f)),y=1;y<=s;y++){var v=e.z-m*y,x=p.getResolution(v);if(x){var b=n._getTileConfig().getTileIndex(_,x),w=n._getTileId(b.x,b.y,v,e.layer),C=this.tileCache.getAndRemove(w);if(C)return this.tileCache.add(w,C),C}}return null},i.isValidCachedTile=function(e){return!!e.image},i.isTileComplete=function(){return!0},i._getLayerOfTile=function(e){return this.layer.getChildLayer?this.layer.getChildLayer(e):this.layer},i.getCachedTile=function(e,t){var i=e.id,n=this.tilesInView,r=this.tileCache.getAndRemove(i);if(r){t||(n[i]=r);var s=this.tilesLoading;if(s&&s[i]){this.markCurrent(s[i],!1);var o=s[i];this.abortTileLoading(o.image,o.info),delete s[i]}}else r=n[i];return r&&(r.current=!0,this.isValidCachedTile(r)&&this.tileCache.add(i,r)),r},i._addTileToCache=function(e,t){this.isValidCachedTile({info:e,image:t})&&(this.tilesInView[e.id]={image:t,current:!0,info:e})},i.getTileOpacity=function(e,t){var i=this._getTileFadingOpacity(e);if(this.layer.getChildLayer){var n=this.layer.getLayer(t.layer);n&&(i*=n.options.opacity)}return i},i._getTileFadingOpacity=function(e){return this.layer.options.fadeAnimation&&e.loadTime?Math.min(1,(cP()-e.loadTime)/this.layer.options.fadeDuration):1},i.onRemove=function(){this.clear(),delete this.tileCache,delete this._tilePlaceHolder,delete this._tileZoom,e.prototype.onRemove.call(this)},i.markCurrent=function(e,t){e.current=t},i.markTiles=function(){var e=0,t=0;if(this.tilesLoading)for(var i in this.tilesLoading)this.markCurrent(this.tilesLoading[i],!1),e++;if(this.tilesInView)for(var n in this.tilesInView)this.markCurrent(this.tilesInView[n],!1),t++;return[e,t]},i.retireTiles=function(e){for(var t in this.tilesLoading){var i=this.tilesLoading[t];!e&&i.current||(i.image&&this.abortTileLoading(i.image,i.info),this.deleteTile(i),this.removeTileLoading(i.info))}for(var n in this.tilesInView){var r=this.tilesInView[n];r.current||(delete this.tilesInView[n],this.tileCache.has(n)||this.deleteTile(r))}},i.deleteTile=function(e){if(e&&e.image){var t=e.info.id;this._tileQueueIds.has(t)&&this._tileQueueIds.delete(t),e.image.close&&e.image.close(),e.image instanceof Image&&(e.image.onload=null,e.image.onerror=null)}},i._generatePlaceHolder=function(e){var t=this.getMap(),i=this.layer.options.placeholder;if(!i||t.getPitch())return null;var n=this.layer.getTileSize(),r=e/t._getResolution(),s=this._tilePlaceHolder=this._tilePlaceHolder||YA.createCanvas(1,1,t.CanvasClass);return s.width=n.width*r,s.height=n.height*r,gP(i)?i(s):function(e){var t=e.getContext("2d"),i=e.width,n=e.height,r=i/16,s=n/16;t.beginPath();for(var o=0;o<16;o++)t.moveTo(0,o*s),t.lineTo(i,o*s),t.moveTo(o*r,0),t.lineTo(o*r,n);t.strokeStyle="rgba(180, 180, 180, 0.1)",t.lineWidth=1,t.stroke(),t.beginPath();for(var a=[[0,0],[i,0],[0,n],[i,n],[0,0],[0,n],[i,0],[i,n],[0,n/2],[i,n/2],[i/2,0],[i/2,n]],l=1;l<a.length;l+=2)t.moveTo(a[l-1][0],a[l-1][1]),t.lineTo(a[l][0],a[l][1]);t.lineWidth=4,t.stroke()}(s),s},i.setTerrainHelper=function(e){this._terrainHelper=e},t}(bR);function eB(){return!1}function tB(e,t){return Math.abs(this._tileZoom-e.info.z)-Math.abs(this._tileZoom-t.info.z)}iL.registerRenderer("canvas",QL);var iB=new uM(0,0),nB={properties:{}},rB=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.isDrawable=function(){return!0},i.needToRedraw=function(){var t=this.getMap();return!(!this.isGL()||t.getPitch()||!t.isZooming()||t.isMoving()||t.isRotating())||e.prototype.needToRedraw.call(this)},i.onDrawTileStart=function(e,t){var i=this.gl;if(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.enable(i.POLYGON_OFFSET_FILL),i.enable(i.STENCIL_TEST),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),i.depthMask(!!this.layer.options.depthMask),t&&t.renderTarget){var n=t.renderTarget.fbo;if(n){var r=t.renderTarget.getFramebuffer(n);i.bindFramebuffer(i.FRAMEBUFFER,r)}}},i.onDrawTileEnd=function(e,t){var i=this.gl;t&&t.renderTarget&&t.renderTarget.fbo&&i.bindFramebuffer(i.FRAMEBUFFER,null)},i.drawTile=function(t,i,n){if(!n||!n.sceneFilter||n.sceneFilter(nB)){var r=this.getMap();if(t&&r&&i){var s=t._glScale=t._glScale||t.res/r.getGLRes(),o=t.extent2d.xmax-t.extent2d.xmin,a=t.extent2d.ymax-t.extent2d.ymin;if(!1!==t.cache&&this._bindGLBuffer(i,o,a),this.isGL()){var l=t.offset,c=iB.set(t.extent2d.xmin-l[0],t.extent2d.ymax-l[1]),h=c.x*s,u=c.y*s,d=this.getTileOpacity(i,t),p=null;this.layer.options.debug&&(p=this.getDebugInfo(t.id));var m=this.gl;m.stencilFunc(m.LEQUAL,Math.abs(this.getCurrentTileZoom()-t.z),255);var f=this.layer.getPolygonOffset(),g=this.drawingCurrentTiles?f:f+1;m.polygonOffset(g,g),this.drawGLImage(i,h,u,o,a,s,d,p),this._getTileFadingOpacity(i)<1?this.setToRedraw():this.setCanvasUpdated()}else e.prototype.drawTile.call(this,t,i)}}},i._bindGLBuffer=function(e,t,i){e.glBuffer||(e.glBuffer=this.bufferTileData(0,0,t,i))},i.loadTileImage=function(e,t){var i=this.layer.options.crossOrigin;e.crossOrigin=null!==i?i:"",e.src=t},i.onCanvasCreate=function(){this.canvas.gl&&this.canvas.gl.wrap||this.createCanvas2()},i.createContext=function(){e.prototype.createContext.call(this),this.createGLContext()},i.resizeCanvas=function(t){this.canvas&&(e.prototype.resizeCanvas.call(this,t),this.resizeGLCanvas())},i.clearCanvas=function(){this.canvas&&(e.prototype.clearCanvas.call(this),this.clearGLCanvas())},i.getCanvasImage=function(){if(!this.isGL()||!this.canvas2)return e.prototype.getCanvasImage.call(this);var t=e.prototype.getCanvasImage.call(this);return t&&(t.image=this.canvas2),t},i.isGL=function(){if(this.canvas.gl&&this.canvas.gl.wrap)return!0;var e=this.getMap();return e&&(e.getPitch()||e.getBearing())||this.layer&&!!this.layer.options.fragmentShader},i.deleteTile=function(t){e.prototype.deleteTile.call(this,t),t&&t.image&&this.disposeImage(t.image),delete t.image},i.onRemove=function(){e.prototype.onRemove.call(this),this.removeGLCanvas()},t}(wL(QL));function sB(e){var t=this.layer.getTileSize(),i=this.canvas.constructor,n=this.getMap(),r=n.getDevicePixelRatio(),s=YA.createCanvas(t.width*r,t.height*r,i);s.layer=this.layer;var o=this,a=new uM(e.extent2d.xmin,e.extent2d.ymax),l=new OI(n.pointToCoordinate(a),n.pointToCoordinate(a.add(t.width,t.height)),n.getProjection());return this.layer.drawTile(s,{url:e.url,point:a,center:n.pointToCoordinate(a.add(t.width/2,t.height/2)),extent:l,z:e.z,x:e.x,y:e.y},(function(t){t?o.onTileError(s,e):o.onTileLoad(s,e)})),s}iL.registerRenderer("gl",rB);var oB=function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.prototype.loadTile=function(){return sB.apply(this,arguments)},t}(QL),aB=function(e){function t(){return e.apply(this,arguments)||this}return tM(t,e),t.prototype.loadTile=function(){return sB.apply(this,arguments)},t}(rB);dL.registerRenderer("canvas",oB),dL.registerRenderer("gl",aB);var lB,cB="undefined"!=typeof Int8Array?new Int8Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]):[];(lB=(function(e,t,i){var n;this.gl=e,this.quadVertices=t||cB,this.attributes=["a_position",3,(n=t,n instanceof Float32Array?"FLOAT":n instanceof Int16Array?"SHORT":n instanceof Uint16Array?"UNSIGNED_SHORT":n instanceof Int8Array?"BYTE":n instanceof Uint8Array||n instanceof Uint8ClampedArray?"UNSIGNED_BYTE":"FLOAT")],this.debug=i}).prototype).start=function(){var e=this.gl;e.enable(e.STENCIL_TEST),e.stencilMask(255),e.stencilOp(e.KEEP,e.REPLACE,e.REPLACE),e.depthMask(!1),this._save(),this.buffer||(this._createBuffer(),this._createProgram()),e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),fL(e,this.program,this.attributes),this.transformLoc||(this.transformLoc=e.getUniformLocation(this.program,"transform")),this.colorLoc||(this.colorLoc=e.getUniformLocation(this.program,"color")),this.debug||e.colorMask(!1,!1,!1,!1)},lB.end=function(){var e=this.gl;e.depthMask(!0),this._restore(),this.debug||e.colorMask(!0,!0,!0,!0)},lB.draw=function(e){var t=this.gl;t.uniformMatrix4fv(this.transformLoc,!1,e),t.uniform3fv(this.colorLoc,[Math.random(),Math.random(),Math.random()]),t.drawArrays(t.TRIANGLE_STRIP,0,4)},lB.remove=function(){var e=this.gl;return this.buffer&&e.deleteBuffer(this.buffer),this.program&&(e.deleteShader(this.program.fragmentShader),e.deleteShader(this.program.vertexShader),e.deleteProgram(this.program)),delete this.transformLoc,delete this.gl,this},lB.stencilMask=function(e){return this.gl.stencilMask(e),this},lB.stencilFunc=function(e,t,i){return this.ref=t,this.gl.stencilFunc(e,t,i),this},lB.stencilOp=function(e,t,i){return this.gl.stencilOp(e,t,i),this},lB.resetFunc=function(){return this.ref=1,this.gl.stencilFunc(this.gl.ALWAYS,1,255),this},lB._save=function(){this._savedProgram=this.gl.program},lB._restore=function(){var e=this.gl;e.program=this._savedProgram,e.program&&e.useProgram(e.program)},lB._createBuffer=function(){var e=this.gl;if(this.buffer=e.createBuffer(),!this.buffer)throw new Error("Failed to create the buffer object");e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.quadVertices,e.STATIC_DRAW)},lB._createProgram=function(){var e=mL(this.gl,"\n    attribute vec3 a_position;\n    uniform mat4 transform;\n\n    void main()\n    {\n        gl_Position = transform * vec4(a_position, 1.0);\n    }\n","\n    precision mediump float;\n    uniform vec3 color;\n    void main()\n    {\n        gl_FragColor = vec4(color, 1.0);\n    }\n"),t=e.program,i=e.fragmentShader;t.vertexShader=e.vertexShader,t.fragmentShader=i,this.program=t};var hB=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.checkResources=function(){var e=this._geosToCheck||[];if(!this._resourceChecked&&this.layer._geoList&&_M(e,this.layer._geoList),!EM(e))return[];for(var t=[],i={},n=e.length-1;n>=0;n--){var r=e[n]._getExternalResources();if(r.length)if(this.resources)for(var s=0;s<r.length;s++){var o=r[s][0];this.resources.isResourceLoaded(r[s])||i[o]||(t.push(r[s]),i[o]=1)}else t.push.apply(t,r)}return this._resourceChecked=!0,delete this._geosToCheck,t},i.render=function(){return this.layer._sortGeometries(),e.prototype.render.apply(this,arguments)},i._addGeoToCheckRes=function(e){e&&(Array.isArray(e)||(e=[e]),this._geosToCheck||(this._geosToCheck=[]),_M(this._geosToCheck,e))},i.onGeometryAdd=function(e){this._addGeoToCheckRes(e),uB(this)},i.onGeometryRemove=function(){uB(this)},i.onGeometrySymbolChange=function(e){this._addGeoToCheckRes(e.target),uB(this)},i.onGeometryShapeChange=function(){uB(this)},i.onGeometryPositionChange=function(){uB(this)},i.onGeometryZIndexChange=function(){uB(this)},i.onGeometryShow=function(){uB(this)},i.onGeometryHide=function(){uB(this)},i.onGeometryPropertiesChange=function(){uB(this)},t}(bR);function uB(e){e.layer.options.drawImmediate&&e.render(),e.setToRedraw()}var dB=new DI,pB=[],mB=new DI,fB=new mI;function gB(e){if(!e)return null;var t=e.getContext("2d");return t.clearRect(0,0,e.width,e.height),t}function _B(e){return e&&e.options.progressiveRender&&e.options.progressiveRenderDebug}var yB=function(e){function t(){return e.apply(this,arguments)||this}tM(t,e);var i=t.prototype;return i.setToRedraw=function(){return e.prototype.setToRedraw.call(this),this._resetProgressiveRender(),this},i._geoIsCollision=function(e,t){if(!e)return!1;if(!e.options.collision)return!1;if(e.isPoint&&e.getContainerExtent){e.bbox||(e.bbox=[0,0,0,0]);var i=this.layer.options.collisionBufferSize,n=e.getContainerExtent();if(!n)return!1;if(e.bbox[0]=n.xmin-i,e.bbox[1]=n.ymin-i,e.bbox[2]=n.xmax+i,e.bbox[3]=n.ymax+i,t.collides(e.bbox))return!0;t.insertBox(e.bbox)}return!1},i.getImageData=function(){if(!this._lastRenderTime||cP()-this._lastRenderTime<32)return null;if(!this.context||!this.context.canvas)return null;if(!this._imageData){var e=this.context.canvas,t=e.width,i=e.height;try{this._imageData=this.context.getImageData(0,0,t,i)}catch(n){console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",n)}}return this._imageData},i.clearImageData=function(){this._imageData=null,delete this._imageData,this._lastRenderTime=cP()},i.checkResources=function(){var t=this,i=e.prototype.checkResources.apply(this,arguments),n=this.layer.getStyle();return n&&(Array.isArray(n)||(n=[n]),n.forEach((function(e){for(var n=vk(e.symbol,!0),r=0,s=n.length;r<s;r++)t.resources.isResourceLoaded(n[r])||i.push(n[r])}))),i},i.needToRedraw=function(){if(this.isProgressiveRender()&&!this.renderEnd)return!0;var t=this.getMap();return!(!t.isInteracting()||!this.layer.options.enableAltitude)||!(t.isZooming()&&!t.isRotating()&&!t.getPitch()&&!this._hasPoint&&this.layer.constructor===hD)&&e.prototype.needToRedraw.call(this)},i.draw=function(){if(this.getMap()){if(!this.layer.isVisible()||this.layer.isEmpty())return this.clearCanvas(),void this.completeRender();this.prepareCanvas(),this.drawGeos(),this.completeRender()}},i.isBlank=function(){return!!this.context&&!this.isProgressiveRender()&&!this.context.canvas._drawn},i.drawOnInteracting=function(){if(this._geosToDraw){this._updateMapStateCache(),this._updateDisplayExtent();var e=this.getMap(),t=this.layer.getCount(),i=this.mapStateCache.resolution;(e.isZooming()&&e.options.seamlessZoom&&void 0!==this._drawnRes&&i>1.5*this._drawnRes&&this._geosToDraw.length<t||e.isMoving()||e.isInteracting())&&(this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this._checkGeos(),this._drawnRes=i),this._sortByDistanceToCamera(e.cameraPosition);var n=this.layer.options,r=n.collisionDelay;if(n.collision){var s=cP();this._lastCollisionTime||(this._lastCollisionTime=s),s-this._lastCollisionTime<=r?this._geosToDraw=this._lastGeosToDraw||this._geosToDraw:(this._collidesGeos(),this._lastCollisionTime=s)}for(var o=0,a=this._geosToDraw.length;o<a;o++){var l=this._geosToDraw[o];l._isCheck||l.isVisible()?(l._paint(this._displayExtent),this._geosToDraw[o]._cPoint=void 0,this._geosToDraw[o]._inCurrentView=void 0):(delete l._cPoint,delete l._inCurrentView)}this.clearImageData(),this._lastGeosToDraw=this._geosToDraw,_B(this.layer)&&console.log("progressiveRender on drawOnInteracting page:",this.page)}},i.show=function(){this.layer.forEach((function(e){e._repaint()})),e.prototype.show.apply(this,arguments)},i.forEachGeo=function(e,t){this.layer.forEach(e,t)},i._checkGeos=function(){for(var e=this._getCurrentNeedRenderGeos(),t=0,i=e.length;t<i;t++)this.checkGeo(e[t]);return this},i.drawGeos=function(){this._drawSnapshot(),this._updateMapStateCache(),this._drawnRes=this.mapStateCache.resolution,this._updateDisplayExtent(),this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this._checkGeos(),this._sortByDistanceToCamera(this.getMap().cameraPosition),this._collidesGeos();for(var e=0,t=this._geosToDraw.length;e<t;e++)this._geosToDraw[e]._paint(),this._geosToDraw[e]._cPoint=void 0,this._geosToDraw[e]._inCurrentView=void 0;this.clearImageData(),this._lastGeosToDraw=this._geosToDraw,_B(this.layer)&&console.log("progressiveRender drawGeos page:",this.page),this._snapshot(),this._setDrawGeosDrawTime()},i.prepareToDraw=function(){return this.layer._drawTime=cP(),this._hasPoint=!1,this._geosToDraw=[],this},i._setDrawGeosDrawTime=function(){for(var e=cP(),t=this.layer._drawTime,i=this.getGeoPainterList(),n=0,r=i.length;n<r;n++){var s=i[n];s&&s._setDrawTime&&s._setDrawTime(t)}return _B(this.layer)&&console.log("_setDrawGeosDrawTime time:",cP()-e+"ms"),this},i.checkGeo=function(e){if(e.isPoint&&void 0!==this._onlyHasPoint)e._inCurrentView&&(this._hasPoint=!0,e._isCheck=!0,this._geosToDraw.push(e));else if(e._isCheck=!1,e&&e.isVisible()&&e.getMap()&&e.getLayer()&&e.getLayer().isCanvasRender()){var t=e._getPainter(),i=!0;if(e._inCurrentView)i=!0;else if(!1===e._inCurrentView)i=!1;else{var n=t.get2DExtent(this.resources,dB);n&&n.intersects(this._displayExtent)||(i=!1)}i&&(t.hasPoint()&&(this._hasPoint=!0),e._isCheck=!0,this._geosToDraw.push(e))}},i._collidesGeos=function(){if(!this.layer.options.collision)return this;var e=this.layer.options.collisionScope,t=this.layer.getMap(),i="map"===e?t.getCollisionIndex():fB;i===fB&&i.clear();var n=this._geosToDraw;this._geosToDraw=[];for(var r=0,s=n.length;r<s;r++)this._geoIsCollision(n[r],i)||this._geosToDraw.push(n[r]);return this},i.onZoomEnd=function(){delete this.canvasExtent2D,e.prototype.onZoomEnd.apply(this,arguments)},i.onRemove=function(){this.forEachGeo((function(e){e.onHide()})),delete this._geosToDraw,delete this.snapshotCanvas,delete this.pageGeos,delete this.geoPainterList},i.onGeometryPropertiesChange=function(t){t&&this.layer._styleGeometry(t.target),e.prototype.onGeometryPropertiesChange.call(this,t)},i._updateDisplayExtent=function(){var e=this.canvasExtent2D;if(this._maskExtent){if(!this._maskExtent.intersects(e))return void this.completeRender();e=e.intersection(this._maskExtent)}this._displayExtent=e},i.identifyAtPoint=function(e,t){void 0===t&&(t={});var i=this.getGeosForIdentify();return i?this.layer._hitGeos(i,e,t):[]},i._updateMapStateCache=function(){var e=this.getMap(),t=e._pointToContainerPoint(this.southWest)._add(0,-e.height),i=e.getResolution(),n=e.getPitch(),r=e.getBearing(),s=e.getGLScale(),o=e.getGLRes(),a=e.getContainerExtent(),l=e._get2DExtent(),c=e._get2DExtentAtRes(o);return this.mapStateCache={resolution:i,pitch:n,bearing:r,glScale:s,glRes:o,_2DExtent:l,glExtent:c,containerExtent:a,offset:t},this},i._batchConversionMarkers=function(e){if(this._onlyHasPoint=void 0,!this._constructorIsThis())return[];var t=[],i=[],n=[],r={},s=this.layer,o=s.options,a=s.getAltitude?s.getAltitude():0,l=s.isCanvasRender();this._onlyHasPoint=!0;for(var c=0,h=this._getCurrentNeedRenderGeos(),u=0,d=h.length;u<d;u++){var p=h[u];if(p.isPoint){var m=p._painter;m||(m=p._getPainter());var f=m.getRenderPoints("center")[0][0],g=o.enableAltitude?p._getAltitude():a;void 0===r[g]&&(r[g]=m.getAltitude()),t[c]=f,n[c]=r[g],i[c]=p,c++}else this._onlyHasPoint=!1}if(0===c)return[];var _=this.getMap(),y=NM(t,"_pt");y=_._pointsAtResToContainerPoints(t,e,n,y);for(var v=_.getContainerExtent(),x=v.xmax,b=v.ymax,w=v.xmin,C=v.ymin,S={},E=0,T=i.length;E<T;E++){var P=i[E];if(P._cPoint=y[E],P._cPoint){var M=y[E],k=M.x,A=M.y;if(P._inCurrentView=k>=w&&A>=C&&k<=x&&A<=b,!P._inCurrentView){var I,R=P.getSymbolHash();I=R?S[R]=S[R]||P._painter.getFixedExtent():P._painter.getFixedExtent(),mB.set(I.xmin,I.ymin,I.xmax,I.ymax),mB._add(y[E]),P._inCurrentView=mB.intersects(v)}P._inCurrentView&&(P.isVisible()&&l||(P._inCurrentView=!1),this._onlyHasPoint&&P._inCurrentView&&(this._hasPoint=!0,P._isCheck=!0,this._geosToDraw.push(P)))}else P._inCurrentView=!1}return y},i._sortByDistanceToCamera=function(e){if(this.layer.options.sortByDistanceToCamera&&this._geosToDraw.length){var t=this.getMap(),i=t.distanceToPoint(1e3,0,t.getGLScale()).x/1e3;this._geosToDraw.sort((function(t,n){if(!t.isPoint||!n.isPoint)return 0;var r=t._painter,s=n._painter;if(!r||!s)return 0;var o=r.getRenderPoints("center")[0][0],a=s.getRenderPoints("center")[0][0],l=r.getAltitude()*i,c=s.getAltitude()*i;MD(pB,o.x,o.y,l);var h=OD(pB,e);return MD(pB,a.x,a.y,c),OD(pB,e)-h}))}},i._constructorIsThis=function(){return this.constructor===t},i.isProgressiveRender=function(){var e=this.layer;if(!e)return!1;var t=e.options||{};return!t.collision&&t.progressiveRender},i.getGeosForIdentify=function(){return this.isProgressiveRender()?this.pageGeos||[]:this._geosToDraw||[]},i.getGeoPainterList=function(){if(!this.isProgressiveRender()){for(var e=[],t=this._geosToDraw||[],i=0,n=t.length;i<n;i++)e.push(t[i]._painter);return e}return this.geoPainterList||[]},i._checkSnapshotCanvas=function(){if(!this.isProgressiveRender())return delete this.snapshotCanvas,null;var e=this.canvas;if(!e)return delete this.snapshotCanvas,null;this.snapshotCanvas||(this.snapshotCanvas=YA.createCanvas(1,1));var t=this.snapshotCanvas,i=e.width,n=e.height,r=e.style;return t.width===i&&t.height===n||(t.width=i,t.height=n),t.style.width===r.width&&t.style.height===r.height||(t.style.width=r.width,t.style.height=r.height),t},i._getCurrentNeedRenderGeos=function(){var e=this.layer._geoList||[];if(!this.isProgressiveRender())return e;if(this.renderEnd)return[];var t=this.layer.options.progressiveRenderCount,i=this.page;return e.slice((i-1)*t,i*t)},i._resetProgressiveRender=function(){_B(this.layer)&&console.log("progressiveRender resetProgressiveRender"),this.renderEnd=!1,this.page=1,this.pageGeos=[],this.geoPainterList=[],this.maxTolerance=0,this._clearSnapshotCanvas()},i._clearSnapshotCanvas=function(){var e=this._checkSnapshotCanvas();e&&gB(e)},i._snapshot=function(){for(var e=this.isProgressiveRender(),t=this._geosToDraw||[],i=0,n=t.length;i<n;i++){var r=t[i],s=r._hitTestTolerance()||0;this.maxTolerance=Math.max(this.maxTolerance,s),e&&(this.pageGeos.push(r),this.geoPainterList.push(r._painter))}if(!e)return this;var o=cP(),a=this._checkSnapshotCanvas();a&&this.canvas&&gB(a).drawImage(this.canvas,0,0);var l=this.layer,c=Math.ceil((l._geoList||[]).length/l.options.progressiveRenderCount);return this.renderEnd=this.page>=c,this.renderEnd&&this._setDrawGeosDrawTime(),_B(this.layer)&&console.log("snapshot time:",cP()-o+"ms"),this.page++,this},i._drawSnapshot=function(){if(!this.isProgressiveRender())return this;var e=this.snapshotCanvas,t=this.context;if(!e||!t)return this;var i=this.getMap();if(!i)return this;var n=i.getDevicePixelRatio()||1,r=1/n;return t.scale(r,r),t.drawImage(e,0,0),t.scale(n,n),this},t}(hB);hD.registerRenderer("canvas",yB);var vB=function(e){function t(t){var i;return(i=e.call(this,t)||this)._containerIsCanvas=!!t._containerDOM.getContext,i._registerEvents(),i._loopTime=0,i._resizeEventList=[],i._resizeTime=-1/0,i}tM(t,e);var i=t.prototype;return i.load=function(){this.initContainer()},i.renderFrame=function(e){var t=this.map;if(!t||!t.options.renderable)return!1;if(this._handleResizeEventList(e),t.options.stopRenderOnOffscreen&&this._containerIsOffscreen())return!0;this._updateDomPosition(e),delete this._isViewChanged,t._fireEvent("framestart"),this.updateMapDOM(),t.clearCollisionIndex();var i=this._getAllLayerToRender();return this.drawLayers(i,e),this.drawLayerCanvas(i)&&(this.drawTops(),this._drawCenterCross(),t.options.debugSky&&this._debugSky()),this._needClear=!1,t._fireEvent("frameend"),this._recordView(),this._mapview=this._getMapView(),delete this._spatialRefChanged,this._fireLayerLoadEvents(),this.executeFrameCallbacks(),this._canvasUpdated=!1,t.uiCollides(),!0},i.updateMapDOM=function(){var e=this.map;if(!e.isZooming()){var t=e._getViewPointFrameOffset();t?e.offsetPlatform(t):this.domChanged()&&this.offsetPlatform(null,!0)}},i.drawLayers=function(e,t){for(var i=this.map,n=i.isInteracting(),r=[],s=[],o=i.options.fpsOnInteracting||0,a=0===o?0:1e3/o,l=this.map.options.layerCanvasLimitOnInteracting,c=e.length,h=i.getBaseLayer(),u=0,d=0;d<c;d++){var p=e[d];if(p.isVisible()){var m=p.isCanvasRender();m&&r.push(p.getId());var f=p._getRenderer();if(f){var g=this._checkLayerRedraw(p);m&&f.isCanvasUpdated()&&(g||s.push(p.getId()),this.setLayerCanvasUpdated());var _=f.__zoomTransformMatrix;if(delete f.__zoomTransformMatrix,g){if(n&&m){if(l>0&&c-1-d>l&&p!==h){p._getRenderer().clearCanvas();continue}u+=this._drawCanvasLayerOnInteracting(p,u,a,t)}else n&&f.drawOnInteracting?(f.prepareRender&&f.prepareRender(),f.checkAndDraw?f.checkAndDraw(f.drawOnInteracting,this._eventParam,t):f.drawOnInteracting(this._eventParam,t)):(f.render(t),m&&_&&f.isLoadingResource()&&(f.__zoomTransformMatrix=_));m&&(s.push(p.getId()),this.setLayerCanvasUpdated())}else m&&n&&(i.isZooming()&&!i.getPitch()?(f.prepareRender(),f.__zoomTransformMatrix=this._zoomMatrix):(i.getPitch()||i.isRotating())&&f.clearCanvas())}}}var y=this._canvasIds||[],v=this._updatedIds||[];this._canvasIds=r,this._updatedIds=s,this.isLayerCanvasUpdated()||y.join("---")===r.join("---")&&v.join("---")===s.join("---")||this.setLayerCanvasUpdated()},i._checkLayerRedraw=function(e){if(this.isSpatialReferenceChanged())return!0;var t=this.map,i=e._getRenderer();return e.isCanvasRender()?i.testIfNeedRedraw():!(!i.needToRedraw||!i.needToRedraw())||t.isInteracting()||this.isViewChanged()},i._drawCanvasLayerOnInteracting=function(e,t,i,n){var r=this.map,s=e._getRenderer(),o=s.getDrawTime(),a=0===i||i>0&&t+o<=i;if(s.mustRenderOnInteracting&&s.mustRenderOnInteracting())s.render(n);else{if(s.drawOnInteracting&&(e===r.getBaseLayer()||a||r.isZooming()&&e.options.forceRenderOnZooming||r.isMoving()&&e.options.forceRenderOnMoving||r.isRotating()&&e.options.forceRenderOnRotating))return s.prepareRender(),s.prepareCanvas(),s.checkAndDraw?s.checkAndDraw(s.drawOnInteracting,this._eventParam,n):s.drawOnInteracting(this._eventParam,n),o;!r.isZooming()||r.getPitch()||r.isRotating()?(r.getPitch()||r.isRotating())&&s.clearCanvas():(s.prepareRender(),s.__zoomTransformMatrix=this._zoomMatrix)}return s.drawOnInteracting&&!a&&s.onSkipDrawOnInteracting(this._eventParam,n),0},i._fireLayerLoadEvents=function(){if(this._updatedIds&&this._updatedIds.length>0){var e=this.map;this._updatedIds.reverse().forEach((function(t){var i=e.getLayer(t);if(i){var n=i._getRenderer();n&&n.isRenderComplete()&&i.fire("layerload")}}))}},i.isLayerCanvasUpdated=function(){return this._canvasUpdated},i.setLayerCanvasUpdated=function(){this._canvasUpdated=!0},i.drawLayerCanvas=function(e){var t=this.map;if(!t)return!1;if(!this.isLayerCanvasUpdated()&&!this.isViewChanged()&&!1===this._needClear)return!1;this.canvas||this.createCanvas(),t._fireEvent("renderstart",{context:this.context}),this._updateCanvasSize()||this.clearCanvas();for(var i,n=t.isInteracting(),r=t.options.layerCanvasLimitOnInteracting,s=e.length,o=[],a=0;a<s;a++)if(e[a].isVisible()&&e[a].isCanvasRender()&&e[a]._getRenderer()){var l=this._getLayerImage(e[a]);l&&l.image&&(e[a]===t.getBaseLayer()?i=[e[a],l]:o.push([e[a],l]))}var c=this.canvas.width,h=this.canvas.height;i&&(this._drawLayerCanvasImage(i[0],i[1],c,h),this._drawFog()),s=o.length;for(var u=n&&r>=0&&s>r?s-r:0;u<s;u++)this._drawLayerCanvasImage(o[u][0],o[u][1],c,h);return t._fireEvent("renderend",{context:this.context}),!0},i.setToRedraw=function(){var e=this._getAllLayerToRender();this._needClear=!0;for(var t=0,i=e.length;t<i;t++){var n=e[t].getRenderer();n&&n.canvas&&n.setToRedraw&&n.setToRedraw()}},i.updateMapSize=function(e){if(e&&!this._containerIsCanvas){var t=e.height+"px",i=this.map._panels;i.mapWrapper.style.width=e.width+"px",i.mapWrapper.style.height=t,this._updateCanvasSize()}},i.getMainPanel=function(){return this.map?this._containerIsCanvas?this.map._containerDOM:this.map._panels?this.map._panels.mapWrapper:null:null},i.toDataURL=function(e,t){return this.canvas?this.canvas.toDataURL(e,t):null},i.remove=function(){QP.webgl&&"undefined"!=typeof document&&(oI.off("dprchange",this._thisDocDPRChange,this),oI.off("docvisibilitychange",this._thisDocVisibilitychange,this),oI.off("dragstart",this._thisDocDragStart,this),oI.off("dragend",this._thisDocDragEnd,this)),this._resizeInterval&&clearInterval(this._resizeInterval),this._resizeObserver&&this._resizeObserver.disconnect(),delete this.context,delete this.canvas,delete this.map,delete this._spatialRefChanged,this._cancelFrameLoop()},i.hitDetect=function(e){var t=this.map;if(t&&t.options.hitDetect&&!t.isInteracting()){var i=t._getLayers(),n="default",r=t.options.hitDetectLimit||0,s=0;e&&e._round&&e._round();for(var o=i.length-1;o>=0;o--){var a=i[o];if(!(!a.options.hitDetect||a.isEmpty&&a.isEmpty())&&a.options.geometryEvents){var l=a._getRenderer();if(l&&l.hitDetect&&(!l.isBlank||!l.isBlank())){if("default"!==a.options.cursor&&l.hitDetect(e)){n=a.options.cursor||"pointer";break}if(s++,r>0&&s>r)break}}}t._trySetCursor(n)}},i._getLayerImage=function(e){var t=e._getRenderer();return t.getCanvasImage?t.getCanvasImage():null},i.initContainer=function(){var e=this.map._panels;function t(t,i,n,r){var s,o=Xk("div",i);return n&&(o.style.cssText=n),e[t]=o,r||((s=o).onselectstart=function(){return!1},s.ondragstart=function(){return!1},s.setAttribute("unselectable","on")),o}var i=this.map._containerDOM;if(!this._containerIsCanvas){i.innerHTML="";var n="position:absolute;top:0px;left:0px;",r=t("mapWrapper","maptalks-wrapper","position:absolute;overflow:hidden;",!0),s=t("allLayers","maptalks-all-layers",n+"padding:0px;margin:0px;z-index:0;overflow:visible;",!0),o=t("backStatic","maptalks-back-static",n+"z-index:0;",!0),a=t("back","maptalks-back",n+"z-index:1;"),l=t("backLayer","maptalks-back-layer",n),c=t("canvasContainer","maptalks-canvas-layer",n+"border:none;z-index:2;"),h=t("frontStatic","maptalks-front-static",n+"z-index:3;",!0),u=t("front","maptalks-front",n+"z-index:4;",!0),d=t("frontLayer","maptalks-front-layer",n+"z-index:0;"),p=t("ui","maptalks-ui",n+"border:none;z-index:1;",!0),m=t("control","maptalks-control","z-index:1",!0);i.appendChild(r),s.appendChild(o),a.appendChild(l),a.layerDOM=l,s.appendChild(a),s.appendChild(c),u.appendChild(d),u.layerDOM=d,u.uiDOM=p,s.appendChild(h),s.appendChild(u),u.appendChild(p),r.appendChild(s),r.appendChild(m),this.createCanvas(),this.resetContainer();var f=this.map._getContainerDomSize();this.updateMapSize(f)}},i.isViewChanged=function(){if(void 0!==this._isViewChanged)return this._isViewChanged;var e=this._mapview,t=this._getMapView();return this._isViewChanged=!e||!IM(e,t),this._isViewChanged},i._recordView=function(){var e=this.map;!e._onViewChange||e.isInteracting()||e.isAnimating()||IM(e.getView(),e._getCurrentView())||e._onViewChange(e.getView())},i.isSpatialReferenceChanged=function(){return this._spatialRefChanged},i._getMapView=function(){var e=this.map,t=e._getPrjCenter();return{x:t.x,y:t.y,zoom:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),width:e.width,height:e.height}},i._frameLoop=function(e){var t=this;this.map?(this._frameTimestamp=e=e||0,this._resizeCount=0,this.renderFrame(e),this._animationFrame=lM((function(e){t._frameLoop(e)}))):this._cancelFrameLoop()},i._cancelFrameLoop=function(){this._animationFrame&&cM(this._animationFrame)},i._drawLayerCanvasImage=function(e,t,i,n){var r=this.context,s=t.point.round(),o=this.map.getDevicePixelRatio();1!==o&&s._multi(o);var a=t.image,l=a.width,c=a.height;if(!(s.x+l<=0||s.y+c<=0)){var h=e.options.opacity;if(dP(h)||(h=1),!(h<=0)){var u=t.opacity;if(dP(u)||(u=1),!(u<=0)){var d=r.globalAlpha;h<1&&(r.globalAlpha*=h),u<1&&(r.globalAlpha*=u),e.options.cssFilter&&(r.filter=e.options.cssFilter);var p=e.getRenderer(),m=p.__zoomTransformMatrix,f=p.clipCanvas(this.context);m&&(r.save(),r.setTransform.apply(r,m)),r.drawImage(a,0,0,l,c,s.x,s.y,i,n),m&&r.restore(),f&&r.restore(),"none"!==r.filter&&(r.filter="none"),r.globalAlpha=d}}}},i._drawCenterCross=function(){var e=this.map.options.centerCross;if(e){var t=this.context,i=new uM(this.canvas.width/2,this.canvas.height/2);gP(e)?e(t,i):YA.drawCross(this.context,i.x,i.y,2,"#f00")}},i._drawContainerExtent=function(){var e=this.map.options.cascadePitches,t=this.map.height-this.map._getVisualHeight(e[0]),i=this.map.height-this.map._getVisualHeight(e[1]),n=this.map.getContainerExtent(),r=this.context;r.beginPath(),r.moveTo(0,n.ymin),r.lineTo(n.xmax,n.ymin),r.stroke(),r.beginPath(),r.moveTo(0,t),r.lineTo(n.xmax,t),r.stroke(),r.beginPath(),r.moveTo(0,i),r.lineTo(n.xmax,i),r.stroke()},i._drawFog=function(){var e=this.map;if(!(e.getPitch()<=e.options.maxVisualPitch)&&e.options.fog){var t=e.getDevicePixelRatio(),i=this.context,n=e.getContainerExtent(),r=(e.height-e._getVisualHeight(75))*t;r<0&&(r=0);var s=n.ymin*t,o=Math.ceil(s-r),a=e.options.fogColor.join(),l=i.createLinearGradient(0,r,0,s+30),c=1-30/(o+30);l.addColorStop(0,"rgba("+a+", 0)"),l.addColorStop(.3,"rgba("+a+", 0.3)"),l.addColorStop(c,"rgba("+a+", 1)"),l.addColorStop(1,"rgba("+a+", 0)"),i.beginPath(),i.fillStyle=l,i.fillRect(0,r,Math.ceil(n.getWidth())*t,Math.ceil(o+30))}},i._debugSky=function(){var e=this.map;if(!e)return this;var t=e.getContainerExtent().ymin;if(t<=0)return this;var i=this.context;return i.strokeStyle="red",i.strokeRect(0,0,e.width,t),this},i._getAllLayerToRender=function(){return this.map._getLayers()},i.clearCanvas=function(){this.canvas&&YA.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},i._updateCanvasSize=function(){if(!this.canvas||this._containerIsCanvas)return!1;var e=this.map,t=e.getSize(),i=this.canvas,n=FM(t,e.getDevicePixelRatio()),r=n.width,s=n.height,o=n.cssWidth,a=n.cssHeight;return!i.style||i.style.width===o&&i.style.height===a||(i.style.width=o,i.style.height=a),(r!==i.width||s!==i.height)&&(i.height=s,i.width=r,this.topLayer.width=i.width,this.topLayer.height=i.height,!0)},i.createCanvas=function(){this.topLayer=Xk("canvas"),this.topCtx=this.topLayer.getContext("2d"),this._containerIsCanvas?this.canvas=this.map._containerDOM:(this.canvas=Xk("canvas"),this._updateCanvasSize(),this.map._panels.canvasContainer.appendChild(this.canvas)),this.context=this.canvas.getContext("2d")},i._updateDomPosition=function(e){return void 0===this._checkPositionTime&&(this._checkPositionTime=-1/0),Math.abs(e-this._checkPositionTime)>=500&&(rA(this.map._containerDOM),this._checkPositionTime=Math.min(e,this._checkPositionTime)),this},i._handleResizeEventList=function(e){if(!this._resizeEventList)return this;var t=this._resizeEventList.length;if(0===t)return this;if(this._resizeTime&&e-this._resizeTime<60)return this;var i=this._resizeEventList[t-1].contentRect;return this.map._containerDomContentRect=i,this._resizeEventList=[],this._checkSize(i),this._resizeCount=this._resizeCount||0,this.renderFrame((this._frameTimestamp||0)+ ++this._resizeCount/100),this._resizeTime=e,this},i._checkSize=function(){this.map&&this.map.checkSize()},i._setCheckSizeInterval=function(e){var t=this;QP.resizeObserver?(this._resizeObserver&&this._resizeObserver.disconnect(),this.map&&(this._resizeObserver=new ResizeObserver((function(e){!t.map||t.map.isRemoved()?t._resizeObserver.disconnect():e.length&&(t._resizeEventList=t._resizeEventList||[],t._resizeEventList.push(e[0]))})),this._resizeObserver.observe(this.map._containerDOM))):(clearInterval(this._resizeInterval),this._checkSizeInterval=e,this._resizeInterval=setInterval((function(){!t.map||t.map.isRemoved()?clearInterval(t._resizeInterval):t._checkSize()}),this._checkSizeInterval))},i._registerEvents=function(){var e=this,t=this.map;t.options.checkSize&&!wP&&"undefined"!=typeof window&&this._setCheckSizeInterval(t.options.checkSizeInterval),QP.mobile||t.on("_mousemove",this._onMapMouseMove,this),t.on("_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart",(function(t){e._eventParam=t})),t.on("_zooming",(function(i){t.getPitch()||(e._zoomMatrix=i.matrix.container),e._eventParam=i})),t.on("_zoomend",(function(t){e._eventParam=t,delete e._zoomMatrix})),t.on("_spatialreferencechange",(function(){e._spatialRefChanged=!0})),QP.webgl&&"undefined"!=typeof document&&(oI.on("dprchange",this._thisDocDPRChange,this),oI.on("docvisibilitychange",this._thisDocVisibilitychange,this),oI.on("dragstart",this._thisDocDragStart,this),oI.on("dragend",this._thisDocDragEnd,this))},i._onMapMouseMove=function(e){var t=this,i=this.map;!i.isInteracting()&&i.options.hitDetect&&(this._hitDetectFrame&&cM(this._hitDetectFrame),this._hitDetectFrame=lM((function(){t.hitDetect(e.containerPoint)})))},i._getCanvasLayers=function(){return this.map._getLayers((function(e){return e.isCanvasRender()}))},i.addTopElement=function(e){this._tops||(this._tops=[]),this._tops.push(e)},i.removeTopElement=function(e){if(this._tops){var t=this._tops.indexOf(e);t>=0&&this._tops.splice(t,1)}},i.getTopElements=function(){return this._tops||[]},i.drawTops=function(){this.topCtx.clearRect(0,0,this.topLayer.width,this.topLayer.height),this.map.fire("drawtopstart"),this.map.fire("drawtops");for(var e=this.getTopElements(),t=!1,i=0;i<e.length;i++)e[i].render(this.topCtx)&&(t=!0);t&&this.context.drawImage(this.topLayer,0,0),this.map.fire("drawtopsend")},t}(function(e){function t(t){var i;return(i=e.call(this)||this).map=t,i._handlerQueue=[],i._thisDocVisibilitychange=i._onDocVisibilitychange.bind(aM(aM(i))),i._thisDocDragStart=i._onDocDragStart.bind(aM(aM(i))),i._thisDocDragEnd=i._onDocDragEnd.bind(aM(aM(i))),i._thisDocDPRChange=i._onDocDPRChange.bind(aM(aM(i))),i}tM(t,e);var i=t.prototype;return i.callInNextFrame=function(e){this._handlerQueue.push(e)},i.executeFrameCallbacks=function(){var e=this._handlerQueue;this._handlerQueue=[];for(var t=0,i=e.length;t<i;t++)e[t]()},i.offsetPlatform=function(e,t){if(!this.map._panels.front)return this;if(!t&&0===e.x&&0===e.y)return this;var i=this.map._panels,n=this._frontCount=i.back.layerDOM.childElementCount,r=this._backCount=i.front.layerDOM.childElementCount,s=this._uiCount=i.front.uiDOM.childElementCount;if(n||r||s){var o=this.map.offsetPlatform();o=e?o.add(e)._round():o.round(),r&&nA(i.back,o),(n||s)&&nA(i.front,o)}return this},i.domChanged=function(){var e=this.map._panels;return!!e.front&&(void 0===this._frontCount||this._frontCount!==e.back.layerDOM.childElementCount||void 0===this._backCount||this._backCount!==e.front.layerDOM.childElementCount||void 0===this._uiCount||this._uiCount!==e.front.uiDOM.childElementCount)},i.resetContainer=function(){if(this.map&&(this.map._resetMapViewPoint(),this.map._panels.front)){var e=new uM(0,0);nA(this.map._panels.back,e),nA(this.map._panels.front,e)}},i.onZoomEnd=function(){this.resetContainer()},i.onLoad=function(){this._frameLoop()},i._onDocVisibilitychange=function(){"visible"===document.visibilityState&&this.setToRedraw()},i._getWrapPanel=function(){if(!this.map)return null;var e=this.map.getPanels();return e&&e.mapWrapper},i._onDocDragStart=function(){var e=this._getWrapPanel();e&&(e.style.overflow="visible")},i._onDocDragEnd=function(){var e=this._getWrapPanel();e&&(e.style.overflow="hidden")},i._onDocDPRChange=function(){var e=this.map;e&&e.options&&!e.options.devicePixelRatio&&e.checkSize&&e.getRenderer&&e.getRenderer()&&e.checkSize(!0)},i._containerIsOffscreen=function(){var e=this.map.getContainer();return!e||!e.style||"none"===e.style.display||Math.min(e.clientWidth,e.clientHeight)<=0},t}(sI));lN.registerRenderer("canvas",vB),lN.mergeOptions({fog:!1,fogColor:[233,233,233]});var xB={_getRenderPoints:function(){return[[this._getCenter2DPoint(this.getMap().getGLRes())],null]}};MN.include(xB),qN.include(xB),UN.include(xB),GN.include(xB),HN.include({_getRenderPoints:function(e){var t=this.getMap(),i=t.getGLRes();if("vertex"===e){for(var n=this._trimRing(this.getShell()),r=[],s=0,o=n.length;s<o;s++)r.push(t.coordToPointAtRes(n[s],i));return[r,null]}return[[t.coordToPointAtRes(this.getCenter(),i)],null]}});var bB={_getRenderPoints:function(e){var t,i=this.getMap(),n=i.getGLRes(),r=null;if("point"===e)(t=this._getPath2DPoints(this._getPrjCoordinates(),!1,n))&&t.length>0&&Array.isArray(t[0])&&(t=t[0].concat(t[1]));else if("vertex"===e)if(r=[],(t=this._getPath2DPoints(this._getPrjCoordinates(),!1,n))&&t.length>0&&Array.isArray(t[0])){for(var s=0,o=t.length;s<o;s++)for(var a=0,l=t[s].length;a<l;a++)r.push(0===a?[t[s][a],t[s][a+1]]:[t[s][a-1],t[s][a]]);t=t[0].concat(t[1])}else for(var c=0,h=t.length;c<h;c++)r.push(0===c?[t[c],t[c+1]]:[t[c-1],t[c]]);else if("line"===e){t=[],r=[];var u=this._getPath2DPoints(this._getPrjCoordinates(),!1,n);if(u.length>0&&Array.isArray(u[0]))for(var d,p=1,m=u.length;p<m;p++){d=u[p],this instanceof EN&&d.length>0&&!d[0].equals(d[d.length-1])&&d.push(d[0]);for(var f=1,g=d.length;f<g;f++)t.push(d[f].add(d[f-1])._multi(.5)),r.push([d[f-1],d[f]])}else{this instanceof EN&&u.length>0&&!u[0].equals(u[u.length-1])&&u.push(u[0]);for(var _=1,y=u.length;_<y;_++)t.push(u[_].add(u[_-1])._multi(.5)),r.push([u[_-1],u[_]])}}else if("vertex-first"===e){var v=this._getPrjCoordinates(),x=v.length,b=x?i._prjToPointAtRes(v[0],n):null;t=x?[b]:[],r=x?[[b,v[1]?i._prjToPointAtRes(v[1],n):b]]:[]}else if("vertex-last"===e){var w=this._getPrjCoordinates(),C=w.length,S=C?i._prjToPointAtRes(w[C-1],n):null;t=C?[S]:[];var E=C>1?C-2:C-1;r=C?[[w[E]?i._prjToPointAtRes(w[E],n):S,S]]:[]}else{var T=this.getCenter();if(T){var P=this._getProjection().project(T);t=[i._prjToPointAtRes(P,n)]}else t=[]}return[t,r]}};AN.include(bB),EN.include(bB);var wB={within:!1,center:[0,0]};function CB(e){if(e&&e._containerBbox){wB.within=!1;var t=e._containerBbox,i=t.minx,n=t.miny,r=t.maxx,s=t.maxy,o=Math.abs(r-i),a=Math.abs(s-n);o<=1&&a<=1&&(wB.within=!0,wB.center[0]=(i+r)/2,wB.center[1]=(n+s)/2),delete e._containerBbox}else wB.within=!1;return wB}function SB(){var e=[1/0,1/0,-1/0,-1/0];return GA(this._getPrjShell(),e),new OI(e[0],e[1],e[2],e[3])}function EB(){var e=this._getPrjShell();if(!e||!Array.isArray(e))return[];var t=this._getProjection(),i=this.getCoordinates()||{};return e.map((function(e){var n=t.unproject(e);return n.z=i.z||0,n}))}UO.include({_redrawWhenPitch:function(){return!1},_redrawWhenRotate:function(){return!1},_getRenderBBOX:function(e,t){return e.isHitTesting?null:(HA(qA),GA(t,qA),qA)}});var TB={_redrawWhenPitch:function(){return!0},_redrawWhenRotate:function(){return this instanceof qN||this instanceof GN},_computeRotatedPrjExtent:SB,getRotatedShell:EB,_paintAsPath:function(){if(this.isRotated())return!0;var e=this.getMap();return this._getAltitude()>0||e.getPitch()||this instanceof qN&&e.getBearing()},_getPaintParams:function(){var e=this.getMap();if(this._paintAsPath())return EN.prototype._getPaintParams.call(this,!0);var t=this._getPrjCoordinates(),i=e._prjToPointAtRes(t,e.getGLRes()),n=this._getRenderSize(i);return[i].concat(n)},_paintOn:function(){return this._paintAsPath()?YA.polygon.apply(YA,arguments):YA.ellipse.apply(YA,arguments)},_getRenderSize:function(e){var t=this.getMap(),i=t.getGLRes(),n=this._getPrjExtent(),r=t._prjToPointAtRes(n.getMin(),i),s=t._prjToPointAtRes(n.getMax(),i);return[Math.abs(s.x-r.x)/2,Math.abs(s.y-e.y),Math.abs(e.y-r.y)]}};qN.include(TB),UN.include(TB),HN.include({_getPaintParams:function(){var e=this.getMap(),t=this._getPrjShell();return[this._getPath2DPoints(t,!1,e.getGLRes())]},_paintOn:YA.polygon,_computeRotatedPrjExtent:SB,getRotatedShell:EB}),GN.include(TB,{_redrawWhenPitch:function(){return!0},_getPaintParams:function(){if(this._paintAsPath())return EN.prototype._getPaintParams.call(this,!0);var e=this.getMap(),t=e._prjToPointAtRes(this._getPrjCoordinates(),e.getGLRes());return[t,this._getRenderSize(t)[0],[this.getStartAngle(),this.getEndAngle()]]},_paintOn:function(){if(this._paintAsPath())return YA.polygon.apply(YA,arguments);var e=this.getMap().getBearing(),t=arguments;return e&&(t[3]=t[3].slice(0),t[3][0]+=e,t[3][1]+=e),YA.sector.apply(YA,t)}}),SN.include({_paintAsPath:function(){return!0}}),AN.include({arrowStyles:{classic:[3,4]},_getArrowShape:function(e,t,i,n,r){if(!e||!t||e.equals(t))return null;r||(r=0);var s,o=i*n[1]+r,a=i*n[0]/2+r;(s=t.sub(t.nextCtrlPoint||t.prevCtrlPoint?new uM(t.prevCtrlPoint?t.prevCtrlPoint:t.nextCtrlPoint):e))._unit();var l=t.sub(s.multi(o));s._perp();var c=l.add(s.multi(a));return s._multi(-1),[c,t,l.add(s.multi(a)),c]},_getPaintParams:function(){var e=this._getPrjCoordinates();return[this._getPath2DPoints(e,!1,this.getMap().getGLRes())]},_paintOn:function(e,t,i,n,r){var s=CB(this._painter);return s.within?YA.pixelRect(e,s.center,i,n):this.options.smoothness?YA.paintSmoothLine(e,t,i,this.options.smoothness,!1,this._animIdx,this._animTailRatio):YA.path(e,t,i,null,r),this._paintArrow(e,t,i),this._getRenderBBOX(e,t)},_getArrowPlacement:function(){return this.options.arrowPlacement},_getArrowStyle:function(){var e=this.options.arrowStyle;return e?Array.isArray(e)?e:this.arrowStyles[e]:null},_getArrows:function(e,t,i){var n=this._getArrowStyle();if(!n||e.length<2)return[];for(var r=e.length>0&&Array.isArray(e[0])?e:[e],s=this._getArrowPlacement(),o=[],a=this.getMap(),l=a.coordToContainerPoint(this.getFirstCoordinate()),c=a.coordToContainerPoint(this.getLastCoordinate()),h=r.length-1;h>=0;h--){if("vertex-first"===s||"vertex-firstlast"===s&&r[h][0].closeTo(l,.01)){var u=this._getArrowShape(r[h][1],r[h][0],t,n,i);u&&o.push(u)}if("vertex-last"===s||"vertex-firstlast"===s&&r[h][r[h].length-1].closeTo(c,.01)){var d=this._getArrowShape(r[h][r[h].length-2],r[h][r[h].length-1],t,n,i);d&&o.push(d)}else"point"===s&&this._getArrowPoints(o,r[h],t,n,i)}return o},_getArrowPoints:function(e,t,i,n,r){for(var s=0,o=t.length-1;s<o;s++){var a=this._getArrowShape(t[s],t[s+1],i,n,r);a&&e.push(a)}},_paintArrow:function(e,t,i){var n=this._getInternalSymbol().lineWidth;(!dP(n)||n<3)&&(n=3);var r=this._getArrows(t,n);if(r.length){e.setLineDash&&e.setLineDash([]);for(var s=r.length-1;s>=0;s--)e.fillStyle=e.strokeStyle,YA.polygon(e,r[s],i,i)}}}),EN.include({_getPaintParams:function(e){var t=this.getMap().getGLRes(),i=this._getPrjShell(),n=this._getPath2DPoints(i,e,t),r=n.length>0&&Array.isArray(n[0]);r&&(n=[[n[0]],[n[1]]]);var s=this._getPrjHoles(),o=[];if(s&&s.length>0){for(var a=this._simplified,l=0;l<s.length;l++){var c=this._getPath2DPoints(s[l],e,t);Array.isArray(c)&&r?Array.isArray(c[0])?(n[0].push(c[0]),n[1].push(c[1])):n[0].push(c):o.push(c)}a&&(this._simplified=a)}return r||_M(n=[n],o),[n]},_paintOn:function(e,t,i,n,r){var s=CB(this._painter);return s.within?YA.pixelRect(e,s.center,i,n):YA.polygon(e,t,i,n,r,this.options.smoothness),this._getRenderBBOX(e,t)}}),lN.VERSION="1.0.0-rc.30";let PB=(()=>{class e{constructor(e){this.http=e,this.apiBaseUrl="https://mapmatrixnodej-803097e9a651.herokuapp.com",this.selectedtab=0,this.sharedSiteDetails=new Hp([]),this.obtainedSiteDetails=this.sharedSiteDetails.asObservable(),this.SharedFacilityDtailes=new Hp([]),this.obtainedFacilityDetails=this.SharedFacilityDtailes.asObservable(),this.SharedLevelDtailes=new Hp([]),this.obtainedLevelDetails=this.SharedLevelDtailes.asObservable(),this.SharedSpaceeDetailes=new Hp([]),this.obtainedspaceDetails=this.SharedSpaceeDetailes.asObservable(),this.SharedDeviceDetailes=new Hp([]),this.obtainedDeviceDetails=this.SharedDeviceDetailes.asObservable()}addSite(e){return this.http.post(this.apiBaseUrl+"/Sites",e)}addFacility(e){return this.http.post(this.apiBaseUrl+"/Facilities",e)}addLevel(e){return this.http.post(this.apiBaseUrl+"/Levels",e)}addSpaces(e){return this.http.post(this.apiBaseUrl+"/Spaces",e)}adddevices(e){return this.http.post(this.apiBaseUrl+"/Devices",e)}getAllSites(){return this.http.get(this.apiBaseUrl+"/Sites")}getAllFacilities(){return this.http.get(this.apiBaseUrl+"/Facilities")}getAllLevels(){return this.http.get(this.apiBaseUrl+"/Levels")}getAllSpaces(){return this.http.get(this.apiBaseUrl+"/Spaces")}getSpacesbyId(e){return this.http.get(this.apiBaseUrl+"/Spaces/byId/"+e)}saveAllsiteDetails(e){this.sharedSiteDetails.next(e)}saveAllFacilityDetails(e){this.SharedFacilityDtailes.next(e)}saveAllLevelDetails(e){this.SharedLevelDtailes.next(e)}saveAllSpaceDetails(e){this.SharedSpaceeDetailes.next(e)}saveAllDeviceDetails(e){this.SharedDeviceDetailes.next(e)}}return e.\u0275fac=function(t){return new(t||e)(Ke(jx))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function MB(e,t){if(1&e){const e=No();ko(0,"div",1),ko(1,"button",2),Lo("click",(function(){return Jt(e),Uo().action()})),pa(2),Ao(),Ao()}if(2&e){const e=Uo();gr(2),ma(e.data.action)}}function kB(e,t){}const AB=Math.pow(2,31)-1;class IB{constructor(e,t){this._overlayRef=t,this._afterDismissed=new T,this._afterOpened=new T,this._onAction=new T,this._dismissedByAction=!1,this.containerInstance=e,this.onAction().subscribe(()=>this.dismiss()),e._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}closeWithAction(){this.dismissWithAction()}_dismissAfter(e){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(e,AB))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed.asObservable()}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction.asObservable()}}const RB=new je("MatSnackBarData");class OB{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let NB=(()=>{class e{constructor(e,t){this.snackBarRef=e,this.data=t}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return e.\u0275fac=function(t){return new(t||e)(So(IB),So(RB))},e.\u0275cmp=ft({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(ko(0,"span"),pa(1),Ao(),wo(2,MB,3,1,"div",0)),2&e&&(gr(1),ma(t.data.message),gr(1),Po("ngIf",t.hasAction))},directives:[Ph,dS],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),e})();const DB={snackBarState:vu("state",[Su("void, hidden",Cu({transform:"scale(0.8)",opacity:0})),Su("visible",Cu({transform:"scale(1)",opacity:1})),Tu("* => visible",xu("150ms cubic-bezier(0, 0, 0.2, 1)")),Tu("* => void, * => hidden",xu("75ms cubic-bezier(0.4, 0.0, 1, 1)",Cu({opacity:0})))])};let zB=(()=>{class e extends rC{constructor(e,t,i,n){super(),this._ngZone=e,this._elementRef=t,this._changeDetectorRef=i,this.snackBarConfig=n,this._destroyed=!1,this._onExit=new T,this._onEnter=new T,this._animationState="void",this.attachDomPortal=e=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(e)),this._role="assertive"!==n.politeness||n.announcementMessage?"off"===n.politeness?null:"status":"alert"}attachComponentPortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(e)}onAnimationEnd(e){const{fromState:t,toState:i}=e;if(("void"===i&&"void"!==t||"hidden"===i)&&this._completeExit(),"visible"===i){const e=this._onEnter;this._ngZone.run(()=>{e.next(),e.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}exit(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.asObservable().pipe(ym(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach(t=>e.classList.add(t)):e.classList.add(t)),"center"===this.snackBarConfig.horizontalPosition&&e.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&e.classList.add("mat-snack-bar-top")}_assertNotAttached(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}return e.\u0275fac=function(t){return new(t||e)(So(Cc),So(Fa),So(qs),So(OB))},e.\u0275cmp=ft({type:e,selectors:[["snack-bar-container"]],viewQuery:function(e,t){var i;1&e&&Gl(aC,!0),2&e&&Hl(i=Yl())&&(t._portalOutlet=i.first)},hostAttrs:[1,"mat-snack-bar-container"],hostVars:2,hostBindings:function(e,t){1&e&&Bo("@state.done",(function(e){return t.onAnimationEnd(e)})),2&e&&(xo("role",t._role),_a("@state",t._animationState))},features:[va],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,t){1&e&&wo(0,kB,0,0,"ng-template",0)},directives:[aC],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[DB.snackBarState]}}),e})(),LB=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[qC,hC,Fh,pS,lv],lv]}),e})();const BB=new je("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new OB}});let FB=(()=>{class e{constructor(e,t,i,n,r,s){this._overlay=e,this._live=t,this._injector=i,this._breakpointObserver=n,this._parentSnackBar=r,this._defaultConfig=s,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,t){return this._attach(e,t)}openFromTemplate(e,t){return this._attach(e,t)}open(e,t="",i){const n=Object.assign(Object.assign({},this._defaultConfig),i);return n.data={message:e,action:t},n.announcementMessage||(n.announcementMessage=e),this.openFromComponent(NB,n)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,t){const i=new uC(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[OB,t]])),n=new tC(zB,t.viewContainerRef,i),r=e.attach(n);return r.instance.snackBarConfig=t,r.instance}_attach(e,t){const i=Object.assign(Object.assign(Object.assign({},new OB),this._defaultConfig),t),n=this._createOverlay(i),r=this._attachSnackBarContainer(n,i),s=new IB(r,n);if(e instanceof cl){const t=new iC(e,null,{$implicit:i.data,snackBarRef:s});s.instance=r.attachTemplatePortal(t)}else{const t=this._createInjector(i,s),n=new tC(e,void 0,t),o=r.attachComponentPortal(n);s.instance=o.instance}return this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait)").pipe(cy(n.detachments())).subscribe(e=>{const t=n.overlayElement.classList;e.matches?t.add("mat-snack-bar-handset"):t.remove("mat-snack-bar-handset")}),this._animateSnackBar(s,i),this._openedSnackBarRef=s,this._openedSnackBarRef}_animateSnackBar(e,t){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),t.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(t.duration)),t.announcementMessage&&this._live.announce(t.announcementMessage,t.politeness)}_createOverlay(e){const t=new xC;t.direction=e.direction;let i=this._overlay.position().global();const n="rtl"===e.direction,r="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!n||"end"===e.horizontalPosition&&n,s=!r&&"center"!==e.horizontalPosition;return r?i.left("0"):s?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),t.positionStrategy=i,this._overlay.create(t)}_createInjector(e,t){return new uC(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[IB,t],[RB,e.data]]))}}return e.\u0275fac=function(t){return new(t||e)(Ke(LC),Ke(Wy),Ke(so),Ke(KC),Ke(e,12),Ke(BB))},e.\u0275prov=de({factory:function(){return new e(Ke(LC),Ke(Wy),Ke(Ve),Ke(KC),Ke(e,12),Ke(BB))},token:e,providedIn:LB}),e})();function jB(e){return this instanceof jB?(this.v=e,this):new jB(e)}function VB(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){r[e]&&(n[e]=function(t){return new Promise((function(i,n){s.push([e,t,i,n])>1||a(e,t)}))})}function a(e,t){try{(i=r[e](t)).value instanceof jB?Promise.resolve(i.value.v).then(l,c):h(s[0][2],i)}catch(P0){h(s[0][3],P0)}var i}function l(e){a("next",e)}function c(e){a("throw",e)}function h(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function UB(e){var t,i;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(i=!i)?{value:jB(e[n](t)),done:!1}:r?r(t):t}:r}}function qB(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,r,(t=e[i](t)).done,t.value)}))}}}var HB,GB,WB;"function"==typeof SuppressedError&&SuppressedError,"undefined"!=typeof window&&window,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(HB=self.constructor)||void 0===HB?void 0:HB.name)||"ServiceWorkerGlobalScope"===(null===(GB=self.constructor)||void 0===GB?void 0:GB.name)||self);const ZB="undefined"!=typeof Deno&&void 0!==Deno.version&&void 0!==Deno.version.deno,$B="undefined"!=typeof process&&Boolean(process.version)&&Boolean(null===(WB=process.versions)||void 0===WB?void 0:WB.node)&&!ZB;function XB(e){return e&&"function"==typeof e.getToken&&(void 0===e.signRequest||e.getToken.length>0)}var KB;"undefined"!=typeof Bun&&Bun,"undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator),function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(KB||(KB={}));class YB{constructor(e,t){this._nextPolicy=e,this._options=t}shouldLog(e){return this._options.shouldLog(e)}log(e,t){this._options.log(e,t)}}class JB{constructor(e){this._logger=e}shouldLog(e){return!!this._logger&&e!==KB.OFF&&e<=this._logger.minimumLogLevel}log(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)}}function QB(e){return{create:(e,t)=>{throw new Error("ProxyPolicy is not supported in browser environment")}}}var eF="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},tF=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,iF=function(e){var t=new Set(["1.7.0"]),i=new Set,n="1.7.0".match(tF);if(!n)return function(){return!1};var r=+n[1],s=+n[2],o=+n[3];if(null!=n[4])return function(e){return"1.7.0"===e};function a(e){return i.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(i.has(e))return!1;var n=e.match(tF);if(!n)return a(e);var c=+n[2],h=+n[3];return null!=n[4]||r!==+n[1]?a(e):0===r?s===c&&o<=h?l(e):a(e):s<=c?l(e):a(e)}}(),nF="1.7.0".split(".")[0],rF=Symbol.for("opentelemetry.js.api."+nF),sF=eF;function oF(e,t,i,n){var r;void 0===n&&(n=!1);var s=sF[rF]=null!==(r=sF[rF])&&void 0!==r?r:{version:"1.7.0"};if(!n&&s[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return i.error(o.stack||o.message),!1}return"1.7.0"!==s.version?(o=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v1.7.0"),i.error(o.stack||o.message),!1):(s[e]=t,i.debug("@opentelemetry/api: Registered a global for "+e+" v1.7.0."),!0)}function aF(e){var t,i,n=null===(t=sF[rF])||void 0===t?void 0:t.version;if(n&&iF(n))return null===(i=sF[rF])||void 0===i?void 0:i[e]}function lF(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v1.7.0.");var i=sF[rF];i&&delete i[e]}var cF,hF=new function e(t){var i=this;i._currentContext=t?new Map(t):new Map,i.getValue=function(e){return i._currentContext.get(e)},i.setValue=function(t,n){var r=new e(i._currentContext);return r._currentContext.set(t,n),r},i.deleteValue=function(t){var n=new e(i._currentContext);return n._currentContext.delete(t),n}},uF=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o},dF=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},pF=function(){function e(){}return e.prototype.active=function(){return hF},e.prototype.with=function(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];return t.call.apply(t,dF([i],uF(n),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),mF=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fF("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fF("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fF("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fF("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fF("verbose",this._namespace,e)},e}();function fF(e,t,i){var n=aF("diag");if(n)return i.unshift(t),n[e].apply(n,function(e,t,i){if(i||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}(i),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(cF||(cF={}));var gF,_F=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o},yF=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},vF=function(){function e(){function e(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=aF("diag");if(n)return n[e].apply(n,yF([],_F(t),!1))}}var t=this;t.setLogger=function(e,i){var n,r,s;if(void 0===i&&(i={logLevel:cF.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=o.stack)&&void 0!==n?n:o.message),!1}"number"==typeof i&&(i={logLevel:i});var a=aF("diag"),l=function(e,t){function i(i,n){var r=t[i];return"function"==typeof r&&e>=n?r.bind(t):function(){}}return e<cF.NONE?e=cF.NONE:e>cF.ALL&&(e=cF.ALL),t=t||{},{error:i("error",cF.ERROR),warn:i("warn",cF.WARN),info:i("info",cF.INFO),debug:i("debug",cF.DEBUG),verbose:i("verbose",cF.VERBOSE)}}(null!==(r=i.logLevel)&&void 0!==r?r:cF.INFO,e);if(a&&!i.suppressOverrideMessage){var c=null!==(s=(new Error).stack)&&void 0!==s?s:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+c),l.warn("Current logger will overwrite one already registered from "+c)}return oF("diag",l,t,!0)},t.disable=function(){lF("diag",t)},t.createComponentLogger=function(e){return new mF(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),xF=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o},bF=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},wF=new pF,CF=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return oF("context",e,vF.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,i){for(var n,r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];return(n=this._getContextManager()).with.apply(n,bF([e,t,i],xF(r),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return aF("context")||wF},e.prototype.disable=function(){this._getContextManager().disable(),lF("context",vF.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(gF||(gF={}));var SF={traceId:"00000000000000000000000000000000",spanId:"0000000000000000",traceFlags:gF.NONE},EF=function(){function e(e){void 0===e&&(e=SF),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),TF=Symbol.for("OpenTelemetry Context Key SPAN");function PF(e){return e.getValue(TF)||void 0}function MF(){return PF(CF.getInstance().active())}function kF(e,t){return e.setValue(TF,t)}function AF(e){return e.deleteValue(TF)}function IF(e,t){return kF(e,new EF(t))}function RF(e){var t;return null===(t=PF(e))||void 0===t?void 0:t.spanContext()}var OF=/^([0-9a-f]{32})$/i,NF=/^[0-9a-f]{16}$/i;function DF(e){return OF.test(i=e.traceId)&&"00000000000000000000000000000000"!==i&&NF.test(t=e.spanId)&&"0000000000000000"!==t;var t,i}function zF(e){return new EF(e)}var LF,BF=CF.getInstance(),FF=function(){function e(){}return e.prototype.startSpan=function(e,t,i){if(void 0===i&&(i=BF.active()),Boolean(null==t?void 0:t.root))return new EF;var n,r=i&&RF(i);return"object"==typeof(n=r)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&DF(r)?new EF(r):new EF},e.prototype.startActiveSpan=function(e,t,i,n){var r,s,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(r=t,o=i):(r=t,s=i,o=n);var a=null!=s?s:BF.active(),l=this.startSpan(e,r,a),c=kF(a,l);return BF.with(c,o,void 0,l)}},e}(),jF=new FF,VF=function(){function e(e,t,i,n){this._provider=e,this.name=t,this.version=i,this.options=n}return e.prototype.startSpan=function(e,t,i){return this._getTracer().startSpan(e,t,i)},e.prototype.startActiveSpan=function(e,t,i,n){var r=this._getTracer();return Reflect.apply(r.startActiveSpan,r,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):jF},e}(),UF=new(function(){function e(){}return e.prototype.getTracer=function(e,t,i){return new FF},e}()),qF=function(){function e(){}return e.prototype.getTracer=function(e,t,i){var n;return null!==(n=this.getDelegateTracer(e,t,i))&&void 0!==n?n:new VF(this,e,t,i)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:UF},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,i){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,i)},e}(),HF=function(){function e(){this._proxyTracerProvider=new qF,this.wrapSpanContext=zF,this.isSpanContextValid=DF,this.deleteSpan=AF,this.getSpan=PF,this.getActiveSpan=MF,this.getSpanContext=RF,this.setSpan=kF,this.setSpanContext=IF}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=oF("trace",this._proxyTracerProvider,vF.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return aF("trace")||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){lF("trace",vF.instance()),this._proxyTracerProvider=new qF},e}().getInstance(),GF=CF.getInstance();function WF(e,t){return HF.setSpan(e,t)}!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(LF||(LF={}));const ZF=GF;var $F;function XF(e){const{requestOptions:t,tracingOptions:i}=e;let n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,["requestOptions","tracingOptions"]);return t&&(n=Object.assign(Object.assign({},n),t)),i&&(n.tracingContext=i.tracingContext,n.spanOptions=null==i?void 0:i.spanOptions),n}function KF(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return btoa(t)}function YF(e){const t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}($F||($F={})),"function"==typeof SuppressedError&&SuppressedError;const JF="$";var QF,ej=new Uint8Array(16);function tj(){if(!QF&&!(QF="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return QF(ej)}for(var ij=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,nj=function(e){return"string"==typeof e&&ij.test(e)},rj=[],sj=0;sj<256;++sj)rj.push((sj+256).toString(16).substr(1));var oj=function(e,t,i){var n=(e=e||{}).random||(e.rng||tj)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(rj[e[t+0]]+rj[e[t+1]]+rj[e[t+2]]+rj[e[t+3]]+"-"+rj[e[t+4]]+rj[e[t+5]]+"-"+rj[e[t+6]]+rj[e[t+7]]+"-"+rj[e[t+8]]+rj[e[t+9]]+"-"+rj[e[t+10]]+rj[e[t+11]]+rj[e[t+12]]+rj[e[t+13]]+rj[e[t+14]]+rj[e[t+15]]).toLowerCase();if(!nj(i))throw TypeError("Stringified UUID is invalid");return i}(n)};const aj=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function lj(){return oj()}const cj=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function hj(e,t,i){return e&&t?e.split(t).join(i||""):e}class uj{constructor(e={},t){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,i){const n=(e,n)=>{throw new Error(`"${i}" with value "${t}" should satisfy the constraint "${e}": ${n}.`)};if(e.constraints&&null!=t){const i=t,{ExclusiveMaximum:r,ExclusiveMinimum:s,InclusiveMaximum:o,InclusiveMinimum:a,MaxItems:l,MaxLength:c,MinItems:h,MinLength:u,MultipleOf:d,Pattern:p,UniqueItems:m}=e.constraints;null!=r&&i>=r&&n("ExclusiveMaximum",r),null!=s&&i<=s&&n("ExclusiveMinimum",s),null!=o&&i>o&&n("InclusiveMaximum",o),null!=a&&i<a&&n("InclusiveMinimum",a);const f=t;if(null!=l&&f.length>l&&n("MaxItems",l),null!=c&&f.length>c&&n("MaxLength",c),null!=h&&f.length<h&&n("MinItems",h),null!=u&&f.length<u&&n("MinLength",u),null!=d&&i%d!=0&&n("MultipleOf",d),p){const e="string"==typeof p?new RegExp(p):p;"string"==typeof t&&null!==t.match(e)||n("Pattern",p)}m&&f.some((e,t,i)=>i.indexOf(e)!==t)&&n("UniqueItems",m)}}serialize(e,t,i,n={}){var r,s,o;const a={rootName:null!==(r=n.rootName)&&void 0!==r?r:"",includeRoot:null!==(s=n.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(o=n.xmlCharKey)&&void 0!==o?o:"_"};let l={};const c=e.type.name;i||(i=e.serializedName),null!==c.match(/^Sequence$/i)&&(l=[]),e.isConstant&&(t=e.defaultValue);const{required:h,nullable:u}=e;if(h&&u&&void 0===t)throw new Error(i+" cannot be undefined.");if(h&&!u&&null==t)throw new Error(i+" cannot be null or undefined.");if(!h&&!1===u&&null===t)throw new Error(i+" cannot be null.");return null==t||null!==c.match(/^any$/i)?l=t:null!==c.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?l=function(e,t,i){if(null!=i)if(null!==e.match(/^Number$/i)){if("number"!=typeof i)throw new Error(`${t} with value ${i} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof i.valueOf())throw new Error(`${t} with value "${i}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof i.valueOf()||!aj.test(i))throw new Error(`${t} with value "${i}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof i)throw new Error(`${t} with value ${i} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof i;if(!("string"===e||"function"===e||i instanceof ArrayBuffer||ArrayBuffer.isView(i)||("function"==typeof Blob||"object"==typeof Blob)&&i instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return i}(c,i,t):null!==c.match(/^Enum$/i)?l=function(e,t,i){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some(e=>"string"==typeof e.valueOf()?e.toLowerCase()===i.toLowerCase():e===i))throw new Error(`${i} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return i}(i,e.type.allowedValues,t):null!==c.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?l=function(e,t,i){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(i+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(i+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(i+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(i+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return cj.test(e)}(t))throw new Error(`${i} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(c,t,i):null!==c.match(/^ByteArray$/i)?l=function(e,t){let i="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");i=KF(t)}return i}(i,t):null!==c.match(/^Base64Url$/i)?l=function(e,t){let i="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");i=function(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let i=e.length;for(;i-1>=0&&"="===e[i-1];)--i;return e.substr(0,i)}(KF(e)).replace(/\+/g,"-").replace(/\//g,"_")}}(t)||""}return i}(i,t):null!==c.match(/^Sequence$/i)?l=function(e,t,i,n,r,s){if(!Array.isArray(i))throw new Error(n+" must be of type Array.");const o=t.type.element;if(!o||"object"!=typeof o)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);const a=[];for(let l=0;l<i.length;l++){const t=e.serialize(o,i[l],n,s);if(r&&o.xmlNamespace){const e=o.xmlNamespacePrefix?"xmlns:"+o.xmlNamespacePrefix:"xmlns";"Composite"===o.type.name?(a[l]=Object.assign({},t),a[l][JF]={[e]:o.xmlNamespace}):(a[l]={},a[l][s.xmlCharKey]=t,a[l][JF]={[e]:o.xmlNamespace})}else a[l]=t}return a}(this,e,t,i,Boolean(this.isXML),a):null!==c.match(/^Dictionary$/i)?l=function(e,t,i,n,r,s){if("object"!=typeof i)throw new Error(n+" must be of type object.");const o=t.type.value;if(!o||"object"!=typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);const a={};for(const l of Object.keys(i)){const t=e.serialize(o,i[l],n,s);a[l]=fj(o,t,r,s)}if(r&&t.xmlNamespace){const e=a;return e[JF]={[t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns"]:t.xmlNamespace},e}return a}(this,e,t,i,Boolean(this.isXML),a):null!==c.match(/^Composite$/i)&&(l=function(e,t,i,n,r,s){if(yj(e,t)&&(t=_j(e,t,i,"clientName")),null!=i){const o={},a=mj(e,t,n);for(const c of Object.keys(a)){const l=a[c];if(l.readOnly)continue;let h,u=o;if(e.isXML)h=l.xmlIsWrapped?l.xmlName:l.xmlElementName||l.xmlName;else{const e=dj(l.serializedName);h=e.pop();for(const t of e)null!=u[t]||null==i[c]&&void 0===l.defaultValue||(u[t]={}),u=u[t]}if(null!=u){if(r&&t.xmlNamespace){const e=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns";u[JF]=Object.assign(Object.assign({},u[JF]),{[e]:t.xmlNamespace})}const o=""!==l.serializedName?n+"."+l.serializedName:n;let a=i[c];const d=yj(e,t);d&&d.clientName===c&&null==a&&(a=t.serializedName);const p=e.serialize(l,a,o,s);if(void 0!==p&&null!=h){const e=fj(l,p,r,s);r&&l.xmlIsAttribute?(u[JF]=u[JF]||{},u[JF][h]=p):u[h]=r&&l.xmlIsWrapped?{[l.xmlElementName]:e}:e}}}const l=function(e,t,i){const n=t.type.additionalProperties;if(!n&&t.type.className){const n=pj(e,t,i);return null==n?void 0:n.type.additionalProperties}return n}(e,t,n);if(l){const t=Object.keys(a);for(const r in i)t.every(e=>e!==r)&&(o[r]=e.serialize(l,i[r],n+'["'+r+'"]',s))}return o}return i}(this,e,t,i,Boolean(this.isXML),a)),l}deserialize(e,t,i,n={}){var r,s,o;const a={rootName:null!==(r=n.rootName)&&void 0!==r?r:"",includeRoot:null!==(s=n.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(o=n.xmlCharKey)&&void 0!==o?o:"_"};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let l;const c=e.type.name;if(i||(i=e.serializedName),null!==c.match(/^Composite$/i))l=function(e,t,i,n,r){var s,o;const a=null!==(s=r.xmlCharKey)&&void 0!==s?s:"_";yj(e,t)&&(t=_j(e,t,i,"serializedName"));const l=mj(e,t,n);let c={};const h=[];for(const d of Object.keys(l)){const s=l[d],u=dj(l[d].serializedName);h.push(u[0]);const{serializedName:p,xmlName:m,xmlElementName:f}=s;let g=n;""!==p&&void 0!==p&&(g=n+"."+p);const _=s.headerCollectionPrefix;if(_){const t={};for(const n of Object.keys(i))n.startsWith(_)&&(t[n.substring(_.length)]=e.deserialize(s.type.value,i[n],g,r)),h.push(n);c[d]=t}else if(e.isXML)if(s.xmlIsAttribute&&i[JF])c[d]=e.deserialize(s,i[JF][m],g,r);else if(s.xmlIsMsText)void 0!==i[a]?c[d]=i[a]:"string"==typeof i&&(c[d]=i);else{const t=f||m||p;if(s.xmlIsWrapped){const t=i[m],n=null!==(o=null==t?void 0:t[f])&&void 0!==o?o:[];c[d]=e.deserialize(s,n,g,r),h.push(m)}else c[d]=e.deserialize(s,i[t],g,r),h.push(t)}else{let n,o=i;for(const e of u){if(!o)break;o=o[e]}n=o;const a=t.type.polymorphicDiscriminator;let h;if(a&&d===a.clientName&&null==n&&(n=t.serializedName),Array.isArray(i[d])&&""===l[d].serializedName){n=i[d];const t=e.deserialize(s,n,g,r);for(const[e,i]of Object.entries(c))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=i);c=t}else void 0===n&&void 0===s.defaultValue||(h=e.deserialize(s,n,g,r),c[d]=h)}}const u=t.type.additionalProperties;if(u){const t=e=>{for(const t in l)if(dj(l[t].serializedName)[0]===e)return!1;return!0};for(const s in i)t(s)&&(c[s]=e.deserialize(u,i[s],n+'["'+s+'"]',r))}else if(i)for(const d of Object.keys(i))void 0!==c[d]||h.includes(d)||gj(d,r)||(c[d]=i[d]);return c}(this,e,t,i,a);else{if(this.isXML){const e=a.xmlCharKey,i=t;null!=i[JF]&&null!=i[e]&&(t=i[e])}null!==c.match(/^Number$/i)?(l=parseFloat(t),isNaN(l)&&(l=t)):null!==c.match(/^Boolean$/i)?l="true"===t||"false"!==t&&t:null!==c.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?l=t:null!==c.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?l=new Date(t):null!==c.match(/^UnixTime$/i)?l=function(e){if(e)return new Date(1e3*e)}(t):null!==c.match(/^ByteArray$/i)?l=YF(t):null!==c.match(/^Base64Url$/i)?l=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return YF(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==c.match(/^Sequence$/i)?l=function(e,t,i,n,r){const s=t.type.element;if(!s||"object"!=typeof s)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(i){Array.isArray(i)||(i=[i]);const t=[];for(let o=0;o<i.length;o++)t[o]=e.deserialize(s,i[o],`${n}[${o}]`,r);return t}return i}(this,e,t,i,a):null!==c.match(/^Dictionary$/i)&&(l=function(e,t,i,n,r){const s=t.type.value;if(!s||"object"!=typeof s)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(i){const t={};for(const o of Object.keys(i))t[o]=e.deserialize(s,i[o],n,r);return t}return i}(this,e,t,i,a))}return e.isConstant&&(l=e.defaultValue),l}}function dj(e){const t=[];let i="";if(e){const n=e.split(".");for(const e of n)"\\"===e.charAt(e.length-1)?i+=e.substr(0,e.length-1)+".":(i+=e,t.push(i),i="")}return t}function pj(e,t,i){const n=t.type.className;if(!n)throw new Error(`Class name for model "${i}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[n]}function mj(e,t,i){let n=t.type.modelProperties;if(!n){const r=pj(e,t,i);if(!r)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(n=null==r?void 0:r.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(r)}" of type "${t.type.className}" for object "${i}".`)}return n}function fj(e,t,i,n){if(!i||!e.xmlNamespace)return t;const r={[e.xmlNamespacePrefix?"xmlns:"+e.xmlNamespacePrefix:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[JF])return t;{const e=Object.assign({},t);return e[JF]=r,e}}const s={};return s[n.xmlCharKey]=t,s[JF]=r,s}function gj(e,t){return[JF,t.xmlCharKey].includes(e)}function _j(e,t,i,n){const r=yj(e,t);if(r){const s=r[n];if(null!=s){const n=i[s];if(null!=n){const i=t.type.uberParent||t.type.className,r=e.modelMappers.discriminators[n===i?n:i+"."+n];r&&(t=r)}}}return t}function yj(e,t){return t.type.polymorphicDiscriminator||vj(e,t.type.uberParent)||vj(e,t.type.className)}function vj(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const xj=function(e){const t={};for(const i of["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"])t[i]=i;return t}(),bj={serializedName:"BlobServiceProperties",xmlName:"StorageServiceProperties",type:{name:"Composite",className:"BlobServiceProperties",modelProperties:{blobAnalyticsLogging:{serializedName:"Logging",xmlName:"Logging",type:{name:"Composite",className:"Logging"}},hourMetrics:{serializedName:"HourMetrics",xmlName:"HourMetrics",type:{name:"Composite",className:"Metrics"}},minuteMetrics:{serializedName:"MinuteMetrics",xmlName:"MinuteMetrics",type:{name:"Composite",className:"Metrics"}},cors:{serializedName:"Cors",xmlName:"Cors",xmlIsWrapped:!0,xmlElementName:"CorsRule",type:{name:"Sequence",element:{type:{name:"Composite",className:"CorsRule"}}}},defaultServiceVersion:{serializedName:"DefaultServiceVersion",xmlName:"DefaultServiceVersion",type:{name:"String"}},deleteRetentionPolicy:{serializedName:"DeleteRetentionPolicy",xmlName:"DeleteRetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}},staticWebsite:{serializedName:"StaticWebsite",xmlName:"StaticWebsite",type:{name:"Composite",className:"StaticWebsite"}}}}},wj={serializedName:"Logging",type:{name:"Composite",className:"Logging",modelProperties:{version:{serializedName:"Version",required:!0,xmlName:"Version",type:{name:"String"}},deleteProperty:{serializedName:"Delete",required:!0,xmlName:"Delete",type:{name:"Boolean"}},read:{serializedName:"Read",required:!0,xmlName:"Read",type:{name:"Boolean"}},write:{serializedName:"Write",required:!0,xmlName:"Write",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},Cj={serializedName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy",modelProperties:{enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},days:{constraints:{InclusiveMinimum:1},serializedName:"Days",xmlName:"Days",type:{name:"Number"}}}}},Sj={serializedName:"Metrics",type:{name:"Composite",className:"Metrics",modelProperties:{version:{serializedName:"Version",xmlName:"Version",type:{name:"String"}},enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},includeAPIs:{serializedName:"IncludeAPIs",xmlName:"IncludeAPIs",type:{name:"Boolean"}},retentionPolicy:{serializedName:"RetentionPolicy",xmlName:"RetentionPolicy",type:{name:"Composite",className:"RetentionPolicy"}}}}},Ej={serializedName:"CorsRule",type:{name:"Composite",className:"CorsRule",modelProperties:{allowedOrigins:{serializedName:"AllowedOrigins",required:!0,xmlName:"AllowedOrigins",type:{name:"String"}},allowedMethods:{serializedName:"AllowedMethods",required:!0,xmlName:"AllowedMethods",type:{name:"String"}},allowedHeaders:{serializedName:"AllowedHeaders",required:!0,xmlName:"AllowedHeaders",type:{name:"String"}},exposedHeaders:{serializedName:"ExposedHeaders",required:!0,xmlName:"ExposedHeaders",type:{name:"String"}},maxAgeInSeconds:{constraints:{InclusiveMinimum:0},serializedName:"MaxAgeInSeconds",required:!0,xmlName:"MaxAgeInSeconds",type:{name:"Number"}}}}},Tj={serializedName:"StaticWebsite",type:{name:"Composite",className:"StaticWebsite",modelProperties:{enabled:{serializedName:"Enabled",required:!0,xmlName:"Enabled",type:{name:"Boolean"}},indexDocument:{serializedName:"IndexDocument",xmlName:"IndexDocument",type:{name:"String"}},errorDocument404Path:{serializedName:"ErrorDocument404Path",xmlName:"ErrorDocument404Path",type:{name:"String"}},defaultIndexDocumentPath:{serializedName:"DefaultIndexDocumentPath",xmlName:"DefaultIndexDocumentPath",type:{name:"String"}}}}},Pj={serializedName:"StorageError",type:{name:"Composite",className:"StorageError",modelProperties:{message:{serializedName:"Message",xmlName:"Message",type:{name:"String"}},code:{serializedName:"Code",xmlName:"Code",type:{name:"String"}}}}},Mj={serializedName:"BlobServiceStatistics",xmlName:"StorageServiceStats",type:{name:"Composite",className:"BlobServiceStatistics",modelProperties:{geoReplication:{serializedName:"GeoReplication",xmlName:"GeoReplication",type:{name:"Composite",className:"GeoReplication"}}}}},kj={serializedName:"GeoReplication",type:{name:"Composite",className:"GeoReplication",modelProperties:{status:{serializedName:"Status",required:!0,xmlName:"Status",type:{name:"Enum",allowedValues:["live","bootstrap","unavailable"]}},lastSyncOn:{serializedName:"LastSyncTime",required:!0,xmlName:"LastSyncTime",type:{name:"DateTimeRfc1123"}}}}},Aj={serializedName:"ListContainersSegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListContainersSegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},containerItems:{serializedName:"ContainerItems",required:!0,xmlName:"Containers",xmlIsWrapped:!0,xmlElementName:"Container",type:{name:"Sequence",element:{type:{name:"Composite",className:"ContainerItem"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},Ij={serializedName:"ContainerItem",xmlName:"Container",type:{name:"Composite",className:"ContainerItem",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},deleted:{serializedName:"Deleted",xmlName:"Deleted",type:{name:"Boolean"}},version:{serializedName:"Version",xmlName:"Version",type:{name:"String"}},properties:{serializedName:"Properties",xmlName:"Properties",type:{name:"Composite",className:"ContainerProperties"}},metadata:{serializedName:"Metadata",xmlName:"Metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Rj={serializedName:"ContainerProperties",type:{name:"Composite",className:"ContainerProperties",modelProperties:{lastModified:{serializedName:"Last-Modified",required:!0,xmlName:"Last-Modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"Etag",required:!0,xmlName:"Etag",type:{name:"String"}},leaseStatus:{serializedName:"LeaseStatus",xmlName:"LeaseStatus",type:{name:"Enum",allowedValues:["locked","unlocked"]}},leaseState:{serializedName:"LeaseState",xmlName:"LeaseState",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseDuration:{serializedName:"LeaseDuration",xmlName:"LeaseDuration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},publicAccess:{serializedName:"PublicAccess",xmlName:"PublicAccess",type:{name:"Enum",allowedValues:["container","blob"]}},hasImmutabilityPolicy:{serializedName:"HasImmutabilityPolicy",xmlName:"HasImmutabilityPolicy",type:{name:"Boolean"}},hasLegalHold:{serializedName:"HasLegalHold",xmlName:"HasLegalHold",type:{name:"Boolean"}},defaultEncryptionScope:{serializedName:"DefaultEncryptionScope",xmlName:"DefaultEncryptionScope",type:{name:"String"}},preventEncryptionScopeOverride:{serializedName:"DenyEncryptionScopeOverride",xmlName:"DenyEncryptionScopeOverride",type:{name:"Boolean"}},deletedOn:{serializedName:"DeletedTime",xmlName:"DeletedTime",type:{name:"DateTimeRfc1123"}},remainingRetentionDays:{serializedName:"RemainingRetentionDays",xmlName:"RemainingRetentionDays",type:{name:"Number"}},isImmutableStorageWithVersioningEnabled:{serializedName:"ImmutableStorageWithVersioningEnabled",xmlName:"ImmutableStorageWithVersioningEnabled",type:{name:"Boolean"}}}}},Oj={serializedName:"KeyInfo",type:{name:"Composite",className:"KeyInfo",modelProperties:{startsOn:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"String"}},expiresOn:{serializedName:"Expiry",required:!0,xmlName:"Expiry",type:{name:"String"}}}}},Nj={serializedName:"UserDelegationKey",type:{name:"Composite",className:"UserDelegationKey",modelProperties:{signedObjectId:{serializedName:"SignedOid",required:!0,xmlName:"SignedOid",type:{name:"String"}},signedTenantId:{serializedName:"SignedTid",required:!0,xmlName:"SignedTid",type:{name:"String"}},signedStartsOn:{serializedName:"SignedStart",required:!0,xmlName:"SignedStart",type:{name:"String"}},signedExpiresOn:{serializedName:"SignedExpiry",required:!0,xmlName:"SignedExpiry",type:{name:"String"}},signedService:{serializedName:"SignedService",required:!0,xmlName:"SignedService",type:{name:"String"}},signedVersion:{serializedName:"SignedVersion",required:!0,xmlName:"SignedVersion",type:{name:"String"}},value:{serializedName:"Value",required:!0,xmlName:"Value",type:{name:"String"}}}}},Dj={serializedName:"FilterBlobSegment",xmlName:"EnumerationResults",type:{name:"Composite",className:"FilterBlobSegment",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},where:{serializedName:"Where",required:!0,xmlName:"Where",type:{name:"String"}},blobs:{serializedName:"Blobs",required:!0,xmlName:"Blobs",xmlIsWrapped:!0,xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"FilterBlobItem"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},zj={serializedName:"FilterBlobItem",xmlName:"Blob",type:{name:"Composite",className:"FilterBlobItem",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",type:{name:"String"}},tags:{serializedName:"Tags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags"}}}}},Lj={serializedName:"BlobTags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags",modelProperties:{blobTagSet:{serializedName:"BlobTagSet",required:!0,xmlName:"TagSet",xmlIsWrapped:!0,xmlElementName:"Tag",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobTag"}}}}}}},Bj={serializedName:"BlobTag",xmlName:"Tag",type:{name:"Composite",className:"BlobTag",modelProperties:{key:{serializedName:"Key",required:!0,xmlName:"Key",type:{name:"String"}},value:{serializedName:"Value",required:!0,xmlName:"Value",type:{name:"String"}}}}},Fj={serializedName:"SignedIdentifier",xmlName:"SignedIdentifier",type:{name:"Composite",className:"SignedIdentifier",modelProperties:{id:{serializedName:"Id",required:!0,xmlName:"Id",type:{name:"String"}},accessPolicy:{serializedName:"AccessPolicy",xmlName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy"}}}}},jj={serializedName:"AccessPolicy",type:{name:"Composite",className:"AccessPolicy",modelProperties:{startsOn:{serializedName:"Start",xmlName:"Start",type:{name:"String"}},expiresOn:{serializedName:"Expiry",xmlName:"Expiry",type:{name:"String"}},permissions:{serializedName:"Permission",xmlName:"Permission",type:{name:"String"}}}}},Vj={serializedName:"ListBlobsFlatSegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListBlobsFlatSegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},segment:{serializedName:"Segment",xmlName:"Blobs",type:{name:"Composite",className:"BlobFlatListSegment"}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},Uj={serializedName:"BlobFlatListSegment",xmlName:"Blobs",type:{name:"Composite",className:"BlobFlatListSegment",modelProperties:{blobItems:{serializedName:"BlobItems",required:!0,xmlName:"BlobItems",xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobItemInternal"}}}}}}},qj={serializedName:"BlobItemInternal",xmlName:"Blob",type:{name:"Composite",className:"BlobItemInternal",modelProperties:{name:{serializedName:"Name",xmlName:"Name",type:{name:"Composite",className:"BlobName"}},deleted:{serializedName:"Deleted",required:!0,xmlName:"Deleted",type:{name:"Boolean"}},snapshot:{serializedName:"Snapshot",required:!0,xmlName:"Snapshot",type:{name:"String"}},versionId:{serializedName:"VersionId",xmlName:"VersionId",type:{name:"String"}},isCurrentVersion:{serializedName:"IsCurrentVersion",xmlName:"IsCurrentVersion",type:{name:"Boolean"}},properties:{serializedName:"Properties",xmlName:"Properties",type:{name:"Composite",className:"BlobPropertiesInternal"}},metadata:{serializedName:"Metadata",xmlName:"Metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}},blobTags:{serializedName:"BlobTags",xmlName:"Tags",type:{name:"Composite",className:"BlobTags"}},objectReplicationMetadata:{serializedName:"ObjectReplicationMetadata",xmlName:"OrMetadata",type:{name:"Dictionary",value:{type:{name:"String"}}}},hasVersionsOnly:{serializedName:"HasVersionsOnly",xmlName:"HasVersionsOnly",type:{name:"Boolean"}}}}},Hj={serializedName:"BlobName",type:{name:"Composite",className:"BlobName",modelProperties:{encoded:{serializedName:"Encoded",xmlName:"Encoded",xmlIsAttribute:!0,type:{name:"Boolean"}},content:{serializedName:"content",xmlName:"content",xmlIsMsText:!0,type:{name:"String"}}}}},Gj={serializedName:"BlobPropertiesInternal",xmlName:"Properties",type:{name:"Composite",className:"BlobPropertiesInternal",modelProperties:{createdOn:{serializedName:"Creation-Time",xmlName:"Creation-Time",type:{name:"DateTimeRfc1123"}},lastModified:{serializedName:"Last-Modified",required:!0,xmlName:"Last-Modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"Etag",required:!0,xmlName:"Etag",type:{name:"String"}},contentLength:{serializedName:"Content-Length",xmlName:"Content-Length",type:{name:"Number"}},contentType:{serializedName:"Content-Type",xmlName:"Content-Type",type:{name:"String"}},contentEncoding:{serializedName:"Content-Encoding",xmlName:"Content-Encoding",type:{name:"String"}},contentLanguage:{serializedName:"Content-Language",xmlName:"Content-Language",type:{name:"String"}},contentMD5:{serializedName:"Content-MD5",xmlName:"Content-MD5",type:{name:"ByteArray"}},contentDisposition:{serializedName:"Content-Disposition",xmlName:"Content-Disposition",type:{name:"String"}},cacheControl:{serializedName:"Cache-Control",xmlName:"Cache-Control",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"BlobType",xmlName:"BlobType",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},leaseStatus:{serializedName:"LeaseStatus",xmlName:"LeaseStatus",type:{name:"Enum",allowedValues:["locked","unlocked"]}},leaseState:{serializedName:"LeaseState",xmlName:"LeaseState",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseDuration:{serializedName:"LeaseDuration",xmlName:"LeaseDuration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},copyId:{serializedName:"CopyId",xmlName:"CopyId",type:{name:"String"}},copyStatus:{serializedName:"CopyStatus",xmlName:"CopyStatus",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},copySource:{serializedName:"CopySource",xmlName:"CopySource",type:{name:"String"}},copyProgress:{serializedName:"CopyProgress",xmlName:"CopyProgress",type:{name:"String"}},copyCompletedOn:{serializedName:"CopyCompletionTime",xmlName:"CopyCompletionTime",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"CopyStatusDescription",xmlName:"CopyStatusDescription",type:{name:"String"}},serverEncrypted:{serializedName:"ServerEncrypted",xmlName:"ServerEncrypted",type:{name:"Boolean"}},incrementalCopy:{serializedName:"IncrementalCopy",xmlName:"IncrementalCopy",type:{name:"Boolean"}},destinationSnapshot:{serializedName:"DestinationSnapshot",xmlName:"DestinationSnapshot",type:{name:"String"}},deletedOn:{serializedName:"DeletedTime",xmlName:"DeletedTime",type:{name:"DateTimeRfc1123"}},remainingRetentionDays:{serializedName:"RemainingRetentionDays",xmlName:"RemainingRetentionDays",type:{name:"Number"}},accessTier:{serializedName:"AccessTier",xmlName:"AccessTier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}},accessTierInferred:{serializedName:"AccessTierInferred",xmlName:"AccessTierInferred",type:{name:"Boolean"}},archiveStatus:{serializedName:"ArchiveStatus",xmlName:"ArchiveStatus",type:{name:"Enum",allowedValues:["rehydrate-pending-to-hot","rehydrate-pending-to-cool","rehydrate-pending-to-cold"]}},customerProvidedKeySha256:{serializedName:"CustomerProvidedKeySha256",xmlName:"CustomerProvidedKeySha256",type:{name:"String"}},encryptionScope:{serializedName:"EncryptionScope",xmlName:"EncryptionScope",type:{name:"String"}},accessTierChangedOn:{serializedName:"AccessTierChangeTime",xmlName:"AccessTierChangeTime",type:{name:"DateTimeRfc1123"}},tagCount:{serializedName:"TagCount",xmlName:"TagCount",type:{name:"Number"}},expiresOn:{serializedName:"Expiry-Time",xmlName:"Expiry-Time",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"Sealed",xmlName:"Sealed",type:{name:"Boolean"}},rehydratePriority:{serializedName:"RehydratePriority",xmlName:"RehydratePriority",type:{name:"Enum",allowedValues:["High","Standard"]}},lastAccessedOn:{serializedName:"LastAccessTime",xmlName:"LastAccessTime",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"ImmutabilityPolicyUntilDate",xmlName:"ImmutabilityPolicyUntilDate",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"ImmutabilityPolicyMode",xmlName:"ImmutabilityPolicyMode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"LegalHold",xmlName:"LegalHold",type:{name:"Boolean"}}}}},Wj={serializedName:"ListBlobsHierarchySegmentResponse",xmlName:"EnumerationResults",type:{name:"Composite",className:"ListBlobsHierarchySegmentResponse",modelProperties:{serviceEndpoint:{serializedName:"ServiceEndpoint",required:!0,xmlName:"ServiceEndpoint",xmlIsAttribute:!0,type:{name:"String"}},containerName:{serializedName:"ContainerName",required:!0,xmlName:"ContainerName",xmlIsAttribute:!0,type:{name:"String"}},prefix:{serializedName:"Prefix",xmlName:"Prefix",type:{name:"String"}},marker:{serializedName:"Marker",xmlName:"Marker",type:{name:"String"}},maxPageSize:{serializedName:"MaxResults",xmlName:"MaxResults",type:{name:"Number"}},delimiter:{serializedName:"Delimiter",xmlName:"Delimiter",type:{name:"String"}},segment:{serializedName:"Segment",xmlName:"Blobs",type:{name:"Composite",className:"BlobHierarchyListSegment"}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},Zj={serializedName:"BlobHierarchyListSegment",xmlName:"Blobs",type:{name:"Composite",className:"BlobHierarchyListSegment",modelProperties:{blobPrefixes:{serializedName:"BlobPrefixes",xmlName:"BlobPrefixes",xmlElementName:"BlobPrefix",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobPrefix"}}}},blobItems:{serializedName:"BlobItems",required:!0,xmlName:"BlobItems",xmlElementName:"Blob",type:{name:"Sequence",element:{type:{name:"Composite",className:"BlobItemInternal"}}}}}}},$j={serializedName:"BlobPrefix",type:{name:"Composite",className:"BlobPrefix",modelProperties:{name:{serializedName:"Name",xmlName:"Name",type:{name:"Composite",className:"BlobName"}}}}},Xj={serializedName:"BlockLookupList",xmlName:"BlockList",type:{name:"Composite",className:"BlockLookupList",modelProperties:{committed:{serializedName:"Committed",xmlName:"Committed",xmlElementName:"Committed",type:{name:"Sequence",element:{type:{name:"String"}}}},uncommitted:{serializedName:"Uncommitted",xmlName:"Uncommitted",xmlElementName:"Uncommitted",type:{name:"Sequence",element:{type:{name:"String"}}}},latest:{serializedName:"Latest",xmlName:"Latest",xmlElementName:"Latest",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},Kj={serializedName:"BlockList",type:{name:"Composite",className:"BlockList",modelProperties:{committedBlocks:{serializedName:"CommittedBlocks",xmlName:"CommittedBlocks",xmlIsWrapped:!0,xmlElementName:"Block",type:{name:"Sequence",element:{type:{name:"Composite",className:"Block"}}}},uncommittedBlocks:{serializedName:"UncommittedBlocks",xmlName:"UncommittedBlocks",xmlIsWrapped:!0,xmlElementName:"Block",type:{name:"Sequence",element:{type:{name:"Composite",className:"Block"}}}}}}},Yj={serializedName:"Block",type:{name:"Composite",className:"Block",modelProperties:{name:{serializedName:"Name",required:!0,xmlName:"Name",type:{name:"String"}},size:{serializedName:"Size",required:!0,xmlName:"Size",type:{name:"Number"}}}}},Jj={serializedName:"PageList",type:{name:"Composite",className:"PageList",modelProperties:{pageRange:{serializedName:"PageRange",xmlName:"PageRange",xmlElementName:"PageRange",type:{name:"Sequence",element:{type:{name:"Composite",className:"PageRange"}}}},clearRange:{serializedName:"ClearRange",xmlName:"ClearRange",xmlElementName:"ClearRange",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClearRange"}}}},continuationToken:{serializedName:"NextMarker",xmlName:"NextMarker",type:{name:"String"}}}}},Qj={serializedName:"PageRange",xmlName:"PageRange",type:{name:"Composite",className:"PageRange",modelProperties:{start:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"Number"}},end:{serializedName:"End",required:!0,xmlName:"End",type:{name:"Number"}}}}},eV={serializedName:"ClearRange",xmlName:"ClearRange",type:{name:"Composite",className:"ClearRange",modelProperties:{start:{serializedName:"Start",required:!0,xmlName:"Start",type:{name:"Number"}},end:{serializedName:"End",required:!0,xmlName:"End",type:{name:"Number"}}}}},tV={serializedName:"QueryRequest",xmlName:"QueryRequest",type:{name:"Composite",className:"QueryRequest",modelProperties:{queryType:{serializedName:"QueryType",required:!0,xmlName:"QueryType",type:{name:"String"}},expression:{serializedName:"Expression",required:!0,xmlName:"Expression",type:{name:"String"}},inputSerialization:{serializedName:"InputSerialization",xmlName:"InputSerialization",type:{name:"Composite",className:"QuerySerialization"}},outputSerialization:{serializedName:"OutputSerialization",xmlName:"OutputSerialization",type:{name:"Composite",className:"QuerySerialization"}}}}},iV={serializedName:"QuerySerialization",type:{name:"Composite",className:"QuerySerialization",modelProperties:{format:{serializedName:"Format",xmlName:"Format",type:{name:"Composite",className:"QueryFormat"}}}}},nV={serializedName:"QueryFormat",type:{name:"Composite",className:"QueryFormat",modelProperties:{type:{serializedName:"Type",required:!0,xmlName:"Type",type:{name:"Enum",allowedValues:["delimited","json","arrow","parquet"]}},delimitedTextConfiguration:{serializedName:"DelimitedTextConfiguration",xmlName:"DelimitedTextConfiguration",type:{name:"Composite",className:"DelimitedTextConfiguration"}},jsonTextConfiguration:{serializedName:"JsonTextConfiguration",xmlName:"JsonTextConfiguration",type:{name:"Composite",className:"JsonTextConfiguration"}},arrowConfiguration:{serializedName:"ArrowConfiguration",xmlName:"ArrowConfiguration",type:{name:"Composite",className:"ArrowConfiguration"}},parquetTextConfiguration:{serializedName:"ParquetTextConfiguration",xmlName:"ParquetTextConfiguration",type:{name:"any"}}}}},rV={serializedName:"DelimitedTextConfiguration",xmlName:"DelimitedTextConfiguration",type:{name:"Composite",className:"DelimitedTextConfiguration",modelProperties:{columnSeparator:{serializedName:"ColumnSeparator",xmlName:"ColumnSeparator",type:{name:"String"}},fieldQuote:{serializedName:"FieldQuote",xmlName:"FieldQuote",type:{name:"String"}},recordSeparator:{serializedName:"RecordSeparator",xmlName:"RecordSeparator",type:{name:"String"}},escapeChar:{serializedName:"EscapeChar",xmlName:"EscapeChar",type:{name:"String"}},headersPresent:{serializedName:"HeadersPresent",xmlName:"HasHeaders",type:{name:"Boolean"}}}}},sV={serializedName:"JsonTextConfiguration",xmlName:"JsonTextConfiguration",type:{name:"Composite",className:"JsonTextConfiguration",modelProperties:{recordSeparator:{serializedName:"RecordSeparator",xmlName:"RecordSeparator",type:{name:"String"}}}}},oV={serializedName:"ArrowConfiguration",xmlName:"ArrowConfiguration",type:{name:"Composite",className:"ArrowConfiguration",modelProperties:{schema:{serializedName:"Schema",required:!0,xmlName:"Schema",xmlIsWrapped:!0,xmlElementName:"Field",type:{name:"Sequence",element:{type:{name:"Composite",className:"ArrowField"}}}}}}},aV={serializedName:"ArrowField",xmlName:"Field",type:{name:"Composite",className:"ArrowField",modelProperties:{type:{serializedName:"Type",required:!0,xmlName:"Type",type:{name:"String"}},name:{serializedName:"Name",xmlName:"Name",type:{name:"String"}},precision:{serializedName:"Precision",xmlName:"Precision",type:{name:"Number"}},scale:{serializedName:"Scale",xmlName:"Scale",type:{name:"Number"}}}}},lV={serializedName:"Service_setPropertiesHeaders",type:{name:"Composite",className:"ServiceSetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},cV={serializedName:"Service_setPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceSetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},hV={serializedName:"Service_getPropertiesHeaders",type:{name:"Composite",className:"ServiceGetPropertiesHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},uV={serializedName:"Service_getPropertiesExceptionHeaders",type:{name:"Composite",className:"ServiceGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},dV={serializedName:"Service_getStatisticsHeaders",type:{name:"Composite",className:"ServiceGetStatisticsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},pV={serializedName:"Service_getStatisticsExceptionHeaders",type:{name:"Composite",className:"ServiceGetStatisticsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},mV={serializedName:"Service_listContainersSegmentHeaders",type:{name:"Composite",className:"ServiceListContainersSegmentHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},fV={serializedName:"Service_listContainersSegmentExceptionHeaders",type:{name:"Composite",className:"ServiceListContainersSegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gV={serializedName:"Service_getUserDelegationKeyHeaders",type:{name:"Composite",className:"ServiceGetUserDelegationKeyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_V={serializedName:"Service_getUserDelegationKeyExceptionHeaders",type:{name:"Composite",className:"ServiceGetUserDelegationKeyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yV={serializedName:"Service_getAccountInfoHeaders",type:{name:"Composite",className:"ServiceGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}},isHierarchicalNamespaceEnabled:{serializedName:"x-ms-is-hns-enabled",xmlName:"x-ms-is-hns-enabled",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},vV={serializedName:"Service_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"ServiceGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},xV={serializedName:"Service_submitBatchHeaders",type:{name:"Composite",className:"ServiceSubmitBatchHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},bV={serializedName:"Service_submitBatchExceptionHeaders",type:{name:"Composite",className:"ServiceSubmitBatchExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},wV={serializedName:"Service_filterBlobsHeaders",type:{name:"Composite",className:"ServiceFilterBlobsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},CV={serializedName:"Service_filterBlobsExceptionHeaders",type:{name:"Composite",className:"ServiceFilterBlobsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},SV={serializedName:"Container_createHeaders",type:{name:"Composite",className:"ContainerCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},EV={serializedName:"Container_createExceptionHeaders",type:{name:"Composite",className:"ContainerCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},TV={serializedName:"Container_getPropertiesHeaders",type:{name:"Composite",className:"ContainerGetPropertiesHeaders",modelProperties:{metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobPublicAccess:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}},hasImmutabilityPolicy:{serializedName:"x-ms-has-immutability-policy",xmlName:"x-ms-has-immutability-policy",type:{name:"Boolean"}},hasLegalHold:{serializedName:"x-ms-has-legal-hold",xmlName:"x-ms-has-legal-hold",type:{name:"Boolean"}},defaultEncryptionScope:{serializedName:"x-ms-default-encryption-scope",xmlName:"x-ms-default-encryption-scope",type:{name:"String"}},denyEncryptionScopeOverride:{serializedName:"x-ms-deny-encryption-scope-override",xmlName:"x-ms-deny-encryption-scope-override",type:{name:"Boolean"}},isImmutableStorageWithVersioningEnabled:{serializedName:"x-ms-immutable-storage-with-versioning-enabled",xmlName:"x-ms-immutable-storage-with-versioning-enabled",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},PV={serializedName:"Container_getPropertiesExceptionHeaders",type:{name:"Composite",className:"ContainerGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},MV={serializedName:"Container_deleteHeaders",type:{name:"Composite",className:"ContainerDeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},kV={serializedName:"Container_deleteExceptionHeaders",type:{name:"Composite",className:"ContainerDeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},AV={serializedName:"Container_setMetadataHeaders",type:{name:"Composite",className:"ContainerSetMetadataHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},IV={serializedName:"Container_setMetadataExceptionHeaders",type:{name:"Composite",className:"ContainerSetMetadataExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},RV={serializedName:"Container_getAccessPolicyHeaders",type:{name:"Composite",className:"ContainerGetAccessPolicyHeaders",modelProperties:{blobPublicAccess:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},OV={serializedName:"Container_getAccessPolicyExceptionHeaders",type:{name:"Composite",className:"ContainerGetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},NV={serializedName:"Container_setAccessPolicyHeaders",type:{name:"Composite",className:"ContainerSetAccessPolicyHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},DV={serializedName:"Container_setAccessPolicyExceptionHeaders",type:{name:"Composite",className:"ContainerSetAccessPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zV={serializedName:"Container_restoreHeaders",type:{name:"Composite",className:"ContainerRestoreHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},LV={serializedName:"Container_restoreExceptionHeaders",type:{name:"Composite",className:"ContainerRestoreExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},BV={serializedName:"Container_renameHeaders",type:{name:"Composite",className:"ContainerRenameHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},FV={serializedName:"Container_renameExceptionHeaders",type:{name:"Composite",className:"ContainerRenameExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},jV={serializedName:"Container_submitBatchHeaders",type:{name:"Composite",className:"ContainerSubmitBatchHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}}}}},VV={serializedName:"Container_submitBatchExceptionHeaders",type:{name:"Composite",className:"ContainerSubmitBatchExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},UV={serializedName:"Container_filterBlobsHeaders",type:{name:"Composite",className:"ContainerFilterBlobsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},qV={serializedName:"Container_filterBlobsExceptionHeaders",type:{name:"Composite",className:"ContainerFilterBlobsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},HV={serializedName:"Container_acquireLeaseHeaders",type:{name:"Composite",className:"ContainerAcquireLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},GV={serializedName:"Container_acquireLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerAcquireLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},WV={serializedName:"Container_releaseLeaseHeaders",type:{name:"Composite",className:"ContainerReleaseLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},ZV={serializedName:"Container_releaseLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerReleaseLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},$V={serializedName:"Container_renewLeaseHeaders",type:{name:"Composite",className:"ContainerRenewLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},XV={serializedName:"Container_renewLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerRenewLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},KV={serializedName:"Container_breakLeaseHeaders",type:{name:"Composite",className:"ContainerBreakLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseTime:{serializedName:"x-ms-lease-time",xmlName:"x-ms-lease-time",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},YV={serializedName:"Container_breakLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerBreakLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},JV={serializedName:"Container_changeLeaseHeaders",type:{name:"Composite",className:"ContainerChangeLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},QV={serializedName:"Container_changeLeaseExceptionHeaders",type:{name:"Composite",className:"ContainerChangeLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},eU={serializedName:"Container_listBlobFlatSegmentHeaders",type:{name:"Composite",className:"ContainerListBlobFlatSegmentHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},tU={serializedName:"Container_listBlobFlatSegmentExceptionHeaders",type:{name:"Composite",className:"ContainerListBlobFlatSegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},iU={serializedName:"Container_listBlobHierarchySegmentHeaders",type:{name:"Composite",className:"ContainerListBlobHierarchySegmentHeaders",modelProperties:{contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},nU={serializedName:"Container_listBlobHierarchySegmentExceptionHeaders",type:{name:"Composite",className:"ContainerListBlobHierarchySegmentExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},rU={serializedName:"Container_getAccountInfoHeaders",type:{name:"Composite",className:"ContainerGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}}}}},sU={serializedName:"Container_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"ContainerGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},oU={serializedName:"Blob_downloadHeaders",type:{name:"Composite",className:"BlobDownloadHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},createdOn:{serializedName:"x-ms-creation-time",xmlName:"x-ms-creation-time",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},objectReplicationPolicyId:{serializedName:"x-ms-or-policy-id",xmlName:"x-ms-or-policy-id",type:{name:"String"}},objectReplicationRules:{serializedName:"x-ms-or",xmlName:"x-ms-or",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-or-"},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},contentRange:{serializedName:"content-range",xmlName:"content-range",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletedOn:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},isCurrentVersion:{serializedName:"x-ms-is-current-version",xmlName:"x-ms-is-current-version",type:{name:"Boolean"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},blobContentMD5:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}},tagCount:{serializedName:"x-ms-tag-count",xmlName:"x-ms-tag-count",type:{name:"Number"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}},lastAccessed:{serializedName:"x-ms-last-access-time",xmlName:"x-ms-last-access-time",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}},contentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}}}},aU={serializedName:"Blob_downloadExceptionHeaders",type:{name:"Composite",className:"BlobDownloadExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},lU={serializedName:"Blob_getPropertiesHeaders",type:{name:"Composite",className:"BlobGetPropertiesHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},createdOn:{serializedName:"x-ms-creation-time",xmlName:"x-ms-creation-time",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"},objectReplicationPolicyId:{serializedName:"x-ms-or-policy-id",xmlName:"x-ms-or-policy-id",type:{name:"String"}},objectReplicationRules:{serializedName:"x-ms-or",xmlName:"x-ms-or",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-or-"},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletedOn:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},isIncrementalCopy:{serializedName:"x-ms-incremental-copy",xmlName:"x-ms-incremental-copy",type:{name:"Boolean"}},destinationSnapshot:{serializedName:"x-ms-copy-destination-snapshot",xmlName:"x-ms-copy-destination-snapshot",type:{name:"String"}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},accessTier:{serializedName:"x-ms-access-tier",xmlName:"x-ms-access-tier",type:{name:"String"}},accessTierInferred:{serializedName:"x-ms-access-tier-inferred",xmlName:"x-ms-access-tier-inferred",type:{name:"Boolean"}},archiveStatus:{serializedName:"x-ms-archive-status",xmlName:"x-ms-archive-status",type:{name:"String"}},accessTierChangedOn:{serializedName:"x-ms-access-tier-change-time",xmlName:"x-ms-access-tier-change-time",type:{name:"DateTimeRfc1123"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},isCurrentVersion:{serializedName:"x-ms-is-current-version",xmlName:"x-ms-is-current-version",type:{name:"Boolean"}},tagCount:{serializedName:"x-ms-tag-count",xmlName:"x-ms-tag-count",type:{name:"Number"}},expiresOn:{serializedName:"x-ms-expiry-time",xmlName:"x-ms-expiry-time",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}},rehydratePriority:{serializedName:"x-ms-rehydrate-priority",xmlName:"x-ms-rehydrate-priority",type:{name:"Enum",allowedValues:["High","Standard"]}},lastAccessed:{serializedName:"x-ms-last-access-time",xmlName:"x-ms-last-access-time",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiresOn:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},cU={serializedName:"Blob_getPropertiesExceptionHeaders",type:{name:"Composite",className:"BlobGetPropertiesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},hU={serializedName:"Blob_deleteHeaders",type:{name:"Composite",className:"BlobDeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},uU={serializedName:"Blob_deleteExceptionHeaders",type:{name:"Composite",className:"BlobDeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},dU={serializedName:"Blob_undeleteHeaders",type:{name:"Composite",className:"BlobUndeleteHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},pU={serializedName:"Blob_undeleteExceptionHeaders",type:{name:"Composite",className:"BlobUndeleteExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},mU={serializedName:"Blob_setExpiryHeaders",type:{name:"Composite",className:"BlobSetExpiryHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},fU={serializedName:"Blob_setExpiryExceptionHeaders",type:{name:"Composite",className:"BlobSetExpiryExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gU={serializedName:"Blob_setHttpHeadersHeaders",type:{name:"Composite",className:"BlobSetHttpHeadersHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_U={serializedName:"Blob_setHttpHeadersExceptionHeaders",type:{name:"Composite",className:"BlobSetHttpHeadersExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yU={serializedName:"Blob_setImmutabilityPolicyHeaders",type:{name:"Composite",className:"BlobSetImmutabilityPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyExpiry:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}},immutabilityPolicyMode:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}}}}},vU={serializedName:"Blob_setImmutabilityPolicyExceptionHeaders",type:{name:"Composite",className:"BlobSetImmutabilityPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},xU={serializedName:"Blob_deleteImmutabilityPolicyHeaders",type:{name:"Composite",className:"BlobDeleteImmutabilityPolicyHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},bU={serializedName:"Blob_deleteImmutabilityPolicyExceptionHeaders",type:{name:"Composite",className:"BlobDeleteImmutabilityPolicyExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},wU={serializedName:"Blob_setLegalHoldHeaders",type:{name:"Composite",className:"BlobSetLegalHoldHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},legalHold:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}}}},CU={serializedName:"Blob_setLegalHoldExceptionHeaders",type:{name:"Composite",className:"BlobSetLegalHoldExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},SU={serializedName:"Blob_setMetadataHeaders",type:{name:"Composite",className:"BlobSetMetadataHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},EU={serializedName:"Blob_setMetadataExceptionHeaders",type:{name:"Composite",className:"BlobSetMetadataExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},TU={serializedName:"Blob_acquireLeaseHeaders",type:{name:"Composite",className:"BlobAcquireLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},PU={serializedName:"Blob_acquireLeaseExceptionHeaders",type:{name:"Composite",className:"BlobAcquireLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},MU={serializedName:"Blob_releaseLeaseHeaders",type:{name:"Composite",className:"BlobReleaseLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},kU={serializedName:"Blob_releaseLeaseExceptionHeaders",type:{name:"Composite",className:"BlobReleaseLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},AU={serializedName:"Blob_renewLeaseHeaders",type:{name:"Composite",className:"BlobRenewLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},IU={serializedName:"Blob_renewLeaseExceptionHeaders",type:{name:"Composite",className:"BlobRenewLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},RU={serializedName:"Blob_changeLeaseHeaders",type:{name:"Composite",className:"BlobChangeLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},leaseId:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},OU={serializedName:"Blob_changeLeaseExceptionHeaders",type:{name:"Composite",className:"BlobChangeLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},NU={serializedName:"Blob_breakLeaseHeaders",type:{name:"Composite",className:"BlobBreakLeaseHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},leaseTime:{serializedName:"x-ms-lease-time",xmlName:"x-ms-lease-time",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}}}}},DU={serializedName:"Blob_breakLeaseExceptionHeaders",type:{name:"Composite",className:"BlobBreakLeaseExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zU={serializedName:"Blob_createSnapshotHeaders",type:{name:"Composite",className:"BlobCreateSnapshotHeaders",modelProperties:{snapshot:{serializedName:"x-ms-snapshot",xmlName:"x-ms-snapshot",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},LU={serializedName:"Blob_createSnapshotExceptionHeaders",type:{name:"Composite",className:"BlobCreateSnapshotExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},BU={serializedName:"Blob_startCopyFromURLHeaders",type:{name:"Composite",className:"BlobStartCopyFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},FU={serializedName:"Blob_startCopyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobStartCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},jU={serializedName:"Blob_copyFromURLHeaders",type:{name:"Composite",className:"BlobCopyFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{defaultValue:"success",isConstant:!0,serializedName:"x-ms-copy-status",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},VU={serializedName:"Blob_copyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},UU={serializedName:"Blob_abortCopyFromURLHeaders",type:{name:"Composite",className:"BlobAbortCopyFromURLHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},qU={serializedName:"Blob_abortCopyFromURLExceptionHeaders",type:{name:"Composite",className:"BlobAbortCopyFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},HU={serializedName:"Blob_setTierHeaders",type:{name:"Composite",className:"BlobSetTierHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},GU={serializedName:"Blob_setTierExceptionHeaders",type:{name:"Composite",className:"BlobSetTierExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},WU={serializedName:"Blob_getAccountInfoHeaders",type:{name:"Composite",className:"BlobGetAccountInfoHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},skuName:{serializedName:"x-ms-sku-name",xmlName:"x-ms-sku-name",type:{name:"Enum",allowedValues:["Standard_LRS","Standard_GRS","Standard_RAGRS","Standard_ZRS","Premium_LRS"]}},accountKind:{serializedName:"x-ms-account-kind",xmlName:"x-ms-account-kind",type:{name:"Enum",allowedValues:["Storage","BlobStorage","StorageV2","FileStorage","BlockBlobStorage"]}}}}},ZU={serializedName:"Blob_getAccountInfoExceptionHeaders",type:{name:"Composite",className:"BlobGetAccountInfoExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},$U={serializedName:"Blob_queryHeaders",type:{name:"Composite",className:"BlobQueryHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},metadata:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}}},contentLength:{serializedName:"content-length",xmlName:"content-length",type:{name:"Number"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},contentRange:{serializedName:"content-range",xmlName:"content-range",type:{name:"String"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},contentEncoding:{serializedName:"content-encoding",xmlName:"content-encoding",type:{name:"String"}},cacheControl:{serializedName:"cache-control",xmlName:"cache-control",type:{name:"String"}},contentDisposition:{serializedName:"content-disposition",xmlName:"content-disposition",type:{name:"String"}},contentLanguage:{serializedName:"content-language",xmlName:"content-language",type:{name:"String"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},blobType:{serializedName:"x-ms-blob-type",xmlName:"x-ms-blob-type",type:{name:"Enum",allowedValues:["BlockBlob","PageBlob","AppendBlob"]}},copyCompletionTime:{serializedName:"x-ms-copy-completion-time",xmlName:"x-ms-copy-completion-time",type:{name:"DateTimeRfc1123"}},copyStatusDescription:{serializedName:"x-ms-copy-status-description",xmlName:"x-ms-copy-status-description",type:{name:"String"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyProgress:{serializedName:"x-ms-copy-progress",xmlName:"x-ms-copy-progress",type:{name:"String"}},copySource:{serializedName:"x-ms-copy-source",xmlName:"x-ms-copy-source",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},leaseDuration:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Enum",allowedValues:["infinite","fixed"]}},leaseState:{serializedName:"x-ms-lease-state",xmlName:"x-ms-lease-state",type:{name:"Enum",allowedValues:["available","leased","expired","breaking","broken"]}},leaseStatus:{serializedName:"x-ms-lease-status",xmlName:"x-ms-lease-status",type:{name:"Enum",allowedValues:["locked","unlocked"]}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},acceptRanges:{serializedName:"accept-ranges",xmlName:"accept-ranges",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-server-encrypted",xmlName:"x-ms-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},blobContentMD5:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}},contentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}}}},XU={serializedName:"Blob_queryExceptionHeaders",type:{name:"Composite",className:"BlobQueryExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},KU={serializedName:"Blob_getTagsHeaders",type:{name:"Composite",className:"BlobGetTagsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},YU={serializedName:"Blob_getTagsExceptionHeaders",type:{name:"Composite",className:"BlobGetTagsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},JU={serializedName:"Blob_setTagsHeaders",type:{name:"Composite",className:"BlobSetTagsHeaders",modelProperties:{clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},QU={serializedName:"Blob_setTagsExceptionHeaders",type:{name:"Composite",className:"BlobSetTagsExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},eq={serializedName:"PageBlob_createHeaders",type:{name:"Composite",className:"PageBlobCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},tq={serializedName:"PageBlob_createExceptionHeaders",type:{name:"Composite",className:"PageBlobCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},iq={serializedName:"PageBlob_uploadPagesHeaders",type:{name:"Composite",className:"PageBlobUploadPagesHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},nq={serializedName:"PageBlob_uploadPagesExceptionHeaders",type:{name:"Composite",className:"PageBlobUploadPagesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},rq={serializedName:"PageBlob_clearPagesHeaders",type:{name:"Composite",className:"PageBlobClearPagesHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},sq={serializedName:"PageBlob_clearPagesExceptionHeaders",type:{name:"Composite",className:"PageBlobClearPagesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},oq={serializedName:"PageBlob_uploadPagesFromURLHeaders",type:{name:"Composite",className:"PageBlobUploadPagesFromURLHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},aq={serializedName:"PageBlob_uploadPagesFromURLExceptionHeaders",type:{name:"Composite",className:"PageBlobUploadPagesFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},lq={serializedName:"PageBlob_getPageRangesHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},cq={serializedName:"PageBlob_getPageRangesExceptionHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},hq={serializedName:"PageBlob_getPageRangesDiffHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesDiffHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},uq={serializedName:"PageBlob_getPageRangesDiffExceptionHeaders",type:{name:"Composite",className:"PageBlobGetPageRangesDiffExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},dq={serializedName:"PageBlob_resizeHeaders",type:{name:"Composite",className:"PageBlobResizeHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},pq={serializedName:"PageBlob_resizeExceptionHeaders",type:{name:"Composite",className:"PageBlobResizeExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},mq={serializedName:"PageBlob_updateSequenceNumberHeaders",type:{name:"Composite",className:"PageBlobUpdateSequenceNumberHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},blobSequenceNumber:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},fq={serializedName:"PageBlob_updateSequenceNumberExceptionHeaders",type:{name:"Composite",className:"PageBlobUpdateSequenceNumberExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},gq={serializedName:"PageBlob_copyIncrementalHeaders",type:{name:"Composite",className:"PageBlobCopyIncrementalHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},copyId:{serializedName:"x-ms-copy-id",xmlName:"x-ms-copy-id",type:{name:"String"}},copyStatus:{serializedName:"x-ms-copy-status",xmlName:"x-ms-copy-status",type:{name:"Enum",allowedValues:["pending","success","aborted","failed"]}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},_q={serializedName:"PageBlob_copyIncrementalExceptionHeaders",type:{name:"Composite",className:"PageBlobCopyIncrementalExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},yq={serializedName:"AppendBlob_createHeaders",type:{name:"Composite",className:"AppendBlobCreateHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},vq={serializedName:"AppendBlob_createExceptionHeaders",type:{name:"Composite",className:"AppendBlobCreateExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},xq={serializedName:"AppendBlob_appendBlockHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobAppendOffset:{serializedName:"x-ms-blob-append-offset",xmlName:"x-ms-blob-append-offset",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},bq={serializedName:"AppendBlob_appendBlockExceptionHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},wq={serializedName:"AppendBlob_appendBlockFromUrlHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockFromUrlHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},blobAppendOffset:{serializedName:"x-ms-blob-append-offset",xmlName:"x-ms-blob-append-offset",type:{name:"String"}},blobCommittedBlockCount:{serializedName:"x-ms-blob-committed-block-count",xmlName:"x-ms-blob-committed-block-count",type:{name:"Number"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Cq={serializedName:"AppendBlob_appendBlockFromUrlExceptionHeaders",type:{name:"Composite",className:"AppendBlobAppendBlockFromUrlExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Sq={serializedName:"AppendBlob_sealHeaders",type:{name:"Composite",className:"AppendBlobSealHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isSealed:{serializedName:"x-ms-blob-sealed",xmlName:"x-ms-blob-sealed",type:{name:"Boolean"}}}}},Eq={serializedName:"AppendBlob_sealExceptionHeaders",type:{name:"Composite",className:"AppendBlobSealExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Tq={serializedName:"BlockBlob_uploadHeaders",type:{name:"Composite",className:"BlockBlobUploadHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Pq={serializedName:"BlockBlob_uploadExceptionHeaders",type:{name:"Composite",className:"BlockBlobUploadExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Mq={serializedName:"BlockBlob_putBlobFromUrlHeaders",type:{name:"Composite",className:"BlockBlobPutBlobFromUrlHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},kq={serializedName:"BlockBlob_putBlobFromUrlExceptionHeaders",type:{name:"Composite",className:"BlockBlobPutBlobFromUrlExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Aq={serializedName:"BlockBlob_stageBlockHeaders",type:{name:"Composite",className:"BlockBlobStageBlockHeaders",modelProperties:{contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Iq={serializedName:"BlockBlob_stageBlockExceptionHeaders",type:{name:"Composite",className:"BlockBlobStageBlockExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Rq={serializedName:"BlockBlob_stageBlockFromURLHeaders",type:{name:"Composite",className:"BlockBlobStageBlockFromURLHeaders",modelProperties:{contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Oq={serializedName:"BlockBlob_stageBlockFromURLExceptionHeaders",type:{name:"Composite",className:"BlockBlobStageBlockFromURLExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Nq={serializedName:"BlockBlob_commitBlockListHeaders",type:{name:"Composite",className:"BlockBlobCommitBlockListHeaders",modelProperties:{etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},contentMD5:{serializedName:"content-md5",xmlName:"content-md5",type:{name:"ByteArray"}},xMsContentCrc64:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},versionId:{serializedName:"x-ms-version-id",xmlName:"x-ms-version-id",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},isServerEncrypted:{serializedName:"x-ms-request-server-encrypted",xmlName:"x-ms-request-server-encrypted",type:{name:"Boolean"}},encryptionKeySha256:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}},encryptionScope:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Dq={serializedName:"BlockBlob_commitBlockListExceptionHeaders",type:{name:"Composite",className:"BlockBlobCommitBlockListExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},zq={serializedName:"BlockBlob_getBlockListHeaders",type:{name:"Composite",className:"BlockBlobGetBlockListHeaders",modelProperties:{lastModified:{serializedName:"last-modified",xmlName:"last-modified",type:{name:"DateTimeRfc1123"}},etag:{serializedName:"etag",xmlName:"etag",type:{name:"String"}},contentType:{serializedName:"content-type",xmlName:"content-type",type:{name:"String"}},blobContentLength:{serializedName:"x-ms-blob-content-length",xmlName:"x-ms-blob-content-length",type:{name:"Number"}},clientRequestId:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}},requestId:{serializedName:"x-ms-request-id",xmlName:"x-ms-request-id",type:{name:"String"}},version:{serializedName:"x-ms-version",xmlName:"x-ms-version",type:{name:"String"}},date:{serializedName:"date",xmlName:"date",type:{name:"DateTimeRfc1123"}},errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}},Lq={serializedName:"BlockBlob_getBlockListExceptionHeaders",type:{name:"Composite",className:"BlockBlobGetBlockListExceptionHeaders",modelProperties:{errorCode:{serializedName:"x-ms-error-code",xmlName:"x-ms-error-code",type:{name:"String"}}}}};var Bq;!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(Bq||(Bq={}));const Fq={parameterPath:["options","contentType"],mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},jq={parameterPath:"blobServiceProperties",mapper:bj},Vq={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Uq={parameterPath:"url",mapper:{serializedName:"url",required:!0,xmlName:"url",type:{name:"String"}},skipEncoding:!0},qq={parameterPath:"restype",mapper:{defaultValue:"service",isConstant:!0,serializedName:"restype",type:{name:"String"}}},Hq={parameterPath:"comp",mapper:{defaultValue:"properties",isConstant:!0,serializedName:"comp",type:{name:"String"}}},Gq={parameterPath:["options","timeoutInSeconds"],mapper:{constraints:{InclusiveMinimum:0},serializedName:"timeout",xmlName:"timeout",type:{name:"Number"}}},Wq={parameterPath:"version",mapper:{defaultValue:"2023-11-03",isConstant:!0,serializedName:"x-ms-version",type:{name:"String"}}},Zq={parameterPath:["options","requestId"],mapper:{serializedName:"x-ms-client-request-id",xmlName:"x-ms-client-request-id",type:{name:"String"}}},$q={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Xq={parameterPath:"comp",mapper:{defaultValue:"list",isConstant:!0,serializedName:"comp",type:{name:"String"}}},Kq={parameterPath:["options","prefix"],mapper:{serializedName:"prefix",xmlName:"prefix",type:{name:"String"}}},Yq={parameterPath:["options","marker"],mapper:{serializedName:"marker",xmlName:"marker",type:{name:"String"}}},Jq={parameterPath:["options","maxPageSize"],mapper:{constraints:{InclusiveMinimum:1},serializedName:"maxresults",xmlName:"maxresults",type:{name:"Number"}}},Qq={parameterPath:["options","include"],mapper:{serializedName:"include",xmlName:"include",xmlElementName:"ListContainersIncludeType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["metadata","deleted","system"]}}}},collectionFormat:Bq.Csv},eH={parameterPath:"keyInfo",mapper:Oj},tH={parameterPath:"restype",mapper:{defaultValue:"account",isConstant:!0,serializedName:"restype",type:{name:"String"}}},iH={parameterPath:"body",mapper:{serializedName:"body",required:!0,xmlName:"body",type:{name:"Stream"}}},nH={parameterPath:"comp",mapper:{defaultValue:"batch",isConstant:!0,serializedName:"comp",type:{name:"String"}}},rH={parameterPath:"contentLength",mapper:{serializedName:"Content-Length",required:!0,xmlName:"Content-Length",type:{name:"Number"}}},sH={parameterPath:"multipartContentType",mapper:{serializedName:"Content-Type",required:!0,xmlName:"Content-Type",type:{name:"String"}}},oH={parameterPath:"comp",mapper:{defaultValue:"blobs",isConstant:!0,serializedName:"comp",type:{name:"String"}}},aH={parameterPath:["options","where"],mapper:{serializedName:"where",xmlName:"where",type:{name:"String"}}},lH={parameterPath:"restype",mapper:{defaultValue:"container",isConstant:!0,serializedName:"restype",type:{name:"String"}}},cH={parameterPath:["options","metadata"],mapper:{serializedName:"x-ms-meta",xmlName:"x-ms-meta",type:{name:"Dictionary",value:{type:{name:"String"}}},headerCollectionPrefix:"x-ms-meta-"}},hH={parameterPath:["options","access"],mapper:{serializedName:"x-ms-blob-public-access",xmlName:"x-ms-blob-public-access",type:{name:"Enum",allowedValues:["container","blob"]}}},uH={parameterPath:["options","leaseAccessConditions","leaseId"],mapper:{serializedName:"x-ms-lease-id",xmlName:"x-ms-lease-id",type:{name:"String"}}},dH={parameterPath:["options","modifiedAccessConditions","ifModifiedSince"],mapper:{serializedName:"If-Modified-Since",xmlName:"If-Modified-Since",type:{name:"DateTimeRfc1123"}}},pH={parameterPath:["options","modifiedAccessConditions","ifUnmodifiedSince"],mapper:{serializedName:"If-Unmodified-Since",xmlName:"If-Unmodified-Since",type:{name:"DateTimeRfc1123"}}},mH={parameterPath:"comp",mapper:{defaultValue:"metadata",isConstant:!0,serializedName:"comp",type:{name:"String"}}},fH={parameterPath:"comp",mapper:{defaultValue:"acl",isConstant:!0,serializedName:"comp",type:{name:"String"}}},gH={parameterPath:"comp",mapper:{defaultValue:"undelete",isConstant:!0,serializedName:"comp",type:{name:"String"}}},_H={parameterPath:"comp",mapper:{defaultValue:"lease",isConstant:!0,serializedName:"comp",type:{name:"String"}}},yH={parameterPath:"action",mapper:{defaultValue:"acquire",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},vH={parameterPath:["options","duration"],mapper:{serializedName:"x-ms-lease-duration",xmlName:"x-ms-lease-duration",type:{name:"Number"}}},xH={parameterPath:["options","proposedLeaseId"],mapper:{serializedName:"x-ms-proposed-lease-id",xmlName:"x-ms-proposed-lease-id",type:{name:"String"}}},bH={parameterPath:"action",mapper:{defaultValue:"release",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},wH={parameterPath:"leaseId",mapper:{serializedName:"x-ms-lease-id",required:!0,xmlName:"x-ms-lease-id",type:{name:"String"}}},CH={parameterPath:"action",mapper:{defaultValue:"renew",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},SH={parameterPath:"action",mapper:{defaultValue:"break",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},EH={parameterPath:["options","breakPeriod"],mapper:{serializedName:"x-ms-lease-break-period",xmlName:"x-ms-lease-break-period",type:{name:"Number"}}},TH={parameterPath:"action",mapper:{defaultValue:"change",isConstant:!0,serializedName:"x-ms-lease-action",type:{name:"String"}}},PH={parameterPath:"proposedLeaseId",mapper:{serializedName:"x-ms-proposed-lease-id",required:!0,xmlName:"x-ms-proposed-lease-id",type:{name:"String"}}},MH={parameterPath:["options","include"],mapper:{serializedName:"include",xmlName:"include",xmlElementName:"ListBlobsIncludeItem",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["copy","deleted","metadata","snapshots","uncommittedblobs","versions","tags","immutabilitypolicy","legalhold","deletedwithversions"]}}}},collectionFormat:Bq.Csv},kH={parameterPath:["options","snapshot"],mapper:{serializedName:"snapshot",xmlName:"snapshot",type:{name:"String"}}},AH={parameterPath:["options","versionId"],mapper:{serializedName:"versionid",xmlName:"versionid",type:{name:"String"}}},IH={parameterPath:["options","range"],mapper:{serializedName:"x-ms-range",xmlName:"x-ms-range",type:{name:"String"}}},RH={parameterPath:["options","cpkInfo","encryptionKey"],mapper:{serializedName:"x-ms-encryption-key",xmlName:"x-ms-encryption-key",type:{name:"String"}}},OH={parameterPath:["options","cpkInfo","encryptionKeySha256"],mapper:{serializedName:"x-ms-encryption-key-sha256",xmlName:"x-ms-encryption-key-sha256",type:{name:"String"}}},NH={parameterPath:["options","cpkInfo","encryptionAlgorithm"],mapper:{serializedName:"x-ms-encryption-algorithm",xmlName:"x-ms-encryption-algorithm",type:{name:"String"}}},DH={parameterPath:["options","modifiedAccessConditions","ifMatch"],mapper:{serializedName:"If-Match",xmlName:"If-Match",type:{name:"String"}}},zH={parameterPath:["options","modifiedAccessConditions","ifNoneMatch"],mapper:{serializedName:"If-None-Match",xmlName:"If-None-Match",type:{name:"String"}}},LH={parameterPath:["options","modifiedAccessConditions","ifTags"],mapper:{serializedName:"x-ms-if-tags",xmlName:"x-ms-if-tags",type:{name:"String"}}},BH={parameterPath:["options","blobHttpHeaders","blobCacheControl"],mapper:{serializedName:"x-ms-blob-cache-control",xmlName:"x-ms-blob-cache-control",type:{name:"String"}}},FH={parameterPath:["options","blobHttpHeaders","blobContentType"],mapper:{serializedName:"x-ms-blob-content-type",xmlName:"x-ms-blob-content-type",type:{name:"String"}}},jH={parameterPath:["options","blobHttpHeaders","blobContentMD5"],mapper:{serializedName:"x-ms-blob-content-md5",xmlName:"x-ms-blob-content-md5",type:{name:"ByteArray"}}},VH={parameterPath:["options","blobHttpHeaders","blobContentEncoding"],mapper:{serializedName:"x-ms-blob-content-encoding",xmlName:"x-ms-blob-content-encoding",type:{name:"String"}}},UH={parameterPath:["options","blobHttpHeaders","blobContentLanguage"],mapper:{serializedName:"x-ms-blob-content-language",xmlName:"x-ms-blob-content-language",type:{name:"String"}}},qH={parameterPath:["options","blobHttpHeaders","blobContentDisposition"],mapper:{serializedName:"x-ms-blob-content-disposition",xmlName:"x-ms-blob-content-disposition",type:{name:"String"}}},HH={parameterPath:"comp",mapper:{defaultValue:"immutabilityPolicies",isConstant:!0,serializedName:"comp",type:{name:"String"}}},GH={parameterPath:["options","immutabilityPolicyExpiry"],mapper:{serializedName:"x-ms-immutability-policy-until-date",xmlName:"x-ms-immutability-policy-until-date",type:{name:"DateTimeRfc1123"}}},WH={parameterPath:["options","immutabilityPolicyMode"],mapper:{serializedName:"x-ms-immutability-policy-mode",xmlName:"x-ms-immutability-policy-mode",type:{name:"Enum",allowedValues:["Mutable","Unlocked","Locked"]}}},ZH={parameterPath:["options","encryptionScope"],mapper:{serializedName:"x-ms-encryption-scope",xmlName:"x-ms-encryption-scope",type:{name:"String"}}},$H={parameterPath:["options","tier"],mapper:{serializedName:"x-ms-access-tier",xmlName:"x-ms-access-tier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}}},XH={parameterPath:["options","rehydratePriority"],mapper:{serializedName:"x-ms-rehydrate-priority",xmlName:"x-ms-rehydrate-priority",type:{name:"Enum",allowedValues:["High","Standard"]}}},KH={parameterPath:["options","sourceModifiedAccessConditions","sourceIfModifiedSince"],mapper:{serializedName:"x-ms-source-if-modified-since",xmlName:"x-ms-source-if-modified-since",type:{name:"DateTimeRfc1123"}}},YH={parameterPath:["options","sourceModifiedAccessConditions","sourceIfUnmodifiedSince"],mapper:{serializedName:"x-ms-source-if-unmodified-since",xmlName:"x-ms-source-if-unmodified-since",type:{name:"DateTimeRfc1123"}}},JH={parameterPath:["options","sourceModifiedAccessConditions","sourceIfMatch"],mapper:{serializedName:"x-ms-source-if-match",xmlName:"x-ms-source-if-match",type:{name:"String"}}},QH={parameterPath:["options","sourceModifiedAccessConditions","sourceIfNoneMatch"],mapper:{serializedName:"x-ms-source-if-none-match",xmlName:"x-ms-source-if-none-match",type:{name:"String"}}},eG={parameterPath:["options","sourceModifiedAccessConditions","sourceIfTags"],mapper:{serializedName:"x-ms-source-if-tags",xmlName:"x-ms-source-if-tags",type:{name:"String"}}},tG={parameterPath:"copySource",mapper:{serializedName:"x-ms-copy-source",required:!0,xmlName:"x-ms-copy-source",type:{name:"String"}}},iG={parameterPath:["options","blobTagsString"],mapper:{serializedName:"x-ms-tags",xmlName:"x-ms-tags",type:{name:"String"}}},nG={parameterPath:["options","legalHold"],mapper:{serializedName:"x-ms-legal-hold",xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}},rG={parameterPath:["options","sourceContentMD5"],mapper:{serializedName:"x-ms-source-content-md5",xmlName:"x-ms-source-content-md5",type:{name:"ByteArray"}}},sG={parameterPath:["options","copySourceAuthorization"],mapper:{serializedName:"x-ms-copy-source-authorization",xmlName:"x-ms-copy-source-authorization",type:{name:"String"}}},oG={parameterPath:["options","copySourceTags"],mapper:{serializedName:"x-ms-copy-source-tag-option",xmlName:"x-ms-copy-source-tag-option",type:{name:"Enum",allowedValues:["REPLACE","COPY"]}}},aG={parameterPath:["options","queryRequest"],mapper:tV},lG={parameterPath:"comp",mapper:{defaultValue:"tags",isConstant:!0,serializedName:"comp",type:{name:"String"}}},cG={parameterPath:["options","tags"],mapper:Lj},hG={parameterPath:["options","transactionalContentMD5"],mapper:{serializedName:"Content-MD5",xmlName:"Content-MD5",type:{name:"ByteArray"}}},uG={parameterPath:["options","transactionalContentCrc64"],mapper:{serializedName:"x-ms-content-crc64",xmlName:"x-ms-content-crc64",type:{name:"ByteArray"}}},dG={parameterPath:"blobContentLength",mapper:{serializedName:"x-ms-blob-content-length",required:!0,xmlName:"x-ms-blob-content-length",type:{name:"Number"}}},pG={parameterPath:["options","blobSequenceNumber"],mapper:{serializedName:"x-ms-blob-sequence-number",xmlName:"x-ms-blob-sequence-number",type:{name:"Number"}}},mG={parameterPath:["options","contentType"],mapper:{defaultValue:"application/octet-stream",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},fG={parameterPath:"body",mapper:{serializedName:"body",required:!0,xmlName:"body",type:{name:"Stream"}}},gG={parameterPath:"accept",mapper:{defaultValue:"application/xml",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},_G={parameterPath:"comp",mapper:{defaultValue:"page",isConstant:!0,serializedName:"comp",type:{name:"String"}}},yG={parameterPath:"pageWrite",mapper:{defaultValue:"update",isConstant:!0,serializedName:"x-ms-page-write",type:{name:"String"}}},vG={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberLessThanOrEqualTo"],mapper:{serializedName:"x-ms-if-sequence-number-le",xmlName:"x-ms-if-sequence-number-le",type:{name:"Number"}}},xG={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberLessThan"],mapper:{serializedName:"x-ms-if-sequence-number-lt",xmlName:"x-ms-if-sequence-number-lt",type:{name:"Number"}}},bG={parameterPath:["options","sequenceNumberAccessConditions","ifSequenceNumberEqualTo"],mapper:{serializedName:"x-ms-if-sequence-number-eq",xmlName:"x-ms-if-sequence-number-eq",type:{name:"Number"}}},wG={parameterPath:"sourceUrl",mapper:{serializedName:"x-ms-copy-source",required:!0,xmlName:"x-ms-copy-source",type:{name:"String"}}},CG={parameterPath:["options","sourceContentCrc64"],mapper:{serializedName:"x-ms-source-content-crc64",xmlName:"x-ms-source-content-crc64",type:{name:"ByteArray"}}},SG={parameterPath:"comp",mapper:{defaultValue:"pagelist",isConstant:!0,serializedName:"comp",type:{name:"String"}}},EG={parameterPath:"comp",mapper:{defaultValue:"appendblock",isConstant:!0,serializedName:"comp",type:{name:"String"}}},TG={parameterPath:["options","appendPositionAccessConditions","maxSize"],mapper:{serializedName:"x-ms-blob-condition-maxsize",xmlName:"x-ms-blob-condition-maxsize",type:{name:"Number"}}},PG={parameterPath:["options","appendPositionAccessConditions","appendPosition"],mapper:{serializedName:"x-ms-blob-condition-appendpos",xmlName:"x-ms-blob-condition-appendpos",type:{name:"Number"}}},MG={parameterPath:["options","sourceRange"],mapper:{serializedName:"x-ms-source-range",xmlName:"x-ms-source-range",type:{name:"String"}}},kG={parameterPath:"blobType",mapper:{defaultValue:"BlockBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}},AG={parameterPath:"comp",mapper:{defaultValue:"block",isConstant:!0,serializedName:"comp",type:{name:"String"}}},IG={parameterPath:"blockId",mapper:{serializedName:"blockid",required:!0,xmlName:"blockid",type:{name:"String"}}},RG={parameterPath:"blocks",mapper:Xj},OG={parameterPath:"comp",mapper:{defaultValue:"blocklist",isConstant:!0,serializedName:"comp",type:{name:"String"}}};class NG{constructor(e){this.client=e}setProperties(e,t){const i={blobServiceProperties:e,options:XF(t||{})};return this.client.sendOperationRequest(i,zG)}getProperties(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,LG)}getStatistics(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,BG)}listContainersSegment(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,FG)}getUserDelegationKey(e,t){const i={keyInfo:e,options:XF(t||{})};return this.client.sendOperationRequest(i,jG)}getAccountInfo(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,VG)}submitBatch(e,t,i,n){const r={contentLength:e,multipartContentType:t,body:i,options:XF(n||{})};return this.client.sendOperationRequest(r,UG)}filterBlobs(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,qG)}}const DG=new uj(n,!0),zG={path:"/",httpMethod:"PUT",responses:{202:{headersMapper:lV},default:{bodyMapper:Pj,headersMapper:cV}},requestBody:jq,queryParameters:[qq,Hq,Gq],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:DG},LG={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:bj,headersMapper:hV},default:{bodyMapper:Pj,headersMapper:uV}},queryParameters:[qq,Hq,Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:DG},BG={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:Mj,headersMapper:dV},default:{bodyMapper:Pj,headersMapper:pV}},queryParameters:[qq,Gq,{parameterPath:"comp",mapper:{defaultValue:"stats",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:DG},FG={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:Aj,headersMapper:mV},default:{bodyMapper:Pj,headersMapper:fV}},queryParameters:[Gq,Xq,Kq,Yq,Jq,Qq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:DG},jG={path:"/",httpMethod:"POST",responses:{200:{bodyMapper:Nj,headersMapper:gV},default:{bodyMapper:Pj,headersMapper:_V}},requestBody:eH,queryParameters:[qq,Gq,{parameterPath:"comp",mapper:{defaultValue:"userdelegationkey",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:DG},VG={path:"/",httpMethod:"GET",responses:{200:{headersMapper:yV},default:{bodyMapper:Pj,headersMapper:vV}},queryParameters:[Hq,tH],urlParameters:[Uq],headerParameters:[Wq,$q],isXML:!0,serializer:DG},UG={path:"/",httpMethod:"POST",responses:{202:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:xV},default:{bodyMapper:Pj,headersMapper:bV}},requestBody:iH,queryParameters:[Gq,nH],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,rH,sH],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:DG},qG={path:"/",httpMethod:"GET",responses:{200:{bodyMapper:Dj,headersMapper:wV},default:{bodyMapper:Pj,headersMapper:CV}},queryParameters:[Gq,Yq,Jq,oH,aH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:DG};class HG{constructor(e){this.client=e}create(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,WG)}getProperties(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,ZG)}delete(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,$G)}setMetadata(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,XG)}getAccessPolicy(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,KG)}setAccessPolicy(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,YG)}restore(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,JG)}rename(e,t){const i={sourceContainerName:e,options:XF(t||{})};return this.client.sendOperationRequest(i,QG)}submitBatch(e,t,i,n){const r={contentLength:e,multipartContentType:t,body:i,options:XF(n||{})};return this.client.sendOperationRequest(r,eW)}filterBlobs(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,tW)}acquireLease(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,iW)}releaseLease(e,t){const i={leaseId:e,options:XF(t||{})};return this.client.sendOperationRequest(i,nW)}renewLease(e,t){const i={leaseId:e,options:XF(t||{})};return this.client.sendOperationRequest(i,rW)}breakLease(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,sW)}changeLease(e,t,i){const n={leaseId:e,proposedLeaseId:t,options:XF(i||{})};return this.client.sendOperationRequest(n,oW)}listBlobFlatSegment(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,aW)}listBlobHierarchySegment(e,t){const i={delimiter:e,options:XF(t||{})};return this.client.sendOperationRequest(i,lW)}getAccountInfo(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,cW)}}const GG=new uj(n,!0),WG={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:SV},default:{bodyMapper:Pj,headersMapper:EV}},queryParameters:[Gq,lH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,hH,{parameterPath:["options","containerEncryptionScope","defaultEncryptionScope"],mapper:{serializedName:"x-ms-default-encryption-scope",xmlName:"x-ms-default-encryption-scope",type:{name:"String"}}},{parameterPath:["options","containerEncryptionScope","preventEncryptionScopeOverride"],mapper:{serializedName:"x-ms-deny-encryption-scope-override",xmlName:"x-ms-deny-encryption-scope-override",type:{name:"Boolean"}}}],isXML:!0,serializer:GG},ZG={path:"/{containerName}",httpMethod:"GET",responses:{200:{headersMapper:TV},default:{bodyMapper:Pj,headersMapper:PV}},queryParameters:[Gq,lH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH],isXML:!0,serializer:GG},$G={path:"/{containerName}",httpMethod:"DELETE",responses:{202:{headersMapper:MV},default:{bodyMapper:Pj,headersMapper:kV}},queryParameters:[Gq,lH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH],isXML:!0,serializer:GG},XG={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:AV},default:{bodyMapper:Pj,headersMapper:IV}},queryParameters:[Gq,lH,mH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,uH,dH],isXML:!0,serializer:GG},KG={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}},serializedName:"SignedIdentifiers",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier"},headersMapper:RV},default:{bodyMapper:Pj,headersMapper:OV}},queryParameters:[Gq,lH,fH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH],isXML:!0,serializer:GG},YG={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:NV},default:{bodyMapper:Pj,headersMapper:DV}},requestBody:{parameterPath:["options","containerAcl"],mapper:{serializedName:"containerAcl",xmlName:"SignedIdentifiers",xmlIsWrapped:!0,xmlElementName:"SignedIdentifier",type:{name:"Sequence",element:{type:{name:"Composite",className:"SignedIdentifier"}}}}},queryParameters:[Gq,lH,fH],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,hH,uH,dH,pH],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:GG},JG={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:zV},default:{bodyMapper:Pj,headersMapper:LV}},queryParameters:[Gq,lH,gH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,{parameterPath:["options","deletedContainerName"],mapper:{serializedName:"x-ms-deleted-container-name",xmlName:"x-ms-deleted-container-name",type:{name:"String"}}},{parameterPath:["options","deletedContainerVersion"],mapper:{serializedName:"x-ms-deleted-container-version",xmlName:"x-ms-deleted-container-version",type:{name:"String"}}}],isXML:!0,serializer:GG},QG={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:BV},default:{bodyMapper:Pj,headersMapper:FV}},queryParameters:[Gq,lH,{parameterPath:"comp",mapper:{defaultValue:"rename",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,{parameterPath:"sourceContainerName",mapper:{serializedName:"x-ms-source-container-name",required:!0,xmlName:"x-ms-source-container-name",type:{name:"String"}}},{parameterPath:["options","sourceLeaseId"],mapper:{serializedName:"x-ms-source-lease-id",xmlName:"x-ms-source-lease-id",type:{name:"String"}}}],isXML:!0,serializer:GG},eW={path:"/{containerName}",httpMethod:"POST",responses:{202:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:jV},default:{bodyMapper:Pj,headersMapper:VV}},requestBody:iH,queryParameters:[Gq,nH,lH],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,rH,sH],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:GG},tW={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:Dj,headersMapper:UV},default:{bodyMapper:Pj,headersMapper:qV}},queryParameters:[Gq,Yq,Jq,oH,aH,lH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:GG},iW={path:"/{containerName}",httpMethod:"PUT",responses:{201:{headersMapper:HV},default:{bodyMapper:Pj,headersMapper:GV}},queryParameters:[Gq,lH,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,yH,vH,xH],isXML:!0,serializer:GG},nW={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:WV},default:{bodyMapper:Pj,headersMapper:ZV}},queryParameters:[Gq,lH,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,bH,wH],isXML:!0,serializer:GG},rW={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:$V},default:{bodyMapper:Pj,headersMapper:XV}},queryParameters:[Gq,lH,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,wH,CH],isXML:!0,serializer:GG},sW={path:"/{containerName}",httpMethod:"PUT",responses:{202:{headersMapper:KV},default:{bodyMapper:Pj,headersMapper:YV}},queryParameters:[Gq,lH,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,SH,EH],isXML:!0,serializer:GG},oW={path:"/{containerName}",httpMethod:"PUT",responses:{200:{headersMapper:JV},default:{bodyMapper:Pj,headersMapper:QV}},queryParameters:[Gq,lH,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,wH,TH,PH],isXML:!0,serializer:GG},aW={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:Vj,headersMapper:eU},default:{bodyMapper:Pj,headersMapper:tU}},queryParameters:[Gq,Xq,Kq,Yq,Jq,lH,MH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:GG},lW={path:"/{containerName}",httpMethod:"GET",responses:{200:{bodyMapper:Wj,headersMapper:iU},default:{bodyMapper:Pj,headersMapper:nU}},queryParameters:[Gq,Xq,Kq,Yq,Jq,lH,MH,{parameterPath:"delimiter",mapper:{serializedName:"delimiter",required:!0,xmlName:"delimiter",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:GG},cW={path:"/{containerName}",httpMethod:"GET",responses:{200:{headersMapper:rU},default:{bodyMapper:Pj,headersMapper:sU}},queryParameters:[Hq,tH],urlParameters:[Uq],headerParameters:[Wq,$q],isXML:!0,serializer:GG};function hW(e){return function(t,i){const n=HF.getTracer("azure/core-tracing",void 0),r=(null==i?void 0:i.tracingOptions)||{},s=Object.assign({kind:LF.INTERNAL},r.spanOptions),o=e.packagePrefix?`${e.packagePrefix}.${t}`:t;let a;a=function(){var e;if("undefined"==typeof process)return!1;const t=null===(e=process.env.AZURE_TRACING_DISABLED)||void 0===e?void 0:e.toLowerCase();return"false"!==t&&"0"!==t&&Boolean(t)}()?HF.wrapSpanContext(SF):n.startSpan(o,s,r.tracingContext),e.namespace&&a.setAttribute("az.namespace",e.namespace);let l=r.spanOptions||{};a.isRecording()&&e.namespace&&(l=Object.assign(Object.assign({},r.spanOptions),{attributes:Object.assign(Object.assign({},s.attributes),{"az.namespace":e.namespace})}));const c=Object.assign(Object.assign({},r),{spanOptions:l,tracingContext:WF(r.tracingContext||ZF.active(),a)});return{span:a,updatedOptions:Object.assign(Object.assign({},i),{tracingOptions:c})}}}const uW="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let dW,pW=[],mW=[];const fW=[];uW&&_W(uW);const gW=Object.assign(e=>vW(e),{enable:_W,enabled:yW,disable:function(){const e=dW||"";return _W(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function _W(e){dW=e,pW=[],mW=[];const t=/\*/g,i=e.split(",").map(e=>e.trim().replace(t,".*?"));for(const n of i)n.startsWith("-")?mW.push(new RegExp(`^${n.substr(1)}$`)):pW.push(new RegExp(`^${n}$`));for(const n of fW)n.enabled=yW(n.namespace)}function yW(e){if(e.endsWith("*"))return!0;for(const t of mW)if(t.test(e))return!1;for(const t of pW)if(t.test(e))return!0;return!1}function vW(e){const t=Object.assign((function(...i){t.enabled&&(i.length>0&&(i[0]=`${e} ${i[0]}`),t.log(...i))}),{enabled:yW(e),destroy:xW,log:gW.log,namespace:e,extend:bW});return fW.push(t),t}function xW(){const e=fW.indexOf(this);return e>=0&&(fW.splice(e,1),!0)}function bW(e){const t=vW(`${this.namespace}:${e}`);return t.log=this.log,t}var wW=gW;const CW=new Set,SW="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let EW;const TW=wW("azure");TW.log=(...e)=>{wW.log(...e)};const PW=["verbose","info","warning","error"];SW&&(OW(SW)?function(e){if(e&&!OW(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${PW.join(",")}`);EW=e;const t=[];for(const i of CW)RW(i)&&t.push(i.namespace);wW.enable(t.join(","))}(SW):console.error(`AZURE_LOG_LEVEL set to unknown log level '${SW}'; logging is not enabled. Acceptable values: ${PW.join(", ")}.`));const MW={verbose:400,info:300,warning:200,error:100};function kW(e){const t=TW.extend(e);return AW(TW,t),{error:IW(t,"error"),warning:IW(t,"warning"),info:IW(t,"info"),verbose:IW(t,"verbose")}}function AW(e,t){t.log=(...t)=>{e.log(...t)}}function IW(e,t){const i=Object.assign(e.extend(t),{level:t});if(AW(e,i),RW(i)){const e=wW.disable();wW.enable(e+","+i.namespace)}return CW.add(i),i}function RW(e){return Boolean(EW&&MW[e.level]<=MW[EW])}function OW(e){return PW.includes(e)}const NW=kW("core-http"),DW=hW({packagePrefix:"",namespace:""});function zW(e={}){return{create:(t,i)=>new LW(t,i,e)}}class LW extends YB{constructor(e,t,i){super(e,t),this.userAgent=i.userAgent}async sendRequest(e){if(!e.tracingContext)return this._nextPolicy.sendRequest(e);const t=this.tryCreateSpan(e);if(!t)return this._nextPolicy.sendRequest(e);try{const i=await this._nextPolicy.sendRequest(e);return this.tryProcessResponse(t,i),i}catch(T0){throw this.tryProcessError(t,T0),T0}}tryCreateSpan(e){var t;try{const{span:i}=DW("HTTP "+e.method,{tracingOptions:{spanOptions:Object.assign(Object.assign({},e.spanOptions),{kind:LF.CLIENT}),tracingContext:e.tracingContext}});if(!i.isRecording())return void i.end();const n=null===(t=e.tracingContext)||void 0===t?void 0:t.getValue(Symbol.for("az.namespace"));"string"==typeof n&&i.setAttribute("az.namespace",n),i.setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&i.setAttribute("http.user_agent",this.userAgent);const r=i.spanContext(),s=function(e){const t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),t.length)return;const i=(e.traceFlags||0).toString(16);return`00-${e.traceId}-${e.spanId}-${1===i.length?"0"+i:i}`}(r);if(s&&HF.isSpanContextValid(r)){e.headers.set("traceparent",s);const t=r.traceState&&r.traceState.serialize();t&&e.headers.set("tracestate",t)}return i}catch(i){return void NW.warning("Skipping creating a tracing span due to an error: "+i.message)}}tryProcessError(e,t){try{e.setStatus({code:$F.ERROR,message:t.message}),t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(i){NW.warning("Skipping tracing span processing due to an error: "+i.message)}}tryProcessResponse(e,t){try{e.setAttribute("http.status_code",t.status);const i=t.headers.get("x-ms-request-id");i&&e.setAttribute("serviceRequestId",i),e.setStatus({code:$F.OK}),e.end()}catch(i){NW.warning("Skipping tracing span processing due to an error: "+i.message)}}}const BW={enable:!0};class FW extends YB{constructor(e,t,i){super(e,t),this.keepAliveOptions=i}async sendRequest(e){return e.keepAlive=this.keepAliveOptions.enable,this._nextPolicy.sendRequest(e)}}function jW(e="x-ms-client-request-id"){return{create:(t,i)=>new VW(t,i,e)}}class VW extends YB{constructor(e,t,i){super(e,t),this._requestIdHeaderName=i}sendRequest(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)}}class UW{constructor(){this._rawQuery={}}any(){return Object.keys(this._rawQuery).length>0}keys(){return Object.keys(this._rawQuery)}set(e,t){const i=t;if(e)if(null!=i){const t=Array.isArray(i)?i:i.toString();this._rawQuery[e]=t}else delete this._rawQuery[e]}get(e){return e?this._rawQuery[e]:void 0}toString(){let e="";for(const t in this._rawQuery){e&&(e+="&");const i=this._rawQuery[t];if(Array.isArray(i)){const n=[];for(const e of i)n.push(`${t}=${e}`);e+=n.join("&")}else e+=`${t}=${i}`}return e}static parse(e){const t=new UW;if(e){e.startsWith("?")&&(e=e.substring(1));let i="ParameterName",n="",r="";for(let s=0;s<e.length;++s){const o=e[s];switch(i){case"ParameterName":switch(o){case"=":i="ParameterValue";break;case"&":n="",r="";break;default:n+=o}break;case"ParameterValue":switch(o){case"&":t.set(n,r),n="",r="",i="ParameterName";break;default:r+=o}break;default:throw new Error("Unrecognized URLQuery parse state: "+i)}}"ParameterValue"===i&&t.set(n,r)}return t}}class qW{setScheme(e){e?this.set(e,"SCHEME"):this._scheme=void 0}getScheme(){return this._scheme}setHost(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0}getHost(){return this._host}setPort(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")}getPort(){return this._port}setPath(e){if(e){const t=e.indexOf("://");if(-1!==t){const i=e.lastIndexOf("/",t);this.set(-1===i?e:e.substr(i+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0}appendPath(e){if(e){let t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}}getPath(){return this._path}setQuery(e){this._query=e?UW.parse(e):void 0}setQueryParameter(e,t){e&&(this._query||(this._query=new UW),this._query.set(e,t))}getQueryParameterValue(e){return this._query?this._query.get(e):void 0}getQuery(){return this._query?this._query.toString():void 0}set(e,t){const i=new GW(e,t);for(;i.next();){const e=i.current();let t;if(e)switch(e.type){case"SCHEME":this._scheme=e.text||void 0;break;case"HOST":this._host=e.text||void 0;break;case"PORT":this._port=e.text||void 0;break;case"PATH":t=e.text||void 0,this._path&&"/"!==this._path&&"/"===t||(this._path=t);break;case"QUERY":this._query=UW.parse(e.text);break;default:throw new Error("Unrecognized URLTokenType: "+e.type)}}}toString(){let e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e}replaceAll(e,t){e&&(this.setScheme(hj(this.getScheme(),e,t)),this.setHost(hj(this.getHost(),e,t)),this.setPort(hj(this.getPort(),e,t)),this.setPath(hj(this.getPath(),e,t)),this.setQuery(hj(this.getQuery(),e,t)))}static parse(e){const t=new qW;return t.set(e,"SCHEME_OR_HOST"),t}}class HW{constructor(e,t){this.text=e,this.type=t}static scheme(e){return new HW(e,"SCHEME")}static host(e){return new HW(e,"HOST")}static port(e){return new HW(e,"PORT")}static path(e){return new HW(e,"PATH")}static query(e){return new HW(e,"QUERY")}}class GW{constructor(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}current(){return this._currentToken}next(){if(WW(this))switch(this._currentState){case"SCHEME":!function(e){const t=function(e){return KW(e,e=>function(e){const t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e))}(e);e._currentToken=HW.scheme(t),e._currentState=WW(e)?"HOST":"DONE"}(this);break;case"SCHEME_OR_HOST":!function(e){const t=YW(e,":","/","?");WW(e)?":"===ZW(e)?"://"===XW(e,3)?(e._currentToken=HW.scheme(t),e._currentState="HOST"):(e._currentToken=HW.host(t),e._currentState="PORT"):(e._currentToken=HW.host(t),e._currentState="/"===ZW(e)?"PATH":"QUERY"):(e._currentToken=HW.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===XW(e,3)&&$W(e,3);const t=YW(e,":","/","?");e._currentToken=HW.host(t),e._currentState=WW(e)?":"===ZW(e)?"PORT":"/"===ZW(e)?"PATH":"QUERY":"DONE"}(this);break;case"PORT":!function(e){":"===ZW(e)&&$W(e);const t=YW(e,"/","?");e._currentToken=HW.port(t),e._currentState=WW(e)?"/"===ZW(e)?"PATH":"QUERY":"DONE"}(this);break;case"PATH":!function(e){const t=YW(e,"?");e._currentToken=HW.path(t),e._currentState=WW(e)?"QUERY":"DONE"}(this);break;case"QUERY":!function(e){"?"===ZW(e)&&$W(e);const t=function(e){let t="";return e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength),t}(e);e._currentToken=HW.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;return!!this._currentToken}}function WW(e){return e._currentIndex<e._textLength}function ZW(e){return e._text[e._currentIndex]}function $W(e,t){WW(e)&&(t||(t=1),e._currentIndex+=t)}function XW(e,t){let i=e._currentIndex+t;return e._textLength<i&&(i=e._textLength),e._text.substring(e._currentIndex,i)}function KW(e,t){let i="";for(;WW(e);){const n=ZW(e);if(!t(n))break;i+=n,$W(e)}return i}function YW(e,...t){return KW(e,e=>-1===t.indexOf(e))}const JW=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],QW=["api-version"];class eZ{constructor({allowedHeaderNames:e=[],allowedQueryParameters:t=[]}={}){e=Array.isArray(e)?JW.concat(e):JW,t=Array.isArray(t)?QW.concat(t):QW,this.allowedHeaderNames=new Set(e.map(e=>e.toLowerCase())),this.allowedQueryParameters=new Set(t.map(e=>e.toLowerCase()))}sanitize(e){const t=new Set;return JSON.stringify(e,(e,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if("_headersMap"===e)return this.sanitizeHeaders(i);if("url"===e)return this.sanitizeUrl(i);if("query"===e)return this.sanitizeQuery(i);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(i)||!("object"!=typeof(n=i)||null===n||Array.isArray(n)||n instanceof RegExp||n instanceof Date)){if(t.has(i))return"[Circular]";t.add(i)}var n;return i}},2)}sanitizeHeaders(e){return this.sanitizeObject(e,this.allowedHeaderNames,(e,t)=>e[t].value)}sanitizeQuery(e){return this.sanitizeObject(e,this.allowedQueryParameters,(e,t)=>e[t])}sanitizeObject(e,t,i){if("object"!=typeof e||null===e)return e;const n={};for(const r of Object.keys(e))n[r]=t.has(r.toLowerCase())?i(e,r):"REDACTED";return n}sanitizeUrl(e){if("string"!=typeof e||null===e)return e;const t=qW.parse(e),i=t.getQuery();if(!i)return e;const n=UW.parse(i);for(const r of n.keys())this.allowedQueryParameters.has(r.toLowerCase())||n.set(r,"REDACTED");return t.setQuery(n.toString()),t.toString()}}const tZ={},iZ=new eZ;class nZ extends Error{constructor(e,t,i,n,r){super(e),this.name="RestError",this.code=t,this.statusCode=i,this.request=n,this.response=r,Object.setPrototypeOf(this,nZ.prototype)}[tZ](){return`RestError: ${this.message} \n ${iZ.sanitize(this)}`}}if(nZ.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",nZ.PARSE_ERROR="PARSE_ERROR",!(self.document&&self.DOMParser&&self.Node&&self.XMLSerializer))throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');let rZ,sZ,oZ,aZ,lZ;function cZ(){return rZ||(rZ=document.implementation.createDocument(null,null,null)),rZ}function hZ(){return sZ||(sZ=new DOMParser),sZ}function uZ(e,t={}){var i,n,r;const s={rootName:null!==(i=t.rootName)&&void 0!==i?i:"root",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(r=t.xmlCharKey)&&void 0!==r?r:"_"},o=function e(t,i,n){if(null==t||"string"==typeof t||"number"==typeof t||"boolean"==typeof t){const e=cZ().createElement(i);return e.textContent=null==t?"":t.toString(),[e]}if(Array.isArray(t)){const r=[];for(const s of t)for(const t of e(s,i,n))r.push(t);return r}if("object"==typeof t){const r=cZ().createElement(i);for(const i of Object.keys(t))if(i===JF)for(const e of dZ(t[i]))r.attributes.setNamedItem(e);else if(i===n.xmlCharKey)r.textContent=t[i].toString();else for(const s of e(t[i],i,n))r.appendChild(s);return[r]}throw new Error("Illegal value passed to buildObject: "+t)}(e,s.rootName,s)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(oZ||(oZ=new XMLSerializer),oZ).serializeToString(o)}function dZ(e){const t=[];for(const i of Object.keys(e)){const n=cZ().createAttribute(i);n.value=e[i].toString(),t.push(n)}return t}function pZ(e,t){return{create:(i,n)=>new gZ(i,n,e,t)}}void 0!==self.trustedTypes&&(aZ=self.trustedTypes.createPolicy("@azure/core-http#xml.browser",{createHTML:e=>e}));const mZ=["application/json","text/json"],fZ=["application/xml","application/atom+xml"];class gZ extends YB{constructor(e,t,i,n={}){var r;super(e,t),this.jsonContentTypes=i&&i.json||mZ,this.xmlContentTypes=i&&i.xml||fZ,this.xmlCharKey=null!==(r=n.xmlCharKey)&&void 0!==r?r:"_"}async sendRequest(e){return this._nextPolicy.sendRequest(e).then(e=>function(e,t,i,n={}){var r,s,o;const a={rootName:null!==(r=n.rootName)&&void 0!==r?r:"",includeRoot:null!==(s=n.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(o=n.xmlCharKey)&&void 0!==o?o:"_"};return function(e,t,i,n){var r;const s=e=>{const t=new nZ(`Error "${e}" occurred while parsing the response body - ${i.bodyAsText}.`,e.code||nZ.PARSE_ERROR,i.status,i.request,i);return Promise.reject(t)};if(!(null===(r=i.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(i.status))&&!i.request.streamResponseBody&&i.bodyAsText){const r=i.bodyAsText,o=i.headers.get("Content-Type")||"",a=o?o.split(";").map(e=>e.toLowerCase()):[];if(0===a.length||a.some(t=>-1!==e.indexOf(t)))return new Promise(e=>{i.parsedBody=JSON.parse(r),e(i)}).catch(s);if(a.some(e=>-1!==t.indexOf(e)))return function(e,t={}){var i,n,r,s;try{const o={rootName:null!==(i=t.rootName)&&void 0!==i?i:"",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(r=t.xmlCharKey)&&void 0!==r?r:"_"},a=hZ().parseFromString(null!==(s=null==aZ?void 0:aZ.createHTML(e))&&void 0!==s?s:e,"application/xml");let l;return function(e){const t=e.getElementsByTagName("parsererror");if(t.length>0&&function(){var e,t;if(void 0===lZ)try{const i=null!==(e=null==aZ?void 0:aZ.createHTML("INVALID"))&&void 0!==e?e:"INVALID";lZ=null!==(t=hZ().parseFromString(i,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==t?t:""}catch(i){lZ=""}return lZ}())for(let i=0;i<t.length;i++)if(t[i].namespaceURI===lZ)throw new Error(t[i].innerHTML)}(a),l=function e(t,i){let n={};const r=t.childNodes.length,s=t.childNodes[0],o=s&&1===r&&s.nodeType===Node.TEXT_NODE&&s.nodeValue||void 0,a=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(t);if(a){n[JF]={};for(let e=0;e<a.attributes.length;e++){const t=a.attributes[e];n[JF][t.nodeName]=t.nodeValue}o&&(n[i.xmlCharKey]=o)}else 0===r?n="":o&&(n=o);if(!o)for(let l=0;l<r;l++){const r=t.childNodes[l];if(r.nodeType!==Node.TEXT_NODE){const t=e(r,i);n[r.nodeName]?Array.isArray(n[r.nodeName])?n[r.nodeName].push(t):n[r.nodeName]=[n[r.nodeName],t]:n[r.nodeName]=t}}return n}(o.includeRoot?a:a.childNodes[0],o),Promise.resolve(l)}catch(T0){return Promise.reject(T0)}}(r,n).then(e=>(i.parsedBody=e,i)).catch(s)}return Promise.resolve(i)}(e,t,i,a).then(e=>{if(!function(e){const t=e.request.shouldDeserialize;let i;return i=void 0===t||("boolean"==typeof t?t:t(e)),i}(e))return e;const t=e.request.operationSpec;if(!t||!t.responses)return e;const r=function(e){let t;const i=e.request,n=i.operationSpec;if(n){const r=i.operationResponseGetter;t=r?r(n,e):n.responses[e.status]}return t}(e),{error:s,shouldReturnResponse:o}=function(e,t,i){var n;const r=200<=e.status&&e.status<300;if(function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?r:i){if(!i)return{error:null,shouldReturnResponse:!1};if(!i.isError)return{error:null,shouldReturnResponse:!1}}const s=null!=i?i:t.responses.default,o=(null===(n=e.request.streamResponseStatusCodes)||void 0===n?void 0:n.has(e.status))||e.request.streamResponseBody,a=new nZ(o?"Unexpected status code: "+e.status:e.bodyAsText,void 0,e.status,e.request,e);if(!s)throw a;const l=s.bodyMapper,c=s.headersMapper;try{if(e.parsedBody){const i=e.parsedBody;let n;if(l){let e=i;t.isXML&&l.type.name===xj.Sequence&&(e="object"==typeof i?i[l.xmlElementName]:[]),n=t.serializer.deserialize(l,e,"error.response.parsedBody")}const r=i.error||n||i;a.code=r.code,r.message&&(a.message=r.message),l&&(a.response.parsedBody=n)}e.headers&&c&&(a.response.parsedHeaders=t.serializer.deserialize(c,e.headers.toJson(),"operationRes.parsedHeaders"))}catch(h){a.message=`Error "${h.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:a,shouldReturnResponse:!1}}(e,t,r);if(s)throw s;if(o)return e;if(r){if(r.bodyMapper){let i=e.parsedBody;t.isXML&&r.bodyMapper.type.name===xj.Sequence&&(i="object"==typeof i?i[r.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(r.bodyMapper,i,"operationRes.parsedBody",n)}catch(a){throw new nZ(`Error ${a} occurred in deserializing the responseBody - ${e.bodyAsText}`,void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=i.status>=200&&i.status<300);r.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(r.headersMapper,e.headers.toJson(),"operationRes.parsedHeaders",n))}return e})}(this.jsonContentTypes,this.xmlContentTypes,e,{xmlCharKey:this.xmlCharKey}))}}function _Z(e={}){return{create:(t,i)=>new yZ(t,i,e)}}class yZ extends YB{constructor(e,t,{logger:i=NW.info,allowedHeaderNames:n=[],allowedQueryParameters:r=[]}={}){super(e,t),this.logger=i,this.sanitizer=new eZ({allowedHeaderNames:n,allowedQueryParameters:r})}get allowedHeaderNames(){return this.sanitizer.allowedHeaderNames}set allowedHeaderNames(e){this.sanitizer.allowedHeaderNames=e}get allowedQueryParameters(){return this.sanitizer.allowedQueryParameters}set allowedQueryParameters(e){this.sanitizer.allowedQueryParameters=e}sendRequest(e){return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then(e=>this.logResponse(e))):this._nextPolicy.sendRequest(e)}logRequest(e){this.logger("Request: "+this.sanitizer.sanitize(e))}logResponse(e){return this.logger("Response status code: "+e.status),this.logger("Headers: "+this.sanitizer.sanitize(e.headers)),e}}const vZ=kW("storage-blob"),xZ=["Access-Control-Allow-Origin","Cache-Control","Content-Length","Content-Type","Date","Request-Id","traceparent","Transfer-Encoding","User-Agent","x-ms-client-request-id","x-ms-date","x-ms-error-code","x-ms-request-id","x-ms-return-client-request-id","x-ms-version","Accept-Ranges","Content-Disposition","Content-Encoding","Content-Language","Content-MD5","Content-Range","ETag","Last-Modified","Server","Vary","x-ms-content-crc64","x-ms-copy-action","x-ms-copy-completion-time","x-ms-copy-id","x-ms-copy-progress","x-ms-copy-status","x-ms-has-immutability-policy","x-ms-has-legal-hold","x-ms-lease-state","x-ms-lease-status","x-ms-range","x-ms-request-server-encrypted","x-ms-server-encrypted","x-ms-snapshot","x-ms-source-range","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","x-ms-access-tier","x-ms-access-tier-change-time","x-ms-access-tier-inferred","x-ms-account-kind","x-ms-archive-status","x-ms-blob-append-offset","x-ms-blob-cache-control","x-ms-blob-committed-block-count","x-ms-blob-condition-appendpos","x-ms-blob-condition-maxsize","x-ms-blob-content-disposition","x-ms-blob-content-encoding","x-ms-blob-content-language","x-ms-blob-content-length","x-ms-blob-content-md5","x-ms-blob-content-type","x-ms-blob-public-access","x-ms-blob-sequence-number","x-ms-blob-type","x-ms-copy-destination-snapshot","x-ms-creation-time","x-ms-default-encryption-scope","x-ms-delete-snapshots","x-ms-delete-type-permanent","x-ms-deny-encryption-scope-override","x-ms-encryption-algorithm","x-ms-if-sequence-number-eq","x-ms-if-sequence-number-le","x-ms-if-sequence-number-lt","x-ms-incremental-copy","x-ms-lease-action","x-ms-lease-break-period","x-ms-lease-duration","x-ms-lease-id","x-ms-lease-time","x-ms-page-write","x-ms-proposed-lease-id","x-ms-range-get-content-md5","x-ms-rehydrate-priority","x-ms-sequence-number-action","x-ms-sku-name","x-ms-source-content-md5","x-ms-source-if-match","x-ms-source-if-modified-since","x-ms-source-if-none-match","x-ms-source-if-unmodified-since","x-ms-tag-count","x-ms-encryption-key-sha256","x-ms-if-tags","x-ms-source-if-tags"],bZ=["comp","maxresults","rscc","rscd","rsce","rscl","rsct","se","si","sip","sp","spr","sr","srt","ss","st","sv","include","marker","prefix","copyid","restype","blockid","blocklisttype","delimiter","prevsnapshot","ske","skoid","sks","skt","sktid","skv","snapshot"],wZ=["10000","10001","10002","10003","10004","10100","10101","10102","10103","10104","11000","11001","11002","11003","11004","11100","11101","11102","11103","11104"];function CZ(e){return e.toLowerCase()}function SZ(e){if(e&&"object"==typeof e){const t=e;if("function"==typeof t.rawHeaders&&"function"==typeof t.clone&&"function"==typeof t.get&&"function"==typeof t.set&&"function"==typeof t.contains&&"function"==typeof t.remove&&"function"==typeof t.headersArray&&"function"==typeof t.headerValues&&"function"==typeof t.headerNames&&"function"==typeof t.toJson)return!0}return!1}class EZ{constructor(e){if(this._headersMap={},e)for(const t in e)this.set(t,e[t])}set(e,t){this._headersMap[CZ(e)]={name:e,value:t.toString().trim()}}get(e){const t=this._headersMap[CZ(e)];return t?t.value:void 0}contains(e){return!!this._headersMap[CZ(e)]}remove(e){const t=this.contains(e);return delete this._headersMap[CZ(e)],t}rawHeaders(){return this.toJson({preserveCase:!0})}headersArray(){const e=[];for(const t in this._headersMap)e.push(this._headersMap[t]);return e}headerNames(){const e=[],t=this.headersArray();for(let i=0;i<t.length;++i)e.push(t[i].name);return e}headerValues(){const e=[],t=this.headersArray();for(let i=0;i<t.length;++i)e.push(t[i].value);return e}toJson(e={}){const t={};if(e.preserveCase)for(const i in this._headersMap){const e=this._headersMap[i];t[e.name]=e.value}else for(const i in this._headersMap){const e=this._headersMap[i];t[CZ(e.name)]=e.value}return t}toString(){return JSON.stringify(this.toJson({preserveCase:!0}))}clone(){const e={};for(const t in this._headersMap){const i=this._headersMap[t];e[i.name]=i.value}return new EZ(e)}}function TZ(e,t){const i=e.split(";");for(const n of i)if(n.trim().startsWith(t))return n.trim().match(t+"=(.*)")[1];return""}function PZ(e){let t="";e.startsWith("UseDevelopmentStorage=true")&&(t=function(e){let t="";if(-1!==e.search("DevelopmentStorageProxyUri=")){const i=e.split(";");for(const e of i)e.trim().startsWith("DevelopmentStorageProxyUri=")&&(t=e.trim().match("DevelopmentStorageProxyUri=(.*)")[1])}return t}(e),e="DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;");let i=TZ(e,"BlobEndpoint");if(i=i.endsWith("/")?i.slice(0,-1):i,-1!==e.search("DefaultEndpointsProtocol=")&&-1!==e.search("AccountKey=")){let n="",r="",s=Buffer.from("accountKey","base64"),o="";if(r=TZ(e,"AccountName"),s=Buffer.from(TZ(e,"AccountKey"),"base64"),!i){n=TZ(e,"DefaultEndpointsProtocol");const t=n.toLowerCase();if("https"!==t&&"http"!==t)throw new Error("Invalid DefaultEndpointsProtocol in the provided Connection String. Expecting 'https' or 'http'");if(o=TZ(e,"EndpointSuffix"),!o)throw new Error("Invalid EndpointSuffix in the provided Connection String");i=`${n}://${r}.blob.${o}`}if(!r)throw new Error("Invalid AccountName in the provided Connection String");if(0===s.length)throw new Error("Invalid AccountKey in the provided Connection String");return{kind:"AccountConnString",url:i,accountName:r,accountKey:s,proxyUri:t}}{const t=TZ(e,"SharedAccessSignature");let n=TZ(e,"AccountName");if(n||(n=LZ(i)),!i)throw new Error("Invalid BlobEndpoint in the provided SAS Connection String");if(!t)throw new Error("Invalid SharedAccessSignature in the provided SAS Connection String");return{kind:"SASConnString",url:i,accountName:n,accountSas:t}}}function MZ(e,t){const i=qW.parse(e);let n=i.getPath();return n=n?n.endsWith("/")?`${n}${t}`:`${n}/${t}`:t,i.setPath(n),new URL(i.toString()).toString()}function kZ(e,t,i){const n=qW.parse(e);return n.setQueryParameter(t,i),n.toString()}function AZ(e,t){return qW.parse(e).getQueryParameterValue(t)}function IZ(e){return qW.parse(e).getPath()}function RZ(e){const t=qW.parse(e),i=t.getPath();if(!i)throw new RangeError("Invalid url without valid path.");let n=t.getQuery()||"";return n=n.trim(),""!==n&&(n=n.startsWith("?")?n:"?"+n),`${i}${n}`}function OZ(e,t){const i=qW.parse(e);let n=i.getQuery();return n?n+="&"+t:n=t,i.setQuery(n),i.toString()}function NZ(e,t=!0){const i=e.toISOString();return t?i.substring(0,i.length-1)+"0000Z":i.substring(0,i.length-5)+"Z"}function DZ(e,t){return e.length>42&&(e=e.slice(0,42)),i=e+function(e,t,i=" "){return String.prototype.padStart?e.padStart(t,i):(i=i||" ",e.length>t?e:((t-=e.length)>i.length&&(i+=i.repeat(t/i.length)),i.slice(0,t)+e))}(t.toString(),48-e.length,"0"),$B?Buffer.from(i).toString("base64"):btoa(i);var i}function zZ(e,t){return e.toLocaleLowerCase()===t.toLocaleLowerCase()}function LZ(e){const t=qW.parse(e);let i;try{return i="blob"===t.getHost().split(".")[1]?t.getHost().split(".")[0]:BZ(t)?t.getPath().split("/")[1]:"",i}catch(n){throw new Error("Unable to extract accountName with provided information.")}}function BZ(e){if(void 0===e.getHost())return!1;const t=e.getHost()+(void 0===e.getPort()?"":":"+e.getPort());return/^.*:.*:.*$|^(localhost|host.docker.internal)(:[0-9]+)?$|^(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])){3}(:[0-9]+)?$/.test(t)||void 0!==e.getPort()&&wZ.includes(e.getPort())}function FZ(e){if(void 0===e)return;const t=[];for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const n=e[i];t.push(`${encodeURIComponent(i)}=${encodeURIComponent(n)}`)}return t.join("&")}function jZ(e){if(void 0===e)return;const t={blobTagSet:[]};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.blobTagSet.push({key:i,value:e[i]});return t}function VZ(e){if(void 0===e)return;const t={};for(const i of e.blobTagSet)t[i.key]=i.value;return t}function UZ(e){if(void 0!==e)switch(e.kind){case"csv":return{format:{type:"delimited",delimitedTextConfiguration:{columnSeparator:e.columnSeparator||",",fieldQuote:e.fieldQuote||"",recordSeparator:e.recordSeparator,escapeChar:e.escapeCharacter||"",headersPresent:e.hasHeaders||!1}}};case"json":return{format:{type:"json",jsonTextConfiguration:{recordSeparator:e.recordSeparator}}};case"arrow":return{format:{type:"arrow",arrowConfiguration:{schema:e.schema}}};case"parquet":return{format:{type:"parquet"}};default:throw Error("Invalid BlobQueryTextConfiguration.")}}function qZ(e){if(!e)return;if("policy-id"in e)return;const t=[];for(const i in e){const n=i.split("_"),r="or-";n[0].startsWith(r)&&(n[0]=n[0].substring(r.length));const s={ruleId:n[1],replicationStatus:e[i]},o=t.findIndex(e=>e.policyId===n[0]);o>-1?t[o].rules.push(s):t.push({policyId:n[0],rules:[s]})}return t}function HZ(e,t){return e.credential=t,e}function GZ(e){return e?e.scheme+" "+e.value:void 0}function WZ(e){return e.encoded?decodeURIComponent(e.content):e.content}function ZZ(e){var t;return Object.assign(Object.assign({},e),{segment:{blobPrefixes:null===(t=e.segment.blobPrefixes)||void 0===t?void 0:t.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name)})),blobItems:e.segment.blobItems.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name)}))}})}function*$Z(e){let t=[],i=[];e.pageRange&&(t=e.pageRange),e.clearRange&&(i=e.clearRange);let n=0,r=0;for(;n<t.length&&r<i.length;)t[n].start<i[r].start?(yield{start:t[n].start,end:t[n].end,isClear:!1},++n):(yield{start:i[r].start,end:i[r].end,isClear:!0},++r);for(;n<t.length;++n)yield{start:t[n].start,end:t[n].end,isClear:!1};for(;r<i.length;++r)yield{start:i[r].start,end:i[r].end,isClear:!0}}function XZ(e){const t=e.split("/");for(let i=0;i<t.length;i++)t[i]=encodeURIComponent(t[i]);return t.join("/")}class KZ extends YB{constructor(e,t){super(e,t)}async sendRequest(e){return $B||("GET"!==e.method.toUpperCase()&&"HEAD"!==e.method.toUpperCase()||(e.url=kZ(e.url,"_",(new Date).getTime().toString())),e.headers.remove("Cookie"),e.headers.remove("Content-Length")),this._nextPolicy.sendRequest(e)}}class YZ{create(e,t){return new KZ(e,t)}}new WeakMap,new WeakMap;class JZ extends Error{constructor(e){super(e),this.name="AbortError"}}var QZ;!function(e){e[e.EXPONENTIAL=0]="EXPONENTIAL",e[e.FIXED=1]="FIXED"}(QZ||(QZ={}));const e$={maxRetryDelayInMs:12e4,maxTries:4,retryDelayInMs:4e3,retryPolicyType:QZ.EXPONENTIAL,secondaryHost:"",tryTimeoutInMs:void 0},t$=new JZ("The operation was aborted.");class i$ extends YB{constructor(e,t,i=e$){super(e,t),this.retryOptions={retryPolicyType:i.retryPolicyType?i.retryPolicyType:e$.retryPolicyType,maxTries:i.maxTries&&i.maxTries>=1?Math.floor(i.maxTries):e$.maxTries,tryTimeoutInMs:i.tryTimeoutInMs&&i.tryTimeoutInMs>=0?i.tryTimeoutInMs:e$.tryTimeoutInMs,retryDelayInMs:i.retryDelayInMs&&i.retryDelayInMs>=0?Math.min(i.retryDelayInMs,i.maxRetryDelayInMs?i.maxRetryDelayInMs:e$.maxRetryDelayInMs):e$.retryDelayInMs,maxRetryDelayInMs:i.maxRetryDelayInMs&&i.maxRetryDelayInMs>=0?i.maxRetryDelayInMs:e$.maxRetryDelayInMs,secondaryHost:i.secondaryHost?i.secondaryHost:e$.secondaryHost}}async sendRequest(e){return this.attemptSendRequest(e,!1,1)}async attemptSendRequest(e,t,i){const n=e.clone(),r=t||!this.retryOptions.secondaryHost||!("GET"===e.method||"HEAD"===e.method||"OPTIONS"===e.method)||i%2==1;let s;r||(n.url=function(e,t){const i=qW.parse(e);return i.setHost(t),i.toString()}(n.url,this.retryOptions.secondaryHost)),this.retryOptions.tryTimeoutInMs&&(n.url=kZ(n.url,"timeout",Math.floor(this.retryOptions.tryTimeoutInMs/1e3).toString()));try{if(vZ.info(`RetryPolicy: =====> Try=${i} ${r?"Primary":"Secondary"}`),s=await this._nextPolicy.sendRequest(n),!this.shouldRetry(r,i,s))return s;t=t||!r&&404===s.status}catch(T0){if(vZ.error(`RetryPolicy: Caught error, message: ${T0.message}, code: ${T0.code}`),!this.shouldRetry(r,i,s,T0))throw T0}return await this.delay(r,i,e.abortSignal),this.attemptSendRequest(e,t,++i)}shouldRetry(e,t,i,n){if(t>=this.retryOptions.maxTries)return vZ.info(`RetryPolicy: Attempt(s) ${t} >= maxTries ${this.retryOptions.maxTries}, no further try.`),!1;const r=["ETIMEDOUT","ESOCKETTIMEDOUT","ECONNREFUSED","ECONNRESET","ENOENT","ENOTFOUND","TIMEOUT","EPIPE","REQUEST_SEND_ERROR"];if(n)for(const s of r)if(n.name.toUpperCase().includes(s)||n.message.toUpperCase().includes(s)||n.code&&n.code.toString().toUpperCase()===s)return vZ.info(`RetryPolicy: Network error ${s} found, will retry.`),!0;if(i||n){const t=i?i.status:n?n.statusCode:0;if(!e&&404===t)return vZ.info("RetryPolicy: Secondary access with 404, will retry."),!0;if(503===t||500===t)return vZ.info(`RetryPolicy: Will retry for status code ${t}.`),!0}return!("PARSE_ERROR"!==(null==n?void 0:n.code)||!(null==n?void 0:n.message.startsWith('Error "Error: Unclosed root tag'))||(vZ.info("RetryPolicy: Incomplete XML response likely due to service timeout, will retry."),0))}async delay(e,t,i){let n=0;if(e)switch(this.retryOptions.retryPolicyType){case QZ.EXPONENTIAL:n=Math.min((Math.pow(2,t-1)-1)*this.retryOptions.retryDelayInMs,this.retryOptions.maxRetryDelayInMs);break;case QZ.FIXED:n=this.retryOptions.retryDelayInMs}else n=1e3*Math.random();return vZ.info(`RetryPolicy: Delay for ${n}ms`),async function(e,t,i){return new Promise((n,r)=>{let s;const o=()=>{void 0!==s&&clearTimeout(s),r(i)};s=setTimeout(()=>{void 0!==t&&t.removeEventListener("abort",o),n()},e),void 0!==t&&t.addEventListener("abort",o)})}(n,i,t$)}}class n${constructor(e){this.retryOptions=e}create(e,t){return new i$(e,t,this.retryOptions)}}class r$ extends YB{sendRequest(e){return this._nextPolicy.sendRequest(this.signRequest(e))}signRequest(e){return e}}class s$ extends r${constructor(e,t){super(e,t)}}class o$ extends class{create(e,t){throw new Error("Method should be implemented in children classes.")}}{create(e,t){return new s$(e,t)}}var a$=i(0);class l$ extends YB{constructor(e,t,i){super(e,t),this.telemetry=i}async sendRequest(e){return $B&&(e.headers||(e.headers=new EZ),e.headers.get("User-Agent")||e.headers.set("User-Agent",this.telemetry)),this._nextPolicy.sendRequest(e)}}class c${constructor(e){const t=[];if($B){if(e){const i=e.userAgentPrefix||"";i.length>0&&-1===t.indexOf(i)&&t.push(i)}const i="azsdk-js-storageblob/12.17.0";-1===t.indexOf(i)&&t.push(i);let n=`(NODE-VERSION ${process.version})`;a$&&(n=`(NODE-VERSION ${process.version}; ${a$.type()} ${a$.release()})`),-1===t.indexOf(n)&&t.push(n)}this.telemetryString=t.join(" ")}create(e,t){return new l$(e,t,this.telemetryString)}}class h${sendRequest(e){var t;const i=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");const n=e.abortSignal;if(n){if(n.aborted)return Promise.reject(new JZ("The operation was aborted."));const e=()=>{i.abort()};n.addEventListener("abort",e),i.addEventListener("readystatechange",()=>{i.readyState===XMLHttpRequest.DONE&&n.removeEventListener("abort",e)})}if(u$(i.upload,e.onUploadProgress),u$(i,e.onDownloadProgress),e.formData){const t=e.formData,i=new FormData,n=(e,t)=>{t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"options")?i.append(e,t.value,t.options):i.append(e,t)};for(const e of Object.keys(t)){const i=t[e];if(Array.isArray(i))for(let t=0;t<i.length;t++)n(e,i[t]);else n(e,i)}e.body=i,e.formData=void 0;const r=e.headers.get("Content-Type");r&&-1!==r.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}i.open(e.method,e.url),i.timeout=e.timeout,i.withCredentials=e.withCredentials;for(const r of e.headers.headersArray())i.setRequestHeader(r.name,r.value);return i.responseType=(null===(t=e.streamResponseStatusCodes)||void 0===t?void 0:t.size)||e.streamResponseBody?"blob":"text",i.send(void 0===e.body?null:e.body),new Promise("blob"===i.responseType?(t,n)=>{!function(e,t,i,n){e.addEventListener("readystatechange",()=>{var r;if(e.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(t.streamResponseBody||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))){const n=new Promise((i,n)=>{e.addEventListener("load",()=>{i(e.response)}),p$(t,e,n)});i({request:t,status:e.status,headers:d$(e),blobBody:n})}else e.addEventListener("load",()=>{if(e.response){const r=new FileReader;r.onload=function(n){var r;const s=null===(r=n.target)||void 0===r?void 0:r.result;i({request:t,status:e.status,headers:d$(e),bodyAsText:s})},r.onerror=function(e){n(r.error)},r.readAsText(e.response,"UTF-8")}else i({request:t,status:e.status,headers:d$(e)})})})}(i,e,t,n),p$(e,i,n)}:function(t,n){i.addEventListener("load",()=>t({request:e,status:i.status,headers:d$(i),bodyAsText:i.responseText})),p$(e,i,n)})}}function u$(e,t){t&&e.addEventListener("progress",e=>t({loadedBytes:e.loaded}))}function d$(e){const t=new EZ,i=e.getAllResponseHeaders().trim().split(/[\r\n]+/);for(const n of i){const e=n.indexOf(":"),i=n.slice(0,e),r=n.slice(e+2);t.set(i,r)}return t}function p$(e,t,i){t.addEventListener("error",()=>i(new nZ("Failed to send request to "+e.url,nZ.REQUEST_SEND_ERROR,void 0,e)));const n=new JZ("The operation was aborted.");t.addEventListener("abort",()=>i(n)),t.addEventListener("timeout",()=>i(n))}const m$=new h$;function f$(e,t){let i;const{abortSignal:n,abortErrorMsg:r}=null!=t?t:{};return function(t,n){const{cleanupBeforeAbort:r,abortSignal:s,abortErrorMsg:o}=null!=n?n:{};return new Promise((t,n)=>{function a(){n(new JZ(null!=o?o:"The operation was aborted."))}function l(){null==s||s.removeEventListener("abort",c)}function c(){null==r||r(),l(),a()}if(null==s?void 0:s.aborted)return a();try{(t=>{i=setTimeout(t,e)})(e=>{l(),t(e)})}catch(T0){n(T0)}null==s||s.addEventListener("abort",c)})}(0,{cleanupBeforeAbort:()=>clearTimeout(i),abortSignal:n,abortErrorMsg:null!=r?r:"The delay was aborted."})}const g$={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function _$(e,t,i){let n=null,r=null;const s=Object.assign(Object.assign({},g$),i),o={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!o.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function a(i){var a;return o.isRefreshing||(n=async function(e,t,i){async function n(){if(!(Date.now()<i)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(a){return null}}let r=await n();for(;null===r;)await f$(t),r=await n();return r}(()=>e.getToken(t,i),s.retryIntervalInMs,null!==(a=null==r?void 0:r.expiresOnTimestamp)&&void 0!==a?a:Date.now()).then(e=>(n=null,r=e,r)).catch(e=>{throw n=null,r=null,e})),n}return async e=>o.mustRefresh?a(e):(o.shouldRefresh&&a(e),r)}function y$(e){if(!e||"object"!=typeof e)return!1;const t=e;return Array.isArray(t.factories)&&"object"==typeof t.options&&"function"==typeof t.toServiceClientOptions}class v${constructor(e,t={}){this.factories=e,this.options=Object.assign(Object.assign({},t),{httpClient:t.httpClient||m$})}toServiceClientOptions(){return{httpClient:this.options.httpClient,requestPolicyFactories:this.factories}}}function x$(e,t={}){var i;void 0===e&&(e=new o$);const n=new c$(t.userAgentOptions),r=[zW({userAgent:n.telemetryString}),(s=t.keepAliveOptions,{create:(e,t)=>new FW(e,t,s||BW)}),n,jW(),new YZ,new n$(t.retryOptions),pZ(void 0,{xmlCharKey:"#"}),_Z({logger:vZ.info,allowedHeaderNames:xZ,allowedQueryParameters:bZ})];var s;return $B&&(r.push(QB()),r.push({create:(e,t)=>{throw new Error("DisableResponseDecompressionPolicy is not supported in browser environment")}})),r.push(XB(e)?HZ(function(e,t){let i=_$(e,t);class n extends YB{constructor(e,t){super(e,t)}async sendRequest(t){if(!t.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");const n=i,r=(await n({abortSignal:t.abortSignal,tracingOptions:{tracingContext:t.tracingContext}})).token;t.headers.set("authorization","Bearer "+r);const s=await this._nextPolicy.sendRequest(t);if(401===(null==s?void 0:s.status)){const n=function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(s);if(n){const r=function(e){return(e.slice("Bearer ".length).trim()+" ").split(" ").filter(e=>e).map(e=>(([e,t])=>({[e]:t}))(e.trim().split("="))).reduce((e,t)=>Object.assign(Object.assign({},e),t),{})}(n),s=r.resource_id+"/.default",o=qW.parse(r.authorization_uri).getPath().split("/")[1],a=_$(e,s),l=(await a({abortSignal:t.abortSignal,tracingOptions:{tracingContext:t.tracingContext},tenantId:o})).token;return i=a,t.headers.set("authorization","Bearer "+l),this._nextPolicy.sendRequest(t)}}return s}}return{create:(e,t)=>new n(e,t)}}(e,null!==(i=t.audience)&&void 0!==i?i:"https://storage.azure.com/.default"),e):e),new v$(r,t)}class b${}const w$=["GET","HEAD"];class C$ extends YB{constructor(e,t,i=20){super(e,t),this.maxRetries=i}sendRequest(e){return this._nextPolicy.sendRequest(e).then(e=>function e(t,i,n){const{request:r,status:s}=i,o=i.headers.get("location");if(o&&(300===s||301===s&&w$.includes(r.method)||302===s&&w$.includes(r.method)||303===s&&"POST"===r.method||307===s)&&(!t.maxRetries||n<t.maxRetries)){const i=qW.parse(r.url);return i.setPath(o),r.url=i.toString(),303===s&&(r.method="GET",delete r.body),t._nextPolicy.sendRequest(r).then(i=>e(t,i,n+1))}return Promise.resolve(i)}(this,e,0))}}function S$(e){return"number"==typeof e}function E$(e,t,i,n,r){return!!t(n,r)&&i.retryCount<e}function T$(e,t={retryCount:0,retryInterval:0},i){i&&(t.error&&(i.innerError=t.error),t.error=i),t.retryCount++;let n=Math.pow(2,t.retryCount-1)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}var P$;!function(e){e[e.Exponential=0]="Exponential"}(P$||(P$={}));class M$ extends YB{constructor(e,t,i,n,r){super(e,t),this.retryCount=S$(i)?i:3,this.retryInterval=S$(n)?n:3e4,this.maxRetryInterval=S$(r)?r:9e4}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).then(t=>k$(this,e,t)).catch(t=>k$(this,e,t.response,void 0,t))}}async function k$(e,t,i,n,r){n=T$({retryInterval:e.retryInterval,minRetryInterval:0,maxRetryInterval:e.maxRetryInterval},n,r);const s=t.abortSignal&&t.abortSignal.aborted;if(s||!E$(e.retryCount,(function(e){const t=null==e?void 0:e.status;return!(503===t&&(null==i?void 0:i.headers.get("Retry-After"))||void 0===t||t<500&&408!==t||501===t||505===t)}),n,i)){if(s||r||!i)throw n.error||new nZ("Failed to send the request.",nZ.REQUEST_SEND_ERROR,i&&i.status,i&&i.request,i);return i}NW.info("Retrying request in "+n.retryInterval);try{await f$(n.retryInterval);const i=await e._nextPolicy.sendRequest(t.clone());return k$(e,t,i,n)}catch(T0){return k$(e,t,i,n,T0)}}function A$(e){return I$(e.parameterPath,e.mapper)}function I$(e,t){let i;return i="string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName,i}class R${constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m){this.streamResponseBody=s,this.streamResponseStatusCodes=m,this.url=e||"",this.method=t||"GET",this.headers=SZ(r)?r:new EZ(r),this.body=i,this.query=n,this.formData=void 0,this.withCredentials=o||!1,this.abortSignal=a,this.timeout=l||0,this.onUploadProgress=c,this.onDownloadProgress=h,this.proxySettings=u,this.keepAlive=d,this.decompressResponse=p,this.requestId=this.headers.get("x-ms-client-request-id")||lj()}validateRequestProperties(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")}prepare(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){const t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){const{pathTemplate:t,pathParameters:i}=e;if("string"!=typeof t)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");const n=e.baseUrl;let r=n+(n.endsWith("/")?"":"/")+(t.startsWith("/")?t.slice(1):t);const s=r.match(/({[\w-]*\s*[\w-]*})/gi);if(s&&s.length){if(!i)throw new Error(`pathTemplate: ${t} has been provided. Hence, options.pathParameters must also be provided.`);s.forEach((function(e){const n=e.slice(1,-1),s=i[n];if(null==s||"string"!=typeof s&&"object"!=typeof s){const e=JSON.stringify(i,void 0,2);throw new Error(`pathTemplate: ${t} contains the path parameter ${n} however, it is not present in parameters: ${e}.The value of the path parameter can either be a "string" of the form { ${n}: "some sample value" } or it can be an "object" of the form { "${n}": { value: "some sample value", skipUrlEncoding: true } }.`)}if("string"==typeof s.valueOf()&&(r=r.replace(e,encodeURIComponent(s))),"object"==typeof s.valueOf()){if(!s.value)throw new Error(`options.pathParameters[${n}] is of type "object" but it does not contain a "value" property.`);r=r.replace(e,s.skipUrlEncoding?s.value:encodeURIComponent(s.value))}}))}this.url=r}if(e.queryParameters){const t=e.queryParameters;if("object"!=typeof t)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");const i=[];this.query={};for(const e in t){const n=t[e];if(n)if("string"==typeof n)i.push(e+"="+encodeURIComponent(n)),this.query[e]=encodeURIComponent(n);else if("object"==typeof n){if(!n.value)throw new Error(`options.queryParameters[${e}] is of type "object" but it does not contain a "value" property.`);n.skipUrlEncoding?(i.push(e+"="+n.value),this.query[e]=n.value):(i.push(e+"="+encodeURIComponent(n.value)),this.query[e]=encodeURIComponent(n.value))}}this.url+=i.join("&")}if(e.headers){const t=e.headers;for(const i of Object.keys(e.headers))this.headers.set(i,t[i])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new uj(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),e.tracingContext&&(this.tracingContext=e.tracingContext),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this}clone(){const e=new R$(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(e.formData=this.formData),this.operationSpec&&(e.operationSpec=this.operationSpec),this.shouldDeserialize&&(e.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(e.operationResponseGetter=this.operationResponseGetter),e}}const O$=function(){return"x-ms-useragent"};function N$(){const e=function(){const e=self.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return function(e,t=" ",i="/"){return e.map(e=>`${e.key}${e.value?`${i}${e.value}`:""}`).join(t)}([{key:"core-http",value:"3.0.4"}].concat(e))}class D$ extends YB{constructor(e,t,i,n){super(e,t),this._nextPolicy=e,this._options=t,this.headerKey=i,this.headerValue=n}sendRequest(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)}addUserAgentHeader(e){e.headers||(e.headers=new EZ),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)}}const z$={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function L$(e,t){const i=function(e,t,i){let n=null,r=null;const s=Object.assign(Object.assign({},z$),void 0),o={get isRefreshing(){return null!==n},get shouldRefresh(){var e;return!o.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function a(i){var a;return o.isRefreshing||(n=async function(e,t,i){async function n(){if(!(Date.now()<i)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(a){return null}}let r=await n();for(;null===r;)await f$(t),r=await n();return r}(()=>e.getToken(t,i),s.retryIntervalInMs,null!==(a=null==r?void 0:r.expiresOnTimestamp)&&void 0!==a?a:Date.now()).then(e=>(n=null,r=e,r)).catch(e=>{throw n=null,r=null,e})),n}return async e=>o.mustRefresh?a(e):(o.shouldRefresh&&a(e),r)}(e,t);class n extends YB{constructor(e,t){super(e,t)}async sendRequest(e){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");const{token:t}=await i({abortSignal:e.abortSignal,tracingOptions:{tracingContext:e.tracingContext}});return e.headers.set("authorization","Bearer "+t),this._nextPolicy.sendRequest(e)}}return{create:(e,t)=>new n(e,t)}}let B$;class F$ extends YB{constructor(e,t,i=30){super(e,t),this._retryTimeout=i}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).then(t=>function(e,t,i){if(409===i.status){const n=function(e){let t,i;if(e){try{i=JSON.parse(e)}catch(T0){}if(i&&i.error&&i.error.message&&i.error.code&&"MissingSubscriptionRegistration"===i.error.code){const e=i.error.message.match(/.*'(.*)'/i);e&&(t=e.pop())}}return t}(i.bodyAsText);if(n){const r=function(e){let t;const i=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!i||!i[0])throw new Error(`Unable to extract subscriptionId from the given url - ${e}.`);return t=i[0],t}(t.url);return async function(e,t,i,n){const r=`${t}providers/${i}/register?api-version=2016-02-01`,s=`${t}providers/${i}?api-version=2016-02-01`,o=j$(n);if(o.method="POST",o.url=r,200!==(await e._nextPolicy.sendRequest(o)).status)throw new Error(`Autoregistration of ${i} failed. Please try registering manually.`);return async function e(t,i,n){const r=j$(n);r.url=i,r.method="GET";const s=await t._nextPolicy.sendRequest(r),o=s.parsedBody;return!(!s.parsedBody||!o.registrationState||"Registered"!==o.registrationState)||(await f$(1e3*t._retryTimeout),e(t,i,n))}(e,s,n)}(e,r,n,t).catch(()=>!1).then(n=>n?(t.headers.set("x-ms-client-request-id",lj()),e._nextPolicy.sendRequest(t.clone())):i)}}return Promise.resolve(i)}(this,e,t))}}function j$(e,t=!1){const i=e.clone();return t&&(i.url=e.url),i.headers.set("x-ms-client-request-id",lj()),i.headers.set("Content-Type","application/json; charset=utf-8"),i}class V$ extends YB{constructor(e,t,i){super(e,t),this.authenticationProvider=i}signRequest(e){return this.authenticationProvider.signRequest(e)}sendRequest(e){return this.signRequest(e).then(e=>this._nextPolicy.sendRequest(e))}}class U$ extends YB{constructor(e,t,i,n,r,s){super(e,t),this.retryCount=S$(i)?i:3,this.retryInterval=S$(n)?n:3e4,this.minRetryInterval=S$(r)?r:3e3,this.maxRetryInterval=S$(s)?s:9e4}sendRequest(e){return this._nextPolicy.sendRequest(e.clone()).catch(t=>async function e(t,i,n,r,s){if(s=T$(t,s,r),!E$(t.retryCount,(function(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}),s,n,r))return r?Promise.reject(s.error):n;try{return await f$(s.retryInterval),t._nextPolicy.sendRequest(i.clone())}catch(o){return e(t,i,n,o,s)}}(this,e,t.response,t))}}const q$=429,H$=503;class G$ extends YB{constructor(e,t,i){super(e,t),this.numberOfRetries=0,this._handleResponse=i||this._defaultResponseHandler}async sendRequest(e){const t=await this._nextPolicy.sendRequest(e.clone());return t.status!==q$&&t.status!==H$?t:this._handleResponse(e,t)}async _defaultResponseHandler(e,t){var i;const n=t.headers.get("Retry-After");if(n){const t=G$.parseRetryAfterHeader(n);if(t){if(this.numberOfRetries+=1,await f$(t,{abortSignal:e.abortSignal,abortErrorMsg:"The operation was aborted."}),null===(i=e.abortSignal)||void 0===i?void 0:i.aborted)throw new JZ("The operation was aborted.");return this.numberOfRetries<3?this.sendRequest(e):this._nextPolicy.sendRequest(e)}}return t}static parseRetryAfterHeader(e){const t=Number(e);return Number.isNaN(t)?G$.parseDateRetryAfterHeader(e):1e3*t}static parseDateRetryAfterHeader(e){try{const t=Date.now(),i=Date.parse(e)-t;return Number.isNaN(i)?void 0:i}catch(t){return}}}function W$(e,t){let i;return"string"==typeof e?i=e:(i=t(),"function"==typeof e&&(i=e(i))),i}function Z$(e,t,i,n){return function e(t,i,n,r,s){var o;let a;"string"==typeof n&&(n=[n]);const l=null===(o=i.options)||void 0===o?void 0:o.serializerOptions;if(Array.isArray(n)){if(n.length>0){if(r.isConstant)a=r.defaultValue;else{let e=$$(i,n);e.propertyFound||(e=$$(t,n));let s=!1;e.propertyFound||(s=r.required||"options"===n[0]&&2===n.length),a=s?r.defaultValue:e.propertyValue}const e=I$(n,r);s.serialize(r,a,e,l)}}else{r.required&&(a={});for(const o in n){const c=r.type.modelProperties[o],h=n[o],u=e(t,i,h,c,s),d=I$(h,c);s.serialize(c,u,d,l),null!=u&&(a||(a={}),a[o]=u)}}return a}(e,t,i.parameterPath,i.mapper,n)}function $$(e,t){const i={propertyFound:!1};let n=0;for(;n<t.length;++n){const i=t[n];if(null==e||!(i in e))break;e=e[i]}return n===t.length&&(i.propertyValue=e,i.propertyFound=!0),i}function X$(e,t){const i=e.parsedHeaders,n=t&&t.bodyMapper,r=t=>Object.defineProperty(t,"_response",{value:e});if(n){const t=n.type.name;if("Stream"===t)return r(Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));const s="Composite"===t&&n.type.modelProperties||{},o=Object.keys(s).some(e=>""===s[e].serializedName);if("Sequence"===t||o){const t=[...e.parsedBody||[]];for(const i of Object.keys(s))s[i].serializedName&&(t[i]=e.parsedBody[i]);if(i)for(const e of Object.keys(i))t[e]=i[e];return r(t),t}if("Composite"===t||"Dictionary"===t)return r(Object.assign(Object.assign({},i),e.parsedBody))}return n||"HEAD"===e.request.method||"object"!=typeof(s=e.parsedBody)&&"function"!=typeof s||null===s?r(Object.assign(Object.assign({},i),{body:e.parsedBody})):r(Object.assign(Object.assign({},i),e.parsedBody));var s}class K$ extends class{constructor(e,t){let i;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||(B$||(B$=new h$),B$),this._requestPolicyOptions=new JB(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))NW.info("ServiceClient: using custom request policies"),i=t.requestPolicyFactories;else{let r=void 0;if(XB(e))NW.info("ServiceClient: creating bearer token authentication policy from provided credentials"),r=(()=>{let i=void 0;const n=this,r=t;return{create(t,s){const o=function(e,t){return(null==e?void 0:e.credentialScopes)?e.credentialScopes:t?t+"/.default":void 0}(r,n.baseUri);if(!o)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==i&&(i=L$(e,o)),i.create(t,s)}}})();else if(e&&"function"==typeof e.signRequest)NW.info("ServiceClient: creating signing policy from provided credentials"),n=e,r={create:(e,t)=>new V$(e,t,n)};else if(null!=e)throw new Error("The credentials argument must implement the TokenCredential interface");if(NW.info("ServiceClient: using default request policies"),i=function(e,t){const i=[];t.generateClientRequestIdHeader&&i.push(jW(t.clientRequestIdHeaderName)),e&&i.push(e);const n=W$(t.userAgentHeaderName,O$),r=W$(t.userAgent,N$);return n&&r&&i.push(function(e){const t=e&&null!=e.key?e.key:"x-ms-useragent",i=e&&null!=e.value?e.value:N$();return{create:(e,n)=>new D$(e,n,t,i)}}({key:n,value:r})),i.push(function(e=20){return{create:(t,i)=>new C$(t,i,e)}}()),i.push(function(e=30){return{create:(t,i)=>new F$(t,i,e)}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(i.push({create:(e,t)=>new M$(e,t,void 0,void 0,void 0)}),i.push({create:(e,t)=>new U$(e,t,void 0,void 0,void 0,void 0)}),i.push({create:(e,t)=>new G$(e,t)})),i.push(pZ(t.deserializationContentTypes)),$B&&i.push(QB()),i.push(_Z({logger:NW.info})),i}(r,t),t.requestPolicyFactories){const e=t.requestPolicyFactories(i);e&&(i=e)}}var n;this._requestPolicyFactories=i}sendRequest(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");let t;try{!function(e){if(e&&"object"==typeof e){const t=e;if("string"==typeof t.url&&"string"==typeof t.method&&"object"==typeof t.headers&&SZ(t.headers)&&"function"==typeof t.validateRequestProperties&&"function"==typeof t.prepare&&"function"==typeof t.clone)return!0}return!1}(e)?(t=new R$,t=t.prepare(e)):(e.validateRequestProperties(),t=e)}catch(n){return Promise.reject(n)}let i=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(let r=this._requestPolicyFactories.length-1;r>=0;--r)i=this._requestPolicyFactories[r].create(i,this._requestPolicyOptions);return i.sendRequest(t)}async sendOperationRequest(e,t,i){var n;"function"==typeof e.options&&(i=e.options,e.options=void 0);const r=null===(n=e.options)||void 0===n?void 0:n.serializerOptions,s=new R$;let o;try{const i=t.baseUrl||this.baseUri;if(!i)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");s.method=t.httpMethod,s.operationSpec=t;const n=qW.parse(i);if(t.path&&n.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(const s of t.urlParameters){let i=Z$(this,e,s,t.serializer);i=t.serializer.serialize(s.mapper,i,A$(s),r),s.skipEncoding||(i=encodeURIComponent(i)),n.replaceAll(`{${s.mapper.serializedName||A$(s)}}`,i)}if(t.queryParameters&&t.queryParameters.length>0)for(const s of t.queryParameters){let i=Z$(this,e,s,t.serializer);if(null!=i){if(i=t.serializer.serialize(s.mapper,i,A$(s),r),null!=s.collectionFormat)if(s.collectionFormat===Bq.Multi){if(0===i.length)continue;for(const e in i){const t=i[e];i[e]=null==t?"":t.toString()}}else s.collectionFormat!==Bq.Ssv&&s.collectionFormat!==Bq.Tsv||(i=i.join(s.collectionFormat));if(!s.skipEncoding)if(Array.isArray(i))for(const e in i)null!=i[e]&&(i[e]=encodeURIComponent(i[e]));else i=encodeURIComponent(i);null!=s.collectionFormat&&s.collectionFormat!==Bq.Multi&&s.collectionFormat!==Bq.Ssv&&s.collectionFormat!==Bq.Tsv&&(i=i.join(s.collectionFormat)),n.setQueryParameter(s.mapper.serializedName||A$(s),i)}}s.url=n.toString();const a=t.contentType||this.requestContentType;if(a&&t.requestBody&&s.headers.set("Content-Type",a),t.headerParameters)for(const o of t.headerParameters){let i=Z$(this,e,o,t.serializer);if(null!=i){i=t.serializer.serialize(o.mapper,i,A$(o),r);const e=o.mapper.headerCollectionPrefix;if(e)for(const t of Object.keys(i))s.headers.set(e+t,i[t]);else s.headers.set(o.mapper.serializedName||A$(o),i)}}const c=e.options;if(c){if(c.customHeaders)for(const e in c.customHeaders)s.headers.set(e,c.customHeaders[e]);c.abortSignal&&(s.abortSignal=c.abortSignal),c.timeout&&(s.timeout=c.timeout),c.onUploadProgress&&(s.onUploadProgress=c.onUploadProgress),c.onDownloadProgress&&(s.onDownloadProgress=c.onDownloadProgress),c.spanOptions&&(s.spanOptions=c.spanOptions),c.tracingContext&&(s.tracingContext=c.tracingContext),null!=c.shouldDeserialize&&(s.shouldDeserialize=c.shouldDeserialize)}let h,u;s.withCredentials=this._withCredentials,function(e,t,i,n){var r,s,o,a,l,c;const h=null!==(s=null===(r=i.options)||void 0===r?void 0:r.serializerOptions)&&void 0!==s?s:{},u={rootName:null!==(o=h.rootName)&&void 0!==o?o:"",includeRoot:null!==(a=h.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(l=h.xmlCharKey)&&void 0!==l?l:"_"},d=h.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=Z$(e,i,n.requestBody,n.serializer);const r=n.requestBody.mapper,{required:s,xmlName:o,xmlElementName:a,serializedName:l,xmlNamespace:h,xmlNamespacePrefix:m}=r,f=r.type.name;try{if(null!=t.body||s){const e=A$(n.requestBody);t.body=n.serializer.serialize(r,t.body,e,u);const i=f===xj.Stream;if(n.isXML){const e=m?"xmlns:"+m:"xmlns",n=function(e,t,i,n,r){if(e&&!["Composite","Sequence","Dictionary"].includes(i)){const i={};return i[r.xmlCharKey]=n,i[JF]={[t]:e},i}return n}(h,e,f,t.body,u);f===xj.Sequence?t.body=uZ(function(e,t,i,n){if(Array.isArray(e)||(e=[e]),!i||!n)return{[t]:e};const r={[t]:e};return r[JF]={[i]:n},r}(n,a||o||l,e,h),{rootName:o||l,xmlCharKey:d}):i||(t.body=uZ(n,{rootName:o||l,xmlCharKey:d}))}else{if(f===xj.String&&((null===(c=n.contentType)||void 0===c?void 0:c.match("text/plain"))||"text"===n.mediaType))return;i||(t.body=JSON.stringify(t.body))}}}catch(p){throw new Error(`Error "${p.message}" occurred in serializing the payload - ${JSON.stringify(l,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const r of n.formDataParameters){const s=Z$(e,i,r,n.serializer);if(null!=s){const e=r.mapper.serializedName||A$(r);t.formData[e]=n.serializer.serialize(r.mapper,s,A$(r),u)}}}}(this,s,e,t),void 0===s.streamResponseStatusCodes&&(s.streamResponseStatusCodes=function(e){const t=new Set;for(const i in e.responses){const n=e.responses[i];n.bodyMapper&&n.bodyMapper.type.name===xj.Stream&&t.add(Number(i))}return t}(t));try{h=await this.sendRequest(s)}catch(l){u=l}u?(u.response&&(u.details=X$(u.response,t.responses[u.statusCode]||t.responses.default)),o=Promise.reject(u)):o=Promise.resolve(X$(h,t.responses[h.status]))}catch(l){o=Promise.reject(l)}const a=i;return a&&o.then(e=>a(null,e._response.parsedBody,e._response.request,e._response)).catch(e=>a(e)),o}}{constructor(e,t){if(void 0===e)throw new Error("'url' cannot be null");if(t||(t={}),!t.userAgent){const e=N$();t.userAgent="azure-storage-blob/12.17.0 "+e}super(void 0,t),this.requestContentType="application/json; charset=utf-8",this.baseUri=t.endpoint||"{url}",this.url=e,this.version=t.version||"2023-11-03"}}class Y${constructor(e,t){this.url=function(e){const t=qW.parse(e);let i=t.getPath();return i=i||"/",i=encodeURIComponent(i).replace(/%2F/g,"/").replace(/'/g,"%27").replace(/\+/g,"%20").replace(/%25/g,"%"),t.setPath(i),t.toString()}(e),this.accountName=LZ(e),this.pipeline=t,this.storageClientContext=new K$(this.url,t.toServiceClientOptions()),this.isHttps=zZ(function(e){return qW.parse(e).getScheme()}(this.url)||"","https"),this.credential=new o$;for(const i of this.pipeline.factories)$B&&i instanceof b$||i instanceof o$?this.credential=i:XB(i.credential)&&(this.credential=i.credential);this.storageClientContext.requestContentType=void 0}}const J$=hW({packagePrefix:"Azure.Storage.Blob",namespace:"Microsoft.Storage"});function Q$(e){var t,i;return{spanOptions:null===(t=null==e?void 0:e.tracingOptions)||void 0===t?void 0:t.spanOptions,tracingContext:null===(i=null==e?void 0:e.tracingOptions)||void 0===i?void 0:i.tracingContext}}class eX{constructor(){this.read=!1,this.add=!1,this.create=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.tag=!1,this.move=!1,this.execute=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1}static parse(e){const t=new eX;for(const i of e)switch(i){case"r":t.read=!0;break;case"a":t.add=!0;break;case"c":t.create=!0;break;case"w":t.write=!0;break;case"d":t.delete=!0;break;case"x":t.deleteVersion=!0;break;case"t":t.tag=!0;break;case"m":t.move=!0;break;case"e":t.execute=!0;break;case"i":t.setImmutabilityPolicy=!0;break;case"y":t.permanentDelete=!0;break;default:throw new RangeError("Invalid permission: "+i)}return t}static from(e){const t=new eX;return e.read&&(t.read=!0),e.add&&(t.add=!0),e.create&&(t.create=!0),e.write&&(t.write=!0),e.delete&&(t.delete=!0),e.deleteVersion&&(t.deleteVersion=!0),e.tag&&(t.tag=!0),e.move&&(t.move=!0),e.execute&&(t.execute=!0),e.setImmutabilityPolicy&&(t.setImmutabilityPolicy=!0),e.permanentDelete&&(t.permanentDelete=!0),t}toString(){const e=[];return this.read&&e.push("r"),this.add&&e.push("a"),this.create&&e.push("c"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.tag&&e.push("t"),this.move&&e.push("m"),this.execute&&e.push("e"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),e.join("")}}class tX{constructor(){this.read=!1,this.add=!1,this.create=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.list=!1,this.tag=!1,this.move=!1,this.execute=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1,this.filterByTags=!1}static parse(e){const t=new tX;for(const i of e)switch(i){case"r":t.read=!0;break;case"a":t.add=!0;break;case"c":t.create=!0;break;case"w":t.write=!0;break;case"d":t.delete=!0;break;case"l":t.list=!0;break;case"t":t.tag=!0;break;case"x":t.deleteVersion=!0;break;case"m":t.move=!0;break;case"e":t.execute=!0;break;case"i":t.setImmutabilityPolicy=!0;break;case"y":t.permanentDelete=!0;break;case"f":t.filterByTags=!0;break;default:throw new RangeError("Invalid permission "+i)}return t}static from(e){const t=new tX;return e.read&&(t.read=!0),e.add&&(t.add=!0),e.create&&(t.create=!0),e.write&&(t.write=!0),e.delete&&(t.delete=!0),e.list&&(t.list=!0),e.deleteVersion&&(t.deleteVersion=!0),e.tag&&(t.tag=!0),e.move&&(t.move=!0),e.execute&&(t.execute=!0),e.setImmutabilityPolicy&&(t.setImmutabilityPolicy=!0),e.permanentDelete&&(t.permanentDelete=!0),e.filterByTags&&(t.filterByTags=!0),t}toString(){const e=[];return this.read&&e.push("r"),this.add&&e.push("a"),this.create&&e.push("c"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.list&&e.push("l"),this.tag&&e.push("t"),this.move&&e.push("m"),this.execute&&e.push("e"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),this.filterByTags&&e.push("f"),e.join("")}}class iX{}function nX(e){return e.end?`${e.start}-${e.end}`:e.start}var rX;!function(e){e.Https="https",e.HttpsAndHttp="https,http"}(rX||(rX={}));class sX{constructor(e,t,i,n,r,s,o,a,l,c,h,u,d,p,m,f,g,_,y,v){this.version=e,this.signature=t,void 0!==i&&"string"!=typeof i?(this.permissions=i.permissions,this.services=i.services,this.resourceTypes=i.resourceTypes,this.protocol=i.protocol,this.startsOn=i.startsOn,this.expiresOn=i.expiresOn,this.ipRangeInner=i.ipRange,this.identifier=i.identifier,this.encryptionScope=i.encryptionScope,this.resource=i.resource,this.cacheControl=i.cacheControl,this.contentDisposition=i.contentDisposition,this.contentEncoding=i.contentEncoding,this.contentLanguage=i.contentLanguage,this.contentType=i.contentType,i.userDelegationKey&&(this.signedOid=i.userDelegationKey.signedObjectId,this.signedTenantId=i.userDelegationKey.signedTenantId,this.signedStartsOn=i.userDelegationKey.signedStartsOn,this.signedExpiresOn=i.userDelegationKey.signedExpiresOn,this.signedService=i.userDelegationKey.signedService,this.signedVersion=i.userDelegationKey.signedVersion,this.preauthorizedAgentObjectId=i.preauthorizedAgentObjectId,this.correlationId=i.correlationId)):(this.services=n,this.resourceTypes=r,this.expiresOn=a,this.permissions=i,this.protocol=s,this.startsOn=o,this.ipRangeInner=l,this.encryptionScope=v,this.identifier=c,this.resource=h,this.cacheControl=u,this.contentDisposition=d,this.contentEncoding=p,this.contentLanguage=m,this.contentType=f,g&&(this.signedOid=g.signedObjectId,this.signedTenantId=g.signedTenantId,this.signedStartsOn=g.signedStartsOn,this.signedExpiresOn=g.signedExpiresOn,this.signedService=g.signedService,this.signedVersion=g.signedVersion,this.preauthorizedAgentObjectId=_,this.correlationId=y))}get ipRange(){if(this.ipRangeInner)return{end:this.ipRangeInner.end,start:this.ipRangeInner.start}}toString(){const e=["sv","ss","srt","spr","st","se","sip","si","ses","skoid","sktid","skt","ske","sks","skv","sr","sp","sig","rscc","rscd","rsce","rscl","rsct","saoid","scid"],t=[];for(const i of e)switch(i){case"sv":this.tryAppendQueryParameter(t,i,this.version);break;case"ss":this.tryAppendQueryParameter(t,i,this.services);break;case"srt":this.tryAppendQueryParameter(t,i,this.resourceTypes);break;case"spr":this.tryAppendQueryParameter(t,i,this.protocol);break;case"st":this.tryAppendQueryParameter(t,i,this.startsOn?NZ(this.startsOn,!1):void 0);break;case"se":this.tryAppendQueryParameter(t,i,this.expiresOn?NZ(this.expiresOn,!1):void 0);break;case"sip":this.tryAppendQueryParameter(t,i,this.ipRange?nX(this.ipRange):void 0);break;case"si":this.tryAppendQueryParameter(t,i,this.identifier);break;case"ses":this.tryAppendQueryParameter(t,i,this.encryptionScope);break;case"skoid":this.tryAppendQueryParameter(t,i,this.signedOid);break;case"sktid":this.tryAppendQueryParameter(t,i,this.signedTenantId);break;case"skt":this.tryAppendQueryParameter(t,i,this.signedStartsOn?NZ(this.signedStartsOn,!1):void 0);break;case"ske":this.tryAppendQueryParameter(t,i,this.signedExpiresOn?NZ(this.signedExpiresOn,!1):void 0);break;case"sks":this.tryAppendQueryParameter(t,i,this.signedService);break;case"skv":this.tryAppendQueryParameter(t,i,this.signedVersion);break;case"sr":this.tryAppendQueryParameter(t,i,this.resource);break;case"sp":this.tryAppendQueryParameter(t,i,this.permissions);break;case"sig":this.tryAppendQueryParameter(t,i,this.signature);break;case"rscc":this.tryAppendQueryParameter(t,i,this.cacheControl);break;case"rscd":this.tryAppendQueryParameter(t,i,this.contentDisposition);break;case"rsce":this.tryAppendQueryParameter(t,i,this.contentEncoding);break;case"rscl":this.tryAppendQueryParameter(t,i,this.contentLanguage);break;case"rsct":this.tryAppendQueryParameter(t,i,this.contentType);break;case"saoid":this.tryAppendQueryParameter(t,i,this.preauthorizedAgentObjectId);break;case"scid":this.tryAppendQueryParameter(t,i,this.correlationId)}return t.join("&")}tryAppendQueryParameter(e,t,i){i&&(t=encodeURIComponent(t),i=encodeURIComponent(i),t.length>0&&i.length>0&&e.push(`${t}=${i}`))}}function oX(e,t,i){const n=e.version?e.version:"2023-11-03",r=t instanceof b$?t:void 0;let s;if(void 0===r&&void 0!==i&&(s=new iX(i,t)),void 0===r&&void 0===s)throw TypeError("Invalid sharedKeyCredential, userDelegationKey or accountName.");if(n>="2020-12-06")return void 0!==r?function(e,t){if(!((e=lX(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");let i,n="c",r=e.snapshotTime;e.blobName&&(n="b",e.snapshotTime?n="bs":e.versionId&&(n="bv",r=e.versionId)),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const s=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,n,r,e.encryptionScope,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),o=t.computeHMACSHA256(s);return new sX(e.version,o,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,void 0,void 0,void 0,e.encryptionScope)}(e,r):function(e,t){if(!(e=lX(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");let i,n="c",r=e.snapshotTime;e.blobName&&(n="b",e.snapshotTime?n="bs":e.versionId&&(n="bv",r=e.versionId)),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const s=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?NZ(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?NZ(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.preauthorizedAgentObjectId,void 0,e.correlationId,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,n,r,e.encryptionScope,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(s);return new sX(e.version,o,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey,e.preauthorizedAgentObjectId,e.correlationId,e.encryptionScope)}(e,s);if(n>="2018-11-09")return void 0!==r?function(e,t){if(!((e=lX(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");let i,n="c",r=e.snapshotTime;e.blobName&&(n="b",e.snapshotTime?n="bs":e.versionId&&(n="bv",r=e.versionId)),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const s=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,n,r,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),o=t.computeHMACSHA256(s);return new sX(e.version,o,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType)}(e,r):n>="2020-02-10"?function(e,t){if(!(e=lX(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");let i,n="c",r=e.snapshotTime;e.blobName&&(n="b",e.snapshotTime?n="bs":e.versionId&&(n="bv",r=e.versionId)),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const s=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?NZ(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?NZ(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.preauthorizedAgentObjectId,void 0,e.correlationId,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,n,r,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(s);return new sX(e.version,o,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey,e.preauthorizedAgentObjectId,e.correlationId)}(e,s):function(e,t){if(!(e=lX(e)).permissions||!e.expiresOn)throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when generating user delegation SAS.");let i,n="c",r=e.snapshotTime;e.blobName&&(n="b",e.snapshotTime?n="bs":e.versionId&&(n="bv",r=e.versionId)),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const s=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),t.userDelegationKey.signedObjectId,t.userDelegationKey.signedTenantId,t.userDelegationKey.signedStartsOn?NZ(t.userDelegationKey.signedStartsOn,!1):"",t.userDelegationKey.signedExpiresOn?NZ(t.userDelegationKey.signedExpiresOn,!1):"",t.userDelegationKey.signedService,t.userDelegationKey.signedVersion,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,n,r,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType].join("\n"),o=t.computeHMACSHA256(s);return new sX(e.version,o,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType,t.userDelegationKey)}(e,s);if(n>="2015-04-05"){if(void 0!==r)return function(e,t){if(!((e=lX(e)).identifier||e.permissions&&e.expiresOn))throw new RangeError("Must provide 'permissions' and 'expiresOn' for Blob SAS generation when 'identifier' is not provided.");let i,n="c";e.blobName&&(n="b"),e.permissions&&(i=e.blobName?eX.parse(e.permissions.toString()).toString():tX.parse(e.permissions.toString()).toString());const r=[i||"",e.startsOn?NZ(e.startsOn,!1):"",e.expiresOn?NZ(e.expiresOn,!1):"",aX(t.accountName,e.containerName,e.blobName),e.identifier,e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",e.version,e.cacheControl?e.cacheControl:"",e.contentDisposition?e.contentDisposition:"",e.contentEncoding?e.contentEncoding:"",e.contentLanguage?e.contentLanguage:"",e.contentType?e.contentType:""].join("\n"),s=t.computeHMACSHA256(r);return new sX(e.version,s,i,void 0,void 0,e.protocol,e.startsOn,e.expiresOn,e.ipRange,e.identifier,n,e.cacheControl,e.contentDisposition,e.contentEncoding,e.contentLanguage,e.contentType)}(e,r);throw new RangeError("'version' must be >= '2018-11-09' when generating user delegation SAS using user delegation key.")}throw new RangeError("'version' must be >= '2015-04-05'.")}function aX(e,t,i){const n=[`/blob/${e}/${t}`];return i&&n.push("/"+i),n.join("")}function lX(e){const t=e.version?e.version:"2023-11-03";if(e.snapshotTime&&t<"2018-11-09")throw RangeError("'version' must be >= '2018-11-09' when providing 'snapshotTime'.");if(void 0===e.blobName&&e.snapshotTime)throw RangeError("Must provide 'blobName' when providing 'snapshotTime'.");if(e.versionId&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'versionId'.");if(void 0===e.blobName&&e.versionId)throw RangeError("Must provide 'blobName' when providing 'versionId'.");if(e.permissions&&e.permissions.setImmutabilityPolicy&&t<"2020-08-04")throw RangeError("'version' must be >= '2020-08-04' when provided 'i' permission.");if(e.permissions&&e.permissions.deleteVersion&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'x' permission.");if(e.permissions&&e.permissions.permanentDelete&&t<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when providing 'y' permission.");if(e.permissions&&e.permissions.tag&&t<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when providing 't' permission.");if(t<"2020-02-10"&&e.permissions&&(e.permissions.move||e.permissions.execute))throw RangeError("'version' must be >= '2020-02-10' when providing the 'm' or 'e' permission.");if(t<"2021-04-10"&&e.permissions&&e.permissions.filterByTags)throw RangeError("'version' must be >= '2021-04-10' when providing the 'f' permission.");if(t<"2020-02-10"&&(e.preauthorizedAgentObjectId||e.correlationId))throw RangeError("'version' must be >= '2020-02-10' when providing 'preauthorizedAgentObjectId' or 'correlationId'.");if(e.encryptionScope&&t<"2020-12-06")throw RangeError("'version' must be >= '2020-12-06' when provided 'encryptionScope' in SAS.");return e.version=t,e}class cX{constructor(e){this.client=e}download(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,uX)}getProperties(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,dX)}delete(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,pX)}undelete(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,mX)}setExpiry(e,t){const i={expiryOptions:e,options:XF(t||{})};return this.client.sendOperationRequest(i,fX)}setHttpHeaders(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,gX)}setImmutabilityPolicy(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,_X)}deleteImmutabilityPolicy(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,yX)}setLegalHold(e,t){const i={legalHold:e,options:XF(t||{})};return this.client.sendOperationRequest(i,vX)}setMetadata(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,xX)}acquireLease(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,bX)}releaseLease(e,t){const i={leaseId:e,options:XF(t||{})};return this.client.sendOperationRequest(i,wX)}renewLease(e,t){const i={leaseId:e,options:XF(t||{})};return this.client.sendOperationRequest(i,CX)}changeLease(e,t,i){const n={leaseId:e,proposedLeaseId:t,options:XF(i||{})};return this.client.sendOperationRequest(n,SX)}breakLease(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,EX)}createSnapshot(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,TX)}startCopyFromURL(e,t){const i={copySource:e,options:XF(t||{})};return this.client.sendOperationRequest(i,PX)}copyFromURL(e,t){const i={copySource:e,options:XF(t||{})};return this.client.sendOperationRequest(i,MX)}abortCopyFromURL(e,t){const i={copyId:e,options:XF(t||{})};return this.client.sendOperationRequest(i,kX)}setTier(e,t){const i={tier:e,options:XF(t||{})};return this.client.sendOperationRequest(i,AX)}getAccountInfo(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,IX)}query(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,RX)}getTags(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,OX)}setTags(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,NX)}}const hX=new uj(n,!0),uX={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:oU},206:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:oU},default:{bodyMapper:Pj,headersMapper:aU}},queryParameters:[Gq,kH,AH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,IH,{parameterPath:["options","rangeGetContentMD5"],mapper:{serializedName:"x-ms-range-get-content-md5",xmlName:"x-ms-range-get-content-md5",type:{name:"Boolean"}}},{parameterPath:["options","rangeGetContentCRC64"],mapper:{serializedName:"x-ms-range-get-content-crc64",xmlName:"x-ms-range-get-content-crc64",type:{name:"Boolean"}}},RH,OH,NH,DH,zH,LH],isXML:!0,serializer:hX},dX={path:"/{containerName}/{blob}",httpMethod:"HEAD",responses:{200:{headersMapper:lU},default:{bodyMapper:Pj,headersMapper:cU}},queryParameters:[Gq,kH,AH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,RH,OH,NH,DH,zH,LH],isXML:!0,serializer:hX},pX={path:"/{containerName}/{blob}",httpMethod:"DELETE",responses:{202:{headersMapper:hU},default:{bodyMapper:Pj,headersMapper:uU}},queryParameters:[Gq,kH,AH,{parameterPath:["options","blobDeleteType"],mapper:{serializedName:"deletetype",xmlName:"deletetype",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,DH,zH,LH,{parameterPath:["options","deleteSnapshots"],mapper:{serializedName:"x-ms-delete-snapshots",xmlName:"x-ms-delete-snapshots",type:{name:"Enum",allowedValues:["include","only"]}}}],isXML:!0,serializer:hX},mX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:dU},default:{bodyMapper:Pj,headersMapper:pU}},queryParameters:[Gq,gH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:hX},fX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:mU},default:{bodyMapper:Pj,headersMapper:fU}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"expiry",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,{parameterPath:"expiryOptions",mapper:{serializedName:"x-ms-expiry-option",required:!0,xmlName:"x-ms-expiry-option",type:{name:"String"}}},{parameterPath:["options","expiresOn"],mapper:{serializedName:"x-ms-expiry-time",xmlName:"x-ms-expiry-time",type:{name:"String"}}}],isXML:!0,serializer:hX},gX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:gU},default:{bodyMapper:Pj,headersMapper:_U}},queryParameters:[Hq,Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,DH,zH,LH,BH,FH,jH,VH,UH,qH],isXML:!0,serializer:hX},_X={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:yU},default:{bodyMapper:Pj,headersMapper:vU}},queryParameters:[Gq,HH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,pH,GH,WH],isXML:!0,serializer:hX},yX={path:"/{containerName}/{blob}",httpMethod:"DELETE",responses:{200:{headersMapper:xU},default:{bodyMapper:Pj,headersMapper:bU}},queryParameters:[Gq,HH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q],isXML:!0,serializer:hX},vX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:wU},default:{bodyMapper:Pj,headersMapper:CU}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"legalhold",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,{parameterPath:"legalHold",mapper:{serializedName:"x-ms-legal-hold",required:!0,xmlName:"x-ms-legal-hold",type:{name:"Boolean"}}}],isXML:!0,serializer:hX},xX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:SU},default:{bodyMapper:Pj,headersMapper:EU}},queryParameters:[Gq,mH],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH],isXML:!0,serializer:hX},bX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:TU},default:{bodyMapper:Pj,headersMapper:PU}},queryParameters:[Gq,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,yH,vH,xH,DH,zH,LH],isXML:!0,serializer:hX},wX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:MU},default:{bodyMapper:Pj,headersMapper:kU}},queryParameters:[Gq,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,bH,wH,DH,zH,LH],isXML:!0,serializer:hX},CX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:AU},default:{bodyMapper:Pj,headersMapper:IU}},queryParameters:[Gq,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,wH,CH,DH,zH,LH],isXML:!0,serializer:hX},SX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:RU},default:{bodyMapper:Pj,headersMapper:OU}},queryParameters:[Gq,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,wH,TH,PH,DH,zH,LH],isXML:!0,serializer:hX},EX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:NU},default:{bodyMapper:Pj,headersMapper:DU}},queryParameters:[Gq,_H],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,SH,EH,DH,zH,LH],isXML:!0,serializer:hX},TX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:zU},default:{bodyMapper:Pj,headersMapper:LU}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"snapshot",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH],isXML:!0,serializer:hX},PX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:BU},default:{bodyMapper:Pj,headersMapper:FU}},queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,uH,dH,pH,DH,zH,LH,GH,WH,$H,XH,KH,YH,JH,QH,eG,tG,iG,{parameterPath:["options","sealBlob"],mapper:{serializedName:"x-ms-seal-blob",xmlName:"x-ms-seal-blob",type:{name:"Boolean"}}},nG],isXML:!0,serializer:hX},MX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:jU},default:{bodyMapper:Pj,headersMapper:VU}},queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,cH,uH,dH,pH,DH,zH,LH,GH,WH,ZH,$H,KH,YH,JH,QH,tG,iG,nG,{parameterPath:"xMsRequiresSync",mapper:{defaultValue:"true",isConstant:!0,serializedName:"x-ms-requires-sync",type:{name:"String"}}},rG,sG,oG],isXML:!0,serializer:hX},kX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{204:{headersMapper:UU},default:{bodyMapper:Pj,headersMapper:qU}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"copy",isConstant:!0,serializedName:"comp",type:{name:"String"}}},{parameterPath:"copyId",mapper:{serializedName:"copyid",required:!0,xmlName:"copyid",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,{parameterPath:"copyActionAbortConstant",mapper:{defaultValue:"abort",isConstant:!0,serializedName:"x-ms-copy-action",type:{name:"String"}}}],isXML:!0,serializer:hX},AX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:HU},202:{headersMapper:HU},default:{bodyMapper:Pj,headersMapper:GU}},queryParameters:[Gq,kH,AH,{parameterPath:"comp",mapper:{defaultValue:"tier",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,LH,XH,{parameterPath:"tier",mapper:{serializedName:"x-ms-access-tier",required:!0,xmlName:"x-ms-access-tier",type:{name:"Enum",allowedValues:["P4","P6","P10","P15","P20","P30","P40","P50","P60","P70","P80","Hot","Cool","Archive","Cold"]}}}],isXML:!0,serializer:hX},IX={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{headersMapper:WU},default:{bodyMapper:Pj,headersMapper:ZU}},queryParameters:[Hq,tH],urlParameters:[Uq],headerParameters:[Wq,$q],isXML:!0,serializer:hX},RX={path:"/{containerName}/{blob}",httpMethod:"POST",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:$U},206:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:$U},default:{bodyMapper:Pj,headersMapper:XU}},requestBody:aG,queryParameters:[Gq,kH,{parameterPath:"comp",mapper:{defaultValue:"query",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,uH,dH,pH,RH,OH,NH,DH,zH,LH],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:hX},OX={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:Lj,headersMapper:KU},default:{bodyMapper:Pj,headersMapper:YU}},queryParameters:[Gq,kH,AH,lG],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,LH],isXML:!0,serializer:hX},NX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{204:{headersMapper:JU},default:{bodyMapper:Pj,headersMapper:QU}},requestBody:cG,queryParameters:[Gq,AH,lG],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,uH,LH,hG,uG],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:hX};class DX{constructor(e,t){const i=new K$(e.url,e.pipeline.toServiceClientOptions());this._url=e.url,void 0===e.name?(this._isContainer=!0,this._containerOrBlobOperation=new HG(i)):(this._isContainer=!1,this._containerOrBlobOperation=new cX(i)),t||(t=lj()),this._leaseId=t}get leaseId(){return this._leaseId}get url(){return this._url}async acquireLease(e,t={}){var i,n,r,s,o,a;const{span:l,updatedOptions:c}=J$("BlobLeaseClient-acquireLease",t);if(this._isContainer&&((null===(i=t.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(n=t.conditions)||void 0===n?void 0:n.ifMatch)||(null===(r=t.conditions)||void 0===r?void 0:r.ifNoneMatch)&&""!==(null===(s=t.conditions)||void 0===s?void 0:s.ifNoneMatch)||(null===(o=t.conditions)||void 0===o?void 0:o.tagConditions)))throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");try{return await this._containerOrBlobOperation.acquireLease(Object.assign({abortSignal:t.abortSignal,duration:e,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(a=t.conditions)||void 0===a?void 0:a.tagConditions}),proposedLeaseId:this._leaseId},Q$(c)))}catch(P0){throw l.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{l.end()}}async changeLease(e,t={}){var i,n,r,s,o,a;const{span:l,updatedOptions:c}=J$("BlobLeaseClient-changeLease",t);if(this._isContainer&&((null===(i=t.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(n=t.conditions)||void 0===n?void 0:n.ifMatch)||(null===(r=t.conditions)||void 0===r?void 0:r.ifNoneMatch)&&""!==(null===(s=t.conditions)||void 0===s?void 0:s.ifNoneMatch)||(null===(o=t.conditions)||void 0===o?void 0:o.tagConditions)))throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");try{const i=await this._containerOrBlobOperation.changeLease(this._leaseId,e,Object.assign({abortSignal:t.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(a=t.conditions)||void 0===a?void 0:a.tagConditions})},Q$(c)));return this._leaseId=e,i}catch(P0){throw l.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{l.end()}}async releaseLease(e={}){var t,i,n,r,s,o;const{span:a,updatedOptions:l}=J$("BlobLeaseClient-releaseLease",e);if(this._isContainer&&((null===(t=e.conditions)||void 0===t?void 0:t.ifMatch)&&""!==(null===(i=e.conditions)||void 0===i?void 0:i.ifMatch)||(null===(n=e.conditions)||void 0===n?void 0:n.ifNoneMatch)&&""!==(null===(r=e.conditions)||void 0===r?void 0:r.ifNoneMatch)||(null===(s=e.conditions)||void 0===s?void 0:s.tagConditions)))throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");try{return await this._containerOrBlobOperation.releaseLease(this._leaseId,Object.assign({abortSignal:e.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(o=e.conditions)||void 0===o?void 0:o.tagConditions})},Q$(l)))}catch(P0){throw a.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{a.end()}}async renewLease(e={}){var t,i,n,r,s,o;const{span:a,updatedOptions:l}=J$("BlobLeaseClient-renewLease",e);if(this._isContainer&&((null===(t=e.conditions)||void 0===t?void 0:t.ifMatch)&&""!==(null===(i=e.conditions)||void 0===i?void 0:i.ifMatch)||(null===(n=e.conditions)||void 0===n?void 0:n.ifNoneMatch)&&""!==(null===(r=e.conditions)||void 0===r?void 0:r.ifNoneMatch)||(null===(s=e.conditions)||void 0===s?void 0:s.tagConditions)))throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");try{return await this._containerOrBlobOperation.renewLease(this._leaseId,Object.assign({abortSignal:e.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(o=e.conditions)||void 0===o?void 0:o.tagConditions})},Q$(l)))}catch(P0){throw a.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{a.end()}}async breakLease(e,t={}){var i,n,r,s,o,a;const{span:l,updatedOptions:c}=J$("BlobLeaseClient-breakLease",t);if(this._isContainer&&((null===(i=t.conditions)||void 0===i?void 0:i.ifMatch)&&""!==(null===(n=t.conditions)||void 0===n?void 0:n.ifMatch)||(null===(r=t.conditions)||void 0===r?void 0:r.ifNoneMatch)&&""!==(null===(s=t.conditions)||void 0===s?void 0:s.ifNoneMatch)||(null===(o=t.conditions)||void 0===o?void 0:o.tagConditions)))throw new RangeError("The IfMatch, IfNoneMatch and tags access conditions are ignored by the service. Values other than undefined or their default values are not acceptable.");try{const i=Object.assign({abortSignal:t.abortSignal,breakPeriod:e,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(a=t.conditions)||void 0===a?void 0:a.tagConditions})},Q$(c));return await this._containerOrBlobOperation.breakLease(i)}catch(P0){throw l.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{l.end()}}}class zX{constructor(e,t={}){this.originalResponse=e}get acceptRanges(){return this.originalResponse.acceptRanges}get cacheControl(){return this.originalResponse.cacheControl}get contentDisposition(){return this.originalResponse.contentDisposition}get contentEncoding(){return this.originalResponse.contentEncoding}get contentLanguage(){return this.originalResponse.contentLanguage}get blobSequenceNumber(){return this.originalResponse.blobSequenceNumber}get blobType(){return this.originalResponse.blobType}get contentLength(){return this.originalResponse.contentLength}get contentMD5(){return this.originalResponse.contentMD5}get contentRange(){return this.originalResponse.contentRange}get contentType(){return this.originalResponse.contentType}get copyCompletedOn(){}get copyId(){return this.originalResponse.copyId}get copyProgress(){return this.originalResponse.copyProgress}get copySource(){return this.originalResponse.copySource}get copyStatus(){return this.originalResponse.copyStatus}get copyStatusDescription(){return this.originalResponse.copyStatusDescription}get leaseDuration(){return this.originalResponse.leaseDuration}get leaseState(){return this.originalResponse.leaseState}get leaseStatus(){return this.originalResponse.leaseStatus}get date(){return this.originalResponse.date}get blobCommittedBlockCount(){return this.originalResponse.blobCommittedBlockCount}get etag(){return this.originalResponse.etag}get errorCode(){return this.originalResponse.errorCode}get isServerEncrypted(){return this.originalResponse.isServerEncrypted}get blobContentMD5(){return this.originalResponse.blobContentMD5}get lastModified(){return this.originalResponse.lastModified}get metadata(){return this.originalResponse.metadata}get requestId(){return this.originalResponse.requestId}get clientRequestId(){return this.originalResponse.clientRequestId}get version(){return this.originalResponse.version}get encryptionKeySha256(){return this.originalResponse.encryptionKeySha256}get contentCrc64(){return this.originalResponse.contentCrc64}get blobBody(){throw Error("Quick query in browser is not supported yet.")}get readableStreamBody(){}get _response(){return this.originalResponse._response}}class LX{constructor(e){this.client=e}create(e,t){const i={contentLength:e,options:XF(t||{})};return this.client.sendOperationRequest(i,jX)}appendBlock(e,t,i){const n={contentLength:e,body:t,options:XF(i||{})};return this.client.sendOperationRequest(n,VX)}appendBlockFromUrl(e,t,i){const n={sourceUrl:e,contentLength:t,options:XF(i||{})};return this.client.sendOperationRequest(n,UX)}seal(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,qX)}}const BX=new uj(n,!0),FX=new uj(n,!1),jX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:yq},default:{bodyMapper:Pj,headersMapper:vq}},queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,BH,FH,jH,VH,UH,qH,GH,WH,ZH,iG,nG,{parameterPath:"blobType",mapper:{defaultValue:"AppendBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}}],isXML:!0,serializer:BX},VX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:xq},default:{bodyMapper:Pj,headersMapper:bq}},requestBody:fG,queryParameters:[Gq,EG],urlParameters:[Uq],headerParameters:[Wq,Zq,rH,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH,hG,uG,mG,gG,TG,PG],mediaType:"binary",serializer:FX},UX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:wq},default:{bodyMapper:Pj,headersMapper:Cq}},queryParameters:[Gq,EG],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH,KH,YH,JH,QH,rG,sG,hG,wG,CG,TG,PG,MG],isXML:!0,serializer:BX},qX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:Sq},default:{bodyMapper:Pj,headersMapper:Eq}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"seal",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,DH,zH,PG],isXML:!0,serializer:BX};class HX{constructor(e){this.client=e}upload(e,t,i){const n={contentLength:e,body:t,options:XF(i||{})};return this.client.sendOperationRequest(n,ZX)}putBlobFromUrl(e,t,i){const n={contentLength:e,copySource:t,options:XF(i||{})};return this.client.sendOperationRequest(n,$X)}stageBlock(e,t,i,n){const r={blockId:e,contentLength:t,body:i,options:XF(n||{})};return this.client.sendOperationRequest(r,XX)}stageBlockFromURL(e,t,i,n){const r={blockId:e,contentLength:t,sourceUrl:i,options:XF(n||{})};return this.client.sendOperationRequest(r,KX)}commitBlockList(e,t){const i={blocks:e,options:XF(t||{})};return this.client.sendOperationRequest(i,YX)}getBlockList(e,t){const i={listType:e,options:XF(t||{})};return this.client.sendOperationRequest(i,JX)}}const GX=new uj(n,!0),WX=new uj(n,!1),ZX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:Tq},default:{bodyMapper:Pj,headersMapper:Pq}},requestBody:fG,queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,rH,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,BH,FH,jH,VH,UH,qH,GH,WH,ZH,$H,iG,nG,hG,uG,mG,gG,kG],mediaType:"binary",serializer:WX},$X={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:Mq},default:{bodyMapper:Pj,headersMapper:kq}},queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,BH,FH,jH,VH,UH,qH,ZH,$H,KH,YH,JH,QH,eG,tG,iG,rG,sG,oG,hG,kG,{parameterPath:["options","copySourceBlobProperties"],mapper:{serializedName:"x-ms-copy-source-blob-properties",xmlName:"x-ms-copy-source-blob-properties",type:{name:"Boolean"}}}],isXML:!0,serializer:GX},XX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:Aq},default:{bodyMapper:Pj,headersMapper:Iq}},requestBody:fG,queryParameters:[Gq,AG,IG],urlParameters:[Uq],headerParameters:[Wq,Zq,rH,uH,RH,OH,NH,ZH,hG,uG,mG,gG],mediaType:"binary",serializer:WX},KX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:Rq},default:{bodyMapper:Pj,headersMapper:Oq}},queryParameters:[Gq,AG,IG],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,uH,RH,OH,NH,ZH,KH,YH,JH,QH,rG,sG,wG,CG,MG],isXML:!0,serializer:GX},YX={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:Nq},default:{bodyMapper:Pj,headersMapper:Dq}},requestBody:RG,queryParameters:[Gq,OG],urlParameters:[Uq],headerParameters:[Fq,Vq,Wq,Zq,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,BH,FH,jH,VH,UH,qH,GH,WH,ZH,$H,iG,nG,hG,uG],isXML:!0,contentType:"application/xml; charset=utf-8",mediaType:"xml",serializer:GX},JX={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:Kj,headersMapper:zq},default:{bodyMapper:Pj,headersMapper:Lq}},queryParameters:[Gq,kH,OG,{parameterPath:"listType",mapper:{defaultValue:"committed",serializedName:"blocklisttype",required:!0,xmlName:"blocklisttype",type:{name:"Enum",allowedValues:["committed","uncommitted","all"]}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,LH],isXML:!0,serializer:GX};class QX{constructor(e){this.client=e}create(e,t,i){const n={contentLength:e,blobContentLength:t,options:XF(i||{})};return this.client.sendOperationRequest(n,iK)}uploadPages(e,t,i){const n={contentLength:e,body:t,options:XF(i||{})};return this.client.sendOperationRequest(n,nK)}clearPages(e,t){const i={contentLength:e,options:XF(t||{})};return this.client.sendOperationRequest(i,rK)}uploadPagesFromURL(e,t,i,n,r){const s={sourceUrl:e,sourceRange:t,contentLength:i,range:n,options:XF(r||{})};return this.client.sendOperationRequest(s,sK)}getPageRanges(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,oK)}getPageRangesDiff(e){const t={options:XF(e||{})};return this.client.sendOperationRequest(t,aK)}resize(e,t){const i={blobContentLength:e,options:XF(t||{})};return this.client.sendOperationRequest(i,lK)}updateSequenceNumber(e,t){const i={sequenceNumberAction:e,options:XF(t||{})};return this.client.sendOperationRequest(i,cK)}copyIncremental(e,t){const i={copySource:e,options:XF(t||{})};return this.client.sendOperationRequest(i,hK)}}const eK=new uj(n,!0),tK=new uj(n,!1),iK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:eq},default:{bodyMapper:Pj,headersMapper:tq}},queryParameters:[Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,cH,uH,dH,pH,RH,OH,NH,DH,zH,LH,BH,FH,jH,VH,UH,qH,GH,WH,ZH,$H,iG,nG,{parameterPath:"blobType",mapper:{defaultValue:"PageBlob",isConstant:!0,serializedName:"x-ms-blob-type",type:{name:"String"}}},dG,pG],isXML:!0,serializer:eK},nK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:iq},default:{bodyMapper:Pj,headersMapper:nq}},requestBody:fG,queryParameters:[Gq,_G],urlParameters:[Uq],headerParameters:[Wq,Zq,rH,uH,dH,pH,IH,RH,OH,NH,DH,zH,LH,ZH,hG,uG,mG,gG,yG,vG,xG,bG],mediaType:"binary",serializer:tK},rK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:rq},default:{bodyMapper:Pj,headersMapper:sq}},queryParameters:[Gq,_G],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,uH,dH,pH,IH,RH,OH,NH,DH,zH,LH,ZH,vG,xG,bG,{parameterPath:"pageWrite",mapper:{defaultValue:"clear",isConstant:!0,serializedName:"x-ms-page-write",type:{name:"String"}}}],isXML:!0,serializer:eK},sK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{201:{headersMapper:oq},default:{bodyMapper:Pj,headersMapper:aq}},queryParameters:[Gq,_G],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,rH,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH,KH,YH,JH,QH,rG,sG,yG,vG,xG,bG,wG,{parameterPath:"sourceRange",mapper:{serializedName:"x-ms-source-range",required:!0,xmlName:"x-ms-source-range",type:{name:"String"}}},CG,{parameterPath:"range",mapper:{serializedName:"x-ms-range",required:!0,xmlName:"x-ms-range",type:{name:"String"}}}],isXML:!0,serializer:eK},oK={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:Jj,headersMapper:lq},default:{bodyMapper:Pj,headersMapper:cq}},queryParameters:[Gq,Yq,Jq,kH,SG],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,IH,DH,zH,LH],isXML:!0,serializer:eK},aK={path:"/{containerName}/{blob}",httpMethod:"GET",responses:{200:{bodyMapper:Jj,headersMapper:hq},default:{bodyMapper:Pj,headersMapper:uq}},queryParameters:[Gq,Yq,Jq,kH,SG,{parameterPath:["options","prevsnapshot"],mapper:{serializedName:"prevsnapshot",xmlName:"prevsnapshot",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,IH,DH,zH,LH,{parameterPath:["options","prevSnapshotUrl"],mapper:{serializedName:"x-ms-previous-snapshot-url",xmlName:"x-ms-previous-snapshot-url",type:{name:"String"}}}],isXML:!0,serializer:eK},lK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:dq},default:{bodyMapper:Pj,headersMapper:pq}},queryParameters:[Hq,Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,RH,OH,NH,DH,zH,LH,ZH,dG],isXML:!0,serializer:eK},cK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{200:{headersMapper:mq},default:{bodyMapper:Pj,headersMapper:fq}},queryParameters:[Hq,Gq],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,uH,dH,pH,DH,zH,LH,pG,{parameterPath:"sequenceNumberAction",mapper:{serializedName:"x-ms-sequence-number-action",required:!0,xmlName:"x-ms-sequence-number-action",type:{name:"Enum",allowedValues:["max","update","increment"]}}}],isXML:!0,serializer:eK},hK={path:"/{containerName}/{blob}",httpMethod:"PUT",responses:{202:{headersMapper:gq},default:{bodyMapper:Pj,headersMapper:_q}},queryParameters:[Gq,{parameterPath:"comp",mapper:{defaultValue:"incrementalcopy",isConstant:!0,serializedName:"comp",type:{name:"String"}}}],urlParameters:[Uq],headerParameters:[Wq,Zq,$q,dH,pH,DH,zH,LH,tG],isXML:!0,serializer:eK};var uK,dK,pK;function mK(e){if(void 0!==e)return e}function fK(e,t){if(e&&!t)throw new RangeError("Customer-provided encryption key must be used over HTTPS.");e&&!e.encryptionAlgorithm&&(e.encryptionAlgorithm="AES256")}function gK(e){const t=(e._response.parsedBody.pageRange||[]).map(e=>({offset:e.start,count:e.end-e.start})),i=(e._response.parsedBody.clearRange||[]).map(e=>({offset:e.start,count:e.end-e.start}));return Object.assign(Object.assign({},e),{pageRange:t,clearRange:i,_response:Object.assign(Object.assign({},e._response),{parsedBody:{pageRange:t,clearRange:i}})})}!function(e){e.Hot="Hot",e.Cool="Cool",e.Cold="Cold",e.Archive="Archive"}(uK||(uK={})),function(e){e.P4="P4",e.P6="P6",e.P10="P10",e.P15="P15",e.P20="P20",e.P30="P30",e.P40="P40",e.P50="P50",e.P60="P60",e.P70="P70",e.P80="P80"}(dK||(dK={})),function(e){e.StorageOAuthScopes="https://storage.azure.com/.default",e.DiskComputeOAuthScopes="https://disk.compute.azure.com/.default"}(pK||(pK={}));class _K extends Error{constructor(e){super(e),this.name="PollerStoppedError",Object.setPrototypeOf(this,_K.prototype)}}class yK extends Error{constructor(e){super(e),this.name="PollerCancelledError",Object.setPrototypeOf(this,yK.prototype)}}class vK extends class{constructor(e){this.resolveOnUnsuccessful=!1,this.stopped=!0,this.pollProgressCallbacks=[],this.operation=e,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.promise.catch(()=>{})}async startPolling(e={}){for(this.stopped&&(this.stopped=!1);!this.isStopped()&&!this.isDone();)await this.poll(e),await this.delay()}async pollOnce(e={}){this.isDone()||(this.operation=await this.operation.update({abortSignal:e.abortSignal,fireProgress:this.fireProgress.bind(this)})),this.processUpdatedState()}fireProgress(e){for(const t of this.pollProgressCallbacks)t(e)}async cancelOnce(e={}){this.operation=await this.operation.cancel(e)}poll(e={}){if(!this.pollOncePromise){this.pollOncePromise=this.pollOnce(e);const t=()=>{this.pollOncePromise=void 0};this.pollOncePromise.then(t,t).catch(this.reject)}return this.pollOncePromise}processUpdatedState(){if(this.operation.state.error&&(this.stopped=!0,!this.resolveOnUnsuccessful))throw this.reject(this.operation.state.error),this.operation.state.error;if(this.operation.state.isCancelled&&(this.stopped=!0,!this.resolveOnUnsuccessful)){const e=new yK("Operation was canceled");throw this.reject(e),e}this.isDone()&&this.resolve&&this.resolve(this.getResult())}async pollUntilDone(e={}){return this.stopped&&this.startPolling(e).catch(this.reject),this.processUpdatedState(),this.promise}onProgress(e){return this.pollProgressCallbacks.push(e),()=>{this.pollProgressCallbacks=this.pollProgressCallbacks.filter(t=>t!==e)}}isDone(){const e=this.operation.state;return Boolean(e.isCompleted||e.isCancelled||e.error)}stopPolling(){this.stopped||(this.stopped=!0,this.reject&&this.reject(new _K("This poller is already stopped")))}isStopped(){return this.stopped}cancelOperation(e={}){if(this.cancelPromise){if(e.abortSignal)throw new Error("A cancel request is currently pending")}else this.cancelPromise=this.cancelOnce(e);return this.cancelPromise}getOperationState(){return this.operation.state}getResult(){return this.operation.state.result}toString(){return this.operation.toString()}}{constructor(e){const{blobClient:t,copySource:i,intervalInMs:n=15e3,onProgress:r,resumeFrom:s,startCopyFromURLOptions:o}=e;let a;s&&(a=JSON.parse(s).state),super(CK(Object.assign(Object.assign({},a),{blobClient:t,copySource:i,startCopyFromURLOptions:o}))),"function"==typeof r&&this.onProgress(r),this.intervalInMs=n}delay(){return f$(this.intervalInMs)}}const xK=async function(e={}){const t=this.state,{copyId:i}=t;return t.isCompleted?CK(t):i?(await t.blobClient.abortCopyFromURL(i,{abortSignal:e.abortSignal}),t.isCancelled=!0,CK(t)):(t.isCancelled=!0,CK(t))},bK=async function(e={}){const t=this.state,{blobClient:i,copySource:n,startCopyFromURLOptions:r}=t;if(t.isStarted){if(!t.isCompleted)try{const i=await t.blobClient.getProperties({abortSignal:e.abortSignal}),{copyStatus:n,copyProgress:r}=i,s=t.copyProgress;r&&(t.copyProgress=r),"pending"===n&&r!==s&&"function"==typeof e.fireProgress?e.fireProgress(t):"success"===n?(t.result=i,t.isCompleted=!0):"failed"===n&&(t.error=new Error(`Blob copy failed with reason: "${i.copyStatusDescription||"unknown"}"`),t.isCompleted=!0)}catch(T0){t.error=T0,t.isCompleted=!0}}else{t.isStarted=!0;const e=await i.startCopyFromURL(n,r);t.copyId=e.copyId,"success"===e.copyStatus&&(t.result=e,t.isCompleted=!0)}return CK(t)},wK=function(){return JSON.stringify({state:this.state},(e,t)=>{if("blobClient"!==e)return t})};function CK(e){return{state:Object.assign({},e),cancel:xK,toString:wK,update:bK}}function SK(e){if(e.offset<0)throw new RangeError("Range.offset cannot be smaller than 0.");if(e.count&&e.count<=0)throw new RangeError("Range.count must be larger than 0. Leave it undefined if you want a range from offset to the end.");return e.count?`bytes=${e.offset}-${e.offset+e.count-1}`:`bytes=${e.offset}-`}var EK,TK,PK=i("+qE3");!function(e){e[e.Good=0]="Good",e[e.Error=1]="Error"}(EK||(EK={}));class MK{constructor(e=5){if(this.actives=0,this.completed=0,this.offset=0,this.operations=[],this.state=EK.Good,e<1)throw new RangeError("concurrency must be larger than 0");this.concurrency=e,this.emitter=new PK.EventEmitter}addOperation(e){this.operations.push(async()=>{try{this.actives++,await e(),this.actives--,this.completed++,this.parallelExecute()}catch(t){this.emitter.emit("error",t)}})}async do(){return 0===this.operations.length?Promise.resolve():(this.parallelExecute(),new Promise((e,t)=>{this.emitter.on("finish",e),this.emitter.on("error",e=>{this.state=EK.Error,t(e)})}))}nextOperation(){return this.offset<this.operations.length?this.operations[this.offset++]:null}parallelExecute(){if(this.state!==EK.Error)if(this.completed>=this.operations.length)this.emitter.emit("finish");else for(;this.actives<this.concurrency;){const e=this.nextOperation();if(!e)return;e()}}}class kK{}class AK extends Y${constructor(e,t,i,n){let r,s;if(n=n||{},y$(t))s=e,r=t;else if($B&&t instanceof b$||t instanceof o$||XB(t))s=e,r=x$(t,n=i);else if(t||"string"==typeof t){if(!t||"string"!=typeof t||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");{const o=t,a=i,l=PZ(e);if("AccountConnString"===l.kind){if(!$B)throw new Error("Account connection string is only supported in Node.js environment");{const e=new b$(l.accountName,l.accountKey);s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a)),n.proxyOptions||(n.proxyOptions=void 0),r=x$(e,n)}}else{if("SASConnString"!==l.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a))+"?"+l.accountSas,r=x$(new o$,n)}}}else s=e,i&&"string"!=typeof i&&(n=i),r=x$(new o$,n);super(s,r),({blobName:this._name,containerName:this._containerName}=this.getBlobAndContainerNamesFromUrl()),this.blobContext=new cX(this.storageClientContext),this._snapshot=AZ(this.url,"snapshot"),this._versionId=AZ(this.url,"versionid")}get name(){return this._name}get containerName(){return this._containerName}withSnapshot(e){return new AK(kZ(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}withVersion(e){return new AK(kZ(this.url,"versionid",0===e.length?void 0:e),this.pipeline)}getAppendBlobClient(){return new IK(this.url,this.pipeline)}getBlockBlobClient(){return new RK(this.url,this.pipeline)}getPageBlobClient(){return new OK(this.url,this.pipeline)}async download(e=0,t,i={}){var n;i.conditions=i.conditions||{},i.conditions=i.conditions||{},fK(i.customerProvidedKey,this.isHttps);const{span:r,updatedOptions:s}=J$("BlobClient-download",i);try{const o=await this.blobContext.download(Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions}),requestOptions:{onDownloadProgress:$B?void 0:i.onProgress},range:0!==e||t?SK({offset:e,count:t}):void 0,rangeGetContentMD5:i.rangeGetContentMD5,rangeGetContentCRC64:i.rangeGetContentCrc64,snapshot:i.snapshot,cpkInfo:i.customerProvidedKey},Q$(s))),a=Object.assign(Object.assign({},o),{_response:o._response,objectReplicationDestinationPolicyId:o.objectReplicationPolicyId,objectReplicationSourceProperties:qZ(o.objectReplicationRules)});if(!$B)return a;if((void 0===i.maxRetryRequests||i.maxRetryRequests<0)&&(i.maxRetryRequests=5),void 0===o.contentLength)throw new RangeError("File download response doesn't contain valid content length header");if(!o.etag)throw new RangeError("File download response doesn't contain valid etag header");return new 1(a,async t=>{var n;const r={leaseAccessConditions:i.conditions,modifiedAccessConditions:{ifMatch:i.conditions.ifMatch||o.etag,ifModifiedSince:i.conditions.ifModifiedSince,ifNoneMatch:i.conditions.ifNoneMatch,ifUnmodifiedSince:i.conditions.ifUnmodifiedSince,ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions},range:SK({count:e+o.contentLength-t,offset:t}),rangeGetContentMD5:i.rangeGetContentMD5,rangeGetContentCRC64:i.rangeGetContentCrc64,snapshot:i.snapshot,cpkInfo:i.customerProvidedKey};return(await this.blobContext.download(Object.assign({abortSignal:i.abortSignal},r))).readableStreamBody},e,o.contentLength,{maxRetryRequests:i.maxRetryRequests,onProgress:i.onProgress})}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async exists(e={}){const{span:t,updatedOptions:i}=J$("BlobClient-exists",e);try{return fK(e.customerProvidedKey,this.isHttps),await this.getProperties({abortSignal:e.abortSignal,customerProvidedKey:e.customerProvidedKey,conditions:e.conditions,tracingOptions:i.tracingOptions}),!0}catch(P0){if(404===P0.statusCode)return!1;if(409===P0.statusCode&&("BlobUsesCustomerSpecifiedEncryption"===P0.details.errorCode||"BlobDoesNotUseCustomerSpecifiedEncryption"===P0.details.errorCode))return!0;throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async getProperties(e={}){var t;const{span:i,updatedOptions:n}=J$("BlobClient-getProperties",e);try{e.conditions=e.conditions||{},fK(e.customerProvidedKey,this.isHttps);const r=await this.blobContext.getProperties(Object.assign({abortSignal:e.abortSignal,leaseAccessConditions:e.conditions,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions}),cpkInfo:e.customerProvidedKey},Q$(n)));return Object.assign(Object.assign({},r),{_response:r._response,objectReplicationDestinationPolicyId:r.objectReplicationPolicyId,objectReplicationSourceProperties:qZ(r.objectReplicationRules)})}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async delete(e={}){var t;const{span:i,updatedOptions:n}=J$("BlobClient-delete",e);e.conditions=e.conditions||{};try{return await this.blobContext.delete(Object.assign({abortSignal:e.abortSignal,deleteSnapshots:e.deleteSnapshots,leaseAccessConditions:e.conditions,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions})},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async deleteIfExists(e={}){var t,i;const{span:n,updatedOptions:r}=J$("BlobClient-deleteIfExists",e);try{const e=await this.delete(r);return Object.assign(Object.assign({succeeded:!0},e),{_response:e._response})}catch(P0){if("BlobNotFound"===(null===(t=P0.details)||void 0===t?void 0:t.errorCode))return n.setStatus({code:$F.ERROR,message:"Expected exception when deleting a blob or snapshot only if it exists."}),Object.assign(Object.assign({succeeded:!1},null===(i=P0.response)||void 0===i?void 0:i.parsedHeaders),{_response:P0.response});throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async undelete(e={}){const{span:t,updatedOptions:i}=J$("BlobClient-undelete",e);try{return await this.blobContext.undelete(Object.assign({abortSignal:e.abortSignal},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async setHTTPHeaders(e,t={}){var i;const{span:n,updatedOptions:r}=J$("BlobClient-setHTTPHeaders",t);t.conditions=t.conditions||{};try{return fK(t.customerProvidedKey,this.isHttps),await this.blobContext.setHttpHeaders(Object.assign({abortSignal:t.abortSignal,blobHttpHeaders:e,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions})},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async setMetadata(e,t={}){var i;const{span:n,updatedOptions:r}=J$("BlobClient-setMetadata",t);t.conditions=t.conditions||{};try{return fK(t.customerProvidedKey,this.isHttps),await this.blobContext.setMetadata(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,metadata:e,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:t.customerProvidedKey,encryptionScope:t.encryptionScope},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async setTags(e,t={}){var i;const{span:n,updatedOptions:r}=J$("BlobClient-setTags",t);try{return await this.blobContext.setTags(Object.assign(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions})},Q$(r)),{tags:jZ(e)}))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async getTags(e={}){var t;const{span:i,updatedOptions:n}=J$("BlobClient-getTags",e);try{const r=await this.blobContext.getTags(Object.assign({abortSignal:e.abortSignal,leaseAccessConditions:e.conditions,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions})},Q$(n)));return Object.assign(Object.assign({},r),{_response:r._response,tags:VZ({blobTagSet:r.blobTagSet})||{}})}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}getBlobLeaseClient(e){return new DX(this,e)}async createSnapshot(e={}){var t;const{span:i,updatedOptions:n}=J$("BlobClient-createSnapshot",e);e.conditions=e.conditions||{};try{return fK(e.customerProvidedKey,this.isHttps),await this.blobContext.createSnapshot(Object.assign({abortSignal:e.abortSignal,leaseAccessConditions:e.conditions,metadata:e.metadata,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions}),cpkInfo:e.customerProvidedKey,encryptionScope:e.encryptionScope},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async beginCopyFromURL(e,t={}){const i=new vK({blobClient:{abortCopyFromURL:(...e)=>this.abortCopyFromURL(...e),getProperties:(...e)=>this.getProperties(...e),startCopyFromURL:(...e)=>this.startCopyFromURL(...e)},copySource:e,intervalInMs:t.intervalInMs,onProgress:t.onProgress,resumeFrom:t.resumeFrom,startCopyFromURLOptions:t});return await i.poll(),i}async abortCopyFromURL(e,t={}){const{span:i,updatedOptions:n}=J$("BlobClient-abortCopyFromURL",t);try{return await this.blobContext.abortCopyFromURL(e,Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async syncCopyFromURL(e,t={}){var i,n,r;const{span:s,updatedOptions:o}=J$("BlobClient-syncCopyFromURL",t);t.conditions=t.conditions||{},t.sourceConditions=t.sourceConditions||{};try{return await this.blobContext.copyFromURL(e,Object.assign({abortSignal:t.abortSignal,metadata:t.metadata,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:t.sourceConditions.ifMatch,sourceIfModifiedSince:t.sourceConditions.ifModifiedSince,sourceIfNoneMatch:t.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:t.sourceConditions.ifUnmodifiedSince},sourceContentMD5:t.sourceContentMD5,copySourceAuthorization:GZ(t.sourceAuthorization),tier:mK(t.tier),blobTagsString:FZ(t.tags),immutabilityPolicyExpiry:null===(n=t.immutabilityPolicy)||void 0===n?void 0:n.expiriesOn,immutabilityPolicyMode:null===(r=t.immutabilityPolicy)||void 0===r?void 0:r.policyMode,legalHold:t.legalHold,encryptionScope:t.encryptionScope,copySourceTags:t.copySourceTags},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async setAccessTier(e,t={}){var i;const{span:n,updatedOptions:r}=J$("BlobClient-setAccessTier",t);try{return await this.blobContext.setTier(mK(e),Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),rehydratePriority:t.rehydratePriority},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async downloadToBuffer(e,t,i,n={}){let r,s=0,o=0,a=n;e instanceof Buffer?(r=e,s=t||0,o="number"==typeof i?i:0):(s="number"==typeof e?e:0,o="number"==typeof t?t:0,a=i||{});const{span:l,updatedOptions:c}=J$("BlobClient-downloadToBuffer",a);try{if(a.blockSize||(a.blockSize=0),a.blockSize<0)throw new RangeError("blockSize option must be >= 0");if(0===a.blockSize&&(a.blockSize=4194304),s<0)throw new RangeError("offset option must be >= 0");if(o&&o<=0)throw new RangeError("count option must be greater than 0");if(a.conditions||(a.conditions={}),!o){const e=await this.getProperties(Object.assign(Object.assign({},a),{tracingOptions:Object.assign(Object.assign({},a.tracingOptions),Q$(c))}));if(o=e.contentLength-s,o<0)throw new RangeError(`offset ${s} shouldn't be larger than blob size ${e.contentLength}`)}if(!r)try{r=Buffer.alloc(o)}catch(h){throw new Error(`Unable to allocate the buffer of size: ${o}(in bytes). Please try passing your own buffer to the "downloadToBuffer" method or try using other methods like "download" or "downloadToFile".\t ${h.message}`)}if(r.length<o)throw new RangeError("The buffer's size should be equal to or larger than the request count of bytes: "+o);let e=0;const t=new MK(a.concurrency);for(let i=s;i<s+o;i+=a.blockSize)t.addOperation(async()=>{let t=s+o;i+a.blockSize<t&&(t=i+a.blockSize),await this.download(i,t-i,{abortSignal:a.abortSignal,conditions:a.conditions,maxRetryRequests:a.maxRetryRequestsPerBlock,customerProvidedKey:a.customerProvidedKey,tracingOptions:Object.assign(Object.assign({},a.tracingOptions),Q$(c))}),await void 0,e+=t-i,a.onProgress&&a.onProgress({loadedBytes:e})});return await t.do(),r}catch(P0){throw l.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{l.end()}}async downloadToFile(e,t=0,i,n={}){const{span:r,updatedOptions:s}=J$("BlobClient-downloadToFile",n);try{const e=await this.download(t,i,Object.assign(Object.assign({},n),{tracingOptions:Object.assign(Object.assign({},n.tracingOptions),Q$(s))}));return e.readableStreamBody&&await void 0,e.blobDownloadStream=void 0,e}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}getBlobAndContainerNamesFromUrl(){let e,t;try{const i=qW.parse(this.url);if("blob"===i.getHost().split(".")[1]){const n=i.getPath().match("/([^/]*)(/(.*))?");e=n[1],t=n[3]}else if(BZ(i)){const n=i.getPath().match("/([^/]*)/([^/]*)(/(.*))?");e=n[2],t=n[4]}else{const n=i.getPath().match("/([^/]*)(/(.*))?");e=n[1],t=n[3]}if(e=decodeURIComponent(e),t=decodeURIComponent(t),t=t.replace(/\\/g,"/"),!e)throw new Error("Provided containerName is invalid.");return{blobName:t,containerName:e}}catch(i){throw new Error("Unable to extract blobName and containerName with provided information.")}}async startCopyFromURL(e,t={}){var i,n,r;const{span:s,updatedOptions:o}=J$("BlobClient-startCopyFromURL",t);t.conditions=t.conditions||{},t.sourceConditions=t.sourceConditions||{};try{return await this.blobContext.startCopyFromURL(e,Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,metadata:t.metadata,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:t.sourceConditions.ifMatch,sourceIfModifiedSince:t.sourceConditions.ifModifiedSince,sourceIfNoneMatch:t.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:t.sourceConditions.ifUnmodifiedSince,sourceIfTags:t.sourceConditions.tagConditions},immutabilityPolicyExpiry:null===(n=t.immutabilityPolicy)||void 0===n?void 0:n.expiriesOn,immutabilityPolicyMode:null===(r=t.immutabilityPolicy)||void 0===r?void 0:r.policyMode,legalHold:t.legalHold,rehydratePriority:t.rehydratePriority,tier:mK(t.tier),blobTagsString:FZ(t.tags),sealBlob:t.sealBlob},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}generateSasUrl(e){return new Promise(t=>{if(!(this.credential instanceof b$))throw new RangeError("Can only generate the SAS when the client is initialized with a shared key credential");const i=oX(Object.assign({containerName:this._containerName,blobName:this._name,snapshotTime:this._snapshot,versionId:this._versionId},e),this.credential).toString();t(OZ(this.url,i))})}async deleteImmutabilityPolicy(e){const{span:t,updatedOptions:i}=J$("BlobClient-deleteImmutabilityPolicy",e);try{return await this.blobContext.deleteImmutabilityPolicy(Object.assign({abortSignal:null==e?void 0:e.abortSignal},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async setImmutabilityPolicy(e,t){const{span:i,updatedOptions:n}=J$("BlobClient-setImmutabilityPolicy",t);try{return await this.blobContext.setImmutabilityPolicy(Object.assign({abortSignal:null==t?void 0:t.abortSignal,immutabilityPolicyExpiry:e.expiriesOn,immutabilityPolicyMode:e.policyMode,modifiedAccessConditions:null==t?void 0:t.modifiedAccessCondition},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async setLegalHold(e,t){const{span:i,updatedOptions:n}=J$("BlobClient-setLegalHold",t);try{return await this.blobContext.setLegalHold(e,Object.assign({abortSignal:null==t?void 0:t.abortSignal},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}}class IK extends AK{constructor(e,t,i,n){let r,s;if(n=n||{},y$(t))s=e,r=t;else if($B&&t instanceof b$||t instanceof o$||XB(t))s=e,r=x$(t,n=i);else if(t||"string"==typeof t){if(!t||"string"!=typeof t||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");{const o=t,a=i,l=PZ(e);if("AccountConnString"===l.kind){if(!$B)throw new Error("Account connection string is only supported in Node.js environment");{const e=new b$(l.accountName,l.accountKey);s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a)),n.proxyOptions||(n.proxyOptions=void 0),r=x$(e,n)}}else{if("SASConnString"!==l.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a))+"?"+l.accountSas,r=x$(new o$,n)}}}else s=e,r=x$(new o$,n);super(s,r),this.appendBlobContext=new LX(this.storageClientContext)}withSnapshot(e){return new IK(kZ(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}async create(e={}){var t,i,n;const{span:r,updatedOptions:s}=J$("AppendBlobClient-create",e);e.conditions=e.conditions||{};try{return fK(e.customerProvidedKey,this.isHttps),await this.appendBlobContext.create(0,Object.assign({abortSignal:e.abortSignal,blobHttpHeaders:e.blobHTTPHeaders,leaseAccessConditions:e.conditions,metadata:e.metadata,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions}),cpkInfo:e.customerProvidedKey,encryptionScope:e.encryptionScope,immutabilityPolicyExpiry:null===(i=e.immutabilityPolicy)||void 0===i?void 0:i.expiriesOn,immutabilityPolicyMode:null===(n=e.immutabilityPolicy)||void 0===n?void 0:n.policyMode,legalHold:e.legalHold,blobTagsString:FZ(e.tags)},Q$(s)))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async createIfNotExists(e={}){var t,i;const{span:n,updatedOptions:r}=J$("AppendBlobClient-createIfNotExists",e),s={ifNoneMatch:"*"};try{const e=await this.create(Object.assign(Object.assign({},r),{conditions:s}));return Object.assign(Object.assign({succeeded:!0},e),{_response:e._response})}catch(P0){if("BlobAlreadyExists"===(null===(t=P0.details)||void 0===t?void 0:t.errorCode))return n.setStatus({code:$F.ERROR,message:"Expected exception when creating a blob only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(i=P0.response)||void 0===i?void 0:i.parsedHeaders),{_response:P0.response});throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async seal(e={}){var t;const{span:i,updatedOptions:n}=J$("AppendBlobClient-seal",e);e.conditions=e.conditions||{};try{return await this.appendBlobContext.seal(Object.assign({abortSignal:e.abortSignal,appendPositionAccessConditions:e.conditions,leaseAccessConditions:e.conditions,modifiedAccessConditions:Object.assign(Object.assign({},e.conditions),{ifTags:null===(t=e.conditions)||void 0===t?void 0:t.tagConditions})},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async appendBlock(e,t,i={}){var n;const{span:r,updatedOptions:s}=J$("AppendBlobClient-appendBlock",i);i.conditions=i.conditions||{};try{return fK(i.customerProvidedKey,this.isHttps),await this.appendBlobContext.appendBlock(t,e,Object.assign({abortSignal:i.abortSignal,appendPositionAccessConditions:i.conditions,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions}),requestOptions:{onUploadProgress:i.onProgress},transactionalContentMD5:i.transactionalContentMD5,transactionalContentCrc64:i.transactionalContentCrc64,cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope},Q$(s)))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async appendBlockFromURL(e,t,i,n={}){var r;const{span:s,updatedOptions:o}=J$("AppendBlobClient-appendBlockFromURL",n);n.conditions=n.conditions||{},n.sourceConditions=n.sourceConditions||{};try{return fK(n.customerProvidedKey,this.isHttps),await this.appendBlobContext.appendBlockFromUrl(e,0,Object.assign({abortSignal:n.abortSignal,sourceRange:SK({offset:t,count:i}),sourceContentMD5:n.sourceContentMD5,sourceContentCrc64:n.sourceContentCrc64,leaseAccessConditions:n.conditions,appendPositionAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(r=n.conditions)||void 0===r?void 0:r.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:n.sourceConditions.ifMatch,sourceIfModifiedSince:n.sourceConditions.ifModifiedSince,sourceIfNoneMatch:n.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:n.sourceConditions.ifUnmodifiedSince},copySourceAuthorization:GZ(n.sourceAuthorization),cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}}class RK extends AK{constructor(e,t,i,n){let r,s;if(n=n||{},y$(t))s=e,r=t;else if($B&&t instanceof b$||t instanceof o$||XB(t))s=e,r=x$(t,n=i);else if(t||"string"==typeof t){if(!t||"string"!=typeof t||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");{const o=t,a=i,l=PZ(e);if("AccountConnString"===l.kind){if(!$B)throw new Error("Account connection string is only supported in Node.js environment");{const e=new b$(l.accountName,l.accountKey);s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a)),n.proxyOptions||(n.proxyOptions=void 0),r=x$(e,n)}}else{if("SASConnString"!==l.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a))+"?"+l.accountSas,r=x$(new o$,n)}}}else s=e,i&&"string"!=typeof i&&(n=i),r=x$(new o$,n);super(s,r),this.blockBlobContext=new HX(this.storageClientContext),this._blobContext=new cX(this.storageClientContext)}withSnapshot(e){return new RK(kZ(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}async query(e,t={}){var i;fK(t.customerProvidedKey,this.isHttps);const{span:n,updatedOptions:r}=J$("BlockBlobClient-query",t);try{if(!$B)throw new Error("This operation currently is only supported in Node.js.");fK(t.customerProvidedKey,this.isHttps);const s=await this._blobContext.query(Object.assign({abortSignal:t.abortSignal,queryRequest:{queryType:"SQL",expression:e,inputSerialization:UZ(t.inputTextConfiguration),outputSerialization:UZ(t.outputTextConfiguration)},leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:t.customerProvidedKey},Q$(r)));return new zX(s,{abortSignal:t.abortSignal,onProgress:t.onProgress,onError:t.onError})}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async upload(e,t,i={}){var n,r,s;i.conditions=i.conditions||{};const{span:o,updatedOptions:a}=J$("BlockBlobClient-upload",i);try{return fK(i.customerProvidedKey,this.isHttps),await this.blockBlobContext.upload(t,e,Object.assign({abortSignal:i.abortSignal,blobHttpHeaders:i.blobHTTPHeaders,leaseAccessConditions:i.conditions,metadata:i.metadata,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions}),requestOptions:{onUploadProgress:i.onProgress},cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope,immutabilityPolicyExpiry:null===(r=i.immutabilityPolicy)||void 0===r?void 0:r.expiriesOn,immutabilityPolicyMode:null===(s=i.immutabilityPolicy)||void 0===s?void 0:s.policyMode,legalHold:i.legalHold,tier:mK(i.tier),blobTagsString:FZ(i.tags)},Q$(a)))}catch(P0){throw o.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{o.end()}}async syncUploadFromURL(e,t={}){var i,n,r,s,o;t.conditions=t.conditions||{};const{span:a,updatedOptions:l}=J$("BlockBlobClient-syncUploadFromURL",t);try{return fK(t.customerProvidedKey,this.isHttps),await this.blockBlobContext.putBlobFromUrl(0,e,Object.assign(Object.assign(Object.assign({},t),{blobHttpHeaders:t.blobHTTPHeaders,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:t.conditions.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:null===(i=t.sourceConditions)||void 0===i?void 0:i.ifMatch,sourceIfModifiedSince:null===(n=t.sourceConditions)||void 0===n?void 0:n.ifModifiedSince,sourceIfNoneMatch:null===(r=t.sourceConditions)||void 0===r?void 0:r.ifNoneMatch,sourceIfUnmodifiedSince:null===(s=t.sourceConditions)||void 0===s?void 0:s.ifUnmodifiedSince,sourceIfTags:null===(o=t.sourceConditions)||void 0===o?void 0:o.tagConditions},cpkInfo:t.customerProvidedKey,copySourceAuthorization:GZ(t.sourceAuthorization),tier:mK(t.tier),blobTagsString:FZ(t.tags),copySourceTags:t.copySourceTags}),Q$(l)))}catch(P0){throw a.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{a.end()}}async stageBlock(e,t,i,n={}){const{span:r,updatedOptions:s}=J$("BlockBlobClient-stageBlock",n);try{return fK(n.customerProvidedKey,this.isHttps),await this.blockBlobContext.stageBlock(e,i,t,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,requestOptions:{onUploadProgress:n.onProgress},transactionalContentMD5:n.transactionalContentMD5,transactionalContentCrc64:n.transactionalContentCrc64,cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope},Q$(s)))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async stageBlockFromURL(e,t,i=0,n,r={}){const{span:s,updatedOptions:o}=J$("BlockBlobClient-stageBlockFromURL",r);try{return fK(r.customerProvidedKey,this.isHttps),await this.blockBlobContext.stageBlockFromURL(e,0,t,Object.assign({abortSignal:r.abortSignal,leaseAccessConditions:r.conditions,sourceContentMD5:r.sourceContentMD5,sourceContentCrc64:r.sourceContentCrc64,sourceRange:0!==i||n?SK({offset:i,count:n}):void 0,cpkInfo:r.customerProvidedKey,encryptionScope:r.encryptionScope,copySourceAuthorization:GZ(r.sourceAuthorization)},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async commitBlockList(e,t={}){var i,n,r;t.conditions=t.conditions||{};const{span:s,updatedOptions:o}=J$("BlockBlobClient-commitBlockList",t);try{return fK(t.customerProvidedKey,this.isHttps),await this.blockBlobContext.commitBlockList({latest:e},Object.assign({abortSignal:t.abortSignal,blobHttpHeaders:t.blobHTTPHeaders,leaseAccessConditions:t.conditions,metadata:t.metadata,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:t.customerProvidedKey,encryptionScope:t.encryptionScope,immutabilityPolicyExpiry:null===(n=t.immutabilityPolicy)||void 0===n?void 0:n.expiriesOn,immutabilityPolicyMode:null===(r=t.immutabilityPolicy)||void 0===r?void 0:r.policyMode,legalHold:t.legalHold,tier:mK(t.tier),blobTagsString:FZ(t.tags)},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async getBlockList(e,t={}){var i;const{span:n,updatedOptions:r}=J$("BlockBlobClient-getBlockList",t);try{const s=await this.blockBlobContext.getBlockList(e,Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions})},Q$(r)));return s.committedBlocks||(s.committedBlocks=[]),s.uncommittedBlocks||(s.uncommittedBlocks=[]),s}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async uploadData(e,t={}){const{span:i,updatedOptions:n}=J$("BlockBlobClient-uploadData",t);try{if($B){let t;return e instanceof Buffer?t=e:e instanceof ArrayBuffer?t=Buffer.from(e):(e=e,t=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),this.uploadSeekableInternal((e,i)=>t.slice(e,e+i),t.byteLength,n)}{const t=new Blob([e]);return this.uploadSeekableInternal((e,i)=>t.slice(e,e+i),t.size,n)}}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async uploadBrowserData(e,t={}){const{span:i,updatedOptions:n}=J$("BlockBlobClient-uploadBrowserData",t);try{const t=new Blob([e]);return await this.uploadSeekableInternal((e,i)=>t.slice(e,e+i),t.size,n)}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async uploadSeekableInternal(e,t,i={}){if(i.blockSize||(i.blockSize=0),i.blockSize<0||i.blockSize>4194304e3)throw new RangeError("blockSize option must be >= 0 and <= 4194304000");if(0===i.maxSingleShotSize||i.maxSingleShotSize||(i.maxSingleShotSize=268435456),i.maxSingleShotSize<0||i.maxSingleShotSize>268435456)throw new RangeError("maxSingleShotSize option must be >= 0 and <= 268435456");if(0===i.blockSize){if(t>2097152e8)throw new RangeError(t+" is too larger to upload to a block blob.");t>i.maxSingleShotSize&&(i.blockSize=Math.ceil(t/5e4),i.blockSize<4194304&&(i.blockSize=4194304))}i.blobHTTPHeaders||(i.blobHTTPHeaders={}),i.conditions||(i.conditions={});const{span:n,updatedOptions:r}=J$("BlockBlobClient-uploadSeekableInternal",i);try{if(t<=i.maxSingleShotSize)return await this.upload(e(0,t),t,r);const s=Math.floor((t-1)/i.blockSize)+1;if(s>5e4)throw new RangeError("The buffer's size is too big or the BlockSize is too small;the number of blocks must be <= 50000");const o=[],a=lj();let l=0;const c=new MK(i.concurrency);for(let n=0;n<s;n++)c.addOperation(async()=>{const c=DZ(a,n),h=i.blockSize*n,u=(n===s-1?t:h+i.blockSize)-h;o.push(c),await this.stageBlock(c,e(h,u),u,{abortSignal:i.abortSignal,conditions:i.conditions,encryptionScope:i.encryptionScope,tracingOptions:r.tracingOptions}),l+=u,i.onProgress&&i.onProgress({loadedBytes:l})});return await c.do(),this.commitBlockList(o,r)}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async uploadFile(e,t={}){const{span:i,updatedOptions:n}=J$("BlockBlobClient-uploadFile",t);try{const e=(await void 0).size;return await this.uploadSeekableInternal((e,t)=>()=>{},e,Object.assign(Object.assign({},t),{tracingOptions:Object.assign(Object.assign({},t.tracingOptions),Q$(n))}))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async uploadStream(e,t=8388608,i=5,n={}){n.blobHTTPHeaders||(n.blobHTTPHeaders={}),n.conditions||(n.conditions={});const{span:r,updatedOptions:s}=J$("BlockBlobClient-uploadStream",n);try{let o=0;const a=lj();let l=0;const c=[],h=new kK(e,t,i,async(e,t)=>{const i=DZ(a,o);c.push(i),o++,await this.stageBlock(i,e,t,{conditions:n.conditions,encryptionScope:n.encryptionScope,tracingOptions:s.tracingOptions}),l+=t,n.onProgress&&n.onProgress({loadedBytes:l})},Math.ceil(i/4*3));return await h.do(),await this.commitBlockList(c,Object.assign(Object.assign({},n),{tracingOptions:Object.assign(Object.assign({},n.tracingOptions),Q$(s))}))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}}class OK extends AK{constructor(e,t,i,n){let r,s;if(n=n||{},y$(t))s=e,r=t;else if($B&&t instanceof b$||t instanceof o$||XB(t))s=e,r=x$(t,n=i);else if(t||"string"==typeof t){if(!t||"string"!=typeof t||!i||"string"!=typeof i)throw new Error("Expecting non-empty strings for containerName and blobName parameters");{const o=t,a=i,l=PZ(e);if("AccountConnString"===l.kind){if(!$B)throw new Error("Account connection string is only supported in Node.js environment");{const e=new b$(l.accountName,l.accountKey);s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a)),n.proxyOptions||(n.proxyOptions=void 0),r=x$(e,n)}}else{if("SASConnString"!==l.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");s=MZ(MZ(l.url,encodeURIComponent(o)),encodeURIComponent(a))+"?"+l.accountSas,r=x$(new o$,n)}}}else s=e,r=x$(new o$,n);super(s,r),this.pageBlobContext=new QX(this.storageClientContext)}withSnapshot(e){return new OK(kZ(this.url,"snapshot",0===e.length?void 0:e),this.pipeline)}async create(e,t={}){var i,n,r;t.conditions=t.conditions||{};const{span:s,updatedOptions:o}=J$("PageBlobClient-create",t);try{return fK(t.customerProvidedKey,this.isHttps),await this.pageBlobContext.create(0,e,Object.assign({abortSignal:t.abortSignal,blobHttpHeaders:t.blobHTTPHeaders,blobSequenceNumber:t.blobSequenceNumber,leaseAccessConditions:t.conditions,metadata:t.metadata,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),cpkInfo:t.customerProvidedKey,encryptionScope:t.encryptionScope,immutabilityPolicyExpiry:null===(n=t.immutabilityPolicy)||void 0===n?void 0:n.expiriesOn,immutabilityPolicyMode:null===(r=t.immutabilityPolicy)||void 0===r?void 0:r.policyMode,legalHold:t.legalHold,tier:mK(t.tier),blobTagsString:FZ(t.tags)},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async createIfNotExists(e,t={}){var i,n;const{span:r,updatedOptions:s}=J$("PageBlobClient-createIfNotExists",t);try{const i={ifNoneMatch:"*"},n=await this.create(e,Object.assign(Object.assign({},t),{conditions:i,tracingOptions:s.tracingOptions}));return Object.assign(Object.assign({succeeded:!0},n),{_response:n._response})}catch(P0){if("BlobAlreadyExists"===(null===(i=P0.details)||void 0===i?void 0:i.errorCode))return r.setStatus({code:$F.ERROR,message:"Expected exception when creating a blob only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(n=P0.response)||void 0===n?void 0:n.parsedHeaders),{_response:P0.response});throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async uploadPages(e,t,i,n={}){var r;n.conditions=n.conditions||{};const{span:s,updatedOptions:o}=J$("PageBlobClient-uploadPages",n);try{return fK(n.customerProvidedKey,this.isHttps),await this.pageBlobContext.uploadPages(i,e,Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(r=n.conditions)||void 0===r?void 0:r.tagConditions}),requestOptions:{onUploadProgress:n.onProgress},range:SK({offset:t,count:i}),sequenceNumberAccessConditions:n.conditions,transactionalContentMD5:n.transactionalContentMD5,transactionalContentCrc64:n.transactionalContentCrc64,cpkInfo:n.customerProvidedKey,encryptionScope:n.encryptionScope},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async uploadPagesFromURL(e,t,i,n,r={}){var s;r.conditions=r.conditions||{},r.sourceConditions=r.sourceConditions||{};const{span:o,updatedOptions:a}=J$("PageBlobClient-uploadPagesFromURL",r);try{return fK(r.customerProvidedKey,this.isHttps),await this.pageBlobContext.uploadPagesFromURL(e,SK({offset:t,count:n}),0,SK({offset:i,count:n}),Object.assign({abortSignal:r.abortSignal,sourceContentMD5:r.sourceContentMD5,sourceContentCrc64:r.sourceContentCrc64,leaseAccessConditions:r.conditions,sequenceNumberAccessConditions:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},r.conditions),{ifTags:null===(s=r.conditions)||void 0===s?void 0:s.tagConditions}),sourceModifiedAccessConditions:{sourceIfMatch:r.sourceConditions.ifMatch,sourceIfModifiedSince:r.sourceConditions.ifModifiedSince,sourceIfNoneMatch:r.sourceConditions.ifNoneMatch,sourceIfUnmodifiedSince:r.sourceConditions.ifUnmodifiedSince},cpkInfo:r.customerProvidedKey,encryptionScope:r.encryptionScope,copySourceAuthorization:GZ(r.sourceAuthorization)},Q$(a)))}catch(P0){throw o.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{o.end()}}async clearPages(e=0,t,i={}){var n;i.conditions=i.conditions||{};const{span:r,updatedOptions:s}=J$("PageBlobClient-clearPages",i);try{return await this.pageBlobContext.clearPages(0,Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions}),range:SK({offset:e,count:t}),sequenceNumberAccessConditions:i.conditions,cpkInfo:i.customerProvidedKey,encryptionScope:i.encryptionScope},Q$(s)))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async getPageRanges(e=0,t,i={}){var n;i.conditions=i.conditions||{};const{span:r,updatedOptions:s}=J$("PageBlobClient-getPageRanges",i);try{return await this.pageBlobContext.getPageRanges(Object.assign({abortSignal:i.abortSignal,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions}),range:SK({offset:e,count:t})},Q$(s))).then(gK)}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async listPageRangesSegment(e=0,t,i,n={}){var r;const{span:s,updatedOptions:o}=J$("PageBlobClient-getPageRangesSegment",n);try{return await this.pageBlobContext.getPageRanges(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(r=n.conditions)||void 0===r?void 0:r.tagConditions}),range:SK({offset:e,count:t}),marker:i,maxPageSize:n.maxPageSize},Q$(o)))}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}listPageRangeItemSegments(e=0,t,i,n={}){return VB(this,arguments,(function*(){let r;if(i||void 0===i)do{r=yield jB(this.listPageRangesSegment(e,t,i,n)),i=r.continuationToken,yield yield jB(yield jB(r))}while(i)}))}listPageRangeItems(e=0,t,i={}){return VB(this,arguments,(function*(){var n,r;try{for(var s,o=qB(this.listPageRangeItemSegments(e,t,void 0,i));!(s=yield jB(o.next())).done;){const e=s.value;yield jB(yield*UB(qB($Z(e))))}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=o.return)&&(yield jB(r.call(o)))}finally{if(n)throw n.error}}}))}listPageRanges(e=0,t,i={}){i.conditions=i.conditions||{};const n=this.listPageRangeItems(e,t,i);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(n={})=>this.listPageRangeItemSegments(e,t,n.continuationToken,Object.assign({maxPageSize:n.maxPageSize},i))}}async getPageRangesDiff(e,t,i,n={}){var r;n.conditions=n.conditions||{};const{span:s,updatedOptions:o}=J$("PageBlobClient-getPageRangesDiff",n);try{return await this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(r=n.conditions)||void 0===r?void 0:r.tagConditions}),prevsnapshot:i,range:SK({offset:e,count:t})},Q$(o))).then(gK)}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async listPageRangesDiffSegment(e,t,i,n,r){var s;const{span:o,updatedOptions:a}=J$("PageBlobClient-getPageRangesDiffSegment",r);try{return await this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:null==r?void 0:r.abortSignal,leaseAccessConditions:null==r?void 0:r.conditions,modifiedAccessConditions:Object.assign(Object.assign({},null==r?void 0:r.conditions),{ifTags:null===(s=null==r?void 0:r.conditions)||void 0===s?void 0:s.tagConditions}),prevsnapshot:i,range:SK({offset:e,count:t}),marker:n,maxPageSize:null==r?void 0:r.maxPageSize},Q$(a)))}catch(P0){throw o.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{o.end()}}listPageRangeDiffItemSegments(e,t,i,n,r){return VB(this,arguments,(function*(){let s;if(n||void 0===n)do{s=yield jB(this.listPageRangesDiffSegment(e,t,i,n,r)),n=s.continuationToken,yield yield jB(yield jB(s))}while(n)}))}listPageRangeDiffItems(e,t,i,n){return VB(this,arguments,(function*(){var r,s;try{for(var o,a=qB(this.listPageRangeDiffItemSegments(e,t,i,void 0,n));!(o=yield jB(a.next())).done;){const e=o.value;yield jB(yield*UB(qB($Z(e))))}}catch(l){r={error:l}}finally{try{o&&!o.done&&(s=a.return)&&(yield jB(s.call(a)))}finally{if(r)throw r.error}}}))}listPageRangesDiff(e,t,i,n={}){n.conditions=n.conditions||{};const r=this.listPageRangeDiffItems(e,t,i,Object.assign({},n));return{next:()=>r.next(),[Symbol.asyncIterator](){return this},byPage:(r={})=>this.listPageRangeDiffItemSegments(e,t,i,r.continuationToken,Object.assign({maxPageSize:r.maxPageSize},n))}}async getPageRangesDiffForManagedDisks(e,t,i,n={}){var r;n.conditions=n.conditions||{};const{span:s,updatedOptions:o}=J$("PageBlobClient-GetPageRangesDiffForManagedDisks",n);try{return await this.pageBlobContext.getPageRangesDiff(Object.assign({abortSignal:n.abortSignal,leaseAccessConditions:n.conditions,modifiedAccessConditions:Object.assign(Object.assign({},n.conditions),{ifTags:null===(r=n.conditions)||void 0===r?void 0:r.tagConditions}),prevSnapshotUrl:i,range:SK({offset:e,count:t})},Q$(o))).then(gK)}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async resize(e,t={}){var i;t.conditions=t.conditions||{};const{span:n,updatedOptions:r}=J$("PageBlobClient-resize",t);try{return await this.pageBlobContext.resize(e,Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions}),encryptionScope:t.encryptionScope},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async updateSequenceNumber(e,t,i={}){var n;i.conditions=i.conditions||{};const{span:r,updatedOptions:s}=J$("PageBlobClient-updateSequenceNumber",i);try{return await this.pageBlobContext.updateSequenceNumber(e,Object.assign({abortSignal:i.abortSignal,blobSequenceNumber:t,leaseAccessConditions:i.conditions,modifiedAccessConditions:Object.assign(Object.assign({},i.conditions),{ifTags:null===(n=i.conditions)||void 0===n?void 0:n.tagConditions})},Q$(s)))}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async startCopyIncremental(e,t={}){var i;const{span:n,updatedOptions:r}=J$("PageBlobClient-startCopyIncremental",t);try{return await this.pageBlobContext.copyIncremental(e,Object.assign({abortSignal:t.abortSignal,modifiedAccessConditions:Object.assign(Object.assign({},t.conditions),{ifTags:null===(i=t.conditions)||void 0===i?void 0:i.tagConditions})},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}}class NK{constructor(e,t){if(!e||!e.contentType)throw new RangeError("batchResponse is malformed or doesn't contain valid content-type.");if(!t||0===t.size)throw new RangeError("Invalid state: subRequests is not provided or size is 0.");this.batchResponse=e,this.subRequests=t,this.responseBatchBoundary=this.batchResponse.contentType.split("=")[1],this.perResponsePrefix=`--${this.responseBatchBoundary}\r\n`,this.batchResponseEnding=`--${this.responseBatchBoundary}--`}async parseBatchResponse(){if(202!==this.batchResponse._response.status)throw new Error(`Invalid state: batch request failed with status: '${this.batchResponse._response.status}'.`);const e=(await async function(e){return async function(e){const t=new FileReader;return new Promise((i,n)=>{t.onloadend=e=>{i(e.target.result)},t.onerror=n,t.readAsText(e)})}(await e.blobBody)}(this.batchResponse)).split(this.batchResponseEnding)[0].split(this.perResponsePrefix).slice(1),t=e.length;if(t!==this.subRequests.size&&1!==t)throw new Error("Invalid state: sub responses' count is not equal to sub requests' count.");const i=new Array(t);let n=0,r=0;for(let s=0;s<t;s++){const t=e[s],o={};o.headers=new EZ;const a=t.split("\r\n");let l=!1,c=!1,h=!1,u=-1;for(const e of a)if(l)if(""!==e.trim())if(c)o.bodyAsText||(o.bodyAsText=""),o.bodyAsText+=e;else{if(-1===e.indexOf(": "))throw new Error(`Invalid state: find non-empty line '${e}' without HTTP header delimiter ': '.`);const t=e.split(": ");o.headers.set(t[0],t[1]),"x-ms-error-code"===t[0]&&(o.errorCode=t[1],h=!0)}else c||(c=!0);else if(e.startsWith("Content-ID")&&(u=parseInt(e.split(": ")[1])),e.startsWith("HTTP/1.1")){l=!0;const t=e.split(" ");o.status=parseInt(t[1]),o.statusMessage=t.slice(2).join(" ")}-1!==u&&Number.isInteger(u)&&u>=0&&u<this.subRequests.size&&void 0===i[u]?(o._request=this.subRequests.get(u),i[u]=o):vZ.error(`subResponses[${s}] is dropped as the Content-ID is not found or invalid, Content-ID: ${u}`),h?r++:n++}return{subResponses:i,subResponsesSucceededCount:n,subResponsesFailedCount:r}}}!function(e){e[e.LOCKED=0]="LOCKED",e[e.UNLOCKED=1]="UNLOCKED"}(TK||(TK={}));class DK{static async lock(e){return new Promise(t=>{void 0===this.keys[e]||this.keys[e]===TK.UNLOCKED?(this.keys[e]=TK.LOCKED,t()):this.onUnlockEvent(e,()=>{this.keys[e]=TK.LOCKED,t()})})}static async unlock(e){return new Promise(t=>{this.keys[e]===TK.LOCKED&&this.emitUnlockEvent(e),delete this.keys[e],t()})}static onUnlockEvent(e,t){void 0===this.listeners[e]?this.listeners[e]=[t]:this.listeners[e].push(t)}static emitUnlockEvent(e){if(void 0!==this.listeners[e]&&this.listeners[e].length>0){const t=this.listeners[e].shift();setImmediate(()=>{t.call(this)})}}}DK.keys={},DK.listeners={};class zK{constructor(){this.batch="batch",this.batchRequest=new LK}getMultiPartContentType(){return this.batchRequest.getMultipartContentType()}getHttpRequestBody(){return this.batchRequest.getHttpRequestBody()}getSubRequests(){return this.batchRequest.getSubRequests()}async addSubRequestInternal(e,t){await DK.lock(this.batch);try{this.batchRequest.preAddSubRequest(e),await t(),this.batchRequest.postAddSubRequest(e)}finally{await DK.unlock(this.batch)}}setBatchType(e){if(this.batchType||(this.batchType=e),this.batchType!==e)throw new RangeError(`BlobBatch only supports one operation type per batch and it already is being used for ${this.batchType} operations.`)}async deleteBlob(e,t,i){let n,r;if("string"==typeof e&&($B&&t instanceof b$||t instanceof o$||XB(t)))n=e,r=t;else{if(!(e instanceof AK))throw new RangeError("Invalid arguments. Either url and credential, or BlobClient need be provided.");n=e.url,r=e.credential,i=t}i||(i={});const{span:s,updatedOptions:o}=J$("BatchDeleteRequest-addSubRequest",i);try{this.setBatchType("delete"),await this.addSubRequestInternal({url:n,credential:r},async()=>{await new AK(n,this.batchRequest.createPipeline(r)).delete(o)})}catch(P0){throw s.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{s.end()}}async setBlobAccessTier(e,t,i,n){let r,s,o;if("string"==typeof e&&($B&&t instanceof b$||t instanceof o$||XB(t)))r=e,s=t,o=i;else{if(!(e instanceof AK))throw new RangeError("Invalid arguments. Either url and credential, or BlobClient need be provided.");r=e.url,s=e.credential,o=t,n=i}n||(n={});const{span:a,updatedOptions:l}=J$("BatchSetTierRequest-addSubRequest",n);try{this.setBatchType("setAccessTier"),await this.addSubRequestInternal({url:r,credential:s},async()=>{await new AK(r,this.batchRequest.createPipeline(s)).setAccessTier(o,l)})}catch(P0){throw a.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{a.end()}}}class LK{constructor(){this.operationCount=0,this.body="";const e=lj();this.boundary="batch_"+e,this.subRequestPrefix=`--${this.boundary}\r\nContent-Type: application/http\r\nContent-Transfer-Encoding: binary`,this.multipartContentType="multipart/mixed; boundary="+this.boundary,this.batchRequestEnding=`--${this.boundary}--`,this.subRequests=new Map}createPipeline(e){const t=e instanceof o$,i=3+(t?0:1),n=new Array(i);return n[0]=pZ(),n[1]=new VK,t||(n[2]=XB(e)?HZ(L$(e,"https://storage.azure.com/.default"),e):e),n[i-1]=new FK(this),new v$(n,{})}appendSubRequestToBody(e){this.body+=[this.subRequestPrefix,"Content-ID: "+this.operationCount,"",`${e.method.toString()} ${RZ(e.url)} HTTP/1.1\r\n`].join("\r\n");for(const t of e.headers.headersArray())this.body+=`${t.name}: ${t.value}\r\n`;this.body+="\r\n"}preAddSubRequest(e){if(this.operationCount>=256)throw new RangeError("Cannot exceed 256 sub requests in a single batch");const t=IZ(e.url);if(!t||""===t)throw new RangeError(`Invalid url for sub request: '${e.url}'`)}postAddSubRequest(e){this.subRequests.set(this.operationCount,e),this.operationCount++}getHttpRequestBody(){return`${this.body}${this.batchRequestEnding}\r\n`}getMultipartContentType(){return this.multipartContentType}getSubRequests(){return this.subRequests}}class BK extends YB{constructor(e,t,i){super(t,i),this.dummyResponse={request:new R$,status:200,headers:new EZ},this.batchRequest=e}async sendRequest(e){return await this.batchRequest.appendSubRequestToBody(e),this.dummyResponse}}class FK{constructor(e){this.batchRequest=e}create(e,t){return new BK(this.batchRequest,e,t)}}class jK extends YB{constructor(e,t){super(e,t)}async sendRequest(e){let t="";for(const i of e.headers.headersArray())zZ(i.name,"x-ms-version")&&(t=i.name);return""!==t&&e.headers.remove(t),this._nextPolicy.sendRequest(e)}}class VK{create(e,t){return new jK(e,t)}}class UK{constructor(e,t,i){let n;n=y$(t)?t:x$(t||new o$,i);const r=new K$(e,n.toServiceClientOptions()),s=IZ(e);this.serviceOrContainerContext=s&&"/"!==s?new HG(r):new NG(r)}createBatch(){return new zK}async deleteBlobs(e,t,i){const n=new zK;for(const r of e)"string"==typeof r?await n.deleteBlob(r,t,i):await n.deleteBlob(r,t);return this.submitBatch(n)}async setBlobsAccessTier(e,t,i,n){const r=new zK;for(const s of e)"string"==typeof s?await r.setBlobAccessTier(s,t,i,n):await r.setBlobAccessTier(s,t,i);return this.submitBatch(r)}async submitBatch(e,t={}){if(!e||0===e.getSubRequests().size)throw new RangeError("Batch request should contain one or more sub requests.");const{span:i,updatedOptions:n}=J$("BlobBatchClient-submitBatch",t);try{const s=e.getHttpRequestBody(),o=await this.serviceOrContainerContext.submitBatch((r=s,new Blob([r]).size),e.getMultiPartContentType(),s,Object.assign(Object.assign({},t),Q$(n))),a=new NK(o,e.getSubRequests()),l=await a.parseBatchResponse();return{_response:o._response,contentType:o.contentType,errorCode:o.errorCode,requestId:o.requestId,clientRequestId:o.clientRequestId,version:o.version,subResponses:l.subResponses,subResponsesSucceededCount:l.subResponsesSucceededCount,subResponsesFailedCount:l.subResponsesFailedCount}}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}var r}}class qK extends Y${constructor(e,t,i){let n,r;if(i=i||{},y$(t))r=e,n=t;else if($B&&t instanceof b$||t instanceof o$||XB(t))r=e,n=x$(t,i);else if(t||"string"==typeof t){if(!t||"string"!=typeof t)throw new Error("Expecting non-empty strings for containerName parameter");{const s=t,o=PZ(e);if("AccountConnString"===o.kind){if(!$B)throw new Error("Account connection string is only supported in Node.js environment");{const e=new b$(o.accountName,o.accountKey);r=MZ(o.url,encodeURIComponent(s)),i.proxyOptions||(i.proxyOptions=void 0),n=x$(e,i)}}else{if("SASConnString"!==o.kind)throw new Error("Connection string must be either an Account connection string or a SAS connection string");r=MZ(o.url,encodeURIComponent(s))+"?"+o.accountSas,n=x$(new o$,i)}}}else r=e,n=x$(new o$,i);super(r,n),this._containerName=this.getContainerNameFromUrl(),this.containerContext=new HG(this.storageClientContext)}get containerName(){return this._containerName}async create(e={}){const{span:t,updatedOptions:i}=J$("ContainerClient-create",e);try{return await this.containerContext.create(Object.assign(Object.assign({},e),Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async createIfNotExists(e={}){var t,i;const{span:n,updatedOptions:r}=J$("ContainerClient-createIfNotExists",e);try{const e=await this.create(r);return Object.assign(Object.assign({succeeded:!0},e),{_response:e._response})}catch(P0){if("ContainerAlreadyExists"===(null===(t=P0.details)||void 0===t?void 0:t.errorCode))return n.setStatus({code:$F.ERROR,message:"Expected exception when creating a container only if it does not already exist."}),Object.assign(Object.assign({succeeded:!1},null===(i=P0.response)||void 0===i?void 0:i.parsedHeaders),{_response:P0.response});throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async exists(e={}){const{span:t,updatedOptions:i}=J$("ContainerClient-exists",e);try{return await this.getProperties({abortSignal:e.abortSignal,tracingOptions:i.tracingOptions}),!0}catch(P0){if(404===P0.statusCode)return t.setStatus({code:$F.ERROR,message:"Expected exception when checking container existence"}),!1;throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}getBlobClient(e){return new AK(MZ(this.url,XZ(e)),this.pipeline)}getAppendBlobClient(e){return new IK(MZ(this.url,XZ(e)),this.pipeline)}getBlockBlobClient(e){return new RK(MZ(this.url,XZ(e)),this.pipeline)}getPageBlobClient(e){return new OK(MZ(this.url,XZ(e)),this.pipeline)}async getProperties(e={}){e.conditions||(e.conditions={});const{span:t,updatedOptions:i}=J$("ContainerClient-getProperties",e);try{return await this.containerContext.getProperties(Object.assign(Object.assign({abortSignal:e.abortSignal},e.conditions),Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async delete(e={}){e.conditions||(e.conditions={});const{span:t,updatedOptions:i}=J$("ContainerClient-delete",e);try{return await this.containerContext.delete(Object.assign({abortSignal:e.abortSignal,leaseAccessConditions:e.conditions,modifiedAccessConditions:e.conditions},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async deleteIfExists(e={}){var t,i;const{span:n,updatedOptions:r}=J$("ContainerClient-deleteIfExists",e);try{const e=await this.delete(r);return Object.assign(Object.assign({succeeded:!0},e),{_response:e._response})}catch(P0){if("ContainerNotFound"===(null===(t=P0.details)||void 0===t?void 0:t.errorCode))return n.setStatus({code:$F.ERROR,message:"Expected exception when deleting a container only if it exists."}),Object.assign(Object.assign({succeeded:!1},null===(i=P0.response)||void 0===i?void 0:i.parsedHeaders),{_response:P0.response});throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async setMetadata(e,t={}){if(t.conditions||(t.conditions={}),t.conditions.ifUnmodifiedSince)throw new RangeError("the IfUnmodifiedSince must have their default values because they are ignored by the blob service");const{span:i,updatedOptions:n}=J$("ContainerClient-setMetadata",t);try{return await this.containerContext.setMetadata(Object.assign({abortSignal:t.abortSignal,leaseAccessConditions:t.conditions,metadata:e,modifiedAccessConditions:t.conditions},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async getAccessPolicy(e={}){e.conditions||(e.conditions={});const{span:t,updatedOptions:i}=J$("ContainerClient-getAccessPolicy",e);try{const n=await this.containerContext.getAccessPolicy(Object.assign({abortSignal:e.abortSignal,leaseAccessConditions:e.conditions},Q$(i))),r={_response:n._response,blobPublicAccess:n.blobPublicAccess,date:n.date,etag:n.etag,errorCode:n.errorCode,lastModified:n.lastModified,requestId:n.requestId,clientRequestId:n.clientRequestId,signedIdentifiers:[],version:n.version};for(const e of n){let t=void 0;e.accessPolicy&&(t={permissions:e.accessPolicy.permissions},e.accessPolicy.expiresOn&&(t.expiresOn=new Date(e.accessPolicy.expiresOn)),e.accessPolicy.startsOn&&(t.startsOn=new Date(e.accessPolicy.startsOn))),r.signedIdentifiers.push({accessPolicy:t,id:e.id})}return r}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async setAccessPolicy(e,t,i={}){i.conditions=i.conditions||{};const{span:n,updatedOptions:r}=J$("ContainerClient-setAccessPolicy",i);try{const s=[];for(const e of t||[])s.push({accessPolicy:{expiresOn:e.accessPolicy.expiresOn?NZ(e.accessPolicy.expiresOn):"",permissions:e.accessPolicy.permissions,startsOn:e.accessPolicy.startsOn?NZ(e.accessPolicy.startsOn):""},id:e.id});return await this.containerContext.setAccessPolicy(Object.assign({abortSignal:i.abortSignal,access:e,containerAcl:s,leaseAccessConditions:i.conditions,modifiedAccessConditions:i.conditions},Q$(r)))}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}getBlobLeaseClient(e){return new DX(this,e)}async uploadBlockBlob(e,t,i,n={}){const{span:r,updatedOptions:s}=J$("ContainerClient-uploadBlockBlob",n);try{const n=this.getBlockBlobClient(e),o=await n.upload(t,i,s);return{blockBlobClient:n,response:o}}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async deleteBlob(e,t={}){const{span:i,updatedOptions:n}=J$("ContainerClient-deleteBlob",t);try{let r=this.getBlobClient(e);return t.versionId&&(r=r.withVersion(t.versionId)),await r.delete(n)}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async listBlobFlatSegment(e,t={}){const{span:i,updatedOptions:n}=J$("ContainerClient-listBlobFlatSegment",t);try{const s=await this.containerContext.listBlobFlatSegment(Object.assign(Object.assign({marker:e},t),Q$(n)));return Object.assign(Object.assign({},s),{_response:Object.assign(Object.assign({},s._response),{parsedBody:(r=s._response.parsedBody,Object.assign(Object.assign({},r),{segment:{blobItems:r.segment.blobItems.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name)}))}}))}),segment:Object.assign(Object.assign({},s.segment),{blobItems:s.segment.blobItems.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name),tags:VZ(e.blobTags),objectReplicationSourceProperties:qZ(e.objectReplicationMetadata)}))})})}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}var r}async listBlobHierarchySegment(e,t,i={}){var n;const{span:r,updatedOptions:s}=J$("ContainerClient-listBlobHierarchySegment",i);try{const o=await this.containerContext.listBlobHierarchySegment(e,Object.assign(Object.assign({marker:t},i),Q$(s)));return Object.assign(Object.assign({},o),{_response:Object.assign(Object.assign({},o._response),{parsedBody:ZZ(o._response.parsedBody)}),segment:Object.assign(Object.assign({},o.segment),{blobItems:o.segment.blobItems.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name),tags:VZ(e.blobTags),objectReplicationSourceProperties:qZ(e.objectReplicationMetadata)})),blobPrefixes:null===(n=o.segment.blobPrefixes)||void 0===n?void 0:n.map(e=>Object.assign(Object.assign({},e),{name:WZ(e.name)}))})})}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}listSegments(e,t={}){return VB(this,arguments,(function*(){let i;if(e||void 0===e)do{i=yield jB(this.listBlobFlatSegment(e,t)),e=i.continuationToken,yield yield jB(yield jB(i))}while(e)}))}listItems(e={}){return VB(this,arguments,(function*(){var t,i;try{for(var n,r=qB(this.listSegments(void 0,e));!(n=yield jB(r.next())).done;){const e=n.value;yield jB(yield*UB(qB(e.segment.blobItems)))}}catch(s){t={error:s}}finally{try{n&&!n.done&&(i=r.return)&&(yield jB(i.call(r)))}finally{if(t)throw t.error}}}))}listBlobsFlat(e={}){const t=[];e.includeCopy&&t.push("copy"),e.includeDeleted&&t.push("deleted"),e.includeMetadata&&t.push("metadata"),e.includeSnapshots&&t.push("snapshots"),e.includeVersions&&t.push("versions"),e.includeUncommitedBlobs&&t.push("uncommittedblobs"),e.includeTags&&t.push("tags"),e.includeDeletedWithVersions&&t.push("deletedwithversions"),e.includeImmutabilityPolicy&&t.push("immutabilitypolicy"),e.includeLegalHold&&t.push("legalhold"),""===e.prefix&&(e.prefix=void 0);const i=Object.assign(Object.assign({},e),t.length>0?{include:t}:{}),n=this.listItems(i);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listSegments(e.continuationToken,Object.assign({maxPageSize:e.maxPageSize},i))}}listHierarchySegments(e,t,i={}){return VB(this,arguments,(function*(){let n;if(t||void 0===t)do{n=yield jB(this.listBlobHierarchySegment(e,t,i)),t=n.continuationToken,yield yield jB(yield jB(n))}while(t)}))}listItemsByHierarchy(e,t={}){return VB(this,arguments,(function*(){var i,n;try{for(var r,s=qB(this.listHierarchySegments(e,void 0,t));!(r=yield jB(s.next())).done;){const e=r.value.segment;if(e.blobPrefixes)for(const t of e.blobPrefixes)yield yield jB(Object.assign({kind:"prefix"},t));for(const t of e.blobItems)yield yield jB(Object.assign({kind:"blob"},t))}}catch(o){i={error:o}}finally{try{r&&!r.done&&(n=s.return)&&(yield jB(n.call(s)))}finally{if(i)throw i.error}}}))}listBlobsByHierarchy(e,t={}){if(""===e)throw new RangeError("delimiter should contain one or more characters");const i=[];t.includeCopy&&i.push("copy"),t.includeDeleted&&i.push("deleted"),t.includeMetadata&&i.push("metadata"),t.includeSnapshots&&i.push("snapshots"),t.includeVersions&&i.push("versions"),t.includeUncommitedBlobs&&i.push("uncommittedblobs"),t.includeTags&&i.push("tags"),t.includeDeletedWithVersions&&i.push("deletedwithversions"),t.includeImmutabilityPolicy&&i.push("immutabilitypolicy"),t.includeLegalHold&&i.push("legalhold"),""===t.prefix&&(t.prefix=void 0);const n=Object.assign(Object.assign({},t),i.length>0?{include:i}:{}),r=this.listItemsByHierarchy(e,n);return{next:async()=>r.next(),[Symbol.asyncIterator](){return this},byPage:(t={})=>this.listHierarchySegments(e,t.continuationToken,Object.assign({maxPageSize:t.maxPageSize},n))}}async findBlobsByTagsSegment(e,t,i={}){const{span:n,updatedOptions:r}=J$("ContainerClient-findBlobsByTagsSegment",i);try{const s=await this.containerContext.filterBlobs(Object.assign({abortSignal:i.abortSignal,where:e,marker:t,maxPageSize:i.maxPageSize},Q$(r)));return Object.assign(Object.assign({},s),{_response:s._response,blobs:s.blobs.map(e=>{var t;let i="";return 1===(null===(t=e.tags)||void 0===t?void 0:t.blobTagSet.length)&&(i=e.tags.blobTagSet[0].value),Object.assign(Object.assign({},e),{tags:VZ(e.tags),tagValue:i})})})}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}findBlobsByTagsSegments(e,t,i={}){return VB(this,arguments,(function*(){let n;if(t||void 0===t)do{n=yield jB(this.findBlobsByTagsSegment(e,t,i)),n.blobs=n.blobs||[],t=n.continuationToken,yield yield jB(n)}while(t)}))}findBlobsByTagsItems(e,t={}){return VB(this,arguments,(function*(){var i,n;try{for(var r,s=qB(this.findBlobsByTagsSegments(e,void 0,t));!(r=yield jB(s.next())).done;){const e=r.value;yield jB(yield*UB(qB(e.blobs)))}}catch(o){i={error:o}}finally{try{r&&!r.done&&(n=s.return)&&(yield jB(n.call(s)))}finally{if(i)throw i.error}}}))}findBlobsByTags(e,t={}){const i=Object.assign({},t),n=this.findBlobsByTagsItems(e,i);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(t={})=>this.findBlobsByTagsSegments(e,t.continuationToken,Object.assign({maxPageSize:t.maxPageSize},i))}}getContainerNameFromUrl(){let e;try{const t=qW.parse(this.url);if(e="blob"===t.getHost().split(".")[1]?t.getPath().split("/")[1]:BZ(t)?t.getPath().split("/")[2]:t.getPath().split("/")[1],e=decodeURIComponent(e),!e)throw new Error("Provided containerName is invalid.");return e}catch(t){throw new Error("Unable to extract containerName with provided information.")}}generateSasUrl(e){return new Promise(t=>{if(!(this.credential instanceof b$))throw new RangeError("Can only generate the SAS when the client is initialized with a shared key credential");const i=oX(Object.assign({containerName:this._containerName},e),this.credential).toString();t(OZ(this.url,i))})}getBlobBatchClient(){return new UK(this.url,this.pipeline)}}"function"==typeof SuppressedError&&SuppressedError;class HK{constructor(){this.read=!1,this.write=!1,this.delete=!1,this.deleteVersion=!1,this.list=!1,this.add=!1,this.create=!1,this.update=!1,this.process=!1,this.tag=!1,this.filter=!1,this.setImmutabilityPolicy=!1,this.permanentDelete=!1}static parse(e){const t=new HK;for(const i of e)switch(i){case"r":t.read=!0;break;case"w":t.write=!0;break;case"d":t.delete=!0;break;case"x":t.deleteVersion=!0;break;case"l":t.list=!0;break;case"a":t.add=!0;break;case"c":t.create=!0;break;case"u":t.update=!0;break;case"p":t.process=!0;break;case"t":t.tag=!0;break;case"f":t.filter=!0;break;case"i":t.setImmutabilityPolicy=!0;break;case"y":t.permanentDelete=!0;break;default:throw new RangeError("Invalid permission character: "+i)}return t}static from(e){const t=new HK;return e.read&&(t.read=!0),e.write&&(t.write=!0),e.delete&&(t.delete=!0),e.deleteVersion&&(t.deleteVersion=!0),e.filter&&(t.filter=!0),e.tag&&(t.tag=!0),e.list&&(t.list=!0),e.add&&(t.add=!0),e.create&&(t.create=!0),e.update&&(t.update=!0),e.process&&(t.process=!0),e.setImmutabilityPolicy&&(t.setImmutabilityPolicy=!0),e.permanentDelete&&(t.permanentDelete=!0),t}toString(){const e=[];return this.read&&e.push("r"),this.write&&e.push("w"),this.delete&&e.push("d"),this.deleteVersion&&e.push("x"),this.filter&&e.push("f"),this.tag&&e.push("t"),this.list&&e.push("l"),this.add&&e.push("a"),this.create&&e.push("c"),this.update&&e.push("u"),this.process&&e.push("p"),this.setImmutabilityPolicy&&e.push("i"),this.permanentDelete&&e.push("y"),e.join("")}}class GK{constructor(){this.service=!1,this.container=!1,this.object=!1}static parse(e){const t=new GK;for(const i of e)switch(i){case"s":t.service=!0;break;case"c":t.container=!0;break;case"o":t.object=!0;break;default:throw new RangeError("Invalid resource type: "+i)}return t}toString(){const e=[];return this.service&&e.push("s"),this.container&&e.push("c"),this.object&&e.push("o"),e.join("")}}class WK{constructor(){this.blob=!1,this.file=!1,this.queue=!1,this.table=!1}static parse(e){const t=new WK;for(const i of e)switch(i){case"b":t.blob=!0;break;case"f":t.file=!0;break;case"q":t.queue=!0;break;case"t":t.table=!0;break;default:throw new RangeError("Invalid service character: "+i)}return t}toString(){const e=[];return this.blob&&e.push("b"),this.table&&e.push("t"),this.queue&&e.push("q"),this.file&&e.push("f"),e.join("")}}class ZK extends Y${constructor(e,t,i){let n;n=y$(t)?t:$B&&t instanceof b$||t instanceof o$||XB(t)?x$(t,i):x$(new o$,i),super(e,n),this.serviceContext=new NG(this.storageClientContext)}static fromConnectionString(e,t){t=t||{};const i=PZ(e);if("AccountConnString"===i.kind){if($B){const e=new b$(i.accountName,i.accountKey);t.proxyOptions||(t.proxyOptions=void 0);const n=x$(e,t);return new ZK(i.url,n)}throw new Error("Account connection string is only supported in Node.js environment")}if("SASConnString"===i.kind){const e=x$(new o$,t);return new ZK(i.url+"?"+i.accountSas,e)}throw new Error("Connection string must be either an Account connection string or a SAS connection string")}getContainerClient(e){return new qK(MZ(this.url,encodeURIComponent(e)),this.pipeline)}async createContainer(e,t={}){const{span:i,updatedOptions:n}=J$("BlobServiceClient-createContainer",t);try{const t=this.getContainerClient(e),r=await t.create(n);return{containerClient:t,containerCreateResponse:r}}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async deleteContainer(e,t={}){const{span:i,updatedOptions:n}=J$("BlobServiceClient-deleteContainer",t);try{const t=this.getContainerClient(e);return await t.delete(n)}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async undeleteContainer(e,t,i={}){const{span:n,updatedOptions:r}=J$("BlobServiceClient-undeleteContainer",i);try{const s=this.getContainerClient(i.destinationContainerName||e),o=new HG(s.storageClientContext);return{containerClient:s,containerUndeleteResponse:await o.restore(Object.assign({deletedContainerName:e,deletedContainerVersion:t},r))}}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}async renameContainer(e,t,i={}){var n;const{span:r,updatedOptions:s}=J$("BlobServiceClient-renameContainer",i);try{const o=this.getContainerClient(t),a=new HG(o.storageClientContext);return{containerClient:o,containerRenameResponse:await a.rename(e,Object.assign(Object.assign({},s),{sourceLeaseId:null===(n=i.sourceCondition)||void 0===n?void 0:n.leaseId}))}}catch(P0){throw r.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{r.end()}}async getProperties(e={}){const{span:t,updatedOptions:i}=J$("BlobServiceClient-getProperties",e);try{return await this.serviceContext.getProperties(Object.assign({abortSignal:e.abortSignal},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async setProperties(e,t={}){const{span:i,updatedOptions:n}=J$("BlobServiceClient-setProperties",t);try{return await this.serviceContext.setProperties(e,Object.assign({abortSignal:t.abortSignal},Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async getStatistics(e={}){const{span:t,updatedOptions:i}=J$("BlobServiceClient-getStatistics",e);try{return await this.serviceContext.getStatistics(Object.assign({abortSignal:e.abortSignal},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async getAccountInfo(e={}){const{span:t,updatedOptions:i}=J$("BlobServiceClient-getAccountInfo",e);try{return await this.serviceContext.getAccountInfo(Object.assign({abortSignal:e.abortSignal},Q$(i)))}catch(P0){throw t.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{t.end()}}async listContainersSegment(e,t={}){const{span:i,updatedOptions:n}=J$("BlobServiceClient-listContainersSegment",t);try{return await this.serviceContext.listContainersSegment(Object.assign(Object.assign(Object.assign({abortSignal:t.abortSignal,marker:e},t),{include:"string"==typeof t.include?[t.include]:t.include}),Q$(n)))}catch(P0){throw i.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{i.end()}}async findBlobsByTagsSegment(e,t,i={}){const{span:n,updatedOptions:r}=J$("BlobServiceClient-findBlobsByTagsSegment",i);try{const s=await this.serviceContext.filterBlobs(Object.assign({abortSignal:i.abortSignal,where:e,marker:t,maxPageSize:i.maxPageSize},Q$(r)));return Object.assign(Object.assign({},s),{_response:s._response,blobs:s.blobs.map(e=>{var t;let i="";return 1===(null===(t=e.tags)||void 0===t?void 0:t.blobTagSet.length)&&(i=e.tags.blobTagSet[0].value),Object.assign(Object.assign({},e),{tags:VZ(e.tags),tagValue:i})})})}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}findBlobsByTagsSegments(e,t,i={}){return VB(this,arguments,(function*(){let n;if(t||void 0===t)do{n=yield jB(this.findBlobsByTagsSegment(e,t,i)),n.blobs=n.blobs||[],t=n.continuationToken,yield yield jB(n)}while(t)}))}findBlobsByTagsItems(e,t={}){return VB(this,arguments,(function*(){var i,n;try{for(var r,s=qB(this.findBlobsByTagsSegments(e,void 0,t));!(r=yield jB(s.next())).done;){const e=r.value;yield jB(yield*UB(qB(e.blobs)))}}catch(o){i={error:o}}finally{try{r&&!r.done&&(n=s.return)&&(yield jB(n.call(s)))}finally{if(i)throw i.error}}}))}findBlobsByTags(e,t={}){const i=Object.assign({},t),n=this.findBlobsByTagsItems(e,i);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(t={})=>this.findBlobsByTagsSegments(e,t.continuationToken,Object.assign({maxPageSize:t.maxPageSize},i))}}listSegments(e,t={}){return VB(this,arguments,(function*(){let i;if(e||void 0===e)do{i=yield jB(this.listContainersSegment(e,t)),i.containerItems=i.containerItems||[],e=i.continuationToken,yield yield jB(yield jB(i))}while(e)}))}listItems(e={}){return VB(this,arguments,(function*(){var t,i;try{for(var n,r=qB(this.listSegments(void 0,e));!(n=yield jB(r.next())).done;){const e=n.value;yield jB(yield*UB(qB(e.containerItems)))}}catch(s){t={error:s}}finally{try{n&&!n.done&&(i=r.return)&&(yield jB(i.call(r)))}finally{if(t)throw t.error}}}))}listContainers(e={}){""===e.prefix&&(e.prefix=void 0);const t=[];e.includeDeleted&&t.push("deleted"),e.includeMetadata&&t.push("metadata"),e.includeSystem&&t.push("system");const i=Object.assign(Object.assign({},e),t.length>0?{include:t}:{}),n=this.listItems(i);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listSegments(e.continuationToken,Object.assign({maxPageSize:e.maxPageSize},i))}}async getUserDelegationKey(e,t,i={}){const{span:n,updatedOptions:r}=J$("BlobServiceClient-getUserDelegationKey",i);try{const s=await this.serviceContext.getUserDelegationKey({startsOn:NZ(e,!1),expiresOn:NZ(t,!1)},Object.assign({abortSignal:i.abortSignal},Q$(r))),o={signedObjectId:s.signedObjectId,signedTenantId:s.signedTenantId,signedStartsOn:new Date(s.signedStartsOn),signedExpiresOn:new Date(s.signedExpiresOn),signedService:s.signedService,signedVersion:s.signedVersion,value:s.value};return Object.assign({_response:s._response,requestId:s.requestId,clientRequestId:s.clientRequestId,version:s.version,date:s.date,errorCode:s.errorCode},o)}catch(P0){throw n.setStatus({code:$F.ERROR,message:P0.message}),P0}finally{n.end()}}getBlobBatchClient(){return new UK(this.url,this.pipeline)}generateAccountSasUrl(e,t=HK.parse("r"),i="sco",n={}){if(!(this.credential instanceof b$))throw RangeError("Can only generate the account SAS when the client is initialized with a shared key credential");if(void 0===e){const t=new Date;e=new Date(t.getTime()+36e5)}const r=function(e,t){const i=e.version?e.version:"2023-11-03";if(e.permissions&&e.permissions.setImmutabilityPolicy&&i<"2020-08-04")throw RangeError("'version' must be >= '2020-08-04' when provided 'i' permission.");if(e.permissions&&e.permissions.deleteVersion&&i<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when provided 'x' permission.");if(e.permissions&&e.permissions.permanentDelete&&i<"2019-10-10")throw RangeError("'version' must be >= '2019-10-10' when provided 'y' permission.");if(e.permissions&&e.permissions.tag&&i<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when provided 't' permission.");if(e.permissions&&e.permissions.filter&&i<"2019-12-12")throw RangeError("'version' must be >= '2019-12-12' when provided 'f' permission.");if(e.encryptionScope&&i<"2020-12-06")throw RangeError("'version' must be >= '2020-12-06' when provided 'encryptionScope' in SAS.");const n=HK.parse(e.permissions.toString()),r=WK.parse(e.services).toString(),s=GK.parse(e.resourceTypes).toString();let o;o=i>="2020-12-06"?[t.accountName,n,r,s,e.startsOn?NZ(e.startsOn,!1):"",NZ(e.expiresOn,!1),e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",i,e.encryptionScope?e.encryptionScope:"",""].join("\n"):[t.accountName,n,r,s,e.startsOn?NZ(e.startsOn,!1):"",NZ(e.expiresOn,!1),e.ipRange?nX(e.ipRange):"",e.protocol?e.protocol:"",i,""].join("\n");const a=t.computeHMACSHA256(o);return new sX(i,a,n.toString(),r,s,e.protocol,e.startsOn,e.expiresOn,e.ipRange,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e.encryptionScope)}(Object.assign({permissions:t,expiresOn:e,resourceTypes:i,services:WK.parse("b").toString()},n),this.credential).toString();return OZ(this.url,r)}}let $K=(()=>{class e{constructor(){this.picturesAccount="storagesmartroute27",this.picturesContainer="filesupload"}uploadImage(e,t,i,n){"exe"!=i.split(".")[1]&&this.uploadBlob(t,i,this.containerClient(e),n)}listImages(e){return this.listBlobs(this.containerClient(e))}downloadImage(e,t,i){this.downloadBlob(t,this.containerClient(e),i)}deleteImage(e,t,i){this.deleteBlob(t,this.containerClient(e),i)}uploadBlob(e,t,i,n){let r=i.getBlockBlobClient(t),s=e.type;t.indexOf("geojson")>=0&&(s="geojson"),r.uploadData(e,{blobHTTPHeaders:{blobContentType:s}}).then(()=>n())}listBlobs(e){var t,i,n,r,s;return n=this,void 0,s=function*(){let n=[],r=e.listBlobsFlat();try{for(var s,o=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,r,(t=e[i](t)).done,t.value)}))}}}(r);!(s=yield o.next()).done;)n.push(s.value.name)}catch(a){t={error:a}}finally{try{s&&!s.done&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}return n},new((r=void 0)||(r=Promise))((function(e,t){function i(e){try{a(s.next(e))}catch(P0){t(P0)}}function o(e){try{a(s.throw(e))}catch(P0){t(P0)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,o)}a((s=s.apply(n,[])).next())}))}downloadBlob(e,t,i){t.getBlobClient(e).download().then(e=>{e.blobBody.then(e=>{i(e)})})}deleteBlob(e,t,i){t.deleteBlob(e).then(()=>{i()})}containerClient(e){return new ZK(`https://${this.picturesAccount}.blob.core.windows.net?${e}`).getContainerClient(this.picturesContainer)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),XK=(()=>{class e{constructor(){this.siteparams=new Hp([]),this.addSiteData=this.siteparams.asObservable(),this.facilityparams=new Hp([]),this.addFacilityData=this.facilityparams.asObservable(),this.facilityLocation=new Hp([]),this.locateFacility=this.facilityLocation.asObservable(),this.levelParams=new Hp([]),this.addlevelData=this.levelParams.asObservable(),this.polygondata=new Hp([]),this.polygongeojson=this.polygondata.asObservable(),this.api=this.load()}load(){const e=document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0;const t="GooglePlaces_cb_"+(1e9*Math.random()>>>0);e.src=this.getScriptSrc(t);const i=window,n=new Promise((n,r)=>{i[t]=n,e.onerror=r});return document.body.appendChild(e),n.then(()=>google.maps)}getScriptSrc(e){const t={v:"3",callback:e,key:"AIzaSyCaKbVhcX_22R_pRKDYuNA7vox-PtGaDkI",libraries:"places"};return`//maps.googleapis.com/maps/api/js?${Object.keys(t).map(e=>`${e}=${t[e]}`).join("&")}&language=fr`}setFacilitylocation(e){this.facilityLocation.next(e)}addsitevalues(e){this.siteparams.next(e)}addFacilityvalues(e){this.facilityparams.next(e)}addLevelValues(e){this.levelParams.next(e)}addpolygondata(e){this.polygondata.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function KK(e,t){1&e&&(ko(0,"div"),pa(1,"Sitename is required"),Ao())}function YK(e,t){if(1&e&&(ko(0,"div",20),wo(1,KK,2,0,"div",21),Ao()),2&e){Uo();const e=Co(8);gr(1),Po("ngIf",e.errors.required)}}function JK(e,t){if(1&e){const e=No();ko(0,"a",22),Lo("click",(function(){return Jt(e),Uo().redirect()})),pa(1,"click here to locate from map"),Ao()}}function QK(e,t){1&e&&(ko(0,"div"),pa(1,"location is required"),Ao())}function eY(e,t){if(1&e&&(ko(0,"div",20),wo(1,QK,2,0,"div",21),Ao()),2&e){Uo();const e=Co(28);gr(1),Po("ngIf",e.errors.required)}}const tY=function(e){return{"is-invalid":e}};let iY=(()=>{class e{constructor(e,t,i,n,r,s,o){this.snackBar=e,this.blobService=t,this.dialog=i,this.router=n,this.route=r,this.locationservice=s,this.siteonboarding=o,this.showPortal=!1,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteName:"",fileUrl:"",lan:0,lat:0},this.locationservice.addSiteData.subscribe(e=>{this.form.siteName=e[0].siteName,this.form.fileUrl=e[0].fileUrl,this.form.lan=e[0].lan,this.form.lat=e[0].lat,this.lanlat=e[0].lan+","+e[0].lat})}ngOnInit(){}fileUpload(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.picturesList=[],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.form.siteName.replace(/\s+/g,"")+"/"+this.fileType+"/"+e.name,()=>{}),this.reloadImages())}locationchange(e){console.log(e.target.value,"::::event.target.value:::"),this.form.lan=e.target.value.split(",")[0],this.form.lat=e.target.value.split(",")[1],this.lanlat=e.target.value}reloadImages(){this.blobService.listImages(this.sas).then(e=>{e&&(this.form.fileUrl=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.form.siteName.replace(/\s+/g,"")}/${this.fileType}/${this.fileName}`)})}onchangeSiteName(e){this.form.siteName=e}redirect(){this.locationservice.addsitevalues([this.form]),this.router.navigate(["maptool/1"])}onSubmit(){console.log(this.form),0==this.form.lan&&this.lanlat.split(","),0==this.form.lat&&this.lanlat.split(","),this.siteonboarding.addSite(this.form).subscribe(e=>{console.log(e,"add site responce"),Object.entries(e).length>0?(this.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),this.dialog.closeAll(),this.router.navigate(["/map"])):this.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})})}onReset(e){e.reset()}}return e.\u0275fac=function(t){return new(t||e)(So(FB),So($K),So(kT),So(i_),So($f),So(XK),So(PB))},e.\u0275cmp=ft({type:e,selectors:[["app-addsite"]],decls:35,vars:14,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["matInput","","type","text","name","sitename","placeholder","Enter site Name","required","",1,"form-control",3,"ngModel","ngClass","change","ngModelChange"],["sitename","ngModel"],["class","invalid-feedback",4,"ngIf"],[1,"buttongroup"],[1,"image-upload"],["for","file-input"],[1,"note"],[2,"font-size","12px"],["id","file-input","type","file","accept",".jpg,.img,.png,.JPEG",1,"upload",3,"disabled","change"],[3,"click",4,"ngIf"],["matSuffix",""],["matInput","","type","text","placeholder","Enter Coordinate Ex:[Lan, Lat]","name","Location","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange","change"],["location","ngModel"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"]],template:function(e,t){if(1&e){const e=No();ko(0,"div",0),ko(1,"form",1,2),Lo("ngSubmit",(function(){return Jt(e),Co(2).form.valid})),ko(3,"div",3),ko(4,"label"),pa(5,"Site Name"),Ao(),ko(6,"mat-form-field",4),ko(7,"input",5,6),Lo("change",(function(){Jt(e);const i=Co(8);return t.onchangeSiteName(i.value)}))("ngModelChange",(function(e){return t.form.siteName=e})),Ao(),wo(9,YK,2,1,"div",7),Ao(),Ao(),ko(10,"div",3),ko(11,"div",8),ko(12,"div",9),ko(13,"label",10),ko(14,"mat-icon"),pa(15,"cloud_upload"),Ao(),Ao(),ko(16,"p",11),ko(17,"span",12),pa(18,"(Supported File Formats:*/.png,.jpg,JPEG)"),Ao(),Ao(),ko(19,"input",13),Lo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ao(),Ao(),Ao(),Ao(),ko(20,"div",3),ko(21,"label"),pa(22," Location"),Ao(),wo(23,JK,2,0,"a",14),ko(24,"mat-icon",15),pa(25,"location_on"),Ao(),ko(26,"mat-form-field",4),ko(27,"input",16,17),Lo("ngModelChange",(function(e){return t.lanlat=e}))("change",(function(e){return t.locationchange(e)})),Ao(),wo(29,eY,2,1,"div",7),Ao(),Ao(),ko(30,"div",8),ko(31,"button",18),Lo("click",(function(){return t.onSubmit()})),pa(32,"Submit"),Ao(),ko(33,"button",19),Lo("click",(function(){Jt(e);const i=Co(2);return t.onReset(i)})),pa(34," Reset "),Ao(),Ao(),Ao(),Ao()}if(2&e){const e=Co(2),i=Co(8),n=Co(28);gr(7),Po("ngModel",t.form.siteName)("ngClass",kl(10,tY,e.submitted&&i.errors)),gr(2),Po("ngIf",e.submitted&&i.errors),gr(10),Po("disabled",!t.form.siteName),gr(4),Po("ngIf",t.form.fileUrl),gr(4),Po("disabled",!t.form.fileUrl)("ngModel",t.lanlat)("ngClass",kl(12,tY,e.submitted&&n.errors)),gr(2),Po("ngIf",e.submitted&&n.errors),gr(2),Po("disabled",!t.lanlat)}},directives:[Iw,Ib,ww,jE,ZE,Cb,Dw,Ab,Aw,Ch,Ph,gb,NE,dS],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),e})();function nY(e,t){if(1&e&&(ko(0,"mat-option",30),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.siteId),gr(1),ma(e.siteName)}}function rY(e,t){1&e&&(ko(0,"div"),pa(1,"Sitename is required"),Ao())}function sY(e,t){if(1&e&&(ko(0,"div",31),wo(1,rY,2,0,"div",32),Ao()),2&e){Uo();const e=Co(11);gr(1),Po("ngIf",e.errors.required)}}function oY(e,t){1&e&&(ko(0,"div"),pa(1,"Facility name is required"),Ao())}function aY(e,t){if(1&e&&(ko(0,"div",31),wo(1,oY,2,0,"div",32),Ao()),2&e){Uo();const e=Co(21);gr(1),Po("ngIf",e.errors.required)}}function lY(e,t){1&e&&(ko(0,"div"),pa(1,"No. of Levels required"),Ao())}function cY(e,t){if(1&e&&(ko(0,"div",31),wo(1,lY,2,0,"div",32),Ao()),2&e){Uo();const e=Co(28);gr(1),Po("ngIf",e.errors.required)}}function hY(e,t){1&e&&(ko(0,"div"),pa(1,"Working Hours From required"),Ao())}function uY(e,t){if(1&e&&(ko(0,"div",31),wo(1,hY,2,0,"div",32),Ao()),2&e){Uo();const e=Co(36);gr(1),Po("ngIf",e.errors.required)}}function dY(e,t){1&e&&(ko(0,"div"),pa(1,"Working Hours To required"),Ao())}function pY(e,t){if(1&e&&(ko(0,"div",31),wo(1,dY,2,0,"div",32),Ao()),2&e){Uo();const e=Co(43);gr(1),Po("ngIf",e.errors.required)}}function mY(e,t){if(1&e){const e=No();ko(0,"a",33),Lo("click",(function(){return Jt(e),Uo().redirect()})),pa(1,"click here to locate from map "),Ao()}}function fY(e,t){1&e&&(ko(0,"div"),pa(1,"location is required"),Ao())}function gY(e,t){1&e&&(ko(0,"div"),pa(1," location must me geometry "),Ao())}function _Y(e,t){1&e&&(ko(0,"div"),pa(1," location must me geometry "),Ao())}function yY(e,t){if(1&e&&(ko(0,"div",31),wo(1,fY,2,0,"div",32),wo(2,gY,2,0,"div",32),wo(3,_Y,2,0,"div",32),Ao()),2&e){Uo();const e=Co(52);gr(1),Po("ngIf",e.errors.required),gr(1),Po("ngIf",e.errors.minlength),gr(1),Po("ngIf",e.errors.maxlength)}}const vY=function(e){return{"is-invalid":e}};let xY=(()=>{class e{constructor(e,t,i,n,r,s){this.dialog=e,this.blobService=t,this.snackBar=i,this.router=n,this.siteonboarding=r,this.maplocationservice=s,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.sitesData=[],this.form={siteId:"",facilityName:"",imageUrl:"",lan:0,lat:0,HrsFrom:0,HrsTo:0,MaxLevels:0},this.maplocationservice.addFacilityData.subscribe(e=>{this.form.siteId=e[0].siteId,this.form.facilityName=e[0].facilityName,this.form.imageUrl=e[0].imageUrl,this.form.lan=e[0].lan,this.form.lat=e[0].lat,this.form.HrsFrom=e[0].HrsFrom,this.form.HrsTo=e[0].HrsTo,this.form.MaxLevels=e[0].MaxLevels,this.lanlat=e[0].lan+","+e[0].lat})}ngOnInit(){this.getAllSites()}fileUpload(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1];let t=this.form.facilityName.replace(/\s+/g,"");console.log(t),this.picturesList=[],this.form.facilityName&&(this.blobService.uploadImage(this.sas,e,this.sitename+"/"+t+"/"+this.fileType+"/"+e.name,()=>{}),this.reloadImages())}reloadImages(){this.blobService.listImages(this.sas).then(e=>{this.form.imageUrl=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.sitename}/${this.form.facilityName.replace(/\s+/g,"")}/${this.fileType}/${this.fileName}`,e.push(`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.sitename}/${this.form.facilityName.replace(/\s+/g,"")}/${this.fileType}/${this.fileName}`),e.forEach(e=>{this.downloadThisBlob(e,this.containerClient(this.sas))}),console.log(this.form,"list")})}containerClient(e){return new ZK(`https://${this.blobService.picturesAccount}.blob.core.windows.net?${e}`).getContainerClient(this.blobService.picturesContainer)}downloadThisBlob(e,t){const i=t.getBlobClient(e);return e.indexOf("geojson")>=0?i.setHTTPHeaders({blobContentType:"geojson"}):i.setHTTPHeaders({blobContentType:"application/octet-stream"}),i.url}selectedSite(e){let t=this.sitesData.filter((t,i)=>t.siteId==e);this.sitename=t[0].siteName,this.maplocationservice.setFacilitylocation(t[0].location.coordinates)}getAllSites(){console.log(":::loading  sites::::"),this.siteonboarding.obtainedSiteDetails.subscribe(e=>{console.log(e),e&&(this.sitesData=e),console.log(this.sitesData,"siteData")})}redirect(){this.maplocationservice.addFacilityvalues([this.form]),this.router.navigate(["maptool/2"])}locationchange(e){console.log(e.target.value,"::::event.target.value:::"),this.form.lan=e.target.value.split(",")[0],this.form.lat=e.target.value.split(",")[1],this.lanlat=e.target.value.split(",")[0]+","+e.target.value.split(",")[1]}onSubmit(){console.log(this.form,"add facility payload"),0==this.form.lan&&this.lanlat.split(","),0==this.form.lat&&this.lanlat.split(","),this.siteonboarding.addFacility(this.form).subscribe(e=>{Object.entries(e).length>0?(console.log(e,"add facility responce"),this.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),this.dialog.closeAll(),this.router.navigate(["/map"])):this.snackBar.open("Failed","retry",{duration:3e3,verticalPosition:"top"})})}onReset(e){e.reset()}}return e.\u0275fac=function(t){return new(t||e)(So(kT),So($K),So(FB),So(i_),So(PB),So(XK))},e.\u0275cmp=ft({type:e,selectors:[["app-add-facility"]],decls:66,vars:39,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange","selectionChange"],["sitename","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["matInput","","type","text","name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["facilityname","ngModel"],["matInput","","type","number","name","MaxLevels","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["MaxLevels","ngModel"],["matInput","","type","time","name","workingHrs_Froms","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["workingHrs_Froms","ngModel"],["matInput","","type","time","name","workingHrs_To","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["workingHrs_To","ngModel"],[1,"buttongroup"],[3,"click",4,"ngIf"],["matInput","","type","text","name","Location","placeholder","Enter Coordinate Ex:[Lan, Lat]","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange","change"],["location","ngModel"],[1,"image-upload"],["for","file-input"],[2,"font-size","12px"],["id","file-input","type","file","accept","..jpg,.img,.png,.JPEG,.JPG",1,"upload",3,"disabled","change"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"]],template:function(e,t){if(1&e){const e=No();ko(0,"div",0),ko(1,"form",1,2),Lo("ngSubmit",(function(){return Jt(e),Co(2).form.valid})),ko(3,"div",3),ko(4,"div",4),Io(5,"div",5),ko(6,"div",5),ko(7,"label"),pa(8,"Site Name"),Ao(),ko(9,"mat-form-field",6),ko(10,"mat-select",7,8),Lo("ngModelChange",(function(e){return t.form.siteId=e}))("selectionChange",(function(){Jt(e);const i=Co(11);return t.selectedSite(i.value)})),ko(12,"mat-option",9),pa(13,"Select Site"),Ao(),wo(14,nY,2,2,"mat-option",10),Ao(),Ao(),wo(15,sY,2,1,"div",11),Ao(),ko(16,"div",5),ko(17,"label"),pa(18,"Facility Name"),Ao(),ko(19,"mat-form-field",6),ko(20,"input",12,13),Lo("ngModelChange",(function(e){return t.form.facilityName=e})),Ao(),Ao(),wo(22,aY,2,1,"div",11),Ao(),ko(23,"div",5),ko(24,"label"),pa(25,"No. of Levels in Facility "),Ao(),ko(26,"mat-form-field",6),ko(27,"input",14,15),Lo("ngModelChange",(function(e){return t.form.MaxLevels=e})),Ao(),Ao(),wo(29,cY,2,1,"div",11),Ao(),Ao(),ko(30,"div",4),ko(31,"div",5),ko(32,"label"),pa(33,"Working Hours From"),Ao(),ko(34,"mat-form-field",6),ko(35,"input",16,17),Lo("ngModelChange",(function(e){return t.form.HrsFrom=e})),Ao(),Ao(),wo(37,uY,2,1,"div",11),Ao(),ko(38,"div",5),ko(39,"label"),pa(40,"Working Hours To"),Ao(),ko(41,"mat-form-field",6),ko(42,"input",18,19),Lo("ngModelChange",(function(e){return t.form.HrsTo=e})),Ao(),Ao(),wo(44,pY,2,1,"div",11),Ao(),ko(45,"div",5),ko(46,"div",20),ko(47,"label"),pa(48,"Location "),Ao(),wo(49,mY,2,0,"a",21),Ao(),ko(50,"mat-form-field",6),ko(51,"input",22,23),Lo("ngModelChange",(function(e){return t.lanlat=e}))("change",(function(e){return t.locationchange(e)})),Ao(),Ao(),wo(53,yY,4,3,"div",11),Ao(),Ao(),Ao(),ko(54,"div",20),ko(55,"div",24),ko(56,"label",25),ko(57,"mat-icon"),pa(58,"cloud_upload"),Ao(),ko(59,"span",26),pa(60,"(Supported File Formats:*/.png,.jpg,JPEG)"),Ao(),Ao(),ko(61,"input",27),Lo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ao(),Ao(),ko(62,"button",28),Lo("click",(function(){return t.onSubmit()})),pa(63,"Submit"),Ao(),ko(64,"button",29),Lo("click",(function(){Jt(e);const i=Co(2);return t.onReset(i)})),pa(65," Reset "),Ao(),Ao(),Ao(),Ao()}if(2&e){const e=Co(2),i=Co(11),n=Co(21),r=Co(28),s=Co(36),o=Co(43),a=Co(52);gr(10),Po("ngModel",t.form.siteId)("ngClass",kl(27,vY,e.submitted&&i.errors)),gr(4),Po("ngForOf",t.sitesData),gr(1),Po("ngIf",e.submitted&&i.errors),gr(5),Po("disabled",!t.form.siteId)("ngModel",t.form.facilityName)("ngClass",kl(29,vY,e.submitted&&n.errors)),gr(2),Po("ngIf",e.submitted&&n.errors),gr(5),Po("disabled",!t.form.facilityName)("ngModel",t.form.MaxLevels)("ngClass",kl(31,vY,e.submitted&&r.errors)),gr(2),Po("ngIf",e.submitted&&r.errors),gr(6),Po("disabled",!t.form.facilityName)("ngModel",t.form.HrsFrom)("ngClass",kl(33,vY,e.submitted&&s.errors)),gr(2),Po("ngIf",e.submitted&&s.errors),gr(5),Po("disabled",!t.form.facilityName)("ngModel",t.form.HrsTo)("ngClass",kl(35,vY,e.submitted&&o.errors)),gr(2),Po("ngIf",e.submitted&&o.errors),gr(5),Po("ngIf",t.form.imageUrl),gr(2),Po("disabled",!t.form.facilityName)("ngModel",t.lanlat)("ngClass",kl(37,vY,e.submitted&&a.errors)),gr(2),Po("ngIf",e.submitted&&a.errors),gr(8),Po("disabled",!t.form.facilityName),gr(1),Po("disabled",!t.lanlat)}},directives:[Iw,Ib,ww,jE,mT,Dw,Ab,Aw,Ch,Kv,Eh,Ph,ZE,Cb,qb,gb,dS],styles:[".card[_ngcontent-%COMP%]{justify-content:center;margin:0}.card[_ngcontent-%COMP%], .items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.row[_ngcontent-%COMP%]{display:flex;justify-items:space-between}.col-md-6[_ngcontent-%COMP%]{padding:5px;margin:5px}"]}),e})();function bY(e,t){if(1&e&&(ko(0,"mat-option",12),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.siteId),gr(1),ma(e.siteName)}}function wY(e,t){1&e&&(ko(0,"div"),pa(1,"Site name is required"),Ao())}function CY(e,t){if(1&e&&(ko(0,"div",27),wo(1,wY,2,0,"div",28),Ao()),2&e){Uo();const e=Co(8);gr(1),Po("ngIf",e.errors.required)}}function SY(e,t){if(1&e&&(ko(0,"mat-option",12),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.facilityId),gr(1),ma(e.facilityName)}}function EY(e,t){1&e&&(ko(0,"div"),pa(1,"facility name is required"),Ao())}function TY(e,t){if(1&e&&(ko(0,"div",27),wo(1,EY,2,0,"div",28),Ao()),2&e){Uo();const e=Co(18);gr(1),Po("ngIf",e.errors.required)}}function PY(e,t){1&e&&(ko(0,"div"),pa(1,"Level name is required"),Ao())}function MY(e,t){if(1&e&&(ko(0,"div",27),wo(1,PY,2,0,"div",28),Ao()),2&e){Uo();const e=Co(28);gr(1),Po("ngIf",e.errors.required)}}function kY(e,t){1&e&&(ko(0,"div"),pa(1,"Capacity & Max-capacity required"),Ao())}function AY(e,t){if(1&e&&(ko(0,"div",27),wo(1,kY,2,0,"div",28),Ao()),2&e){Uo();const e=Co(37),t=Co(43);gr(1),Po("ngIf",e.errors.required&&t.errors.required)}}const IY=function(e){return{"is-invalid":e}};let RY=(()=>{class e{constructor(e,t,i,n,r,s,o){this.http=e,this.snackBar=t,this.router=i,this.blobService=n,this.siteonboarding=r,this.maplocationservice=s,this.dialog=o,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteId:"",facilityId:"",levelName:"",fileUrl:"",capacity:0,Max_capacity:0},this.allFacilities=[],this.sitesData=[],this.facilityData=[],this.selectedfile={},this.maplocationservice.addFacilityData.subscribe(e=>{console.log("In add floor component/constructor"),this.form.siteId=e.siteId,this.form.facilityId=e.facilityName,this.form.levelName=e.levelName,this.form.fileUrl=e.fileUrl})}ngOnInit(){this.getSites(),this.getFacilities()}handleFileSelect(e){}fileUpload(e){if(this.fileName=e.name,this.fileType=e.name.split(".")[1],"geojson"!==this.fileType)(new FormData).append("file",e),this.picturesList=[],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.sitename+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.form.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+e.name,()=>{}),this.reloadImages());else if("geojson"===this.fileType){const t=new FileReader;t.readAsText(e,"UTF-8"),t.onload=()=>{this.selectedfile=JSON.parse(t.result),console.log(this.selectedfile),this.form.fileUrl=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.sitename}/${this.facilityName.replace(/\s+/g,"")}/${this.form.levelName.replace(/\s+/g,"")}/${this.fileType}/${this.fileName}`},t.onerror=e=>{console.log(e)}}}download(e,t,i){console.log(t);const n=document.createElement("a"),r=new Blob([e],{type:i});n.href=URL.createObjectURL(r),n.download=t,(new FormData).append("file",r),this.fileName&&(this.blobService.uploadImage(this.sas,r,this.sitename+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.form.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+this.fileName,()=>{}),this.reloadImages())}onDownload(e){console.log(e,"editedgeojson"),this.download(JSON.stringify(e),this.form.levelName.replace(/\s+/g,"")+".geojson","text/plain")}reloadImages(){this.blobService.listImages(this.sas).then(e=>{e&&(this.form.fileUrl=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.sitename}/${this.facilityName.replace(/\s+/g,"")}/${this.form.levelName.replace(/\s+/g,"")}/${this.fileType}/${this.fileName}`)})}redirect(){console.log(this.form,"in add level after adding new level"),this.router.navigate(["createspaces/3"])}getSites(){this.siteonboarding.obtainedSiteDetails.subscribe(e=>{this.sitesData=e})}getFacilities(){this.allFacilities=[],this.siteonboarding.obtainedFacilityDetails.subscribe(e=>{this.allFacilities=e})}selectedSite(e){this.facilityData=[],this.facilityName=null,console.log(e,this.allFacilities),this.facilityData=this.allFacilities.filter((t,i)=>t.Site_Id==e),this.facilityName=this.facilityData[0].facilityName}selectedFacility(e){let t=this.facilityData.filter(t=>t.facilityId==e),i=this.sitesData.filter(e=>e.siteId==this.form.siteId);console.log(i,"selectedsiteobj"),this.sitename=i[0].siteName,this.maplocationservice.setFacilitylocation(t[0].facilitylocation.coordinates)}onSubmit(){console.log(this.form,"::::::form data:::::"),this.siteonboarding.addLevel(this.form).subscribe(e=>{Object.entries(e).length>0?(console.log(this.selectedfile.features,"this.selectedfile.features"),this.getAllLevels(),this.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),e.fileUrl.toString(),this.responceFacilityId=e.Facility_Id,this.maplocationservice.addLevelValues([e])):this.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})})}getAllLevels(){this.siteonboarding.getAllLevels().subscribe(e=>{if(e)if(this.siteonboarding.saveAllLevelDetails(e),this.selectedfile.features){let t;t=e.filter((e,t)=>e.Facility_Id===this.responceFacilityId&&e.levelName==this.form.levelName),this.selectedfile.features.length>0&&this.selectedfile.features.forEach((e,i)=>{e.properties?e.properties.levelId=t[0].levelId:null==e.properties&&(e.properties={levelId:t[0].levelId}),i==this.selectedfile.features.length-1&&(this.onDownload(this.selectedfile),this.siteonboarding.selectedtab=3)})}else this.siteonboarding.selectedtab=3})}onReset(e){e.reset()}}return e.\u0275fac=function(t){return new(t||e)(So(jx),So(FB),So(i_),So($K),So(PB),So(XK),So(kT))},e.\u0275cmp=ft({type:e,selectors:[["app-add-floor"]],decls:57,vars:32,consts:[[1,"register-form"],["name","form",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange","selectionChange"],["sitename","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["facilityname","ngModel"],[3,"value"],["matInput","","type","text","name","levelname","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["levelname","ngModel"],[1,"buttongroup"],[1,"col"],["matInput","","type","number","name","capacity","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["capacity","ngModel"],["matInput","","type","number","name","Max_capacity","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["Max_capacity","ngModel"],[1,"image-upload"],["for","file-input"],[2,"font-size","12px"],["id","file-input","type","file","accept",".geojson,.jpg,.img,.png,.JPEG",1,"upload",3,"disabled","change"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=No();ko(0,"div",0),ko(1,"form",1,2),Lo("ngSubmit",(function(){return Jt(e),Co(2).form.valid})),ko(3,"div",3),ko(4,"label"),pa(5,"Site Name"),Ao(),ko(6,"mat-form-field",4),ko(7,"mat-select",5,6),Lo("ngModelChange",(function(e){return t.form.siteId=e}))("selectionChange",(function(){Jt(e);const i=Co(8);return t.selectedSite(i.value)})),ko(9,"mat-option",7),pa(10,"Select Site"),Ao(),wo(11,bY,2,2,"mat-option",8),Ao(),Ao(),wo(12,CY,2,1,"div",9),Ao(),ko(13,"div",3),ko(14,"label"),pa(15,"Facility Name"),Ao(),ko(16,"mat-form-field",4),ko(17,"mat-select",10,11),Lo("selectionChange",(function(){Jt(e);const i=Co(18);return t.selectedFacility(i.value)}))("ngModelChange",(function(e){return t.form.facilityId=e})),ko(19,"mat-option",12),pa(20,"Select Facility"),Ao(),wo(21,SY,2,2,"mat-option",8),Ao(),Ao(),wo(22,TY,2,1,"div",9),Ao(),ko(23,"div",3),ko(24,"label"),pa(25,"Level Name"),Ao(),ko(26,"mat-form-field",4),ko(27,"input",13,14),Lo("ngModelChange",(function(e){return t.form.levelName=e})),Ao(),Ao(),wo(29,MY,2,1,"div",9),Ao(),ko(30,"div",3),ko(31,"div",15),ko(32,"div",16),ko(33,"label"),pa(34,"Capacity "),Ao(),ko(35,"mat-form-field",4),ko(36,"input",17,18),Lo("ngModelChange",(function(e){return t.form.capacity=e})),Ao(),Ao(),Ao(),ko(38,"div",16),ko(39,"label"),pa(40,"Max Capacity "),Ao(),ko(41,"mat-form-field",4),ko(42,"input",19,20),Lo("ngModelChange",(function(e){return t.form.Max_capacity=e})),Ao(),Ao(),Ao(),Ao(),wo(44,AY,2,1,"div",9),Ao(),ko(45,"div",15),ko(46,"div",21),ko(47,"label",22),ko(48,"mat-icon"),pa(49,"cloud_upload"),Ao(),Ao(),ko(50,"span",23),pa(51,"(Supported File Formats:*/geojson,.png,.jpg,JPEG)"),Ao(),ko(52,"input",24),Lo("change",(function(e){return t.fileUpload(e.target.files[0])})),Ao(),Ao(),ko(53,"button",25),Lo("click",(function(){return t.onSubmit()})),pa(54,"Submit"),Ao(),ko(55,"button",26),Lo("click",(function(){Jt(e);const i=Co(2);return t.onReset(i)})),pa(56," Reset "),Ao(),Ao(),Ao(),Ao()}if(2&e){const e=Co(2),i=Co(8),n=Co(18),r=Co(28),s=Co(37),o=Co(43);gr(7),Po("ngModel",t.form.siteId)("ngClass",kl(22,IY,e.submitted&&i.errors)),gr(4),Po("ngForOf",t.sitesData),gr(1),Po("ngIf",e.submitted&&i.errors),gr(5),Po("disabled",!t.form.siteId)("ngModel",t.form.facilityId)("ngClass",kl(24,IY,e.submitted&&n.errors)),gr(4),Po("ngForOf",t.facilityData),gr(1),Po("ngIf",e.submitted&&n.errors),gr(5),Po("disabled",!t.form.facilityId)("ngModel",t.form.levelName)("ngClass",kl(26,IY,e.submitted&&r.errors)),gr(2),Po("ngIf",e.submitted&&r.errors),gr(7),Po("disabled",!t.form.levelName)("ngModel",t.form.capacity)("ngClass",kl(28,IY,e.submitted&&s.errors)),gr(6),Po("disabled",!t.form.levelName)("ngModel",t.form.Max_capacity)("ngClass",kl(30,IY,e.submitted&&o.errors)),gr(2),Po("ngIf",e.submitted&&s.errors&&o),gr(8),Po("disabled",!t.form.levelName),gr(1),Po("disabled",!t.form.fileUrl)}},directives:[Iw,Ib,ww,jE,mT,Dw,Ab,Aw,Ch,Kv,Eh,Ph,ZE,Cb,qb,gb,dS],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),e})();function OY(e,t){if(1&e&&(ko(0,"mat-option",15),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.siteId),gr(1),ma(e.siteName)}}function NY(e,t){1&e&&(ko(0,"div"),pa(1,"Site name is required"),Ao())}function DY(e,t){if(1&e&&(ko(0,"div",16),wo(1,NY,2,0,"div",17),Ao()),2&e){Uo();const e=Co(8);gr(1),Po("ngIf",e.errors.required)}}function zY(e,t){if(1&e&&(ko(0,"mat-option",15),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.facilityId),gr(1),ma(e.facilityName)}}function LY(e,t){1&e&&(ko(0,"div"),pa(1,"facility name is required"),Ao())}function BY(e,t){if(1&e&&(ko(0,"div",16),wo(1,LY,2,0,"div",17),Ao()),2&e){Uo();const e=Co(16);gr(1),Po("ngIf",e.errors.required)}}function FY(e,t){if(1&e&&(ko(0,"mat-option",15),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e.levelId),gr(1),ma(e.levelName)}}function jY(e,t){1&e&&(ko(0,"div"),pa(1,"Level name is required"),Ao())}function VY(e,t){if(1&e&&(ko(0,"div",16),wo(1,jY,2,0,"div",17),Ao()),2&e){Uo();const e=Co(24);gr(1),Po("ngIf",e.errors.required)}}function UY(e,t){if(1&e){const e=No();ko(0,"a",18),Lo("click",(function(){return Jt(e),Uo().redirect()})),pa(1,"click here to locate from map "),ko(2,"mat-icon",19),pa(3,"location_on"),Ao(),Ao()}}const qY=function(e){return{"is-invalid":e}};let HY=(()=>{class e{constructor(e,t,i,n,r,s){this.http=e,this.router=t,this.blobService=i,this.siteonboarding=n,this.maplocationservice=r,this.dialog=s,this.picturesList=[],this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.picturesDownloaded=[],this.form={siteId:"",facilityId:"",levelId:"",fileUrl:"",spaceDetails:[]},this.allFacilities=[],this.sitesData=[],this.facilityData=[],this.getLevels()}ngOnInit(){this.getSites(),this.getFacilities()}fileUpload(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.picturesList=[]}reloadImages(){this.blobService.listImages(this.sas).then(e=>{e&&this.maplocationservice.addLevelValues(this.form)})}containerClient(e){return new ZK(`https://${this.blobService.picturesAccount}.blob.core.windows.net?${e}`).getContainerClient(this.blobService.picturesContainer)}downloadThisBlob(e,t){const i=t.getBlobClient(e);return e.indexOf("geojson")>=0?i.setHTTPHeaders({blobContentType:"geojson"}):i.setHTTPHeaders({blobContentType:"application/octet-stream"}),i.url}redirect(){this.router.navigate(["createspaces/4"])}getSites(){this.siteonboarding.obtainedSiteDetails.subscribe(e=>{this.sitesData=e})}getFacilities(){this.allFacilities=[],this.siteonboarding.obtainedFacilityDetails.subscribe(e=>{this.allFacilities=e})}getLevels(){this.siteonboarding.obtainedLevelDetails.subscribe(e=>{console.log(e,"in add space"),this.allLevels=e})}selectedSite(e){this.facilityData=[],this.facilityName=null,console.log(e,this.allFacilities),this.facilityData=this.allFacilities.filter((t,i)=>t.Site_Id==e),console.log(this.facilityData,"faciltity data"),this.facilityName=this.facilityData[0].facilityName}selectedFacility(e){console.log(this.allLevels,"all levels"),this.levelsData=[],this.levelsData=this.allLevels.filter((t,i)=>t.Facility_Id==e),console.log(this.levelsData);let t=this.facilityData.filter(t=>t.facilityId==e);this.maplocationservice.setFacilitylocation(t[0].facilitylocation.coordinates)}selectLevel(e){let t=this.levelsData.filter(t=>t.levelId==e);console.log(t,"selectedlevelObj"),this.maplocationservice.addLevelValues(t)}onSubmit(){this.siteonboarding.addLevel(this.form).subscribe(e=>{if(e){console.log(e,"add level responce");let t=e.fileUrl.toString();this.reloadImages(),this.redirect(),this.dialog.closeAll(),this.http.get(t).subscribe(e=>{console.log("trying to get uploaded image "),console.log(e)})}})}onReset(e){e.reset()}}return e.\u0275fac=function(t){return new(t||e)(So(jx),So(i_),So($K),So(PB),So(XK),So(kT))},e.\u0275cmp=ft({type:e,selectors:[["app-add-space"]],decls:29,vars:21,consts:[[1,"register-form"],["name","form"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","sitename","required","",1,"form-control",3,"ngModel","ngClass","selectionChange","ngModelChange"],["sitename","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["name","facilityname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["facilityname","ngModel"],["name","levelname","required","",1,"form-control",3,"disabled","ngModel","ngClass","selectionChange","ngModelChange"],["levelname","ngModel"],[1,"buttongroup"],[3,"click",4,"ngIf"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"],[3,"click"],["matSuffix",""]],template:function(e,t){if(1&e){const e=No();ko(0,"div",0),ko(1,"form",1,2),ko(3,"div",3),ko(4,"label"),pa(5,"Site Name"),Ao(),ko(6,"mat-form-field",4),ko(7,"mat-select",5,6),Lo("selectionChange",(function(){Jt(e);const i=Co(8);return t.selectedSite(i.value)}))("ngModelChange",(function(e){return t.form.siteId=e})),wo(9,OY,2,2,"mat-option",7),Ao(),Ao(),wo(10,DY,2,1,"div",8),Ao(),ko(11,"div",3),ko(12,"label"),pa(13,"Facility Name"),Ao(),ko(14,"mat-form-field",4),ko(15,"mat-select",9,10),Lo("selectionChange",(function(){Jt(e);const i=Co(16);return t.selectedFacility(i.value)}))("ngModelChange",(function(e){return t.form.facilityId=e})),wo(17,zY,2,2,"mat-option",7),Ao(),Ao(),wo(18,BY,2,1,"div",8),Ao(),ko(19,"div",3),ko(20,"label"),pa(21,"Level Name"),Ao(),ko(22,"mat-form-field",4),ko(23,"mat-select",11,12),Lo("selectionChange",(function(){Jt(e);const i=Co(24);return t.selectLevel(i.value)}))("ngModelChange",(function(e){return t.form.levelId=e})),wo(25,FY,2,2,"mat-option",7),Ao(),Ao(),wo(26,VY,2,1,"div",8),Ao(),ko(27,"div",13),wo(28,UY,4,0,"a",14),Ao(),Ao(),Ao()}if(2&e){const e=Co(2),i=Co(8),n=Co(16),r=Co(24);gr(7),Po("ngModel",t.form.siteId)("ngClass",kl(15,qY,e.submitted&&i.errors)),gr(2),Po("ngForOf",t.sitesData),gr(1),Po("ngIf",e.submitted&&i.errors),gr(5),Po("disabled",!t.form.siteId)("ngModel",t.form.facilityId)("ngClass",kl(17,qY,e.submitted&&n.errors)),gr(2),Po("ngForOf",t.facilityData),gr(1),Po("ngIf",e.submitted&&n.errors),gr(5),Po("disabled",!t.form.facilityId)("ngModel",t.form.levelId)("ngClass",kl(19,qY,e.submitted&&r.errors)),gr(2),Po("ngForOf",t.levelsData),gr(1),Po("ngIf",e.submitted&&r.errors),gr(2),Po("ngIf",t.form.levelId)}},directives:[Iw,Ib,ww,jE,mT,Dw,Ab,Aw,Ch,Eh,Ph,Kv,gb,NE],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.buttongroup[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),e})(),GY=(()=>{class e{constructor(e){this.siteonboardingservice=e}ngOnInit(){this.demo1TabIndex=this.siteonboardingservice.selectedtab}}return e.\u0275fac=function(t){return new(t||e)(So(PB))},e.\u0275cmp=ft({type:e,selectors:[["app-addbuildingpopup"]],decls:9,vars:1,consts:[[3,"selectedIndex","selectedIndexChange"],["label","Add Site "],["label","Add Facility"],["label","Add Level"],["label","Add Space"]],template:function(e,t){1&e&&(ko(0,"mat-tab-group",0),Lo("selectedIndexChange",(function(e){return t.siteonboardingservice.selectedtab=e})),ko(1,"mat-tab",1),Io(2,"app-addsite"),Ao(),ko(3,"mat-tab",2),Io(4,"app-add-facility"),Ao(),ko(5,"mat-tab",3),Io(6,"app-add-floor"),Ao(),ko(7,"mat-tab",4),Io(8,"app-add-space"),Ao(),Ao()),2&e&&Po("selectedIndex",t.siteonboardingservice.selectedtab)},directives:[XS,BS,iY,xY,RY,HY],styles:[".user[_ngcontent-%COMP%]{color:#00f}"]}),e})();const WY=["map"];function ZY(e,t){if(1&e){const e=No();ko(0,"div",10),ko(1,"div"),ko(2,"button",11),Lo("click",(function(){return Jt(e),Uo().showOccupency()})),Io(3,"img",12),Ao(),Ao(),ko(4,"div"),ko(5,"button",13),Lo("click",(function(){return Jt(e),Uo().showIAQ()})),Io(6,"img",14),Ao(),Ao(),ko(7,"div"),ko(8,"button",15),Lo("click",(function(){return Jt(e),Uo().showCameras()})),Io(9,"img",16),Ao(),Ao(),ko(10,"div"),ko(11,"button",17),Lo("click",(function(){return Jt(e),Uo().showRouters()})),Io(12,"img",18),Ao(),Ao(),Ao()}}function $Y(e,t){if(1&e){const e=No();ko(0,"button",6),Lo("click",(function(t){return Jt(e),Uo().refreshpage(t)})),ko(1,"mat-icon",19),pa(2," refresh "),Ao(),Ao()}}let XY=(()=>{class e{constructor(e,t,i,n,r){this.dialog=e,this.http=t,this.snackBar=i,this.router=n,this.siteonboarding=r,this.selectedsiteFacilities=[],this.selectedLevels=[],this.sitemarker=null,this.facilitymarker=null,this.showRefresh=!1,this.showicons=!1,this.markerLocations=[{lat:38.914764662971436,lng:-97.01461108304595},{lat:2,lng:2}],this.polygons=[],this.centeroid={type:"FeatureCollection",features:[]},this.Devicescentroid=[],this.Devicegeojson={type:"FeatureCollection",features:[]},this.sitesdata=[],this.router.events.pipe(em(e=>e instanceof Um)).subscribe(e=>{"/map"!=e.url&&this.dialog.closeAll()})}ngOnInit(){this.getAllSites(),this.getAllFacilities(),this.getAllLevels()}loadMap(e){document.getElementById("map").innerHTML="",this.map=null,this.showRefresh=!1,this.showicons=!1,this.map=new lN("map",{center:[-1.85306,52.63249],zoom:2.5,minZoom:2,pitch:6,baseLayer:new iL("base",{urlTemplate:"http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})}),this.layer=new hD("vector").setOptions({enableAltitude:!0}).addTo(this.map),document.querySelector(".maptalks-attribution").innerHTML="",console.log(this.sitesdata),this.sitesdata&&this.plotingsitemarkers(this.sitesdata)}getAllSites(){this.siteonboarding.getAllSites().subscribe(e=>{e&&(this.sitesdata=e,this.siteonboarding.saveAllsiteDetails(e),this.loadMap(this.sitesdata))})}plotingsitemarkers(e){this.selectedsiteFacilities=[],this.facilityName=null,this.sitename=null,console.log(e,":::sites:::"),e.forEach(e=>{this.sitemarker=new Ez.UIMarker(e.location.coordinates,{draggable:!1,single:!1,id:e.siteId,name:e.siteName,type:"sitemarker",content:`\n        <style>   \n        .main {\n          min-height: 50px;\n          min-width: 200px;\n          background-color: #673ab7;\n          border-radius: 8px;\n          display: flex;\n          padding: 5px;\n          box-sizing: border-box;\n          position: relative;\n      }\n      .main::after{\n          content: "";\n        position: absolute;\n        top: 100%;\n        left: 50%;\n        margin-left: -5px;\n        border-width: 5px;\n        border-width: 10px;\n        border-style: solid;\n        border-color: #673ab7 transparent transparent transparent;\n      }\n      .marker{\n          max-width: 100%; \n          display: flex;\n      }\n      \n      .image{\n          background-color: none;\n          border-radius: 5px;\n          width: 40px;\n          height: 100%;\n          margin-right: 5px;\n          flex: 1;\n      }\n      \n      .image img{\n          width: 100%;\n          height: 100%;\n          object-fit: fill;\n          border-radius: 5px;\n      }\n      \n      .info{\n          /* background-color: aquamarine; */\n          height: 100%;\n          width: 100%;\n          display: flex;\n          flex: 2;\n          flex-grow: 5;\n          flex-direction: column;\n          padding-left: 10px;\n          color:#ffff;\n\n      }\n      .title{\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        max-width: 200px;\n      }\n\n        </style>\n        <div class="marker" id='sitemarker'>\n        <div class="main">\n          <div class="image">\n          <img src='${e.fileUrl}' alt="Profile Image">\n          </div>\n          <div class="info">\n            <div class="title">${e.siteName}</div>\n            <div class="contant">&#127970;No.of Facilities: ${e.total_Facilities}</div>\n          </div>\n        </div>\n      </div>\n       \n        `}).addTo(this.map).on("click",e=>{this.siteonboarding.obtainedFacilityDetails.subscribe(t=>{console.log(e.target.options.id),t.forEach((i,n)=>{i.Site_Id==e.target.options.id&&this.selectedsiteFacilities.push(t[n])}),console.log(this.selectedsiteFacilities,"matched facilities"),this.sitename=e.target.options.name,this.gotofacilities(this.selectedsiteFacilities),e.target.remove()})})})}gotofacilities(e){this.facilitymarker=null,this.levelName=null,this.selectedLevels=[],e.forEach((e,t)=>{console.log(e.fileUrl);let i={draggable:!1,single:!1,id:e.facilityId,name:e.facilityName,type:"facilitymarker",content:`\n        <style>   \n        .main {\n          min-height: 50px;\n          min-width: 200px;\n          background-color: #673ab7;\n          border-radius: 8px;\n          display: flex;\n          padding: 5px;\n          box-sizing: border-box;\n          position: relative;\n      }\n      .main::after{\n          content: "";\n        position: absolute;\n        top: 100%;\n        left: 50%;\n        margin-left: -5px;\n        border-width: 5px;\n        border-width: 10px;\n        border-style: solid;\n        border-color: #673ab7 transparent transparent transparent;\n      }\n      .marker{\n          max-width: 100%; \n          display: flex;\n      }\n      \n      .image{\n          background-color: none;\n          border-radius: 5px;\n          width: 40px;\n          height: 100%;\n          margin-right: 5px;\n          flex: 1;\n      }\n      \n      .image img{\n          width: 100%;\n          height: 100%;\n          object-fit: fill;\n          border-radius: 5px;\n      }\n      \n      .info{\n          /* background-color: aquamarine; */\n          height: 100%;\n          width: 100%;\n          display: flex;\n          flex: 2;\n          flex-grow: 5;\n          flex-direction: column;\n          padding-left: 10px;\n          color:#ffff;\n\n      }\n      .title{\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        max-width: 200px;\n      }\n        </style>\n        <div class="marker" id='facilityMarker'>\n        <div class="main">\n          <div class="image">\n          <img src=${e.fileUrl.toString()} alt="Profile Image">\n          </div>\n          <div class="info">\n            <div class="title">${e.facilityName}</div>\n            <div class="contant">&#127970;No.Of Levels:${e.total_Levels}</div>\n          </div>\n        </div>\n      </div>      \n        `};this.facilitymarker=new Ez.UIMarker(e.facilitylocation.coordinates,i),this.facilitymarker.addTo(this.map).show(),this.facilitymarker.on("click",e=>{this.facilityName=e.target.options.name,this.sitemarker.setContent(""),this.siteonboarding.obtainedLevelDetails.subscribe(t=>{t&&(t.forEach((i,n)=>{i.Facility_Id==e.target.options.id&&this.selectedLevels.push(t[n])}),console.log(this.selectedLevels),this.getpolygonsdata(e.target._coordinate))}),this.levelName=this.selectedLevels[0].levelName,document.getElementById("facilityMarker").style.display="none",this.facilitymarker.remove()})}),this.map.animateTo({center:e[0].facilitylocation.coordinates,zoom:18,pitch:35,bearing:0},{duration:3e3})}opentoster(e,t){this.snackBar.open(e,"close",{duration:t,verticalPosition:"top"})}getspaceIdsbyId(e,t){this.Devicescentroid=[],this.showicons=!0,this.centeroid.features=[],console.log(e),this.siteonboarding.getSpacesbyId(e).subscribe(i=>{i&&(i.forEach(e=>{let i={type:"Feature"};i.properties={Altitude:t,spaceName:e.spaceName,spaceId:e.spaceId,levelId:e.Level_Id},i.geometry=e.spacelocation,this.centeroid.features.push(i),0!=e.Devices.lenght&&e.Devices.forEach(e=>{this.Devicescentroid.push(e)})}),this.addSpacenamestomap(t,e))}),this.layer.getGeometries().forEach((t,i)=>{"Polygon"!=t.type&&"Point"!=t.type||t.properties.levelId===e||this.layer.getGeometries()[i].setOptions({visible:!1})})}addSpacenamestomap(e,t){this.centeroid.features.forEach((e,t)=>{this.layer.setOptions({enableAltitude:!0}).addGeometry(new MN(e.geometry.coordinates,{symbol:[{markerWidth:18,markerHeight:20},{textFaceName:"sans-serif",textName:"{name}",textSize:9,textFill:"black",markerFillOpacity:1,textDy:5}],properties:{id:e.properties.spaceId,levelId:e.properties.levelId,name:e.properties.spaceName,altitude:e.properties.Altitude,visible:!0}}))}),this.Devicescentroid.forEach(i=>{let n={type:"Feature"};n.properties={Altitude:e,spaceId:i.Space_Id,levelId:t,deviceType:i.deviceType},n.geometry=i.devicelocation,this.Devicegeojson.features.push(n)}),console.log(this.Devicegeojson),this.plottingdeviceMarkers()}plottingdeviceMarkers(){console.log(this.Devicegeojson),this.Devicegeojson.features.forEach(e=>{console.log(e,"device objects");var t="";"Occupency"==e.properties.deviceType?t="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-user-groups-80.png":"IAQ"==e.properties.deviceType?t="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/IAQ.png":"IoT Cam"==e.properties.deviceType?t="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/camera marker.png":"Router"==e.properties.deviceType&&(t="https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-router-50.png"),this.layer.setOptions({enableAltitude:!0}).addGeometry(new MN(e.geometry.coordinates,{symbol:[{markerFile:t,markerWidth:40,markerHeight:30,markerDx:0,markerDy:0,markerOpacity:1,markerRotation:0},{textFaceName:"sans-serif",textName:"{deviceType}",textSize:10,textDy:14}],properties:{id:e.properties.spaceId,levelId:e.properties.levelId,deviceType:e.properties.deviceType,altitude:e.properties.Altitude}}).setOptions({visible:!1}))})}getpolygonsdata(e){let t="";this.selectedLevels.sort((function(e,t){return new Date(e.createdAt).getTime()>new Date(t.createdAt).getTime()?1:-1})),console.log(this.selectedLevels,"this.selectedLevels"),this.selectedLevels.forEach((i,n)=>{t=i.fileUrl.includes(".geojson")?this.selectedLevels[n].fileUrl:`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.sitename}/${this.facilityName.replace(/\s+/g,"")}/${i.levelName.replace(/\s+/g,"")}/geojson/${i.levelName.replace(/\s+/g,"")+".geojson"}`,this.createpolygons(t,n),this.map.animateTo({center:e,zoom:20.5,pitch:55,bearing:0},{duration:1e3}),this.facilitymarker.remove()})}createpolygons(e,t){console.log(e),this.http.get(String(e)).subscribe(e=>{var i;this.showRefresh=!0,console.log(e,"geojson data"),e.features.forEach(e=>{"Polygon"==e.geometry.type?i=e.geometry.coordinates:"MultiPolygon"==e.geometry.type&&(i=e.geometry.coordinates[0][0]),this.layer.setOptions({enableAltitude:!0}).addGeometry(new EN(i,{visible:!0,editable:!0,cursor:"pointer",draggable:!1,dragShadow:!1,drawOnAxis:null,symbol:{lineColor:"#34495e",lineWidth:.5,polygonFill:"rgb(135,196,240)",polygonOpacity:.6},properties:{id:e.properties.levelId,levelId:e.properties.levelId,name:e.properties.levelId,altitude:4*t,visible:!0}}).on("click",e=>{console.log(e),this.focuspoint=e.coordinate,this.getspaceIdsbyId(e.target.properties.id,e.target.properties.altitude),this.map.animateTo({center:e.coordinate,zoom:23,pitch:0,bearing:0},{duration:1e3}),this.map.removeBaseLayer()}).on("contextmenu",e=>{console.log(e),this.layer.getGeometries().forEach((e,t)=>{"Point"==e.type&&e.properties.deviceType?this.layer.getGeometries()[t].setOptions({visible:!1}):"Polygon"==e.type&&e.setOptions({visible:!0})}),this.map.animateTo({center:e.coordinate,zoom:21,pitch:55,bearing:0},{duration:1e3})}))})})}getAllLevels(){this.siteonboarding.getAllLevels().subscribe(e=>{e&&this.siteonboarding.saveAllLevelDetails(e)})}getAllFacilities(){this.siteonboarding.getAllFacilities().subscribe(e=>{e&&this.siteonboarding.saveAllFacilityDetails(e)})}refreshpage(e){this.map.removeLayer("vector"),this.ngOnInit()}openDailog(e){this.dialog.open(GY,{closeOnNavigation:!0,autoFocus:!0,data:e})}showOccupency(){this.layer.getGeometries().forEach((e,t)=>{"Point"==e.type&&e.properties.deviceType&&"Occupency"==e.properties.deviceType?this.layer.getGeometries()[t].setOptions({visible:!0}):"Point"==e.type&&e.properties.deviceType&&"Occupency"!==e.properties.deviceType&&this.layer.getGeometries()[t].setOptions({visible:!1})}),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()-1,pitch:0,bearing:0},{duration:1e3})}showIAQ(){this.layer.getGeometries().forEach((e,t)=>{"Point"==e.type&&e.properties.deviceType&&"IAQ"==e.properties.deviceType?this.layer.getGeometries()[t].setOptions({visible:!0}):"Point"==e.type&&e.properties.deviceType&&"IAQ"!==e.properties.deviceType&&this.layer.getGeometries()[t].setOptions({visible:!1})}),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()+1,pitch:0,bearing:0},{duration:1e3})}showCameras(){this.layer.getGeometries().forEach((e,t)=>{"Point"==e.type&&e.properties.deviceType&&"IoT Cam"==e.properties.deviceType?this.layer.getGeometries()[t].setOptions({visible:!0}):"Point"==e.type&&e.properties.deviceType&&"IoT Cam"!==e.properties.deviceType&&this.layer.getGeometries()[t].setOptions({visible:!1})}),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()-1,pitch:0,bearing:0},{duration:1e3})}showRouters(){this.layer.getGeometries().forEach((e,t)=>{"Point"==e.type&&e.properties.deviceType&&"Router"==e.properties.deviceType?this.layer.getGeometries()[t].setOptions({visible:!0}):"Point"==e.type&&e.properties.deviceType&&"Router"!==e.properties.deviceType&&this.layer.getGeometries()[t].setOptions({visible:!1})}),this.map.animateTo({center:this.focuspoint,zoom:this.map.getZoom()+1,pitch:0,bearing:0},{duration:1e3})}}return e.\u0275fac=function(t){return new(t||e)(So(kT),So(jx),So(FB),So(i_),So(PB))},e.\u0275cmp=ft({type:e,selectors:[["app-map"]],viewQuery:function(e,t){var i;1&e&&Wl(WY,!0),2&e&&Hl(i=Yl())&&(t.mapContainer=i.first)},decls:11,vars:2,consts:[[1,"row"],[1,"col-lg-12"],["id","map"],["id","state-legend","class","legend",4,"ngIf"],["id","buttongrouping",1,"buttongrouping"],[1,"example-button-container"],["mat-fab","","color","primary",3,"click"],["matTooltip","Add building","matTooltipPosition","right"],["mat-fab","","color","primary",3,"click",4,"ngIf"],[1,"name"],["id","state-legend",1,"legend"],["matTooltip","Occupancy","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/icons8-user-groups-80.png","alt","",1,"icon"],["matTooltip","IAQ","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/IAQ.png","alt","",1,"icon"],["matTooltip","IOT Camera","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","../../../assets/camera marker.png","alt","",1,"icon"],["matTooltip","Routers","mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["src","https://storagesmartroute27.blob.core.windows.net/filesupload/Markers/icons8-router-50.png","alt","",1,"icon"],["matTooltip","Refresh","matTooltipPosition","right"]],template:function(e,t){1&e&&(ko(0,"div",0),ko(1,"div",1),Io(2,"div",2),wo(3,ZY,13,0,"div",3),ko(4,"div",4),ko(5,"div",5),ko(6,"button",6),Lo("click",(function(e){return t.openDailog(e)})),ko(7,"mat-icon",7),pa(8," domain "),Ao(),Ao(),wo(9,$Y,3,0,"button",8),Ao(),Io(10,"div",9),Ao(),Ao(),Ao()),2&e&&(gr(3),Po("ngIf",t.showicons),gr(6),Po("ngIf",t.showRefresh))},directives:[Ph,dS,gb,rS],styles:['@import url("https://unpkg.com/maptalks/dist/maptalks.css");#map[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}.maptalks-attribution[_ngcontent-%COMP%]{display:none}.buttongrouping[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:100}.text_marker[_ngcontent-%COMP%]{font:30px bold sans-serif;color:#34495e;text-shadow:2px 0 #fff;width:160px}.legend[_ngcontent-%COMP%]{background-color:rgba(131,104,178,.7333333333333333);border-radius:50px;width:auto;bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.1);justify-items:center;font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;padding:10px;position:absolute;right:10px;z-index:1;display:grid}.legend[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:40px;height:40px}.legend[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-radius:50%;display:inline-block;padding:10px;height:30px;margin:5px;width:30px}.example-button-container[_ngcontent-%COMP%]{display:grid;justify-content:space-around;width:120px;padding:auto}']}),e})(),KY=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ft({type:e,selectors:[["app-occupency"]],decls:2,vars:0,template:function(e,t){1&e&&(ko(0,"p"),pa(1," occupency works! "),Ao())},encapsulation:2}),e})(),YY=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ft({type:e,selectors:[["app-maintenance"]],decls:2,vars:0,template:function(e,t){1&e&&(ko(0,"p"),pa(1," maintenance works! "),Ao())},encapsulation:2}),e})();var JY=i("4ZJM"),QY=i("iFvi");let eJ=(()=>{class e{constructor(e,t,i){this.route=e,this.dialog=t,this.maplocationservice=i,this.facilityLocation=[],this.routeparams=this.route.snapshot.paramMap.get("id"),1==this.routeparams?(this.formelement=iY,this.maplocationservice.addSiteData.subscribe(e=>{this.formdata=e})):2==this.routeparams?(this.formelement=xY,this.maplocationservice.locateFacility.subscribe(e=>{this.facilityLocation=e}),this.maplocationservice.addFacilityData.subscribe(e=>{console.log(e,"::facility params"),this.formdata=e})):3==this.routeparams&&(this.formelement=RY)}ngOnInit(){let e=0==this.facilityLocation.length?0:19,t=0==this.facilityLocation.length?[-24,42]:this.facilityLocation;JY.accessToken="pk.eyJ1IjoidmlrYXMtc3dhbXkiLCJhIjoiY2t3eWticmc1MG5yZjM0cXR3czBheDMyeCJ9.ROb_2S1Qd_47JhnT_x6xMQ";const i=new JY.Map({container:"mapa-mapbox",style:"mapbox://styles/mapbox/streets-v12",center:t,zoom:e});var n=this,r=new JY.Marker({draggable:!0,color:"red",scale:.8,pitchAlignment:"auto",rotationAlignment:"auto"});1!=this.routeparams&&2!=this.routeparams||(i.once("dblclick",(function(e){var t=e.lngLat;n.formdata.lan=t.lng,n.formdata.lat=t.lat,console.log("Lng:",t.lng,"Lat:",t.lat),r.setLngLat(t).addTo(i),n.opendialog()})),r.on("dragend",(function(){const e=r.getLngLat();console.log(e,"lngLat"),n.formdata.lan=e.lng,n.formdata.lat=e.lat,n.opendialog()}))),1==this.routeparams&&i.addControl(new QY({accessToken:JY.accessToken,mapboxgl:JY}))}opendialog(){console.log(this.formdata,"openDialog"),this.maplocationservice.addsitevalues(this.formdata),this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{left:"100px",top:"0px"}})}}return e.\u0275fac=function(t){return new(t||e)(So($f),So(kT),So(XK))},e.\u0275cmp=ft({type:e,selectors:[["app-airquaility"]],decls:3,vars:0,consts:[[1,"row"],[1,"col-md-12"],["id","mapa-mapbox"]],template:function(e,t){1&e&&(ko(0,"div",0),ko(1,"div",1),Io(2,"div",2),Ao(),Ao())},styles:["#mapa-mapbox[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}"]}),e})();const tJ=["search"];function iJ(e,t){1&e&&(ko(0,"div",4),Io(1,"input",5,6),Ao())}let nJ=(()=>{class e{constructor(e,t,i,n){this.route=e,this.dialog=t,this.maplocationservice=i,this.ngZone=n,this.entries=[],this.facilityLocation=[],this.routeparams=this.route.snapshot.paramMap.get("id"),1==this.routeparams?(this.formelement=iY,this.maplocationservice.addSiteData.subscribe(e=>{console.log(e,"::::addsite formdata::::"),this.formdata=e})):2==this.routeparams&&(this.formelement=xY,this.maplocationservice.locateFacility.subscribe(e=>{this.facilityLocation=e}),this.maplocationservice.addFacilityData.subscribe(e=>{this.formdata=e}))}ngOnInit(){this.maplocationservice.api.then(e=>{this.initAutocomplete(e)}),this.initmap()}initmap(){let e=0==this.facilityLocation.length?3:19,t=0==this.facilityLocation.length?[-1.85306,52.63249]:this.facilityLocation;document.getElementById("mapa-mapbox").innerHTML="",this.map=null,this.map=new lN("mapa-mapbox",{center:t,zoom:e,minZoom:2,pitch:6,baseLayer:new iL("base",{urlTemplate:"http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})}),document.querySelector(".maptalks-attribution").innerHTML="",new hD("vector").setOptions({editable:!0}).addTo(this.map),2==this.routeparams&&this.map.once("click",e=>{new MN(e.coordinate,{draggable:!0}).addTo(this.map.getLayer("vector")).on("dragend",e=>{const t=e.coordinate;this.formdata[0].lan=t.x,this.formdata[0].lat=t.y,console.log(this.formdata[0]),this.opendialog()});const t=e.coordinate;this.formdata[0].lan=t.x,this.formdata[0].lat=t.y,console.log(this.formdata[0]),this.opendialog()})}initAutocomplete(e){let t=new e.places.Autocomplete(this.searchElementRef.nativeElement);t.addListener("place_changed",()=>{this.ngZone.run(()=>{this.onPlaceChange(t.getPlace())})})}onPlaceChange(e){const t=this.locationFromPlace(e);this.entries.unshift({place:e,location:t}),console.log([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],"lnglat"),this.map.setCenterAndZoom([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],21),new MN([this.entries[0].location.coordinates.longitude,this.entries[0].location.coordinates.latitude],{draggable:!0}).addTo(this.map.getLayer("vector")).addEventListener("dragend",e=>{console.log(e,"afterdraging");const t=e.coordinate;this.formdata[0].lan=t.x,this.formdata[0].lat=t.y,console.log(this.formdata[0]),this.opendialog()})}locationFromPlace(e){const t=e.address_components;if(void 0===t)return null;const i=oJ(t,"administrative_area_level_3"),n=sJ(t,"locality")||i,r=sJ(t,"country"),s=oJ(t,"country"),o=oJ(t,"administrative_area_level_1"),a=e.name!==n?e.name:null,l={latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()};return{name:a,cityName:n,countryName:r,countryCode:s,stateCode:o,bounds:e.geometry.viewport.toJSON(),coordinates:l}}opendialog(){1==this.routeparams?this.maplocationservice.addsitevalues(this.formdata):2==this.routeparams&&this.maplocationservice.addFacilityvalues(this.formdata),this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{left:"100px",top:"0px"}})}}return e.\u0275fac=function(t){return new(t||e)(So($f),So(kT),So(XK),So(Cc))},e.\u0275cmp=ft({type:e,selectors:[["app-geo-referencing-map"]],viewQuery:function(e,t){var i;1&e&&Wl(tJ,!0),2&e&&Hl(i=Yl())&&(t.searchElementRef=i.first)},decls:4,vars:1,consts:[[1,"row"],[1,"col-md-12"],["id","search",4,"ngIf"],["id","mapa-mapbox"],["id","search"],["placeholder","search for location","autocorrect","off","autocapitalize","off","spellcheck","off","type","text",1,"form-control"],["search",""]],template:function(e,t){1&e&&(ko(0,"div",0),ko(1,"div",1),wo(2,iJ,3,0,"div",2),Io(3,"div",3),Ao(),Ao()),2&e&&(gr(2),Po("ngIf",1==t.routeparams))},directives:[Ph],styles:["#mapa-mapbox[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{font-family:Lato}dl[_ngcontent-%COMP%]{font-size:13px}dl[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{padding:0 3px;border:1px solid #ccc;white-space:nowrap}input[type=text][_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;width:300px;padding:5px;height:20px;border-radius:5px 0 0 5px;outline:none;color:#9dbfaf}table[_ngcontent-%COMP%]{margin:10px 0;border:1px solid red}code[_ngcontent-%COMP%], dt[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-family:Source Code Pro;font-size:12px}"]}),e})();function rJ(e,t){return e.filter(e=>e.types[0]===t)[0]}function sJ(e,t){const i=rJ(e,t);return i&&i.long_name}function oJ(e,t){const i=rJ(e,t);return i&&i.short_name}function aJ(e){const{subscriber:t,counter:i,period:n}=e;t.next(i),this.schedule({subscriber:t,counter:i+1,period:n},n)}function lJ(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function cJ(e,t){const i=t?"":"none";lJ(e.style,{touchAction:t?"":"none",webkitUserDrag:t?"":"none",webkitTapHighlightColor:t?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function hJ(e){const t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function uJ(e,t){return e.getPropertyValue(t).split(",").map(e=>e.trim())}function dJ(e){const t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}}function pJ(e,t,i){const{top:n,bottom:r,left:s,right:o}=e;return i>=n&&i<=r&&t>=s&&t<=o}function mJ(e,t,i){e.top+=t,e.bottom=e.top+e.height,e.left+=i,e.right=e.left+e.width}function fJ(e,t,i,n){const{top:r,right:s,bottom:o,left:a,width:l,height:c}=e,h=l*t,u=c*t;return n>r-u&&n<o+u&&i>a-h&&i<s+h}class gJ{constructor(e,t){this._document=e,this._viewportRuler=t,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),e.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:dJ(e)})})}handleScroll(e){const t=e.target,i=this.positions.get(t);if(!i)return null;const n=t===this._document?t.documentElement:t,r=i.scrollPosition;let s,o;if(t===this._document){const e=this._viewportRuler.getViewportScrollPosition();s=e.top,o=e.left}else s=t.scrollTop,o=t.scrollLeft;const a=r.top-s,l=r.left-o;return this.positions.forEach((e,i)=>{e.clientRect&&t!==i&&n.contains(i)&&mJ(e.clientRect,a,l)}),r.top=s,r.left=o,{top:a,left:l}}}const _J=L_({passive:!0}),yJ=L_({passive:!1});class vJ{constructor(e,t,i,n,r,s){this._config=t,this._document=i,this._ngZone=n,this._viewportRuler=r,this._dragDropRegistry=s,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new T,this._pointerMoveSubscription=d.EMPTY,this._pointerUpSubscription=d.EMPTY,this._scrollSubscription=d.EMPTY,this._resizeSubscription=d.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new T,this.started=new T,this.released=new T,this.ended=new T,this.entered=new T,this.exited=new T,this.dropped=new T,this.moved=this._moveEvents.asObservable(),this._pointerDown=e=>{if(this.beforeStarted.next(),this._handles.length){const t=this._handles.find(t=>{const i=e.target;return!!i&&(i===t||t.contains(i))});!t||this._disabledHandles.has(t)||this.disabled||this._initializeDragSequence(t,e)}else this.disabled||this._initializeDragSequence(this._rootElement,e)},this._pointerMove=e=>{e.preventDefault();const t=this._getPointerPositionOnPage(e);if(!this._hasStartedDragging){if(Math.abs(t.x-this._pickupPositionOnPage.x)+Math.abs(t.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){if(!(Date.now()>=this._dragStartTime+this._getDragStartDelay(e)))return void this._endDragSequence(e);this._dropContainer&&this._dropContainer.isDragging()||(this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(e)))}return}this._boundaryElement&&(this._previewRect&&(this._previewRect.width||this._previewRect.height)||(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()));const i=this._getConstrainedPointerPosition(t);if(this._hasMoved=!0,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i);else{const e=this._activeTransform;e.x=i.x-this._pickupPositionOnPage.x+this._passiveTransform.x,e.y=i.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(e.x,e.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${e.x} ${e.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:e,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})},this._pointerUp=e=>{this._endDragSequence(e)},this.withRootElement(e),this._parentPositions=new gJ(i,r),s.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){const t=j_(e);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions())}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){return this._handles=e.map(e=>H_(e)),this._handles.forEach(e=>cJ(e,!1)),this._toggleNativeDragInteractions(),this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=H_(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,yJ),t.addEventListener("touchstart",this._pointerDown,_J)}),this._initialTransform=void 0,this._rootElement=t),this}withBoundaryElement(e){return this._boundaryElement=e?H_(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&CJ(this._rootElement),CJ(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){this._handles.indexOf(e)>-1&&this._disabledHandles.add(e)}enableHandle(e){this._disabledHandles.delete(e)}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}_sortFromLastPointerPosition(){const e=this._pointerPositionAtLastDirectionChange;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e))}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&CJ(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&CJ(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(e))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(e){this.started.next({source:this}),SJ(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const e=this._rootElement,n=e.parentNode,r=this._preview=this._createPreviewElement(),s=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment("");n.insertBefore(o,e),e.style.display="none",this._document.body.appendChild(n.replaceChild(s,e)),(i=this._document,i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body).appendChild(r),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this._initialContainer=this._initialIndex=void 0;var i;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(e,t){t.stopPropagation();const i=this.isDragging(),n=SJ(t),r=!n&&0!==t.button,s=this._rootElement,o=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(t.target&&t.target.draggable&&"mousedown"===t.type&&t.preventDefault(),i||r||o)return;this._handles.length&&(this._rootElementTapHighlight=s.style.webkitTapHighlightColor,s.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(e=>{this._updateOnScroll(e)}),this._boundaryElement&&(this._boundaryRect=dJ(this._boundaryElement));const a=this._previewTemplate;this._pickupPositionInElement=a&&a.template&&!a.matchSize?{x:0,y:0}:this._getPointerPositionInElement(e,t);const l=this._pickupPositionOnPage=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:l.x,y:l.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),n=this._getPointerPositionOnPage(e),r=this._getDragDistance(this._getPointerPositionOnPage(e)),s=t._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:r}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:r}),t.drop(this,i,this._initialContainer,s,r,this._initialIndex),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t}){let i=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!i&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(i=this._initialContainer),i&&i!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=i,this._dropContainer.enter(this,e,t,i===this._initialContainer&&i.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:i,currentIndex:i.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(e,t),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this._preview.style.transform=xJ(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y)}_createPreviewElement(){const e=this._previewTemplate,t=this.previewClass,i=e?e.template:null;let n;if(i&&e){const t=e.matchSize?this._rootElement.getBoundingClientRect():null,r=e.viewContainer.createEmbeddedView(i,e.context);r.detectChanges(),n=EJ(r,this._document),this._previewRef=r,e.matchSize?TJ(n,t):n.style.transform=xJ(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const e=this._rootElement;n=bJ(e),TJ(n,e.getBoundingClientRect())}return lJ(n.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:""+(this._config.zIndex||1e3)}),cJ(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(e=>n.classList.add(e)):n.classList.add(t)),n}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=xJ(e.left,e.top);const t=function(e){const t=getComputedStyle(e),i=uJ(t,"transition-property"),n=i.find(e=>"transform"===e||"all"===e);if(!n)return 0;const r=i.indexOf(n),s=uJ(t,"transition-duration"),o=uJ(t,"transition-delay");return hJ(s[r])+hJ(o[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(e=>{const i=t=>{(!t||t.target===this._preview&&"transform"===t.propertyName)&&(this._preview.removeEventListener("transitionend",i),e(),clearTimeout(n))},n=setTimeout(i,1.5*t);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=EJ(this._placeholderRef,this._document)):i=bJ(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t){const i=this._rootElement.getBoundingClientRect(),n=e===this._rootElement?null:e,r=n?n.getBoundingClientRect():i,s=SJ(t)?t.targetTouches[0]:t,o=this._getViewportScrollPosition();return{x:r.left-i.left+(s.pageX-r.left-o.left),y:r.top-i.top+(s.pageY-r.top-o.top)}}_getPointerPositionOnPage(e){const t=SJ(e)?e.touches[0]||e.changedTouches[0]:e,i=this._getViewportScrollPosition();return{x:t.pageX-i.left,y:t.pageY-i.top}}_getConstrainedPointerPosition(e){const t=this.constrainPosition?this.constrainPosition(e,this):e,i=this._dropContainer?this._dropContainer.lockAxis:null;if("x"===this.lockAxis||"x"===i?t.y=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==i||(t.x=this._pickupPositionOnPage.x),this._boundaryRect){const{x:e,y:i}=this._pickupPositionInElement,n=this._boundaryRect,r=this._previewRect,s=n.top+i,o=n.bottom-(r.height-i);t.x=wJ(t.x,n.left+e,n.right-(r.width-e)),t.y=wJ(t.y,s,o)}return t}_updatePointerDirectionDelta(e){const{x:t,y:i}=e,n=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,s=Math.abs(t-r.x),o=Math.abs(i-r.y);return s>this._config.pointerDirectionChangeThreshold&&(n.x=t>r.x?1:-1,r.x=t),o>this._config.pointerDirectionChangeThreshold&&(n.y=i>r.y?1:-1,r.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,cJ(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,yJ),e.removeEventListener("touchstart",this._pointerDown,_J)}_applyRootElementTransform(e,t){const i=xJ(e,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),n=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===n.width&&0===n.height)return;const r=i.left-n.left,s=n.right-i.right,o=i.top-n.top,a=n.bottom-i.bottom;i.width>n.width?(r>0&&(e+=r),s>0&&(e-=s)):e=0,i.height>n.height?(o>0&&(t+=o),a>0&&(t-=a)):t=0,e===this._passiveTransform.x&&t===this._passiveTransform.y||this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:SJ(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);this._boundaryRect&&t&&mJ(this._boundaryRect,t.top,t.left)}_getViewportScrollPosition(){const e=this._parentPositions.positions.get(this._document);return e?e.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}function xJ(e,t){return`translate3d(${Math.round(e)}px, ${Math.round(t)}px, 0)`}function bJ(e){const t=e.cloneNode(!0),i=t.querySelectorAll("[id]"),n=e.querySelectorAll("canvas");t.removeAttribute("id");for(let r=0;r<i.length;r++)i[r].removeAttribute("id");if(n.length){const e=t.querySelectorAll("canvas");for(let t=0;t<n.length;t++){const i=e[t].getContext("2d");i&&i.drawImage(n[t],0,0)}}return t}function wJ(e,t,i){return Math.max(t,Math.min(i,e))}function CJ(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function SJ(e){return"t"===e.type[0]}function EJ(e,t){const i=e.rootNodes;if(1===i.length&&i[0].nodeType===t.ELEMENT_NODE)return i[0];const n=t.createElement("div");return i.forEach(e=>n.appendChild(e)),n}function TJ(e,t){e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.transform=xJ(t.left,t.top)}function PJ(e,t,i){const n=MJ(t,e.length-1),r=MJ(i,e.length-1);if(n===r)return;const s=e[n],o=r<n?-1:1;for(let a=n;a!==r;a+=o)e[a]=e[a+o];e[r]=s}function MJ(e,t){return Math.max(0,Math.min(t,e))}class kJ{constructor(e,t,i,n,r){this._dragDropRegistry=t,this._ngZone=n,this._viewportRuler=r,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=()=>!0,this.beforeStarted=new T,this.entered=new T,this.exited=new T,this.dropped=new T,this.sorted=new T,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=d.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new T,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(e=0,t=iy){return(!sy(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=iy),new b(i=>(i.add(t.schedule(aJ,e,{subscriber:i,counter:0,period:e})),i))}(0,J_).pipe(cy(this._stopScrollTimers)).subscribe(()=>{const e=this._scrollNode;1===this._verticalScrollDirection?IJ(e,-2):2===this._verticalScrollDirection&&IJ(e,2),1===this._horizontalScrollDirection?RJ(e,-2):2===this._horizontalScrollDirection&&RJ(e,2)})},this.element=H_(e),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new gJ(i,r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){const e=H_(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach(e=>e._startReceiving(this)),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}enter(e,t,i,n){let r;this.start(),null==n?(r=this.sortingDisabled?this._draggables.indexOf(e):-1,-1===r&&(r=this._getItemIndexFromPointerPosition(e,t,i))):r=n;const s=this._activeDraggables,o=s.indexOf(e),a=e.getPlaceholderElement();let l=s[r];if(l===e&&(l=s[r+1]),o>-1&&s.splice(o,1),l&&!this._dragDropRegistry.isDragging(l)){const t=l.getRootElement();t.parentElement.insertBefore(a,t),s.splice(r,0,e)}else{const n=H_(this.element);this._shouldEnterAsFirstChild(t,i)?(n.insertBefore(a,s[0].getRootElement()),s.unshift(e)):(n.appendChild(a),s.push(e))}a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,n,r,s){this._reset(),null==s&&(s=i.getItemIndex(e)),this.dropped.next({item:e,currentIndex:t,previousIndex:s,container:this,previousContainer:i,isPointerOverContainer:n,distance:r})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(e=>e._withDropContainer(this)),this.isDragging()&&(t.filter(e=>e.isDragging()).every(t=>-1===e.indexOf(t))?this._reset():this._cacheItems()),this}withDirection(e){return this._direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._orientation=e,this}withScrollableParents(e){const t=H_(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?AJ("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,t=>t.drag===e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,n){if(this.sortingDisabled||!fJ(this._clientRect,.05,t,i))return;const r=this._itemPositions,s=this._getItemIndexFromPointerPosition(e,t,i,n);if(-1===s&&r.length>0)return;const o="horizontal"===this._orientation,a=AJ(r,t=>t.drag===e),l=r[s],c=r[a].clientRect,h=l.clientRect,u=a>s?1:-1;this._previousSwap.drag=l.drag,this._previousSwap.delta=o?n.x:n.y;const d=this._getItemOffsetPx(c,h,u),p=this._getSiblingOffsetPx(a,r,u),m=r.slice();PJ(r,a,s),this.sorted.next({previousIndex:a,currentIndex:s,container:this,item:e}),r.forEach((t,i)=>{if(m[i]===t)return;const n=t.drag===e,r=n?d:p,s=n?e.getPlaceholderElement():t.drag.getRootElement();t.offset+=r,o?(s.style.transform=`translate3d(${Math.round(t.offset)}px, 0, 0)`,mJ(t.clientRect,0,r)):(s.style.transform=`translate3d(0, ${Math.round(t.offset)}px, 0)`,mJ(t.clientRect,r,0))})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,n=0,r=0;if(this._parentPositions.positions.forEach((s,o)=>{o!==this._document&&s.clientRect&&!i&&fJ(s.clientRect,.05,e,t)&&([n,r]=function(e,t,i,n){const r=OJ(t,n),s=NJ(t,i);let o=0,a=0;if(r){const t=e.scrollTop;1===r?t>0&&(o=1):e.scrollHeight-t>e.clientHeight&&(o=2)}if(s){const t=e.scrollLeft;1===s?t>0&&(a=1):e.scrollWidth-t>e.clientWidth&&(a=2)}return[o,a]}(o,s.clientRect,e,t),(n||r)&&(i=o))}),!n&&!r){const{width:s,height:o}=this._viewportRuler.getViewportSize(),a={width:s,height:o,top:0,right:s,bottom:o,left:0};n=OJ(a,t),r=NJ(a,e),i=window}!i||n===this._verticalScrollDirection&&r===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=n,this._horizontalScrollDirection=r,this._scrollNode=i,(n||r)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_cacheParentPositions(){const e=H_(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}_cacheItemPositions(){const e="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(e=>{const t=e.getVisibleElement();return{drag:e,offset:0,clientRect:dJ(t)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const e=H_(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(e=>{const t=e.getRootElement();t&&(t.style.transform="")}),this._siblings.forEach(e=>e._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(e,t,i){const n="horizontal"===this._orientation,r=t[e].clientRect,s=t[e+-1*i];let o=r[n?"width":"height"]*i;if(s){const e=n?"left":"top",t=n?"right":"bottom";-1===i?o-=s.clientRect[e]-r[t]:o+=r[e]-s.clientRect[t]}return o}_getItemOffsetPx(e,t,i){const n="horizontal"===this._orientation;let r=n?t.left-e.left:t.top-e.top;return-1===i&&(r+=n?t.width-e.width:t.height-e.height),r}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,n="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const r=i[i.length-1].clientRect;return n?e>=r.right:t>=r.bottom}{const r=i[0].clientRect;return n?e<=r.left:t<=r.top}}_getItemIndexFromPointerPosition(e,t,i,n){const r="horizontal"===this._orientation;return AJ(this._itemPositions,({drag:s,clientRect:o},a,l)=>{if(s===e)return l.length<2;if(n){const e=r?n.x:n.y;if(s===this._previousSwap.drag&&e===this._previousSwap.delta)return!1}return r?t>=Math.floor(o.left)&&t<Math.floor(o.right):i>=Math.floor(o.top)&&i<Math.floor(o.bottom)})}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(e,t){return pJ(this._clientRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(n=>n._canReceive(e,t,i))}_canReceive(e,t,i){if(!pJ(this._clientRect,t,i)||!this.enterPredicate(e,this))return!1;const n=this._getShadowRoot().elementFromPoint(t,i);if(!n)return!1;const r=H_(this.element);return n===r||r.contains(n)}_startReceiving(e){const t=this._activeSiblings;t.has(e)||(t.add(e),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&(this._itemPositions.forEach(({clientRect:e})=>{mJ(e,t.top,t.left)}),this._itemPositions.forEach(({drag:e})=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=F_(H_(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}}function AJ(e,t){for(let i=0;i<e.length;i++)if(t(e[i],i,e))return i;return-1}function IJ(e,t){e===window?e.scrollBy(0,t):e.scrollTop+=t}function RJ(e,t){e===window?e.scrollBy(t,0):e.scrollLeft+=t}function OJ(e,t){const{top:i,bottom:n,height:r}=e,s=.05*r;return t>=i-s&&t<=i+s?1:t>=n-s&&t<=n+s?2:0}function NJ(e,t){const{left:i,right:n,width:r}=e,s=.05*r;return t>=i-s&&t<=i+s?1:t>=n-s&&t<=n+s?2:0}const DJ=L_({passive:!1,capture:!0});let zJ=(()=>{class e{constructor(e,t){this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new T,this.pointerUp=new T,this.scroll=new T,this._preventDefaultWhileDragging=e=>{this._activeDragInstances.size&&e.preventDefault()},this._document=t}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._preventDefaultWhileDragging,DJ)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,DJ)}startDragging(e,t){if(!this._activeDragInstances.has(e)&&(this._activeDragInstances.add(e),1===this._activeDragInstances.size)){const e=t.type.startsWith("touch"),i=e?"touchend":"mouseup";this._globalListeners.set(e?"touchmove":"mousemove",{handler:e=>this.pointerMove.next(e),options:DJ}).set(i,{handler:e=>this.pointerUp.next(e),options:!0}).set("scroll",{handler:e=>this.scroll.next(e),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:DJ}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((e,t)=>{this._document.addEventListener(t,e.handler,e.options)})})}}stopDragging(e){this._activeDragInstances.delete(e),0===this._activeDragInstances.size&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances.has(e)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,t)=>{this._document.removeEventListener(t,e.handler,e.options)}),this._globalListeners.clear()}}return e.\u0275fac=function(t){return new(t||e)(Ke(Cc),Ke(th))},e.\u0275prov=de({factory:function(){return new e(Ke(Cc),Ke(th))},token:e,providedIn:"root"}),e})();const LJ={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let BJ=(()=>{class e{constructor(e,t,i,n){this._document=e,this._ngZone=t,this._viewportRuler=i,this._dragDropRegistry=n}createDrag(e,t=LJ){return new vJ(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new kJ(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return e.\u0275fac=function(t){return new(t||e)(Ke(th),Ke(Cc),Ke(vy),Ke(zJ))},e.\u0275prov=de({factory:function(){return new e(Ke(th),Ke(Cc),Ke(vy),Ke(zJ))},token:e,providedIn:"root"}),e})();const FJ=new je("CDK_DRAG_PARENT");let jJ=(()=>{class e{constructor(e,t){this.element=e,this._stateChanges=new T,this._disabled=!1,this._parentDrag=t,cJ(e.nativeElement,!1)}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e),this._stateChanges.next(this)}ngOnDestroy(){this._stateChanges.complete()}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(FJ,8))},e.\u0275dir=bt({type:e,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:["cdkDragHandleDisabled","disabled"]}}),e})(),VJ=(()=>{class e{constructor(e){this.templateRef=e}}return e.\u0275fac=function(t){return new(t||e)(So(cl))},e.\u0275dir=bt({type:e,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"}}),e})(),UJ=(()=>{class e{constructor(e){this.templateRef=e,this._matchSize=!1}get matchSize(){return this._matchSize}set matchSize(e){this._matchSize=j_(e)}}return e.\u0275fac=function(t){return new(t||e)(So(cl))},e.\u0275dir=bt({type:e,selectors:[["ng-template","cdkDragPreview",""]],inputs:{matchSize:"matchSize",data:"data"}}),e})();const qJ=new je("CDK_DRAG_CONFIG"),HJ=new je("CDK_DROP_LIST");let GJ=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l){this.element=e,this.dropContainer=t,this._document=i,this._ngZone=n,this._viewContainerRef=r,this._dir=o,this._changeDetectorRef=l,this._destroyed=new T,this.started=new Ol,this.released=new Ol,this.ended=new Ol,this.entered=new Ol,this.exited=new Ol,this.dropped=new Ol,this.moved=new b(e=>{const t=this._dragRef.moved.pipe(B(e=>({source:this,pointerPosition:e.pointerPosition,event:e.event,delta:e.delta,distance:e.distance}))).subscribe(e);return()=>{t.unsubscribe()}}),this._dragRef=a.createDrag(e,{dragStartThreshold:s&&null!=s.dragStartThreshold?s.dragStartThreshold:5,pointerDirectionChangeThreshold:s&&null!=s.pointerDirectionChangeThreshold?s.pointerDirectionChangeThreshold:5,zIndex:null==s?void 0:s.zIndex}),this._dragRef.data=this,s&&this._assignDefaults(s),t&&(this._dragRef._withDropContainer(t._dropListRef),t.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=j_(e),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.onStable.asObservable().pipe(ym(1),cy(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._handles.changes.pipe(Mm(this._handles),Nm(e=>{const t=e.filter(e=>e._parentDrag===this).map(e=>e.element);this._dragRef.withHandles(t)}),Sm(e=>$(...e.map(e=>e._stateChanges.pipe(Mm(e))))),cy(this._destroyed)).subscribe(e=>{const t=this._dragRef,i=e.element.nativeElement;e.disabled?t.disableHandle(i):t.enableHandle(i)}),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})}ngOnChanges(e){const t=e.rootElementSelector,i=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}_updateRootElement(){const e=this.element.nativeElement,t=this.rootElementSelector?WJ(e,this.rootElementSelector):e;if(t&&t.nodeType!==this._document.ELEMENT_NODE)throw Error(`cdkDrag must be attached to an element node. Currently attached to "${t.nodeName}".`);this._dragRef.withRootElement(t||e)}_getBoundaryElement(){const e=this.boundaryElement;if(!e)return null;if("string"==typeof e)return WJ(this.element.nativeElement,e);const t=H_(e);if(En()&&!t.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return t}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const t=this._dir,i=this.dragStartDelay,n=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,r=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof i&&i?i:V_(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(n).withPreviewTemplate(r),t&&e.withDirection(t.value)}})}_handleEvents(e){e.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(()=>{this.released.emit({source:this})}),e.ended.subscribe(e=>{this.ended.emit({source:this,distance:e.distance}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(e=>{this.entered.emit({container:e.container.data,item:this,currentIndex:e.currentIndex})}),e.exited.subscribe(e=>{this.exited.emit({container:e.container.data,item:this})}),e.dropped.subscribe(e=>{this.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,isPointerOverContainer:e.isPointerOverContainer,item:this,distance:e.distance})})}_assignDefaults(e){const{lockAxis:t,dragStartDelay:i,constrainPosition:n,previewClass:r,boundaryElement:s,draggingDisabled:o,rootElementSelector:a}=e;this.disabled=null!=o&&o,this.dragStartDelay=i||0,t&&(this.lockAxis=t),n&&(this.constrainPosition=n),r&&(this.previewClass=r),s&&(this.boundaryElement=s),a&&(this.rootElementSelector=a)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(HJ,12),So(th),So(Cc),So(ul),So(qJ,8),So(py,8),So(BJ),So(qs))},e.\u0275dir=bt({type:e,selectors:[["","cdkDrag",""]],contentQueries:function(e,t,i){var n;1&e&&($l(i,UJ,!0),$l(i,VJ,!0),$l(i,jJ,!0)),2&e&&(Hl(n=Yl())&&(t._previewTemplate=n.first),Hl(n=Yl())&&(t._placeholderTemplate=n.first),Hl(n=Yl())&&(t._handles=n))},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(e,t){2&e&&ia("cdk-drag-disabled",t.disabled)("cdk-drag-dragging",t._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Da([{provide:FJ,useExisting:e}]),Ea]}),e})();function WJ(e,t){let i=e.parentElement;for(;i;){if(i.matches?i.matches(t):i.msMatchesSelector(t))return i;i=i.parentElement}return null}let ZJ=(()=>{class e{constructor(){this._items=new Set,this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e)}ngOnDestroy(){this._items.clear()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:["cdkDropListGroupDisabled","disabled"]},exportAs:["cdkDropListGroup"]}),e})(),$J=0,XJ=(()=>{class e{constructor(t,i,n,r,s,o,a){this.element=t,this._changeDetectorRef=n,this._dir=r,this._group=s,this._scrollDispatcher=o,this._destroyed=new T,this.connectedTo=[],this.id="cdk-drop-list-"+$J++,this.enterPredicate=()=>!0,this.dropped=new Ol,this.entered=new Ol,this.exited=new Ol,this.sorted=new Ol,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,a&&this._assignDefaults(a),this._dropListRef.enterPredicate=(e,t)=>this.enterPredicate(e.data,t.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),s&&s._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=j_(e)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,t)=>e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=e._dropLists.indexOf(this);t>-1&&e._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}start(){this._dropListRef.start()}drop(e,t,i,n){this._dropListRef.drop(e._dragRef,t,i._dropListRef,n,{x:0,y:0})}enter(e,t,i){this._dropListRef.enter(e._dragRef,t,i)}exit(e){this._dropListRef.exit(e._dragRef)}getItemIndex(e){return this._dropListRef.getItemIndex(e._dragRef)}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe(Mm(this._dir.value),cy(this._destroyed)).subscribe(e=>t.withDirection(e)),t.beforeStarted.subscribe(()=>{const i=U_(this.connectedTo).map(t=>"string"==typeof t?e._dropLists.find(e=>e.id===t):t);if(this._group&&this._group._items.forEach(e=>{-1===i.indexOf(e)&&i.push(e)}),!this._scrollableParentsResolved&&this._scrollDispatcher){const e=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(e=>e.getElementRef().nativeElement);this._dropListRef.withScrollableParents(e),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=j_(this.sortingDisabled),t.autoScrollDisabled=j_(this.autoScrollDisabled),t.connectedTo(i.filter(e=>e&&e!==this).map(e=>e._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(e=>{this.entered.emit({container:this,item:e.item.data,currentIndex:e.currentIndex})}),e.exited.subscribe(e=>{this.exited.emit({container:this,item:e.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(e=>{this.sorted.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,container:this,item:e.item.data})}),e.dropped.subscribe(e=>{this.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,item:e.item.data,isPointerOverContainer:e.isPointerOverContainer,distance:e.distance}),this._changeDetectorRef.markForCheck()})}_assignDefaults(e){const{lockAxis:t,draggingDisabled:i,sortingDisabled:n,listAutoScrollDisabled:r,listOrientation:s}=e;this.disabled=null!=i&&i,this.sortingDisabled=null!=n&&n,this.autoScrollDisabled=null!=r&&r,this.orientation=s||"vertical",t&&(this.lockAxis=t)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(BJ),So(qs),So(py,8),So(ZJ,12),So(_y),So(qJ,8))},e.\u0275dir=bt({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(e,t){2&e&&(ga("id",t.id),ia("cdk-drop-list-disabled",t.disabled)("cdk-drop-list-dragging",t._dropListRef.isDragging())("cdk-drop-list-receiving",t._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Da([{provide:ZJ,useValue:void 0},{provide:HJ,useExisting:e}])]}),e._dropLists=[],e})(),KJ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[BJ],imports:[xy]}),e})();function YJ(e,t){if(1&e&&(ko(0,"mat-option",14),pa(1),Ao()),2&e){const e=t.$implicit;Po("value",e),gr(1),ma(e)}}function JJ(e,t){1&e&&(ko(0,"div"),pa(1,"facility name is required"),Ao())}function QJ(e,t){if(1&e&&(ko(0,"div",15),wo(1,JJ,2,0,"div",16),Ao()),2&e){Uo();const e=Co(8);gr(1),Po("ngIf",e.errors.required)}}function eQ(e,t){1&e&&(ko(0,"div"),pa(1,"Level name is required"),Ao())}function tQ(e,t){if(1&e&&(ko(0,"div",15),wo(1,eQ,2,0,"div",16),Ao()),2&e){Uo();const e=Co(16);gr(1),Po("ngIf",e.errors.required)}}const iQ=function(e){return{"is-invalid":e}};let nQ=(()=>{class e{constructor(e,t,i){this.siteonboarding=e,this.snackBar=t,this.dialog=i,this.form={Site_Id:"",Facility_Id:"",Levle_Id:"",Space_Id:"",deviceType:"",deviceId:"",devicelocation:""},this.DevicesTypes=["Occupency","IAQ","IoT Cam","Router"],this.siteonboarding.obtainedDeviceDetails.subscribe(e=>{console.log(e,"add device component"),this.form.Site_Id=e[0].properties.Site_Id,this.form.Facility_Id=e[0].properties.Facility_Id,this.form.Levle_Id=e[0].properties.Level_Id,this.form.Space_Id=e[0].properties.spaceId,this.form.devicelocation=JSON.stringify(e[0].geometry)})}ngOnInit(){}onSubmit(){this.siteonboarding.adddevices(this.form).subscribe(e=>{console.log(e),Object.entries(e)?(this.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),this.dialog.closeAll()):this.snackBar.open("Failed","Retry",{duration:3e3,verticalPosition:"top"})})}selectedDevice(e){this.form.deviceType=e}onReset(e){e.reset()}}return e.\u0275fac=function(t){return new(t||e)(So(PB),So(FB),So(kT))},e.\u0275cmp=ft({type:e,selectors:[["app-add-device"]],decls:23,vars:13,consts:[[1,"register-form"],["name","form"],["f","ngForm"],[1,"form-group"],["appearance","outline"],["name","deviceType","required","",1,"form-control",3,"ngModel","ngClass","selectionChange","ngModelChange"],["deviceType","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["matInput","","type","text","name","deviceID","required","",1,"form-control",3,"disabled","ngModel","ngClass","ngModelChange"],["deviceID","ngModel"],[1,"buttongroup"],["type","submit","color","primary","mat-raised-button","",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],[3,"value"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=No();ko(0,"div",0),ko(1,"form",1,2),ko(3,"div",3),ko(4,"label"),pa(5,"Device Type"),Ao(),ko(6,"mat-form-field",4),ko(7,"mat-select",5,6),Lo("selectionChange",(function(){Jt(e);const i=Co(8);return t.selectedDevice(i.value)}))("ngModelChange",(function(e){return t.form.deviceType=e})),wo(9,YJ,2,2,"mat-option",7),Ao(),Ao(),wo(10,QJ,2,1,"div",8),Ao(),ko(11,"div",3),ko(12,"label"),pa(13,"Device Id"),Ao(),ko(14,"mat-form-field",4),ko(15,"input",9,10),Lo("ngModelChange",(function(e){return t.form.deviceId=e})),Ao(),Ao(),wo(17,tQ,2,1,"div",8),Ao(),ko(18,"div",11),ko(19,"button",12),Lo("click",(function(){return t.onSubmit()})),pa(20,"Submit"),Ao(),ko(21,"button",13),Lo("click",(function(){Jt(e);const i=Co(2);return t.onReset(i)})),pa(22," Reset "),Ao(),Ao(),Ao(),Ao()}if(2&e){const e=Co(2),i=Co(8),n=Co(16);gr(7),Po("ngModel",t.form.deviceType)("ngClass",kl(9,iQ,e.submitted&&i.errors)),gr(2),Po("ngForOf",t.DevicesTypes),gr(1),Po("ngIf",e.submitted&&i.errors),gr(5),Po("disabled",!t.form.deviceType)("ngModel",t.form.deviceId)("ngClass",kl(11,iQ,e.submitted&&n.errors)),gr(2),Po("ngIf",e.submitted&&n.errors),gr(2),Po("disabled",!t.form.deviceId)}},directives:[Iw,Ib,ww,jE,mT,Dw,Ab,Aw,Ch,Eh,Ph,ZE,Cb,dS,Kv],styles:[".card[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:relative;top:0;left:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:.5;filter:alpha(opacity=0)}main[_ngcontent-%COMP%]{padding:1em;font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:50px;display:block;color:#adff2f}label[_ngcontent-%COMP%]{color:#000}.items[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{display:flex}.location[_ngcontent-%COMP%]{width:70%;align-items:flex-start;justify-content:space-between;margin-left:8px}.location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:50px}.mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%]{display:block;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.confirm-button[_ngcontent-%COMP%]{background-color:#0046ad;padding:6px;border-radius:5px;border:none;color:#fff;min-height:45%;cursor:pointer;width:94%;margin:4px 5px 0;font-size:.8rem;font-weight:400}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.buttongroup[_ngcontent-%COMP%], .fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),e})(),rQ=0,sQ=(()=>{class e{constructor(){this._stateChanges=new T,this._openCloseAllActions=new T,this.id="cdk-accordion-"+rQ++,this._multi=!1}get multi(){return this._multi}set multi(e){this._multi=j_(e)}openAll(){this._openCloseAll(!0)}closeAll(){this._openCloseAll(!1)}ngOnChanges(e){this._stateChanges.next(e)}ngOnDestroy(){this._stateChanges.complete()}_openCloseAll(e){this.multi&&this._openCloseAllActions.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[Ea]}),e})(),oQ=0,aQ=(()=>{class e{constructor(e,t,i){this.accordion=e,this._changeDetectorRef=t,this._expansionDispatcher=i,this._openCloseAllSubscription=d.EMPTY,this.closed=new Ol,this.opened=new Ol,this.destroyed=new Ol,this.expandedChange=new Ol,this.id="cdk-accordion-child-"+oQ++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=i.listen((e,t)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===t&&this.id!==e&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(e){e=j_(e),this._expanded!==e&&(this._expanded=e,this.expandedChange.emit(e),e?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){this._disabled=j_(e)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(e=>{this.disabled||(this.expanded=e)})}}return e.\u0275fac=function(t){return new(t||e)(So(sQ,12),So(qs),So(gy))},e.\u0275dir=bt({type:e,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[Da([{provide:sQ,useValue:void 0}])]}),e})(),lQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})();const cQ=["body"];function hQ(e,t){}const uQ=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],dQ=["mat-expansion-panel-header","*","mat-action-row"],pQ=function(e,t){return{collapsedHeight:e,expandedHeight:t}},mQ=function(e,t){return{value:e,params:t}};function fQ(e,t){1&e&&Io(0,"span",2),2&e&&Po("@indicatorRotate",Uo()._getExpandedState())}const gQ=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],_Q=["mat-panel-title","mat-panel-description","*"],yQ=new je("MAT_ACCORDION"),vQ={indicatorRotate:vu("indicatorRotate",[Su("collapsed, void",Cu({transform:"rotate(0deg)"})),Su("expanded",Cu({transform:"rotate(180deg)"})),Tu("expanded <=> collapsed, void => collapsed",xu("225ms cubic-bezier(0.4,0.0,0.2,1)"))]),expansionHeaderHeight:vu("expansionHeight",[Su("collapsed, void",Cu({height:"{{collapsedHeight}}"}),{params:{collapsedHeight:"48px"}}),Su("expanded",Cu({height:"{{expandedHeight}}"}),{params:{expandedHeight:"64px"}}),Tu("expanded <=> collapsed, void => collapsed",bu([Mu("@indicatorRotate",Pu(),{optional:!0}),xu("225ms cubic-bezier(0.4,0.0,0.2,1)")]))]),bodyExpansion:vu("bodyExpansion",[Su("collapsed, void",Cu({height:"0px",visibility:"hidden"})),Su("expanded",Cu({height:"*",visibility:"visible"})),Tu("expanded <=> collapsed, void => collapsed",xu("225ms cubic-bezier(0.4,0.0,0.2,1)"))])};let xQ=(()=>{class e{constructor(e){this._template=e}}return e.\u0275fac=function(t){return new(t||e)(So(cl))},e.\u0275dir=bt({type:e,selectors:[["ng-template","matExpansionPanelContent",""]]}),e})(),bQ=0;const wQ=new je("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let CQ=(()=>{class e extends aQ{constructor(e,t,i,n,r,s,o){super(e,t,i),this._viewContainerRef=n,this._animationMode=s,this._hideToggle=!1,this.afterExpand=new Ol,this.afterCollapse=new Ol,this._inputChanges=new T,this._headerId="mat-expansion-panel-header-"+bQ++,this._bodyAnimationDone=new T,this.accordion=e,this._document=r,this._bodyAnimationDone.pipe(Q_((e,t)=>e.fromState===t.fromState&&e.toState===t.toState)).subscribe(e=>{"void"!==e.fromState&&("expanded"===e.toState?this.afterExpand.emit():"collapsed"===e.toState&&this.afterCollapse.emit())}),o&&(this.hideToggle=o.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(e){this._hideToggle=j_(e)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(e){this._togglePosition=e}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe(Mm(null),em(()=>this.expanded&&!this._portal),ym(1)).subscribe(()=>{this._portal=new iC(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(e){this._inputChanges.next(e)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const e=this._document.activeElement,t=this._body.nativeElement;return e===t||t.contains(e)}return!1}}return e.\u0275fac=function(t){return new(t||e)(So(yQ,12),So(qs),So(gy),So(ul),So(th),So(jp,8),So(wQ,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-expansion-panel"]],contentQueries:function(e,t,i){var n;1&e&&$l(i,xQ,!0),2&e&&Hl(n=Yl())&&(t._lazyContent=n.first)},viewQuery:function(e,t){var i;1&e&&Wl(cQ,!0),2&e&&Hl(i=Yl())&&(t._body=i.first)},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(e,t){2&e&&ia("mat-expanded",t.expanded)("_mat-animation-noopable","NoopAnimations"===t._animationMode)("mat-expansion-panel-spacing",t._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[Da([{provide:yQ,useValue:void 0}]),va,Ea],ngContentSelectors:dQ,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(e,t){1&e&&(Ho(uQ),Go(0),ko(1,"div",0,1),Lo("@bodyExpansion.done",(function(e){return t._bodyAnimationDone.next(e)})),ko(3,"div",2),Go(4,1),wo(5,hQ,0,0,"ng-template",3),Ao(),Go(6,2),Ao()),2&e&&(gr(1),Po("@bodyExpansion",t._getExpandedState())("id",t.id),xo("aria-labelledby",t._headerId),gr(4),Po("cdkPortalOutlet",t._portal))},directives:[aC],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[vQ.bodyExpansion]},changeDetection:0}),e})(),SQ=(()=>{class e{constructor(e,t,i,n,r){this.panel=e,this._element=t,this._focusMonitor=i,this._changeDetectorRef=n,this._parentChangeSubscription=d.EMPTY,this._animationsDisabled=!0;const s=e.accordion?e.accordion._stateChanges.pipe(em(e=>!(!e.hideToggle&&!e.togglePosition))):Kp;this._parentChangeSubscription=$(e.opened,e.closed,s,e._inputChanges.pipe(em(e=>!!(e.hideToggle||e.disabled||e.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),e.closed.pipe(em(()=>e._containsFocus())).subscribe(()=>i.focusVia(t,"program")),i.monitor(t).subscribe(t=>{t&&e.accordion&&e.accordion._handleHeaderFocus(this)}),r&&(this.expandedHeight=r.expandedHeight,this.collapsedHeight=r.collapsedHeight)}_animationStarted(){this._animationsDisabled=!1}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_keydown(e){switch(e.keyCode){case 32:case 13:wy(e)||(e.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e))}}focus(e="program",t){this._focusMonitor.focusVia(this._element,e,t)}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return e.\u0275fac=function(t){return new(t||e)(So(CQ,1),So(Fa),So(Ky),So(qs),So(wQ,8))},e.\u0275cmp=ft({type:e,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:19,hostBindings:function(e,t){1&e&&(Bo("@expansionHeight.start",(function(){return t._animationStarted()})),Lo("click",(function(){return t._toggle()}))("keydown",(function(e){return t._keydown(e)}))),2&e&&(xo("id",t.panel._headerId)("tabindex",t.disabled?-1:0)("aria-controls",t._getPanelId())("aria-expanded",t._isExpanded())("aria-disabled",t.panel.disabled),_a("@.disabled",t._animationsDisabled)("@expansionHeight",Al(16,mQ,t._getExpandedState(),Al(13,pQ,t.collapsedHeight,t.expandedHeight))),ia("mat-expanded",t._isExpanded())("mat-expansion-toggle-indicator-after","after"===t._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===t._getTogglePosition()))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},ngContentSelectors:_Q,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(e,t){1&e&&(Ho(gQ),ko(0,"span",0),Go(1),Go(2,1),Go(3,2),Ao(),wo(4,fQ,1,1,"span",1)),2&e&&(gr(4),Po("ngIf",t._showToggle()))},directives:[Ph],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;position:relative}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}\n'],encapsulation:2,data:{animation:[vQ.indicatorRotate,vQ.expansionHeaderHeight]},changeDetection:0}),e})(),EQ=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-panel-description"]],hostAttrs:[1,"mat-expansion-panel-header-description"]}),e})(),TQ=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),e})(),PQ=(()=>{class e extends sQ{constructor(){super(...arguments),this._ownHeaders=new Dl,this._hideToggle=!1,this.displayMode="default",this.togglePosition="after"}get hideToggle(){return this._hideToggle}set hideToggle(e){this._hideToggle=j_(e)}ngAfterContentInit(){this._headers.changes.pipe(Mm(this._headers)).subscribe(e=>{this._ownHeaders.reset(e.filter(e=>e.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new By(this._ownHeaders).withWrap()}_handleHeaderKeydown(e){const{keyCode:t}=e,i=this._keyManager;36===t?wy(e)||(i.setFirstItemActive(),e.preventDefault()):35===t?wy(e)||(i.setLastItemActive(),e.preventDefault()):this._keyManager.onKeydown(e)}_handleHeaderFocus(e){this._keyManager.updateActiveItem(e)}}return e.\u0275fac=function(t){return MQ(t||e)},e.\u0275dir=bt({type:e,selectors:[["mat-accordion"]],contentQueries:function(e,t,i){var n;1&e&&$l(i,SQ,!0),2&e&&Hl(n=Yl())&&(t._headers=n)},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(e,t){2&e&&ia("mat-accordion-multi",t.multi)},inputs:{multi:"multi",displayMode:"displayMode",togglePosition:"togglePosition",hideToggle:"hideToggle"},exportAs:["matAccordion"],features:[Da([{provide:yQ,useExisting:e}]),va]}),e})();const MQ=cn(PQ);let kQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lQ,hC]]}),e})();function AQ(e,t){if(1&e&&(Ci(),Io(0,"circle",3)),2&e){const e=Uo();ta("animation-name","mat-progress-spinner-stroke-rotate-"+e.diameter)("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),xo("r",e._circleRadius)}}function IQ(e,t){if(1&e&&(Ci(),Io(0,"circle",3)),2&e){const e=Uo();ta("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),xo("r",e._circleRadius)}}function RQ(e,t){if(1&e&&(Ci(),Io(0,"circle",3)),2&e){const e=Uo();ta("animation-name","mat-progress-spinner-stroke-rotate-"+e.diameter)("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),xo("r",e._circleRadius)}}function OQ(e,t){if(1&e&&(Ci(),Io(0,"circle",3)),2&e){const e=Uo();ta("stroke-dashoffset",e._strokeDashOffset,"px")("stroke-dasharray",e._strokeCircumference,"px")("stroke-width",e._circleStrokeWidth,"%"),xo("r",e._circleRadius)}}class NQ{constructor(e){this._elementRef=e}}const DQ=hv(NQ,"primary"),zQ=new je("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});let LQ=(()=>{class e extends DQ{constructor(t,i,n,r,s){super(t),this._elementRef=t,this._document=n,this._diameter=100,this._value=0,this._fallbackAnimation=!1,this.mode="determinate";const o=e._diameters;o.has(n.head)||o.set(n.head,new Set([100])),this._fallbackAnimation=i.EDGE||i.TRIDENT,this._noopAnimations="NoopAnimations"===r&&!!s&&!s._forceAnimations,s&&(s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth))}get diameter(){return this._diameter}set diameter(e){this._diameter=V_(e),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(e){this._strokeWidth=V_(e)}get value(){return"determinate"===this.mode?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,V_(e)))}ngOnInit(){const e=this._elementRef.nativeElement;this._styleRoot=F_(e)||this._document.head,this._attachStyleNode(),e.classList.add(`mat-progress-spinner-indeterminate${this._fallbackAnimation?"-fallback":""}-animation`)}get _circleRadius(){return(this.diameter-10)/2}get _viewBox(){const e=2*this._circleRadius+this.strokeWidth;return`0 0 ${e} ${e}`}get _strokeCircumference(){return 2*Math.PI*this._circleRadius}get _strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}get _circleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const t=this._styleRoot,i=this._diameter,n=e._diameters;let r=n.get(t);if(!r||!r.has(i)){const e=this._document.createElement("style");e.setAttribute("mat-spinner-animation",i+""),e.textContent=this._getAnimationText(),t.appendChild(e),r||(r=new Set,n.set(t,r)),r.add(i)}}_getAnimationText(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*this._strokeCircumference).replace(/END_VALUE/g,""+.2*this._strokeCircumference).replace(/DIAMETER/g,""+this.diameter)}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(A_),So(th,8),So(jp,8),So(zQ))},e.\u0275cmp=ft({type:e,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(xo("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),ta("width",t.diameter,"px")("height",t.diameter,"px"),ia("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[va],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(Ci(),ko(0,"svg",0),wo(1,AQ,1,9,"circle",1),wo(2,IQ,1,7,"circle",2),Ao()),2&e&&(ta("width",t.diameter,"px")("height",t.diameter,"px"),Po("ngSwitch","indeterminate"===t.mode),xo("viewBox",t._viewBox),gr(1),Po("ngSwitchCase",!0),gr(1),Po("ngSwitchCase",!1))},directives:[Ih,Rh],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),e._diameters=new WeakMap,e})(),BQ=(()=>{class e extends LQ{constructor(e,t,i,n,r){super(e,t,i,n,r),this.mode="indeterminate"}}return e.\u0275fac=function(t){return new(t||e)(So(Fa),So(A_),So(th,8),So(jp,8),So(zQ))},e.\u0275cmp=ft({type:e,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(e,t){2&e&&(ta("width",t.diameter,"px")("height",t.diameter,"px"),ia("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color"},features:[va],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(Ci(),ko(0,"svg",0),wo(1,RQ,1,9,"circle",1),wo(2,OQ,1,7,"circle",2),Ao()),2&e&&(ta("width",t.diameter,"px")("height",t.diameter,"px"),Po("ngSwitch","indeterminate"===t.mode),xo("viewBox",t._viewBox),gr(1),Po("ngSwitchCase",!0),gr(1),Po("ngSwitchCase",!1))},directives:[Ih,Rh],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),e})(),FQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv,Fh],lv]}),e})();function jQ(e,t){if(1&e){const e=No();ko(0,"button",3),Lo("click",(function(){return Jt(e),Uo().onDownload()})),ko(1,"mat-icon",14),pa(2,"save"),Ao(),Ao()}}function VQ(e,t){1&e&&Io(0,"mat-spinner",15),2&e&&Po("diameter",36)}function UQ(e,t){if(1&e){const e=No();ko(0,"mat-expansion-panel",20),Lo("opened",(function(){return Jt(e),Uo(3).panelOpenState=!0}))("closed",(function(){return Jt(e),Uo(3).panelOpenState=!1})),ko(1,"mat-expansion-panel-header"),Io(2,"mat-panel-title"),ko(3,"mat-panel-description"),pa(4),Ao(),Ao(),ko(5,"form",21,22),Lo("ngSubmit",(function(){return Jt(e),Co(6).form.valid})),ko(7,"label"),pa(8," SpaceName"),Ao(),ko(9,"mat-form-field",23),ko(10,"input",24,25),Lo("ngModelChange",(function(i){return Jt(e),t.$implicit.spaceName=i})),Ao(),Ao(),ko(12,"label"),pa(13," Space Type"),Ao(),ko(14,"mat-form-field",23),ko(15,"input",26,27),Lo("ngModelChange",(function(i){return Jt(e),t.$implicit.spaceType=i})),Ao(),Ao(),ko(17,"label"),pa(18," Space Capacity"),Ao(),ko(19,"mat-form-field",23),ko(20,"input",28,29),Lo("ngModelChange",(function(i){return Jt(e),t.$implicit.capacity=i})),Ao(),Ao(),Ao(),Ao()}if(2&e){const e=t.$implicit,i=Uo(2).$implicit;gr(4),fa("",i.levelName," "),gr(6),Po("ngModel",e.spaceName),gr(5),Po("ngModel",e.spaceType),gr(5),Po("ngModel",e.capacity)}}function qQ(e,t){if(1&e&&(Ro(0),ko(1,"mat-accordion"),wo(2,UQ,22,4,"mat-expansion-panel",19),Ao(),Oo()),2&e){const e=Uo().$implicit;gr(2),Po("ngForOf",e.subAccordion)}}function HQ(e,t){if(1&e){const e=No();ko(0,"mat-expansion-panel",16),Lo("opened",(function(){return Jt(e),Uo().panelOpenState=!0}))("closed",(function(){return Jt(e),Uo().panelOpenState=!1})),ko(1,"button",17),Lo("click",(function(i){Jt(e);const n=t.$implicit,r=t.index;return Uo().deleteItem(i,n,r)})),ko(2,"mat-icon"),pa(3,"cancel"),Ao(),Ao(),ko(4,"mat-expansion-panel-header"),ko(5,"mat-panel-title"),pa(6),Ao(),ko(7,"mat-panel-description"),pa(8),Ao(),Ao(),wo(9,qQ,3,1,"ng-container",18),Ao()}if(2&e){const e=t.$implicit,i=t.index;gr(6),ma(i+1),gr(2),ma(e.facilityName),gr(1),Po("ngIf",e.subAccordion)}}function GQ(e,t){if(1&e){const e=No();ko(0,"button",30),Lo("click",(function(){return Jt(e),Uo().submitSpaces()})),pa(1,"Confirm Spaces & Submit"),Ao()}}let WQ=(()=>{class e{constructor(e,t,i,n,r,s,o){this.snackBar=e,this.http=t,this.route=i,this.siteonboarding=n,this.blobService=r,this.dialog=s,this.maplocationservice=o,this.isUserAllowedFurter=!0,this.markerLocations=[{lat:38.914764662971436,lng:-97.01461108304595},{lat:2,lng:2}],this.sampleGeojson={type:"FeatureCollection",features:[]},this.spacecentroid={type:"FeatureCollection",features:[]},this.sas="sp=racwdli&st=2023-12-08T10:41:34Z&se=2025-09-04T18:41:34Z&spr=https&sv=2022-11-02&sr=c&sig=vCsc0ekXq6WQgRR%2BCzjy%2FWwhFSe%2BAZ7%2BF%2Byiv5lO%2BEw%3D",this.showupload=!1,this.facilityLocation=[],this.formpayload=[],this.drawToolitems=[],this.loader=!0,this.panelOpenState=!0,this.accordions=[],this.routeparams=this.route.snapshot.paramMap.get("id"),this.formelement=nQ,this.maplocationservice.locateFacility.subscribe(e=>{this.facilityLocation=e}),this.maplocationservice.addlevelData.subscribe(e=>{this.Facility_Id=e[0].Facility_Id,this.Site_Id=e[0].Site_Id,this.Level_Id=e[0].levelId,this.levelName=e[0].levelName,this.formdata=e})}drop(e){PJ(this.accordions,e.previousIndex,e.currentIndex)}ngOnInit(){var e;this.getSpaces(),this.siteonboarding.obtainedLevelDetails.subscribe(e=>{e.forEach((t,i)=>{t.levelId==this.formdata[0].levelId&&(this.Level_Id=e[i].levelId,this.levelName=e[i].levelName)})}),this.siteonboarding.obtainedFacilityDetails.subscribe(e=>{e.forEach((t,i)=>{t.facilityId==this.formdata[0].Facility_Id&&(this.facilityName=e[i].facilityName)})}),this.siteonboarding.obtainedSiteDetails.subscribe(e=>{e.forEach((t,i)=>{t.siteId==this.formdata[0].Site_Id&&(this.siteName=e[i].siteName)})});var t=null;t=new lN("createspace",{center:0==this.facilityLocation.length?[-24,42]:this.facilityLocation,zoom:0==this.facilityLocation.length?0:24,minZoom:2,pitch:6,layerSwitcherControl:{position:{top:"20",right:"750"},baseTitle:"Base Layers",overlayTitle:"Layers",repeatWorld:!1,excludeLayers:["vector"],containerClass:"maptalks-layer-switcher"},baseLayer:new aL("Base TileLayer",[new iL("Carto light",{visible:!0,repeatWorld:!1,urlTemplate:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]}),new iL("Satellite",{visible:!1,repeatWorld:!1,urlTemplate:"http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],attribution:'\xa9 <a href="http://osm.org">OpenStreetMap</a>  contributors, \xa9 <a href="https://carto.com/">CARTO</a> '})])});var i=new hD("vector").setOptions({editable:!0}).addTo(t);this.siteonboarding.obtainedspaceDetails.subscribe(e=>{t.getLayers().forEach(e=>{e._geoList.forEach((t,i)=>{"Marker"==t._jsonType&&t.options.id&&e._geoList[i].remove()})}),e&&e.forEach((i,n)=>{VN.toGeometry(i).setOptions({id:this.levelName}).addTo(t.getLayer("vector")).bringToFront().on("click",(function(t){i.properties.spaceId==t.target.properties.spaceId&&r.siteonboarding.saveAllDeviceDetails([e[n]]),r.opendialog()}))})}),this.maplocationservice.polygongeojson.subscribe(e=>{t.getLayers().forEach(e=>{e._geoList.forEach((t,i)=>{"Polygon"==t._jsonType&&e._geoList[i].remove()})}),e[0]&&(this.loader=!1,e[0].features.forEach(e=>{i.addGeometry(e)}),0==e[0].features.lenght&&(this.showupload=!1))});let n="";this.formdata.fileUrl&&!this.formdata[0].fileUrl.includes(".geojson")?(n=0==this.formdata.fileUrl.includes(".geojson")?this.formdata.fileUrl:"",this.geojsonLink=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.siteName}/${this.facilityName.replace(/\s+/g,"")}/${this.levelName.replace(/\s+/g,"")}/geojson/${this.levelName.replace(/\s+/g,"")+".geojson"}`,this.drawToolitems=["Point","LineString","Polygon","Circle","Ellipse","Rectangle","FreeHandLineString","FreeHandPolygon"]):this.formdata[0].fileUrl&&!this.formdata[0].fileUrl.includes(".geojson")?(n=0==this.formdata[0].fileUrl.includes(".geojson")?this.formdata[0].fileUrl:"",this.geojsonLink=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.siteName}/${this.facilityName.replace(/\s+/g,"")}/${this.levelName.replace(/\s+/g,"")}/geojson/${this.levelName.replace(/\s+/g,"")+".geojson"}`,this.drawToolitems=["Point","LineString","Polygon","Circle","Ellipse","Rectangle","FreeHandLineString","FreeHandPolygon"]):this.formdata[0].fileUrl.includes(".geojson")?(this.geojsonLink=this.formdata[0].fileUrl,this.drawToolitems=["Point"]):this.formdata[0].fileUrl.includes(".geojson")||(this.geojsonLink=`https://storagesmartroute27.blob.core.windows.net/filesupload/${this.siteName}/${this.facilityName.replace(/\s+/g,"")}/${this.levelName.replace(/\s+/g,"")}/geojson/${this.levelName.replace(/\s+/g,"")+".geojson"}`,this.drawToolitems=["Point"]),this.getpolygonsdata(),this.point=new MN(this.facilityLocation,{visible:!0,editable:!0,cursor:"pointer",draggable:!1,dragShadow:!1,drawOnAxis:null,symbol:{markerFile:n,markerWidth:200,markerHeight:100,markerDx:0,markerDy:0,markerOpacity:1},properties:{id:this.levelName}}),n&&new hD("customimage",this.point,{enableAltitude:!0}).addTo(t),t.on("zoomend ",()=>{(e=t.getZoom())>21?this.point.updateSymbol({markerWidth:400,markerHeight:300}):e<=21&&this.point.updateSymbol({markerWidth:10*e,markerHeight:5*e}),this.point.updateSymbol({markerWidth:10*e,markerHeight:5*e})});var r=this,s=new mD({mode:"Point"}).addTo(t).disable();s.on("drawend",(function(e){let t=JSON.stringify(e.geometry.toGeoJSON()),n=JSON.parse(t);n.properties={spacename:"",levelId:r.Level_Id},r.selecteddrawToolOption=n.geometry.type,"Point"==n.geometry.type?(e.geometry.setOptions({id:r.levelName}),r.accordions.push({facilityName:r.facilityName,levelName:r.levelName,subAccordion:[{Facility_Id:r.Facility_Id,Level_Id:r.Level_Id,Site_Id:r.Site_Id,spaceName:"",spaceType:"",capacity:0,spacelocation:JSON.stringify(n)}]}),r.spacecentroid.features.push(n)):(r.showupload=!0,r.sampleGeojson.features.push(n)),i.addGeometry(e.geometry)})),t.getLayer("vector").bringToFront();var o=this.drawToolitems.map((function(e){return{item:e,click:function(){s.setMode(e).enable()}}}));new Lz.Toolbar({items:[{item:"Shape",children:o},{item:"Disable",click:function(){s.disable()}},{item:"Clear",click:function(){"Point"==r.selecteddrawToolOption?(r.spacecentroid.features.splice(-1,1),r.accordions.splice(-1,1),r.siteonboarding.saveAllSpaceDetails(r.spacecentroid.features),r.accordions.splice(-1,1)):(r.sampleGeojson.features.splice(-1,1),r.maplocationservice.addpolygondata([r.sampleGeojson]))}}]}).addTo(t);const a=G_(document,"keydown").pipe(em(e=>27===e.keyCode),Q_());this.subscription=a.subscribe(e=>{"keydown"===e.type&&s.disable()})}getpolygonsdata(){this.loader=!0,this.http.get(String(this.geojsonLink)).subscribe(e=>{e&&(this.loader=!1,this.sampleGeojson.features=[],e.features.forEach(e=>{this.sampleGeojson.features.push(e)}),this.maplocationservice.addpolygondata([this.sampleGeojson]))})}getSpaces(){this.siteonboarding.getAllSpaces().subscribe(e=>{if(e){let t=[];e.forEach((i,n)=>{let r={};i.Level_Id==this.Level_Id&&(r.type="Feature",r.geometry=e[n].spacelocation,r.properties={spaceName:e[n].spaceName,spaceType:e[n].spaceType,spaceId:e[n].spaceId,Site_Id:e[n].Site_Id,Facility_Id:e[n].Facility_Id,Level_Id:e[n].Level_Id},t.push(r))}),this.siteonboarding.saveAllSpaceDetails(t)}})}deleteItem(e,t,i){this.accordions.splice(i-1,1)}opendialog(){this.dialog.open(this.formelement,{closeOnNavigation:!0,autoFocus:!0,data:event,position:{right:"100px",top:"50px"}})}fileUpload(e){(new FormData).append("file",e),this.fileName=e.name,this.fileType=e.name.split(".")[1],this.fileName&&(this.blobService.uploadImage(this.sas,e,this.facilityName+"/"+this.levelName+"/"+this.fileType+"/"+e.name,()=>{}),this.reloadImages())}reloadImages(){this.blobService.listImages(this.sas).then(e=>{e&&(this.snackBar.open("File/data saved successfully","close",{duration:3e3,verticalPosition:"top"}),this.getpolygonsdata())})}startEdit(){this.point.startEdit()}endEdit(){this.point.endEdit()}download(e,t,i){const n=document.createElement("a"),r=new Blob([e],{type:i});n.href=URL.createObjectURL(r),n.download=t,(new FormData).append("file",r),this.fileName=t,this.fileType=t.split(".")[1],this.fileName&&(this.blobService.uploadImage(this.sas,r,this.siteName+"/"+this.facilityName.replace(/\s+/g,"")+"/"+this.levelName.replace(/\s+/g,"")+"/"+this.fileType+"/"+t,()=>{}),this.reloadImages())}onDownload(){this.download(JSON.stringify(this.sampleGeojson),this.levelName.replace(/\s+/g,"")+".geojson","text/plain"),this.showupload=!0}submitForm(e){this.siteonboarding.addSpaces(e).subscribe(e=>{e.length>0?(this.snackBar.open("Done","close",{duration:3e3,verticalPosition:"top"}),this.accordions=[],this.getSpaces()):this.snackBar.open("Failed","retry",{duration:3e3,verticalPosition:"top"})})}submitSpaces(){this.formpayload=[],this.accordions.forEach((e,t)=>{e.subAccordion.forEach(e=>{this.formpayload.push(e),t==this.accordions.length-1&&this.submitForm(this.formpayload)})})}}return e.\u0275fac=function(t){return new(t||e)(So(FB),So(jx),So($f),So(PB),So($K),So(kT),So(XK))},e.\u0275cmp=ft({type:e,selectors:[["app-create-spaces"]],decls:17,vars:4,consts:[[1,"row"],[1,"col-lg-12"],[1,"pane"],["mat-icon-button","","color","primary","aria-label","normal button",3,"click"],["matTooltip","Start Edit"],["matTooltip","Done"],["mat-icon-button","","color","primary","aria-label","normal button",3,"click",4,"ngIf"],[1,"spinner-div"],["class","spinner","color","primary",3,"diameter",4,"ngIf"],["id","createspace"],[1,"accordian"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"opened","closed",4,"ngFor","ngForOf"],["type","button","class","confirm-button","id","left-panel-link",3,"click",4,"ngIf"],["matTooltip","Save"],["color","primary",1,"spinner",3,"diameter"],["cdkDrag","",3,"opened","closed"],["mat-icon-button","","color","gray","aria-label","normal button",1,"icon-button-small",3,"click"],[4,"ngIf"],[3,"opened","closed",4,"ngFor","ngForOf"],[3,"opened","closed"],["name","form",3,"ngSubmit"],["f","ngForm"],["appearance","outline"],["matInput","","type","text","name","spaceName","required","",1,"form-control",3,"ngModel","ngModelChange"],["spaceName","ngModel"],["matInput","","type","text","name","SpaceType","required","",1,"form-control",3,"ngModel","ngModelChange"],["SpaceType","ngModel"],["matInput","","type","text","name","Capacity","required","",1,"form-control",3,"ngModel","ngModelChange"],["Capacity","ngModel"],["type","button","id","left-panel-link",1,"confirm-button",3,"click"]],template:function(e,t){1&e&&(ko(0,"div",0),ko(1,"div",1),ko(2,"div",2),ko(3,"button",3),Lo("click",(function(){return t.startEdit()})),ko(4,"mat-icon",4),pa(5,"edit"),Ao(),Ao(),ko(6,"button",3),Lo("click",(function(){return t.endEdit()})),ko(7,"mat-icon",5),pa(8,"done_all"),Ao(),Ao(),wo(9,jQ,3,0,"button",6),Ao(),ko(10,"div",7),wo(11,VQ,1,1,"mat-spinner",8),Ao(),Io(12,"div",9),ko(13,"div",10),ko(14,"mat-accordion",11),Lo("cdkDropListDropped",(function(e){return t.drop(e)})),wo(15,HQ,10,3,"mat-expansion-panel",12),Ao(),wo(16,GQ,2,0,"button",13),Ao(),Ao(),Ao()),2&e&&(gr(9),Po("ngIf",t.showupload),gr(2),Po("ngIf",t.loader),gr(4),Po("ngForOf",t.accordions),gr(1),Po("ngIf",t.accordions.length>0))},directives:[dS,gb,rS,Ph,PQ,XJ,Eh,BQ,CQ,GJ,SQ,TQ,EQ,Iw,Ib,ww,jE,ZE,Cb,Dw,Ab,Aw],styles:["#createspace[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;right:0}.spinner-div[_ngcontent-%COMP%]{z-index:100000;top:50%;bottom:50%;position:absolute}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]{width:80px;height:80px;line-height:80px}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;line-height:48px}button[mat-icon-button].icon-button-large[_ngcontent-%COMP%]   .mat-button-ripple[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]{position:absolute;top:0;right:5px;width:24px;height:24px;line-height:24px}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}button[mat-icon-button].icon-button-small[_ngcontent-%COMP%]   .mat-button-ripple[_ngcontent-%COMP%]{font-size:inherit;width:inherit;height:inherit;line-height:inherit}.pane[_ngcontent-%COMP%]{background:none;line-height:28px;color:#fff;z-index:10;position:absolute;top:30px;left:30px;display:flex}.pane[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;color:#fff;text-align:left;padding:0 10px;min-width:28px;min-height:28px;float:left}.mat-form-field[_ngcontent-%COMP%]{width:100%}.maptalks-toolbar-horizonal[_ngcontent-%COMP%], div[_ngcontent-%COMP%]{margin:-20px!important}.image-upload[_ngcontent-%COMP%]{position:absolute;top:20px;right:100px;z-index:100}.image-upload[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{display:none}.image-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:80px;cursor:pointer}.fields[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.accordian[_ngcontent-%COMP%]{background:none;line-height:28px;color:#fff;z-index:10;position:absolute;justify-content:center;min-width:250px;max-width:300px;min-height:450px;max-height:500px;overflow-y:auto;overflow-x:hidden;top:100px;left:20px}.card-footer[_ngcontent-%COMP%]{margin:10px;height:10vh}.confirm-button[_ngcontent-%COMP%]{background-color:#0046ad;padding:6px;border-radius:5px;border:none;color:#fff;min-height:45%;cursor:pointer;width:94%;margin:4px 5px 0;font-size:.8rem;font-weight:400}"]}),e})(),ZQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv,Fv],lv]}),e})();const $Q=new je("mat-chips-default-options"),XQ={separatorKeyCodes:[13]};let KQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[Pv,{provide:$Q,useValue:XQ}]}),e})(),YQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Av,lv],Av,lv]}),e})();const JQ={provide:new je("mat-menu-scroll-strategy"),deps:[LC],useFactory:function(e){return()=>e.scrollStrategies.reposition()}};let QQ=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[JQ],imports:[lv]}),e})(),e0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[JQ],imports:[[Fh,lv,Fv,qC,QQ],xy,lv,QQ]}),e})(),t0=(()=>{class e{constructor(){this.changes=new T,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,t,i)=>{if(0==i||0==t)return"0 of "+i;const n=e*t;return`${n+1} \u2013 ${n<(i=Math.max(i,0))?Math.min(n+t,i):n+t} of ${i}`}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})();const i0={provide:t0,deps:[[new oe,new le,t0]],useFactory:function(e){return e||new t0}};let n0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[i0],imports:[[Fh,pS,fT,oS]]}),e})(),r0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lv],lv]}),e})(),s0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[Fh,lv],lv]}),e})(),o0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})(),a0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[o0,Fv,lv,Ay],o0,lv]}),e})(),l0=(()=>{class e{constructor(){this.changes=new T,this.sortButtonLabel=e=>"Change sorting for "+e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})();const c0={provide:l0,deps:[[new oe,new le,l0]],useFactory:function(e){return e||new l0}};let h0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[c0],imports:[[Fh]]}),e})(),u0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)}}),e})(),d0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[u0,lv],lv]}),e})(),p0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[lv],lv]}),e})(),m0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[my]]}),e})(),f0=(()=>{class e{constructor(){this.changes=new T,this.optionalLabel="Optional"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:"root"}),e})();const g0={provide:f0,deps:[[new oe,new le,f0]],useFactory:function(e){return e||new f0}};let _0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},providers:[g0,Pv],imports:[[lv,Fh,hC,pS,m0,_b,Fv],lv]}),e})(),y0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[ev,lv],lv]}),e})(),v0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[qC,lv,hC],lv]}),e})(),x0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[_T,pS,v0,ZQ,XE,zT,KQ,d0,OT,AT,kQ,VE,YQ,_b,$E,Jw,e0,n0,r0,FQ,NT,Fv,fT,y0,bx,a0,s0,LB,h0,_0,nE,p0,oS,Tv,u0,ev,my,lQ,Ay,qC,I_,hC,KJ]}),e})();const b0=[{path:"maptool/:id",component:nJ},{path:"createspaces/:id",component:WQ}];let w0=(()=>{class e{}return e.\u0275mod=vt({type:e}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[v_.forRoot(b0),Fh,_u,Up,Lw,x0]]}),e})();const C0=[{path:"map",component:XY},{path:"Occupancy",component:KY},{path:"PM",component:YY},{path:"maptool/:id",component:eJ},{path:"",component:XY}];let S0=(()=>{class e{}return e.\u0275mod=vt({type:e,bootstrap:[qT]}),e.\u0275inj=pe({factory:function(t){return new(t||e)},imports:[[v_.forRoot(C0),_u,tb,Up,bx,Jw,_b,nE,XE,AT,oS,pS,$E,fT,VE,OT,NT,zT,_T,w0]]}),e})();(function(){if(Sn)throw new Error("Cannot enable prod mode after platform setup.");Cn=!1})(),fu().bootstrapModule(S0).catch(e=>console.error(e))},zn8P:function(e,t){function i(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="zn8P"}},[[1,0]]]);